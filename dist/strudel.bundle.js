(function(){"use strict";const App$1={};window.App=App$1;const DOM$1={};DOM$1.dataset_obj={},DOM$1.dataset_id=0,DOM$1.el=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),t.querySelector(e)),DOM$1.els=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),Array.from(t.querySelectorAll(e))),DOM$1.el_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=t.querySelector(e);return o||t.classList.contains(DOM$1.clean_dot(e))&&(o=t),o},DOM$1.els_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=Array.from(t.querySelectorAll(e));return o.length===0&&t.classList.contains(DOM$1.clean_dot(e))&&(o=[t]),o},DOM$1.clone=e=>(e=DOM$1.element(e),e.cloneNode(!0)),DOM$1.clone_children=e=>{e=DOM$1.element(e);let t=Array.from(e.children),o=[];for(let a of t)o.push(DOM$1.clone(a));return o},DOM$1.dataset=(e,t,o)=>{if(e=DOM$1.element(e),!e)return;let a=e.dataset.dataset_id;if(a||(a=DOM$1.dataset_id,DOM$1.dataset_id+=1,e.dataset.dataset_id=a,DOM$1.dataset_obj[a]={}),o!==void 0)DOM$1.dataset_obj[a][t]=o;else return DOM$1.dataset_obj[a][t]},DOM$1.create=(e,t="",o="")=>{let a=document.createElement(e);if(t){let u=t.split(" ").filter(l=>l!=="");for(let l of u)a.classList.add(l)}return o&&(a.id=o),a},DOM$1.ev=(e,t,o,a)=>{e=DOM$1.element(e),e.addEventListener(t,o,a)},DOM$1.evs=(e,t,o,a)=>{e=DOM$1.element(e);for(let u of t)e.addEventListener(u,o,a)},DOM$1.index=e=>(e=DOM$1.element(e),Array.from(e.parentNode.children).indexOf(e)),DOM$1.class=(e,t)=>{e=DOM$1.element(e);for(let o of t)if(e.classList.contains(DOM$1.clean_dot(o)))return!0;return!1},DOM$1.parent=(e,t)=>{e=DOM$1.element(e);for(let o of t){let a=e.closest(o);if(a)return a}},DOM$1.clean_dot=e=>e.replace(".",""),DOM$1.show=(e,t=1)=>{e=DOM$1.element(e),e.classList.remove(DOM$1.hidden(t))},DOM$1.hide=(e,t=1)=>{e=DOM$1.element(e),e.classList.add(DOM$1.hidden(t))},DOM$1.hidden=(e=1)=>{let t="hidden";return e>1&&(t+=`_${e}`),t},DOM$1.is_hidden=(e,t=1)=>e.classList.contains(DOM$1.hidden(t)),DOM$1.element=e=>typeof e=="string"?DOM$1.el(e):e,typeof window<"u"&&(window.DOM=DOM$1);const NeedContext$1={};NeedContext$1.created=!1,NeedContext$1.after_show=()=>{},NeedContext$1.after_hide=()=>{},NeedContext$1.min_width="25px",NeedContext$1.min_height="25px",NeedContext$1.back_icon="⬅️",NeedContext$1.back_text="Back",NeedContext$1.clear_text="Clear",NeedContext$1.item_sep="4px",NeedContext$1.layers={},NeedContext$1.level=0,NeedContext$1.gap="0.5rem",NeedContext$1.side_padding="0.5rem",NeedContext$1.compact_padding="0.3rem",NeedContext$1.center_top=20,NeedContext$1.dragging=!1,NeedContext$1.autohide_delay=500,NeedContext$1.autoclick_delay=500,NeedContext$1.autohide_threshold=5,NeedContext$1.set_defaults=()=>{NeedContext$1.open=!1,NeedContext$1.mousedown=!1,NeedContext$1.first_mousedown=!1,NeedContext$1.keydown=!1,NeedContext$1.filtered=!1,NeedContext$1.last_x=0,NeedContext$1.last_y=0,NeedContext$1.layers={},NeedContext$1.mouse_activity={},NeedContext$1.autohide_enabled=!1,NeedContext$1.reset_debouncers()},NeedContext$1.clear_filter=()=>{NeedContext$1.filter.value="",NeedContext$1.do_filter(),NeedContext$1.filter.focus()},NeedContext$1.do_filter=()=>{let e=NeedContext$1.filter.value,t=NeedContext$1.remove_spaces_2(e).toLowerCase(),o=t.includes(":"),a=!1;for(let p of document.querySelectorAll(".needcontext-separator"))t?p.classList.add("needcontext-hidden"):p.classList.remove("needcontext-hidden");for(let p of document.querySelectorAll(".needcontext-text")){let d=p.closest(".needcontext-item"),g=p.textContent.toLowerCase();g=NeedContext$1.remove_spaces(g),o||(g=g.replace(/:/g,"")),g.includes(t)?(d.classList.remove("needcontext-hidden"),a||(NeedContext$1.select_item(parseInt(d.dataset.index)),a=!0)):d.classList.add("needcontext-hidden")}let u=document.querySelector("#needcontext-back"),l=document.querySelector("#needcontext-clear");if(NeedContext$1.filtered=t!=="",NeedContext$1.filtered){let p=document.querySelector("#needcontext-clear-text");p.textContent=e.trim(),l.classList.remove("needcontext-hidden"),u&&u.classList.add("needcontext-hidden")}else l.classList.add("needcontext-hidden"),u&&u.classList.remove("needcontext-hidden");NeedContext$1.scroll_to_selected()},NeedContext$1.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},NeedContext$1.show=(e={})=>{let t={root:!0,expand:!1,picker_mode:!1,margin:0,compact:!1,autohide:!1,autoclick:!1};if(NeedContext$1.def_args(t,e),!e.items.length)return;if(NeedContext$1.reset_debouncers(),NeedContext$1.created||NeedContext$1.create(),e.e&&e.e.clientX!==void 0&&e.e.clientY!==void 0)e.x=e.e.clientX,e.y=e.e.clientY;else if(e.element){let f=e.element.getBoundingClientRect();e.x=f.left,e.y=f.top+e.margin}e.root&&(NeedContext$1.level=0);let o=e.x===void 0||e.y===void 0;if(e.items=e.items.slice(0),e.index===void 0){let f=e.items.filter(A=>!A.separator);for(let[A,b]of f.entries())if(b.selected){e.index=A;break}}e.index===void 0&&(e.index=0),e.index>=e.items.length&&(e.index=e.items.length-1);let a,u=NeedContext$1.get_layer();u?a=u.last_index:a=e.index,a=a||0;for(let[f,A]of e.items.entries())f===a?A.selected=!0:A.selected=!1;let l=0,p=NeedContext$1.container;if(p.innerHTML="",p.style.left="unset",p.style.top="unset",p.style.transform="unset",p.style.minWidth="unset",p.style.minHeight="unset",e.title&&!e.compact){let f=document.createElement("div");f.id="needcontext-title",e.title_icon&&(document.createElement("div").classList.add("needcontext-title-icon"),f.append(e.title_icon));let A=document.createElement("div");if(A.textContent=e.title.trim(),f.append(A),p.append(f),e.title_number){let b=document.createElement("div");b.classList.add("needcontext-title-number"),f.append(b)}p.classList.add("with_title"),p.classList.remove("without_title")}else p.classList.remove("with_title"),p.classList.add("without_title");e.root||p.append(NeedContext$1.back_button()),p.append(NeedContext$1.clear_button());let d=[];e.compact?p.classList.add("needcontext-compact"):p.classList.remove("needcontext-compact");for(let f of e.items){if(e.compact&&!f.icon)continue;let A=document.createElement("div");if(A.classList.add("needcontext-item"),f.separator)A.classList.add("needcontext-separator");else{if(A.classList.add("needcontext-normal"),f.highlight&&A.classList.add("needcontext-highlight"),f.image){let b=document.createElement("img");b.loading="lazy",b.addEventListener("error",F=>{F.target.classList.add("needcontext-hidden")}),b.classList.add("needcontext-image"),b.src=f.image,A.append(b)}if(f.icon){let b=document.createElement("div");b.classList.add("needcontext-icon"),f.icon_action&&b.addEventListener("click",F=>{f.icon_action(F,b)}),b.append(f.icon),A.append(b)}if(f.text){let b=document.createElement("div");b.classList.add("needcontext-text"),b.textContent=f.text.trim(),A.append(b)}if(e.compact){if(e.compact){let b=[f.text,f.info].filter(Boolean);A.title=b.join(" - ")}}else f.info&&(A.title=f.info.trim());f.bold&&A.classList.add("needcontext-bold"),f.direct_action&&A.addEventListener("click",()=>{f.direct_action(),NeedContext$1.hide()}),A.dataset.index=l,f.index=l,A.addEventListener("mousemove",()=>{let b=parseInt(A.dataset.index);NeedContext$1.index!==b&&NeedContext$1.select_item(b)}),l+=1,d.push(f)}e.on_drag&&(A.draggable=!0),f.element=A,f.picked=!1,p.append(A)}NeedContext$1.layers[NeedContext$1.level]={root:e.root,items:e.items,normal_items:d,last_index:a,x:e.x,y:e.y},NeedContext$1.main.classList.remove("needcontext-hidden"),NeedContext$1.update_title(),o&&(p.style.left="50%",p.style.transform="translateX(-50%)",e.y=NeedContext$1.center_top),e.y<5&&(e.y=5),e.x<5&&(e.x=5);let g=5;if(e.y+p.offsetHeight+5>window.innerHeight){let f=Math.abs(e.y+p.offsetHeight-window.innerHeight);e.y-=f+g}if(e.x+p.offsetWidth+5>window.innerWidth){let f=Math.abs(e.x+p.offsetWidth-window.innerWidth);e.x-=f+g}NeedContext$1.last_x=e.x,NeedContext$1.last_y=e.y,e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),p.style.top=`${e.y}px`,o||(p.style.left=`${e.x}px`,p.style.transform="unset"),NeedContext$1.filter.value="",NeedContext$1.filter.focus(),e.expand&&e.element?p.style.minWidth=`${e.element.clientWidth}px`:p.style.minWidth=NeedContext$1.min_width,p.style.minHeight=NeedContext$1.min_height,NeedContext$1.filter.value="",NeedContext$1.filtered=!1,NeedContext$1.select_item(a),NeedContext$1.scroll_to_selected(),NeedContext$1.open=!0,NeedContext$1.after_show(),e.root&&(NeedContext$1.args=e)},NeedContext$1.hide=e=>{NeedContext$1.open&&(NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.set_defaults(),NeedContext$1.after_hide(),NeedContext$1.args.after_hide&&NeedContext$1.args.after_hide(e))},NeedContext$1.select_item=e=>{let t=Array.from(document.querySelectorAll(".needcontext-normal"));for(let o of t)parseInt(o.dataset.index)===e?o.classList.add("needcontext-item-selected"):o.classList.remove("needcontext-item-selected");NeedContext$1.index=e},NeedContext$1.scroll_to_selected=(e="center")=>{let t=document.querySelector(".needcontext-item-selected");t&&t.scrollIntoView({block:e})},NeedContext$1.select_next=(e="down",t=!1)=>{let o=!1,a,u=NeedContext$1.get_layer().normal_items.slice(0);u=u.filter(l=>!l.removed),e==="up"&&u.reverse();for(let l of u)if(NeedContext$1.is_visible(l.element)){if(a===void 0&&(a=l.index),o){NeedContext$1.select_item(l.index),NeedContext$1.scroll_to_selected("nearest");return}l.index===NeedContext$1.index&&(o=!0)}if(!t)return NeedContext$1.select_item(a),NeedContext$1.scroll_to_selected("nearest"),!0;NeedContext$1.select_next("up")},NeedContext$1.select_action=(e,t=NeedContext$1.index,o="mouse")=>{if(o==="mouse"&&!e.target.closest(".needcontext-normal"))return;let a=NeedContext$1.get_layer().normal_items[t];if(!a)return;let u=NeedContext$1.last_x,l=NeedContext$1.last_y,p=f=>{NeedContext$1.get_layer().last_index=t,NeedContext$1.level+=1,e.clientY&&(l=e.clientY),NeedContext$1.show({x:u,y:l,items:f,root:!1})},d=f=>{f.length===1&&f[0].direct?NeedContext$1.action(f[0],e):p(f)};async function g(){if(a.action){e.shiftKey?a.shift_action&&NeedContext$1.shift_action(a,e):e.ctrlKey?a.ctrl_action&&NeedContext$1.ctrl_action(a,e):e.altKey?a.alt_action&&NeedContext$1.alt_action(a,e):NeedContext$1.action(a,e);return}else if(a.items)d(a.items);else if(a.get_items){let f=await a.get_items();d(f)}}if(o==="keyboard"){g();return}e.button===0?e.shiftKey?a.shift_action&&NeedContext$1.shift_action(a,e):e.ctrlKey?a.ctrl_action&&NeedContext$1.ctrl_action(a,e):e.altKey?a.alt_action&&NeedContext$1.alt_action(a,e):g():e.button===1?a.middle_action&&NeedContext$1.middle_action(a,e):e.button===2&&a.context_action&&NeedContext$1.context_action(a,e)},NeedContext$1.is_visible=e=>!e.classList.contains("needcontext-hidden"),NeedContext$1.remove_spaces=e=>e.replace(/[\s-]+/g,""),NeedContext$1.remove_spaces_2=e=>e.replace(/\s+/g,""),NeedContext$1.init=()=>{let e=document.createElement("style"),t=`
    #needcontext-main {
      position: fixed;
      z-index: 999999999;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }

    .needcontext-hidden {
      display: none !important;
    }

    #needcontext-container {
      z-index: 2;
      position: absolute;
      background-color: white;
      color: black;
      font-size: 16px;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      user-select: none;
      border: 1px solid #2B2F39;
      border-radius: 5px;
      padding-bottom: 5px;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: hidden;
      text-align: left;
      max-width: 98%;
    }

    #needcontext-container.needcontext-compact {
      flex-direction: row;
      flex-wrap: wrap;
      padding-left: ${NeedContext$1.compact_padding};
      padding-right: ${NeedContext$1.compact_padding};
    }

    .needcontext-compact .needcontext-text {
      display: none;
    }

    .needcontext-compact .needcontext-separator {
      display: none;
    }

    #needcontext-container.without_title {
      padding-top: 5px;
    }

    #needcontext-title {
      font-weight: bold;
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      background-color: rgba(67, 220, 255, 0.47);
      padding-top: 4px;
      padding-bottom: 4px;
      margin-bottom: 2px;
      display: flex;
      flex-direction: row;
      gap: ${NeedContext$1.gap};
      align-items: center;
      justify-content: flex-start;
    }

    #needcontext-filter {
      opacity: 0;
    }

    .needcontext-item {
      white-space: nowrap;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
    }

    .needcontext-normal {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      cursor: pointer;
    }

    .needcontext-highlight {
      border: 1px solid currentColor !important;
      border-radius: 10px;
    }

    .needcontext-picked .needcontext-text {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .needcontext-button {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
      cursor: pointer;
    }

    .needcontext-button:hover {
      text-shadow: 0 0 1rem currentColor;
    }

    .needcontext-separator {
      border-top: 1px solid currentColor;
      margin-left: ${NeedContext$1.side_padding};
      margin-right: ${NeedContext$1.side_padding};
      margin-top: ${NeedContext$1.item_sep};
      margin-bottom: ${NeedContext$1.item_sep};
      opacity: 0.7;
    }

    .needcontext-item-selected {
      background-color: rgba(0, 0, 0, 0.18);
    }

    .needcontext-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .needcontext-image {
      width: 1.11rem;
      height: 1.11rem;
      object-fit: contain;
      margin-right: 0.1rem;
    }

    .needcontext-bold {
      font-weight: bold;
    }
  `;e.innerText=t,document.head.appendChild(e),document.addEventListener("mousedown",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.first_mousedown=!0,o.target.closest("#needcontext-container")&&(NeedContext$1.mousedown=!0))}),document.addEventListener("mouseup",o=>{!NeedContext$1.open||!o.target||(o.target.closest("#needcontext-container")?o.target.closest(".needcontext-back")?o.button===0&&NeedContext$1.go_back():o.target.closest(".needcontext-clear")?o.button===0&&NeedContext$1.clear_filter():NeedContext$1.mousedown&&NeedContext$1.select_action(o):NeedContext$1.first_mousedown&&NeedContext$1.dismiss(o),NeedContext$1.mousedown=!1)}),document.addEventListener("mousemove",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.addEventListener("mouseover",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.documentElement.addEventListener("mouseleave",o=>{NeedContext$1.open&&NeedContext$1.args.autohide&&NeedContext$1.autohide_debouncer.call_2(o)}),document.addEventListener("keydown",o=>{NeedContext$1.open&&(NeedContext$1.keydown=!0,["ArrowUp","ArrowLeft"].includes(o.key)?(NeedContext$1.select_next("up"),o.preventDefault()):["ArrowDown","ArrowRight"].includes(o.key)?(NeedContext$1.select_next(),o.preventDefault()):o.key==="Backspace"&&(NeedContext$1.filtered||(NeedContext$1.go_back(),o.preventDefault())))}),document.addEventListener("keyup",o=>{NeedContext$1.open&&NeedContext$1.keydown&&(NeedContext$1.keydown=!1,o.key==="Escape"?(NeedContext$1.dismiss(o),o.preventDefault()):o.key==="Enter"&&(NeedContext$1.select_action(o,void 0,"keyboard"),o.preventDefault()))}),NeedContext$1.start_autohide(),NeedContext$1.start_autoclick(),NeedContext$1.set_defaults()},NeedContext$1.create=()=>{NeedContext$1.main=document.createElement("div"),NeedContext$1.main.id="needcontext-main",NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.container=document.createElement("div"),NeedContext$1.container.id="needcontext-container",NeedContext$1.filter=document.createElement("input"),NeedContext$1.filter.id="needcontext-filter",NeedContext$1.filter.type="text",NeedContext$1.filter.autocomplete="off",NeedContext$1.filter.spellcheck=!1,NeedContext$1.filter.placeholder="Filter",NeedContext$1.filter.addEventListener("input",e=>{NeedContext$1.do_filter()}),NeedContext$1.main.addEventListener("contextmenu",e=>{e.preventDefault()}),NeedContext$1.container.addEventListener("dragstart",e=>{NeedContext$1.dragging=!0,NeedContext$1.dragstart_action(e)}),NeedContext$1.container.addEventListener("dragenter",e=>{NeedContext$1.dragenter_action(e)}),NeedContext$1.container.addEventListener("dragend",e=>{NeedContext$1.dragging=!1,NeedContext$1.dragend_action(e)}),NeedContext$1.main.append(NeedContext$1.filter),NeedContext$1.main.append(NeedContext$1.container),document.body.appendChild(NeedContext$1.main),NeedContext$1.created=!0},NeedContext$1.dragstart_action=e=>{NeedContext$1.dragged_item=e.target;let t=NeedContext$1.container,o=Array.from(t.querySelectorAll(".needcontext-item"));NeedContext$1.dragged_index=o.indexOf(e.target)},NeedContext$1.dragenter_action=e=>{let t=NeedContext$1.dragged_item;if(t===e.target)return;let o=NeedContext$1.container,a=Array.from(o.querySelectorAll(".needcontext-item")),u=a.indexOf(t),l=a.indexOf(e.target);if(u<0||l<0)return;u<l?o.insertBefore(t,e.target.nextSibling):o.insertBefore(t,e.target),a=Array.from(o.querySelectorAll(".needcontext-item"));let p=a.indexOf(t),d=a.indexOf(e.target);t.dataset.index=p,e.target.dataset.index=d,NeedContext$1.select_item(p)},NeedContext$1.dragend_action=e=>{let t=NeedContext$1.container,o=NeedContext$1.dragged_item,u=Array.from(t.querySelectorAll(".needcontext-item")).indexOf(o);NeedContext$1.hide(e),NeedContext$1.args.on_drag(NeedContext$1.dragged_index,u)},NeedContext$1.get_layer=()=>NeedContext$1.layers[NeedContext$1.level],NeedContext$1.prev_layer=()=>NeedContext$1.layers[NeedContext$1.level-1],NeedContext$1.go_back=()=>{if(NeedContext$1.level===0)return;let e=NeedContext$1.prev_layer();NeedContext$1.level-=1;let t={x:e.x,y:e.y,items:e.items,root:e.root};t.compact=NeedContext$1.args.compact,t.autohide=NeedContext$1.args.autohide,t.autoclick=NeedContext$1.args.autoclick,NeedContext$1.show(t)},NeedContext$1.back_button=()=>{let e=document.createElement("div");e.id="needcontext-back",e.classList.add("needcontext-back"),e.classList.add("needcontext-button");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.textContent=NeedContext$1.back_text.trim(),e.append(t),e.append(o),e.title="Shortcut: Backspace",e},NeedContext$1.clear_button=()=>{let e=document.createElement("div");e.id="needcontext-clear",e.classList.add("needcontext-clear"),e.classList.add("needcontext-button"),e.classList.add("needcontext-hidden");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.id="needcontext-clear-text",o.textContent=NeedContext$1.clear_text.trim(),e.append(t),e.append(o),e.title="Type to filter. Click to clear",e},NeedContext$1.action=(e,t)=>{if(e.element&&(!NeedContext$1.is_visible(e.element)||t.target.closest(".needcontext-icon")&&e.icon_action))return;let o=NeedContext$1.args,a=NeedContext$1.args.after_action;if(o.picker_mode){e.element.classList.add("needcontext-picked"),NeedContext$1.filter.focus(),e.picked=!0;let u=!0;for(let l of o.items)if(!l.picked){u=!1;break}u&&NeedContext$1.hide(t)}else NeedContext$1.hide(t);e.action(t),a&&a(t)},NeedContext$1.dismiss=e=>{NeedContext$1.args.after_dismiss&&NeedContext$1.args.after_dismiss(e),NeedContext$1.hide(e)},NeedContext$1.shift_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_shift_action&&NeedContext$1.args.after_shift_action(t),NeedContext$1.hide(t),e.shift_action(t))},NeedContext$1.ctrl_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_ctrl_action&&NeedContext$1.args.after_ctrl_action(t),NeedContext$1.hide(t),e.ctrl_action(t))},NeedContext$1.alt_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_alt_action&&NeedContext$1.args.after_alt_action(t),NeedContext$1.hide(t),e.alt_action(t))},NeedContext$1.middle_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_middle_action&&NeedContext$1.args.after_middle_action(t),NeedContext$1.args.middle_action_remove?NeedContext$1.remove_item(e):NeedContext$1.hide(t),e.middle_action(t))},NeedContext$1.context_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_context_action&&NeedContext$1.args.after_context_action(t),NeedContext$1.hide(t),e.context_action(t))},NeedContext$1.remove_item=e=>{NeedContext$1.select_next("down",!0),e.removed=!0,e.element.remove(),NeedContext$1.update_title()},NeedContext$1.update_title=()=>{let e=document.querySelector("#needcontext-title");if(!e)return;let t=e.querySelector(".needcontext-title-number");if(!t)return;let o=NeedContext$1.count_items();t.textContent=`(${o})`},NeedContext$1.count_items=()=>{let e=NeedContext$1.get_layer().normal_items;return e=e.filter(t=>!t.removed),e=e.filter(t=>!t.fake),e.length},NeedContext$1.create_debouncer=(e,t)=>{let o,a={};function u(){clearTimeout(o),o=void 0}function l(...p){e(...p)}return a.call=(...p)=>{u(),o=setTimeout(()=>{l(...p)},t)},a.call_2=(...p)=>{o||a.call(p)},a.now=(...p)=>{u(),l(...p)},a.cancel=()=>{u()},a},NeedContext$1.reset_debouncers=()=>{NeedContext$1.autohide_debouncer.cancel(),NeedContext$1.autoclick_debouncer.cancel()},NeedContext$1.check_auto_funcs=e=>{if(!NeedContext$1.open||!e.target)return;let t=e.target.id==="needcontext-main";if(t||NeedContext$1.reset_debouncers(),NeedContext$1.args.autohide&&t&&NeedContext$1.autohide_enabled&&NeedContext$1.autohide_debouncer.call_2(e),NeedContext$1.args.autoclick){let o=e.target.closest(".needcontext-item");o||(o=e.target.closest(".needcontext-back")),o&&NeedContext$1.autoclick_debouncer.call(o,e)}},NeedContext$1.check_mouse_range=e=>{if(NeedContext$1.autohide_enabled||e.target.id!=="needcontext-main")return;let t=e.clientX,o=e.clientY;if(NeedContext$1.mouse_activity.initial_x===void 0){NeedContext$1.mouse_activity.initial_x=t,NeedContext$1.mouse_activity.initial_y=o;return}let a=NeedContext$1.container.getBoundingClientRect();function u(l){let p=l>NeedContext$1.autohide_threshold;return p&&(NeedContext$1.autohide_enabled=!0),p}if(o<a.top&&o<NeedContext$1.mouse_activity.initial_y&&o<a.top){let l=a.top-o;if(u(l))return}if(o>a.bottom&&o>NeedContext$1.mouse_activity.initial_y&&o>a.bottom){let l=o-a.bottom;if(u(l))return}if(t<a.left&&t<NeedContext$1.mouse_activity.initial_x&&t<a.left){let l=a.left-t;if(u(l))return}if(t>a.right&&t>NeedContext$1.mouse_activity.initial_x&&t>a.right){let l=t-a.right;if(u(l))return}},NeedContext$1.start_autohide=e=>{NeedContext$1.autohide_debouncer=NeedContext$1.create_debouncer(t=>{NeedContext$1.hide(t)},e||NeedContext$1.autohide_delay)},NeedContext$1.start_autoclick=e=>{NeedContext$1.autoclick_debouncer=NeedContext$1.create_debouncer((t,o)=>{t.closest(".needcontext-item")?NeedContext$1.select_action(o):t.closest(".needcontext-back")&&NeedContext$1.go_back()},e||NeedContext$1.autoclick_delay)},typeof window<"u"&&(window.NeedContext=NeedContext$1),(function(e,t){var o=t(e);typeof module<"u"&&"exports"in module?module.exports=o:typeof define=="function"&&define.amd?define([],function(){return o}):e.jdenticon=o})(typeof self<"u"?self:void 0,function(e){function t(te,se,q){return parseInt(te.substr(se,q),16)}function o(te){return te|=0,te<0?"00":te<16?"0"+te.toString(16):te<256?te.toString(16):"ff"}function a(te,se,q){return q=q<0?q+6:q>6?q-6:q,o(255*(q<1?te+(se-te)*q:q<3?se:q<4?te+(se-te)*(4-q):te))}function u(te){if(/^#[0-9a-f]{3,8}$/i.test(te)){var se,q=te.length;if(q<6){var le=te[1],be=te[2],Me=te[3],ye=te[4]||"";se="#"+le+le+be+be+Me+Me+ye+ye}return(q==7||q>8)&&(se=te),se}}function l(te){var se=t(te,7,2),q;if(isNaN(se))q=te;else{var le=t(te,1,2),be=t(te,3,2),Me=t(te,5,2);q="rgba("+le+","+be+","+Me+","+(se/255).toFixed(2)+")"}return q}function p(te,se,q){var le;if(se==0){var be=o(q*255);le=be+be+be}else{var Me=q<=.5?q*(se+1):q+se-q*se,ye=q*2-Me;le=a(ye,Me,te*6+2)+a(ye,Me,te*6)+a(ye,Me,te*6-2)}return"#"+le}function d(te,se,q){var le=[.55,.5,.5,.46,.6,.55,.55],be=le[te*6+.5|0];return q=q<.5?q*be*2:be+(q-.5)*(1-be)*2,p(te,se,q)}var g=e,f={G:"jdenticon_config",n:"config"},A={};function b(te){A=te}function F(te){return arguments.length&&(A[f.n]=te),A[f.n]}function S(te,se){var q=typeof te=="object"&&te||A[f.n]||g[f.G]||{},le=q.lightness||{},be=q.saturation||{},Me="color"in be?be.color:be,ye=be.grayscale,$e=q.backColor,Ae=q.padding;function De(nt,rt){var je=le[nt];return je&&je.length>1||(je=rt),function(Xe){return Xe=je[0]+Xe*(je[1]-je[0]),Xe<0?0:Xe>1?1:Xe}}function Ne(nt){var rt=q.hues,je;return rt&&rt.length>0&&(je=rt[0|.999*nt*rt.length]),typeof je=="number"?(je/360%1+1)%1:nt}return{X:Ne,p:typeof Me=="number"?Me:.5,H:typeof ye=="number"?ye:0,q:De("color",[.4,.8]),I:De("grayscale",[.3,.9]),J:u($e),Y:typeof te=="number"?te:typeof Ae=="number"?Ae:se}}var k=1,$=2,R={t:"data-jdenticon-hash",o:"data-jdenticon-value"},I="["+R.t+"],["+R.o+"]",z=typeof document<"u"&&document.querySelectorAll.bind(document);function ie(te){if(te){var se=te.tagName;if(/^svg$/i.test(se))return k;if(/^canvas$/i.test(se)&&"getContext"in te)return $}}function U(te){if(typeof MutationObserver<"u"){var se=new MutationObserver(function(le){for(var be=0;be<le.length;be++){for(var Me=le[be],ye=Me.addedNodes,$e=0;ye&&$e<ye.length;$e++){var Ae=ye[$e];if(Ae.nodeType==1)if(ie(Ae))te(Ae);else for(var De=Ae.querySelectorAll(I),Ne=0;Ne<De.length;Ne++)te(De[Ne])}Me.type=="attributes"&&ie(Me.target)&&te(Me.target)}});se.observe(document.body,{childList:!0,attributes:!0,attributeFilter:[R.o,R.t,"width","height"],subtree:!0})}}function O(te,se){this.x=te,this.y=se}function ee(te,se,q,le){this.u=te,this.v=se,this.K=q,this.Z=le}ee.prototype.L=function(se,q,le,be){var Me=this.u+this.K,ye=this.v+this.K,$e=this.Z;return $e===1?new O(Me-q-(be||0),this.v+se):$e===2?new O(Me-se-(le||0),ye-q-(be||0)):$e===3?new O(this.u+q,ye-se-(le||0)):new O(this.u+se,this.v+q)};var re=new ee(0,0,0,0);function oe(te){this.M=te,this.A=re}var _e=oe.prototype;_e.g=function(se,q){for(var le=this,be=q?-2:2,Me=[],ye=q?se.length-2:0;ye<se.length&&ye>=0;ye+=be)Me.push(le.A.L(se[ye],se[ye+1]));this.M.g(Me)},_e.h=function(se,q,le,be){var Me=this.A.L(se,q,le,le);this.M.h(Me,le,be)},_e.i=function(se,q,le,be,Me){this.g([se,q,se+le,q,se+le,q+be,se,q+be],Me)},_e.j=function(se,q,le,be,Me,ye){var $e=[se+le,q,se+le,q+be,se,q+be,se,q];$e.splice((Me||0)%4*2,2),this.g($e,ye)},_e.N=function(se,q,le,be,Me){this.g([se+le/2,q,se+le,q+be/2,se+le/2,q+be,se,q+be/2],Me)};function ue(te,se,q,le){te=te%14;var be,Me,ye,$e,Ae,De;te?te==1?(ye=0|q*.5,$e=0|q*.8,se.j(q-ye,0,ye,$e,2)):te==2?(ye=0|q/3,se.i(ye,ye,q-ye,q-ye)):te==3?(Ae=q*.1,De=q<6?1:q<8?2:0|q*.25,Ae=Ae>1?0|Ae:Ae>.5?1:Ae,se.i(De,De,q-Ae-De,q-Ae-De)):te==4?(Me=0|q*.15,ye=0|q*.5,se.h(q-ye-Me,q-ye-Me,ye)):te==5?(Ae=q*.1,De=Ae*4,De>3&&(De=0|De),se.i(0,0,q,q),se.g([De,De,q-Ae,De,De+(q-De-Ae)/2,q-Ae],!0)):te==6?se.g([0,0,q,0,q,q*.7,q*.4,q*.4,q*.7,q,0,q]):te==7?se.j(q/2,q/2,q/2,q/2,3):te==8?(se.i(0,0,q,q/2),se.i(0,q/2,q/2,q/2),se.j(q/2,q/2,q/2,q/2,1)):te==9?(Ae=q*.14,De=q<4?1:q<6?2:0|q*.35,Ae=q<8?Ae:0|Ae,se.i(0,0,q,q),se.i(De,De,q-De-Ae,q-De-Ae,!0)):te==10?(Ae=q*.12,De=Ae*3,se.i(0,0,q,q),se.h(De,De,q-Ae-De,!0)):te==11?se.j(q/2,q/2,q/2,q/2,3):te==12?(Me=q*.25,se.i(0,0,q,q),se.N(Me,Me,q-Me,q-Me,!0)):!le&&(Me=q*.4,ye=q*1.2,se.h(Me,Me,ye)):(be=q*.42,se.g([0,0,q,0,q,q-be*2,q-be,q,0,q]))}function Ce(te,se,q){te=te%4;var le;te?te==1?se.j(0,q/2,q,q/2,0):te==2?se.N(0,0,q,q):(le=q/6,se.h(le,le,q-2*le)):se.j(0,0,q,q,0)}function me(te,se){return te=se.X(te),[d(te,se.H,se.I(0)),d(te,se.p,se.q(.5)),d(te,se.H,se.I(1)),d(te,se.p,se.q(1)),d(te,se.p,se.q(0))]}function he(te,se,q){var le=S(q,.08);le.J&&te.m(le.J);var be=te.k,Me=.5+be*le.Y|0;be-=Me*2;var ye=new oe(te),$e=0|be/4,Ae=0|Me+be/2-$e*2,De=0|Me+be/2-$e*2;function Ne(ft,ht,Ge,Ze,Ke){var tt=t(se,Ge,1),mt=Ze?t(se,Ze,1):0;te.O(rt[je[ft]]);for(var bt=0;bt<Ke.length;bt++)ye.A=new ee(Ae+Ke[bt][0]*$e,De+Ke[bt][1]*$e,$e,mt++%4),ht(tt,ye,$e,bt);te.P()}var nt=t(se,-7)/268435455,rt=me(nt,le),je=[],Xe;function ct(ft){if(ft.indexOf(Xe)>=0){for(var ht=0;ht<ft.length;ht++)if(je.indexOf(ft[ht])>=0)return!0}}for(var Re=0;Re<3;Re++)Xe=t(se,8+Re,1)%rt.length,(ct([0,4])||ct([2,3]))&&(Xe=1),je.push(Xe);Ne(0,Ce,2,3,[[1,0],[2,0],[2,3],[1,3],[0,1],[3,1],[3,2],[0,2]]),Ne(1,Ce,4,5,[[0,0],[3,0],[3,3],[0,3]]),Ne(2,ue,1,null,[[1,1],[2,1],[2,2],[1,2]]),te.finish()}function ve(te){var se=40,q=16,le=0,be=0,Me=encodeURI(te)+"%80",ye=[],$e,Ae=[],De=1732584193,Ne=4023233417,nt=~De,rt=~Ne,je=3285377520,Xe=[De,Ne,nt,rt,je],ct=0,Re="";function ft(ht,Ge){return ht<<Ge|ht>>>32-Ge}for(;le<Me.length;be++)ye[be>>2]=ye[be>>2]|(Me[le]=="%"?parseInt(Me.substring(le+1,le+=3),16):Me.charCodeAt(le++))<<(3-(be&3))*8;for($e=((be+7>>6)+1)*q,ye[$e-1]=be*8-8;ct<$e;ct+=q){for(le=0;le<80;le++)be=ft(De,5)+je+(le<20?(Ne&nt^~Ne&rt)+1518500249:le<40?(Ne^nt^rt)+1859775393:le<60?(Ne&nt^Ne&rt^nt&rt)+2400959708:(Ne^nt^rt)+3395469782)+(Ae[le]=le<q?ye[ct+le]|0:ft(Ae[le-3]^Ae[le-8]^Ae[le-14]^Ae[le-16],1)),je=rt,rt=nt,nt=ft(Ne,30),Ne=De,De=be;Xe[0]=De=Xe[0]+De|0,Xe[1]=Ne=Xe[1]+Ne|0,Xe[2]=nt=Xe[2]+nt|0,Xe[3]=rt=Xe[3]+rt|0,Xe[4]=je=Xe[4]+je|0}for(le=0;le<se;le++)Re+=(Xe[le>>3]>>>(7-(le&7))*4&15).toString(16);return Re}function Fe(te){return/^[0-9a-f]{11,}$/i.test(te)&&te}function Se(te){return ve(te==null?"":""+te)}function Ee(te,se){var q=te.canvas,le=q.width,be=q.height;te.save(),se||(se=Math.min(le,be),te.translate((le-se)/2|0,(be-se)/2|0)),this.l=te,this.k=se,te.clearRect(0,0,se,se)}var Pe=Ee.prototype;Pe.m=function(se){var q=this.l,le=this.k;q.fillStyle=l(se),q.fillRect(0,0,le,le)},Pe.O=function(se){var q=this.l;q.fillStyle=l(se),q.beginPath()},Pe.P=function(){this.l.fill()},Pe.g=function(se){var q=this.l;q.moveTo(se[0].x,se[0].y);for(var le=1;le<se.length;le++)q.lineTo(se[le].x,se[le].y);q.closePath()},Pe.h=function(se,q,le){var be=this.l,Me=q/2;be.moveTo(se.x+Me,se.y+Me),be.arc(se.x+Me,se.y+Me,Me,0,Math.PI*2,le),be.closePath()},Pe.finish=function(){this.l.restore()};function Ye(te,se,q,le){if(!te)throw new Error("No canvas specified.");he(new Ee(te,q),Fe(se)||Se(se),le)}function He(te){return(te*10+.5|0)/10}function et(){this.B=""}var de=et.prototype;de.g=function(se){for(var q="",le=0;le<se.length;le++)q+=(le?"L":"M")+He(se[le].x)+" "+He(se[le].y);this.B+=q+"Z"},de.h=function(se,q,le){var be=le?0:1,Me=He(q/2),ye=He(q),$e="a"+Me+","+Me+" 0 1,"+be+" ";this.B+="M"+He(se.x)+" "+He(se.y+q/2)+$e+ye+",0"+$e+-ye+",0"};function Le(te){this.C,this.D={},this.R=te,this.k=te.k}var ot=Le.prototype;ot.m=function(se){var q=/^(#......)(..)?/.exec(se),le=q[2]?t(q[2],0)/255:1;this.R.m(q[1],le)},ot.O=function(se){this.C=this.D[se]||(this.D[se]=new et)},ot.P=function(){},ot.g=function(se){this.C.g(se)},ot.h=function(se,q,le){this.C.h(se,q,le)},ot.finish=function(){var se=this,q=this.D;for(var le in q)q.hasOwnProperty(le)&&se.R.S(le,q[le].B)};var Ve={T:"http://www.w3.org/2000/svg",U:"width",V:"height"};function Oe(te){this.k=te,this.F='<svg xmlns="'+Ve.T+'" width="'+te+'" height="'+te+'" viewBox="0 0 '+te+" "+te+'">'}var Je=Oe.prototype;Je.m=function(se,q){q&&(this.F+='<rect width="100%" height="100%" fill="'+se+'" opacity="'+q.toFixed(2)+'"/>')},Je.S=function(se,q){this.F+='<path fill="'+se+'" d="'+q+'"/>'},Je.toString=function(){return this.F+"</svg>"};function We(te,se,q){var le=new Oe(se);return he(new Le(le),Fe(te)||Se(te),q),le.toString()}function qe(te,se){for(var q=[],le=arguments.length-2;le-- >0;)q[le]=arguments[le+2];for(var be=document.createElementNS(Ve.T,se),Me=0;Me+1<q.length;Me+=2)be.setAttribute(q[Me],q[Me+1]);te.appendChild(be)}function yt(te){var se=this.k=Math.min(Number(te.getAttribute(Ve.U))||100,Number(te.getAttribute(Ve.V))||100);for(this.W=te;te.firstChild;)te.removeChild(te.firstChild);te.setAttribute("viewBox","0 0 "+se+" "+se),te.setAttribute("preserveAspectRatio","xMidYMid meet")}var pt=yt.prototype;pt.m=function(se,q){q&&qe(this.W,"rect",Ve.U,"100%",Ve.V,"100%","fill",se,"opacity",q)},pt.S=function(se,q){qe(this.W,"path","fill",se,"d",q)};function Qe(){z&&At(I)}function At(te,se,q){it(te,se,q,function(le,be){if(be)return be==k?new Le(new yt(le)):new Ee(le.getContext("2d"))})}function it(te,se,q,le){if(typeof te=="string"){if(z)for(var be=z(te),Me=0;Me<be.length;Me++)it(be[Me],se,q,le);return}var ye=Fe(se)||se!=null&&Se(se)||Fe(te.getAttribute(R.t))||te.hasAttribute(R.o)&&Se(te.getAttribute(R.o));if(ye){var $e=le(te,ie(te));$e&&he($e,ye,q)}}function vt(te,se){return this.each(function(q,le){At(le,te,se)}),this}var at=Qe;b(at),at.configure=F,at.drawIcon=Ye,at.toSvg=We,at.update=At,at.updateCanvas=At,at.updateSvg=At,at.version="3.1.1",at.bundle="browser-umd";var Ct=g.jQuery;Ct&&(Ct.fn.jdenticon=vt);function Mt(){var te=(at[f.n]||g[f.G]||{}).replaceMode;te!="never"&&(Qe(),te=="observe"&&U(At))}return typeof setTimeout=="function"&&setTimeout(Mt,0),at}),(function(){let e=window.AudioContext||window.webkitAudioContext;function t(a,u=3,l=2){let p=a.sampleRate,d=p*u,g=a.createBuffer(2,d,p),f=g.getChannelData(0),A=g.getChannelData(1);for(let b=0;b<d;b++){let F=b/d,S=Math.pow(1-F,l);f[b]=(Math.random()*2-1)*S,A[b]=(Math.random()*2-1)*S}return g}class o extends e{constructor(...u){super(...u);let l=this;const p=!window.master_fx;console.log(p?"Intercepted MAIN AudioContext (Seamless Reverb Mode)":"Intercepted SECONDARY AudioContext");let d=l.createBiquadFilter();d.type="lowshelf",d.frequency.value=320,d.gain.value=0;let g=l.createBiquadFilter();g.type="peaking",g.frequency.value=1e3,g.Q.value=1,g.gain.value=0;let f=l.createBiquadFilter();f.type="highshelf",f.frequency.value=4e3,f.gain.value=0,App.panning=l.createStereoPanner(),App.panning.pan.value=0;let A=l.createConvolver();A.buffer=t(l);let b=l.createGain();b.gain.value=0;let F=l.createGain();if(F.gain.value=1,d.connect(g),g.connect(f),f.connect(App.panning),App.panning.connect(F),F.connect(super.destination),Object.defineProperty(d,"maxChannelCount",{get:()=>super.destination.maxChannelCount}),Object.defineProperty(l,"destination",{get:()=>d,configurable:!0}),p){let S={timer:null,is_connected:!1};window.master_fx={context:l,nodes:{eq_low:d,eq_mid:g,eq_high:f,panner:App.panning,reverb_gain:b,master_gain:F},set_eq:(k,$,R)=>{let I=l.currentTime,z=.1;k!==void 0&&d.gain.setTargetAtTime(k,I,z),$!==void 0&&g.gain.setTargetAtTime($,I,z),R!==void 0&&f.gain.setTargetAtTime(R,I,z)},set_volume:k=>{F.gain.setTargetAtTime(k,l.currentTime,.1)},set_panning:k=>{App.panning.pan.setTargetAtTime(k,l.currentTime,.1)},splash_reverb:(k=3)=>{let $=l.currentTime,R=.1,I=.5,z=.5;S.timer&&(clearTimeout(S.timer),S.timer=null),b.gain.cancelScheduledValues($),S.is_connected||(App.panning.connect(A),A.connect(b),b.connect(F),b.gain.setValueAtTime(0,$),S.is_connected=!0,console.log("Reverb Connected")),b.gain.linearRampToValueAtTime(z,$+R);let ie=$+k;b.gain.setValueAtTime(z,ie),b.gain.linearRampToValueAtTime(0,ie+I),S.timer=setTimeout(()=>{b.disconnect(),A.disconnect(),S.is_connected=!1,console.log("Reverb Disconnected (Clean)")},(k+I)*1e3+100)}}}}}window.AudioContext=o,window.webkitAudioContext&&(window.webkitAudioContext=o)})(),typeof globalThis.process>"u"&&(globalThis.process={env:{}}),typeof globalThis.process.env>"u"&&(globalThis.process.env={}),typeof globalThis.process.env.NODE_ENV>"u"&&(globalThis.process.env.NODE_ENV="production");function peg$subclass(e,t){function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o}function peg$SyntaxError(e,t,o,a){var u=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(u,peg$SyntaxError.prototype),u.expected=t,u.found=o,u.location=a,u.name="SyntaxError",u}peg$subclass(peg$SyntaxError,Error);function peg$padEnd(e,t,o){return o=o||" ",e.length>t?e:(t-=e.length,o+=o.repeat(t),e+o.slice(0,t))}peg$SyntaxError.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var o=null,a;for(a=0;a<e.length;a++)if(e[a].source===this.location.source){o=e[a].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,l=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(u):u,p=this.location.source+":"+l.line+":"+l.column;if(o){var d=this.location.end,g=peg$padEnd("",l.line.toString().length," "),f=o[u.line-1],A=u.line===d.line?d.column:f.length+1,b=A-u.column||1;t+=`
 --> `+p+`
`+g+` |
`+l.line+" | "+f+`
`+g+" | "+peg$padEnd("",u.column-1," ")+peg$padEnd("",b,"^")}else t+=`
 at `+p}return t},peg$SyntaxError.buildMessage=function(e,t){var o={literal:function(f){return'"'+u(f.text)+'"'},class:function(f){var A=f.parts.map(function(b){return Array.isArray(b)?l(b[0])+"-"+l(b[1]):l(b)});return"["+(f.inverted?"^":"")+A.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(f){return f.description}};function a(f){return f.charCodeAt(0).toString(16).toUpperCase()}function u(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+a(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+a(A)})}function l(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+a(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+a(A)})}function p(f){return o[f.type](f)}function d(f){var A=f.map(p),b,F;if(A.sort(),A.length>0){for(b=1,F=1;b<A.length;b++)A[b-1]!==A[b]&&(A[F]=A[b],F++);A.length=F}switch(A.length){case 1:return A[0];case 2:return A[0]+" or "+A[1];default:return A.slice(0,-1).join(", ")+", or "+A[A.length-1]}}function g(f){return f?'"'+u(f)+'"':"end of input"}return"Expected "+d(e)+" but "+g(t)+" found."};function peg$parse(e,t){t=t!==void 0?t:{};var o={},a=t.grammarSource,u={start:rn},l=rn,p=".",d="-",g="0",f=",",A="|",b="[",F="]",S="{",k="}",$="%",R="<",I=">",z="!",ie="(",U=")",O="/",ee="*",re="?",oe=":",_e="..",ue="^",Ce="struct",me="target",he="euclid",ve="slow",Fe="rotL",Se="rotR",Ee="fast",Pe="scale",Ye="//",He="cat",et="$",de="setcps",Le="setbpm",ot="hush",Ve=/^[1-9]/,Oe=/^[eE]/,Je=/^[+\-]/,We=/^[0-9]/,qe=/^[ \n\r\t\xA0]/,yt=/^["']/,pt=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Qe=/^[@_]/,At=/^[^\n]/,it=Ht("number"),vt=Ue(".",!1),at=Et([["1","9"]],!1,!1),Ct=Et(["e","E"],!1,!1),Mt=Et(["+","-"],!1,!1),te=Ue("-",!1),se=Ue("0",!1),q=Et([["0","9"]],!1,!1),le=Ht("whitespace"),be=Et([" ",`
`,"\r","	"," "],!1,!1),Me=Ue(",",!1),ye=Ue("|",!1),$e=Et(['"',"'"],!1,!1),Ae=Ht('a letter, a number, "-", "#", ".", "^", "_"'),De=Et(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),Ne=Ue("[",!1),nt=Ue("]",!1),rt=Ue("{",!1),je=Ue("}",!1),Xe=Ue("%",!1),ct=Ue("<",!1),Re=Ue(">",!1),ft=Et(["@","_"],!1,!1),ht=Ue("!",!1),Ge=Ue("(",!1),Ze=Ue(")",!1),Ke=Ue("/",!1),tt=Ue("*",!1),mt=Ue("?",!1),bt=Ue(":",!1),Pt=Ue("..",!1),M=Ue("^",!1),B=Ue("struct",!1),N=Ue("target",!1),L=Ue("euclid",!1),Z=Ue("slow",!1),ae=Ue("rotL",!1),fe=Ue("rotR",!1),ge=Ue("fast",!1),xe=Ue("scale",!1),ze=Ue("//",!1),ut=Et([`
`],!0,!1),Dt=Ue("cat",!1),kt=Ue("$",!1),Ot=Ue("setcps",!1),Wt=Ue("setbpm",!1),xt=Ue("hush",!1),dn=function(){return parseFloat(qn())},fn=function(E){const V=E.join("");return V==="."||V==="_"},hn=function(E){return new zr(E.join(""))},mn=function(E){return E},_n=function(E,V){return E.arguments_.stepsPerCycle=V,E},gn=function(E){return E},yn=function(E){return E.arguments_.alignment="polymeter_slowcat",E},An=function(E){return V=>V.options_.weight=(V.options_.weight??1)+(E??2)-1},bn=function(E){return V=>{const K=(V.options_.reps??1)+(E??2)-1;V.options_.reps=K,V.options_.ops=V.options_.ops.filter(pe=>pe.type_!=="replicate"),V.options_.ops.push({type_:"replicate",arguments_:{amount:K}}),V.options_.weight=K}},Cn=function(E,V,K){return pe=>pe.options_.ops.push({type_:"bjorklund",arguments_:{pulse:E,step:V,rotation:K}})},vn=function(E){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:E,type:"slow"}})},Mn=function(E){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:E,type:"fast"}})},Pn=function(E){return V=>V.options_.ops.push({type_:"degradeBy",arguments_:{amount:E,seed:Qt++}})},xn=function(E){return V=>V.options_.ops.push({type_:"tail",arguments_:{element:E}})},Sn=function(E){return V=>V.options_.ops.push({type_:"range",arguments_:{element:E}})},Fn=function(E,V){const K=new Ur(E,{ops:[],weight:1,reps:1});for(const pe of V)pe(K);return K},Dn=function(E,V){return new Yt(V,"fastcat",void 0,!!E)},En=function(E){return{alignment:"stack",list:E}},wn=function(E){return{alignment:"rand",list:E,seed:Qt++}},Gn=function(E){return{alignment:"feet",list:E,seed:Qt++}},kn=function(E,V){return V&&V.list.length>0?new Yt([E,...V.list],V.alignment,V.seed):E},$n=function(E,V){return new Yt(V?[E,...V.list]:[E],"polymeter")},Nn=function(E){return E},Tn=function(E){return{name:"struct",args:{mini:E}}},Rn=function(E){return{name:"target",args:{name:E}}},Bn=function(E,V,K){return{name:"bjorklund",args:{pulse:E,step:parseInt(V)}}},Ln=function(E){return{name:"stretch",args:{amount:E}}},In=function(E){return{name:"shift",args:{amount:"-"+E}}},Vn=function(E){return{name:"shift",args:{amount:E}}},Xn=function(E){return{name:"stretch",args:{amount:"1/"+E}}},Zn=function(E){return{name:"scale",args:{scale:E.join("")}}},en=function(E,V){return V},On=function(E,V){return V.unshift(E),new Yt(V,"slowcat")},Wn=function(E){return E},zn=function(E,V){return new jr(E.name,E.args,V)},jn=function(E){return E},Un=function(E){return E},Yn=function(E){return new Jt("setcps",{value:E})},Hn=function(E){return new Jt("setcps",{value:E/120/2})},Kn=function(){return new Jt("hush")},j=t.peg$currPos|0,Ie=j,Nt=[{line:1,column:1}],St=j,zt=t.peg$maxFailExpected||[],we=t.peg$silentFails|0,Xt;if(t.startRule){if(!(t.startRule in u))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');l=u[t.startRule]}function qn(){return e.substring(Ie,j)}function tn(){return Kt(Ie,j)}function Ue(E,V){return{type:"literal",text:E,ignoreCase:V}}function Et(E,V,K){return{type:"class",parts:E,inverted:V,ignoreCase:K}}function Jn(){return{type:"end"}}function Ht(E){return{type:"other",description:E}}function nn(E){var V=Nt[E],K;if(V)return V;if(E>=Nt.length)K=Nt.length-1;else for(K=E;!Nt[--K];);for(V=Nt[K],V={line:V.line,column:V.column};K<E;)e.charCodeAt(K)===10?(V.line++,V.column=1):V.column++,K++;return Nt[E]=V,V}function Kt(E,V,K){var pe=nn(E),ke=nn(V),st={source:a,start:{offset:E,line:pe.line,column:pe.column},end:{offset:V,line:ke.line,column:ke.column}};return st}function Te(E){j<St||(j>St&&(St=j,zt=[]),zt.push(E))}function Qn(E,V,K){return new peg$SyntaxError(peg$SyntaxError.buildMessage(E,V),E,V,K)}function rn(){var E;return E=Wr(),E}function Gt(){var E,V;return we++,E=j,lr(),V=jt(),V!==o?(ur(),sr(),Ie=E,E=dn()):(j=E,E=o),we--,E===o&&we===0&&Te(it),E}function er(){var E;return e.charCodeAt(j)===46?(E=p,j++):(E=o,we===0&&Te(vt)),E}function nr(){var E;return E=e.charAt(j),Ve.test(E)?j++:(E=o,we===0&&Te(at)),E}function rr(){var E;return E=e.charAt(j),Oe.test(E)?j++:(E=o,we===0&&Te(Ct)),E}function sr(){var E,V,K,pe,ke;if(E=j,V=rr(),V!==o){if(K=e.charAt(j),Je.test(K)?j++:(K=o,we===0&&Te(Mt)),K===o&&(K=null),pe=[],ke=Tt(),ke!==o)for(;ke!==o;)pe.push(ke),ke=Tt();else pe=o;pe!==o?(V=[V,K,pe],E=V):(j=E,E=o)}else j=E,E=o;return E}function ur(){var E,V,K,pe;if(E=j,V=er(),V!==o){if(K=[],pe=Tt(),pe!==o)for(;pe!==o;)K.push(pe),pe=Tt();else K=o;K!==o?(V=[V,K],E=V):(j=E,E=o)}else j=E,E=o;return E}function jt(){var E,V,K,pe;if(E=cr(),E===o)if(E=j,V=nr(),V!==o){for(K=[],pe=Tt();pe!==o;)K.push(pe),pe=Tt();V=[V,K],E=V}else j=E,E=o;return E}function lr(){var E;return e.charCodeAt(j)===45?(E=d,j++):(E=o,we===0&&Te(te)),E}function cr(){var E;return e.charCodeAt(j)===48?(E=g,j++):(E=o,we===0&&Te(se)),E}function Tt(){var E;return E=e.charAt(j),We.test(E)?j++:(E=o,we===0&&Te(q)),E}function Be(){var E,V;for(we++,E=[],V=e.charAt(j),qe.test(V)?j++:(V=o,we===0&&Te(be));V!==o;)E.push(V),V=e.charAt(j),qe.test(V)?j++:(V=o,we===0&&Te(be));return we--,V=o,we===0&&Te(le),E}function Rt(){var E,V,K,pe;return E=j,V=Be(),e.charCodeAt(j)===44?(K=f,j++):(K=o,we===0&&Te(Me)),K!==o?(pe=Be(),V=[V,K,pe],E=V):(j=E,E=o),E}function sn(){var E,V,K,pe;return E=j,V=Be(),e.charCodeAt(j)===124?(K=A,j++):(K=o,we===0&&Te(ye)),K!==o?(pe=Be(),V=[V,K,pe],E=V):(j=E,E=o),E}function on(){var E,V,K,pe;return E=j,V=Be(),e.charCodeAt(j)===46?(K=p,j++):(K=o,we===0&&Te(vt)),K!==o?(pe=Be(),V=[V,K,pe],E=V):(j=E,E=o),E}function Bt(){var E;return E=e.charAt(j),yt.test(E)?j++:(E=o,we===0&&Te($e)),E}function Ut(){var E;return we++,E=e.charAt(j),pt.test(E)?j++:(E=o,we===0&&Te(De)),we--,E===o&&we===0&&Te(Ae),E}function an(){var E,V,K,pe;if(E=j,Be(),V=[],K=Ut(),K!==o)for(;K!==o;)V.push(K),K=Ut();else V=o;return V!==o?(K=Be(),Ie=j,pe=fn(V),pe?pe=o:pe=void 0,pe!==o?(Ie=E,E=hn(V)):(j=E,E=o)):(j=E,E=o),E}function dr(){var E,V,K,pe;return E=j,Be(),e.charCodeAt(j)===91?(V=b,j++):(V=o,we===0&&Te(Ne)),V!==o?(Be(),K=cn(),K!==o?(Be(),e.charCodeAt(j)===93?(pe=F,j++):(pe=o,we===0&&Te(nt)),pe!==o?(Be(),Ie=E,E=mn(K)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function fr(){var E,V,K,pe,ke;return E=j,Be(),e.charCodeAt(j)===123?(V=S,j++):(V=o,we===0&&Te(rt)),V!==o?(Be(),K=pn(),K!==o?(Be(),e.charCodeAt(j)===125?(pe=k,j++):(pe=o,we===0&&Te(je)),pe!==o?(ke=hr(),ke===o&&(ke=null),Be(),Ie=E,E=_n(K,ke)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function hr(){var E,V,K;return E=j,e.charCodeAt(j)===37?(V=$,j++):(V=o,we===0&&Te(Xe)),V!==o?(K=Lt(),K!==o?(Ie=E,E=gn(K)):(j=E,E=o)):(j=E,E=o),E}function mr(){var E,V,K,pe;return E=j,Be(),e.charCodeAt(j)===60?(V=R,j++):(V=o,we===0&&Te(ct)),V!==o?(Be(),K=pn(),K!==o?(Be(),e.charCodeAt(j)===62?(pe=I,j++):(pe=o,we===0&&Te(Re)),pe!==o?(Be(),Ie=E,E=yn(K)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function Lt(){var E;return E=an(),E===o&&(E=dr(),E===o&&(E=fr(),E===o&&(E=mr()))),E}function un(){var E;return E=_r(),E===o&&(E=yr(),E===o&&(E=Ar(),E===o&&(E=br(),E===o&&(E=gr(),E===o&&(E=Cr(),E===o&&(E=vr(),E===o&&(E=Mr()))))))),E}function _r(){var E,V,K;return E=j,Be(),V=e.charAt(j),Qe.test(V)?j++:(V=o,we===0&&Te(ft)),V!==o?(K=Gt(),K===o&&(K=null),Ie=E,E=An(K)):(j=E,E=o),E}function gr(){var E,V,K;return E=j,Be(),e.charCodeAt(j)===33?(V=z,j++):(V=o,we===0&&Te(ht)),V!==o?(K=Gt(),K===o&&(K=null),Ie=E,E=bn(K)):(j=E,E=o),E}function yr(){var E,V,K,pe,ke,st,Ft;return E=j,e.charCodeAt(j)===40?(V=ie,j++):(V=o,we===0&&Te(Ge)),V!==o?(Be(),K=Zt(),K!==o?(Be(),pe=Rt(),pe!==o?(Be(),ke=Zt(),ke!==o?(Be(),Rt(),Be(),st=Zt(),st===o&&(st=null),Be(),e.charCodeAt(j)===41?(Ft=U,j++):(Ft=o,we===0&&Te(Ze)),Ft!==o?(Ie=E,E=Cn(K,ke,st)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function Ar(){var E,V,K;return E=j,e.charCodeAt(j)===47?(V=O,j++):(V=o,we===0&&Te(Ke)),V!==o?(K=Lt(),K!==o?(Ie=E,E=vn(K)):(j=E,E=o)):(j=E,E=o),E}function br(){var E,V,K;return E=j,e.charCodeAt(j)===42?(V=ee,j++):(V=o,we===0&&Te(tt)),V!==o?(K=Lt(),K!==o?(Ie=E,E=Mn(K)):(j=E,E=o)):(j=E,E=o),E}function Cr(){var E,V,K;return E=j,e.charCodeAt(j)===63?(V=re,j++):(V=o,we===0&&Te(mt)),V!==o?(K=Gt(),K===o&&(K=null),Ie=E,E=Pn(K)):(j=E,E=o),E}function vr(){var E,V,K;return E=j,e.charCodeAt(j)===58?(V=oe,j++):(V=o,we===0&&Te(bt)),V!==o?(K=Lt(),K!==o?(Ie=E,E=xn(K)):(j=E,E=o)):(j=E,E=o),E}function Mr(){var E,V,K;return E=j,e.substr(j,2)===_e?(V=_e,j+=2):(V=o,we===0&&Te(Pt)),V!==o?(K=Lt(),K!==o?(Ie=E,E=Sn(K)):(j=E,E=o)):(j=E,E=o),E}function Zt(){var E,V,K,pe;if(E=j,V=Lt(),V!==o){for(K=[],pe=un();pe!==o;)K.push(pe),pe=un();Ie=E,E=Fn(V,K)}else j=E,E=o;return E}function $t(){var E,V,K,pe;if(E=j,e.charCodeAt(j)===94?(V=ue,j++):(V=o,we===0&&Te(M)),V===o&&(V=null),K=[],pe=Zt(),pe!==o)for(;pe!==o;)K.push(pe),pe=Zt();else K=o;return K!==o?(Ie=E,E=Dn(V,K)):(j=E,E=o),E}function ln(){var E,V,K,pe,ke;if(E=j,V=[],K=j,pe=Rt(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o),K!==o)for(;K!==o;)V.push(K),K=j,pe=Rt(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o);else V=o;return V!==o&&(Ie=E,V=En(V)),E=V,E}function Pr(){var E,V,K,pe,ke;if(E=j,V=[],K=j,pe=sn(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o),K!==o)for(;K!==o;)V.push(K),K=j,pe=sn(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o);else V=o;return V!==o&&(Ie=E,V=wn(V)),E=V,E}function xr(){var E,V,K,pe,ke;if(E=j,V=[],K=j,pe=on(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o),K!==o)for(;K!==o;)V.push(K),K=j,pe=on(),pe!==o?(ke=$t(),ke!==o?K=ke:(j=K,K=o)):(j=K,K=o);else V=o;return V!==o&&(Ie=E,V=Gn(V)),E=V,E}function cn(){var E,V,K;return E=j,V=$t(),V!==o?(K=ln(),K===o&&(K=Pr(),K===o&&(K=xr())),K===o&&(K=null),Ie=E,E=kn(V,K)):(j=E,E=o),E}function pn(){var E,V,K;return E=j,V=$t(),V!==o?(K=ln(),K===o&&(K=null),Ie=E,E=$n(V,K)):(j=E,E=o),E}function Sr(){var E,V,K,pe;return E=j,Be(),V=Bt(),V!==o?(Be(),K=cn(),K!==o?(Be(),pe=Bt(),pe!==o?(Ie=E,E=Nn(K)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function Fr(){var E;return E=Tr(),E===o&&(E=Gr(),E===o&&(E=Nr(),E===o&&(E=Er(),E===o&&(E=wr(),E===o&&(E=Dr(),E===o&&(E=$r(),E===o&&(E=kr()))))))),E}function Dr(){var E,V,K;return E=j,e.substr(j,6)===Ce?(V=Ce,j+=6):(V=o,we===0&&Te(B)),V!==o?(Be(),K=It(),K!==o?(Ie=E,E=Tn(K)):(j=E,E=o)):(j=E,E=o),E}function Er(){var E,V,K,pe,ke;return E=j,e.substr(j,6)===me?(V=me,j+=6):(V=o,we===0&&Te(N)),V!==o?(Be(),K=Bt(),K!==o?(pe=an(),pe!==o?(ke=Bt(),ke!==o?(Ie=E,E=Rn(pe)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function wr(){var E,V,K,pe;return E=j,e.substr(j,6)===he?(V=he,j+=6):(V=o,we===0&&Te(L)),V!==o?(Be(),K=jt(),K!==o?(Be(),pe=jt(),pe!==o?(Be(),jt(),Ie=E,E=Bn(K,pe)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o),E}function Gr(){var E,V,K;return E=j,e.substr(j,4)===ve?(V=ve,j+=4):(V=o,we===0&&Te(Z)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=Ln(K)):(j=E,E=o)):(j=E,E=o),E}function kr(){var E,V,K;return E=j,e.substr(j,4)===Fe?(V=Fe,j+=4):(V=o,we===0&&Te(ae)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=In(K)):(j=E,E=o)):(j=E,E=o),E}function $r(){var E,V,K;return E=j,e.substr(j,4)===Se?(V=Se,j+=4):(V=o,we===0&&Te(fe)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=Vn(K)):(j=E,E=o)):(j=E,E=o),E}function Nr(){var E,V,K;return E=j,e.substr(j,4)===Ee?(V=Ee,j+=4):(V=o,we===0&&Te(ge)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=Xn(K)):(j=E,E=o)):(j=E,E=o),E}function Tr(){var E,V,K,pe,ke;if(E=j,e.substr(j,5)===Pe?(V=Pe,j+=5):(V=o,we===0&&Te(xe)),V!==o)if(Be(),K=Bt(),K!==o){if(pe=[],ke=Ut(),ke!==o)for(;ke!==o;)pe.push(ke),ke=Ut();else pe=o;pe!==o?(ke=Bt(),ke!==o?(Ie=E,E=Zn(pe)):(j=E,E=o)):(j=E,E=o)}else j=E,E=o;else j=E,E=o;return E}function qt(){var E,V,K,pe;if(E=j,e.substr(j,2)===Ye?(V=Ye,j+=2):(V=o,we===0&&Te(ze)),V!==o){for(K=[],pe=e.charAt(j),At.test(pe)?j++:(pe=o,we===0&&Te(ut));pe!==o;)K.push(pe),pe=e.charAt(j),At.test(pe)?j++:(pe=o,we===0&&Te(ut));V=[V,K],E=V}else j=E,E=o;return E}function Rr(){var E,V,K,pe,ke,st,Ft,Vt;if(E=j,e.substr(j,3)===He?(V=He,j+=3):(V=o,we===0&&Te(Dt)),V!==o)if(Be(),e.charCodeAt(j)===91?(K=b,j++):(K=o,we===0&&Te(Ne)),K!==o)if(Be(),pe=It(),pe!==o){for(ke=[],st=j,Ft=Rt(),Ft!==o?(Vt=It(),Vt!==o?(Ie=st,st=en(pe,Vt)):(j=st,st=o)):(j=st,st=o);st!==o;)ke.push(st),st=j,Ft=Rt(),Ft!==o?(Vt=It(),Vt!==o?(Ie=st,st=en(pe,Vt)):(j=st,st=o)):(j=st,st=o);st=Be(),e.charCodeAt(j)===93?(Ft=F,j++):(Ft=o,we===0&&Te(nt)),Ft!==o?(Ie=E,E=On(pe,ke)):(j=E,E=o)}else j=E,E=o;else j=E,E=o;else j=E,E=o;return E}function Br(){var E;return E=Rr(),E===o&&(E=Sr()),E}function It(){var E,V,K,pe,ke;if(E=j,V=Br(),V!==o){for(Be(),K=[],pe=qt();pe!==o;)K.push(pe),pe=qt();Ie=E,E=Wn(V)}else j=E,E=o;return E===o&&(E=j,V=Fr(),V!==o?(Be(),e.charCodeAt(j)===36?(K=et,j++):(K=o,we===0&&Te(kt)),K!==o?(pe=Be(),ke=It(),ke!==o?(Ie=E,E=zn(V,ke)):(j=E,E=o)):(j=E,E=o)):(j=E,E=o)),E}function Lr(){var E,V;return E=j,V=It(),V!==o&&(Ie=E,V=jn(V)),E=V,E===o&&(E=qt()),E}function Ir(){var E;return E=Lr(),E}function Vr(){var E,V;return E=j,Be(),V=Xr(),V===o&&(V=Zr(),V===o&&(V=Or())),V!==o?(Be(),Ie=E,E=Un(V)):(j=E,E=o),E}function Xr(){var E,V,K;return E=j,e.substr(j,6)===de?(V=de,j+=6):(V=o,we===0&&Te(Ot)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=Yn(K)):(j=E,E=o)):(j=E,E=o),E}function Zr(){var E,V,K;return E=j,e.substr(j,6)===Le?(V=Le,j+=6):(V=o,we===0&&Te(Wt)),V!==o?(Be(),K=Gt(),K!==o?(Ie=E,E=Hn(K)):(j=E,E=o)):(j=E,E=o),E}function Or(){var E,V;return E=j,e.substr(j,4)===ot?(V=ot,j+=4):(V=o,we===0&&Te(xt)),V!==o&&(Ie=E,V=Kn()),E=V,E}function Wr(){var E;return E=Ir(),E===o&&(E=Vr()),E}var zr=function(E){this.type_="atom",this.source_=E,this.location_=tn()},Yt=function(E,V,K,pe){this.type_="pattern",this.arguments_={alignment:V,_steps:pe},K!==void 0&&(this.arguments_.seed=K),this.source_=E},jr=function(E,V,K){this.type_=E,this.arguments_=V,this.source_=K},Ur=function(E,V){this.type_="element",this.source_=E,this.options_=V,this.location_=tn()},Jt=function(E,V){this.type_="command",this.name_=E,this.options_=V},Qt=0;if(Xt=l(),t.peg$library)return{peg$result:Xt,peg$currPos:j,peg$FAILED:o,peg$maxFailExpected:zt,peg$maxFailPos:St};if(Xt!==o&&j===e.length)return Xt;throw Xt!==o&&j<e.length&&Te(Jn()),Qn(zt,St<e.length?e.charAt(St):null,St<e.length?Kt(St,St+1):Kt(St,St))}const peg$allowedStartRules=["start"];typeof BigInt>"u"&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const C_ZERO=BigInt(0),C_ONE=BigInt(1),C_TWO=BigInt(2),C_FIVE=BigInt(5),C_TEN=BigInt(10),MAX_CYCLE_LEN=2e3,P={s:C_ONE,n:C_ZERO,d:C_ONE};function assign(e,t){try{e=BigInt(e)}catch{throw InvalidParameter()}return e*t}function trunc(e){return typeof e=="bigint"?e:Math.floor(e)}function newFraction(e,t){if(t===C_ZERO)throw DivisionByZero();const o=Object.create(Fraction$1.prototype);o.s=e<C_ZERO?-C_ONE:C_ONE,e=e<C_ZERO?-e:e;const a=gcd$1(e,t);return o.n=e/a,o.d=t/a,o}function factorize(e){const t={};let o=e,a=C_TWO,u=C_FIVE-C_ONE;for(;u<=o;){for(;o%a===C_ZERO;)o/=a,t[a]=(t[a]||C_ZERO)+C_ONE;u+=C_ONE+C_TWO*a++}return o!==e?o>1&&(t[o]=(t[o]||C_ZERO)+C_ONE):t[e]=(t[e]||C_ZERO)+C_ONE,t}const parse$b=function(e,t){let o=C_ZERO,a=C_ONE,u=C_ONE;if(e!=null)if(t!==void 0){if(typeof e=="bigint")o=e;else{if(isNaN(e))throw InvalidParameter();if(e%1!==0)throw NonIntegerParameter();o=BigInt(e)}if(typeof t=="bigint")a=t;else{if(isNaN(t))throw InvalidParameter();if(t%1!==0)throw NonIntegerParameter();a=BigInt(t)}u=o*a}else if(typeof e=="object"){if("d"in e&&"n"in e)o=BigInt(e.n),a=BigInt(e.d),"s"in e&&(o*=BigInt(e.s));else if(0 in e)o=BigInt(e[0]),1 in e&&(a=BigInt(e[1]));else if(typeof e=="bigint")o=e;else throw InvalidParameter();u=o*a}else if(typeof e=="number"){if(isNaN(e))throw InvalidParameter();if(e<0&&(u=-C_ONE,e=-e),e%1===0)o=BigInt(e);else if(e>0){let l=1,p=0,d=1,g=1,f=1,A=1e7;for(e>=1&&(l=10**Math.floor(1+Math.log10(e)),e/=l);d<=A&&f<=A;){let b=(p+g)/(d+f);if(e===b){d+f<=A?(o=p+g,a=d+f):f>d?(o=g,a=f):(o=p,a=d);break}else e>b?(p+=g,d+=f):(g+=p,f+=d),d>A?(o=g,a=f):(o=p,a=d)}o=BigInt(o)*BigInt(l),a=BigInt(a)}}else if(typeof e=="string"){let l=0,p=C_ZERO,d=C_ZERO,g=C_ZERO,f=C_ONE,A=C_ONE,b=e.replace(/_/g,"").match(/\d+|./g);if(b===null)throw InvalidParameter();if(b[l]==="-"?(u=-C_ONE,l++):b[l]==="+"&&l++,b.length===l+1?d=assign(b[l++],u):b[l+1]==="."||b[l]==="."?(b[l]!=="."&&(p=assign(b[l++],u)),l++,(l+1===b.length||b[l+1]==="("&&b[l+3]===")"||b[l+1]==="'"&&b[l+3]==="'")&&(d=assign(b[l],u),f=C_TEN**BigInt(b[l].length),l++),(b[l]==="("&&b[l+2]===")"||b[l]==="'"&&b[l+2]==="'")&&(g=assign(b[l+1],u),A=C_TEN**BigInt(b[l+1].length)-C_ONE,l+=3)):b[l+1]==="/"||b[l+1]===":"?(d=assign(b[l],u),f=assign(b[l+2],C_ONE),l+=3):b[l+3]==="/"&&b[l+1]===" "&&(p=assign(b[l],u),d=assign(b[l+2],u),f=assign(b[l+4],C_ONE),l+=5),b.length<=l)a=f*A,u=o=g+a*p+A*d;else throw InvalidParameter()}else if(typeof e=="bigint")o=e,u=e,a=C_ONE;else throw InvalidParameter();if(a===C_ZERO)throw DivisionByZero();P.s=u<C_ZERO?-C_ONE:C_ONE,P.n=o<C_ZERO?-o:o,P.d=a<C_ZERO?-a:a};function modpow(e,t,o){let a=C_ONE;for(;t>C_ZERO;e=e*e%o,t>>=C_ONE)t&C_ONE&&(a=a*e%o);return a}function cycleLen(e,t){for(;t%C_TWO===C_ZERO;t/=C_TWO);for(;t%C_FIVE===C_ZERO;t/=C_FIVE);if(t===C_ONE)return C_ZERO;let o=C_TEN%t,a=1;for(;o!==C_ONE;a++)if(o=o*C_TEN%t,a>MAX_CYCLE_LEN)return C_ZERO;return BigInt(a)}function cycleStart(e,t,o){let a=C_ONE,u=modpow(C_TEN,o,t);for(let l=0;l<300;l++){if(a===u)return BigInt(l);a=a*C_TEN%t,u=u*C_TEN%t}return 0}function gcd$1(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function Fraction$1(e,t){if(parse$b(e,t),this instanceof Fraction$1)e=gcd$1(P.d,P.n),this.s=P.s,this.n=P.n/e,this.d=P.d/e;else return newFraction(P.s*P.n,P.d)}var DivisionByZero=function(){return new Error("Division by Zero")},InvalidParameter=function(){return new Error("Invalid argument")},NonIntegerParameter=function(){return new Error("Parameters must be integer")};Fraction$1.prototype={s:C_ONE,n:C_ZERO,d:C_ONE,abs:function(){return newFraction(this.n,this.d)},neg:function(){return newFraction(-this.s*this.n,this.d)},add:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d+P.s*this.d*P.n,this.d*P.d)},sub:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d-P.s*this.d*P.n,this.d*P.d)},mul:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.n,this.d*P.d)},div:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.d,this.d*P.n)},clone:function(){return newFraction(this.s*this.n,this.d)},mod:function(e,t){if(e===void 0)return newFraction(this.s*this.n%this.d,C_ONE);if(parse$b(e,t),C_ZERO===P.n*this.d)throw DivisionByZero();return newFraction(this.s*(P.d*this.n)%(P.n*this.d),P.d*this.d)},gcd:function(e,t){return parse$b(e,t),newFraction(gcd$1(P.n,this.n)*gcd$1(P.d,this.d),P.d*this.d)},lcm:function(e,t){return parse$b(e,t),P.n===C_ZERO&&this.n===C_ZERO?newFraction(C_ZERO,C_ONE):newFraction(P.n*this.n,gcd$1(P.n,this.n)*gcd$1(P.d,this.d))},inverse:function(){return newFraction(this.s*this.d,this.n)},pow:function(e,t){if(parse$b(e,t),P.d===C_ONE)return P.s<C_ZERO?newFraction((this.s*this.d)**P.n,this.n**P.n):newFraction((this.s*this.n)**P.n,this.d**P.n);if(this.s<C_ZERO)return null;let o=factorize(this.n),a=factorize(this.d),u=C_ONE,l=C_ONE;for(let p in o)if(p!=="1"){if(p==="0"){u=C_ZERO;break}if(o[p]*=P.n,o[p]%P.d===C_ZERO)o[p]/=P.d;else return null;u*=BigInt(p)**o[p]}for(let p in a)if(p!=="1"){if(a[p]*=P.n,a[p]%P.d===C_ZERO)a[p]/=P.d;else return null;l*=BigInt(p)**a[p]}return P.s<C_ZERO?newFraction(l,u):newFraction(u,l)},log:function(e,t){if(parse$b(e,t),this.s<=C_ZERO||P.s<=C_ZERO)return null;const o={},a=factorize(P.n),u=factorize(P.d),l=factorize(this.n),p=factorize(this.d);for(const f in u)a[f]=(a[f]||C_ZERO)-u[f];for(const f in p)l[f]=(l[f]||C_ZERO)-p[f];for(const f in a)f!=="1"&&(o[f]=!0);for(const f in l)f!=="1"&&(o[f]=!0);let d=null,g=null;for(const f in o){const A=a[f]||C_ZERO,b=l[f]||C_ZERO;if(A===C_ZERO){if(b!==C_ZERO)return null;continue}let F=b,S=A;const k=gcd$1(F,S);if(F/=k,S/=k,d===null&&g===null)d=F,g=S;else if(F*g!==d*S)return null}return d!==null&&g!==null?newFraction(d,g):null},equals:function(e,t){return parse$b(e,t),this.s*this.n*P.d===P.s*P.n*this.d},lt:function(e,t){return parse$b(e,t),this.s*this.n*P.d<P.s*P.n*this.d},lte:function(e,t){return parse$b(e,t),this.s*this.n*P.d<=P.s*P.n*this.d},gt:function(e,t){return parse$b(e,t),this.s*this.n*P.d>P.s*P.n*this.d},gte:function(e,t){return parse$b(e,t),this.s*this.n*P.d>=P.s*P.n*this.d},compare:function(e,t){parse$b(e,t);let o=this.s*this.n*P.d-P.s*P.n*this.d;return(C_ZERO<o)-(o<C_ZERO)},ceil:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+(e*this.n%this.d>C_ZERO&&this.s>=C_ZERO?C_ONE:C_ZERO),e)},floor:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)-(e*this.n%this.d>C_ZERO&&this.s<C_ZERO?C_ONE:C_ZERO),e)},round:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+this.s*((this.s>=C_ZERO?C_ONE:C_ZERO)+C_TWO*(e*this.n%this.d)>this.d?C_ONE:C_ZERO),e)},roundTo:function(e,t){parse$b(e,t);const o=this.n*P.d,a=this.d*P.n,u=o%a;let l=trunc(o/a);return u+u>=a&&l++,newFraction(this.s*l*P.n,P.d)},divisible:function(e,t){return parse$b(e,t),!(!(P.n*this.d)||this.n*P.d%(P.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,o=this.d;e=e||15;let a=cycleLen(t,o),u=cycleStart(t,o,a),l=this.s<C_ZERO?"-":"";if(l+=trunc(t/o),t%=o,t*=C_TEN,t&&(l+="."),a){for(let p=u;p--;)l+=trunc(t/o),t%=o,t*=C_TEN;l+="(";for(let p=a;p--;)l+=trunc(t/o),t%=o,t*=C_TEN;l+=")"}else for(let p=e;t&&p--;)l+=trunc(t/o),t%=o,t*=C_TEN;return l},toFraction:function(e){let t=this.n,o=this.d,a=this.s<C_ZERO?"-":"";if(o===C_ONE)a+=t;else{let u=trunc(t/o);e&&u>C_ZERO&&(a+=u,a+=" ",t%=o),a+=t,a+="/",a+=o}return a},toLatex:function(e){let t=this.n,o=this.d,a=this.s<C_ZERO?"-":"";if(o===C_ONE)a+=t;else{let u=trunc(t/o);e&&u>C_ZERO&&(a+=u,t%=o),a+="\\frac{",a+=t,a+="}{",a+=o,a+="}"}return a},toContinued:function(){let e=this.n,t=this.d,o=[];do{o.push(trunc(e/t));let a=e%t;e=t,t=a}while(e!==C_ONE);return o},simplify:function(e){const t=BigInt(1/(e||.001)|0),o=this.abs(),a=o.toContinued();for(let u=1;u<a.length;u++){let l=newFraction(a[u-1],C_ONE);for(let d=u-2;d>=0;d--)l=l.inverse().add(a[d]);let p=l.sub(o);if(p.n*t<p.d)return l.mul(this.s)}return this}};const logKey="strudel.log";let debounce=1e3,lastMessage,lastTime;function errorLogger$1(e,t="cyclist"){process.env.NODE_ENV==="development"&&console.error(e),logger$2(`[${t}] error: ${e.message}`)}function logger$2(e,t,o={}){let a=performance.now();lastMessage===e&&a-lastTime<debounce||(lastMessage=e,lastTime=a,console.log(`%c${e}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(logKey,{detail:{message:e,type:t,data:o}})))}logger$2.key=logKey;const isNoteWithOctave=e=>/^[a-gA-G][#bsf]*[0-9]*$/.test(e),isNote=e=>/^[a-gA-G][#bsf]*-?[0-9]*$/.test(e),tokenizeNote$3=e=>{if(typeof e!="string")return[];const[t,o="",a]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,a?Number(a):void 0]:[]},chromas$2={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$2={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset$1=e=>e?.split("").reduce((t,o)=>t+accs$2[o],0)||0,noteToMidi$1=(e,t=3)=>{const[o,a,u=t]=tokenizeNote$3(e);if(!o)throw new Error('not a note: "'+e+'"');const l=chromas$2[o.toLowerCase()],p=getAccidentalsOffset$1(a);return(Number(u)+1)*12+l+p},midiToFreq$2=e=>Math.pow(2,(e-69)/12)*440,freqToMidi$2=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi$1=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:a}=e;if(typeof o=="number")return freqToMidi$2(o);if(typeof a=="string")return noteToMidi$1(a);if(typeof a=="number")return a;if(!t)throw new Error("valueToMidi: expected freq or note to be set");return t},getEventOffsetMs=(e,t)=>(e-t)*1e3,getFreq=e=>midiToFreq$2(typeof e=="number"?e:noteToMidi$1(e)),pcs$1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],midi2note$1=e=>{const t=Math.floor(e/12)-1;return pcs$1[e%12]+t},_mod$2=(e,t)=>(e%t+t)%t,averageArray=e=>e.reduce((t,o)=>t+o)/e.length;function nanFallback$1(e,t=0){return isNaN(Number(e))?(logger$2(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const getSoundIndex$1=(e,t)=>_mod$2(Math.round(nanFallback$1(e??0,0)),t),getPlayableNoteValue=e=>{let{value:t,context:o}=e,a=t;if(typeof a=="object"&&!Array.isArray(a)&&(a=a.note||a.n||a.value,a===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(t)}`);if(typeof a=="number"&&o.type!=="frequency")a=midiToFreq$2(e.value);else if(typeof a=="number"&&o.type==="frequency")a=e.value;else if(typeof a!="string"||!isNote(a))throw new Error("not a note: "+JSON.stringify(a));return a},getFrequency=e=>{let{value:t,context:o}=e;if(typeof t=="object")return t.freq?t.freq:getFreq(t.note||t.n||t.value);if(typeof t=="number"&&o.type!=="frequency")t=midiToFreq$2(e.value);else if(typeof t=="string"&&isNote(t))t=midiToFreq$2(noteToMidi$1(e.value));else if(typeof t!="number")throw new Error("not a note or frequency: "+t);return t},rotate$2=(e,t)=>e.slice(t).concat(e.slice(0,t)),pipe=(...e)=>e.reduce((t,o)=>(...a)=>t(o(...a)),t=>t),compose=(...e)=>pipe(...e.reverse()),removeUndefineds=e=>e.filter(t=>t!=null),flatten=e=>[].concat(...e),id=e=>e,constant=(e,t)=>e,listRange=(e,t)=>Array.from({length:t-e+1},(o,a)=>a+e);function curry(e,t,o=e.length){const a=function u(...l){if(l.length>=o)return e.apply(this,l);{const p=function(...d){return u.apply(this,l.concat(d))};return t&&t(p,l),p}};return t&&t(a,[]),a}function parseNumeral(e){const t=Number(e);if(!isNaN(t))return t;if(isNote(e))return noteToMidi$1(e);throw new Error(`cannot parse as numeral: "${e}"`)}function mapArgs(e,t){return(...o)=>e(...o.map(t))}function numeralArgs(e){return mapArgs(e,parseNumeral)}function parseFractional(e){const t=Number(e);if(!isNaN(t))return t;const o={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[e];if(typeof o<"u")return o;throw new Error(`cannot parse as fractional: "${e}"`)}const fractionalArgs=e=>mapArgs(e,parseFractional),splitAt=function(e,t){return[t.slice(0,e),t.slice(e)]},zipWith=(e,t,o)=>t.map((a,u)=>e(a,o[u])),pairs=function(e){const t=[];for(let o=0;o<e.length-1;++o)t.push([e[o],e[o+1]]);return t},clamp$1=(e,t,o)=>Math.min(Math.max(e,t),o),solfeggio=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],indian=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],german=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],byzantine=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],japanese=["I","Ro","Ha","Ni","Ho","He","To"],english=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],sol2note=(e,t="letters")=>{const a=(t==="solfeggio"?solfeggio:t==="indian"?indian:t==="german"?german:t==="byzantine"?byzantine:t==="japanese"?japanese:english)[e%12],u=Math.floor(e/12)-1;return a+u};function uniq(e){var t={};return e.filter(function(o){return t.hasOwn(o)?!1:t[o]=!0})}function uniqsort(e){return e.sort().filter(function(t,o,a){return!o||t!=a[o-1]})}function uniqsortr(e){return e.sort((t,o)=>t.compare(o)).filter(function(t,o,a){return!o||t.ne(a[o-1])})}function unicodeToBase64(e){const t=new TextEncoder().encode(e);return btoa(String.fromCharCode(...t))}function base64ToUnicode(e){const t=new Uint8Array(atob(e).split("").map(a=>a.charCodeAt(0)));return new TextDecoder().decode(t)}function code2hash(e){return encodeURIComponent(unicodeToBase64(e))}function hash2code(e){return base64ToUnicode(decodeURIComponent(e))}function objectMap(e,t){return Array.isArray(e)?e.map(t):Object.fromEntries(Object.entries(e).map(([o,a],u)=>[o,t(a,o,u)]))}function cycleToSeconds$1(e,t){return e/t}class ClockCollator{constructor({getTargetClockTime:t=getUnixTimeSeconds,weight:o=16,offsetDelta:a=.005,checkAfterTime:u=2,resetAfterTime:l=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=t,this.weight=o,this.offsetDelta=a,this.checkAfterTime=u,this.resetAfterTime=l,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(t){const o=this.getTargetClockTime(),a=o-this.timeAtPrevOffsetSample,u=o-t;if(a>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=u),this.prevOffsetTimes.push(u),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||a>this.checkAfterTime){this.timeAtPrevOffsetSample=o;const l=averageArray(this.prevOffsetTimes);Math.abs(l-this.offsetTime)>this.offsetDelta&&(this.offsetTime=l)}return this.offsetTime}calculateTimestamp(t,o){return this.calculateOffset(t)+o}}function getPerformanceTimeSeconds(){return performance.now()*.001}function getUnixTimeSeconds(){return Date.now()*.001}const keyAlias=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let keyState;function getCurrentKeyboardState(){if(keyState==null){if(typeof window>"u")return;keyState={},window.addEventListener("keydown",e=>{keyState[e.key]=!0}),window.addEventListener("keyup",e=>{keyState[e.key]=!1})}return{...keyState}}function stringifyValues(e,t=!1){return typeof e=="object"?t?JSON.stringify(e).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(e):e}Fraction$1.prototype.sam=function(){return this.floor()},Fraction$1.prototype.nextSam=function(){return this.sam().add(1)},Fraction$1.prototype.wholeCycle=function(){return new TimeSpan(this.sam(),this.nextSam())},Fraction$1.prototype.cyclePos=function(){return this.sub(this.sam())},Fraction$1.prototype.lt=function(e){return this.compare(e)<0},Fraction$1.prototype.gt=function(e){return this.compare(e)>0},Fraction$1.prototype.lte=function(e){return this.compare(e)<=0},Fraction$1.prototype.gte=function(e){return this.compare(e)>=0},Fraction$1.prototype.eq=function(e){return this.compare(e)==0},Fraction$1.prototype.ne=function(e){return this.compare(e)!=0},Fraction$1.prototype.max=function(e){return this.gt(e)?this:e},Fraction$1.prototype.maximum=function(...e){return e=e.map(t=>new Fraction$1(t)),e.reduce((t,o)=>o.max(t),this)},Fraction$1.prototype.min=function(e){return this.lt(e)?this:e},Fraction$1.prototype.mulmaybe=function(e){return e!==void 0?this.mul(e):void 0},Fraction$1.prototype.divmaybe=function(e){return e!==void 0?this.div(e):void 0},Fraction$1.prototype.addmaybe=function(e){return e!==void 0?this.add(e):void 0},Fraction$1.prototype.submaybe=function(e){return e!==void 0?this.sub(e):void 0},Fraction$1.prototype.show=function(){return this.s*this.n+"/"+this.d},Fraction$1.prototype.or=function(e){return this.eq(0)?e:this};const fraction$1=e=>Fraction$1(e),gcd=(...e)=>{if(e=removeUndefineds(e),e.length!==0)return e.reduce((t,o)=>t.gcd(o),fraction$1(1))},lcm=(...e)=>{if(e=removeUndefineds(e),e.length===0)return;const t=e.pop();return e.reduce((o,a)=>o===void 0||a===void 0?void 0:o.lcm(a),t)},isFraction=e=>e instanceof Fraction$1;fraction$1._original=Fraction$1;const Fraction=fraction$1;class TimeSpan{constructor(t,o){this.begin=Fraction(t),this.end=Fraction(o)}get spanCycles(){const t=[];var o=this.begin;const a=this.end,u=a.sam();if(o.equals(a))return[new TimeSpan(o,a)];for(;a.gt(o);){if(o.sam().equals(u)){t.push(new TimeSpan(o,this.end));break}const l=o.nextSam();t.push(new TimeSpan(o,l)),o=l}return t}get duration(){return this.end.sub(this.begin)}cycleArc(){const t=this.begin.cyclePos(),o=t.add(this.duration);return new TimeSpan(t,o)}withTime(t){return new TimeSpan(t(this.begin),t(this.end))}withEnd(t){return new TimeSpan(this.begin,t(this.end))}withCycle(t){const o=this.begin.sam(),a=o.add(t(this.begin.sub(o))),u=o.add(t(this.end.sub(o)));return new TimeSpan(a,u)}intersection(t){const o=this.begin.max(t.begin),a=this.end.min(t.end);if(!o.gt(a)&&!(o.equals(a)&&(o.equals(this.end)&&this.begin.lt(this.end)||o.equals(t.end)&&t.begin.lt(t.end))))return new TimeSpan(o,a)}intersection_e(t){const o=this.intersection(t);if(o==null)throw"TimeSpans do not intersect";return o}midpoint(){return this.begin.add(this.duration.div(Fraction(2)))}equals(t){return this.begin.equals(t.begin)&&this.end.equals(t.end)}show(){return this.begin.show()+" → "+this.end.show()}}class Hap{constructor(t,o,a,u={},l=!1){this.whole=t,this.part=o,this.value=a,this.context=u,this.stateful=l,l&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){let t;return typeof this.value?.duration=="number"?t=Fraction(this.value.duration):t=this.whole.end.sub(this.whole.begin),typeof this.value?.clip=="number"?t.mul(this.value.clip):t}get endClipped(){return this.whole.begin.add(this.duration)}isActive(t){return this.whole.begin<=t&&this.endClipped>=t}isInPast(t){return t>this.endClipped}isInNearPast(t,o){return o-t<=this.endClipped}isInFuture(t){return t<this.whole.begin}isInNearFuture(t,o){return o<this.whole.begin&&o>this.whole.begin-t}isWithinTime(t,o){return this.whole.begin<=o&&this.endClipped>=t}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(t){const o=this.whole?t(this.whole):void 0;return new Hap(o,t(this.part),this.value,this.context)}withValue(t){return new Hap(this.whole,this.part,t(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(t){return this.context.tags?.includes(t)}resolveState(t){if(this.stateful&&this.hasOnset()){console.log("stateful");const o=this.value,[a,u]=o(t);return[a,new Hap(this.whole,this.part,u,this.context,!1)]}return[t,this]}spanEquals(t){return this.whole==null&&t.whole==null||this.whole.equals(t.whole)}equals(t){return this.spanEquals(t)&&this.part.equals(t.part)&&this.value===t.value}show(t=!1){const o=typeof this.value=="object"?t?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var a="";if(this.whole==null)a="~"+this.part.show;else{var u=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(a=this.whole.begin.show()+" ⇜ "),u||(a+="("),a+=this.part.show(),u||(a+=")"),this.whole.end.equals(this.part.end)||(a+=" ⇝ "+this.whole.end.show())}return"[ "+a+" | "+o+" ]"}showWhole(t=!1){return`${this.whole==null?"~":this.whole.show()}: ${stringifyValues(this.value,t)}`}combineContext(t){const o=this;return{...o.context,...t.context,locations:(o.context.locations||[]).concat(t.context.locations||[])}}setContext(t){return new Hap(this.whole,this.part,this.value,t)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class State{constructor(t,o={}){this.span=t,this.controls=o}setSpan(t){return new State(t,this.controls)}withSpan(t){return this.setSpan(t(this.span))}setControls(t){return new State(this.span,{...this.controls,...t})}}function unionWithObj(e,t,o){if(t?.value!==void 0&&Object.keys(t).length===1)return logger$2("[warn]: Can't do arithmetic on control pattern."),e;const a=Object.keys(e).filter(u=>Object.keys(t).includes(u));return Object.assign({},e,t,Object.fromEntries(a.map(u=>[u,o(e[u],t[u])])))}curry((e,t)=>e*t),curry((e,t)=>t.map(e));function drawLine(e,t=60){let o=0,a=Fraction(0),u=[""],l="";for(;u[0].length<t;){const p=e.queryArc(o,o+1),d=p.filter(A=>A.hasOnset()).map(A=>A.duration),g=gcd(...d),f=g.inverse();u=u.map(A=>A+"|"),l+="|";for(let A=0;A<f;A++){const[b,F]=[a,a.add(g)],S=p.filter($=>$.whole.begin.lte(b)&&$.whole.end.gte(F)),k=S.length-u.length;k>0&&(u=u.concat(Array(k).fill(l))),u=u.map(($,R)=>{const I=S[R];if(I){const ie=I.whole.begin.eq(b)?""+I.value:"-";return $+ie}return $+"."}),l+=".",a=a.add(g)}o++}return u.join(`
`)}let stringParser,__steps=!0;const calculateSteps=function(e){__steps=!!e},setStringParser=e=>stringParser=e;let Pattern$1=class _t{constructor(t,o=void 0){this.query=t,this._Pattern=!0,this._steps=o}get _steps(){return this.__steps}set _steps(t){this.__steps=t===void 0?void 0:Fraction(t)}setSteps(t){return this._steps=t,this}withSteps(t){return __steps?new _t(this.query,this._steps===void 0?void 0:t(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(t){const o=new _t(a=>this.query(a).map(u=>u.withValue(t)));return o._steps=this._steps,o}withState(t){return new _t(o=>this.query(t(o)))}fmap(t){return this.withValue(t)}appWhole(t,o){const a=this,u=function(l){const p=a.query(l),d=o.query(l),g=function(f,A){const b=f.part.intersection(A.part);if(b!=null)return new Hap(t(f.whole,A.whole),b,f.value(A.value),A.combineContext(f))};return flatten(p.map(f=>removeUndefineds(d.map(A=>g(f,A)))))};return new _t(u)}appBoth(t){const o=this,a=function(l,p){if(!(l==null||p==null))return l.intersection_e(p)},u=o.appWhole(a,t);return __steps&&(u._steps=lcm(t._steps,o._steps)),u}appLeft(t){const o=this,a=function(l){const p=[];for(const d of o.query(l)){const g=t.query(l.setSpan(d.wholeOrPart()));for(const f of g){const A=d.whole,b=d.part.intersection(f.part);if(b){const F=d.value(f.value),S=f.combineContext(d),k=new Hap(A,b,F,S);p.push(k)}}}return p},u=new _t(a);return u._steps=this._steps,u}appRight(t){const o=this,a=function(l){const p=[];for(const d of t.query(l)){const g=o.query(l.setSpan(d.wholeOrPart()));for(const f of g){const A=d.whole,b=f.part.intersection(d.part);if(b){const F=f.value(d.value),S=d.combineContext(f),k=new Hap(A,b,F,S);p.push(k)}}}return p},u=new _t(a);return u._steps=t._steps,u}bindWhole(t,o){const a=this,u=function(l){const p=function(g,f){return new Hap(t(g.whole,f.whole),f.part,f.value,Object.assign({},g.context,f.context,{locations:(g.context.locations||[]).concat(f.context.locations||[])}))},d=function(g){return o(g.value).query(l.setSpan(g.part)).map(f=>p(g,f))};return flatten(a.query(l).map(g=>d(g)))};return new _t(u)}bind(t){const o=function(a,u){if(!(a==null||u==null))return a.intersection_e(u)};return this.bindWhole(o,t)}join(){return this.bind(id)}outerBind(t){return this.bindWhole(o=>o,t).setSteps(this._steps)}outerJoin(){return this.outerBind(id)}innerBind(t){return this.bindWhole((o,a)=>a,t)}innerJoin(){return this.innerBind(id)}resetJoin(t=!1){const o=this;return new _t(a=>o.discreteOnly().query(a).map(u=>u.value.late(t?u.whole.begin:u.whole.begin.cyclePos()).query(a).map(l=>new Hap(l.whole?l.whole.intersection(u.whole):void 0,l.part.intersection(u.part),l.value).setContext(u.combineContext(l))).filter(l=>l.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const t=this;function o(a){const u=t.discreteOnly().query(a);function l(d){const f=d.value._focusSpan(d.wholeOrPart()).query(a.setSpan(d.part));function A(b,F){let S;if(F.whole&&b.whole&&(S=F.whole.intersection(b.whole),!S))return;const k=F.part.intersection(b.part);if(!k)return;const $=F.combineContext(b);return new Hap(S,k,F.value,$)}return f.map(b=>A(d,b))}return flatten(u.map(l)).filter(d=>d)}return new _t(o)}squeezeBind(t){return this.fmap(t).squeezeJoin()}polyJoin=function(){const t=this;return t.fmap(o=>o.extend(t._steps.div(o._steps))).outerJoin()};polyBind(t){return this.fmap(t).polyJoin()}queryArc(t,o,a={}){try{return this.query(new State(new TimeSpan(t,o),a))}catch(u){return errorLogger$1(u,"query"),[]}}splitQueries(){const t=this,o=a=>flatten(a.span.spanCycles.map(u=>t.query(a.setSpan(u))));return new _t(o)}withQuerySpan(t){return new _t(o=>this.query(o.withSpan(t)))}withQuerySpanMaybe(t){const o=this;return new _t(a=>{const u=a.withSpan(t);return u.span?o.query(u):[]})}withQueryTime(t){return new _t(o=>this.query(o.withSpan(a=>a.withTime(t))))}withHapSpan(t){return new _t(o=>this.query(o).map(a=>a.withSpan(t)))}withHapTime(t){return this.withHapSpan(o=>o.withTime(t))}withHaps(t){const o=new _t(a=>t(this.query(a),a));return o._steps=this._steps,o}withHap(t){return this.withHaps(o=>o.map(t))}setContext(t){return this.withHap(o=>o.setContext(t))}withContext(t){const o=this.withHap(a=>a.setContext(t(a.context)));return this.__pure!==void 0&&(o.__pure=this.__pure,o.__pure_loc=this.__pure_loc),o}stripContext(){return this.withHap(t=>t.setContext({}))}withLoc(t,o){const a={start:t,end:o},u=this.withContext(l=>{const p=(l.locations||[]).concat([a]);return{...l,locations:p}});return this.__pure&&(u.__pure=this.__pure,u.__pure_loc=a),u}filterHaps(t){return new _t(o=>this.query(o).filter(t))}filterValues(t){return new _t(o=>this.query(o).filter(a=>t(a.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(t=>t!=null)}onsetsOnly(){return this.filterHaps(t=>t.hasOnset())}discreteOnly(){return this.filterHaps(t=>t.whole)}defragmentHaps(){return this.discreteOnly().withHaps(o=>{const a=[];for(var u=0;u<o.length;++u){for(var l=!0,p=o[u];l;){const f=JSON.stringify(o[u].value);for(var d=!1,g=u+1;g<o.length;g++){const A=o[g];if(p.whole.equals(A.whole)){if(p.part.begin.eq(A.part.end)){if(f===JSON.stringify(A.value)){p=new Hap(p.whole,new TimeSpan(A.part.begin,p.part.end),p.value),o.splice(g,1),d=!0;break}}else if(A.part.begin.eq(p.part.end)&&f==JSON.stringify(A.value)){p=new Hap(p.whole,new TimeSpan(p.part.begin,A.part.end),p.value),o.splice(g,1),d=!0;break}}}l=d}a.push(p)}return a})}firstCycle(t=!1){var o=this;return t||(o=o.stripContext()),o.query(new State(new TimeSpan(Fraction(0),Fraction(1))))}get firstCycleValues(){return this.firstCycle().map(t=>t.value)}get showFirstCycle(){return this.firstCycle().map(t=>`${t.value}: ${t.whole.begin.toFraction()} - ${t.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(t=>t.sort((o,a)=>o.part.begin.sub(a.part.begin).or(o.part.end.sub(a.part.end)).or(o.whole.begin.sub(a.whole.begin).or(o.whole.end.sub(a.whole.end)))))}asNumber(){return this.fmap(parseNumeral)}_opIn(t,o){return this.fmap(o).appLeft(reify(t))}_opOut(t,o){return this.fmap(o).appRight(reify(t))}_opMix(t,o){return this.fmap(o).appBoth(reify(t))}_opSqueeze(t,o){const a=reify(t);return this.fmap(u=>a.fmap(l=>o(u)(l))).squeezeJoin()}_opSqueezeOut(t,o){const a=this;return reify(t).fmap(l=>a.fmap(p=>o(p)(l))).squeezeJoin()}_opReset(t,o){return reify(t).fmap(u=>this.fmap(l=>o(l)(u))).resetJoin()}_opRestart(t,o){return reify(t).fmap(u=>this.fmap(l=>o(l)(u))).restartJoin()}_opPoly(t,o){const a=reify(t);return this.fmap(u=>a.fmap(l=>o(l)(u))).polyJoin()}layer(...t){return stack(...t.map(o=>o(this)))}superimpose(...t){return this.stack(...t.map(o=>o(this)))}stack(...t){return stack(this,...t)}sequence(...t){return sequence(this,...t)}seq(...t){return sequence(this,...t)}cat(...t){return cat(this,...t)}fastcat(...t){return fastcat(this,...t)}slowcat(...t){return slowcat(this,...t)}onTrigger(t,o=!0){return this.withHap(a=>a.setContext({...a.context,onTrigger:(...u)=>{a.context.onTrigger?.(...u),t(...u)},dominantTrigger:a.context.dominantTrigger||o}))}log(t=a=>`[hap] ${a.showWhole(!0)}`,o=a=>({hap:a})){return this.onTrigger((...a)=>{logger$2(t(...a),void 0,o(...a))},!1)}logValues(t=o=>`[hap] ${stringifyValues(o,!0)}`){return this.log(o=>t(o.value))}drawLine(){return console.log(drawLine(this)),this}unjoin(t,o=id){return t.withHap(a=>a.withValue(u=>u?o(this.ribbon(a.whole.begin,a.whole.duration)):this))}into(t,o){return this.unjoin(t,o).innerJoin()}};function groupHapsBy(e,t){let o=[];return t.forEach(a=>{const u=o.findIndex(([l])=>e(a,l));u===-1?o.push([a]):o[u].push(a)}),o}const congruent=(e,t)=>e.spanEquals(t);Pattern$1.prototype.collect=function(){return this.withHaps(e=>groupHapsBy(congruent,e).map(t=>new Hap(t[0].whole,t[0].part,t,{})))};const arpWith=register("arpWith",(e,t)=>t.collect().fmap(o=>reify(e(o))).innerJoin().withHap(o=>new Hap(o.whole,o.part,o.value.value,o.combineContext(o.value)))),arp=register("arp",(e,t)=>t.arpWith(o=>reify(e).fmap(a=>o[a%o.length])),!1);function _nonArrayObject(e){return!Array.isArray(e)&&typeof e=="object"&&!isFraction(e)}function _composeOp(e,t,o){return _nonArrayObject(e)||_nonArrayObject(t)?(_nonArrayObject(e)||(e={value:e}),_nonArrayObject(t)||(t={value:t}),unionWithObj(e,t,o)):o(e,t)}(function(){const e={set:[(o,a)=>a],keep:[o=>o],keepif:[(o,a)=>a?o:void 0],add:[numeralArgs((o,a)=>o+a)],sub:[numeralArgs((o,a)=>o-a)],mul:[numeralArgs((o,a)=>o*a)],div:[numeralArgs((o,a)=>o/a)],mod:[numeralArgs(_mod$2)],pow:[numeralArgs(Math.pow)],log2:[numeralArgs(Math.log2)],band:[numeralArgs((o,a)=>o&a)],bor:[numeralArgs((o,a)=>o|a)],bxor:[numeralArgs((o,a)=>o^a)],blshift:[numeralArgs((o,a)=>o<<a)],brshift:[numeralArgs((o,a)=>o>>a)],lt:[(o,a)=>o<a],gt:[(o,a)=>o>a],lte:[(o,a)=>o<=a],gte:[(o,a)=>o>=a],eq:[(o,a)=>o==a],eqt:[(o,a)=>o===a],ne:[(o,a)=>o!=a],net:[(o,a)=>o!==a],and:[(o,a)=>o&&a],or:[(o,a)=>o||a],func:[(o,a)=>a(o)]},t=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[o,[a,u]]of Object.entries(e)){Pattern$1.prototype["_"+o]=function(l){return this.fmap(p=>a(p,l))},Object.defineProperty(Pattern$1.prototype,o,{get:function(){const l=this,p=(...d)=>l[o].in(...d);for(const d of t)p[d.toLowerCase()]=function(...g){var f=l;g=sequence(g),u&&(f=u(f),g=u(g));var A;return o==="keepif"?(A=f["_op"+d](g,b=>F=>a(b,F)),A=A.removeUndefineds()):A=f["_op"+d](g,b=>F=>_composeOp(b,F,a)),A};return p.squeezein=p.squeeze,p}});for(const l of t)Pattern$1.prototype[l.toLowerCase()]=function(...p){return this.set[l.toLowerCase()](p)}}Pattern$1.prototype.struct=function(...o){return this.keepif.out(...o)},Pattern$1.prototype.structAll=function(...o){return this.keep.out(...o)},Pattern$1.prototype.mask=function(...o){return this.keepif.in(...o)},Pattern$1.prototype.maskAll=function(...o){return this.keep.in(...o)},Pattern$1.prototype.reset=function(...o){return this.keepif.reset(...o)},Pattern$1.prototype.resetAll=function(...o){return this.keep.reset(...o)},Pattern$1.prototype.restart=function(...o){return this.keepif.restart(...o)},Pattern$1.prototype.restartAll=function(...o){return this.keep.restart(...o)}})();const polyrhythm=stack,pr=stack,pm=polymeter,gap=e=>new Pattern$1(()=>[],e),silence=gap(1),nothing=gap(0);function pure(e){function t(a){return a.span.spanCycles.map(u=>new Hap(Fraction(u.begin).wholeCycle(),u,e))}const o=new Pattern$1(t,1);return o.__pure=e,o}function isPattern(e){return e instanceof Pattern$1||e?._Pattern}function reify(e){return isPattern(e)?e:stringParser&&typeof e=="string"?stringParser(e):pure(e)}function sequenceP(e){let t=pure([]);for(const o of e)t=t.bind(a=>o.fmap(u=>a.concat([u])));return t}function stack(...e){e=e.map(a=>Array.isArray(a)?sequence(...a):reify(a));const t=a=>flatten(e.map(u=>u.query(a))),o=new Pattern$1(t);return __steps&&(o._steps=lcm(...e.map(a=>a._steps))),o}function _stackWith(e,t){if(t=t.map(l=>Array.isArray(l)?sequence(...l):reify(l)),t.length===0)return silence;if(t.length===1)return t[0];const[o,...a]=t.map(l=>l._steps),u=__steps?o.maximum(...a):void 0;return stack(...e(u,t))}function stackLeft(...e){return _stackWith((t,o)=>o.map(a=>a._steps.eq(t)?a:stepcat(a,gap(t.sub(a._steps)))),e)}function stackRight(...e){return _stackWith((t,o)=>o.map(a=>a._steps.eq(t)?a:stepcat(gap(t.sub(a._steps)),a)),e)}function stackCentre(...e){return _stackWith((t,o)=>o.map(a=>{if(a._steps.eq(t))return a;const u=gap(t.sub(a._steps).div(2));return stepcat(u,a,u)}),e)}function stackBy(e,...t){const[o,...a]=t.map(p=>p._steps),u=o.maximum(...a),l={centre:stackCentre,left:stackLeft,right:stackRight,expand:stack,repeat:(...p)=>polymeter(...p).steps(u)};return e.inhabit(l).fmap(p=>p(...t)).innerJoin().setSteps(u)}function slowcat(...e){if(e=e.map(a=>Array.isArray(a)?fastcat(...a):reify(a)),e.length==1)return e[0];const t=function(a){const u=a.span,l=_mod$2(u.begin.sam(),e.length),p=e[l];if(!p)return[];const d=u.begin.floor().sub(u.begin.div(e.length).floor());return p.withHapTime(g=>g.add(d)).query(a.setSpan(u.withTime(g=>g.sub(d))))},o=__steps?lcm(...e.map(a=>a._steps)):void 0;return new Pattern$1(t).splitQueries().setSteps(o)}function slowcatPrime(...e){e=e.map(reify);const t=function(o){const a=Math.floor(o.span.begin)%e.length;return e[a]?.query(o)||[]};return new Pattern$1(t).splitQueries()}function cat(...e){return slowcat(...e)}function arrange(...e){const t=e.reduce((o,[a])=>o+a,0);return e=e.map(([o,a])=>[o,a.fast(o)]),stepcat(...e).slow(t)}function seqPLoop(...e){let t=Fraction(0);for(let o of e)o.length==2&&o.unshift(t),t=o[1];return stack(...e.map(([o,a,u])=>pure(reify(u)).compress(Fraction(o).div(t),Fraction(a).div(t)))).slow(t).innerJoin()}function fastcat(...e){let t=slowcat(...e);return e.length>1&&(t=t._fast(e.length),t._steps=e.length),e.length==1&&e[0].__steps_source&&(e._steps=e[0]._steps),t}function sequence(...e){return fastcat(...e)}function seq(...e){return fastcat(...e)}function _sequenceCount(e){return Array.isArray(e)?e.length==0?[silence,0]:e.length==1?_sequenceCount(e[0]):[fastcat(...e.map(t=>_sequenceCount(t)[0])),e.length]:[reify(e),1]}const mask=curry((e,t)=>reify(t).mask(e)),struct=curry((e,t)=>reify(t).struct(e)),superimpose=curry((e,t)=>reify(t).superimpose(...e)),withValue=curry((e,t)=>reify(t).withValue(e)),bind=curry((e,t)=>reify(t).bind(e)),innerBind=curry((e,t)=>reify(t).innerBind(e)),outerBind=curry((e,t)=>reify(t).outerBind(e)),squeezeBind=curry((e,t)=>reify(t).squeezeBind(e)),stepBind=curry((e,t)=>reify(t).stepBind(e)),polyBind=curry((e,t)=>reify(t).polyBind(e)),set=curry((e,t)=>reify(t).set(e)),keep=curry((e,t)=>reify(t).keep(e)),keepif=curry((e,t)=>reify(t).keepif(e)),add$7=curry((e,t)=>reify(t).add(e)),sub=curry((e,t)=>reify(t).sub(e)),mul=curry((e,t)=>reify(t).mul(e)),div=curry((e,t)=>reify(t).div(e)),mod$3=curry((e,t)=>reify(t).mod(e)),pow=curry((e,t)=>reify(t).pow(e)),band=curry((e,t)=>reify(t).band(e)),bor=curry((e,t)=>reify(t).bor(e)),bxor=curry((e,t)=>reify(t).bxor(e)),blshift=curry((e,t)=>reify(t).blshift(e)),brshift=curry((e,t)=>reify(t).brshift(e)),lt=curry((e,t)=>reify(t).lt(e)),gt=curry((e,t)=>reify(t).gt(e)),lte=curry((e,t)=>reify(t).lte(e)),gte=curry((e,t)=>reify(t).gte(e)),eq=curry((e,t)=>reify(t).eq(e)),eqt=curry((e,t)=>reify(t).eqt(e)),ne=curry((e,t)=>reify(t).ne(e)),net=curry((e,t)=>reify(t).net(e)),and=curry((e,t)=>reify(t).and(e)),or=curry((e,t)=>reify(t).or(e)),func=curry((e,t)=>reify(t).func(e));function register(e,t,o=!0,a=!1,u=l=>l.innerJoin()){if(Array.isArray(e)){const d={};for(const g of e)d[g]=register(g,t,o,a,u);return d}const l=t.length;var p;return o?p=function(...d){d=d.map(reify);const g=d[d.length-1];let f;if(l===1)f=t(g);else{const A=d.slice(0,-1);if(A.every(b=>b.__pure!=null)){const b=A.map(S=>S.__pure),F=A.filter(S=>S.__pure_loc).map(S=>S.__pure_loc);f=t(...b,g),f=f.withContext(S=>{const k=(S.locations||[]).concat(F);return{...S,locations:k}})}else{const[b,...F]=A;let S=(...k)=>t(...k,g);S=curry(S,null,l-1),f=u(F.reduce((k,$)=>k.appLeft($),b.fmap(S)))}}return a&&(f._steps=g._steps),f}:p=function(...d){d=d.map(reify);const g=t(...d);return a&&(g._steps=d[d.length-1]._steps),g},Pattern$1.prototype[e]=function(...d){if(l===2&&d.length!==1)d=[sequence(...d)];else if(l!==d.length+1)throw new Error(`.${e}() expects ${l-1} inputs but got ${d.length}.`);return d=d.map(reify),p(...d,this)},l>1&&(Pattern$1.prototype["_"+e]=function(...d){const g=t(...d,this);return a&&g.setSteps(this._steps),g}),curry(p,null,l)}function stepRegister(e,t,o=!0,a=!1,u=l=>l.stepJoin()){return register(e,t,o,a,u)}const round=register("round",function(e){return e.asNumber().fmap(t=>Math.round(t))}),floor=register("floor",function(e){return e.asNumber().fmap(t=>Math.floor(t))}),ceil=register("ceil",function(e){return e.asNumber().fmap(t=>Math.ceil(t))}),toBipolar=register("toBipolar",function(e){return e.fmap(t=>t*2-1)}),fromBipolar=register("fromBipolar",function(e){return e.fmap(t=>(t+1)/2)}),range$2=register("range",function(e,t,o){return o.mul(t-e).add(e)}),rangex=register("rangex",function(e,t,o){return o._range(Math.log(e),Math.log(t)).fmap(Math.exp)}),range2=register("range2",function(e,t,o){return o.fromBipolar()._range(e,t)}),ratio=register("ratio",e=>e.fmap(t=>Array.isArray(t)?t.slice(1).reduce((o,a)=>o/a,t[0]):t)),compress=register("compress",function(e,t,o){return e=Fraction(e),t=Fraction(t),e.gt(t)||e.gt(1)||t.gt(1)||e.lt(0)||t.lt(0)?silence:o._fastGap(Fraction(1).div(t.sub(e)))._late(e)}),{compressSpan,compressspan}=register(["compressSpan","compressspan"],function(e,t){return t._compress(e.begin,e.end)}),{fastGap,fastgap}=register(["fastGap","fastgap"],function(e,t){const o=function(u){const l=u.begin.sam(),p=u.begin.sub(l).mul(e).min(1),d=u.end.sub(l).mul(e).min(1);if(!(p>=1))return new TimeSpan(l.add(p),l.add(d))},a=function(u){const l=u.part.begin,p=u.part.end,d=l.sam(),g=l.sub(d).div(e).min(1),f=p.sub(d).div(e).min(1),A=new TimeSpan(d.add(g),d.add(f)),b=u.whole?new TimeSpan(A.begin.sub(l.sub(u.whole.begin).div(e)),A.end.add(u.whole.end.sub(p).div(e))):void 0;return new Hap(b,A,u.value,u.context)};return t.withQuerySpanMaybe(o).withHap(a).splitQueries()}),focus=register("focus",function(e,t,o){return e=Fraction(e),t=Fraction(t),o._early(e.sam())._fast(Fraction(1).div(t.sub(e)))._late(e)}),{focusSpan,focusspan}=register(["focusSpan","focusspan"],function(e,t){return t._focus(e.begin,e.end)}),ply=register("ply",function(e,t){const o=t.fmap(a=>pure(a)._fast(e)).squeezeJoin();return __steps&&(o._steps=Fraction(e).mulmaybe(t._steps)),o}),{fast,density:density$1}=register(["fast","density"],function(e,t){return e===0?silence:(e=Fraction(e),t.withQueryTime(a=>a.mul(e)).withHapTime(a=>a.div(e)).setSteps(t._steps))},!0,!0),hurry=register("hurry",function(e,t){return t._fast(e).mul(pure({speed:e}))}),{slow,sparsity}=register(["slow","sparsity"],function(e,t){return e===0?silence:t._fast(Fraction(1).div(e))}),inside=register("inside",function(e,t,o){return t(o._slow(e))._fast(e)}),outside=register("outside",function(e,t,o){return t(o._fast(e))._slow(e)}),lastOf=register("lastOf",function(e,t,o){const a=Array(e-1).fill(o);return a.push(t(o)),slowcatPrime(...a)}),{firstOf,every}=register(["firstOf","every"],function(e,t,o){const a=Array(e-1).fill(o);return a.unshift(t(o)),slowcatPrime(...a)}),apply=register("apply",function(e,t){return e(t)}),cpm=register("cpm",function(e,t){return t._fast(e/60/1)}),early=register("early",function(e,t){return e=Fraction(e),t.withQueryTime(o=>o.add(e)).withHapTime(o=>o.sub(e))},!0,!0),late=register("late",function(e,t){return e=Fraction(e),t._early(Fraction(0).sub(e))},!0,!0),zoom=register("zoom",function(e,t,o){if(t=Fraction(t),e=Fraction(e),e.gte(t))return nothing;const a=t.sub(e),u=__steps?o._steps?.mulmaybe(a):void 0;return o.withQuerySpan(l=>l.withCycle(p=>p.mul(a).add(e))).withHapSpan(l=>l.withCycle(p=>p.sub(e).div(a))).splitQueries().setSteps(u)}),{zoomArc,zoomarc}=register(["zoomArc","zoomarc"],function(e,t){return t.zoom(e.begin,e.end)}),bite=register("bite",(e,t,o)=>t.fmap(a=>u=>{const l=Fraction(a).div(u).mod(1),p=l.add(Fraction(1).div(u));return o.zoom(l,p)}).appLeft(e).squeezeJoin(),!1),linger=register("linger",function(e,t){return e==0?silence:e<0?t._zoom(e.add(1),1)._slow(e):t._zoom(0,e)._slow(e)},!0,!0),{segment,seg}=register(["segment","seg"],function(e,t){return t.struct(pure(!0)._fast(e)).setSteps(e)}),swingBy=register("swingBy",(e,t,o)=>o.inside(t,late(seq(0,e/2)))),swing=register("swing",(e,t)=>t.swingBy(1/3,e)),{invert:invert$1,inv}=register(["invert","inv"],function(e){return e.fmap(t=>!t)},!0,!0),when=register("when",function(e,t,o){return e?t(o):o}),off=register("off",function(e,t,o){return stack(o,t(o.late(e)))}),brak=register("brak",function(e){return e.when(slowcat(!1,!0),t=>fastcat(t,silence)._late(.25))}),rev=register("rev",function(e){const t=function(o){const a=o.span,u=a.begin.sam(),l=a.begin.nextSam(),p=function(g){const f=g.withTime(b=>u.add(l.sub(b))),A=f.begin;return f.begin=f.end,f.end=A,f};return e.query(o.setSpan(p(a))).map(g=>g.withSpan(p))};return new Pattern$1(t).splitQueries()},!1,!0),revv=register("revv",function(e){const t=o=>new TimeSpan(Fraction(0).sub(o.end),Fraction(0).sub(o.begin));return e.withQuerySpan(t).withHapSpan(t)}),pressBy=register("pressBy",function(e,t){return t.fmap(o=>pure(o).compress(e,1)).squeezeJoin()}),press=register("press",function(e){return e._pressBy(.5)});Pattern$1.prototype.hush=function(){return silence};const palindrome=register("palindrome",function(e){return e.lastOf(2,rev)},!0,!0),{juxBy,juxby}=register(["juxBy","juxby"],function(e,t,o){e/=2;const a=function(p,d,g){return d in p?p[d]:g},u=o.withValue(p=>Object.assign({},p,{pan:a(p,"pan",.5)-e})),l=t(o.withValue(p=>Object.assign({},p,{pan:a(p,"pan",.5)+e})));return stack(u,l).setSteps(__steps?lcm(u._steps,l._steps):void 0)}),jux=register("jux",function(e,t){return t._juxBy(1,e,t)}),{echoWith,echowith,stutWith,stutwith}=register(["echoWith","echowith","stutWith","stutwith"],function(e,t,o,a){return stack(...listRange(0,e-1).map(u=>o(a.late(Fraction(t).mul(u)),u)))}),echo=register("echo",function(e,t,o,a){return a._echoWith(e,t,(u,l)=>u.gain(Math.pow(o,l)))}),stut=register("stut",function(e,t,o,a){return a._echoWith(e,o,(u,l)=>u.gain(Math.pow(t,l)))}),applyN=register("applyN",function(e,t,o){let a=o;for(let u=0;u<e;u++)a=t(a);return a}),plyWith=register(["plyWith","plywith"],function(e,t,o){const a=o.fmap(u=>cat(...listRange(0,e-1).map(l=>applyN(l,t,u)))._fast(e)).squeezeJoin();return __steps&&(a._steps=Fraction(e).mulmaybe(o._steps)),a}),plyForEach=register(["plyForEach","plyforeach"],function(e,t,o){const a=o.fmap(u=>cat(cat(pure(u),...listRange(1,e-1).map(l=>t(pure(u),l))))._fast(e)).squeezeJoin();return __steps&&(a._steps=Fraction(e).mulmaybe(o._steps)),a}),_iter=function(e,t,o=!1){return e=Fraction(e),slowcat(...listRange(0,e.sub(1)).map(a=>o?t.late(Fraction(a).div(e)):t.early(Fraction(a).div(e))))},iter=register("iter",function(e,t){return _iter(e,t,!1)},!0,!0),{iterBack,iterback}=register(["iterBack","iterback"],function(e,t){return _iter(e,t,!0)},!0,!0),{repeatCycles}=register("repeatCycles",function(e,t){return new Pattern$1(function(o){const a=o.span.begin.sam(),u=a.div(e).sam(),l=a.sub(u);return o=o.withSpan(p=>p.withTime(d=>d.sub(l))),t.query(o).map(p=>p.withSpan(d=>d.withTime(g=>g.add(l))))}).splitQueries()},!0,!0),_chunk=function(e,t,o,a=!1,u=!1){const l=Array(e-1).fill(!1);l.unshift(!0);const p=_iter(e,sequence(...l),!a);return u||(o=o.repeatCycles(e)),o.when(p,t)},{chunk,slowchunk,slowChunk}=register(["chunk","slowchunk","slowChunk"],function(e,t,o){return _chunk(e,t,o,!1,!1)},!0,!0),{chunkBack,chunkback}=register(["chunkBack","chunkback"],function(e,t,o){return _chunk(e,t,o,!0)},!0,!0),{fastchunk,fastChunk}=register(["fastchunk","fastChunk"],function(e,t,o){return _chunk(e,t,o,!1,!0)},!0,!0),{chunkinto,chunkInto}=register(["chunkinto","chunkInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iterback(e),t)}),{chunkbackinto,chunkBackInto}=register(["chunkbackinto","chunkBackInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iter(e)._early(1),t)}),bypass=register("bypass",function(e,t){return e=!!parseInt(e),e?silence:t},!0,!0),{ribbon,rib}=register(["ribbon","rib"],(e,t,o)=>o.early(e).restart(pure(1).slow(t))),hsla=register("hsla",(e,t,o,a,u)=>u.color(`hsla(${e}turn,${t*100}%,${o*100}%,${a})`)),hsl=register("hsl",(e,t,o,a)=>a.color(`hsl(${e}turn,${t*100}%,${o*100}%)`));Pattern$1.prototype.tag=function(e){return this.withContext(t=>({...t,tags:(t.tags||[]).concat([e])}))};const filter$1=register("filter",(e,t)=>t.withHaps(o=>o.filter(e))),filterWhen=register("filterWhen",(e,t)=>t.filter(o=>e(o.whole.begin))),within=register("within",(e,t,o,a)=>stack(o(a.filterWhen(u=>u.cyclePos()>=e&&u.cyclePos()<=t)),a.filterWhen(u=>u.cyclePos()<e||u.cyclePos()>t)));Pattern$1.prototype.stepJoin=function(){const e=this,t=stepcat(..._retime(_slices(e.queryArc(0,1))))._steps,o=function(a){const l=e.early(a.span.begin.sam()).query(a.setSpan(new TimeSpan(Fraction(0),Fraction(1))));return stepcat(..._retime(_slices(l))).query(a)};return new Pattern$1(o,t)},Pattern$1.prototype.stepBind=function(e){return this.fmap(e).stepJoin()};function _retime(e){const t=e.filter((l,p)=>p.hasSteps).reduce((l,p)=>l.add(p),Fraction(0)),o=removeUndefineds(e.map((l,p)=>p._steps)).reduce((l,p)=>l.add(p),Fraction(0)),a=t.eq(0)?void 0:o.div(t);function u(l,p){return p._steps===void 0?[l.mulmaybe(a),p]:[p._steps,p]}return e.map(l=>u(...l))}function _slices(e){const t=flatten(e.map(u=>[u.part.begin,u.part.end])),o=uniqsortr([Fraction(0),Fraction(1),...t]);return pairs(o).map(u=>[u[1].sub(u[0]),stack(..._fitslice(new TimeSpan(...u),e).map(l=>l.value.withHap(p=>p.setContext(p.combineContext(l)))))])}function _fitslice(e,t){return removeUndefineds(t.map(o=>_match(e,o)))}function _match(e,t){const o=e.intersection(t.part);if(o!=null)return new Hap(t.whole,o,t.value,t.context)}const pace=register("pace",function(e,t){return t._steps===void 0?t:t._steps.eq(Fraction(0))?nothing:t._fast(Fraction(e).div(t._steps)).setSteps(e)});function _polymeterListSteps(e,...t){const o=t.map(u=>_sequenceCount(u));if(o.length==0)return silence;e==0&&(e=o[0][1]);const a=[];for(const u of o)u[1]!=0&&(e==u[1]?a.push(u[0]):a.push(u[0]._fast(Fraction(e).div(Fraction(u[1])))));return stack(...a)}function polymeter(...e){if(Array.isArray(e[0]))return _polymeterListSteps(0,...e);if(e=e.filter(a=>a.hasSteps),e.length==0)return silence;const t=lcm(...e.map(a=>a._steps));if(t.eq(Fraction(0)))return nothing;const o=stack(...e.map(a=>a.pace(t)));return o._steps=t,o}function stepcat(...e){if(e.length===0)return nothing;const t=p=>Array.isArray(p)?p:[p._steps??1,p];if(e=e.map(t),e.find(p=>p[0]===void 0)){const p=e.map(g=>g[0]).filter(g=>g!==void 0);if(p.length===0)return fastcat(...e.map(g=>g[1]));if(p.length===e.length)return nothing;const d=p.reduce((g,f)=>g.add(f),Fraction(0)).div(p.length);for(let g of e)g[0]===void 0&&(g[0]=d)}if(e.length==1)return reify(e[0][1]).withSteps(d=>e[0][0]);const o=e.map(p=>p[0]).reduce((p,d)=>p.add(d),Fraction(0));let a=Fraction(0);const u=[];for(const[p,d]of e){if(Fraction(p).eq(0))continue;const g=a.add(p);u.push(reify(d)._compress(a.div(o),g.div(o))),a=g}const l=stack(...u);return l._steps=o,l}function stepalt(...e){e=e.map(u=>Array.isArray(u)?u.map(reify):[reify(u)]);const t=lcm(...e.map(u=>Fraction(u.length)));let o=[];for(let u=0;u<t;++u)o.push(...e.map(l=>l.length==0?silence:l[u%l.length]));o=o.filter(u=>u.hasSteps&&u._steps>0);const a=o.reduce((u,l)=>u.add(l._steps),Fraction(0));return o=stepcat(...o),o._steps=a,o}const take=stepRegister("take",function(e,t){if(!t.hasSteps||t._steps.lte(0)||(e=Fraction(e),e.eq(0)))return nothing;const o=e<0;o&&(e=e.abs());const a=e.div(t._steps);return a.lte(0)?nothing:a.gte(1)?t:o?t.zoom(Fraction(1).sub(a),1):t.zoom(0,a)}),drop=stepRegister("drop",function(e,t){return t.hasSteps?(e=Fraction(e),e.lt(0)?t.take(t._steps.add(e)):t.take(Fraction(0).sub(t._steps.sub(e)))):nothing}),extend=stepRegister("extend",function(e,t){return t.fast(e).expand(e)}),replicate=stepRegister("replicate",function(e,t){return t.repeatCycles(e).fast(e).expand(e)}),expand=stepRegister("expand",function(e,t){return t.withSteps(o=>o.mul(Fraction(e)))}),contract=stepRegister("contract",function(e,t){return t.withSteps(o=>o.div(Fraction(e)))});Pattern$1.prototype.shrinklist=function(e){const t=this;if(!t.hasSteps)return[t];let[o,a]=Array.isArray(e)?e:[e,t._steps];if(o=Fraction(o),a===0||o===0)return[t];const u=o>0,l=[];if(u){const p=Fraction(1).div(t._steps).mul(o);for(let d=0;d<a;++d){const g=p.mul(d);if(g.gt(1))break;l.push([g,1])}}else{o=Fraction(0).sub(o);const p=Fraction(1).div(t._steps).mul(o);for(let d=0;d<a;++d){const g=Fraction(1).sub(p.mul(d));if(g.lt(0))break;l.push([Fraction(0),g])}}return l.map(p=>t.zoom(...p))};const shrinklist=(e,t)=>t.shrinklist(e),shrink=register("shrink",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(e),a=stepcat(...o);return a._steps=o.reduce((u,l)=>u.add(l._steps),Fraction(0)),a},!0,!1,e=>e.stepJoin()),grow=register("grow",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(Fraction(0).sub(e));o.reverse();const a=stepcat(...o);return a._steps=o.reduce((u,l)=>u.add(l._steps),Fraction(0)),a},!0,!1,e=>e.stepJoin()),tour=function(e,...t){return e.tour(...t)};Pattern$1.prototype.tour=function(...e){return stepcat(...[].concat(...e.map((t,o)=>[...e.slice(0,e.length-o),this,...e.slice(e.length-o)]),this,...e))};const zip=function(...e){e=e.filter(a=>a.hasSteps);const t=slowcat(...e.map(a=>a._slow(a._steps))),o=lcm(...e.map(a=>a._steps));return t._fast(o).setSteps(o)},timecat=stepcat,timeCat=stepcat,s_cat=stepcat,s_alt=stepalt,s_polymeter=polymeter;Pattern$1.prototype.s_polymeter=Pattern$1.prototype.polymeter;const s_taper=shrink;Pattern$1.prototype.s_taper=Pattern$1.prototype.shrink;const s_taperlist=shrinklist;Pattern$1.prototype.s_taperlist=Pattern$1.prototype.shrinklist;const s_add=take;Pattern$1.prototype.s_add=Pattern$1.prototype.take;const s_sub=drop;Pattern$1.prototype.s_sub=Pattern$1.prototype.drop;const s_expand=expand;Pattern$1.prototype.s_expand=Pattern$1.prototype.expand;const s_extend=extend;Pattern$1.prototype.s_extend=Pattern$1.prototype.extend;const s_contract=contract;Pattern$1.prototype.s_contract=Pattern$1.prototype.contract;const s_tour=tour;Pattern$1.prototype.s_tour=Pattern$1.prototype.tour;const s_zip=zip;Pattern$1.prototype.s_zip=Pattern$1.prototype.zip;const steps$2=pace;Pattern$1.prototype.steps=Pattern$1.prototype.pace;const chop=register("chop",function(e,t){const a=Array.from({length:e},(p,d)=>d).map(p=>({begin:p/e,end:(p+1)/e})),u=function(p,d){if("begin"in p&&"end"in p&&p.begin!==void 0&&p.end!==void 0){const g=p.end-p.begin;d={begin:p.begin+d.begin*g,end:p.begin+d.end*g}}return Object.assign({},p,d)},l=function(p){return sequence(a.map(d=>u(p,d)))};return t.squeezeBind(l).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),striate=register("striate",function(e,t){const a=Array.from({length:e},(l,p)=>p).map(l=>({begin:l/e,end:(l+1)/e})),u=slowcat(...a);return t.set(u)._fast(e).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),_loopAt=function(e,t,o=.5){return t.speed(1/e*o).unit("c").slow(e)},slice=register("slice",function(e,t,o){return e.innerBind(a=>t.outerBind(u=>o.outerBind(l=>{l=l instanceof Object?l:{s:l};const p=Array.isArray(a)?a[u]:u/a,d=Array.isArray(a)?a[u+1]:(u+1)/a;return pure({begin:p,end:d,_slices:a,...l})}))).setSteps(t._steps)},!1);Pattern$1.prototype.onTriggerTime=function(e){return this.onTrigger((t,o,a,u)=>{const l=u-o;window.setTimeout(()=>{e(t)},l*1e3)},!1)};const splice=register("splice",function(e,t,o){const a=slice(e,t,o);return new Pattern$1(u=>{const l=u.controls._cps||1;return a.query(u).map(d=>d.withValue(g=>({speed:l/g._slices/d.whole.duration*(g.speed||1),unit:"c",...g})))}).setSteps(t._steps)},!1),{loopAt,loopat}=register(["loopAt","loopat"],function(e,t){const o=t._steps?t._steps.div(e):void 0;return new Pattern$1(a=>_loopAt(e,t,a.controls._cps).query(a),o)}),fit=register("fit",e=>e.withHaps((t,o)=>t.map(a=>a.withValue(u=>{const l=("end"in u?u.end:1)-("begin"in u?u.begin:0);return{...u,speed:(o.controls._cps||1)/a.whole.duration*l,unit:"c"}})))),{loopAtCps,loopatcps}=register(["loopAtCps","loopatcps"],function(e,t,o){return _loopAt(e,o,t)}),ref$1=e=>pure(1).withValue(()=>reify(e())).innerJoin();let fadeGain=e=>e<.5?1:1-(e-.5)/.5,xfade=(e,t,o)=>{t=reify(t),e=reify(e),o=reify(o);let a=t.fmap(l=>({gain:fadeGain(l)})),u=t.fmap(l=>({gain:fadeGain(1-l)}));return stack(e.mul(a),o.mul(u))};Pattern$1.prototype.xfade=function(e,t){return xfade(this,e,t)};const __beat=e=>(t,o,a)=>{t=Fraction(t).mod(o),o=Fraction(o);const u=t.div(o),l=t.add(1).div(o);return e(a.fmap(p=>pure(p)._compress(u,l)))},{beat}=register(["beat"],__beat(e=>e.innerJoin())),_morph=(e,t,o)=>{o=Fraction(o);const a=Fraction(1).div(e.length),u=d=>{const g=[];for(const[f,A]of d.entries())A&&g.push([Fraction(f).div(d.length),A]);return g},l=zipWith(([d,g],[f,A])=>{const b=o.mul(f-d).add(d),F=b.add(a);return new TimeSpan(b,F)},u(e),u(t));function p(d){const g=d.span.begin.sam(),f=d.span.cycleArc(),A=[];for(const b of l){const F=b.intersection(f);F!==void 0&&A.push(new Hap(b.withTime(S=>S.add(g)),F.withTime(S=>S.add(g)),!0))}return A}return new Pattern$1(p).splitQueries()},morph=(e,t,o)=>(e=reify(e),t=reify(t),o=reify(o),e.innerBind(a=>t.innerBind(u=>o.innerBind(l=>_morph(a,u,l))))),distAlgoNames=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const e of distAlgoNames)Pattern$1.prototype[e]=function(t){const o=reify(t).fmap(a=>Array.isArray(a)?[...a,e]:[a,1,e]);return this.distort(o)};const parray=e=>{let o=pure(curry((...a)=>a,null,e.length));for(const a of e)o=o.appBoth(reify(a));return o},_ensureListPattern=e=>Array.isArray(e)?parray(e):reify(e);Pattern$1.prototype.partials=function(e){return this.withValue(t=>o=>({...t,partials:o})).appLeft(_ensureListPattern(e))};const partials=e=>_ensureListPattern(e).as("partials");Pattern$1.prototype.phases=function(e){return this.withValue(t=>o=>({...t,phases:o})).appLeft(_ensureListPattern(e))};const phases=e=>_ensureListPattern(e).as("phases");function createParam(e){let t=Array.isArray(e);e=t?e:[e];const o=e[0],a=l=>{let p;if(typeof l=="object"&&l.value!==void 0&&(p={...l},l=l.value,delete p.value),t&&Array.isArray(l)){const d=p||{};return l.forEach((g,f)=>{f<e.length&&(d[e[f]]=g)}),d}else return p?(p[o]=l,p):{[o]:l}},u=function(l,p){return p?typeof l>"u"?p.fmap(a):p.set(reify(l).withValue(a)):reify(l).withValue(a)};return Pattern$1.prototype[o]=function(l){return u(l,this)},u}const controlAlias=new Map;function isControlName(e){return controlAlias.has(e)}function registerControl(e,...t){const o=Array.isArray(e)?e[0]:e;let a={};return a[o]=createParam(e),controlAlias.set(o,o),t.forEach(u=>{a[u]=a[o],controlAlias.set(u,o),Pattern$1.prototype[u]=Pattern$1.prototype[o]}),a}const{s,sound}=registerControl(["s","n","gain"],"sound"),{wt,wavetablePosition}=registerControl("wt","wavetablePosition"),{wtenv}=registerControl("wtenv"),{wtattack,wtatt}=registerControl("wtattack","wtatt"),{wtdecay,wtdec}=registerControl("wtdecay","wtdec"),{wtsustain,wtsus}=registerControl("wtsustain","wtsus"),{wtrelease,wtrel}=registerControl("wtrelease","wtrel"),{wtrate}=registerControl("wtrate"),{wtsync}=registerControl("wtsync"),{wtdepth}=registerControl("wtdepth"),{wtshape}=registerControl("wtshape"),{wtdc}=registerControl("wtdc"),{wtskew}=registerControl("wtskew"),{warp,wavetableWarp}=registerControl("warp","wavetableWarp"),{warpattack,warpatt}=registerControl("warpattack","warpatt"),{warpdecay,warpdec}=registerControl("warpdecay","warpdec"),{warpsustain,warpsus}=registerControl("warpsustain","warpsus"),{warprelease,warprel}=registerControl("warprelease","warprel"),{warprate}=registerControl("warprate"),{warpdepth}=registerControl("warpdepth"),{warpshape}=registerControl("warpshape"),{warpdc}=registerControl("warpdc"),{warpskew}=registerControl("warpskew"),{warpmode,wavetableWarpMode}=registerControl("warpmode","wavetableWarpMode"),{wtphaserand,wavetablePhaseRand}=registerControl("wtphaserand","wavetablePhaseRand"),{warpenv}=registerControl("warpenv"),{warpsync}=registerControl("warpsync"),{source,src}=registerControl("source","src"),{n}=registerControl("n"),{note:note$2}=registerControl(["note","n"]),{accelerate}=registerControl("accelerate"),{velocity}=registerControl("velocity"),{gain}=registerControl("gain"),{postgain}=registerControl("postgain"),{amp}=registerControl("amp"),{attack,att}=registerControl("attack","att"),{fmh}=registerControl(["fmh","fmi"],"fmh"),{fmi,fm:fm$1}=registerControl(["fmi","fmh"],"fm"),{fmenv}=registerControl("fmenv"),{fmattack}=registerControl("fmattack"),{fmwave}=registerControl("fmwave"),{fmdecay}=registerControl("fmdecay"),{fmsustain}=registerControl("fmsustain"),{fmrelease}=registerControl("fmrelease"),{fmvelocity}=registerControl("fmvelocity"),{bank}=registerControl("bank"),{chorus}=registerControl("chorus"),{analyze}=registerControl("analyze"),{fft}=registerControl("fft"),{decay,dec}=registerControl("decay","dec"),{sustain,sus}=registerControl("sustain","sus"),{release,rel}=registerControl("release","rel"),{hold}=registerControl("hold"),{bandf,bpf,bp}=registerControl(["bandf","bandq","bpenv"],"bpf","bp"),{bandq,bpq}=registerControl("bandq","bpq"),{begin}=registerControl("begin"),{end}=registerControl("end"),{loop}=registerControl("loop"),{loopBegin,loopb}=registerControl("loopBegin","loopb"),{loopEnd,loope}=registerControl("loopEnd","loope"),{crush}=registerControl("crush"),{coarse}=registerControl("coarse"),{tremolo}=registerControl(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync}=registerControl(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth}=registerControl("tremolodepth","tremdepth"),{tremoloskew}=registerControl("tremoloskew","tremskew"),{tremolophase}=registerControl("tremolophase","tremphase"),{tremoloshape}=registerControl("tremoloshape","tremshape"),{drive}=registerControl("drive"),{duck}=registerControl("duckorbit","duck"),{duckdepth}=registerControl("duckdepth"),{duckonset}=registerControl("duckonset","duckons"),{duckattack}=registerControl("duckattack","duckatt"),{byteBeatExpression,bbexpr}=registerControl("byteBeatExpression","bbexpr"),{byteBeatStartTime,bbst}=registerControl("byteBeatStartTime","bbst"),{channels,ch}=registerControl("channels","ch"),{pw}=registerControl(["pw","pwrate","pwsweep"]),{pwrate}=registerControl("pwrate"),{pwsweep}=registerControl("pwsweep"),{phaserrate,ph,phaser}=registerControl(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep,phs}=registerControl("phasersweep","phs"),{phasercenter,phc}=registerControl("phasercenter","phc"),{phaserdepth,phd,phasdp}=registerControl("phaserdepth","phd","phasdp"),{channel}=registerControl("channel"),{cut}=registerControl("cut"),{cutoff,ctf,lpf,lp}=registerControl(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv,lpe}=registerControl("lpenv","lpe"),{hpenv,hpe}=registerControl("hpenv","hpe"),{bpenv,bpe}=registerControl("bpenv","bpe"),{lpattack,lpa}=registerControl("lpattack","lpa"),{hpattack,hpa}=registerControl("hpattack","hpa"),{bpattack,bpa}=registerControl("bpattack","bpa"),{lpdecay,lpd}=registerControl("lpdecay","lpd"),{hpdecay,hpd}=registerControl("hpdecay","hpd"),{bpdecay,bpd}=registerControl("bpdecay","bpd"),{lpsustain,lps}=registerControl("lpsustain","lps"),{hpsustain,hps}=registerControl("hpsustain","hps"),{bpsustain,bps}=registerControl("bpsustain","bps"),{lprelease,lpr}=registerControl("lprelease","lpr"),{hprelease,hpr}=registerControl("hprelease","hpr"),{bprelease,bpr}=registerControl("bprelease","bpr"),{ftype}=registerControl("ftype"),{fanchor}=registerControl("fanchor"),{lprate}=registerControl("lprate"),{lpsync}=registerControl("lpsync"),{lpdepth}=registerControl("lpdepth"),{lpdepthfrequency}=registerControl("lpdepthfrequency","lpdepthfreq"),{lpshape}=registerControl("lpshape"),{lpdc}=registerControl("lpdc"),{lpskew}=registerControl("lpskew"),{bprate}=registerControl("bprate"),{bpsync}=registerControl("bpsync"),{bpdepth}=registerControl("bpdepth"),{bpdepthfrequency}=registerControl("bpdepthfrequency","bpdepthfreq"),{bpshape}=registerControl("bpshape"),{bpdc}=registerControl("bpdc"),{bpskew}=registerControl("bpskew"),{hprate}=registerControl("hprate"),{hpsync}=registerControl("hpsync"),{hpdepth,hpdepthfreq}=registerControl("hpdepth"),{hpdepthfrequency}=registerControl("hpdepthfrequency","hpdepthfreq"),{hpshape}=registerControl("hpshape"),{hpdc}=registerControl("hpdc"),{hpskew}=registerControl("hpskew"),{vib,vibrato,v}=registerControl(["vib","vibmod"],"vibrato","v"),{noise}=registerControl("noise"),{vibmod,vmod}=registerControl(["vibmod","vib"],"vmod"),{hcutoff,hpf,hp}=registerControl(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance,hpq}=registerControl("hresonance","hpq"),{resonance,lpq}=registerControl("resonance","lpq"),{djf}=registerControl("djf"),{delay}=registerControl(["delay","delaytime","delayfeedback"]),{delayfeedback,delayfb,dfb}=registerControl("delayfeedback","delayfb","dfb"),{delayspeed}=registerControl("delayspeed"),{delaytime,delayt,dt}=registerControl("delaytime","delayt","dt"),{delaysync}=registerControl("delaysync"),{lock}=registerControl("lock"),{detune,det}=registerControl("detune","det"),{unison}=registerControl("unison"),{spread}=registerControl("spread"),{dry}=registerControl("dry"),{fadeTime,fadeOutTime}=registerControl("fadeTime","fadeOutTime"),{fadeInTime}=registerControl("fadeInTime"),{freq:freq$1}=registerControl("freq"),{pattack,patt}=registerControl("pattack","patt"),{pdecay,pdec}=registerControl("pdecay","pdec"),{psustain,psus}=registerControl("psustain","psus"),{prelease,prel}=registerControl("prelease","prel"),{penv}=registerControl("penv"),{pcurve}=registerControl("pcurve"),{panchor}=registerControl("panchor"),{gate,gat}=registerControl("gate","gat"),{leslie}=registerControl("leslie"),{lrate}=registerControl("lrate"),{lsize}=registerControl("lsize"),{activeLabel}=registerControl("activeLabel"),{label}=registerControl(["label","activeLabel"]),{degree}=registerControl("degree"),{mtranspose}=registerControl("mtranspose"),{ctranspose}=registerControl("ctranspose"),{harmonic}=registerControl("harmonic"),{stepsPerOctave}=registerControl("stepsPerOctave"),{octaveR}=registerControl("octaveR"),{nudge}=registerControl("nudge"),{octave:octave$1,oct}=registerControl("octave","oct"),{orbit}=registerControl("orbit","o"),{overgain}=registerControl("overgain"),{overshape}=registerControl("overshape"),{pan}=registerControl("pan"),{panspan}=registerControl("panspan"),{pansplay}=registerControl("pansplay"),{panwidth}=registerControl("panwidth"),{panorient}=registerControl("panorient"),{rate}=registerControl("rate"),{slide}=registerControl("slide"),{semitone}=registerControl("semitone"),{voice}=registerControl("voice"),{chord:chord$1}=registerControl("chord"),{dictionary:dictionary$5,dict}=registerControl("dictionary","dict"),{anchor}=registerControl("anchor"),{offset}=registerControl("offset"),{octaves}=registerControl("octaves"),{mode:mode$1}=registerControl(["mode","anchor"]),{room}=registerControl(["room","size"]),{roomlp,rlp}=registerControl("roomlp","rlp"),{roomdim,rdim}=registerControl("roomdim","rdim"),{roomfade,rfade}=registerControl("roomfade","rfade"),{ir,iresponse}=registerControl(["ir","i"],"iresponse"),{irspeed}=registerControl("irspeed"),{irbegin}=registerControl("irbegin"),{roomsize,size,sz,rsize}=registerControl("roomsize","size","sz","rsize"),{shape}=registerControl(["shape","shapevol"]),{distort,dist:dist$2}=registerControl(["distort","distortvol","distorttype"],"dist"),{distortvol}=registerControl("distortvol","distvol"),{distorttype}=registerControl("distorttype","disttype"),{compressor}=registerControl(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee}=registerControl("compressorKnee"),{compressorRatio}=registerControl("compressorRatio"),{compressorAttack}=registerControl("compressorAttack"),{compressorRelease}=registerControl("compressorRelease"),{speed}=registerControl("speed"),{stretch}=registerControl("stretch"),{unit}=registerControl("unit"),{squiz}=registerControl("squiz"),{vowel}=registerControl("vowel"),{waveloss}=registerControl("waveloss"),{density}=registerControl("density"),{expression}=registerControl("expression"),{sustainpedal}=registerControl("sustainpedal"),{fshift}=registerControl("fshift"),{fshiftnote}=registerControl("fshiftnote"),{fshiftphase}=registerControl("fshiftphase"),{triode}=registerControl("triode"),{krush}=registerControl("krush"),{kcutoff}=registerControl("kcutoff"),{octer}=registerControl("octer"),{octersub}=registerControl("octersub"),{octersubsub}=registerControl("octersubsub"),{ring}=registerControl("ring"),{ringf}=registerControl("ringf"),{ringdf}=registerControl("ringdf"),{freeze}=registerControl("freeze"),{xsdelay}=registerControl("xsdelay"),{tsdelay}=registerControl("tsdelay"),{real}=registerControl("real"),{imag}=registerControl("imag"),{enhance}=registerControl("enhance"),{comb}=registerControl("comb"),{smear:smear$1}=registerControl("smear"),{scram}=registerControl("scram"),{binshift}=registerControl("binshift"),{hbrick}=registerControl("hbrick"),{lbrick}=registerControl("lbrick"),{frameRate}=registerControl("frameRate"),{frames}=registerControl("frames"),{hours}=registerControl("hours"),{minutes}=registerControl("minutes"),{seconds}=registerControl("seconds"),{songPtr}=registerControl("songPtr"),{uid}=registerControl("uid"),{val}=registerControl("val"),{cps}=registerControl("cps"),{clip,legato}=registerControl("clip","legato"),{duration,dur}=registerControl("duration","dur"),{zrand}=registerControl("zrand"),{curve}=registerControl("curve"),{deltaSlide}=registerControl("deltaSlide"),{pitchJump}=registerControl("pitchJump"),{pitchJumpTime}=registerControl("pitchJumpTime"),{lfo,repeatTime}=registerControl("lfo","repeatTime"),{znoise}=registerControl("znoise"),{zmod}=registerControl("zmod"),{zcrush}=registerControl("zcrush"),{zdelay}=registerControl("zdelay"),{zzfx}=registerControl("zzfx"),{color,colour}=registerControl(["color","colour"]);let createParams=(...e)=>e.reduce((t,o)=>Object.assign(t,{[o]:createParam(o)}),{});const adsr=register("adsr",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,a,u,l]=e;return t.set({attack:o,decay:a,sustain:u,release:l})}),ad=register("ad",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,a=o]=e;return t.attack(o).decay(a)}),ds=register("ds",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,a=0]=e;return t.set({decay:o,sustain:a})}),ar=register("ar",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,a=o]=e;return t.set({attack:o,release:a})}),{midichan}=registerControl("midichan"),{midimap}=registerControl("midimap"),{midiport}=registerControl("midiport"),{midicmd}=registerControl("midicmd"),control=register("control",(e,t)=>{if(!Array.isArray(e))throw new Error("control expects an array of [ccn, ccv]");const[o,a]=e;return t.ccn(o).ccv(a)}),{ccn}=registerControl("ccn"),{ccv}=registerControl("ccv"),{ctlNum}=registerControl("ctlNum"),{nrpnn}=registerControl("nrpnn"),{nrpv}=registerControl("nrpv"),{progNum}=registerControl("progNum"),sysex=register("sysex",(e,t)=>{if(!Array.isArray(e))throw new Error("sysex expects an array of [id, data]");const[o,a]=e;return t.sysexid(o).sysexdata(a)}),{sysexid}=registerControl("sysexid"),{sysexdata}=registerControl("sysexdata"),{midibend}=registerControl("midibend"),{miditouch}=registerControl("miditouch"),{polyTouch}=registerControl("polyTouch"),{oschost}=registerControl("oschost"),{oscport}=registerControl("oscport"),getControlName=e=>controlAlias.has(e)?controlAlias.get(e):e,as=register("as",(e,t)=>(e=Array.isArray(e)?e:[e],t.fmap(o=>(o=Array.isArray(o)?o:[o],o=Object.fromEntries(e.map((a,u)=>[getControlName(a),o[u]])),o)))),scrub=register("scrub",(e,t)=>e.outerBind(o=>{Array.isArray(o)||(o=[o]);const[a,u=1]=o;return t.begin(a).mul(speed(u)).clip(1)}),!1),controls=Object.freeze(Object.defineProperty({__proto__:null,accelerate,activeLabel,ad,adsr,amp,analyze,anchor,ar,as,att,attack,bandf,bandq,bank,bbexpr,bbst,begin,binshift,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,byteBeatExpression,byteBeatStartTime,ccn,ccv,ch,channel,channels,chord:chord$1,chorus,clip,coarse,color,colour,comb,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,control,cps,createParam,createParams,crush,ctf,ctlNum,ctranspose,curve,cut,cutoff,dec,decay,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,density,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,djf,drive,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,end,enhance,expression,fadeInTime,fadeOutTime,fadeTime,fanchor,fft,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,frameRate,frames,freeze,freq:freq$1,fshift,fshiftnote,fshiftphase,ftype,gain,gat,gate,getControlName,harmonic,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,imag,ir,irbegin,iresponse,irspeed,isControlName,kcutoff,krush,label,lbrick,legato,leslie,lfo,lock,loop,loopBegin,loopEnd,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mode:mode$1,mtranspose,n,noise,note:note$2,nrpnn,nrpv,nudge,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,offset,orbit,oschost,oscport,overgain,overshape,pan,panchor,panorient,panspan,pansplay,panwidth,patt,pattack,pcurve,pdec,pdecay,penv,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phc,phd,phs,pitchJump,pitchJumpTime,polyTouch,postgain,prel,prelease,progNum,psus,psustain,pw,pwrate,pwsweep,rate,rdim,real,registerControl,rel,release,repeatTime,resonance,rfade,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rsize,s,scram,scrub,seconds,semitone,shape,size,slide,smear:smear$1,songPtr,sound,source,speed,spread,squiz,src,stepsPerOctave,stretch,sus,sustain,sustainpedal,sysex,sysexdata,sysexid,sz,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,triode,tsdelay,uid,unison,unit,v,val,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xsdelay,zcrush,zdelay,zmod,znoise,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),left=function(e,t){const[o,a]=e,[u,l]=t,[p,d]=splitAt(a,u);return[[a,o-a],[zipWith((g,f)=>g.concat(f),p,l),d]]},right=function(e,t){const[o,a]=e,[u,l]=t,[p,d]=splitAt(o,l);return[[o,a-o],[zipWith((f,A)=>f.concat(A),u,p),d]]},_bjorklund=function(e,t){const[o,a]=e;return Math.min(o,a)<=1?[e,t]:_bjorklund(...o>a?left(e,t):right(e,t))},bjorklund=function(e,t){const o=e<0,a=Math.abs(e),u=t-a,l=Array(a).fill([1]),p=Array(u).fill([0]),d=_bjorklund([a,u],[l,p]),g=flatten(d[1][0]).concat(flatten(d[1][1]));return o?g.map(f=>1-f):g},_euclidRot=function(e,t,o){const a=bjorklund(e,t);return o?rotate$2(a,-o):a},euclid=register("euclid",function(e,t,o){return o.struct(_euclidRot(e,t,0))}),bjork=register("bjork",function(e,t){Array.isArray(e)||(e=[e]);const[o,a=o,u=0]=e;return t.struct(_euclidRot(o,a,u))}),{euclidrot,euclidRot}=register(["euclidrot","euclidRot"],function(e,t,o,a){return a.struct(_euclidRot(e,t,o))}),_euclidLegato=function(e,t,o,a){if(e<1)return silence;const l=_euclidRot(e,t,0).join("").split("1").slice(1).map(p=>[p.length+1,!0]);return a.struct(timeCat(...l)).late(Fraction(o).div(t))},euclidLegato=register(["euclidLegato"],function(e,t,o){return _euclidLegato(e,t,0,o)}),euclidLegatoRot=register(["euclidLegatoRot"],function(e,t,o,a){return _euclidLegato(e,t,o,a)}),{euclidish,eish}=register(["euclidish","eish"],function(e,t,o,a){const u=_morph(bjorklund(e,t),new Array(e).fill(1),o);return a.struct(u).setSteps(t)});function createClock(e,t,o=.05,a=.1,u=.1,l=globalThis.setInterval,p=globalThis.clearInterval,d=!0){let g=0,f=0,A=10**4,b=.01;const F=U=>o=U(o);u=u||a/2;const S=()=>{const U=e(),O=U+a+u;for(f===0&&(f=U+b);f<O;)f=d?Math.round(f*A)/A:f,t(f,o,g,U),f+=o,g++};let k;const $=()=>{R(),S(),k=l(S,a*1e3)},R=()=>{k!==void 0&&p(k),k=void 0};return{setDuration:F,start:$,stop:()=>{g=0,f=0,R()},pause:()=>R(),duration:o,interval:a,getPhase:()=>f,minLatency:b}}function steady(e){return new Pattern$1(t=>[new Hap(void 0,t.span,e)])}const signal=e=>{const t=o=>[new Hap(void 0,o.span,e(o.span.begin))];return new Pattern$1(t)},saw=signal(e=>e%1),saw2=saw.toBipolar(),isaw=signal(e=>1-e%1),isaw2=isaw.toBipolar(),sine2=signal(e=>Math.sin(Math.PI*2*e)),sine=sine2.fromBipolar(),cosine=sine._early(Fraction(1).div(4)),cosine2=sine2._early(Fraction(1).div(4)),square=signal(e=>Math.floor(e*2%2)),square2=square.toBipolar(),tri=fastcat(saw,isaw),tri2=fastcat(saw2,isaw2),itri=fastcat(isaw,saw),itri2=fastcat(isaw2,saw2),time$1=signal(id);let _mouseY=0,_mouseX=0;typeof window<"u"&&document.addEventListener("mousemove",e=>{_mouseY=e.clientY/document.body.clientHeight,_mouseX=e.clientX/document.body.clientWidth});const mousey=signal(()=>_mouseY),mouseY=signal(()=>_mouseY),mousex=signal(()=>_mouseX),mouseX=signal(()=>_mouseX),xorwise=e=>{const t=e<<13^e,o=t>>17^t;return o<<5^o},_frac=e=>e-Math.trunc(e),timeToIntSeed=e=>xorwise(Math.trunc(_frac(e/300)*536870912)),intSeedToRand=e=>e%536870912/536870912,timeToRand=e=>Math.abs(intSeedToRand(timeToIntSeed(e))),timeToRandsPrime=(e,t)=>{const o=[];for(let a=0;a<t;++a)o.push(intSeedToRand(e)),e=xorwise(e);return o},timeToRands=(e,t)=>timeToRandsPrime(timeToIntSeed(e),t),run=e=>saw.range(0,e).round().segment(e),binary=e=>{const t=reify(e).log2(0).floor().add(1);return binaryN(e,t)},binaryN=(e,t=16)=>{t=reify(t);const o=run(t).mul(-1).add(t.sub(1));return reify(e).segment(t).brshift(o).band(pure(1))},binaryL=e=>{const t=reify(e).log2(0).floor().add(1);return binaryNL(e,t)},binaryNL=(e,t=16)=>reify(e).withValue(o=>a=>{const u=[];for(let l=a-1;l>=0;l--)u.push(o>>l&1);return u}).appLeft(reify(t)),randL=e=>signal(t=>o=>timeToRands(t,o).map(Math.abs)).appLeft(reify(e)),randrun=e=>signal(t=>{const a=timeToRands(t.floor().add(.5),e).map((l,p)=>[l,p]).sort((l,p)=>(l[0]>p[0])-(l[0]<p[0])).map(l=>l[1]),u=t.cyclePos().mul(e).floor()%e;return a[u]})._segment(e),_rearrangeWith=(e,t,o)=>{const a=[...Array(t).keys()].map(u=>o.zoom(Fraction(u).div(t),Fraction(u+1).div(t)));return e.fmap(u=>a[u].repeatCycles(t)._fast(t)).innerJoin()},shuffle$2=register("shuffle",(e,t)=>_rearrangeWith(randrun(e),e,t)),scramble=register("scramble",(e,t)=>_rearrangeWith(_irand(e)._segment(e),e,t)),rand=signal(timeToRand),rand2=rand.toBipolar(),_brandBy=e=>rand.fmap(t=>t<e),brandBy=e=>reify(e).fmap(_brandBy).innerJoin(),brand=_brandBy(.5),_irand=e=>rand.fmap(t=>Math.trunc(t*e)),irand=e=>reify(e).fmap(_irand).innerJoin(),__chooseWith=(e,t)=>(t=t.map(reify),t.length==0?silence:e.range(0,t.length).fmap(o=>{const a=Math.min(Math.max(Math.floor(o),0),t.length-1);return t[a]})),chooseWith=(e,t)=>__chooseWith(e,t).outerJoin(),chooseInWith=(e,t)=>__chooseWith(e,t).innerJoin(),choose=(...e)=>chooseWith(rand,e),chooseIn=(...e)=>chooseInWith(rand,e),chooseOut=choose;Pattern$1.prototype.choose=function(...e){return chooseWith(this,e)},Pattern$1.prototype.choose2=function(...e){return chooseWith(this.fromBipolar(),e)};const chooseCycles=(...e)=>chooseInWith(rand.segment(1),e),randcat=chooseCycles,_wchooseWith=function(e,...t){const o=t.map(d=>reify(d[0])),a=[];let u=pure(0);for(const d of t)u=u.add(d[1]),a.push(u);const l=sequenceP(a),p=function(d){const g=u.mul(d);return l.fmap(f=>A=>o[f.findIndex(b=>b>A,f)]).appLeft(g)};return e.bind(p)},wchooseWith=(...e)=>_wchooseWith(...e).outerJoin(),wchoose=(...e)=>wchooseWith(rand,...e),wchooseCycles=(...e)=>_wchooseWith(rand.segment(1),...e).innerJoin(),wrandcat=wchooseCycles;function _perlin(e){let t=Math.floor(e),o=t+1;const a=p=>6*p**5-15*p**4+10*p**3;return(p=>d=>g=>d+a(p)*(g-d))(e-t)(timeToRand(t))(timeToRand(o))}const perlinWith=e=>e.fmap(_perlin);function _berlin(e){const t=Math.floor(e),o=t+1,a=timeToRand(t),u=timeToRand(o)+a,l=(e-t)/(o-t);return((d,g,f)=>d+(g-d)*f)(a,u,l)/2}const berlinWith=e=>e.fmap(_berlin),perlin=perlinWith(time$1.fmap(e=>Number(e))),berlin=berlinWith(time$1.fmap(e=>Number(e))),degradeByWith=register("degradeByWith",(e,t,o)=>o.fmap(a=>u=>a).appLeft(e.filterValues(a=>a>t)),!0,!0),degradeBy=register("degradeBy",function(e,t){return t._degradeByWith(rand,e)},!0,!0),degrade=register("degrade",e=>e._degradeBy(.5),!0,!0),undegradeBy=register("undegradeBy",function(e,t){return t._degradeByWith(rand.fmap(o=>1-o),e)},!0,!0),undegrade=register("undegrade",e=>e._undegradeBy(.5),!0,!0),sometimesBy=register("sometimesBy",function(e,t,o){return reify(e).fmap(a=>stack(o._degradeBy(a),t(o._undegradeBy(1-a)))).innerJoin()}),sometimes=register("sometimes",function(e,t){return t._sometimesBy(.5,e)}),someCyclesBy=register("someCyclesBy",function(e,t,o){return reify(e).fmap(a=>stack(o._degradeByWith(rand._segment(1),a),t(o._degradeByWith(rand.fmap(u=>1-u)._segment(1),1-a)))).innerJoin()}),someCycles=register("someCycles",function(e,t){return t._someCyclesBy(.5,e)}),often=register("often",function(e,t){return t.sometimesBy(.75,e)}),rarely=register("rarely",function(e,t){return t.sometimesBy(.25,e)}),almostNever=register("almostNever",function(e,t){return t.sometimesBy(.1,e)}),almostAlways=register("almostAlways",function(e,t){return t.sometimesBy(.9,e)}),never=register("never",function(e,t){return t}),always=register("always",function(e,t){return e(t)});function _keyDown(e){Array.isArray(e)===!1&&(e=[e]);const t=getCurrentKeyboardState();return e.every(o=>{const a=keyAlias.get(o)??o;return t[a]})}const whenKey=register("whenKey",function(e,t,o){return o.when(_keyDown(e),t)}),keyDown=register("keyDown",function(e){return e.fmap(_keyDown)}),_pick=function(e,t,o=!0){const a=Array.isArray(e),u=Object.keys(e).length;return e=objectMap(e,reify),u===0?silence:t.fmap(l=>{let p=l;return a&&(p=o?Math.round(p)%u:clamp$1(Math.round(p),0,e.length-1)),e[p]})},pick=function(e,t){return Array.isArray(t)&&([t,e]=[e,t]),__pick(e,t)},__pick=register("pick",function(e,t){return _pick(e,t,!1).innerJoin()}),pickmod=register("pickmod",function(e,t){return _pick(e,t,!0).innerJoin()}),pickF=register("pickF",function(e,t,o){return o.apply(pick(e,t))}),pickmodF=register("pickmodF",function(e,t,o){return o.apply(pickmod(e,t))}),pickOut=register("pickOut",function(e,t){return _pick(e,t,!1).outerJoin()}),pickmodOut=register("pickmodOut",function(e,t){return _pick(e,t,!0).outerJoin()}),pickRestart=register("pickRestart",function(e,t){return _pick(e,t,!1).restartJoin()}),pickmodRestart=register("pickmodRestart",function(e,t){return _pick(e,t,!0).restartJoin()}),pickReset=register("pickReset",function(e,t){return _pick(e,t,!1).resetJoin()}),pickmodReset=register("pickmodReset",function(e,t){return _pick(e,t,!0).resetJoin()}),{inhabit,pickSqueeze}=register(["inhabit","pickSqueeze"],function(e,t){return _pick(e,t,!1).squeezeJoin()}),{inhabitmod,pickmodSqueeze}=register(["inhabitmod","pickmodSqueeze"],function(e,t){return _pick(e,t,!0).squeezeJoin()}),squeeze=(e,t)=>(t=t.map(reify),t.length==0?silence:e.fmap(o=>{const a=_mod$2(Math.round(o),t.length);return t[a]}).squeezeJoin());let synth;try{synth=window?.speechSynthesis}catch(e){console.warn("cannot use window: not in browser?")}let allVoices=synth?.getVoices();function triggerSpeech(e,t,o){synth.cancel();const a=new SpeechSynthesisUtterance(e);a.lang=t,allVoices=synth.getVoices();const u=allVoices.filter(l=>l.lang.includes(t));typeof o=="number"?a.voice=u[o%u.length]:typeof o=="string"&&(a.voice=u.find(l=>l.name===l)),speechSynthesis.speak(a)}const speak=register("speak",function(e,t,o){return o.onTrigger(a=>{triggerSpeech(a.value,e,t)})}),strudelScope={},evalScope$1=async(...e)=>{const t=await Promise.allSettled(e),o=t.filter(a=>a.status==="fulfilled").map(a=>a.value);return t.forEach((a,u)=>{a.status==="rejected"&&console.warn(`evalScope: module with index ${u} could not be loaded:`,a.reason)}),o.forEach(a=>{Object.entries(a).forEach(([u,l])=>{globalThis[u]=l,strudelScope[u]=l})}),o};function safeEval(e,t={}){const{wrapExpression:o=!0,wrapAsync:a=!0}=t;o&&(e=`{${e}}`),a&&(e=`(async ()=>${e})()`);const u=`"use strict";return (${e})`;return Function(u)()}const evaluate$1=async(e,t,o)=>{let a={};if(t){const p=t(e,o);e=p.output,a=p}return{mode:"javascript",pattern:await safeEval(e,{wrapExpression:!!t}),meta:a}},jsContent=`(function(){"use strict";function L(){return performance.now()*.001}let _=0,r=0,o=.5;const h=new Map,m=.1,M=new BroadcastChannel("strudeltick"),b=(s,e)=>{M.postMessage({type:s,payload:e})},C=E(L,(s,e,t,n)=>{const i=r*e,d=s-n,c=n+d,u=i*o,l=_+u,g=n-c-e,f=e*o,p=l+f,y=l+g*o;b("tick",{begin:l,end:p,cps:o,time:n,cycle:y}),r++},m);let k=!1;const I=s=>{h.set(s,{started:!0}),!k&&(C.start(),k=!0)},A=async s=>{h.set(s,{started:!1});const e=Array.from(h.values()).some(t=>t.started);!k||e||(C.stop(),w(0),k=!1)},w=s=>{r=0,_=s},D=s=>{const{type:e,payload:t}=s;switch(e){case"cpschange":{if(t.cps!==o){const n=r*m;_=_+n*o,o=t.cps,r=0}break}case"setcycle":{w(t.cycle);break}case"toggle":{t.started?I(s.id):A(s.id);break}}};self.onconnect=function(s){const e=s.ports[0];e.addEventListener("message",function(t){D(t.data)}),e.start()};function E(s,e,t=.05,n=.1,i=.1){let d=0,c=0,u=10**4,l=.01;const g=a=>t=a(t);i=i||n/2;const f=()=>{const a=s(),O=a+n+i;for(c===0&&(c=a+l);c<O;)c=Math.round(c*u)/u,c>=a&&e(c,t,d,a),c<a&&console.log("TOO LATE",c),c+=t,d++};let p;const y=()=>{T(),f(),p=setInterval(f,n*1e3)},T=()=>p!==void 0&&clearInterval(p);return{setDuration:g,start:y,stop:()=>{d=0,c=0,T()},pause:()=>T(),duration:t,interval:n,getPhase:()=>c,minLatency:l}}})();
`,blob=typeof self<"u"&&self.Blob&&new Blob(["(self.URL || self.webkitURL).revokeObjectURL(self.location.href);",jsContent],{type:"text/javascript;charset=utf-8"});function WorkerWrapper(e){let t;try{if(t=blob&&(self.URL||self.webkitURL).createObjectURL(blob),!t)throw"";const o=new Worker(t,{name:e?.name});return o.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),o}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(jsContent),{name:e?.name})}}class NeoCyclist{constructor({onTrigger:t,onToggle:o,getTime:a}){this.started=!1,this.cps=.5,this.getTime=a,this.time_at_last_tick_message=0,this.collator=new ClockCollator({getTargetClockTime:a}),this.onToggle=o,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(WorkerWrapper),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const u=p=>{const{cps:d,begin:g,end:f,cycle:A,time:b}=p;this.cps=d,this.cycle=A;const F=this.collator.calculateOffset(b)+b;l(g,f,F),this.time_at_last_tick_message=F},l=(p,d,g)=>{if(this.started===!1)return;this.pattern.queryArc(p,d,{_cps:this.cps,cyclist:"neocyclist"}).forEach(A=>{if(A.hasOnset()){const F=cycleToSeconds$1(A.whole.begin-this.cycle,this.cps)+g+this.latency,S=cycleToSeconds$1(A.duration,this.cps);t?.(A,0,S,this.cps,F)}})};this.channel.onmessage=p=>{if(!this.started)return;const{payload:d,type:g}=p.data;switch(g){case"tick":u(d)}}}sendMessage(t,o){this.worker.port.postMessage({type:t,payload:o,id:this.id})}now(){const t=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+t}setCps(t=1){this.sendMessage("cpschange",{cps:t})}setCycle(t){this.sendMessage("setcycle",{cycle:t})}setStarted(t){this.sendMessage("toggle",{started:t}),this.started=t,this.onToggle?.(t)}start(){logger$2("[cyclist] start"),this.setStarted(!0)}stop(){logger$2("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(t,o=!1){this.pattern=t,o&&!this.started&&this.start()}log(t,o,a){const u=a.filter(l=>l.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(u.length).fill("I").join("")}`)}}class Cyclist{constructor({interval:t,onTrigger:o,onToggle:a,onError:u,getTime:l,latency:p=.1,setInterval:d,clearInterval:g,beforeStart:f}){this.started=!1,this.beforeStart=f,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=l,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=a,this.latency=p,this.clock=createClock(l,(A,b,F,S)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=A),this.num_ticks_since_cps_change++;const $=this.num_ticks_since_cps_change*b*this.cps;try{const R=this.lastEnd;this.lastBegin=R;const I=this.num_cycles_at_cps_change+$;if(this.lastEnd=I,this.lastTick=A,A<S){console.log("skip query: too late");return}this.pattern.queryArc(R,I,{_cps:this.cps,cyclist:"cyclist"}).forEach(ie=>{if(ie.hasOnset()){const U=(ie.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+p,O=ie.duration/this.cps,ee=U-A;o?.(ie,ee,O,this.cps,U),ie.value.cps!==void 0&&this.cps!=ie.value.cps&&(this.cps=ie.value.cps,this.num_ticks_since_cps_change=0)}})}catch(R){errorLogger$1(R),u?.(R)}},t,.1,.1,d,g)}now(){if(!this.started)return 0;const t=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+t*this.cps}setStarted(t){this.started=t,this.onToggle?.(t)}async start(){if(await this.beforeStart?.(),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");logger$2("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){logger$2("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){logger$2("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(t,o=!1){this.pattern=t,o&&!this.started&&await this.start()}setCps(t=.5){this.cps!==t&&(this.cps=t,this.num_ticks_since_cps_change=0)}log(t,o,a){const u=a.filter(l=>l.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(u.length).fill("I").join("")}`)}}let time;function getTime(){if(!time)throw new Error("no time set! use setTime to define a time source");return time()}function setTime(e){time=e}function repl$1({defaultOutput:e,onEvalError:t,beforeEval:o,beforeStart:a,afterEval:u,getTime:l,transpiler:p,onToggle:d,editPattern:g,onUpdateState:f,sync:A=!1,setInterval:b,clearInterval:F,id:S,mondo:k=!1}){const $={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},R={id:S},I=de=>{Object.assign($,de),$.isDirty=$.code!==$.activeCode,$.error=$.evalError||$.schedulerError,f?.($)},z={onTrigger:getTrigger({defaultOutput:e,getTime:l}),getTime:l,onToggle:de=>{I({started:de}),d?.(de)},setInterval:b,clearInterval:F,beforeStart:a},ie=A&&typeof SharedWorker<"u"?new NeoCyclist(z):new Cyclist(z);let U={},O=0,ee;const re=function(){return U={},O=0,ee=void 0,silence};function oe(de){return de._Pattern?de.__pure:de}const _e=async(de,Le=!0)=>(de=g?.(de)||de,await ie.setPattern(de,Le),de);setTime(()=>ie.now());const ue=()=>ie.stop(),Ce=()=>ie.start(),me=()=>ie.pause(),he=()=>ie.toggle(),ve=de=>(ie.setCps(oe(de)),silence),Fe=de=>(ie.setCps(oe(de)/60),silence);let Se=[];const Ee=function(de){return Se.push(de),silence},Pe=function(de){return ee=de,silence},Ye=()=>{Pattern$1.prototype.p=function(Le){return typeof Le=="string"&&(Le.startsWith("_")||Le.endsWith("_"))?silence:(Le.includes("$")&&(Le=`${Le}${O}`,O++),U[Le]=this,this)},Pattern$1.prototype.q=function(Le){return silence};try{for(let Le=1;Le<10;++Le)Object.defineProperty(Pattern$1.prototype,`d${Le}`,{get(){return this.p(Le)},configurable:!0}),Object.defineProperty(Pattern$1.prototype,`p${Le}`,{get(){return this.p(Le)},configurable:!0}),Pattern$1.prototype[`q${Le}`]=silence}catch(Le){console.warn("injectPatternMethods: error:",Le)}const de=register("cpm",function(Le,ot){return ot._fast(Le/60/ie.cps)});return evalScope$1({all:Ee,each:Pe,hush:re,cpm:de,setCps:ve,setcps:ve,setCpm:Fe,setcpm:Fe})};return{scheduler:ie,evaluate:async(de,Le=!0,ot=!0)=>{if(!de)throw new Error("no code to evaluate");try{I({code:de,pending:!0}),await Ye(),setTime(()=>ie.now()),await o?.({code:de}),Se=[],ot&&re(),k&&(de=`mondolang\`${de}\``);let{pattern:Ve,meta:Oe}=await evaluate$1(de,p,R);if(Object.keys(U).length){let Je=[],We=!1;for(const[qe,yt]of Object.entries(U)){const pt=qe.length>1&&qe.startsWith("S");if(pt&&We===!1&&(Je=[],We=!0),!We||We&&pt){const Qe=yt.withState(At=>At.setControls({id:qe}));Je.push(Qe)}}ee&&(Je=Je.map(qe=>ee(qe))),Ve=stack(...Je)}else ee&&(Ve=ee(Ve));if(Se.length)for(const Je of Se)Ve=Je(Ve);return isPattern(Ve)||(Ve=silence),logger$2("[eval] code updated"),Ve=await _e(Ve,Le),I({miniLocations:Oe?.miniLocations||[],widgets:Oe?.widgets||[],activeCode:de,pattern:Ve,evalError:void 0,schedulerError:void 0,pending:!1}),u?.({code:de,pattern:Ve,meta:Oe}),Ve}catch(Ve){logger$2(`[eval] error: ${Ve.message}`,"error"),console.error(Ve),I({evalError:Ve,pending:!1}),t?.(Ve)}},start:Ce,stop:ue,pause:me,setCps:ve,setPattern:_e,setCode:de=>I({code:de}),toggle:he,state:$}}const getTrigger=({getTime:e,defaultOutput:t})=>async(o,a,u,l,p)=>{try{(!o.context.onTrigger||!o.context.dominantTrigger)&&await t(o,a,u,l,p),o.context.onTrigger&&await o.context.onTrigger(o,e(),l,p)}catch(d){errorLogger$1(d,"getTrigger")}},backgroundImage=function(e,t={}){const o=document.getElementById("code"),a="background-image:url("+e+");background-size:contain;";o.style=a;const{className:u}=o,l=(g,f)=>{({style:()=>o.style=a+";"+f,className:()=>o.className=f+" "+u})[g]()},p=Object.entries(t).filter(([g,f])=>typeof f=="function");Object.entries(t).filter(([g,f])=>typeof f=="string").forEach(([g,f])=>l(g,f)),p.length},cleanupUi=()=>{const e=document.getElementById("code");e&&(e.style="")};logger$2("🌀 @strudel/core loaded 🌀"),globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`),globalThis._strudelLoaded=!0;const strudelCore=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator,Cyclist,Fraction,Hap,Pattern:Pattern$1,State,TimeSpan,__chooseWith,_brandBy,_fitslice,_irand,_keyDown,_match,_mod:_mod$2,_morph,_polymeterListSteps,_retime,_slices,accelerate,activeLabel,ad,add:add$7,adsr,almostAlways,almostNever,always,amp,analyze,anchor,and,apply,applyN,ar,arp,arpWith,arrange,as,att,attack,averageArray,backgroundImage,band,bandf,bandq,bank,base64ToUnicode,bbexpr,bbst,beat,begin,berlin,berlinWith,binary,binaryL,binaryN,binaryNL,bind,binshift,bite,bjork,bjorklund,blshift,bor,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,brak,brand,brandBy,brshift,bxor,bypass,byteBeatExpression,byteBeatStartTime,calculateSteps,cat,ccn,ccv,ceil,ch,channel,channels,choose,chooseCycles,chooseIn,chooseInWith,chooseOut,chooseWith,chop,chord:chord$1,chorus,chunk,chunkBack,chunkBackInto,chunkInto,chunkback,chunkbackinto,chunkinto,clamp:clamp$1,cleanupUi,clip,coarse,code2hash,color,colour,comb,compose,compress,compressSpan,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,compressspan,constant,contract,control,controls,cosine,cosine2,cpm,cps,createClock,createParam,createParams,crush,ctf,ctlNum,ctranspose,curry,curve,cut,cutoff,cycleToSeconds:cycleToSeconds$1,dec,decay,degrade,degradeBy,degradeByWith,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,div,djf,drawLine,drive,drop,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,early,echo,echoWith,echowith,eish,end,enhance,eq,eqt,errorLogger:errorLogger$1,euclid,euclidLegato,euclidLegatoRot,euclidRot,euclidish,euclidrot,evalScope:evalScope$1,evaluate:evaluate$1,every,expand,expression,extend,fadeInTime,fadeOutTime,fadeTime,fanchor,fast,fastChunk,fastGap,fastcat,fastchunk,fastgap,fft,filter:filter$1,filterWhen,firstOf,fit,flatten,floor,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,focus,focusSpan,focusspan,fractionalArgs,frameRate,frames,freeze,freq:freq$1,freqToMidi:freqToMidi$2,fromBipolar,fshift,fshiftnote,fshiftphase,ftype,func,gain,gap,gat,gate,getAccidentalsOffset:getAccidentalsOffset$1,getControlName,getCurrentKeyboardState,getEventOffsetMs,getFreq,getFrequency,getPerformanceTimeSeconds,getPlayableNoteValue,getSoundIndex:getSoundIndex$1,getTime,getTrigger,grow,gt,gte,harmonic,hash2code,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,hsl,hsla,hurry,id,imag,inhabit,inhabitmod,innerBind,inside,inv,invert:invert$1,ir,irand,irbegin,iresponse,irspeed,isControlName,isNote,isNoteWithOctave,isPattern,isaw,isaw2,iter,iterBack,iterback,itri,itri2,jux,juxBy,juxby,kcutoff,keep,keepif,keyAlias,keyDown,krush,label,lastOf,late,lbrick,legato,leslie,lfo,linger,listRange,lock,logKey,logger:logger$2,loop,loopAt,loopAtCps,loopBegin,loopEnd,loopat,loopatcps,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,lt,lte,mapArgs,mask,midi2note:midi2note$1,midiToFreq:midiToFreq$2,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mod:mod$3,mode:mode$1,morph,mouseX,mouseY,mousex,mousey,mtranspose,mul,n,nanFallback:nanFallback$1,ne,net,never,noise,note:note$2,noteToMidi:noteToMidi$1,nothing,nrpnn,nrpv,nudge,numeralArgs,objectMap,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,off,offset,often,or,orbit,oschost,oscport,outerBind,outside,overgain,overshape,pace,pairs,palindrome,pan,panchor,panorient,panspan,pansplay,panwidth,parray,parseFractional,parseNumeral,partials,patt,pattack,pcurve,pdec,pdecay,penv,perlin,perlinWith,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phases,phc,phd,phs,pick,pickF,pickOut,pickReset,pickRestart,pickSqueeze,pickmod,pickmodF,pickmodOut,pickmodReset,pickmodRestart,pickmodSqueeze,pipe,pitchJump,pitchJumpTime,ply,plyForEach,plyWith,pm,polyBind,polyTouch,polymeter,polyrhythm,postgain,pow,pr,prel,prelease,press,pressBy,progNum,psus,psustain,pure,pw,pwrate,pwsweep,rand,rand2,randL,randcat,randrun,range:range$2,range2,rangex,rarely,rate,ratio,rdim,real,ref:ref$1,register,registerControl,reify,rel,release,removeUndefineds,repeatCycles,repeatTime,repl:repl$1,replicate,resonance,rev,revv,rfade,rib,ribbon,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rotate:rotate$2,round,rsize,run,s,s_add,s_alt,s_cat,s_contract,s_expand,s_extend,s_polymeter,s_sub,s_taper,s_taperlist,s_tour,s_zip,saw,saw2,scram,scramble,scrub,seconds,seg,segment,semitone,seq,seqPLoop,sequence,sequenceP,set,setStringParser,setTime,shape,shrink,shrinklist,shuffle:shuffle$2,signal,silence,sine,sine2,size,slice,slide,slow,slowChunk,slowcat,slowcatPrime,slowchunk,smear:smear$1,sol2note,someCycles,someCyclesBy,sometimes,sometimesBy,songPtr,sound,source,sparsity,speak,speed,splice,splitAt,spread,square,square2,squeeze,squeezeBind,squiz,src,stack,stackBy,stackCentre,stackLeft,stackRight,steady,stepBind,stepalt,stepcat,steps:steps$2,stepsPerOctave,stretch,striate,stringifyValues,struct,strudelScope,stut,stutWith,stutwith,sub,superimpose,sus,sustain,sustainpedal,swing,swingBy,sysex,sysexdata,sysexid,sz,take,time:time$1,timeCat,timecat,toBipolar,tokenizeNote:tokenizeNote$3,tour,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,tri,tri2,triode,tsdelay,uid,undegrade,undegradeBy,unicodeToBase64,uniq,uniqsort,uniqsortr,unison,unit,v,val,valueToMidi:valueToMidi$1,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wchoose,wchooseCycles,when,whenKey,withValue,within,wrandcat,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xfade,xsdelay,zcrush,zdelay,zip,zipWith,zmod,znoise,zoom,zoomArc,zoomarc,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),randOffset=3e-4,applyOptions=(e,t)=>(o,a)=>{const p=e.source_[a].options_?.ops,d=o.__steps_source;if(p)for(const g of p)switch(g.type_){case"stretch":{const f=["fast","slow"],{type:A,amount:b}=g.arguments_;if(!f.includes(A))throw new Error(`mini: stretch: type must be one of ${f.join("|")} but got ${A}`);o=reify(o)[A](t(b));break}case"replicate":{const{amount:f}=g.arguments_;o=reify(o),o=o._repeatCycles(f)._fast(f);break}case"bjorklund":{g.arguments_.rotation?o=o.euclidRot(t(g.arguments_.pulse),t(g.arguments_.step),t(g.arguments_.rotation)):o=o.euclid(t(g.arguments_.pulse),t(g.arguments_.step));break}case"degradeBy":{o=reify(o)._degradeByWith(rand.early(randOffset*g.arguments_.seed),g.arguments_.amount??.5);break}case"tail":{const f=t(g.arguments_.element);o=o.fmap(A=>b=>Array.isArray(A)?[...A,b]:[A,b]).appLeft(f);break}case"range":{const f=t(g.arguments_.element);o=reify(o);const A=(F,S,k=1)=>Array.from({length:Math.abs(S-F)/k+1},($,R)=>F<S?F+R*k:F-R*k);o=((F,S)=>F.squeezeBind(k=>S.bind($=>fastcat(...A(k,$)))))(o,f);break}default:console.warn(`operator "${g.type_}" not implemented`)}return o.__steps_source=o.__steps_source||d,o};function patternifyAST(e,t,o,a=0){o?.(e);const u=l=>patternifyAST(l,t,o,a);switch(e.type_){case"pattern":{const l=e.source_.map(f=>u(f)).map(applyOptions(e,u)),p=e.arguments_.alignment,d=l.filter(f=>f.__steps_source);let g;switch(p){case"stack":{g=stack(...l),d.length&&(g._steps=lcm(...d.map(f=>Fraction(f._steps))));break}case"polymeter_slowcat":{g=stack(...l.map(f=>f._slow(f.__weight))),d.length&&(g._steps=lcm(...d.map(f=>Fraction(f._steps))));break}case"polymeter":{const f=e.arguments_.stepsPerCycle?u(e.arguments_.stepsPerCycle).fmap(b=>Fraction(b)):pure(Fraction(l.length>0?l[0].__weight:1)),A=l.map(b=>b.fast(f.fmap(F=>F.div(b.__weight))));g=stack(...A);break}case"rand":{g=chooseInWith(rand.early(randOffset*e.arguments_.seed).segment(1),l),d.length&&(g._steps=lcm(...d.map(f=>Fraction(f._steps))));break}case"feet":{g=fastcat(...l);break}default:{if(e.source_.some(A=>!!A.options_?.weight)){const A=e.source_.reduce((b,F)=>b.add(F.options_?.weight||Fraction(1)),Fraction(0));g=timeCat(...e.source_.map((b,F)=>[b.options_?.weight||Fraction(1),l[F]])),g.__weight=A,g._steps=A,d.length&&(g._steps=g._steps.mul(lcm(...d.map(b=>Fraction(b._steps)))))}else g=sequence(...l),g._steps=l.length;e.arguments_._steps&&(g.__steps_source=!0)}}return d.length&&(g.__steps_source=!0),g}case"element":return u(e.source_);case"atom":{if(e.source_==="~"||e.source_==="-")return silence;if(!e.location_)return console.warn("no location for",e),e.source_;const l=isNaN(Number(e.source_))?e.source_:Number(e.source_);if(a===-1)return pure(l);const[p,d]=getLeafLocation(t,e,a);return pure(l).withLoc(p,d)}case"stretch":return u(e.source_).slow(u(e.arguments_.amount));default:return console.warn(`node type "${e.type_}" not implemented -> returning silence`),silence}}const getLeafLocation=(e,t,o=0)=>{const{start:a,end:u}=t.location_,l=e?.split("").slice(a.offset,u.offset).join(""),[p=0,d=0]=l?l.split(t.source_).map(g=>g.split("").filter(f=>f===" ").length):[];return[a.offset+p+o,u.offset-d+o]},mini2ast=(e,t=0,o=e)=>{try{return peg$parse(e)}catch(a){const u=[a.location.start.offset+t,a.location.end.offset+t],l=o.slice(0,u[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${l}: ${a.message}`)}},getLeaves=(e,t,o)=>{const a=mini2ast(e,t,o);let u=[];return patternifyAST(a,e,l=>{l.type_==="atom"&&u.push(l)},-1),u},getLeafLocations=(e,t=0,o)=>getLeaves(e,t,o).map(a=>getLeafLocation(e,a,t)),mini=(...e)=>{const t=e.map(o=>{const a=`"${o}"`,u=mini2ast(a);return patternifyAST(u,a)});return sequence(...t)},m$1=(e,t)=>{const o=`"${e}"`,a=mini2ast(o);return patternifyAST(a,o,null,t)},h$1=e=>{const t=mini2ast(e);return patternifyAST(t,e)};function minify(e){return typeof e=="string"?mini(e):reify(e)}function miniAllStrings(){setStringParser(mini)}const strudelMini=Object.freeze(Object.defineProperty({__proto__:null,StartRules:peg$allowedStartRules,SyntaxError:peg$SyntaxError,getLeafLocation,getLeafLocations,getLeaves,h:h$1,m:m$1,mini,mini2ast,miniAllStrings,minify,parse:peg$parse,patternifyAST},Symbol.toStringTag,{value:"Module"}));if(typeof DelayNode<"u"){class e extends DelayNode{constructor(o,a,u,l){super(o),a=Math.abs(a),this.delayTime.value=u;const p=o.createGain();p.gain.value=Math.min(Math.abs(l),.995),this.feedback=p.gain;const d=o.createGain();return d.gain.value=a,this.delayGain=d,this.connect(p),this.connect(d),p.connect(this),this.connect=g=>d.connect(g),this}start(o){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,o+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(t,o,a){return new e(this,t,o,a)}}var reverbGen={};reverbGen.generateReverb=function(e,t){for(var o=e.audioContext||new AudioContext,a=o.sampleRate,u=e.numChannels||2,l=e.decayTime*1.5,p=Math.round(e.decayTime*a),d=Math.round(l*a),g=Math.round((e.fadeInTime||0)*a),f=Math.pow(1/1e3,1/p),A=o.createBuffer(u,d,a),b=0;b<u;b++){for(var F=A.getChannelData(b),S=0;S<d;S++)F[S]=randomSample()*Math.pow(f,S);for(var S=0;S<g;S++)F[S]*=S/g}applyGradualLowpass(A,e.lpFreqStart||0,e.lpFreqEnd||0,e.decayTime,t)},reverbGen.generateGraph=function(e,t,o,a,u){var l=document.createElement("canvas");l.width=t,l.height=o;var p=l.getContext("2d");p.fillStyle="#000",p.fillRect(0,0,l.width,l.height),p.fillStyle="#fff";for(var d=t/e.length,g=o/(u-a),f=0;f<e.length;f++)p.fillRect(f*d,o-(e[f]-a)*g,1,1);return l};var applyGradualLowpass=function(e,t,o,a,u){if(t==0){u(e);return}var l=getAllChannelData(e),p=new OfflineAudioContext(e.numberOfChannels,l[0].length,e.sampleRate),d=p.createBufferSource();d.buffer=e;var g=p.createBiquadFilter();t=Math.min(t,e.sampleRate/2),o=Math.min(o,e.sampleRate/2),g.type="lowpass",g.Q.value=1e-4,g.frequency.setValueAtTime(t,0),g.frequency.linearRampToValueAtTime(o,a),d.connect(g),g.connect(p.destination),d.start(),p.oncomplete=function(f){u(f.renderedBuffer),g.disconnect(),d.disconnect()},p.startRendering(),window.filterNode=g},getAllChannelData=function(e){for(var t=[],o=0;o<e.numberOfChannels;o++)t[o]=e.getChannelData(o);return t},randomSample=function(){return Math.random()*2-1};let log=e=>console.log(e);function errorLogger(e,t="superdough"){process.env.NODE_ENV==="development"&&console.error(e),logger$1(`[${t}] error: ${e.message}`)}const logger$1=(...e)=>log(...e),setLogger=e=>{log=e},tokenizeNote$2=e=>{if(typeof e!="string")return[];const[t,o="",a]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,a?Number(a):void 0]:[]},chromas$1={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$1={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset=e=>e?.split("").reduce((t,o)=>t+accs$1[o],0)||0,noteToMidi=(e,t=3)=>{const[o,a,u=t]=tokenizeNote$2(e);if(!o)throw new Error('not a note: "'+e+'"');const l=chromas$1[o.toLowerCase()],p=getAccidentalsOffset(a);return(Number(u)+1)*12+l+p},midiToFreq$1=e=>Math.pow(2,(e-69)/12)*440,clamp=(e,t,o)=>Math.min(Math.max(e,t),o),freqToMidi$1=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:a}=e;return typeof o=="number"?freqToMidi$1(o):typeof a=="string"?noteToMidi(a):typeof a=="number"?a:t};function nanFallback(e,t=0,o){return isNaN(Number(e))?(!o&&logger$1(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const _mod$1=(e,t)=>(e%t+t)%t,getSoundIndex=(e,t)=>_mod$1(Math.round(nanFallback(e,0)),t);function cycleToSeconds(e,t){return e/t}function getCommonSampleInfo(e,t){const{s:o,n:a=0}=e;let u=valueToMidi(e,36),l=u-36,p,d=0;if(Array.isArray(t))d=getSoundIndex(a,t.length),p=t[d];else{const f=b=>noteToMidi(b)-u,A=Object.keys(t).filter(b=>!b.startsWith("_")).reduce((b,F,S)=>!b||Math.abs(f(F))<Math.abs(f(b))?F:b,null);l=-f(A),d=getSoundIndex(a,t[A].length),p=t[A][d]}const g=`${o}:${d}`;return{transpose:l,url:p,index:d,midi:u,label:g}}const pickAndRename=(e,t)=>Object.fromEntries(Object.entries(t).map(([o,a])=>[o,e[a]])),getBaseURL=e=>{try{return new URL(".",new URL(e)).href.replace(/\/$/,"")}catch{return e.split("/").slice(0,-1).join("/")}};typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(e,t,o=1,a=0){const u=Math.floor(clamp(a,0,1)*t.length),l=t.sampleRate*e,p=this.createBuffer(t.numberOfChannels,t.length,t.sampleRate);for(let d=0;d<t.numberOfChannels;d++){let g=t.getChannelData(d),f=p.getChannelData(d);for(let A=0;A<l;A++){let b=(u+A*Math.abs(o))%g.length;o<1&&(b=b*-1),f[A]=g.at(b)||0}}return p},AudioContext.prototype.createReverb=function(e,t,o,a,u,l,p){const d=this.createConvolver();return d.generate=(g=2,f=.1,A=15e3,b=1e3,F,S,k)=>{d.duration=g,d.fade=f,d.lp=A,d.dim=b,d.ir=F,d.irspeed=S,d.irbegin=k,F?d.buffer=this.adjustLength(g,F,S,k):reverbGen.generateReverb({audioContext:this,numChannels:2,decayTime:g,fadeInTime:f,lpFreqStart:A,lpFreqEnd:b},$=>{d.buffer=$})},d.generate(e,t,o,a,u,l,p),d});var vowelFormant={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class e extends GainNode{constructor(o,a){if(super(o),!vowelFormant[a])throw new Error("vowel: unknown vowel "+a);const{gains:u,qs:l,freqs:p}=vowelFormant[a];this.makeupGain=o.createGain(),this.audioNodes=[];for(let d=0;d<5;d++){const g=o.createGain();g.gain.value=u[d];const f=o.createBiquadFilter();f.type="bandpass",f.Q.value=l[d],f.frequency.value=p[d],super.connect(f),f.connect(g),this.audioNodes.push(f),g.connect(this.makeupGain),this.audioNodes.push(g)}return this.makeupGain.gain.value=8,this}connect(o){this.makeupGain.connect(o)}disconnect(){this.makeupGain.disconnect(),this.audioNodes.forEach(o=>o.disconnect()),super.disconnect(),this.makeupGain=null,this.audioNodes=null}}AudioContext.prototype.createVowelFilter=function(t){return new e(this,t)}}const workletsUrl="data:text/javascript;base64,dmFyIF89KGZ1bmN0aW9uKGZ0KXsidXNlIHN0cmljdCI7Y2xhc3Mga3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5zdGFydGVkPSExLHRoaXMubmJJbnB1dHM9dC5udW1iZXJPZklucHV0cyx0aGlzLm5iT3V0cHV0cz10Lm51bWJlck9mT3V0cHV0cyx0aGlzLmJsb2NrU2l6ZT10LnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplLHRoaXMuaG9wU2l6ZT0xMjgsdGhpcy5uYk92ZXJsYXBzPXRoaXMuYmxvY2tTaXplL3RoaXMuaG9wU2l6ZSx0aGlzLmlucHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkPW5ldyBBcnJheSh0aGlzLm5iSW5wdXRzKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iSW5wdXRzO2UrKyl0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhlLDEpO3RoaXMub3V0cHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmU9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTtmb3IobGV0IGU9MDtlPHRoaXMubmJPdXRwdXRzO2UrKyl0aGlzLmFsbG9jYXRlT3V0cHV0Q2hhbm5lbHMoZSwxKX1yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpe2ZvcihsZXQgcz0wO3M8dGhpcy5uYklucHV0cztzKyspe2xldCByPXRbc10ubGVuZ3RoO3IhPXRoaXMuaW5wdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMocyxyKX1mb3IobGV0IHM9MDtzPHRoaXMubmJPdXRwdXRzO3MrKyl7bGV0IHI9ZVtzXS5sZW5ndGg7ciE9dGhpcy5vdXRwdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHMscil9fWFsbG9jYXRlSW5wdXRDaGFubmVscyh0LGUpe3RoaXMuaW5wdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUrMTI4KSx0aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XT1uZXcgQXJyYXkoZSksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW3NdPXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdLnN1YmFycmF5KDAsdGhpcy5ibG9ja1NpemUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpfWFsbG9jYXRlT3V0cHV0Q2hhbm5lbHModCxlKXt0aGlzLm91dHB1dEJ1ZmZlcnNbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW3NdLmZpbGwoMCl9cmVhZElucHV0cyh0KXtpZih0WzBdLmxlbmd0aCYmdFswXVswXS5sZW5ndGg9PTApe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXRoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLmZpbGwoMCx0aGlzLmJsb2NrU2l6ZSk7cmV0dXJufWZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10W2VdW3NdO3RoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLnNldChyLHRoaXMuYmxvY2tTaXplKX19d3JpdGVPdXRwdXRzKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10aGlzLm91dHB1dEJ1ZmZlcnNbZV1bc10uc3ViYXJyYXkoMCwxMjgpO3RbZV1bc10uc2V0KHIpfX1zaGlmdElucHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpfXNoaWZ0T3V0cHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5zdWJhcnJheSh0aGlzLmJsb2NrU2l6ZS0xMjgpLmZpbGwoMCl9cHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW2VdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF1bZV0pfWhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCl7Zm9yKGxldCB0PTA7dDx0aGlzLm5iT3V0cHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLm91dHB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuYmxvY2tTaXplO3MrKyl0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV1bc10rPXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bZV1bc10vdGhpcy5uYk92ZXJsYXBzfXByb2Nlc3ModCxlLHMpe2NvbnN0IGk9dFswXVswXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5zdGFydGVkJiYhaT8hMToodGhpcy5zdGFydGVkPWksdGhpcy5yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpLHRoaXMucmVhZElucHV0cyh0KSx0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCksdGhpcy5wcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCksdGhpcy5wcm9jZXNzT0xBKHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUscyksdGhpcy5oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpLHRoaXMud3JpdGVPdXRwdXRzKGUpLHRoaXMuc2hpZnRPdXRwdXRCdWZmZXJzKCksITApfXByb2Nlc3NPTEEodCxlLHMpe2NvbnNvbGUuYXNzZXJ0KCExLCJOb3Qgb3ZlcnJpZGVuIil9fWNsYXNzIEV0e2NvbnN0cnVjdG9yKHQpe2lmKHRoaXMuc2l6ZT10fDAsdGhpcy5zaXplPD0xfHwodGhpcy5zaXplJnRoaXMuc2l6ZS0xKSE9PTApdGhyb3cgbmV3IEVycm9yKCJGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxIik7dGhpcy5fY3NpemU9dDw8MTtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuc2l6ZSoyKSxzPTA7czxlLmxlbmd0aDtzKz0yKXtjb25zdCBjPU1hdGguUEkqcy90aGlzLnNpemU7ZVtzXT1NYXRoLmNvcyhjKSxlW3MrMV09LU1hdGguc2luKGMpfXRoaXMudGFibGU9ZTtmb3IodmFyIHI9MCxpPTE7dGhpcy5zaXplPmk7aTw8PTEpcisrO3RoaXMuX3dpZHRoPXIlMj09PTA/ci0xOnIsdGhpcy5fYml0cmV2PW5ldyBBcnJheSgxPDx0aGlzLl93aWR0aCk7Zm9yKHZhciBvPTA7bzx0aGlzLl9iaXRyZXYubGVuZ3RoO28rKyl7dGhpcy5fYml0cmV2W29dPTA7Zm9yKHZhciBhPTA7YTx0aGlzLl93aWR0aDthKz0yKXt2YXIgdT10aGlzLl93aWR0aC1hLTI7dGhpcy5fYml0cmV2W29dfD0obz4+PmEmMyk8PHV9fXRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbCx0aGlzLl9pbnY9MH1mcm9tQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fG5ldyBBcnJheSh0Lmxlbmd0aD4+PjEpLHI9MDtyPHQubGVuZ3RoO3IrPTIpc1tyPj4+MV09dFtyXTtyZXR1cm4gc31jcmVhdGVDb21wbGV4QXJyYXkoKXtjb25zdCB0PW5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXT0wO3JldHVybiB0fXRvQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fHRoaXMuY3JlYXRlQ29tcGxleEFycmF5KCkscj0wO3I8cy5sZW5ndGg7cis9MilzW3JdPXRbcj4+PjFdLHNbcisxXT0wO3JldHVybiBzfWNvbXBsZXRlU3BlY3RydW0odCl7Zm9yKHZhciBlPXRoaXMuX2NzaXplLHM9ZT4+PjEscj0yO3I8cztyKz0yKXRbZS1yXT10W3JdLHRbZS1yKzFdPS10W3IrMV19dHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fdHJhbnNmb3JtNCgpLHRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1yZWFsVHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fcmVhbFRyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9aW52ZXJzZVRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0xLHRoaXMuX3RyYW5zZm9ybTQoKTtmb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl0W3NdLz10aGlzLnNpemU7dGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfV90cmFuc2Zvcm00KCl7dmFyIHQ9dGhpcy5fb3V0LGU9dGhpcy5fY3NpemUscz10aGlzLl93aWR0aCxyPTE8PHMsaT1lL3I8PDEsbyxhLHU9dGhpcy5fYml0cmV2O2lmKGk9PT00KWZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgbT11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTIobyxtLHIpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBtPXVbYV07dGhpcy5fc2luZ2xlVHJhbnNmb3JtNChvLG0scil9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+Mjtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgZD1vK2YsbD1vLHA9MDtsPGQ7bCs9MixwKz1yKXtjb25zdCBtPWwsST1tK2YsZz1JK2Ysdj1nK2Ysdz10W21dLFA9dFttKzFdLFM9dFtJXSxWPXRbSSsxXSxNPXRbZ10seD10W2crMV0seT10W3ZdLEE9dFt2KzFdLFc9dyxOPVAsRT1oW3BdLE89YypoW3ArMV0sRj1TKkUtVipPLEQ9UypPK1YqRSxMPWhbMipwXSxDPWMqaFsyKnArMV0sZXQ9TSpMLXgqQyxzdD1NKkMreCpMLHJ0PWhbMypwXSxudD1jKmhbMypwKzFdLGl0PXkqcnQtQSpudCxvdD15Km50K0EqcnQsYXQ9VytldCwkPU4rc3QsRz1XLWV0LGN0PU4tc3QsdXQ9RitpdCxRPUQrb3QsSj1jKihGLWl0KSxodD1jKihELW90KSxsdD1hdCt1dCxidD0kK1EsSXQ9YXQtdXQsX3Q9JC1RLEJ0PUcraHQsd3Q9Y3QtSixUdD1HLWh0LFB0PWN0K0o7dFttXT1sdCx0W20rMV09YnQsdFtJXT1CdCx0W0krMV09d3QsdFtnXT1JdCx0W2crMV09X3QsdFt2XT1UdCx0W3YrMV09UHR9fX1fc2luZ2xlVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZSsxXSx1PWlbZStzXSxjPWlbZStzKzFdLGg9byt1LGY9YStjLGQ9by11LGw9YS1jO3JbdF09aCxyW3QrMV09ZixyW3QrMl09ZCxyW3QrM109bH1fc2luZ2xlVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlKzFdLGY9aVtlK3NdLGQ9aVtlK3MrMV0sbD1pW2UrYV0scD1pW2UrYSsxXSxtPWlbZSt1XSxJPWlbZSt1KzFdLGc9YytsLHY9aCtwLHc9Yy1sLFA9aC1wLFM9ZittLFY9ZCtJLE09byooZi1tKSx4PW8qKGQtSSkseT1nK1MsQT12K1YsVz13K3gsTj1QLU0sRT1nLVMsTz12LVYsRj13LXgsRD1QK007clt0XT15LHJbdCsxXT1BLHJbdCsyXT1XLHJbdCszXT1OLHJbdCs0XT1FLHJbdCs1XT1PLHJbdCs2XT1GLHJbdCs3XT1EfV9yZWFsVHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IE10PXVbYV07dGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIobyxNdD4+PjEscj4+PjEpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBNdD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG8sTXQ+Pj4xLHI+Pj4xKX12YXIgYz10aGlzLl9pbnY/LTE6MSxoPXRoaXMudGFibGU7Zm9yKHI+Pj0yO3I+PTI7cj4+PTIpe2k9ZS9yPDwxO3ZhciBmPWk+Pj4xLGQ9Zj4+PjEsbD1kPj4+MTtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgcD0wLG09MDtwPD1sO3ArPTIsbSs9cil7dmFyIEk9bytwLGc9SStkLHY9ZytkLHc9ditkLFA9dFtJXSxTPXRbSSsxXSxWPXRbZ10sTT10W2crMV0seD10W3ZdLHk9dFt2KzFdLEE9dFt3XSxXPXRbdysxXSxOPVAsRT1TLE89aFttXSxGPWMqaFttKzFdLEQ9VipPLU0qRixMPVYqRitNKk8sQz1oWzIqbV0sZXQ9YypoWzIqbSsxXSxzdD14KkMteSpldCxydD14KmV0K3kqQyxudD1oWzMqbV0saXQ9YypoWzMqbSsxXSxvdD1BKm50LVcqaXQsYXQ9QSppdCtXKm50LCQ9TitzdCxHPUUrcnQsY3Q9Ti1zdCx1dD1FLXJ0LFE9RCtvdCxKPUwrYXQsaHQ9YyooRC1vdCksbHQ9YyooTC1hdCksYnQ9JCtRLEl0PUcrSixfdD1jdCtsdCxCdD11dC1odDtpZih0W0ldPWJ0LHRbSSsxXT1JdCx0W2ddPV90LHRbZysxXT1CdCxwPT09MCl7dmFyIHd0PSQtUSxUdD1HLUo7dFt2XT13dCx0W3YrMV09VHQ7Y29udGludWV9aWYocCE9PWwpe3ZhciBQdD1jdCxnZT0tdXQsYmU9JCxJZT0tRyxfZT0tYypsdCxCZT0tYypodCx3ZT0tYypKLFRlPS1jKlEsUGU9UHQrX2UsTWU9Z2UrQmUsU2U9YmUrVGUsVmU9SWUtd2UsQ3Q9bytkLXAsUnQ9bytmLXA7dFtDdF09UGUsdFtDdCsxXT1NZSx0W1J0XT1TZSx0W1J0KzFdPVZlfX19fV9zaW5nbGVSZWFsVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZStzXSx1PW8rYSxjPW8tYTtyW3RdPXUsclt0KzFdPTAsclt0KzJdPWMsclt0KzNdPTB9X3NpbmdsZVJlYWxUcmFuc2Zvcm00KHQsZSxzKXtjb25zdCByPXRoaXMuX291dCxpPXRoaXMuX2RhdGEsbz10aGlzLl9pbnY/LTE6MSxhPXMqMix1PXMqMyxjPWlbZV0saD1pW2Urc10sZj1pW2UrYV0sZD1pW2UrdV0sbD1jK2YscD1jLWYsbT1oK2QsST1vKihoLWQpLGc9bCttLHY9cCx3PS1JLFA9bC1tLFM9cCxWPUk7clt0XT1nLHJbdCsxXT0wLHJbdCsyXT12LHJbdCszXT13LHJbdCs0XT1QLHJbdCs1XT0wLHJbdCs2XT1TLHJbdCs3XT1WfX1sZXQgRHQ9bj0+Y29uc29sZS5sb2cobik7Y29uc3QgenQ9KC4uLm4pPT5EdCguLi5uKSxXdD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFN0PW49Pm4vKDErbikscXQ9KG4sdCk9PihuJXQrdCkldCxMdD0obix0KT0+KDErdCkqbi8oMSt0Kk1hdGguYWJzKG4pKSxZPShuLHQpPT5NYXRoLnRhbmgobiooMSt0KSksWXQ9KG4sdCk9Pld0KCgxK3QpKm4sLTEsMSksVnQ9KG4sdCk9PntsZXQgZT0oMSsuNSp0KSpuO2NvbnN0IHM9cXQoZSsxLDQpO3JldHVybiAxLU1hdGguYWJzKHMtMil9LGp0PShuLHQpPT5NYXRoLnNpbihNYXRoLlBJLzIqVnQobix0KSksSHQ9KG4sdCk9Pntjb25zdCBlPVN0KE1hdGgubG9nMXAodCkpLHM9KG4tZS8zKm4qbipuKS8oMS1lLzMpO3JldHVybiBZKHMsdCl9LHh0PShuLHQsZT0hMSk9Pntjb25zdCBzPTErMip0LGk9LjA3KlN0KE1hdGgubG9nMXAodCkpLG89WShuK2ksMip0KSxhPVkoZT9pOi1uK2ksMip0KSx1PW8tYSxjPTEvTWF0aC5jb3NoKHMqaSksaD1jKmMsZj1NYXRoLm1heCgxZS04LChlPzE6MikqcypoKTtyZXR1cm4gWSh1L2YsdCl9LHl0PXtzY3VydmU6THQsc29mdDpZLGhhcmQ6WXQsY3ViaWM6SHQsZGlvZGU6eHQsYXN5bToobix0KT0+eHQobix0LCEwKSxmb2xkOlZ0LHNpbmVmb2xkOmp0LGNoZWJ5c2hldjoobix0KT0+e2NvbnN0IGU9MTAqTWF0aC5sb2cxcCh0KTtsZXQgcz0xLHI9bixpLG89MDtmb3IobGV0IGE9MTthPDY0O2ErKyl7aWYoYTwyKXtvKz1hPT0wP3M6cjtjb250aW51ZX1pPTIqbipzLXIscj1zLHM9aSxhJTI9PT0wJiYobys9TWF0aC5taW4oMS4zKmUvYSwyKSppKX1yZXR1cm4gWShvLGUvMjApfX0sWD1PYmplY3QuZnJlZXplKE9iamVjdC5rZXlzKHl0KSksS3Q9bj0+e2xldCB0PW47dHlwZW9mIG49PSJzdHJpbmciJiYodD1YLmluZGV4T2YobiksdD09PS0xJiYoenQoYFtzdXBlcmRvdWdoXSBDb3VsZCBub3QgZmluZCB3YXZlc2hhcGluZyBhbGdvcml0aG0gJHtufS4KICAgICAgICBBdmFpbGFibGUgb3B0aW9ucyBhcmUgJHtYLmpvaW4oIiwgIil9LgogICAgICAgIERlZmF1bHRpbmcgdG8gJHtYWzBdfS5gKSx0PTApKTtjb25zdCBlPVhbdCVYLmxlbmd0aF07cmV0dXJuIHl0W2VdfSxqPTEyOCxSPU1hdGguUEksaz0yKlIscT0xL3NhbXBsZVJhdGUsVD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFV0PShuLHQsZSk9PmUqKHQtbikrbixiPShuLHQpPT5uW3RdPz9uWzBdLEg9bj0+bi1NYXRoLmZsb29yKG4pLEs9bj0+bnwwLFU9bj0+SyhuKy41KSxadD1uPT5LKG4rMSksQXQ9bj0+bi1LKG4pLHo9bj0+e2NvbnN0IHQ9bioqMjtyZXR1cm4gbiooMjcrdCkvKDI3KzkqdCl9LE50PShuLHQpPT57aWYobjwyKXJldHVybiByPT4wO2NvbnN0IGU9dC8obi0xKSxzPXQqLjU7cmV0dXJuIHI9PnIqZS1zfSxaPShuLHQpPT5uKk1hdGgucG93KDIsdC8xMik7ZnVuY3Rpb24gJHQobix0KXt0PU1hdGgubWluKHQsMS10KTtjb25zdCBlPTEvdDtyZXR1cm4gbjx0PyhuKj1lLDIqbi1uKioyLTEpOm4+MS10PyhuPShuLTEpKmUsbioqMisyKm4rMSk6MH1jb25zdCBkdD17dHJpKG4sdD0uNSl7Y29uc3QgZT0xLXQ7cmV0dXJuIG4+PXQ/MS9lLW4vZTpuL3R9LHNpbmUobil7cmV0dXJuIE1hdGguc2luKGsqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPVQodFtzXSwwLDEpLGE9VCh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtJHQobix0KX19LEd0PU9iamVjdC5rZXlzKGR0KTtjbGFzcyBRdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ0aW1lIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6InNrZXciLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6ImRlcHRoIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InBoYXNlb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6InNoYXBlIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImN1cnZlIixkZWZhdWx0VmFsdWU6MX0se25hbWU6ImRjb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1pbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJtYXgiLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucGhhc2V9aW5jcmVtZW50UGhhc2UodCl7dGhpcy5waGFzZSs9dCx0aGlzLnBoYXNlPjEmJih0aGlzLnBoYXNlPXRoaXMucGhhc2UtMSl9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1zLmJlZ2luWzBdO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cilyZXR1cm4hMDtjb25zdCBpPWVbMF0sbz1zLmZyZXF1ZW5jeVswXSxhPXMudGltZVswXSx1PXMuZGVwdGhbMF0sYz1zLnNrZXdbMF0saD1zLnBoYXNlb2Zmc2V0WzBdLGY9cy5jdXJ2ZVswXSxkPXMuZGNvZmZzZXRbMF0sbD1zLm1pblswXSxwPXMubWF4WzBdLG09R3Rbcy5zaGFwZVswXV0sST1pWzBdLmxlbmd0aD8/MDt0aGlzLnBoYXNlPT1udWxsJiYodGhpcy5waGFzZT1BdChhKm8raCkpO2NvbnN0IGc9bypxO2ZvcihsZXQgdj0wO3Y8STt2Kyspe2ZvcihsZXQgdz0wO3c8aS5sZW5ndGg7dysrKXtsZXQgUD0oZHRbbV0odGhpcy5waGFzZSxjKStkKSp1O1A9TWF0aC5wb3coUCxmKSxpW3ddW3ZdPVQoUCxsLHApfXRoaXMuaW5jcmVtZW50UGhhc2UoZyl9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsZm8tcHJvY2Vzc29yIixRdCk7Y2xhc3MgSnQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY29hcnNlIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNvYXJzZVswXT8/MDthPU1hdGgubWF4KDEsYSk7Zm9yKGxldCB1PTA7dTxqO3UrKylmb3IobGV0IGM9MDtjPHIubGVuZ3RoO2MrKylpW2NdW3VdPXUlYT09PTA/cltjXVt1XTppW2NdW3UtMV07cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjb2Fyc2UtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY3J1c2giLGRlZmF1bHRWYWx1ZTowfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuY3J1c2hbMF0/Pzg7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8ajt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspe2NvbnN0IGg9TWF0aC5wb3coMixhLTEpO2lbY11bdV09TWF0aC5yb3VuZChyW2NdW3VdKmgpL2h9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjcnVzaC1wcm9jZXNzb3IiLFh0KTtjbGFzcyB0ZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5zaGFwZVswXTthPWE8MT9hOi45OTk5OTk5OTk2LGE9MiphLygxLWEpO2NvbnN0IHU9TWF0aC5tYXgoLjAwMSxNYXRoLm1pbigxLHMucG9zdGdhaW5bMF0pKTtmb3IobGV0IGM9MDtjPGo7YysrKWZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKWlbaF1bY109KDErYSkqcltoXVtjXS8oMSthKk1hdGguYWJzKHJbaF1bY10pKSp1O3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic2hhcGUtcHJvY2Vzc29yIix0ZSk7Y2xhc3MgT3R7czA9MDtzMT0wO3VwZGF0ZSh0LGUscz0wKXtzPVQocywwLDEpLGU9VChlLDAsc2FtcGxlUmF0ZS8yLTEpO2NvbnN0IHI9VCgyKk1hdGguc2luKGUqUipxKSwwLDEuMTQpLG89MS1NYXRoLnBvdyguNSw4KnMrMSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBPdCxuZXcgT3RdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9VChzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgZD0wO2Q8ajtkKyspdT09Im5vbmUiP2lbZl1bZF09cltmXVtkXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW2RdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW2RdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtkXT1yW2ZdW2RdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW2RdPXJbZl1bZF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsZWUpO2NsYXNzIHNlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjUwMH0se25hbWU6InEiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZHJpdmUiLGRlZmF1bHRWYWx1ZTouNjl9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMucDA9WzAsMF0sdGhpcy5wMT1bMCwwXSx0aGlzLnAyPVswLDBdLHRoaXMucDM9WzAsMF0sdGhpcy5wMzI9WzAsMF0sdGhpcy5wMzM9WzAsMF0sdGhpcy5wMzQ9WzAsMF19cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztjb25zdCBhPXMucVswXSx1PVQoTWF0aC5leHAocy5kcml2ZVswXSksLjEsMmUzKTtsZXQgYz1zLmZyZXF1ZW5jeVswXTtjPWMqaypxLGM9Yz4xPzE6Yztjb25zdCBoPU1hdGgubWluKDgsYSouMTMpO2xldCBmPTEvdSpNYXRoLm1pbigxLjc1LDEraCk7Zm9yKGxldCBkPTA7ZDxqO2QrKylmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKyl7Y29uc3QgcD10aGlzLnAzW2xdKi4zNjA4OTErdGhpcy5wMzJbbF0qLjQxNzI5K3RoaXMucDMzW2xdKi4xNzc4OTYrdGhpcy5wMzRbbF0qLjA0Mzk3MjU7dGhpcy5wMzRbbF09dGhpcy5wMzNbbF0sdGhpcy5wMzNbbF09dGhpcy5wMzJbbF0sdGhpcy5wMzJbbF09dGhpcy5wM1tsXSx0aGlzLnAwW2xdKz0oeihyW2xdW2RdKnUtaCpwKS16KHRoaXMucDBbbF0pKSpjLHRoaXMucDFbbF0rPSh6KHRoaXMucDBbbF0pLXoodGhpcy5wMVtsXSkpKmMsdGhpcy5wMltsXSs9KHoodGhpcy5wMVtsXSkteih0aGlzLnAyW2xdKSkqYyx0aGlzLnAzW2xdKz0oeih0aGlzLnAyW2xdKS16KHRoaXMucDNbbF0pKSpjLGlbbF1bZF09cCpmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGFkZGVyLXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImRpc3RvcnQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3Ioe3Byb2Nlc3Nvck9wdGlvbnM6dH0pe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMuYWxnb3JpdGhtPUt0KHQuYWxnb3JpdGhtKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2ZvcihsZXQgYT0wO2E8ajthKyspe2NvbnN0IHU9VChiKHMucG9zdGdhaW4sYSksLjAwMSwxKSxjPU1hdGguZXhwbTEoYihzLmRpc3RvcnQsYSkpO2ZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKXtjb25zdCBmPXJbaF1bYV07aVtoXVthXT11KnRoaXMuYWxnb3JpdGhtKGYsYyl9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGlzdG9ydC1wcm9jZXNzb3IiLHJlKTtjbGFzcyBuZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZT1bXX1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJwYW5zcHJlYWQiLGRlZmF1bHRWYWx1ZTouNCxtaW46MCxtYXg6MX0se25hbWU6ImZyZXFzcHJlYWQiLGRlZmF1bHRWYWx1ZTouMixtaW46MH0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjAsbWluOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZTo1LG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifV19cHJvY2Vzcyh0LGUscyl7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXSxpPXMudm9pY2VzWzBdO2ZvcihsZXQgbz0wO288clswXS5sZW5ndGg7bysrKXtjb25zdCBhPWIocy5kZXR1bmUsbyksdT1iKHMuZnJlcXNwcmVhZCxvKSxjPWIocy5wYW5zcHJlYWQsbykqLjUrLjU7bGV0IGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyksZD1iKHMuZnJlcXVlbmN5LG8pO2Q9WihkLGEvMTAwKTtjb25zdCBsPU50KGksdSk7Zm9yKGxldCBwPTA7cDxpO3ArKyl7Y29uc3QgbT1aKGQsbChwKSksST1IKG0qcSk7dGhpcy5waGFzZVtwXT10aGlzLnBoYXNlW3BdPz9NYXRoLnJhbmRvbSgpO2NvbnN0IGc9ZHQuc2F3YmxlcCh0aGlzLnBoYXNlW3BdLEkpO3JbMF1bb10rPWcqaCxyWzFdW29dKz1nKmY7bGV0IHY9dGhpcy5waGFzZVtwXStJO3Y+PTEmJih2LT0xKSx0aGlzLnBoYXNlW3BdPXY7Y29uc3Qgdz1oO2g9ZixmPXd9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic3VwZXJzYXctb3NjaWxsYXRvciIsbmUpO2NvbnN0IGllPTIwNDgscHQ9bmV3IE1hcDtmdW5jdGlvbiBvZShuKXtpZighcHQuaGFzKG4pKXtjb25zdCB0PW5ldyBGbG9hdDMyQXJyYXkobik7Zm9yKGxldCBlPTA7ZTxuO2UrKyl0W2VdPS41KigxLU1hdGguY29zKGsqZS9uKSk7cHQuc2V0KG4sdCl9cmV0dXJuIHB0LmdldChuKX1jbGFzcyBhZSBleHRlbmRzIGt0e3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOmllfSxzdXBlcih0KSx0aGlzLnRpbWVDdXJzb3I9MCx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy5pbnZmZnRTaXplPTEvdGhpcy5mZnRTaXplLHRoaXMuaGFubldpbmRvdz1vZSh0aGlzLmZmdFNpemUpLHRoaXMuZmZ0PW5ldyBFdCh0aGlzLmZmdFNpemUpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy50aW1lQ29tcGxleEJ1ZmZlcj10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLm1hZ25pdHVkZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLmZmdFNpemUvMisxKSx0aGlzLnBlYWtJbmRleGVzPW5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpLHRoaXMubmJQZWFrcz0wfXByb2Nlc3NPTEEodCxlLHMpe2xldCByPXMucGl0Y2hGYWN0b3Jbcy5waXRjaEZhY3Rvci5sZW5ndGgtMV07cjwwJiYocj1yKi4yNSkscj1NYXRoLm1heCgwLHIrMSk7Zm9yKGxldCBpPTA7aTx0aGlzLm5iSW5wdXRzO2krKylmb3IobGV0IG89MDtvPHRbaV0ubGVuZ3RoO28rKyl7Y29uc3QgYT10W2ldW29dLHU9ZVtpXVtvXTt0aGlzLmFwcGx5SGFubldpbmRvdyhhKSx0aGlzLmZmdC5yZWFsVHJhbnNmb3JtKHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIsYSksdGhpcy5jb21wdXRlTWFnbml0dWRlcygpLHRoaXMuZmluZFBlYWtzKCksdGhpcy5zaGlmdFBlYWtzKHIpLHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpLHRoaXMuZmZ0LmludmVyc2VUcmFuc2Zvcm0odGhpcy50aW1lQ29tcGxleEJ1ZmZlcix0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHUpLHRoaXMuYXBwbHlIYW5uV2luZG93KHUpfXRoaXMudGltZUN1cnNvcis9dGhpcy5ob3BTaXplfWFwcGx5SGFubldpbmRvdyh0KXtmb3IobGV0IGU9MDtlPHRoaXMuYmxvY2tTaXplO2UrKyl0W2VdKj10aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2xldCB0PTAsZT0wO2Zvcig7dDx0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyl7Y29uc3Qgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDtsZXQgdD0yO2NvbnN0IGU9dGhpcy5tYWduaXR1ZGVzLmxlbmd0aC0yO2Zvcig7dDxlOyl7Y29uc3Qgcz10aGlzLm1hZ25pdHVkZXNbdF07aWYodGhpcy5tYWduaXR1ZGVzW3QtMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0LTJdPj1zKXt0Kys7Y29udGludWV9aWYodGhpcy5tYWduaXR1ZGVzW3QrMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0KzJdPj1zKXt0Kys7Y29udGludWV9dGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3NdPXQsdGhpcy5uYlBlYWtzKyssdCs9Mn19c2hpZnRQZWFrcyh0KXt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZC5maWxsKDApO2ZvcihsZXQgZT0wO2U8dGhpcy5uYlBlYWtzO2UrKyl7Y29uc3Qgcz10aGlzLnBlYWtJbmRleGVzW2VdLHI9VShzKnQpO2lmKHI+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgaT0wLG89dGhpcy5mZnRTaXplO2U+MCYmKGk9cy1VKChzLXRoaXMucGVha0luZGV4ZXNbZS0xXSkvMikpLGU8dGhpcy5uYlBlYWtzLTEmJihvPXMrWnQoKHRoaXMucGVha0luZGV4ZXNbZSsxXS1zKS8yKSk7Y29uc3QgYT1pLXMsdT1vLXMsYz1rKnRoaXMuaW52ZmZ0U2l6ZSooci1zKSxoPU1hdGguY29zKGMqdGhpcy50aW1lQ3Vyc29yKSxmPU1hdGguc2luKGMqdGhpcy50aW1lQ3Vyc29yKTtmb3IobGV0IGQ9YTtkPHU7ZCsrKXtjb25zdCBsPXMrZCxwPXIrZDtpZihwPj10aGlzLm1hZ25pdHVkZXMubGVuZ3RoKWJyZWFrO2NvbnN0IG09MipsLEk9bSsxLGc9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlclttXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbSV0sdz1nKmgtdipmLFA9ZypmK3YqaCxTPTIqcCxWPVMrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtTXSs9dyx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtWXSs9UH19fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLGFlKTtjbGFzcyBjZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGk9LVIsdGhpcy5ZMD0wLHRoaXMuWTE9MCx0aGlzLlBXPVIsdGhpcy5CPTIuMyx0aGlzLmRwaGlmPTAsdGhpcy5lbnZmPTB9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJwdWxzZXdpZHRoIixkZWZhdWx0VmFsdWU6MSxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXTtsZXQgaT0xLG87Zm9yKGxldCBhPTA7YTwoclswXS5sZW5ndGg/PzApO2ErKyl7Y29uc3QgdT0oMS1UKGIocy5wdWxzZXdpZHRoLGEpLC0uOTksLjk5KSkqUixjPWIocy5kZXR1bmUsYSksaD1aKGIocy5mcmVxdWVuY3ksYSksYy8xMDApO289aCprKnEsdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49UiYmKHRoaXMucGhpLT1rKTtsZXQgZj1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMCk7dGhpcy5ZMD0uNSooZit0aGlzLlkwKTtsZXQgZD1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMSt1KTt0aGlzLlkxPS41KihkK3RoaXMuWTEpO2ZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXJbbF1bYV09LjE1KihmLWQpKnRoaXMuZW52Zn1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInB1bHNlLW9zY2lsbGF0b3IiLGNlKTtjb25zdCBtdD17Yml0QzpmdW5jdGlvbihuLHQsZSl7cmV0dXJuIG4mdD9lOjB9LGJyOmZ1bmN0aW9uKG4sdD04KXtpZih0PjMyKXRocm93IG5ldyBFcnJvcigiYnIoKSBTaXplIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gMzIiKTtsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dDtzKyspZXw9bXQuYml0QyhuLDE8PHMsMTw8dC0ocysxKSk7cmV0dXJuIGV9LHNpbmY6ZnVuY3Rpb24obil7cmV0dXJuIE1hdGguc2luKG4qUi8xMjgpfSxjb3NmOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLmNvcyhuKlIvMTI4KX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obipSLzEyOCl9LHJlZ0c6ZnVuY3Rpb24obix0KXtyZXR1cm4gdC50ZXN0KG4udG9TdHJpbmcoMikpfX07bGV0IHR0LHZ0O2Z1bmN0aW9uIHVlKG4pe2lmKHR0PT1udWxsKXt0dD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhNYXRoKSx2dD10dC5tYXAocz0+TWF0aFtzXSk7Y29uc3QgdD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhtdCksZT10Lm1hcChzPT5tdFtzXSk7dHQucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSx2dC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLnR0LCJ0IixgcmV0dXJuIDAsCiR7bnx8MH07YCkuYmluZChnbG9iYWxUaGlzLC4uLnZ0KX1jbGFzcyBoZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5wb3J0Lm9ubWVzc2FnZT10PT57bGV0e2NvZGVUZXh0OmV9PXQuZGF0YTtjb25zdHtieXRlQmVhdFN0YXJ0VGltZTpzfT10LmRhdGE7cyE9bnVsbCYmKHRoaXMudD0wLHRoaXMuaW5pdGlhbE9mZnNldD1NYXRoLmZsb29yKHMpKSxlPWUudHJpbSgpLnJlcGxhY2UoL15ldmFsXCh1bmVzY2FwZVwoZXNjYXBlKD86YHxcKCd8XCgifFwoYCkoLio/KSg/OmB8J1wpfCJcKXxgXCkpLnJlcGxhY2VcKFwvdVwoXC5cLlwpXC9nLFsiJ2BdXCQxJVsiJ2BdXClcKVwpJC8sKHIsaSk9PnVuZXNjYXBlKGVzY2FwZShpKS5yZXBsYWNlKC91KC4uKS9nLCIkMSUiKSkpLHRoaXMuZnVuYz11ZShlKX0sdGhpcy5pbml0aWFsT2Zmc2V0PTAsdGhpcy50PW51bGwsdGhpcy5mdW5jPW51bGx9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7dGhpcy50PT1udWxsJiYodGhpcy50PXMuYmVnaW5bMF0qc2FtcGxlUmF0ZSk7Y29uc3Qgcj1lWzBdLGk9MjU2KnE7Zm9yKGxldCBvPTA7bzxyWzBdLmxlbmd0aDtvKyspe2NvbnN0IGE9YihzLmRldHVuZSxvKSx1PVooYihzLmZyZXF1ZW5jeSxvKSxhLzEwMCksYz1pKnUqdGhpcy50K3RoaXMuaW5pdGlhbE9mZnNldCxmPSh0aGlzLmZ1bmMoYykmMjU1KS8xMjcuNS0xLGQ9VChmKi4yLC0uNCwuNCk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVtvXT1kO3RoaXMudCsrfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsaGUpO2NsYXNzIGxlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJhdHRhY2siLGRlZmF1bHRWYWx1ZTouMDA1LG1pblZhbHVlOjB9LHtuYW1lOiJkZWNheSIsZGVmYXVsdFZhbHVlOi4xNCxtaW5WYWx1ZTowfSx7bmFtZToic3VzdGFpbiIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6MCxtYXhWYWx1ZToxfSx7bmFtZToicmVsZWFzZSIsZGVmYXVsdFZhbHVlOi4xLG1pblZhbHVlOjB9LHtuYW1lOiJhdHRhY2tDdXJ2ZSIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6LTEsbWF4VmFsdWU6MX0se25hbWU6ImRlY2F5Q3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJyZWxlYXNlQ3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJwZWFrIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InJldHJpZ2dlciIsZGVmYXVsdFZhbHVlOjEsbWluVmFsdWU6MCxtYXhWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMudmFsPTAsdGhpcy5zZWdJZHg9MCx0aGlzLnN0YXRlPTAsdGhpcy5iZWdpblRpbWU9MCx0aGlzLmVuZFRpbWU9MCx0aGlzLmF0dGFja1N0YXJ0PTB9X3dhcnAodCxlLHM9OCl7aWYodD09PTB8fHQ9PT0xKXJldHVybiB0O2lmKGU+MCl7Y29uc3Qgcj0xK3MqZTtyZXR1cm4gMS1NYXRoLnBvdygxLXQscil9ZWxzZXtjb25zdCByPTEtcyplO3JldHVybiBNYXRoLnBvdyh0LHIpfX1fYWR2YW5jZSh0LGUscyxyKXtpZihzPT09MHx8dD09PWUpdGhpcy52YWw9ZTtlbHNle2NvbnN0IGk9TWF0aC5taW4oMSwoY3VycmVudFRpbWUtdGhpcy5iZWdpblRpbWUpL3MpLG89dGhpcy5fd2FycChpLHIpO3RoaXMudmFsPXQrKGUtdCkqb319cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1lWzBdWzBdO2lmKCFyKXJldHVybiEwO2NvbnN0IGk9YihzLmJlZ2luLDApLG89YihzLnJldHJpZ2dlciwwKT49LjU7aSE9PXRoaXMuYmVnaW5UaW1lJiYodGhpcy5zdGF0ZT09PTB8fG8pJiYodGhpcy5iZWdpblRpbWU9aSx0aGlzLnN0YXRlPTEsdGhpcy5lbmRUaW1lPWIocy5lbmQsMCksdGhpcy5hdHRhY2tTdGFydD10aGlzLnZhbCk7Y29uc3QgYT10aGlzLmVuZFRpbWUtdGhpcy5iZWdpblRpbWU7Zm9yKGxldCB1PTA7dTxyLmxlbmd0aDt1Kyspe2NvbnN0IGM9YihzLmF0dGFjayx1KSxoPWIocy5kZWNheSx1KSxmPWIocy5zdXN0YWluLHUpLGQ9YihzLnJlbGVhc2UsdSksbD1iKHMuYXR0YWNrQ3VydmUsdSkscD1iKHMuZGVjYXlDdXJ2ZSx1KSxtPWIocy5yZWxlYXNlQ3VydmUsdSksST1iKHMucGVhayx1KSxnPVt7dGltZTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksc3RhcnQ6MCx0YXJnZXQ6MH0se3RpbWU6YyxzdGFydDp0aGlzLmF0dGFja1N0YXJ0LHRhcmdldDoxLGN1cnZlOmx9LHt0aW1lOmMraCxzdGFydDoxLHRhcmdldDpmLGN1cnZlOnB9LHt0aW1lOmEsc3RhcnQ6Zix0YXJnZXQ6Zn0se3RpbWU6YStkLHN0YXJ0OmYsdGFyZ2V0OjAsY3VydmU6bX1dO2xldHt0aW1lOnYsc3RhcnQ6dyx0YXJnZXQ6UCxjdXJ2ZTpTfT1nW3RoaXMuc3RhdGVdO2Zvcih0aGlzLl9hZHZhbmNlKHcsUCx2LFMpO2N1cnJlbnRUaW1lLXRoaXMuYmVnaW5UaW1lPj12Oyl0aGlzLnN0YXRlPSh0aGlzLnN0YXRlKzEpJWcubGVuZ3RoLHY9Z1t0aGlzLnN0YXRlXS50aW1lO3JbdV09dGhpcy52YWwqSX1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoImVudmVsb3BlLXByb2Nlc3NvciIsbGUpO2NvbnN0IEI9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gZmUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBGdD1uPT4oZmUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBkZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBwZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1GdCh0KSxyPUZ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBtZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKnBlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IGd0PXt9O2NsYXNzIHZlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhZ3RbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgZD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspZFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBkfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha31ndFtpXT1vfXRoaXMudGFibGVzPWd0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOlUoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIEIuTk9ORTpyZXR1cm4gdDtjYXNlIEIuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBCLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsQi5BU1lNKSk7Y2FzZSBCLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIEIuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIEIuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgQi5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqKjIpO3JldHVybiB0KnIlMX1jYXNlIEIuUVVBTlQ6e2NvbnN0e246cn09dGhpcy5fdG9CaXRzKGUpO3JldHVybiBLKHQqcikvcn1jYXNlIEIuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsVSg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoQXQoaSp0KS0uNSkqMn1jYXNlIEIuUFdNOntjb25zdCByPVQoLjUrLjQ5KigyKmUtMSksMCwxKTtyZXR1cm4gdDxyP3QvciouNTouNSsodC1yKS8oMS1yKSouNX1jYXNlIEIuT1JCSVQ6e2NvbnN0IHI9LjUqZTtyZXR1cm4gSCh0K3IqTWF0aC5zaW4oayozKnQpKX1jYXNlIEIuU1BJTjp7Y29uc3Qgcj0uNSplLHtuOml9PXRoaXMuX3RvQml0cyhlLDEsNik7cmV0dXJuIEgodCtyKk1hdGguc2luKGsqaSp0KSl9Y2FzZSBCLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gVCgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgQi5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKioyPD1vO2ErPTIpaWYobyVhPT09MClyZXR1cm4hMTtyZXR1cm4hMH07bGV0e246aX09dGhpcy5fdG9CaXRzKGUsMyk7Zm9yKDshcihpKTspaSsrO3JldHVybiBLKHQqaSkvaX1jYXNlIEIuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPVUocik7Y29uc3QgaT0xPDxyLG89Syh0KmkpO3JldHVybiBkZShvLHIpL2l9Y2FzZSBCLkJST1dOSUFOOntjb25zdCByPS4yNSplKm1lKDY0KnQsNCk7cmV0dXJuIEgodCtyKX1jYXNlIEIuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIFQoYSwwLDEpfWNhc2UgQi5XT1JNSE9MRTp7Y29uc3Qgcj1UKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIEIuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErVSgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIFQociwwLDEpfWNhc2UgQi5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgQi5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKGsqdCkqZTtyZXR1cm4gSCh0K3IpfWNhc2UgQi5GTElQOnJldHVybiB0O2RlZmF1bHQ6cmV0dXJuIHR9fV9zYW1wbGVGcmFtZSh0LGUpe2NvbnN0IHM9dC5sZW5ndGgscj1lKnM7bGV0IGk9cnwwO2k+PXMmJihpPTApO2NvbnN0IG89ci1pLGE9dFtpXTtsZXQgdT1pKzE7dT49cyYmKHU9MCk7Y29uc3QgYz10W3VdO3JldHVybiBhKyhjLWEpKm99X2Nob29zZU1pcCh0KXtjb25zdCBlPVQodCwxZS02LDY0KTtsZXQgcz0wO2Zvcig7cysxPCh0aGlzLnRhYmxlcz8ubGVuZ3RofHwxKSYmZTx0aGlzLnRhYmxlc1tzXVswXS5sZW5ndGgvODspcysrO3JldHVybiBzfXByb2Nlc3ModCxlLHMpe2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtjb25zdCByPWVbMF1bMF0saT1lWzBdWzFdfHxlWzBdWzBdO2lmKCF0aGlzLnRhYmxlcylyZXR1cm4gci5maWxsKDApLGkhPT1yJiZpLnNldChyKSwhMDtjb25zdCBvPXMudm9pY2VzWzBdO2ZvcihsZXQgYT0wO2E8ci5sZW5ndGg7YSsrKXtjb25zdCB1PWIocy5kZXR1bmUsYSksYz1iKHMuZnJlcXNwcmVhZCxhKSxmPVQoYihzLnBvc2l0aW9uLGEpLDAsMSkqKHRoaXMubnVtRnJhbWVzLTEpLGQ9ZnwwLGw9Zi1kLHA9VChiKHMud2FycCxhKSwwLDEpLG09YihzLndhcnBNb2RlLGEpLEk9VChiKHMucGhhc2VyYW5kLGEpLDAsMSksZz1vPjE/VChiKHMucGFuc3ByZWFkLGEpLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpnKSx3PU1hdGguc3FydCguNSsuNSpnKTtsZXQgUD1iKHMuZnJlcXVlbmN5LGEpO1A9WihQLHUvMTAwKTtjb25zdCBTPTEvTWF0aC5zcXJ0KG8pLFY9TnQobyxjKTtmb3IobGV0IE09MDtNPG87TSsrKXtjb25zdCB4PShNJjEpPT0xO2xldCB5PXYsQT13O3gmJih5PXcsQT12KTtjb25zdCBOPVooUCxWKE0pKSpxLEU9dGhpcy5fY2hvb3NlTWlwKE4pLE89dGhpcy50YWJsZXNbRV07dGhpcy5waGFzZVtNXT10aGlzLnBoYXNlW01dPz9NYXRoLnJhbmRvbSgpKkk7Y29uc3QgRj10aGlzLl93YXJwUGhhc2UodGhpcy5waGFzZVtNXSxwLG0pLEQ9dGhpcy5fc2FtcGxlRnJhbWUoT1tkXSxGKSxMPXRoaXMuX3NhbXBsZUZyYW1lKE9bTWF0aC5taW4odGhpcy5udW1GcmFtZXMtMSxkKzEpXSxGKTtsZXQgQz1VdChELEwsbCk7bT09PUIuRkxJUCYmdGhpcy5waGFzZVtNXTxwJiYoQz0tQyksclthXSs9Qyp5KlMsaVthXSs9QypBKlMsdGhpcy5waGFzZVtNXT1IKHRoaXMucGhhc2VbTV0rTil9fXJldHVybiEwfX1yZXR1cm4gcmVnaXN0ZXJQcm9jZXNzb3IoIndhdmV0YWJsZS1vc2NpbGxhdG9yLXByb2Nlc3NvciIsdmUpLGZ0LldhcnBNb2RlPUIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGZ0LFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxmdH0pKHt9KTsK";let audioContext;const setDefaultAudioContext=()=>(audioContext=new AudioContext,audioContext),getAudioContext=()=>audioContext||setDefaultAudioContext();function getAudioContextCurrentTime(){return getAudioContext().currentTime}let noiseCache={};function getNoiseBuffer(e,t){const o=getAudioContext();if(noiseCache[e])return noiseCache[e];const a=2*o.sampleRate,u=o.createBuffer(1,a,o.sampleRate),l=u.getChannelData(0);let p=0,d,g,f,A,b,F,S;d=g=f=A=b=F=S=0;for(let k=0;k<a;k++)if(e==="white")l[k]=Math.random()*2-1;else if(e==="brown"){let $=Math.random()*2-1;l[k]=(p+.02*$)/1.02,p=l[k]}else if(e==="pink"){let $=Math.random()*2-1;d=.99886*d+$*.0555179,g=.99332*g+$*.0750759,f=.969*f+$*.153852,A=.8665*A+$*.3104856,b=.55*b+$*.5329522,F=-.7616*F-$*.016898,l[k]=d+g+f+A+b+F+S+$*.5362,l[k]*=.11,S=$*.115926}else if(e==="crackle"){const $=t*.01;Math.random()<$?l[k]=Math.random()*2-1:l[k]=0}return e!=="crackle"&&(noiseCache[e]=u),u}function getNoiseOscillator(e="white",t,o=.02){const u=getAudioContext().createBufferSource();return u.buffer=getNoiseBuffer(e,o),u.loop=!0,u.start(t),{node:u,stop:l=>u.stop(l)}}function getNoiseMix(e,t,o){const a=getNoiseOscillator("pink",o),u=drywet(e,a.node,t);return a.node.onended=()=>u.onended(),{node:u.node,stop:l=>a?.stop(l)}}const noises=["pink","white","brown","crackle"];function gainNode(e){const t=getAudioContext().createGain();return t.gain.value=e,t}function effectSend(e,t,o){const a=gainNode(o);return e.connect(a),a.connect(t),a}const getSlope=(e,t,o,a)=>a-o===0?0:(t-e)/(a-o);function getWorklet(e,t,o,a){const u=new AudioWorkletNode(e,t,a);return Object.entries(o).forEach(([l,p])=>{p!==void 0&&(u.parameters.get(l).value=p)}),u}const getParamADSR=(e,t,o,a,u,l,p,d,g,f="exponential")=>{t=nanFallback(t),o=nanFallback(o),a=nanFallback(a),u=nanFallback(u);const A=f==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";f==="exponential"&&(l=l===0?.001:l,p=p===0?.001:p);const b=p-l,F=p,S=l+a*b,k=g-d,$=R=>{let I;if(t>R){let z=getSlope(l,F,0,t);I=R*z+(l>F?l:0)}else I=(R-t)*getSlope(F,S,0,o)+F;return f==="exponential"&&(I=I||.001),I};e.setValueAtTime(l,d),t>k?e[A]($(k),g):t+o>k?(e[A]($(t),d+t),e[A]($(k),g)):(e[A]($(t),d+t),e[A]($(t+o),d+t+o),e.setValueAtTime(S,g)),e[A](l,g+u)};function getModulationShapeInput(e){return typeof e=="number"?e%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[e]??0}function getLfo(e,t,o,a={}){const{shape:u=0,...l}=a,{dcoffset:p=-.5,depth:d=1}=a,g={frequency:1,depth:d,skew:.5,phaseoffset:0,time:t,begin:t,end:o,shape:getModulationShapeInput(u),dcoffset:p,min:p*d,max:p*d+d,curve:1,...l};return getWorklet(e,"lfo-processor",g)}function getCompressor(e,t,o,a,u,l){const p={threshold:t??-3,ratio:o??10,knee:a??10,attack:u??.005,release:l??.05};return new DynamicsCompressorNode(e,p)}const getADSRValues=(e,t="linear",o)=>{const[p,d,g,f]=e;if(p==null&&d==null&&g==null&&f==null)return o??[.001,.001,1,.01];const A=g??(p!=null&&d==null||p==null&&d==null?1:.001);return[Math.max(p??0,.001),Math.max(d??0,.001),Math.min(A,1),Math.max(f??0,.01)]};function getParamLfo(e,t,o,a,u){let{defaultDepth:l=1,depth:p,dcoffset:d,...g}=u;p==null&&(p=Object.values(g).some(b=>b!=null)?l:0);let f;return p&&(f=getLfo(e,o,a,{depth:p,dcoffset:d,...g}),f.connect(t)),f}function applyParameterModulators(e,t,o,a,u,l){let{amount:p,offset:d,defaultAmount:g=1,curve:f="linear",values:A,holdEnd:b,defaultValues:F}=u;p==null&&(p=A.some(z=>z!=null)?g:0);const S=d??0,k=p+S;if(Math.abs(k-S)){const[I,z,ie,U]=getADSRValues(A,f,F);getParamADSR(t,I,z,ie,U,S,k,o,b,f)}const R=getParamLfo(e,t,o,a,l);return{lfo:R,disconnect:()=>R?.disconnect()}}function createFilter(e,t,o,a,u,l){let{frequency:p,anchor:d,env:g,type:f,model:A,q:b=1,drive:F=.69,depth:S,depthfrequency:k,dcoffset:$=-.5,skew:R,shape:I,rate:z,sync:ie}=a,U,O;A==="ladder"?(O=getWorklet(e,"ladder-processor",{frequency:p,q:b,drive:F}),U=O.parameters.get("frequency")):(O=e.createBiquadFilter(),O.type=f,O.Q.value=b,O.frequency.value=p,U=O.frequency);const ee=[a.attack,a.decay,a.sustain,a.release],[re,oe,_e,ue]=getADSRValues(ee,"exponential",[.005,.14,0,.1]);if([...ee,g].some(ve=>ve!==void 0)){g=nanFallback(g,1,!0),d=nanFallback(d,0,!0);const ve=Math.abs(g),Fe=ve*d;let Se=clamp(2**-Fe*p,0,2e4),Ee=clamp(2**(ve-Fe)*p,0,2e4);g<0&&([Se,Ee]=[Ee,Se]),getParamADSR(U,re,oe,_e,ue,Se,Ee,t,o,"exponential")}ie!=null&&(z=u*ie);const me=[S,k,R,I,z].some(ve=>ve!==void 0);let he;if(me){S=S??1;const ve=l/u,Se={depth:k??(S??1)*p,dcoffset:$,skew:R,shape:I,frequency:z??u,min:-p+30,max:2e4-p,time:ve,curve:1};he=getParamLfo(e,U,t,o,Se)}return{filter:O,lfo:he}}let wetfade=e=>e<.5?1:1-(e-.5)/.5;function drywet(e,t,o=0){const a=getAudioContext();if(!o)return e;let u=a.createGain(),l=a.createGain();e.connect(u),t.connect(l),u.gain.value=wetfade(o),l.gain.value=wetfade(1-o);let p=a.createGain();return u.connect(p),l.connect(p),{node:p,onended:()=>{u.disconnect(p),l.disconnect(p),e.disconnect(u),t.disconnect(l)}}}let curves=["linear","exponential"];function getPitchEnvelope(e,t,o,a){if((t.pattack??t.pdecay??t.psustain??t.prelease??t.penv)===void 0)return;const l=nanFallback(t.penv,1,!0),p=curves[t.pcurve??0];let[d,g,f,A]=getADSRValues([t.pattack,t.pdecay,t.psustain,t.prelease],p,[.2,.001,1,.001]),b=t.panchor??f;const F=l*100,S=0-F*b,k=F-F*b;getParamADSR(e,d,g,f,A,S,k,o,a,p)}function getVibratoOscillator(e,t,o){const{vibmod:a=.5,vib:u}=t;let l;if(u>0){l=getAudioContext().createOscillator(),l.frequency.value=u;const p=getAudioContext().createGain();return p.gain.value=a*100,l.connect(p),p.connect(e),l.onended=()=>{p.disconnect(e),l.disconnect(p)},l.start(o),l}}function scheduleAtTime(e,t,o=getAudioContext()){const a=o.currentTime;webAudioTimeout(o,e,a,t)}function webAudioTimeout(e,t,o,a){const u=new ConstantSourceNode(e),l=gainNode(0);return l.connect(e.destination),u.connect(l),u.onended=()=>{try{l.disconnect()}catch{}try{u.disconnect()}catch{}t()},u.start(o),u.stop(a),u}const mod$2=(e,t=1,o="sine")=>{const a=getAudioContext();let u;noises.includes(o)?(u=a.createBufferSource(),u.buffer=getNoiseBuffer(o,2),u.loop=!0):(u=a.createOscillator(),u.type=o,u.frequency.value=e),u.start();const l=gainNode(t);return u.connect(l),{node:l,stop:p=>u.stop(p),osc:u}},fm=(e,t,o,a="sine")=>{const l=e.value*t,p=l*o;return mod$2(l,p,a)};function applyFM(e,t,o){const{fmh:a=1,fmi:u,fmenv:l="exp",fmattack:p,fmdecay:d,fmsustain:g,fmrelease:f,fmvelocity:A,fmwave:b="sine",duration:F}=t;let S,k=()=>{};if(u){const R=getAudioContext().createGain(),I=fm(e,a,u,b);if(S=I.node,k=I.stop,![p,d,g,f,A].some(z=>z!==void 0))S.connect(e);else{const[z,ie,U,O]=getADSRValues([p,d,g,f]),ee=o+F;getParamADSR(R.gain,z,ie,U,O,0,1,o,ee,l==="exp"?"exponential":"linear"),S.connect(R),R.connect(e)}I.osc.onended=()=>{R.disconnect(),S.disconnect(),I.osc.disconnect()}}return{stop:k}}const __squash=e=>e/(1+e),_mod=(e,t)=>(e%t+t)%t,_scurve=(e,t)=>(1+t)*e/(1+t*Math.abs(e)),_soft=(e,t)=>Math.tanh(e*(1+t)),_hard=(e,t)=>clamp((1+t)*e,-1,1),_fold=(e,t)=>{let o=(1+.5*t)*e;const a=_mod(o+1,4);return 1-Math.abs(a-2)},_sineFold=(e,t)=>Math.sin(Math.PI/2*_fold(e,t)),_cubic=(e,t)=>{const o=__squash(Math.log1p(t)),a=(e-o/3*e*e*e)/(1-o/3);return _soft(a,t)},_diode=(e,t,o=!1)=>{const a=1+2*t,l=.07*__squash(Math.log1p(t)),p=_soft(e+l,2*t),d=_soft(o?l:-e+l,2*t),g=p-d,f=1/Math.cosh(a*l),A=f*f,b=Math.max(1e-8,(o?1:2)*a*A);return _soft(g/b,t)},_asym=(e,t)=>_diode(e,t,!0),_chebyshev=(e,t)=>{const o=10*Math.log1p(t);let a=1,u=e,l,p=0;for(let d=1;d<64;d++){if(d<2){p+=d==0?a:u;continue}l=2*e*a-u,u=a,a=l,d%2===0&&(p+=Math.min(1.3*o/d,2)*l)}return _soft(p,o/20)},distortionAlgorithms={scurve:_scurve,soft:_soft,hard:_hard,cubic:_cubic,diode:_diode,asym:_asym,fold:_fold,sinefold:_sineFold,chebyshev:_chebyshev},_algoNames=Object.freeze(Object.keys(distortionAlgorithms)),getDistortionAlgorithm=e=>{let t=e;typeof e=="string"&&(t=_algoNames.indexOf(e),t===-1&&(logger$1(`[superdough] Could not find waveshaping algorithm ${e}.
        Available options are ${_algoNames.join(", ")}.
        Defaulting to ${_algoNames[0]}.`),t=0));const o=_algoNames[t%_algoNames.length];return distortionAlgorithms[o]},getDistortion=(e,t,o)=>getWorklet(getAudioContext(),"distort-processor",{distort:e,postgain:t},{processorOptions:{algorithm:o}}),getFrequencyFromValue=(e,t=36)=>{let{note:o,freq:a,octave:u=0}=e;return o=o||t,typeof o=="string"&&(o=noteToMidi(o)),!a&&typeof o=="number"&&(a=midiToFreq$1(o)),a*=Math.pow(2,u),Number(a)},destroyAudioWorkletNode=e=>{e!=null&&(e.disconnect(),e.parameters.get("end")?.setValueAtTime(0,0))};let clean=Symbol("clean"),listenerQueue=[],lqIndex=0;const QUEUE_ITEMS_PER_LISTENER=4;let atom=e=>{let t=[],o={get(){return o.lc||o.listen(()=>{})(),o.value},lc:0,listen(a){return o.lc=t.push(a),()=>{for(let l=lqIndex+QUEUE_ITEMS_PER_LISTENER;l<listenerQueue.length;)listenerQueue[l]===a?listenerQueue.splice(l,QUEUE_ITEMS_PER_LISTENER):l+=QUEUE_ITEMS_PER_LISTENER;let u=t.indexOf(a);~u&&(t.splice(u,1),--o.lc||o.off())}},notify(a,u){let l=!listenerQueue.length;for(let p of t)listenerQueue.push(p,o.value,a,u);if(l){for(lqIndex=0;lqIndex<listenerQueue.length;lqIndex+=QUEUE_ITEMS_PER_LISTENER)listenerQueue[lqIndex](listenerQueue[lqIndex+1],listenerQueue[lqIndex+2],listenerQueue[lqIndex+3]);listenerQueue.length=0}},off(){},set(a){let u=o.value;u!==a&&(o.value=a,o.notify(u))},subscribe(a){let u=o.listen(a);return a(o.value),u},value:e};return process.env.NODE_ENV!=="production"&&(o[clean]=()=>{t=[],o.lc=0,o.off()}),o},map=(e={})=>{let t=atom(e);return t.setKey=function(o,a){let u=t.value;typeof a>"u"&&o in t.value?(t.value={...t.value},delete t.value[o],t.notify(u,o)):t.value[o]!==a&&(t.value={...t.value,[o]:a},t.notify(u,o))},t};const bufferCache$1={},loadCache$2={},getCachedBuffer=e=>bufferCache$1[e];function humanFileSize$1(e,t){var o=1024;if(e<o)return e+" B";var a=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do e/=o,++u;while(e>=o);return e.toFixed(1)+" "+a[u]}function getSampleInfo(e,t){const{speed:o=1}=e,{transpose:a,url:u,index:l,midi:p,label:d}=getCommonSampleInfo(e,t);let g=Math.abs(o)*Math.pow(2,a/12);return{transpose:a,url:u,index:l,midi:p,label:d,playbackRate:g}}const getSampleBuffer=async(e,t,o)=>{let{url:a,label:u,playbackRate:l}=getSampleInfo(e,t);o&&(a=await o(a));const p=getAudioContext(),d=await loadBuffer$1(a,p,u);return e.unit==="c"&&(l=l*d.duration),{buffer:d,playbackRate:l}},getSampleBufferSource=async(e,t,o)=>{let{buffer:a,playbackRate:u}=await getSampleBuffer(e,t,o);e.speed<0&&(a=reverseBuffer(a));const p=getAudioContext().createBufferSource();p.buffer=a,p.playbackRate.value=u;const{loopBegin:d=0,loopEnd:g=1,begin:f=0,end:A=1}=e,b=f*p.buffer.duration;e.loop&&(p.loop=!0,p.loopStart=d*p.buffer.duration-b,p.loopEnd=g*p.buffer.duration-b);const S=p.buffer.duration/p.playbackRate.value,k=(A-f)*S;return{bufferSource:p,offset:b,bufferDuration:S,sliceDuration:k}},loadBuffer$1=(e,t,o,a=0)=>{const u=o?`sound "${o}:${a}"`:"sample";if(e=e.replace("#","%23"),!loadCache$2[e]){logger$1(`[sampler] load ${u}..`,"load-sample",{url:e});const l=Date.now();loadCache$2[e]=fetch(e).then(p=>p.arrayBuffer()).then(async p=>{const d=Date.now()-l,g=humanFileSize$1(p.byteLength);logger$1(`[sampler] load ${u}... done! loaded ${g} in ${d}ms`,"loaded-sample",{url:e});const f=await t.decodeAudioData(p);return bufferCache$1[e]=f,f})}return loadCache$2[e]};function reverseBuffer(e){const t=getAudioContext(),o=t.createBuffer(e.numberOfChannels,e.length,t.sampleRate);for(let a=0;a<e.numberOfChannels;a++)o.copyToChannel(e.getChannelData(a).slice().reverse(),a,a);return o}const getLoadedBuffer=e=>bufferCache$1[e];function resolveSpecialPaths(e){if(e.startsWith("bubo:")){const[t,o]=e.split(":");e=`github:Bubobubobubobubo/dough-${o}`}return e}function githubPath$2(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let o=e.slice(7);o=o.endsWith("/")?o.slice(0,-1):o;let a=o.split("/"),u=a[0],l=a.length>=2?a[1]:"samples",p=a.length>=3?a[2]:"main",d=a.slice(3);return d.push(t||""),d=d.join("/"),`https://raw.githubusercontent.com/${u}/${l}/${p}/${d}`}const processSampleMap=(e,t,o=e._base||"")=>Object.entries(e).forEach(([a,u])=>{if(typeof u=="string"&&(u=[u]),typeof u!="object")throw new Error("wrong sample map format for "+a);o=u._base||o,o=resolveSpecialPaths(o),o.startsWith("github:")&&(o=githubPath$2(o,""));const l=p=>o+p;Array.isArray(u)?u=u.map(l):u=Object.fromEntries(Object.entries(u).map(([p,d])=>[p,(typeof d=="string"?[d]:d).map(l)])),t(a,u)});let resourcePrefixHandlers={};function registerSamplesPrefix(e,t){resourcePrefixHandlers[e]=t}function getSamplesPrefixHandler(e){const t=Object.entries(resourcePrefixHandlers).find(([o])=>e.startsWith(o));if(t)return t[1]}async function fetchSampleMap$1(e){const t=getSamplesPrefixHandler(e);if(t)return t(e);if(e=resolveSpecialPaths(e),e.startsWith("github:")&&(e=githubPath$2(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[u,l]=e.split("shabda:");e=`https://shabda.ndre.gr/${l}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[u,l]=e.split("shabda/speech");l=l.startsWith("/")?l.substring(1):l;let[p,d]=l.split(":"),g="f",f="en-GB";p&&([f,g]=p.split("/")),e=`https://shabda.ndre.gr/speech/${d}.json?gender=${g}&language=${f}&strudel=1'`}if(typeof fetch!="function")return;const o=getBaseURL(e);if(typeof fetch>"u")return;const a=await fetch(e).then(u=>u.json()).catch(u=>{throw console.error(u),new Error(`error loading "${e}"`)});return[a,a._base||o]}const samples=async(e,t=e._base||"",o={})=>{if(typeof e=="string"){const[l,p]=await fetchSampleMap$1(e);return samples(l,t||p,o)}const{prebake:a,tag:u}=o;processSampleMap(e,(l,p)=>{registerSampleSource(l,p,{baseUrl:t,prebake:a,tag:u})},t)},cutGroups=[];async function onTriggerSample(e,t,o,a,u){let{s:l,nudge:p=0,cut:d,loop:g,clip:f=void 0,n:A=0,speed:b=1,duration:F}=t;if(b===0)return;const S=getAudioContext();let[k,$,R,I]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);const{bufferSource:z,sliceDuration:ie,offset:U}=await getSampleBufferSource(t,a,u);if(S.currentTime>e){logger$1(`[sampler] still loading sound "${l}:${A}"`,"highlight");return}if(!z){logger$1(`[sampler] could not load "${l}:${A}"`,"error");return}let O=getVibratoOscillator(z.detune,t,e);const ee=e+p;z.start(ee,U);const re=S.createGain(),oe=z.connect(re);f==null&&g==null&&t.release==null&&(F=ie);let _e=e+F;getParamADSR(oe.gain,k,$,R,I,0,1,e,_e,"linear"),getPitchEnvelope(z.detune,t,e,_e);const ue=S.createGain();oe.connect(ue),z.onended=function(){z.disconnect(),O?.stop(),oe.disconnect(),ue.disconnect(),o()};let Ce=_e+I+.01;z.stop(Ce);const he={node:ue,bufferSource:z,stop:ve=>{z.stop(ve)}};if(d!==void 0){const ve=cutGroups[d];ve&&(ve.node.gain.setValueAtTime(1,ee),ve.node.gain.linearRampToValueAtTime(0,ee+.01)),cutGroups[d]=he}return he}function registerSample(e,t,o){registerSound(e,(a,u,l)=>onTriggerSample(a,u,l,t),{type:"sample",samples:t,...o})}function registerSampleSource(e,t,o){e.startsWith("wt_")?registerWaveTable(e,t,o):registerSample(e,t,o)}let hasChanged=(e,t)=>e!==void 0&&e!==t;class Orbit{reverbNode;delayNode;output;summingNode;djfNode;audioContext;constructor(t){this.audioContext=t,this.output=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode.connect(this.output)}disconnect(){this.output.disconnect(),this.summingNode.disconnect(),this.delayNode?.disconnect(),this.reverbNode?.disconnect()}getDjf(t,o=0){this.djfNode==null&&(this.djfNode=getWorklet(this.audioContext,"djf-processor",{value:t}),this.summingNode.disconnect(),this.summingNode.connect(this.djfNode),this.djfNode.connect(this.output)),this.djfNode.parameters.get("value").setValueAtTime(t,o)}getDelay(t=0,o=.5,a){return o=clamp(o,0,.98),this.delayNode==null&&(this.delayNode=this.audioContext.createFeedbackDelay(1,t,o),this.delayNode.connect(this.summingNode),this.delayNode.start?.(a)),this.delayNode.delayTime.value!==t&&this.delayNode.delayTime.setValueAtTime(t,a),this.delayNode.feedback.value!==o&&this.delayNode.feedback.setValueAtTime(o,a),this.delayNode}getReverb(t,o,a,u,l,p,d){return this.reverbNode==null&&(this.reverbNode=this.audioContext.createReverb(t,o,a,u,l,p,d),this.reverbNode.connect(this.summingNode)),(hasChanged(t,this.reverbNode.duration)||hasChanged(o,this.reverbNode.fade)||hasChanged(a,this.reverbNode.lp)||hasChanged(u,this.reverbNode.dim)||hasChanged(p,this.reverbNode.irspeed)||hasChanged(d,this.reverbNode.irbegin)||this.reverbNode.ir!==l)&&this.reverbNode.generate(t,o,a,u,l,p,d),this.reverbNode}sendReverb(t,o){return effectSend(t,this.reverbNode,o)}sendDelay(t,o){return effectSend(t,this.delayNode,o)}duck(t,o=0,a=.1,u=1){const l=o,p=Math.max(a,.002),d=this.output.gain;webAudioTimeout(this.audioContext,()=>{const g=this.audioContext.currentTime,f=d.value;d.cancelScheduledValues(g),d.setValueAtTime(f,g);const A=Math.max(t,g),b=clamp(1-Math.sqrt(u),.01,f);d.exponentialRampToValueAtTime(b,A+l),d.exponentialRampToValueAtTime(1,A+l+p)},0,t-.01)}connectToOutput(t){t.connect(this.summingNode)}}class SuperdoughOutput{channelMerger;destinationGain;constructor(t){this.audioContext=t,this.initializeAudio()}initializeAudio(){const t=this.audioContext,o=t.destination.maxChannelCount;this.audioContext.destination.channelCount=o,this.channelMerger=new ChannelMergerNode(t,{numberOfInputs:t.destination.channelCount}),this.destinationGain=new GainNode(t),this.channelMerger.connect(this.destinationGain),this.destinationGain.connect(t.destination)}reset(){this.disconnect(),this.initializeAudio()}disconnect(){this.channelMerger.disconnect(),this.destinationGain.disconnect(),this.destinationGain=null,this.channelMerger=null}connectToDestination=(t,o=[0,1])=>{const a=new StereoPannerNode(this.audioContext);t.connect(a);const u=new ChannelSplitterNode(this.audioContext,{numberOfOutputs:a.channelCount});a.connect(u),o.forEach((l,p)=>{u.connect(this.channelMerger,p%a.channelCount,l%this.audioContext.destination.channelCount)})}}class SuperdoughAudioController{audioContext;output;nodes={};constructor(t){this.audioContext=t,this.output=new SuperdoughOutput(t)}reset(){Array.from(this.nodes).forEach(t=>{t.disconnect()}),this.nodes={},this.output.reset()}duck(t,o,a=0,u=.1,l=1){const p=[t].flat(),d=[a].flat(),g=[u].flat(),f=[l].flat();p.forEach((A,b)=>{const F=this.nodes[A];if(F==null){errorLogger(new Error(`duck target orbit ${A} does not exist`),"superdough");return}const S=d[b]??d[0],k=Math.max(g[b]??g[0],.002),$=f[b]??f[0];F.duck(o,S,k,$)})}getOrbit(t,o){return this.nodes[t]==null&&(this.nodes[t]=new Orbit(this.audioContext),this.output.connectToDestination(this.nodes[t].output,o)),this.nodes[t]}}const DEFAULT_MAX_POLYPHONY=128,DEFAULT_AUDIO_DEVICE_NAME="System Standard";let maxPolyphony=DEFAULT_MAX_POLYPHONY;function setMaxPolyphony(e){maxPolyphony=parseInt(e)??DEFAULT_MAX_POLYPHONY}let multiChannelOrbits=!1;function setMultiChannelOrbits(e){multiChannelOrbits=e==!0}const soundMap$1=map();function registerSound(e,t,o={}){e=e.toLowerCase().replace(/\s+/g,"_"),soundMap$1.setKey(e,{onTrigger:t,data:o})}let gainCurveFunc=e=>e;function applyGainCurve(e){return gainCurveFunc(e)}function setGainCurve(e){gainCurveFunc=e}function aliasBankMap(e){for(const o in e)e[o.toLowerCase()]=e[o];const t=soundMap$1.get();for(const o in t){const[a,u]=o.split("_");if(!u)continue;const l=e[a];if(l){if(typeof l=="string")t[`${l}_${u}`.toLowerCase()]=t[o];else if(Array.isArray(l))for(const p of l)t[`${p}_${u}`.toLowerCase()]=t[o]}}soundMap$1.set({...t})}async function aliasBankPath(e){const o=await(await fetch(e)).json();aliasBankMap(o)}async function aliasBank(...e){switch(e.length){case 1:return typeof e[0]=="string"?aliasBankPath(e[0]):aliasBankMap(e[0]);case 2:return aliasBankMap({[e[0]]:e[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+e.length)}}function soundAlias(e,t){if(getSound(e)==null){logger$1("soundAlias: original sound not found");return}soundMap$1.setKey(t,getSound(e))}function getSound(e){return typeof e!="string"?(console.warn(`getSound: expected string got "${e}". fall back to triangle`),soundMap$1.get().triangle):soundMap$1.get()[e.toLowerCase()]}const getAudioDevices=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let e=await navigator.mediaDevices.enumerateDevices();e=e.filter(o=>o.kind==="audiooutput"&&o.deviceId!=="default");const t=new Map;return t.set(DEFAULT_AUDIO_DEVICE_NAME,""),e.forEach(o=>{t.set(o.label,o.deviceId)}),t};let defaultDefaultValues={s:"triangle",gain:.8,postgain:1,density:".03",channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const defaultDefaultDefaultValues=Object.freeze({...defaultDefaultValues});function setDefault(e,t){defaultDefaultValues[e]=t}function resetDefaults(){defaultDefaultValues={...defaultDefaultDefaultValues}}let defaultControls=new Map(Object.entries(defaultDefaultValues));function setDefaultValue(e,t){defaultControls.set(e,t)}function getDefaultValue(e){return defaultControls.get(e)}function setDefaultValues(e){Object.keys(e).forEach(t=>{setDefaultValue(t,e[t])})}function resetDefaultValues(){defaultControls=new Map(Object.entries(defaultDefaultValues))}function setVersionDefaults(e){resetDefaultValues(),e==="1.0"&&setDefaultValue("fanchor",.5)}const resetLoadedSounds=()=>soundMap$1.set({});let externalWorklets=[];function registerWorklet(e){externalWorklets.push(e)}let workletsLoading;function loadWorklets(){if(!workletsLoading){const e=getAudioContext(),t=externalWorklets.concat([workletsUrl]);workletsLoading=Promise.all(t.map(o=>e.audioWorklet.addModule(o)))}return workletsLoading}async function initAudio(e={}){const{disableWorklets:t=!1,maxPolyphony:o,audioDeviceName:a=DEFAULT_AUDIO_DEVICE_NAME,multiChannelOrbits:u=!1}=e;if(setMaxPolyphony(o),setMultiChannelOrbits(u),typeof window>"u")return;const l=getAudioContext();if(a!=null&&a!=DEFAULT_AUDIO_DEVICE_NAME)try{const d=(await getAudioDevices()).get(a),g=(d??"").length>0;l.sinkId!==d&&g&&await l.setSinkId(d),logger$1(`[superdough] Audio Device set to ${a}, it might take a few seconds before audio plays on all output channels`)}catch{logger$1("[superdough] failed to set audio interface","warning")}if(await l.resume(),t){logger$1("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await loadWorklets(),logger$1("[superdough] AudioWorklets loaded")}catch(p){console.warn("could not load AudioWorklet effects",p)}logger$1("[superdough] ready")}let audioReady;async function initAudioOnFirstClick(e){return audioReady||(audioReady=new Promise(t=>{document.addEventListener("mousedown",async function o(){document.removeEventListener("mousedown",o),await initAudio(e),t()})})),audioReady}let controller;function getSuperdoughAudioController(){return controller==null&&(controller=new SuperdoughAudioController(getAudioContext())),controller}function connectToDestination(e,t){getSuperdoughAudioController().output.connectToDestination(e,t)}function getPhaser(e,t,o=1,a=.5,u=1e3,l=2e3){const p=getAudioContext(),d=getLfo(p,e,t,{frequency:o,depth:l*2}),g=2;let f=0;const A=[];for(let b=0;b<g;b++){const F=p.createBiquadFilter();F.type="notch",F.gain.value=1,F.frequency.value=u+f,F.Q.value=2-Math.min(Math.max(a*2,0),1.9),d.connect(F.detune),f+=282,b>0&&A[b-1].connect(F),A.push(F)}return{phaser:A[A.length-1],lfo:d}}function getFilterType(e){e=e??0;const t=["12db","ladder","24db"];return typeof e=="number"?t[Math.floor(_mod$1(e,t.length))]:e}let analysers={},analysersData={};function getAnalyserById(e,t=1024,o=.5){if(!analysers[e]){const a=getAudioContext().createAnalyser();a.fftSize=t,a.smoothingTimeConstant=o,analysers[e]=a,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)}return analysers[e].fftSize!==t&&(analysers[e].fftSize=t,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)),analysers[e]}function getAnalyzerData(e="time",t=1){const o={time:()=>analysers[t]?.getFloatTimeDomainData(analysersData[t]),frequency:()=>analysers[t]?.getFloatFrequencyData(analysersData[t])}[e];if(!o)throw new Error(`getAnalyzerData: ${e} not supported. use one of ${Object.keys(o).join(", ")}`);return o(),analysersData[t]}function resetGlobalEffects(){controller?.reset(),analysers={},analysersData={}}let activeSoundSources=new Map;function mapChannelNumbers(e){return(Array.isArray(e)?e:[e]).map(t=>t-1)}const superdough=async(e,t,o,a=.5,u=.5)=>{const l=getAudioContext(),p=getSuperdoughAudioController();let{stretch:d}=e;if(d!=null&&(t=t-.04),typeof e!="object")throw new Error(`expected hap.value to be an object, but got "${e}". Hint: append .note() or .s() to the end`,"error");if(e.duration=o,t<l.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${t.toFixed(2)}, now: ${l.currentTime.toFixed(2)})`);return}let{tremolo:g,tremolosync:f,tremolodepth:A=1,tremoloskew:b,tremolophase:F=0,tremoloshape:S,s:k=getDefaultValue("s"),bank:$,source:R,gain:I=getDefaultValue("gain"),postgain:z=getDefaultValue("postgain"),density:ie=getDefaultValue("density"),duckorbit:U,duckonset:O,duckattack:ee,duckdepth:re,djf:oe,fanchor:_e=getDefaultValue("fanchor"),release:ue=0,phaserrate:Ce,phaserdepth:me=getDefaultValue("phaserdepth"),phasersweep:he,phasercenter:ve,coarse:Fe,crush:Se,dry:Ee,shape:Pe,shapevol:Ye=getDefaultValue("shapevol"),distort:He,distortvol:et=getDefaultValue("distortvol"),distorttype:de=getDefaultValue("distorttype"),pan:Le,vowel:ot,delay:Ve=getDefaultValue("delay"),delayfeedback:Oe=getDefaultValue("delayfeedback"),delaysync:Je=getDefaultValue("delaysync"),delaytime:We,orbit:qe=getDefaultValue("orbit"),room:yt,roomfade:pt,roomlp:Qe,roomdim:At,roomsize:it,ir:vt,irspeed:at,irbegin:Ct,i:Mt=getDefaultValue("i"),velocity:te=getDefaultValue("velocity"),analyze:se,fft:q=getDefaultValue("fft"),compressor:le,compressorRatio:be,compressorKnee:Me,compressorAttack:ye,compressorRelease:$e}=e;We=We??cycleToSeconds(Je,a);const Ae=mapChannelNumbers(multiChannelOrbits&&qe>0?[qe*2-1,qe*2]:getDefaultValue("channels")),De=e.channels!=null?mapChannelNumbers(e.channels):Ae,Ne=p.getOrbit(qe,De);U!=null&&p.duck(U,t,O,ee,re),I=applyGainCurve(nanFallback(I,1)),z=applyGainCurve(z),Ye=applyGainCurve(Ye),et=applyGainCurve(et),Ve=applyGainCurve(Ve),te=applyGainCurve(te),A=applyGainCurve(A),I*=te;const nt=t+o,rt=nt+ue,je=Math.round(Math.random()*1e6);for(let Ge=0;Ge<=activeSoundSources.size-maxPolyphony;Ge++){const Ze=activeSoundSources.entries().next(),Ke=Ze.value[1].deref(),tt=Ze.value[0],mt=t+.25;Ke?.node?.gain?.linearRampToValueAtTime(0,mt),Ke?.stop?.(mt),activeSoundSources.delete(tt)}let Xe=[];if(["-","~","_"].includes(k))return;$&&k&&(k=`${$}_${k}`,e.s=k);let ct;if(R)ct=R(t,e,o,a);else if(getSound(k)){const{onTrigger:Ge}=getSound(k),Ke=await Ge(t,e,()=>{Xe.forEach(tt=>tt?.disconnect()),activeSoundSources.delete(je)},a);Ke&&(ct=Ke.node,activeSoundSources.set(je,new WeakRef(Ke)))}else throw new Error(`sound ${k} not found! Is it loaded?`);if(!ct)return;if(l.currentTime>t){logger$1("[webaudio] skip hap: still loading",l.currentTime-t);return}const Re=[];Re.push(ct),d!==void 0&&Re.push(getWorklet(l,"phase-vocoder-processor",{pitchFactor:d})),Re.push(gainNode(I));const ft=getFilterType(e.ftype);if(e.cutoff!==void 0){const Ze=pickAndRename(e,{frequency:"cutoff",q:"resonance",attack:"lpattack",decay:"lpdecay",sustain:"lpsustain",release:"lprelease",env:"lpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"lprate",sync:"lpsync",depth:"lpdepth",depthfrequency:"lpdepthfrequency",shape:"lpshape",dcoffset:"lpdc",skew:"lpskew"});Ze.type="lowpass";const Ke=()=>createFilter(l,t,nt,Ze,a,u),{filter:tt,lfo:mt}=Ke();if(Re.push(tt),mt&&Xe.push(mt),ft==="24db"){const{filter:bt,lfo:Pt}=Ke();Re.push(bt),Pt&&Xe.push(Pt)}}if(e.hcutoff!==void 0){const Ze=pickAndRename(e,{frequency:"hcutoff",q:"hresonance",attack:"hpattack",decay:"hpdecay",sustain:"hpsustain",release:"hprelease",env:"hpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"hprate",sync:"hpsync",depth:"hpdepth",depthfrequency:"hpdepthfrequency",shape:"hpshape",dcoffset:"hpdc",skew:"hpskew"});Ze.type="highpass";const Ke=()=>createFilter(l,t,nt,Ze,a,u),{filter:tt,lfo:mt}=Ke();if(Re.push(tt),mt&&Xe.push(mt),ft==="24db"){const{filter:bt,lfo:Pt}=Ke();Re.push(bt),Pt&&Xe.push(Pt)}}if(e.bandf!==void 0){const Ze=pickAndRename(e,{frequency:"bandf",q:"bandq",attack:"bpattack",decay:"bpdecay",sustain:"bpsustain",release:"bprelease",env:"bpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"bprate",sync:"bpsync",depth:"bpdepth",depthfrequency:"bpdepthfrequency",shape:"bpshape",dcoffset:"bpdc",skew:"bpskew"});Ze.type="bandpass";const Ke=()=>createFilter(l,t,nt,Ze,a,u),{filter:tt,lfo:mt}=Ke();if(Re.push(tt),mt&&Xe.push(mt),ft==="24db"){const{filter:bt,lfo:Pt}=Ke();Re.push(bt),Pt&&Xe.push(Pt)}}if(ot!==void 0){const Ge=l.createVowelFilter(ot);Re.push(Ge)}if(Fe!==void 0&&Re.push(getWorklet(l,"coarse-processor",{coarse:Fe})),Se!==void 0&&Re.push(getWorklet(l,"crush-processor",{crush:Se})),Pe!==void 0&&Re.push(getWorklet(l,"shape-processor",{shape:Pe,postgain:Ye})),He!==void 0&&Re.push(getDistortion(He,et,de)),f!=null&&(g=a*f),e.wtPosSynced!=null&&(e.wtPosRate/=a),e.wtWarpSynced!=null&&(e.wtWarpRate/=a),g!==void 0){const Ge=Math.max(1-A,0),Ze=new GainNode(l,{gain:Ge}),Ke=u/a,tt=getLfo(l,t,rt,{skew:b??(S!=null?.5:1),frequency:g,depth:A,time:Ke,dcoffset:0,shape:S,phaseoffset:F,min:0,max:1,curve:1.5});tt.connect(Ze.gain),Xe.push(tt),Re.push(Ze)}if(le!==void 0&&Re.push(getCompressor(l,le,be,Me,ye,$e)),Le!==void 0){const Ge=l.createStereoPanner();Ge.pan.value=2*Le-1,Re.push(Ge)}if(Ce!==void 0&&me>0){const{phaser:Ge,lfo:Ze}=getPhaser(t,rt,Ce,me,ve,he);Xe.push(Ze),Re.push(Ge)}const ht=new GainNode(l,{gain:z});if(Re.push(ht),Ve>0&&We>0&&Oe>0){Ne.getDelay(We,Oe,t);const Ge=Ne.sendDelay(ht,Ve);Xe.push(Ge)}if(yt>0){let Ge;if(vt!==void 0){let Ke,tt=getSound(vt);Array.isArray(tt)?Ke=tt.data.samples[Mt%tt.data.samples.length]:typeof tt=="object"&&(Ke=Object.values(tt.data.samples).flat()[Mt%Object.values(tt.data.samples).length]),Ge=await loadBuffer$1(Ke,l,vt,0)}Ne.getReverb(it,pt,Qe,At,Ge,at,Ct);const Ze=Ne.sendReverb(ht,yt);Xe.push(Ze)}if(oe!=null&&Ne.getDjf(oe,t),se){const Ge=getAnalyserById(se,2**(q+5)),Ze=effectSend(ht,Ge,1);Xe.push(Ze)}if(Ee!=null){Ee=applyGainCurve(Ee);const Ge=new GainNode(l,{gain:Ee});Re.push(Ge),Ne.connectToOutput(Ge)}else Ne.connectToOutput(ht);Re.slice(1).reduce((Ge,Ze)=>Ge.connect(Ze),Re[0]),Xe=Xe.concat(Re)},superdoughTrigger=(e,t,o,a)=>{superdough(t,e-o,t.duration/a,a)},waveforms=["triangle","square","sawtooth","sine","user"],waveformAliases=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function makeSaturationCurve(e,t){const o=e,a=new Float32Array(t);for(let u=0;u<t;u++){const l=u*2/t-1;a[u]=Math.tanh(l*o)}return a}function registerSynthSounds(){[...waveforms].forEach(e=>{registerSound(e,(t,o,a)=>{const[u,l,p,d]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]),g=gainNode(.3);let f=getOscillator(e,t,o,()=>{g.disconnect(),a()}),{node:A,stop:b,triggerRelease:F}=f;const{duration:S}=o,k=gainNode(1);let $=A.connect(g).connect(k);const R=t+S;getParamADSR($.gain,u,l,p,d,0,1,t,R,"linear");const I=R+d+.01;return F?.(I),b(I),{node:$,stop:z=>{b(z)}}},{type:"synth",prebake:!0})}),registerSound("sbd",(e,t,o)=>{const{duration:a,decay:u=.5,pdecay:l=.5,penv:p=36,clip:d}=t,g=getAudioContext(),f=.02,A=1.2,b=.025,F=1,S=g.createOscillator();S.type="triangle",S.frequency.value=getFrequencyFromValue(t,29),S.detune.setValueAtTime(p*100,0),S.detune.setValueAtTime(p*100,e),S.detune.exponentialRampToValueAtTime(.001,e+l);const k=gainNode(1);k.gain.setValueAtTime(1,e+f),k.gain.exponentialRampToValueAtTime(.001,e+f+u),S.start(e);const $=getNoiseOscillator("brown",e,2),R=gainNode(1);R.gain.setValueAtTime(A,e),R.gain.exponentialRampToValueAtTime(.001,e+b);const I=new WaveShaperNode(g);I.curve=makeSaturationCurve(2,g.sampleRate);const z=gainNode(F);S.onended=()=>{S.disconnect(),k.disconnect(),I.disconnect(),$.node.disconnect(),R.disconnect(),z.disconnect(),o()};const ie=S.connect(I).connect(k).connect(z);$.node.connect(R).connect(z);let O=e+u+.01;return d!=null&&(O=Math.min(e+d*a,O)),z.gain.setValueAtTime(F,O-.01),z.gain.linearRampToValueAtTime(0,O),S.stop(O),$.stop(O),{node:ie,stop:ee=>{S.stop(ee)}}},{type:"synth",prebake:!0}),registerSound("supersaw",(e,t,o)=>{const a=getAudioContext();let{duration:u,n:l,unison:p=5,spread:d=.6,detune:g}=t;g=g??l??.18;const f=getFrequencyFromValue(t),[A,b,F,S]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),k=e+u,$=k+S+.01,R=clamp(p,1,100);let I=R>1?clamp(d,0,1):0,z=getWorklet(a,"supersaw-oscillator",{frequency:f,begin:e,end:$,freqspread:g,voices:R,panspread:I},{outputChannelCount:[2]});const ie=1/Math.sqrt(R);getPitchEnvelope(z.parameters.get("detune"),t,e,k);const U=getVibratoOscillator(z.parameters.get("detune"),t,e),O=applyFM(z.parameters.get("frequency"),t,e);let ee=gainNode(1);ee=z.connect(ee),getParamADSR(ee.gain,A,b,F,S,0,.3*ie,e,k,"linear");let re=webAudioTimeout(a,()=>{destroyAudioWorkletNode(z),ee.disconnect(),o(),O?.stop(),U?.stop()},e,$);return{node:ee,stop:oe=>{re.stop(oe)}}},{prebake:!0,type:"synth"}),registerSound("bytebeat",(e,t,o)=>{const a=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:u=0}=t,l=getFrequencyFromValue(t),{byteBeatExpression:p=a[u%a.length],byteBeatStartTime:d}=t,g=getAudioContext();let{duration:f}=t;const[A,b,F,S]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),k=e+f,$=k+S+.01;let R=getWorklet(g,"byte-beat-processor",{frequency:l,begin:e,end:$},{outputChannelCount:[2]});R.port.postMessage({codeText:p,byteBeatStartTime:d,frequency:l});let I=gainNode(1);I=R.connect(I),getParamADSR(I.gain,A,b,F,S,0,1,e,k,"linear");let z=webAudioTimeout(g,()=>{destroyAudioWorkletNode(R),I.disconnect(),o()},e,$);return{node:I,stop:ie=>{z.stop(ie)}}},{prebake:!0,type:"synth"}),registerSound("pulse",(e,t,o)=>{const a=getAudioContext();let{pwrate:u,pwsweep:l}=t;l==null&&(u!=null?l=.3:l=0),u==null&&l!=null&&(u=1);let{duration:p,pw:d=.5}=t;const g=getFrequencyFromValue(t),[f,A,b,F]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),S=e+p,k=S+F+.01;let $=getWorklet(a,"pulse-oscillator",{frequency:g,begin:e,end:k,pulsewidth:d},{outputChannelCount:[2]});getPitchEnvelope($.parameters.get("detune"),t,e,S);const R=getVibratoOscillator($.parameters.get("detune"),t,e),I=applyFM($.parameters.get("frequency"),t,e);let z=gainNode(1);z=$.connect(z),getParamADSR(z.gain,f,A,b,F,0,1,e,S,"linear");let ie;l!=0&&(ie=getLfo(a,e,k,{frequency:u,depth:l}),ie.connect($.parameters.get("pulsewidth")));let U=webAudioTimeout(a,()=>{destroyAudioWorkletNode($),destroyAudioWorkletNode(ie),z.disconnect(),o(),I?.stop(),R?.stop()},e,k);return{node:z,stop:O=>{U.stop(O)}}},{prebake:!0,type:"synth"}),[...noises].forEach(e=>{registerSound(e,(t,o,a)=>{const[u,l,p,d]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]);let g,{density:f}=o;g=getNoiseOscillator(e,t,f);let{node:A,stop:b,triggerRelease:F}=g;const S=gainNode(.3),{duration:k}=o;A.onended=()=>{A.disconnect(),S.disconnect(),a()};const $=gainNode(1);let R=A.connect(S).connect($);const I=t+k;getParamADSR(R.gain,u,l,p,d,0,1,t,I,"linear");const z=I+d+.01;return F?.(z),b(z),{node:R,stop:ie=>{b(ie)}}},{type:"synth",prebake:!0})}),waveformAliases.forEach(([e,t])=>soundMap$1.set({...soundMap$1.get(),[e]:soundMap$1.get()[t]}))}const PI2=2*Math.PI;function waveformN(e,t,o){e=typeof e=="object"?e:new Float32Array(e).fill(1);const u=e.length,l=new Float32Array(u+1),p=new Float32Array(u+1),d=getAudioContext(),g=d.createOscillator(),f={sawtooth:b=>[0,-1/b],square:b=>[0,b%2===0?0:1/b],triangle:b=>[b%2===0?0:1/(b*b),0],user:b=>[0,1]};if(!f[o])throw new Error(`unknown wave type ${o}`);for(let b=0;b<u;b++){const F=e[b],[S,k]=f[o](b+1),$=t?.[b]??0;let R=S*F,I=k*F;if($!==0){const z=Math.cos(PI2*$),ie=Math.sin(PI2*$);R=z*R-ie*I,I=ie*R+z*I}l[b+1]=R,p[b+1]=I}const A=d.createPeriodicWave(l,p);return g.setPeriodicWave(A),g}function getOscillator(e,t,o,a){const{duration:u,noise:l=0}=o,p=o.partials??o.n;let d;e==="user"&&!p&&(logger$1("[superdough] Synth 'user' was selected, but partials not specified. Defaulting to triangle. Use pat.partials to setup custom waveform"),e="triangle"),e=e==="user"&&!p?"triangle":e,!p||p?.length===0||e==="sine"?(d=getAudioContext().createOscillator(),d.type=e||"triangle"):d=waveformN(p,o.phases,e),d.frequency.value=getFrequencyFromValue(o);let g=getVibratoOscillator(d.detune,o,t);getPitchEnvelope(d.detune,o,t,t+u);const f=applyFM(d.frequency,o,t);let A;return l&&(A=getNoiseMix(d,l,t)),d.onended=()=>{A||d.disconnect(),A?.node.disconnect(),a()},d.start(t),{node:A?.node||d,stop:b=>{f.stop(b),g?.stop(b),A?.stop(b),d.stop(b)},triggerRelease:b=>{}}}function buildSamples(e=1,t=.05,o=220,a=0,u=0,l=.1,p=0,d=1,g=0,f=0,A=0,b=0,F=0,S=0,k=0,$=0,R=0,I=1,z=0,ie=0){let U=Math.PI*2,O=getAudioContext().sampleRate,ee=Ye=>Ye>0?1:-1,re=g*=500*U/O/O,oe=o*=(1+t*2*Math.random()-t)*U/O,_e=[],ue=0,Ce=0,me=0,he=1,ve=0,Fe=0,Se=0,Ee,Pe;for(a=a*O+9,z*=O,u*=O,l*=O,R*=O,f*=500*U/O**3,k*=U/O,A*=U/O,b*=O,F=F*O|0,Pe=a+z+u+l+R|0;me<Pe;_e[me++]=Se)++Fe%($*100|0)||(Se=p?p>1?p>2?p>3?Math.sin((ue%U)**3):Math.max(Math.min(Math.tan(ue),1),-1):1-(2*ue/U%2+2)%2:1-4*Math.abs(Math.round(ue/U)-ue/U):Math.sin(ue),Se=(F?1-ie+ie*Math.sin(U*me/F):1)*ee(Se)*Math.abs(Se)**d*e*1*(me<a?me/a:me<a+z?1-(me-a)/z*(1-I):me<a+z+u?I:me<Pe-R?(Pe-me-R)/l*I:0),Se=R?Se/2+(R>me?0:(me<Pe-R?1:(Pe-me)/R)*_e[me-R|0]/2):Se),Ee=(o+=g+=f)*Math.cos(k*Ce++),ue+=Ee-Ee*S*(1-(Math.sin(me)+1)*1e9%2),he&&++he>b&&(o+=A,oe+=A,he=0),F&&!(++ve%F)&&(o=oe,g=re,he||=1);return _e}const getZZFX=(e,t)=>{let{s:o,note:a=36,freq:u,zrand:l=0,attack:p=0,decay:d=0,sustain:g=.8,release:f=.1,curve:A=1,slide:b=0,deltaSlide:F=0,pitchJump:S=0,pitchJumpTime:k=0,lfo:$=0,znoise:R=0,zmod:I=0,zcrush:z=0,zdelay:ie=0,tremolo:U=0,duration:O=.2,zzfx:ee}=e;const re=Math.max(O-p-d,0);typeof a=="string"&&(a=noteToMidi(a)),!u&&typeof a=="number"&&(u=midiToFreq$1(a)),o=o.replace("z_","");const oe=["sine","triangle","sawtooth","tan","noise"].indexOf(o)||0;A=o==="square"?0:A;const ue=buildSamples(...ee||[.25,l,u,p,re,f,oe,A,b,F,S,k,$,R,I,z,ie,g,d,U]),Ce=getAudioContext(),me=Ce.createBuffer(1,ue.length,Ce.sampleRate);me.getChannelData(0).set(ue);const he=getAudioContext().createBufferSource();return he.buffer=me,he.start(t),{node:he}};function registerZZFXSounds(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(e=>{registerSound(e,(t,o,a)=>{const{node:u}=getZZFX({s:e,...o},t);return u.onended=()=>{u.disconnect(),a()},{node:u,stop:()=>{}}},{type:"synth",prebake:!0})})}let worklet;async function dspWorklet(e,t){const o=`dsp-worklet-${Date.now()}`,a=`${t}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${o}', MyProcessor);
`,l=`data:text/javascript;base64,${btoa(a)}`;await e.audioWorklet.addModule(l);const p=new AudioWorkletNode(e,o);return{node:p,stop:()=>p.port.postMessage("stop")}}const stop=()=>{worklet&&(worklet?.stop(),worklet?.node?.disconnect())};typeof window<"u"&&window.addEventListener("message",e=>{e.data==="strudel-stop"?stop():e.data?.dough&&worklet?.node.port.postMessage(e.data)});const dough=async e=>{const t=getAudioContext();stop(),worklet=await dspWorklet(t,e),worklet.node.connect(t.destination)};function doughTrigger(e,t,o,a){window.postMessage({time:a,dough:e.value,currentTime:t,duration:e.duration,cps:o})}const Warpmode=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),seenKeys=new Set;async function getPayload(e,t,o=2048){const a=`${e},${o}`;if(!seenKeys.has(a)){const l=(await loadBuffer(e,t)).getChannelData(0),p=l.length,d=Math.max(1,Math.floor(p/o)),g=new Array(d);for(let f=0;f<d;f++){const A=f*o;g[f]=l.subarray(A,A+o)}return seenKeys.add(a),{frames:g,frameLen:o,numFrames:d,key:a}}return{frameLen:o,key:a}}function humanFileSize(e,t){var o=1024;if(e<o)return e+" B";var a=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do e/=o,++u;while(e>=o);return e.toFixed(1)+" "+a[u]}function parseWavSampleRate(e){const t=new DataView(e);let o=12;for(;o+8<=t.byteLength;){const a=String.fromCharCode(t.getUint8(o),t.getUint8(o+1),t.getUint8(o+2),t.getUint8(o+3)),u=t.getUint32(o+4,!0);if(a==="fmt ")return t.getUint32(o+12,!0);o+=8+u+(u&1)}return null}async function decodeAtNativeRate(e){const t=parseWavSampleRate(e)||44100;return await new OfflineAudioContext(1,1,t).decodeAudioData(e)}const loadCache$1={},loadBuffer=(e,t)=>{if(e=e.replace("#","%23"),!loadCache$1[e]){logger$1(`[wavetable] load table ${t}..`,"load-table",{url:e});const o=Date.now();loadCache$1[e]=fetch(e).then(a=>a.arrayBuffer()).then(async a=>{const u=Date.now()-o,l=humanFileSize(a.byteLength);return logger$1(`[wavetable] load table ${t}... done! loaded ${l} in ${u}ms`,"loaded-table",{url:e}),await decodeAtNativeRate(a)})}return loadCache$1[e]};function githubPath$1(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,a]=e.split("github:");return a=a.endsWith("/")?a.slice(0,-1):a,a.split("/").length===2&&(a+="/main"),`https://raw.githubusercontent.com/${a}/${t}`}const _processTables=(e,t,o,a={})=>(t=e._base||t,Object.entries(e).forEach(([u,l])=>{if(u==="_base")return!1;if(typeof l=="string"&&(l=[l]),typeof l!="object")throw new Error("wrong json format for "+u);let p=t;p.startsWith("github:")&&(p=githubPath$1(p,"")),l=l.map(d=>p+d).filter(d=>d.toLowerCase().endsWith(".wav")?!0:(logger$1(`[wavetable] skipping ${d} -- wavetables must be ".wav" format`),!1)),l.length&&registerWaveTable(u,l,{baseUrl:t,frameLen:o})}));function registerWaveTable(e,t,o){registerSound(e,(a,u,l,p)=>onTriggerSynth(a,u,l,t,p,o?.frameLen??2048),{type:"wavetable",tables:t,...o})}const tables=async(e,t,o,a={})=>{if(o!==void 0)return _processTables(o,e,t);e.startsWith("github:")&&(e=githubPath$1(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432");const u=getBaseURL(e);if(typeof fetch=="function"&&!(typeof fetch>"u"))return fetch(e).then(l=>l.json()).then(l=>_processTables(l,u,t,a)).catch(l=>{throw console.error(l),new Error(`error loading "${e}"`)})};async function onTriggerSynth(e,t,o,a,u,l){const{s:p,n:d=0,duration:g,clip:f}=t,A=getAudioContext(),[b,F,S,k]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);let{warpmode:$}=t;typeof $=="string"&&($=Warpmode[$.toUpperCase()]??Warpmode.NONE);const R=getFrequencyFromValue(t),{url:I,label:z}=getCommonSampleInfo(t,a),ie=await getPayload(I,z,l);let U=e+g;f!==void 0&&(U=Math.min(e+f*g,U));const O=U+k,ee=O+.01,re=getWorklet(A,"wavetable-oscillator-processor",{begin:e,end:ee,frequency:R,freqspread:t.detune,position:t.wt,warp:t.warp,warpMode:$,voices:Math.max(t.unison??1,1),panspread:t.spread,phaserand:t.wtphaserand??t.unison>1?1:0},{outputChannelCount:[2]});if(re.port.postMessage({type:"table",payload:ie}),A.currentTime>e){logger$1(`[wavetable] still loading sound "${p}:${d}"`,"highlight");return}const oe=[t.wtattack,t.wtdecay,t.wtsustain,t.wtrelease],_e=[t.warpattack,t.warpdecay,t.warpsustain,t.warprelease],ue=re.parameters,Ce=ue.get("position"),me=ue.get("warp");let he=t.wtrate;t.wtsync!=null&&(he=u*t.wtsync);const ve=applyParameterModulators(A,Ce,e,O,{offset:t.wt,amount:t.wtenv,defaultAmount:.5,values:oe,holdEnd:U,defaultValues:[0,.5,0,.1]},{frequency:he,depth:t.wtdepth,defaultDepth:.5,shape:t.wtshape,skew:t.wtskew,dcoffset:t.wtdc??0});let Fe=t.warprate;t.warpsync!=null&&(Fe=Fe=u*t.warpsync);const Se=applyParameterModulators(A,me,e,O,{offset:t.warp,amount:t.warpenv,defaultAmount:.5,values:_e,holdEnd:U,defaultValues:[0,.5,0,.1]},{frequency:Fe,depth:t.warpdepth,defaultDepth:.5,shape:t.warpshape,skew:t.warpskew,dcoffset:t.warpdc??0}),Ee=getVibratoOscillator(re.parameters.get("detune"),t,e),Pe=applyFM(re.parameters.get("frequency"),t,e),Ye=A.createGain(),He=re.connect(Ye);getParamADSR(He.gain,b,F,S,k,0,.3,e,U,"linear"),getPitchEnvelope(re.parameters.get("detune"),t,e,U);const et={node:He,source:re},de=webAudioTimeout(A,()=>{destroyAudioWorkletNode(re),Ee?.stop(),Pe?.stop(),He.disconnect(),ve?.disconnect(),Se?.disconnect(),o()},e,ee);return et.stop=Le=>{de.stop(Le)},et}let doughWorklet;function initDoughWorklet(){const e=getAudioContext();doughWorklet=getWorklet(e,"dough-processor",{},{outputChannelCount:[2]}),connectToDestination(doughWorklet)}const soundMap=new Map,loadedSounds=new Map;Pattern$1.prototype.supradough=function(){return this.onTrigger((e,t,o,a)=>{e.value._begin=a,e.value._duration=e.duration/o,!doughWorklet&&initDoughWorklet();const u=(e.value.bank?e.value.bank+"_":"")+e.value.s,l=e.value.n??0,p=`${u}:${l}`;if(soundMap.has(u)&&(e.value.s=p),soundMap.has(u)&&!loadedSounds.has(p)){const d=soundMap.get(u),g=d[l%d.length];console.log(`load ${p} from ${g}`);const f=fetchSample(g);loadedSounds.set(p,f),f.then(({channels:A,sampleRate:b})=>doughWorklet.port.postMessage({sample:p,channels:A,sampleRate:b}))}doughWorklet.port.postMessage({spawn:e.value})},1)};function githubPath(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,a]=e.split("github:");return a=a.endsWith("/")?a.slice(0,-1):a,a.split("/").length===2&&(a+="/main"),`https://raw.githubusercontent.com/${a}/${t}`}async function fetchSampleMap(e){if(e.startsWith("github:")&&(e=githubPath(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[a,u]=e.split("shabda:");e=`https://shabda.ndre.gr/${u}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[a,u]=e.split("shabda/speech");u=u.startsWith("/")?u.substring(1):u;let[l,p]=u.split(":"),d="f",g="en-GB";l&&([g,d]=l.split("/")),e=`https://shabda.ndre.gr/speech/${p}.json?gender=${d}&language=${g}&strudel=1'`}if(typeof fetch!="function")return;const t=e.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const o=await fetch(e).then(a=>a.json()).catch(a=>{throw console.error(a),new Error(`error loading "${e}"`)});return[o,o._base||t]}async function fetchSample(e){const t=await fetch(e).then(a=>a.arrayBuffer()).then(a=>getAudioContext().decodeAudioData(a));let o=[];for(let a=0;a<t.numberOfChannels;a++)o.push(t.getChannelData(a));return{channels:o,sampleRate:t.sampleRate}}async function doughsamples(e,t){if(typeof e=="string"){const[o,a]=await fetchSampleMap(e);return doughsamples(o,a)}Object.entries(e).map(async([o,a])=>{o!=="_base"&&(a=a.map(u=>t+u),soundMap.set(o,a))})}const _workletUrl="data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IGQ9dHlwZW9mIHNhbXBsZVJhdGU8InUiP3NhbXBsZVJhdGU6NDhlMyxBPU1hdGguUEkvZCxiPTEvZDtsZXQgRT1pPT5NYXRoLnBvdyhpLDIpO2NvbnN0IFY9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtmdW5jdGlvbiBjKGkpe3JldHVybiBFKGkpfWZ1bmN0aW9uIE8oaSxzLHQpe2NvbnN0IGU9TWF0aC5zaW4oKDEtdCkqLjUqTWF0aC5QSSksaD1NYXRoLnNpbih0Ki41Kk1hdGguUEkpO3JldHVybiBpKmUrcypofWNsYXNzIHZ7cGhhc2U9MDt1cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNpbih0aGlzLnBoYXNlKjIqTWF0aC5QSSk7cmV0dXJuIHRoaXMucGhhc2U9KHRoaXMucGhhc2Urcy9kKSUxLHR9fWNsYXNzIHh7cGhhc2U9MDt1cGRhdGUocyl7cmV0dXJuIHRoaXMucGhhc2UrPWIqcyx0aGlzLnBoYXNlJTEqMi0xfX1mdW5jdGlvbiB5KGkscyl7cmV0dXJuIGk8cz8oaS89cyxpK2ktaSppLTEpOmk+MS1zPyhpPShpLTEpL3MsaSppK2kraSsxKTowfWNsYXNzIFJ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy5waGFzZT1zLnBoYXNlPz8wfXVwZGF0ZShzKXtjb25zdCB0PXMvZDtsZXQgZT15KHRoaXMucGhhc2UsdCksaD0yKnRoaXMucGhhc2UtMS1lO3JldHVybiB0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2UtPTEpLGh9fWZ1bmN0aW9uIFQoaSxzLHQpe3JldHVybiBpPDI/MDooKGgsbyxuKT0+biooby1oKStoKSgtcyouNSxzKi41LHQvKGktMSkpfWZ1bmN0aW9uIHooaSxzKXtyZXR1cm4gaSpNYXRoLnBvdygyLHMvMTIpfWNsYXNzIEZ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy52b2ljZXM9cy52b2ljZXM/PzUsdGhpcy5mcmVxc3ByZWFkPXMuZnJlcXNwcmVhZD8/LjIsdGhpcy5wYW5zcHJlYWQ9cy5wYW5zcHJlYWQ/Py40LHRoaXMucGhhc2U9bmV3IEZsb2F0MzJBcnJheSh0aGlzLnZvaWNlcykubWFwKCgpPT5NYXRoLnJhbmRvbSgpKX11cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNxcnQoMS10aGlzLnBhbnNwcmVhZCksZT1NYXRoLnNxcnQodGhpcy5wYW5zcHJlYWQpO2xldCBoPTAsbz0wO2ZvcihsZXQgbj0wO248dGhpcy52b2ljZXM7bisrKXtjb25zdCBhPXoocyxUKHRoaXMudm9pY2VzLHRoaXMuZnJlcXNwcmVhZCxuKSkvZCxwPShuJjEpPT0xO2xldCB1PXQ7cCYmKHU9ZSk7bGV0IHE9eSh0aGlzLnBoYXNlW25dLGEpLEQ9Mip0aGlzLnBoYXNlW25dLTEtcTtoPWgrRCp1LG89bytEKnUsdGhpcy5waGFzZVtuXSs9YSx0aGlzLnBoYXNlW25dPjEmJih0aGlzLnBoYXNlW25dLT0xKX1yZXR1cm4gaCtvfX1jbGFzcyB3e3BoYXNlPTA7dXBkYXRlKHMpe3RoaXMucGhhc2UrPWIqcztsZXQgdD10aGlzLnBoYXNlJTE7cmV0dXJuKHQ8LjU/Mip0OjEtMioodC0uNSkpKjItMX19Y2xhc3MgZ3tzMD0wO3MxPTA7dXBkYXRlKHMsdCxlPTApe2U9TWF0aC5tYXgoZSwwKSx0PU1hdGgubWluKHQsMmU0KTtsZXQgaD0yKk1hdGguc2luKHQqQSk7aD1WKGgsMCwxLjE0KTtjb25zdCBuPTEtTWF0aC5wb3coLjUsKGUrLjEyNSkvLjEyNSkqaDtyZXR1cm4gdGhpcy5zMD1uKnRoaXMuczAtaCp0aGlzLnMxK2gqcyx0aGlzLnMxPW4qdGhpcy5zMStoKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgSXtjb25zdHJ1Y3RvcihzPTApe3RoaXMucGhhc2U9c31zYXcocyx0KXtsZXQgZT0odGhpcy5waGFzZStzKSUxLGg9eShlLHQpO3JldHVybiAyKmUtMS1ofXVwZGF0ZShzLHQ9LjUpe2NvbnN0IGU9cy9kO2xldCBoPXRoaXMuc2F3KDAsZSktdGhpcy5zYXcodCxlKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStlKSUxLGgrdCoyLTF9fWNsYXNzIEx7cGhhc2U9MDt1cGRhdGUocyx0PS41KXtyZXR1cm4gdGhpcy5waGFzZSs9YipzLHRoaXMucGhhc2UlMTx0PzE6LTF9fWNsYXNzIFN7dXBkYXRlPXM9Pk1hdGgucmFuZG9tKCk8cypiP01hdGgucmFuZG9tKCk6MH1jbGFzcyBOe3VwZGF0ZSgpe3JldHVybiBNYXRoLnJhbmRvbSgpKjItMX19Y2xhc3MgQntjb25zdHJ1Y3Rvcigpe3RoaXMub3V0PTB9dXBkYXRlKCl7bGV0IHM9TWF0aC5yYW5kb20oKSoyLTE7cmV0dXJuIHRoaXMub3V0PSh0aGlzLm91dCsuMDIqcykvMS4wMix0aGlzLm91dH19Y2xhc3MgR3tjb25zdHJ1Y3Rvcigpe3RoaXMuYjA9MCx0aGlzLmIxPTAsdGhpcy5iMj0wLHRoaXMuYjM9MCx0aGlzLmI0PTAsdGhpcy5iNT0wLHRoaXMuYjY9MH11cGRhdGUoKXtjb25zdCBzPU1hdGgucmFuZG9tKCkqMi0xO3RoaXMuYjA9Ljk5ODg2KnRoaXMuYjArcyouMDU1NTE3OSx0aGlzLmIxPS45OTMzMip0aGlzLmIxK3MqLjA3NTA3NTksdGhpcy5iMj0uOTY5KnRoaXMuYjIrcyouMTUzODUyLHRoaXMuYjM9Ljg2NjUqdGhpcy5iMytzKi4zMTA0ODU2LHRoaXMuYjQ9LjU1KnRoaXMuYjQrcyouNTMyOTUyMix0aGlzLmI1PS0uNzYxNip0aGlzLmI1LXMqLjAxNjg5ODtjb25zdCB0PXRoaXMuYjArdGhpcy5iMSt0aGlzLmIyK3RoaXMuYjMrdGhpcy5iNCt0aGlzLmI1K3RoaXMuYjYrcyouNTM2MjtyZXR1cm4gdGhpcy5iNj1zKi4xMTU5MjYsdCouMTF9fWNsYXNzIGp7cGhhc2U9MTt1cGRhdGUocyl7dGhpcy5waGFzZSs9YipzO2xldCB0PXRoaXMucGhhc2U+PTE/MTowO3JldHVybiB0aGlzLnBoYXNlPXRoaXMucGhhc2UlMSx0fX1mdW5jdGlvbiBNKGkscyx0LGU9MSl7aWYoaTw9MClyZXR1cm4gcztpZihpPj0xKXJldHVybiB0O2xldCBoO3JldHVybiBlPT09MD9oPWk6ZT4wP2g9TWF0aC5wb3coaSxlKTpoPTEtTWF0aC5wb3coMS1pLC1lKSxzKyh0LXMpKmh9Y2xhc3MgZntjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnN0YXRlPSJvZmYiLHRoaXMuc3RhcnRUaW1lPTAsdGhpcy5zdGFydFZhbD0wLHRoaXMuZGVjYXlDdXJ2ZT1zLmRlY2F5Q3VydmU/PzF9dXBkYXRlKHMsdCxlLGgsbyxuKXtzd2l0Y2godGhpcy5zdGF0ZSl7Y2FzZSJvZmYiOnJldHVybiB0PjAmJih0aGlzLnN0YXRlPSJhdHRhY2siLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD0wKSwwO2Nhc2UiYXR0YWNrIjp7bGV0IGw9cy10aGlzLnN0YXJ0VGltZTtyZXR1cm4gbD5lPyh0aGlzLnN0YXRlPSJkZWNheSIsdGhpcy5zdGFydFRpbWU9cywxKTpNKGwvZSx0aGlzLnN0YXJ0VmFsLDEsMSl9Y2FzZSJkZWNheSI6e2xldCBsPXMtdGhpcy5zdGFydFRpbWUsYT1NKGwvaCwxLG8sLXRoaXMuZGVjYXlDdXJ2ZSk7cmV0dXJuIHQ8PTA/KHRoaXMuc3RhdGU9InJlbGVhc2UiLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD1hLGEpOmw+aD8odGhpcy5zdGF0ZT0ic3VzdGFpbiIsdGhpcy5zdGFydFRpbWU9cyxvKTphfWNhc2Uic3VzdGFpbiI6cmV0dXJuIHQ8PTAmJih0aGlzLnN0YXRlPSJyZWxlYXNlIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9byksbztjYXNlInJlbGVhc2UiOntsZXQgbD1zLXRoaXMuc3RhcnRUaW1lO2lmKGw+bilyZXR1cm4gdGhpcy5zdGF0ZT0ib2ZmIiwwO2xldCBhPU0obC9uLHRoaXMuc3RhcnRWYWwsMCwtdGhpcy5kZWNheUN1cnZlKTtyZXR1cm4gdD4wJiYodGhpcy5zdGF0ZT0iYXR0YWNrIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9YSksYX19dGhyb3ciaW52YWxpZCBlbnZlbG9wZSBzdGF0ZSJ9fWNvbnN0ICQ9MTA7Y2xhc3Mga3t3cml0ZUlkeD0wO3JlYWRJZHg9MDtidWZmZXI9bmV3IEZsb2F0MzJBcnJheSgkKmQpO3dyaXRlKHMsdCl7dGhpcy53cml0ZUlkeD0odGhpcy53cml0ZUlkeCsxKSV0aGlzLmJ1ZmZlci5sZW5ndGgsdGhpcy5idWZmZXJbdGhpcy53cml0ZUlkeF09cztsZXQgZT1NYXRoLm1pbihNYXRoLmZsb29yKGQqdCksdGhpcy5idWZmZXIubGVuZ3RoLTEpO3RoaXMucmVhZElkeD10aGlzLndyaXRlSWR4LWUsdGhpcy5yZWFkSWR4PDAmJih0aGlzLnJlYWRJZHgrPXRoaXMuYnVmZmVyLmxlbmd0aCl9dXBkYXRlKHMsdCl7cmV0dXJuIHRoaXMud3JpdGUocyx0KSx0aGlzLmJ1ZmZlclt0aGlzLnJlYWRJZHhdfX1jbGFzcyBXe2RlbGF5PW5ldyBrO21vZHVsYXRvcj1uZXcgdzt1cGRhdGUocyx0LGUsaCxvKXtjb25zdCBuPXRoaXMubW9kdWxhdG9yLnVwZGF0ZShoKSpvLGw9dGhpcy5kZWxheS51cGRhdGUocyxlKigxK24pKTtyZXR1cm4gTyhzLGwsdCl9fWNsYXNzIFh7aG9sZD0wO3Q9MDt1cGRhdGUocyx0KXtyZXR1cm4gdGhpcy50KysldD09PTAmJih0aGlzLnQ9MCx0aGlzLmhvbGQ9cyksdGhpcy5ob2xkfX1jbGFzcyBVe3VwZGF0ZShzLHQpe3Q9TWF0aC5tYXgoMSx0KTtjb25zdCBlPU1hdGgucG93KDIsdC0xKTtyZXR1cm4gTWF0aC5yb3VuZChzKmUpL2V9fWNsYXNzIFl7dXBkYXRlKHMsdD0wLGU9MSl7ZT1NYXRoLm1heCguMDAxLE1hdGgubWluKDEsZSkpO2NvbnN0IGg9TWF0aC5leHBtMSh0KTtyZXR1cm4oMStoKSpzLygxK2gqTWF0aC5hYnMocykpKmV9fWNsYXNzIF97c3RhdGljIHNhbXBsZXM9bmV3IE1hcDtidWZmZXI7c2FtcGxlUmF0ZTtwb3M9MDtzYW1wbGVGcmVxPVAoKTtjb25zdHJ1Y3RvcihzLHQsZSl7dGhpcy5idWZmZXI9cyx0aGlzLnNhbXBsZVJhdGU9dCx0aGlzLmR1cmF0aW9uPXRoaXMuYnVmZmVyLmxlbmd0aC90aGlzLnNhbXBsZVJhdGUsdGhpcy5zcGVlZD1kL3RoaXMuc2FtcGxlUmF0ZSxlJiYodGhpcy5zcGVlZCo9dGhpcy5kdXJhdGlvbil9dXBkYXRlKHMpe2lmKHRoaXMucG9zPj10aGlzLmJ1ZmZlci5sZW5ndGgpcmV0dXJuIDA7Y29uc3QgdD1zL3RoaXMuc2FtcGxlRnJlcSp0aGlzLnNwZWVkO2xldCBlPXRoaXMuYnVmZmVyW01hdGguZmxvb3IodGhpcy5wb3MpXTtyZXR1cm4gdGhpcy5wb3M9dGhpcy5wb3MrdCxlfX1jb25zdCBtPShpLHM9ImxpbmVhciIsdCk9Pntjb25zdFtuLGwsYSxwXT1pO2lmKG49PW51bGwmJmw9PW51bGwmJmE9PW51bGwmJnA9PW51bGwpcmV0dXJuIHQ/P1suMDAxLC4wMDEsMSwuMDFdO2NvbnN0IHU9YT8/KG4hPW51bGwmJmw9PW51bGx8fG49PW51bGwmJmw9PW51bGw/MTouMDAxKTtyZXR1cm5bTWF0aC5tYXgobj8/MCwuMDAxKSxNYXRoLm1heChsPz8wLC4wMDEpLE1hdGgubWluKHUsMSksTWF0aC5tYXgocD8/MCwuMDEpXX07bGV0IEM9e3NpbmU6dixzYXc6Uix6YXc6eCxzYXd0b290aDpSLHphd3Rvb3RoOngsc3VwZXJzYXc6Rix0cmk6dyx0cmlhbmdsZTp3LHB1bHNlOkksc3F1YXJlOkkscHVsemU6TCxkdXN0OlMsY3JhY2tsZTpTLGltcHVsc2U6aix3aGl0ZTpOLGJyb3duOkIscGluazpHfTtjb25zdCBaPXtjaG9ydXM6MCxub3RlOjQ4LHM6InRyaWFuZ2xlIixiYW5rOiIiLGdhaW46MSxwb3N0Z2FpbjoxLHZlbG9jaXR5OjEsZGVuc2l0eToiLjAzIixmdHlwZToiMTJkYiIsZmFuY2hvcjowLHJlc29uYW5jZTowLGhyZXNvbmFuY2U6MCxiYW5kcTowLGNoYW5uZWxzOlsxLDJdLHBoYXNlcmRlcHRoOi43NSxzaGFwZXZvbDoxLGRpc3RvcnR2b2w6MSxkZWxheTowLGJ5dGVCZWF0RXhwcmVzc2lvbjoiMCIsZGVsYXlmZWVkYmFjazouNSxkZWxheXNwZWVkOjEsZGVsYXl0aW1lOi4yNSxvcmJpdDoxLGk6MSxmZnQ6OCx6OiJ0cmlhbmdsZSIscGFuOi41LGZtaDoxLGZtZW52OjAsc3BlZWQ6MSxwdzouNX07bGV0IHI9aT0+WltpXTtjb25zdCBIPXtjOjAsZDoyLGU6NCxmOjUsZzo3LGE6OSxiOjExfSxKPXsiIyI6MSxiOi0xLHM6MSxmOi0xfSxLPShpLHM9Myk9PntsZXRbdCxlPSIiLGg9IiJdPVN0cmluZyhpKS5tYXRjaCgvXihbYS1nQS1HXSkoWyNic2ZdKikoWzAtOV0qKSQvKT8uc2xpY2UoMSl8fFtdO2lmKCF0KXRocm93IG5ldyBFcnJvcignbm90IGEgbm90ZTogIicraSsnIicpO2NvbnN0IG89SFt0LnRvTG93ZXJDYXNlKCldLG49ZT8uc3BsaXQoIiIpLnJlZHVjZSgoYSxwKT0+YStKW3BdLDApfHwwO3JldHVybihOdW1iZXIoaHx8cykrMSkqMTIrbytufSxRPWk9Pk1hdGgucG93KDIsKGktNjkpLzEyKSo0NDAsUD1pPT4oaT1pfHxyKCJub3RlIiksdHlwZW9mIGk9PSJzdHJpbmciJiYoaT1LKGksMykpLFEoaSkpO2NsYXNzIHR0e2lkPTA7b3V0PVswLDBdO2F0dGFjaztkZWNheTtzdXN0YWluO3JlbGVhc2U7X2JlZ2luO19kdXJhdGlvbjtfc291bmQ7X2NoYW5uZWxzPTE7X2J1ZmZlcnM7dW5pdDtfcGVudjtwZW52O3BhdHRhY2s7cGRlY2F5O3BzdXN0YWluO3ByZWxlYXNlO3ZpYjtfdmliO3ZpYm1vZDtfZm07Zm1oO2ZtaTtfZm1lbnY7Zm1hdHRhY2s7Zm1kZWNheTtmbXN1c3RhaW47Zm1yZWxlYXNlO19scGVudjtscGVudjtscGF0dGFjaztscGRlY2F5O2xwc3VzdGFpbjtscHJlbGVhc2U7X2hwZW52O2hwZW52O2hwYXR0YWNrO2hwZGVjYXk7aHBzdXN0YWluO2hwcmVsZWFzZTtfYnBlbnY7YnBlbnY7YnBhdHRhY2s7YnBkZWNheTticHN1c3RhaW47YnByZWxlYXNlO2N1dG9mZjtoY3V0b2ZmO2JhbmRmO2NvYXJzZTtjcnVzaDtkaXN0b3J0O2ZyZXE7bm90ZTtfbHBmO19ocGY7X2JwZjtfY2hvcnVzO19jb2Fyc2U7X2NydXNoO19kaXN0b3J0O2NvbnN0cnVjdG9yKHMpe3RoaXMuZnJlcT8/PVAocy5ub3RlKSx0aGlzLl9iZWdpbj1zLl9iZWdpbix0aGlzLl9kdXJhdGlvbj1zLl9kdXJhdGlvbix0aGlzLnJlbGVhc2U9cy5yZWxlYXNlPz8wO2xldCB0PXRoaXM7aWYoT2JqZWN0LmFzc2lnbih0LHMpLHQucz10LnM/P3IoInMiKSx0LmdhaW49Yyh0LmdhaW4/P3IoImdhaW4iKSksdC52ZWxvY2l0eT1jKHQudmVsb2NpdHk/P3IoInZlbG9jaXR5IikpLHQucG9zdGdhaW49Yyh0LnBvc3RnYWluPz9yKCJwb3N0Z2FpbiIpKSx0LmRlbnNpdHk9dC5kZW5zaXR5Pz9yKCJkZW5zaXR5IiksdC5mYW5jaG9yPXQuZmFuY2hvcj8/cigiZmFuY2hvciIpLHQuZHJpdmU9dC5kcml2ZT8/LjY5LHQucGhhc2VyZGVwdGg9dC5waGFzZXJkZXB0aD8/cigicGhhc2VyZGVwdGgiKSx0LnNoYXBldm9sPWModC5zaGFwZXZvbD8/cigic2hhcGV2b2wiKSksdC5kaXN0b3J0dm9sPWModC5kaXN0b3J0dm9sPz9yKCJkaXN0b3J0dm9sIikpLHQuaT10Lmk/P3IoImkiKSx0LmNob3J1cz10LmNob3J1cz8/cigiY2hvcnVzIiksdC5mZnQ9dC5mZnQ/P3IoImZmdCIpLHQucGFuPXQucGFuPz9yKCJwYW4iKSx0Lm9yYml0PXQub3JiaXQ/P3IoIm9yYml0IiksdC5mbWVudj10LmZtZW52Pz9yKCJmbWVudiIpLHQucmVzb25hbmNlPXQucmVzb25hbmNlPz9yKCJyZXNvbmFuY2UiKSx0LmhyZXNvbmFuY2U9dC5ocmVzb25hbmNlPz9yKCJocmVzb25hbmNlIiksdC5iYW5kcT10LmJhbmRxPz9yKCJiYW5kcSIpLHQuc3BlZWQ9dC5zcGVlZD8/cigic3BlZWQiKSx0LnB3PXQucHc/P3IoInB3IiksW3QuYXR0YWNrLHQuZGVjYXksdC5zdXN0YWluLHQucmVsZWFzZV09bShbdC5hdHRhY2ssdC5kZWNheSx0LnN1c3RhaW4sdC5yZWxlYXNlXSksdC5faG9sZEVuZD10Ll9iZWdpbit0Ll9kdXJhdGlvbix0Ll9lbmQ9dC5faG9sZEVuZCt0LnJlbGVhc2UrLjAxLHQuZm1pJiYodC5zPT09InNhdyJ8fHQucz09PSJzYXd0b290aCIpJiYodC5zPSJ6YXciKSxDW3Quc10pe2NvbnN0IGU9Q1t0LnNdO3QuX3NvdW5kPW5ldyBlLHQuX2NoYW5uZWxzPTF9ZWxzZSBpZihfLnNhbXBsZXMuaGFzKHQucykpe2NvbnN0IGU9Xy5zYW1wbGVzLmdldCh0LnMpO3QuX2J1ZmZlcnM9W10sdC5fY2hhbm5lbHM9ZS5jaGFubmVscy5sZW5ndGg7Zm9yKGxldCBoPTA7aDx0Ll9jaGFubmVscztoKyspdC5fYnVmZmVycy5wdXNoKG5ldyBfKGUuY2hhbm5lbHNbaF0sZS5zYW1wbGVSYXRlLHQudW5pdD09PSJjIikpfWVsc2UgY29uc29sZS53YXJuKCJzb3VuZCBub3QgbG9hZGVkIix0LnMpO3QucGVudiYmKHQuX3BlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXT1tKFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXSkpLHQudmliJiYodC5fdmliPW5ldyB2LHQudmlibW9kPXQudmlibW9kPz9yKCJ2aWJtb2QiKSksdC5mbWkmJih0Ll9mbT1uZXcgdix0LmZtaD10LmZtaD8/cigiZm1oIiksdC5mbWVudiYmKHQuX2ZtZW52PW5ldyBmKHtkZWNheUN1cnZlOjJ9KSxbdC5mbWF0dGFjayx0LmZtZGVjYXksdC5mbXN1c3RhaW4sdC5mbXJlbGVhc2VdPW0oW3QuZm1hdHRhY2ssdC5mbWRlY2F5LHQuZm1zdXN0YWluLHQuZm1yZWxlYXNlXSkpKSx0Ll9hZHNyPW5ldyBmKHtkZWNheUN1cnZlOjJ9KSx0LmRlbGF5PWModC5kZWxheT8/cigiZGVsYXkiKSksdC5kZWxheWZlZWRiYWNrPXQuZGVsYXlmZWVkYmFjaz8/cigiZGVsYXlmZWVkYmFjayIpLHQuZGVsYXlzcGVlZD10LmRlbGF5c3BlZWQ/P3IoImRlbGF5c3BlZWQiKSx0LmRlbGF5dGltZT10LmRlbGF5dGltZT8/cigiZGVsYXl0aW1lIiksdC5scGVudiYmKHQuX2xwZW52PW5ldyBmKHtkZWNheUN1cnZlOjR9KSxbdC5scGF0dGFjayx0LmxwZGVjYXksdC5scHN1c3RhaW4sdC5scHJlbGVhc2VdPW0oW3QubHBhdHRhY2ssdC5scGRlY2F5LHQubHBzdXN0YWluLHQubHByZWxlYXNlXSkpLHQuaHBlbnYmJih0Ll9ocGVudj1uZXcgZih7ZGVjYXlDdXJ2ZTo0fSksW3QuaHBhdHRhY2ssdC5ocGRlY2F5LHQuaHBzdXN0YWluLHQuaHByZWxlYXNlXT1tKFt0LmhwYXR0YWNrLHQuaHBkZWNheSx0Lmhwc3VzdGFpbix0LmhwcmVsZWFzZV0pKSx0LmJwZW52JiYodC5fYnBlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LmJwYXR0YWNrLHQuYnBkZWNheSx0LmJwc3VzdGFpbix0LmJwcmVsZWFzZV09bShbdC5icGF0dGFjayx0LmJwZGVjYXksdC5icHN1c3RhaW4sdC5icHJlbGVhc2VdKSksdC5fY2hvcnVzPXQuY2hvcnVzP1tdOm51bGwsdC5fbHBmPXQuY3V0b2ZmP1tdOm51bGwsdC5faHBmPXQuaGN1dG9mZj9bXTpudWxsLHQuX2JwZj10LmJhbmRmP1tdOm51bGwsdC5fY29hcnNlPXQuY29hcnNlP1tdOm51bGwsdC5fY3J1c2g9dC5jcnVzaD9bXTpudWxsLHQuX2Rpc3RvcnQ9dC5kaXN0b3J0P1tdOm51bGw7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jaGFubmVscztlKyspdC5fbHBmPy5wdXNoKG5ldyBnKSx0Ll9ocGY/LnB1c2gobmV3IGcpLHQuX2JwZj8ucHVzaChuZXcgZyksdC5fY2hvcnVzPy5wdXNoKG5ldyBXKSx0Ll9jb2Fyc2U/LnB1c2gobmV3IFgpLHQuX2NydXNoPy5wdXNoKG5ldyBVKSx0Ll9kaXN0b3J0Py5wdXNoKG5ldyBZKX11cGRhdGUocyl7aWYoIXRoaXMuX3NvdW5kJiYhdGhpcy5fYnVmZmVycylyZXR1cm4gMDtsZXQgdD0rKHM+PXRoaXMuX2JlZ2luJiZzPD10aGlzLl9ob2xkRW5kKSxlPXRoaXMuZnJlcSp0aGlzLnNwZWVkO2lmKHRoaXMuX2ZtJiZ0aGlzLmZtaCE9PXZvaWQgMCYmdGhpcy5mbWkhPT12b2lkIDApe2xldCBhPXRoaXMuZm1pO2lmKHRoaXMuX2ZtZW52KXtjb25zdCBxPXRoaXMuX2ZtZW52LnVwZGF0ZShzLHQsdGhpcy5mbWF0dGFjayx0aGlzLmZtZGVjYXksdGhpcy5mbXN1c3RhaW4sdGhpcy5mbXJlbGVhc2UpO2E9dGhpcy5mbWVudipxKmF9Y29uc3QgcD1lKnRoaXMuZm1oLHU9cCphO2U9ZSt0aGlzLl9mbS51cGRhdGUocCkqdX1pZih0aGlzLl92aWImJnRoaXMudmlibW9kIT09dm9pZCAwJiYoZT1lKjIqKih0aGlzLl92aWIudXBkYXRlKHRoaXMudmliKSp0aGlzLnZpYm1vZC8xMikpLHRoaXMuX3BlbnYmJnRoaXMucGVudiE9PXZvaWQgMCl7Y29uc3QgYT10aGlzLl9wZW52LnVwZGF0ZShzLHQsdGhpcy5wYXR0YWNrLHRoaXMucGRlY2F5LHRoaXMucHN1c3RhaW4sdGhpcy5wcmVsZWFzZSk7ZT1lK2EqdGhpcy5wZW52fWxldCBoPXRoaXMuY3V0b2ZmO2lmKGghPT12b2lkIDAmJnRoaXMuX2xwZW52KXtjb25zdCBhPXRoaXMuX2xwZW52LnVwZGF0ZShzLHQsdGhpcy5scGF0dGFjayx0aGlzLmxwZGVjYXksdGhpcy5scHN1c3RhaW4sdGhpcy5scHJlbGVhc2UpO2g9dGhpcy5scGVudiphKmgraH1sZXQgbz10aGlzLmhjdXRvZmY7aWYobyE9PXZvaWQgMCYmdGhpcy5faHBlbnYmJnRoaXMuaHBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5faHBlbnYudXBkYXRlKHMsdCx0aGlzLmhwYXR0YWNrLHRoaXMuaHBkZWNheSx0aGlzLmhwc3VzdGFpbix0aGlzLmhwcmVsZWFzZSk7bz0yKip0aGlzLmhwZW52KmEqbytvfWxldCBuPXRoaXMuYmFuZGY7aWYobiE9PXZvaWQgMCYmdGhpcy5fYnBlbnYmJnRoaXMuYnBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5fYnBlbnYudXBkYXRlKHMsdCx0aGlzLmJwYXR0YWNrLHRoaXMuYnBkZWNheSx0aGlzLmJwc3VzdGFpbix0aGlzLmJwcmVsZWFzZSk7bj0yKip0aGlzLmJwZW52KmEqbitufWNvbnN0IGw9dGhpcy5fYWRzci51cGRhdGUocyx0LHRoaXMuYXR0YWNrLHRoaXMuZGVjYXksdGhpcy5zdXN0YWluLHRoaXMucmVsZWFzZSk7Zm9yKGxldCBhPTA7YTx0aGlzLl9jaGFubmVsczthKyspe2lmKHRoaXMuX3NvdW5kJiZ0aGlzLnM9PT0icHVsc2UiP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlLHRoaXMucHcpOnRoaXMuX3NvdW5kP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlKTp0aGlzLl9idWZmZXJzJiYodGhpcy5vdXRbYV09dGhpcy5fYnVmZmVyc1thXS51cGRhdGUoZSkpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdKnRoaXMuZ2Fpbip0aGlzLnZlbG9jaXR5LHRoaXMuX2Nob3J1cyl7Y29uc3QgcD10aGlzLl9jaG9ydXNbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY2hvcnVzLC4wMysuMDUqYSwxLC4xMSk7dGhpcy5vdXRbYV09cCt0aGlzLm91dFthXX10aGlzLl9scGYmJih0aGlzLl9scGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLGgsdGhpcy5yZXNvbmFuY2UpLHRoaXMub3V0W2FdPXRoaXMuX2xwZlthXS5zMSksdGhpcy5faHBmJiYodGhpcy5faHBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxvLHRoaXMuaHJlc29uYW5jZSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0tdGhpcy5faHBmW2FdLnMxKSx0aGlzLl9icGYmJih0aGlzLl9icGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLG4sdGhpcy5iYW5kcSksdGhpcy5vdXRbYV09dGhpcy5fYnBmW2FdLnMwKSx0aGlzLl9jb2Fyc2UmJih0aGlzLm91dFthXT10aGlzLl9jb2Fyc2VbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY29hcnNlKSksdGhpcy5fY3J1c2gmJih0aGlzLm91dFthXT10aGlzLl9jcnVzaFthXS51cGRhdGUodGhpcy5vdXRbYV0sdGhpcy5jcnVzaCkpLHRoaXMuX2Rpc3RvcnQmJih0aGlzLm91dFthXT10aGlzLl9kaXN0b3J0W2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmRpc3RvcnQsdGhpcy5kaXN0b3J0dm9sKSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qbCx0aGlzLm91dFthXT10aGlzLm91dFthXSp0aGlzLnBvc3RnYWluLHRoaXMuX2J1ZmZlcnN8fCh0aGlzLm91dFthXT10aGlzLm91dFthXSouMil9aWYodGhpcy5fY2hhbm5lbHM9PT0xJiYodGhpcy5vdXRbMV09dGhpcy5vdXRbMF0pLHRoaXMucGFuIT09LjUpe2NvbnN0IGE9dGhpcy5wYW4qTWF0aC5QSS8yO3RoaXMub3V0WzBdPXRoaXMub3V0WzBdKk1hdGguY29zKGEpLHRoaXMub3V0WzFdPXRoaXMub3V0WzFdKk1hdGguc2luKGEpfX19Y2xhc3Mgc3R7dm9pY2VzPVtdO3ZpZD0wO3E9W107b3V0PVswLDBdO2RlbGF5c2VuZD1bMCwwXTtkZWxheXRpbWU9cigiZGVsYXl0aW1lIik7ZGVsYXlmZWVkYmFjaz1yKCJkZWxheWZlZWRiYWNrIik7ZGVsYXlzcGVlZD1yKCJkZWxheXNwZWVkIik7dD0wO2NvbnN0cnVjdG9yKHM9NDhlMyx0PTApe3RoaXMuc2FtcGxlUmF0ZT1zLHRoaXMudD1NYXRoLmZsb29yKHQqcyksdGhpcy5fZGVsYXlMPW5ldyBrLHRoaXMuX2RlbGF5Uj1uZXcga31sb2FkU2FtcGxlKHMsdCxlKXtfLnNhbXBsZXMuc2V0KHMse2NoYW5uZWxzOnQsc2FtcGxlUmF0ZTplfSl9c2NoZWR1bGVTcGF3bihzKXtpZihzLl9iZWdpbj09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoIltkb3VnaF06IHNjaGVkdWxlU3Bhd24gZXhwZWN0ZWQgX2JlZ2luIHRvIGJlIHNldCIpO2lmKHMuX2R1cmF0aW9uPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcigiW2RvdWdoXTogc2NoZWR1bGVTcGF3biBleHBlY3RlZCBfZHVyYXRpb24gdG8gYmUgc2V0Iik7cy5zYW1wbGVSYXRlPXRoaXMuc2FtcGxlUmF0ZTtjb25zdCB0PU1hdGguZmxvb3Iocy5fYmVnaW4qdGhpcy5zYW1wbGVSYXRlKTt0aGlzLnNjaGVkdWxlKHt0aW1lOnQsdHlwZToic3Bhd24iLGFyZzpzfSl9c3Bhd24ocyl7cy5pZD10aGlzLnZpZCsrO2NvbnN0IHQ9bmV3IHR0KHMpO3RoaXMudm9pY2VzLnB1c2godCk7Y29uc3QgZT1NYXRoLmNlaWwodC5fZW5kKnRoaXMuc2FtcGxlUmF0ZSk7dGhpcy5zY2hlZHVsZSh7dGltZTplLHR5cGU6ImRlc3Bhd24iLGFyZzp0LmlkfSl9ZGVzcGF3bihzKXt0aGlzLnZvaWNlcz10aGlzLnZvaWNlcy5maWx0ZXIodD0+dC5pZCE9PXMpfXNjaGVkdWxlKHMpe2lmKCF0aGlzLnEubGVuZ3RoKXt0aGlzLnEucHVzaChzKTtyZXR1cm59bGV0IHQ9MDtmb3IoO3Q8dGhpcy5xLmxlbmd0aCYmdGhpcy5xW3RdLnRpbWU8cy50aW1lOyl0Kys7dGhpcy5xLnNwbGljZSh0LDAscyl9dXBkYXRlKCl7Zm9yKDt0aGlzLnEubGVuZ3RoPjAmJnRoaXMucVswXS50aW1lPD10aGlzLnQ7KXRoaXNbdGhpcy5xWzBdLnR5cGVdKHRoaXMucVswXS5hcmcpLHRoaXMucS5zaGlmdCgpO3RoaXMub3V0WzBdPTAsdGhpcy5vdXRbMV09MDtmb3IobGV0IGU9MDtlPHRoaXMudm9pY2VzLmxlbmd0aDtlKyspdGhpcy52b2ljZXNbZV0udXBkYXRlKHRoaXMudC90aGlzLnNhbXBsZVJhdGUpLHRoaXMub3V0WzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0sdGhpcy5vdXRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSx0aGlzLnZvaWNlc1tlXS5kZWxheSYmKHRoaXMuZGVsYXlzZW5kWzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0qdGhpcy52b2ljZXNbZV0uZGVsYXksdGhpcy5kZWxheXNlbmRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSp0aGlzLnZvaWNlc1tlXS5kZWxheSx0aGlzLmRlbGF5dGltZT10aGlzLnZvaWNlc1tlXS5kZWxheXRpbWUsdGhpcy5kZWxheXNwZWVkPXRoaXMudm9pY2VzW2VdLmRlbGF5c3BlZWQsdGhpcy5kZWxheWZlZWRiYWNrPXRoaXMudm9pY2VzW2VdLmRlbGF5ZmVlZGJhY2spO2NvbnN0IHM9dGhpcy5fZGVsYXlMLnVwZGF0ZSh0aGlzLmRlbGF5c2VuZFswXSx0aGlzLmRlbGF5dGltZSksdD10aGlzLl9kZWxheVIudXBkYXRlKHRoaXMuZGVsYXlzZW5kWzFdLHRoaXMuZGVsYXl0aW1lKTt0aGlzLmRlbGF5c2VuZFswXT1zKnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLmRlbGF5c2VuZFsxXT10KnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLm91dFswXSs9cyx0aGlzLm91dFsxXSs9dCx0aGlzLnQrK319Y29uc3QgZXQ9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtjbGFzcyBpdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5kb3VnaD1uZXcgc3Qoc2FtcGxlUmF0ZSxjdXJyZW50VGltZSksdGhpcy5wb3J0Lm9ubWVzc2FnZT1zPT57cy5kYXRhLnNwYXduP3RoaXMuZG91Z2guc2NoZWR1bGVTcGF3bihzLmRhdGEuc3Bhd24pOnMuZGF0YS5zYW1wbGU/dGhpcy5kb3VnaC5sb2FkU2FtcGxlKHMuZGF0YS5zYW1wbGUscy5kYXRhLmNoYW5uZWxzLHMuZGF0YS5zYW1wbGVSYXRlKTpzLmRhdGEuc2FtcGxlcz9zLmRhdGEuc2FtcGxlcy5mb3JFYWNoKChbdCxlLGhdKT0+e3RoaXMuZG91Z2gubG9hZFNhbXBsZSh0LGUsaCl9KTpjb25zb2xlLmxvZygidW5yZWNvZ25pemVkIGV2ZW50IHR5cGUiLHMuZGF0YSl9fXByb2Nlc3Mocyx0LGUpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2NvbnN0IGg9dFswXTtmb3IobGV0IG89MDtvPGhbMF0ubGVuZ3RoO28rKyl7dGhpcy5kb3VnaC51cGRhdGUoKTtmb3IobGV0IG49MDtuPGgubGVuZ3RoO24rKyloW25dW29dPWV0KHRoaXMuZG91Z2gub3V0W25dLC0xLDEpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZG91Z2gtcHJvY2Vzc29yIixpdCl9KSgpOwo=";typeof sampleRate<"u"&&sampleRate;const workletUrl=_workletUrl;registerWorklet(workletUrl);const{Pattern,logger,repl}=strudelCore;setLogger(logger);const hap2value=e=>(e.ensureObjectValue(),e.value),webaudioOutput=(e,t,o,a,u)=>superdough(hap2value(e),u,o,a,e.whole?.begin.valueOf());function webaudioRepl(e={}){return e={getTime:()=>getAudioContext().currentTime,defaultOutput:webaudioOutput,...e},repl(e)}Pattern.prototype.dough=function(){return this.onTrigger(doughTrigger,1)};const getDrawContext=(e="test-canvas",t)=>{let{contextType:o="2d",pixelated:a=!1,pixelRatio:u=window.devicePixelRatio}=t||{},l=document.querySelector("#"+e);if(!l){l=document.createElement("canvas"),l.id=e,l.width=window.innerWidth*u,l.height=window.innerHeight*u,l.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",a&&(l.style.imageRendering="pixelated"),document.body.prepend(l);let p;window.addEventListener("resize",()=>{p&&clearTimeout(p),p=setTimeout(()=>{l.width=window.innerWidth*u,l.height=window.innerHeight*u},200)})}return l.getContext(o,{willReadFrequently:!0})};let animationFrames={};function stopAnimationFrame(e){animationFrames[e]!==void 0&&(cancelAnimationFrame(animationFrames[e]),delete animationFrames[e])}function stopAllAnimations(e){Object.keys(animationFrames).forEach(t=>stopAnimationFrame(t))}let memory={};Pattern$1.prototype.draw=function(e,t){if(typeof window>"u")return this;let{id:o=1,lookbehind:a=0,lookahead:u=0}=t,l=Math.max(getTime(),0);stopAnimationFrame(o),a=Math.abs(a),memory[o]=(memory[o]||[]).filter(f=>!f.isInFuture(l));let p=this.queryArc(l,l+u).filter(f=>f.hasOnset());memory[o]=memory[o].concat(p);let d;const g=()=>{const f=getTime(),A=f+u;memory[o]=memory[o].filter(S=>S.isInNearPast(a,f));let b=Math.max(d||A,A-1/10);const F=this.queryArc(b,A).filter(S=>S.hasOnset());memory[o]=memory[o].concat(F),d=A,e(memory[o],f,A,this),animationFrames[o]=requestAnimationFrame(g)};return animationFrames[o]=requestAnimationFrame(g),this};const cleanupDraw=(e=!0,t)=>{const o=getDrawContext();e&&o.clearRect(0,0,o.canvas.width,o.canvas.height),stopAllAnimations()};Pattern$1.prototype.onPaint=function(e){return this.withState(t=>(t.controls.painters||(t.controls.painters=[]),t.controls.painters.push(e),t))},Pattern$1.prototype.getPainters=function(){let e=[];return this.queryArc(0,0,{painters:e}),e};let theme={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function getTheme(){return theme}let clearColor="#22222210";Pattern$1.prototype.animate=function({callback:e,sync:t=!1,smear:o=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const a=getDrawContext();let{clientWidth:u,clientHeight:l}=a.canvas;u*=window.devicePixelRatio,l*=window.devicePixelRatio;let p=o===0?"99":Number((1-o)*100).toFixed(0);p=p.length===1?`0${p}`:p,clearColor=`#200010${p}`;const d=g=>{let f;g=Math.round(g),f=this.slow(1e3).queryArc(g,g),a.fillStyle=clearColor,a.fillRect(0,0,u,l),f.forEach(A=>{let{x:b,y:F,w:S,h:k,s:$,r:R,angle:I=0,fill:z="darkseagreen"}=A.value;if(S*=u,k*=l,R!==void 0&&I!==void 0){const U=I*2*Math.PI,[O,ee]=[(u-S)/2,(l-k)/2];b=O+Math.cos(U)*R*O,F=ee+Math.sin(U)*R*ee}else b*=u-S,F*=l-k;const ie={...A.value,x:b,y:F,w:S,h:k};a.fillStyle=z,$==="rect"?a.fillRect(b,F,S,k):$==="ellipse"&&(a.beginPath(),a.ellipse(b+S/2,F+k/2,S/2,k/2,0,0,2*Math.PI),a.fill()),e&&e(a,ie,A)}),window.frame=requestAnimationFrame(d)};return window.frame=requestAnimationFrame(d),silence};const{x:x$1,y,w,h,angle,r,fill,smear}=createParams("x","y","w","h","angle","r","fill","smear");register("rescale",function(e,t){return t.mul(x$1(e).w(e).y(e).h(e))}),register("moveXY",function(e,t,o){return o.add(x$1(e).y(t))}),register("zoomIn",function(e,t){const o=pure(1).sub(e).div(2);return t.rescale(e).move(o,o)});const scale$2=(e,t,o)=>e*(o-t)+t,getValue=e=>{let{value:t}=e;typeof e.value!="object"&&(t={value:t});let{note:o,n:a,freq:u,s:l}=t;if(u)return freqToMidi$2(u);if(o=o??a,typeof o=="string")try{return noteToMidi$1(o)}catch{return 0}return typeof o=="number"?o:l?"_"+l:t};Pattern$1.prototype.pianoroll=function(e={}){let{cycles:t=4,playhead:o=.5,overscan:a=0,hideNegative:u=!1,ctx:l=getDrawContext(),id:p=1}=e,d=-t*o,g=t*(1-o);const f=(A,b)=>(!u||A.whole.begin>=0)&&A.isWithinTime(b+d,b+g);return this.draw((A,b)=>{__pianoroll({...e,time:b,ctx:l,haps:A.filter(F=>f(F,b))})},{lookbehind:d-a,lookahead:g+a,id:p}),this};function __pianoroll({time:e,haps:t,cycles:o=4,playhead:a=.5,flipTime:u=0,flipValues:l=0,hideNegative:p=!1,inactive:d=getTheme().foreground,active:g=getTheme().foreground,background:f="transparent",smear:A=0,playheadColor:b=getTheme().foreground,minMidi:F=10,maxMidi:S=90,autorange:k=0,timeframe:$,fold:R=1,vertical:I=0,labels:z=!1,fill:ie=1,fillActive:U=!1,strokeActive:O=!0,stroke:ee,hideInactive:re=0,colorizeInactive:oe=1,fontFamily:_e,ctx:ue,id:Ce}={}){const me=ue.canvas.width,he=ue.canvas.height;let ve=-o*a,Fe=o*(1-a);Ce&&(t=t.filter(We=>We.hasTag(Ce))),$&&(console.warn("timeframe is deprecated! use from/to instead"),ve=0,Fe=$);const Se=I?he:me,Ee=I?me:he;let Pe=I?[Se,0]:[0,Se];const Ye=Fe-ve,He=I?[0,Ee]:[Ee,0];let et=S-F+1,de=Ee/et,Le=[];u&&Pe.reverse(),l&&He.reverse();const{min:ot,max:Ve,values:Oe}=t.reduce(({min:We,max:qe,values:yt},pt)=>{const Qe=getValue(pt);return{min:Qe<We?Qe:We,max:Qe>qe?Qe:qe,values:yt.includes(Qe)?yt:[...yt,Qe]}},{min:1/0,max:-1/0,values:[]});k&&(F=ot,S=Ve,et=S-F+1),Le=Oe.sort((We,qe)=>typeof We=="number"&&typeof qe=="number"?We-qe:typeof We=="number"?1:String(We).localeCompare(String(qe))),de=R?Ee/Le.length:Ee/et,ue.fillStyle=f,ue.globalAlpha=1,A||(ue.clearRect(0,0,me,he),ue.fillRect(0,0,me,he)),t.forEach(We=>{const qe=We.whole.begin<=e&&We.endClipped>e;let yt=ee??(O&&qe),pt=!qe&&ie||qe&&U;if(re&&!qe)return;let Qe=We.value?.color;g=Qe||g,d=oe&&Qe||d,Qe=qe?g:d,ue.fillStyle=pt?Qe:"transparent",ue.strokeStyle=Qe;const{velocity:At=1,gain:it=1}=We.value||{};ue.globalAlpha=At*it;const vt=(We.whole.begin-(u?Fe:ve))/Ye,at=scale$2(vt,...Pe);let Ct=scale$2(We.duration/Ye,0,Se);const Mt=getValue(We),te=R?Le.indexOf(Mt)/Le.length:(Number(Mt)-F)/et,se=scale$2(te,...He);let q=0;const le=scale$2(e/Ye,...Pe);let be;if(I?be=[se+1-(l?de:0),Se-le+at+q+1-(u?0:Ct),de-2,Ct-2]:be=[at-le+q+1-(u?Ct:0),se+1-(l?0:de),Ct-2,de-2],yt&&ue.strokeRect(...be),pt&&ue.fillRect(...be),z){const Me=We.value.note??We.value.s+(We.value.n?`:${We.value.n}`:""),{label:ye,activeLabel:$e}=We.value,De=(qe&&$e||ye)??Me;let Ne=I?Ct:de*.75;ue.font=`${Ne}px ${_e||"monospace"}`,ue.fillStyle=pt?"black":Qe,ue.textBaseline="top",ue.fillText(De,...be)}}),ue.globalAlpha=1;const Je=scale$2(-ve/Ye,...Pe);return ue.strokeStyle=b,ue.beginPath(),I?(ue.moveTo(0,Je),ue.lineTo(Ee,Je)):(ue.moveTo(Je,0),ue.lineTo(Je,Ee)),ue.stroke(),this}function getDrawOptions(e,t={}){let[o,a]=e;o=Math.abs(o);const u=a+o,l=u!==0?o/u:0;return{fold:1,...t,cycles:u,playhead:l}}const getPunchcardPainter=(e={})=>(t,o,a,u)=>__pianoroll({ctx:t,time:o,haps:a,...getDrawOptions(u,e)});Pattern$1.prototype.punchcard=function(e){return this.onPaint(getPunchcardPainter(e))},Pattern$1.prototype.wordfall=function(e){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...e})};function fromPolar(e,t,o,a){const u=(e-90)*Math.PI/180;return[o+Math.cos(u)*t,a+Math.sin(u)*t]}const xyOnSpiral=(e,t,o,a,u=0)=>fromPolar((e+u)*360,t*e,o,a);function spiralSegment(e){let{ctx:t,from:o=0,to:a=3,margin:u=50,cx:l=100,cy:p=100,rotate:d=0,thickness:g=u/2,color:f=getTheme().foreground,cap:A="round",stretch:b=1,fromOpacity:F=1,toOpacity:S=1}=e;o*=b,a*=b,d*=b,t.lineWidth=g,t.lineCap=A,t.strokeStyle=f,t.globalAlpha=F,t.beginPath();let[k,$]=xyOnSpiral(o,u,l,p,d);t.moveTo(k,$);const R=1/60;let I=o;for(;I<=a;){const[z,ie]=xyOnSpiral(I,u,l,p,d);t.globalAlpha=(I-o)/(a-o)*S,t.lineTo(z,ie),I+=R}t.stroke()}function drawSpiral(e){let{stretch:t=1,size:o=80,thickness:a=o/2,cap:u="butt",inset:l=3,playheadColor:p="#ffffff",playheadLength:d=.02,playheadThickness:g=a,padding:f=0,steady:A=1,activeColor:b=getTheme().foreground,inactiveColor:F=getTheme().gutterForeground,colorizeInactive:S=0,fade:k=!0,ctx:$,time:R,haps:I,drawTime:z,id:ie}=e;ie&&(I=I.filter(me=>me.hasTag(ie)));const[U,O]=[$.canvas.width,$.canvas.height];$.clearRect(0,0,U*2,O*2);const[ee,re]=[U/2,O/2],oe={margin:o/t,cx:ee,cy:re,stretch:t,cap:u,thickness:a},_e={...oe,thickness:g,from:l-d,to:l,color:p},[ue]=z,Ce=A*R;I.forEach(me=>{const he=me.whole.begin<=R&&me.endClipped>R,ve=me.whole.begin-R+l,Fe=me.endClipped-R+l-f,Se=me.value?.color||b,Ee=S||he?Se:F,Pe=k?1-Math.abs((me.whole.begin-R)/ue):1;spiralSegment({ctx:$,...oe,from:ve,to:Fe,rotate:Ce,color:Ee,fromOpacity:Pe,toOpacity:Pe})}),spiralSegment({ctx:$,..._e,rotate:Ce})}Pattern$1.prototype.spiral=function(e={}){return this.onPaint((t,o,a,u)=>drawSpiral({ctx:t,time:o,haps:a,drawTime:u,...e}))};const c=midiToFreq$2(36),circlePos=(e,t,o,a)=>{a=a*Math.PI*2;const u=Math.sin(a)*o+e,l=Math.cos(a)*o+t;return[u,l]},freq2angle=(e,t)=>.5-Math.log2(e/t)%1;function pitchwheel({haps:e,ctx:t,id:o,hapcircles:a=1,circle:u=0,edo:l=12,root:p=c,thickness:d=3,hapRadius:g=6,mode:f="flake",margin:A=10}={}){const b=f==="polygon",F=f==="flake",S=t.canvas.width,k=t.canvas.height;t.clearRect(0,0,S,k);const $=getTheme().foreground,I=Math.min(S,k)/2-d/2-g-A,z=S/2,ie=k/2;o&&(e=e.filter(O=>O.hasTag(o))),t.strokeStyle=$,t.fillStyle=$,t.globalAlpha=1,t.lineWidth=d,u&&(t.beginPath(),t.arc(z,ie,I,0,2*Math.PI),t.stroke()),l&&(Array.from({length:l},(O,ee)=>{const re=freq2angle(p*Math.pow(2,ee/l),p),[oe,_e]=circlePos(z,ie,I,re);t.beginPath(),t.arc(oe,_e,g,0,2*Math.PI),t.fill()}),t.stroke());let U=[];t.lineWidth=g,e.forEach(O=>{let ee;try{ee=getFrequency(O)}catch{return}const re=freq2angle(ee,p),[oe,_e]=circlePos(z,ie,I,re),ue=O.value.color||$;t.strokeStyle=ue,t.fillStyle=ue;const{velocity:Ce=1,gain:me=1}=O.value||{},he=Ce*me;t.globalAlpha=he,U.push([oe,_e,re,ue,he]),t.beginPath(),a&&(t.moveTo(oe+g,_e),t.arc(oe,_e,g,0,2*Math.PI),t.fill()),F&&(t.moveTo(z,ie),t.lineTo(oe,_e)),t.stroke()}),t.strokeStyle=$,t.globalAlpha=1,b&&U.length&&(U=U.sort((O,ee)=>O[2]-ee[2]),t.beginPath(),t.moveTo(U[0][0],U[0][1]),U.forEach(([O,ee,re,oe,_e])=>{t.strokeStyle=oe,t.globalAlpha=_e,t.lineTo(O,ee)}),t.lineTo(U[0][0],U[0][1]),t.stroke())}Pattern$1.prototype.pitchwheel=function(e={}){let{ctx:t=getDrawContext(),id:o=1}=e;return this.tag(o).onPaint((a,u,l)=>pitchwheel({...e,ctx:t,haps:l.filter(p=>p.isActive(u)),id:o}))};function drawTimeScope(e,{align:t=!0,color:o="white",thickness:a=3,scale:u=.25,pos:l=.75,trigger:p=0,ctx:d=getDrawContext(),id:g=1}={}){d.lineWidth=a,d.strokeStyle=o;let f=d.canvas;if(!e){d.beginPath();let $=l*f.height;d.moveTo(0,$),d.lineTo(f.width,$),d.stroke();return}const A=getAnalyzerData("time",g);d.beginPath();const b=e.frequencyBinCount;let F=t?Array.from(A).findIndex(($,R,I)=>R&&I[R-1]>-p&&$<=-p):0;F=Math.max(F,0);const S=f.width*1/b;let k=0;for(let $=F;$<b;$++){const R=A[$]+1,I=(l-u*(R-1))*f.height;$===0?d.moveTo(k,I):d.lineTo(k,I),k+=S}d.stroke()}function drawFrequencyScope(e,{color:t="white",scale:o=.25,pos:a=.75,lean:u=.5,min:l=-150,max:p=0,ctx:d=getDrawContext(),id:g=1}={}){if(!e){d.beginPath();let k=a*A.height;d.moveTo(0,k),d.lineTo(A.width,k),d.stroke();return}const f=getAnalyzerData("frequency",g),A=d.canvas;d.fillStyle=t;const b=e.frequencyBinCount,F=A.width*1/b;let S=0;for(let k=0;k<b;k++){const R=clamp$1((f[k]-l)/(p-l),0,1)*o,I=R*A.height,z=(a-R*u)*A.height;d.fillRect(S,z,Math.max(F,1),I),S+=F}}function clearScreen(e=0,t="0,0,0",o=getDrawContext()){e?(o.fillStyle=`rgba(${t},${1-e})`,o.fillRect(0,0,o.canvas.width,o.canvas.height)):o.clearRect(0,0,o.canvas.width,o.canvas.height)}Pattern$1.prototype.fscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(()=>{clearScreen(e.smear,"0,0,0",e.ctx),analysers[t]&&drawFrequencyScope(analysers[t],e)},{id:t})},Pattern$1.prototype.tscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||getTheme().foreground,e.color,clearScreen(e.smear,"0,0,0",e.ctx),drawTimeScope(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;let latestColor={};Pattern$1.prototype.spectrum=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||latestColor[t]||getTheme().foreground,latestColor[t]=e.color,drawSpectrum(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;const lastFrames=new Map;function drawSpectrum(e,{thickness:t=3,speed:o=1,min:a=-80,max:u=0,ctx:l=getDrawContext(),id:p=1,color:d}={}){if(l.lineWidth=t,l.strokeStyle=d,!e)return;const g=o,f=getAnalyzerData("frequency",p),A=l.canvas;l.fillStyle=d;const b=e.frequencyBinCount;let F=lastFrames.get(p)||l.getImageData(0,0,A.width,A.height);lastFrames.set(p,F),l.clearRect(0,0,l.canvas.width,l.canvas.height),l.putImageData(F,-g,0);let S=A.width-o;for(let k=0;k<b;k++){const $=clamp$1((f[k]-a)/(u-a),0,1);l.globalAlpha=$;const R=Math.log(k+1)/Math.log(b)*A.height;l.fillRect(S,A.height-R,g,2)}lastFrames.set(p,l.getImageData(0,0,A.width,A.height))}const strudelWebAudio=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY,Warpmode,aliasBank,get analysers(){return analysers},get analysersData(){return analysersData},applyFM,applyGainCurve,applyParameterModulators,connectToDestination,createFilter,destroyAudioWorkletNode,distortionAlgorithms,dough,doughTrigger,doughsamples,drawFrequencyScope,drawTimeScope,drywet,dspWorklet,effectSend,errorLogger,gainNode,getADSRValues,getAnalyserById,getAnalyzerData,getAudioContext,getAudioContextCurrentTime,getAudioDevices,getCachedBuffer,getCompressor,getDefaultValue,getDistortion,getDistortionAlgorithm,getFrequencyFromValue,getLfo,getLoadedBuffer,getOscillator,getParamADSR,getParamLfo,getPitchEnvelope,getSampleBuffer,getSampleBufferSource,getSampleInfo,getSound,getSuperdoughAudioController,getVibratoOscillator,getWorklet,getZZFX,initAudio,initAudioOnFirstClick,loadBuffer:loadBuffer$1,logger:logger$1,noises,onTriggerSample,onTriggerSynth,processSampleMap,registerSampleSource,registerSamplesPrefix,registerSound,registerSynthSounds,registerWaveTable,registerWorklet,registerZZFXSounds,resetDefaultValues,resetDefaults,resetGlobalEffects,resetLoadedSounds,reverseBuffer,samples,scheduleAtTime,setDefault,setDefaultAudioContext,setDefaultValue,setDefaultValues,setGainCurve,setLogger,setMaxPolyphony,setMultiChannelOrbits,setVersionDefaults,soundAlias,soundMap:soundMap$1,superdough,superdoughTrigger,tables,waveformN,webAudioTimeout,webaudioOutput,webaudioRepl},Symbol.toStringTag,{value:"Module"}));var astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],nonASCIIidentifierChars="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",reservedWords={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ecma5AndLessKeywords="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",keywords$1={5:ecma5AndLessKeywords,"5module":ecma5AndLessKeywords+" export import",6:ecma5AndLessKeywords+" const class extends export import super"},keywordRelationalOperator=/^in(stanceof)?$/,nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]"),nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");function isInAstralSet(e,t){for(var o=65536,a=0;a<t.length;a+=2){if(o+=t[a],o>e)return!1;if(o+=t[a+1],o>=e)return!0}return!1}function isIdentifierStart(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifierStart.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)}function isIdentifierChar(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifier.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)||isInAstralSet(e,astralIdentifierCodes)}var TokenType=function(t,o){o===void 0&&(o={}),this.label=t,this.keyword=o.keyword,this.beforeExpr=!!o.beforeExpr,this.startsExpr=!!o.startsExpr,this.isLoop=!!o.isLoop,this.isAssign=!!o.isAssign,this.prefix=!!o.prefix,this.postfix=!!o.postfix,this.binop=o.binop||null,this.updateContext=null};function binop(e,t){return new TokenType(e,{beforeExpr:!0,binop:t})}var beforeExpr={beforeExpr:!0},startsExpr={startsExpr:!0},keywords={};function kw(e,t){return t===void 0&&(t={}),t.keyword=e,keywords[e]=new TokenType(e,t)}var types$1={num:new TokenType("num",startsExpr),regexp:new TokenType("regexp",startsExpr),string:new TokenType("string",startsExpr),name:new TokenType("name",startsExpr),privateId:new TokenType("privateId",startsExpr),eof:new TokenType("eof"),bracketL:new TokenType("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new TokenType("]"),braceL:new TokenType("{",{beforeExpr:!0,startsExpr:!0}),braceR:new TokenType("}"),parenL:new TokenType("(",{beforeExpr:!0,startsExpr:!0}),parenR:new TokenType(")"),comma:new TokenType(",",beforeExpr),semi:new TokenType(";",beforeExpr),colon:new TokenType(":",beforeExpr),dot:new TokenType("."),question:new TokenType("?",beforeExpr),questionDot:new TokenType("?."),arrow:new TokenType("=>",beforeExpr),template:new TokenType("template"),invalidTemplate:new TokenType("invalidTemplate"),ellipsis:new TokenType("...",beforeExpr),backQuote:new TokenType("`",startsExpr),dollarBraceL:new TokenType("${",{beforeExpr:!0,startsExpr:!0}),eq:new TokenType("=",{beforeExpr:!0,isAssign:!0}),assign:new TokenType("_=",{beforeExpr:!0,isAssign:!0}),incDec:new TokenType("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new TokenType("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:binop("||",1),logicalAND:binop("&&",2),bitwiseOR:binop("|",3),bitwiseXOR:binop("^",4),bitwiseAND:binop("&",5),equality:binop("==/!=/===/!==",6),relational:binop("</>/<=/>=",7),bitShift:binop("<</>>/>>>",8),plusMin:new TokenType("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:binop("%",10),star:binop("*",10),slash:binop("/",10),starstar:new TokenType("**",{beforeExpr:!0}),coalesce:binop("??",1),_break:kw("break"),_case:kw("case",beforeExpr),_catch:kw("catch"),_continue:kw("continue"),_debugger:kw("debugger"),_default:kw("default",beforeExpr),_do:kw("do",{isLoop:!0,beforeExpr:!0}),_else:kw("else",beforeExpr),_finally:kw("finally"),_for:kw("for",{isLoop:!0}),_function:kw("function",startsExpr),_if:kw("if"),_return:kw("return",beforeExpr),_switch:kw("switch"),_throw:kw("throw",beforeExpr),_try:kw("try"),_var:kw("var"),_const:kw("const"),_while:kw("while",{isLoop:!0}),_with:kw("with"),_new:kw("new",{beforeExpr:!0,startsExpr:!0}),_this:kw("this",startsExpr),_super:kw("super",startsExpr),_class:kw("class",startsExpr),_extends:kw("extends",beforeExpr),_export:kw("export"),_import:kw("import",startsExpr),_null:kw("null",startsExpr),_true:kw("true",startsExpr),_false:kw("false",startsExpr),_in:kw("in",{beforeExpr:!0,binop:7}),_instanceof:kw("instanceof",{beforeExpr:!0,binop:7}),_typeof:kw("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:kw("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:kw("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lineBreak=/\r\n?|\n|\u2028|\u2029/,lineBreakG=new RegExp(lineBreak.source,"g");function isNewLine(e){return e===10||e===13||e===8232||e===8233}function nextLineBreak(e,t,o){o===void 0&&(o=e.length);for(var a=t;a<o;a++){var u=e.charCodeAt(a);if(isNewLine(u))return a<o-1&&u===13&&e.charCodeAt(a+1)===10?a+2:a+1}return-1}var nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,skipWhiteSpace=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ref=Object.prototype,hasOwnProperty=ref.hasOwnProperty,toString=ref.toString,hasOwn=Object.hasOwn||(function(e,t){return hasOwnProperty.call(e,t)}),isArray=Array.isArray||(function(e){return toString.call(e)==="[object Array]"}),regexpCache=Object.create(null);function wordsRegexp(e){return regexpCache[e]||(regexpCache[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var loneSurrogate=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Position=function(t,o){this.line=t,this.column=o};Position.prototype.offset=function(t){return new Position(this.line,this.column+t)};var SourceLocation=function(t,o,a){this.start=o,this.end=a,t.sourceFile!==null&&(this.source=t.sourceFile)};function getLineInfo(e,t){for(var o=1,a=0;;){var u=nextLineBreak(e,a,t);if(u<0)return new Position(o,t-a);++o,a=u}}var defaultOptions={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},warnedAboutEcmaVersion=!1;function getOptions(e){var t={};for(var o in defaultOptions)t[o]=e&&hasOwn(e,o)?e[o]:defaultOptions[o];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!warnedAboutEcmaVersion&&typeof console=="object"&&console.warn&&(warnedAboutEcmaVersion=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),isArray(t.onToken)){var a=t.onToken;t.onToken=function(u){return a.push(u)}}return isArray(t.onComment)&&(t.onComment=pushComment(t,t.onComment)),t}function pushComment(e,t){return function(o,a,u,l,p,d){var g={type:o?"Block":"Line",value:a,start:u,end:l};e.locations&&(g.loc=new SourceLocation(this,p,d)),e.ranges&&(g.range=[u,l]),t.push(g)}}var SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_CLASS_FIELD_INIT=512,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(e,t){return SCOPE_FUNCTION|(e?SCOPE_ASYNC:0)|(t?SCOPE_GENERATOR:0)}var BIND_NONE=0,BIND_VAR=1,BIND_LEXICAL=2,BIND_FUNCTION=3,BIND_SIMPLE_CATCH=4,BIND_OUTSIDE=5,Parser=function(t,o,a){this.options=t=getOptions(t),this.sourceFile=t.sourceFile,this.keywords=wordsRegexp(keywords$1[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var u="";t.allowReserved!==!0&&(u=reservedWords[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(u+=" await")),this.reservedWords=wordsRegexp(u);var l=(u?u+" ":"")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(l),this.reservedWordsStrictBind=wordsRegexp(l+" "+reservedWords.strictBind),this.input=String(o),this.containsEsc=!1,a?(this.pos=a,this.lineStart=this.input.lastIndexOf(`
`,a-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=types$1.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(SCOPE_TOP),this.regexpState=null,this.privateNameStack=[]},prototypeAccessors={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Parser.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0},prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0},prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0},prototypeAccessors.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT))return!1;if(o&SCOPE_FUNCTION)return(o&SCOPE_ASYNC)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},prototypeAccessors.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags;return(t&SCOPE_SUPER)>0||this.options.allowSuperOutsideMethod},prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0},prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},prototypeAccessors.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT)||o&SCOPE_FUNCTION&&!(o&SCOPE_ARROW))return!0}return!1},prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0},Parser.extend=function(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];for(var a=this,u=0;u<t.length;u++)a=t[u](a);return a},Parser.parse=function(t,o){return new this(o,t).parse()},Parser.parseExpressionAt=function(t,o,a){var u=new this(a,t,o);return u.nextToken(),u.parseExpression()},Parser.tokenizer=function(t,o){return new this(o,t)},Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype,literal=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;pp$9.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length;var t=literal.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){skipWhiteSpace.lastIndex=e+t[0].length;var o=skipWhiteSpace.exec(this.input),a=o.index+o[0].length,u=this.input.charAt(a);return u===";"||u==="}"||lineBreak.test(o[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(u)||u==="!"&&this.input.charAt(a+1)==="=")}e+=t[0].length,skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length,this.input[e]===";"&&e++}},pp$9.eat=function(e){return this.type===e?(this.next(),!0):!1},pp$9.isContextual=function(e){return this.type===types$1.name&&this.value===e&&!this.containsEsc},pp$9.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1},pp$9.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},pp$9.canInsertSemicolon=function(){return this.type===types$1.eof||this.type===types$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$9.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},pp$9.semicolon=function(){!this.eat(types$1.semi)&&!this.insertSemicolon()&&this.unexpected()},pp$9.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},pp$9.expect=function(e){this.eat(e)||this.unexpected()},pp$9.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var DestructuringErrors=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pp$9.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var o=t?e.parenthesizedAssign:e.parenthesizedBind;o>-1&&this.raiseRecoverable(o,t?"Assigning to rvalue":"Parenthesized pattern")}},pp$9.checkExpressionErrors=function(e,t){if(!e)return!1;var o=e.shorthandAssign,a=e.doubleProto;if(!t)return o>=0||a>=0;o>=0&&this.raise(o,"Shorthand property assignments are valid only in destructuring patterns"),a>=0&&this.raiseRecoverable(a,"Redefinition of __proto__ property")},pp$9.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},pp$9.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var pp$8=Parser.prototype;pp$8.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==types$1.eof;){var o=this.parseStatement(null,!0,t);e.body.push(o)}if(this.inModule)for(var a=0,u=Object.keys(this.undefinedExports);a<u.length;a+=1){var l=u[a];this.raiseRecoverable(this.undefinedExports[l].start,"Export '"+l+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var loopLabel={kind:"loop"},switchLabel={kind:"switch"};pp$8.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;skipWhiteSpace.lastIndex=this.pos;var t=skipWhiteSpace.exec(this.input),o=this.pos+t[0].length,a=this.input.charCodeAt(o);if(a===91||a===92)return!0;if(e)return!1;if(a===123||a>55295&&a<56320)return!0;if(isIdentifierStart(a,!0)){for(var u=o+1;isIdentifierChar(a=this.input.charCodeAt(u),!0);)++u;if(a===92||a>55295&&a<56320)return!0;var l=this.input.slice(o,u);if(!keywordRelationalOperator.test(l))return!0}return!1},pp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;skipWhiteSpace.lastIndex=this.pos;var e=skipWhiteSpace.exec(this.input),t=this.pos+e[0].length,o;return!lineBreak.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(isIdentifierChar(o=this.input.charCodeAt(t+8))||o>55295&&o<56320))},pp$8.isUsingKeyword=function(e,t){if(this.options.ecmaVersion<17||!this.isContextual(e?"await":"using"))return!1;skipWhiteSpace.lastIndex=this.pos;var o=skipWhiteSpace.exec(this.input),a=this.pos+o[0].length;if(lineBreak.test(this.input.slice(this.pos,a)))return!1;if(e){var u=a+5,l;if(this.input.slice(a,u)!=="using"||u===this.input.length||isIdentifierChar(l=this.input.charCodeAt(u))||l>55295&&l<56320)return!1;skipWhiteSpace.lastIndex=u;var p=skipWhiteSpace.exec(this.input);if(p&&lineBreak.test(this.input.slice(u,u+p[0].length)))return!1}if(t){var d=a+2,g;if(this.input.slice(a,d)==="of"&&(d===this.input.length||!isIdentifierChar(g=this.input.charCodeAt(d))&&!(g>55295&&g<56320)))return!1}var f=this.input.charCodeAt(a);return isIdentifierStart(f,!0)||f===92},pp$8.isAwaitUsing=function(e){return this.isUsingKeyword(!0,e)},pp$8.isUsing=function(e){return this.isUsingKeyword(!1,e)},pp$8.parseStatement=function(e,t,o){var a=this.type,u=this.startNode(),l;switch(this.isLet(e)&&(a=types$1._var,l="let"),a){case types$1._break:case types$1._continue:return this.parseBreakContinueStatement(u,a.keyword);case types$1._debugger:return this.parseDebuggerStatement(u);case types$1._do:return this.parseDoStatement(u);case types$1._for:return this.parseForStatement(u);case types$1._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(u,!1,!e);case types$1._class:return e&&this.unexpected(),this.parseClass(u,!0);case types$1._if:return this.parseIfStatement(u);case types$1._return:return this.parseReturnStatement(u);case types$1._switch:return this.parseSwitchStatement(u);case types$1._throw:return this.parseThrowStatement(u);case types$1._try:return this.parseTryStatement(u);case types$1._const:case types$1._var:return l=l||this.value,e&&l!=="var"&&this.unexpected(),this.parseVarStatement(u,l);case types$1._while:return this.parseWhileStatement(u);case types$1._with:return this.parseWithStatement(u);case types$1.braceL:return this.parseBlock(!0,u);case types$1.semi:return this.parseEmptyStatement(u);case types$1._export:case types$1._import:if(this.options.ecmaVersion>10&&a===types$1._import){skipWhiteSpace.lastIndex=this.pos;var p=skipWhiteSpace.exec(this.input),d=this.pos+p[0].length,g=this.input.charCodeAt(d);if(g===40||g===46)return this.parseExpressionStatement(u,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),a===types$1._import?this.parseImport(u):this.parseExport(u,o);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(u,!0,!e);var f=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(f)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),f==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(u,!1,f),this.semicolon(),this.finishNode(u,"VariableDeclaration");var A=this.value,b=this.parseExpression();return a===types$1.name&&b.type==="Identifier"&&this.eat(types$1.colon)?this.parseLabeledStatement(u,A,b,e):this.parseExpressionStatement(u,b)}},pp$8.parseBreakContinueStatement=function(e,t){var o=t==="break";this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.label=null:this.type!==types$1.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var a=0;a<this.labels.length;++a){var u=this.labels[a];if((e.label==null||u.name===e.label.name)&&(u.kind!=null&&(o||u.kind==="loop")||e.label&&o))break}return a===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,o?"BreakStatement":"ContinueStatement")},pp$8.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},pp$8.parseDoStatement=function(e){return this.next(),this.labels.push(loopLabel),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(types$1._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(types$1.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},pp$8.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(loopLabel),this.enterScope(0),this.expect(types$1.parenL),this.type===types$1.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var o=this.isLet();if(this.type===types$1._var||this.type===types$1._const||o){var a=this.startNode(),u=o?"let":this.value;return this.next(),this.parseVar(a,!0,u),this.finishNode(a,"VariableDeclaration"),this.parseForAfterInit(e,a,t)}var l=this.isContextual("let"),p=!1,d=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(d){var g=this.startNode();return this.next(),d==="await using"&&this.next(),this.parseVar(g,!0,d),this.finishNode(g,"VariableDeclaration"),this.parseForAfterInit(e,g,t)}var f=this.containsEsc,A=new DestructuringErrors,b=this.start,F=t>-1?this.parseExprSubscripts(A,"await"):this.parseExpression(!0,A);return this.type===types$1._in||(p=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===types$1._in&&this.unexpected(t),e.await=!0):p&&this.options.ecmaVersion>=8&&(F.start===b&&!f&&F.type==="Identifier"&&F.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),l&&p&&this.raise(F.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(F,!1,A),this.checkLValPattern(F),this.parseForIn(e,F)):(this.checkExpressionErrors(A,!0),t>-1&&this.unexpected(t),this.parseFor(e,F))},pp$8.parseForAfterInit=function(e,t,o){return(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===types$1._in?o>-1&&this.unexpected(o):e.await=o>-1),this.parseForIn(e,t)):(o>-1&&this.unexpected(o),this.parseFor(e,t))},pp$8.parseFunctionStatement=function(e,t,o){return this.next(),this.parseFunction(e,FUNC_STATEMENT|(o?0:FUNC_HANGING_STATEMENT),!1,t)},pp$8.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(types$1._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},pp$8.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},pp$8.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(types$1.braceL),this.labels.push(switchLabel),this.enterScope(0);for(var t,o=!1;this.type!==types$1.braceR;)if(this.type===types$1._case||this.type===types$1._default){var a=this.type===types$1._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),a?t.test=this.parseExpression():(o&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),o=!0,t.test=null),this.expect(types$1.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},pp$8.parseThrowStatement=function(e){return this.next(),lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var empty$1=[];pp$8.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?SCOPE_SIMPLE_CATCH:0),this.checkLValPattern(e,t?BIND_SIMPLE_CATCH:BIND_LEXICAL),this.expect(types$1.parenR),e},pp$8.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===types$1._catch){var t=this.startNode();this.next(),this.eat(types$1.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(types$1._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},pp$8.parseVarStatement=function(e,t,o){return this.next(),this.parseVar(e,!1,t,o),this.semicolon(),this.finishNode(e,"VariableDeclaration")},pp$8.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(loopLabel),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},pp$8.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},pp$8.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},pp$8.parseLabeledStatement=function(e,t,o,a){for(var u=0,l=this.labels;u<l.length;u+=1){var p=l[u];p.name===t&&this.raise(o.start,"Label '"+t+"' is already declared")}for(var d=this.type.isLoop?"loop":this.type===types$1._switch?"switch":null,g=this.labels.length-1;g>=0;g--){var f=this.labels[g];if(f.statementStart===e.start)f.statementStart=this.start,f.kind=d;else break}return this.labels.push({name:t,kind:d,statementStart:this.start}),e.body=this.parseStatement(a?a.indexOf("label")===-1?a+"label":a:"label"),this.labels.pop(),e.label=o,this.finishNode(e,"LabeledStatement")},pp$8.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},pp$8.parseBlock=function(e,t,o){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(types$1.braceL),e&&this.enterScope(0);this.type!==types$1.braceR;){var a=this.parseStatement(null);t.body.push(a)}return o&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},pp$8.parseFor=function(e,t){return e.init=t,this.expect(types$1.semi),e.test=this.type===types$1.semi?null:this.parseExpression(),this.expect(types$1.semi),e.update=this.type===types$1.parenR?null:this.parseExpression(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},pp$8.parseForIn=function(e,t){var o=this.type===types$1._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!o||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(o?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=o?this.parseExpression():this.parseMaybeAssign(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,o?"ForInStatement":"ForOfStatement")},pp$8.parseVar=function(e,t,o,a){for(e.declarations=[],e.kind=o;;){var u=this.startNode();if(this.parseVarId(u,o),this.eat(types$1.eq)?u.init=this.parseMaybeAssign(t):!a&&o==="const"&&!(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!a&&(o==="using"||o==="await using")&&this.options.ecmaVersion>=17&&this.type!==types$1._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+o+" declaration"):!a&&u.id.type!=="Identifier"&&!(t&&(this.type===types$1._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):u.init=null,e.declarations.push(this.finishNode(u,"VariableDeclarator")),!this.eat(types$1.comma))break}return e},pp$8.parseVarId=function(e,t){e.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?BIND_VAR:BIND_LEXICAL,!1)};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;pp$8.parseFunction=function(e,t,o,a,u){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!a)&&(this.type===types$1.star&&t&FUNC_HANGING_STATEMENT&&this.unexpected(),e.generator=this.eat(types$1.star)),this.options.ecmaVersion>=8&&(e.async=!!a),t&FUNC_STATEMENT&&(e.id=t&FUNC_NULLABLE_ID&&this.type!==types$1.name?null:this.parseIdent(),e.id&&!(t&FUNC_HANGING_STATEMENT)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION));var l=this.yieldPos,p=this.awaitPos,d=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(e.async,e.generator)),t&FUNC_STATEMENT||(e.id=this.type===types$1.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,o,!1,u),this.yieldPos=l,this.awaitPos=p,this.awaitIdentPos=d,this.finishNode(e,t&FUNC_STATEMENT?"FunctionDeclaration":"FunctionExpression")},pp$8.parseFunctionParams=function(e){this.expect(types$1.parenL),e.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},pp$8.parseClass=function(e,t){this.next();var o=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var a=this.enterClassBody(),u=this.startNode(),l=!1;for(u.body=[],this.expect(types$1.braceL);this.type!==types$1.braceR;){var p=this.parseClassElement(e.superClass!==null);p&&(u.body.push(p),p.type==="MethodDefinition"&&p.kind==="constructor"?(l&&this.raiseRecoverable(p.start,"Duplicate constructor in the same class"),l=!0):p.key&&p.key.type==="PrivateIdentifier"&&isPrivateNameConflicted(a,p)&&this.raiseRecoverable(p.key.start,"Identifier '#"+p.key.name+"' has already been declared"))}return this.strict=o,this.next(),e.body=this.finishNode(u,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},pp$8.parseClassElement=function(e){if(this.eat(types$1.semi))return null;var t=this.options.ecmaVersion,o=this.startNode(),a="",u=!1,l=!1,p="method",d=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(types$1.braceL))return this.parseClassStaticBlock(o),o;this.isClassElementNameStart()||this.type===types$1.star?d=!0:a="static"}if(o.static=d,!a&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===types$1.star)&&!this.canInsertSemicolon()?l=!0:a="async"),!a&&(t>=9||!l)&&this.eat(types$1.star)&&(u=!0),!a&&!l&&!u){var g=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?p=g:a=g)}if(a?(o.computed=!1,o.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),o.key.name=a,this.finishNode(o.key,"Identifier")):this.parseClassElementName(o),t<13||this.type===types$1.parenL||p!=="method"||u||l){var f=!o.static&&checkKeyName(o,"constructor"),A=f&&e;f&&p!=="method"&&this.raise(o.key.start,"Constructor can't have get/set modifier"),o.kind=f?"constructor":p,this.parseClassMethod(o,u,l,A)}else this.parseClassField(o);return o},pp$8.isClassElementNameStart=function(){return this.type===types$1.name||this.type===types$1.privateId||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword},pp$8.parseClassElementName=function(e){this.type===types$1.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},pp$8.parseClassMethod=function(e,t,o,a){var u=e.key;e.kind==="constructor"?(t&&this.raise(u.start,"Constructor can't be a generator"),o&&this.raise(u.start,"Constructor can't be an async method")):e.static&&checkKeyName(e,"prototype")&&this.raise(u.start,"Classes may not have a static property named prototype");var l=e.value=this.parseMethod(t,o,a);return e.kind==="get"&&l.params.length!==0&&this.raiseRecoverable(l.start,"getter should have no params"),e.kind==="set"&&l.params.length!==1&&this.raiseRecoverable(l.start,"setter should have exactly one param"),e.kind==="set"&&l.params[0].type==="RestElement"&&this.raiseRecoverable(l.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")},pp$8.parseClassField=function(e){return checkKeyName(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&checkKeyName(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(types$1.eq)?(this.enterScope(SCOPE_CLASS_FIELD_INIT|SCOPE_SUPER),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")},pp$8.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);this.type!==types$1.braceR;){var o=this.parseStatement(null);e.body.push(o)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")},pp$8.parseClassId=function(e,t){this.type===types$1.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,BIND_LEXICAL,!1)):(t===!0&&this.unexpected(),e.id=null)},pp$8.parseClassSuper=function(e){e.superClass=this.eat(types$1._extends)?this.parseExprSubscripts(null,!1):null},pp$8.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared},pp$8.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,o=e.used;if(this.options.checkPrivateFields)for(var a=this.privateNameStack.length,u=a===0?null:this.privateNameStack[a-1],l=0;l<o.length;++l){var p=o[l];hasOwn(t,p.name)||(u?u.used.push(p):this.raiseRecoverable(p.start,"Private field '#"+p.name+"' must be declared in an enclosing class"))}};function isPrivateNameConflicted(e,t){var o=t.key.name,a=e[o],u="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(u=(t.static?"s":"i")+t.kind),a==="iget"&&u==="iset"||a==="iset"&&u==="iget"||a==="sget"&&u==="sset"||a==="sset"&&u==="sget"?(e[o]="true",!1):a?!0:(e[o]=u,!1)}function checkKeyName(e,t){var o=e.computed,a=e.key;return!o&&(a.type==="Identifier"&&a.name===t||a.type==="Literal"&&a.value===t)}pp$8.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")},pp$8.parseExport=function(e,t){if(this.next(),this.eat(types$1.star))return this.parseExportAllDeclaration(e,t);if(this.eat(types$1._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var o=0,a=e.specifiers;o<a.length;o+=1){var u=a[o];this.checkUnreserved(u.local),this.checkLocalExport(u.local),u.local.type==="Literal"&&this.raise(u.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},pp$8.parseExportDeclaration=function(e){return this.parseStatement(null)},pp$8.parseExportDefaultDeclaration=function(){var e;if(this.type===types$1._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,FUNC_STATEMENT|FUNC_NULLABLE_ID,!1,e)}else if(this.type===types$1._class){var o=this.startNode();return this.parseClass(o,"nullableID")}else{var a=this.parseMaybeAssign();return this.semicolon(),a}},pp$8.checkExport=function(e,t,o){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),hasOwn(e,t)&&this.raiseRecoverable(o,"Duplicate export '"+t+"'"),e[t]=!0)},pp$8.checkPatternExport=function(e,t){var o=t.type;if(o==="Identifier")this.checkExport(e,t,t.start);else if(o==="ObjectPattern")for(var a=0,u=t.properties;a<u.length;a+=1){var l=u[a];this.checkPatternExport(e,l)}else if(o==="ArrayPattern")for(var p=0,d=t.elements;p<d.length;p+=1){var g=d[p];g&&this.checkPatternExport(e,g)}else o==="Property"?this.checkPatternExport(e,t.value):o==="AssignmentPattern"?this.checkPatternExport(e,t.left):o==="RestElement"&&this.checkPatternExport(e,t.argument)},pp$8.checkVariableExport=function(e,t){if(e)for(var o=0,a=t;o<a.length;o+=1){var u=a[o];this.checkPatternExport(e,u.id)}},pp$8.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},pp$8.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")},pp$8.parseExportSpecifiers=function(e){var t=[],o=!0;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;t.push(this.parseExportSpecifier(e))}return t},pp$8.parseImport=function(e){return this.next(),this.type===types$1.string?(e.specifiers=empty$1,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===types$1.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},pp$8.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportSpecifier")},pp$8.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportDefaultSpecifier")},pp$8.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportNamespaceSpecifier")},pp$8.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===types$1.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(types$1.comma)))return e;if(this.type===types$1.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(t)t=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;e.push(this.parseImportSpecifier())}return e},pp$8.parseWithClause=function(){var e=[];if(!this.eat(types$1._with))return e;this.expect(types$1.braceL);for(var t={},o=!0;!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;var a=this.parseImportAttribute(),u=a.key.type==="Identifier"?a.key.name:a.key.value;hasOwn(t,u)&&this.raiseRecoverable(a.key.start,"Duplicate attribute key '"+u+"'"),t[u]=!0,e.push(a)}return e},pp$8.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(types$1.colon),this.type!==types$1.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")},pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1.string){var e=this.parseLiteral(this.value);return loneSurrogate.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)},pp$8.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},pp$8.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var pp$7=Parser.prototype;pp$7.toAssignable=function(e,t,o){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",o&&this.checkPatternErrors(o,!0);for(var a=0,u=e.properties;a<u.length;a+=1){var l=u[a];this.toAssignable(l,t),l.type==="RestElement"&&(l.argument.type==="ArrayPattern"||l.argument.type==="ObjectPattern")&&this.raise(l.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",o&&this.checkPatternErrors(o,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,o);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else o&&this.checkPatternErrors(o,!0);return e},pp$7.toAssignableList=function(e,t){for(var o=e.length,a=0;a<o;a++){var u=e[a];u&&this.toAssignable(u,t)}if(o){var l=e[o-1];this.options.ecmaVersion===6&&t&&l&&l.type==="RestElement"&&l.argument.type!=="Identifier"&&this.unexpected(l.argument.start)}return e},pp$7.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},pp$7.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==types$1.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},pp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case types$1.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(types$1.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case types$1.braceL:return this.parseObj(!0)}return this.parseIdent()},pp$7.parseBindingList=function(e,t,o,a){for(var u=[],l=!0;!this.eat(e);)if(l?l=!1:this.expect(types$1.comma),t&&this.type===types$1.comma)u.push(null);else{if(o&&this.afterTrailingComma(e))break;if(this.type===types$1.ellipsis){var p=this.parseRestBinding();this.parseBindingListItem(p),u.push(p),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else u.push(this.parseAssignableListItem(a))}return u},pp$7.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t},pp$7.parseBindingListItem=function(e){return e},pp$7.parseMaybeDefault=function(e,t,o){if(o=o||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(types$1.eq))return o;var a=this.startNodeAt(e,t);return a.left=o,a.right=this.parseMaybeAssign(),this.finishNode(a,"AssignmentPattern")},pp$7.checkLValSimple=function(e,t,o){t===void 0&&(t=BIND_NONE);var a=t!==BIND_NONE;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(a?"Binding ":"Assigning to ")+e.name+" in strict mode"),a&&(t===BIND_LEXICAL&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),o&&(hasOwn(o,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),o[e.name]=!0),t!==BIND_OUTSIDE&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":a&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return a&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,o);default:this.raise(e.start,(a?"Binding":"Assigning to")+" rvalue")}},pp$7.checkLValPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"ObjectPattern":for(var a=0,u=e.properties;a<u.length;a+=1){var l=u[a];this.checkLValInnerPattern(l,t,o)}break;case"ArrayPattern":for(var p=0,d=e.elements;p<d.length;p+=1){var g=d[p];g&&this.checkLValInnerPattern(g,t,o)}break;default:this.checkLValSimple(e,t,o)}},pp$7.checkLValInnerPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"Property":this.checkLValInnerPattern(e.value,t,o);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,o);break;case"RestElement":this.checkLValPattern(e.argument,t,o);break;default:this.checkLValPattern(e,t,o)}};var TokContext=function(t,o,a,u,l){this.token=t,this.isExpr=!!o,this.preserveSpace=!!a,this.override=u,this.generator=!!l},types={b_stat:new TokContext("{",!1),b_expr:new TokContext("{",!0),b_tmpl:new TokContext("${",!1),p_stat:new TokContext("(",!1),p_expr:new TokContext("(",!0),q_tmpl:new TokContext("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new TokContext("function",!1),f_expr:new TokContext("function",!0),f_expr_gen:new TokContext("function",!0,!1,null,!0),f_gen:new TokContext("function",!1,!1,null,!0)},pp$6=Parser.prototype;pp$6.initialContext=function(){return[types.b_stat]},pp$6.curContext=function(){return this.context[this.context.length-1]},pp$6.braceIsBlock=function(e){var t=this.curContext();return t===types.f_expr||t===types.f_stat?!0:e===types$1.colon&&(t===types.b_stat||t===types.b_expr)?!t.isExpr:e===types$1._return||e===types$1.name&&this.exprAllowed?lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):e===types$1._else||e===types$1.semi||e===types$1.eof||e===types$1.parenR||e===types$1.arrow?!0:e===types$1.braceL?t===types.b_stat:e===types$1._var||e===types$1._const||e===types$1.name?!1:!this.exprAllowed},pp$6.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1},pp$6.updateContext=function(e){var t,o=this.type;o.keyword&&e===types$1.dot?this.exprAllowed=!1:(t=o.updateContext)?t.call(this,e):this.exprAllowed=o.beforeExpr},pp$6.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)},types$1.parenR.updateContext=types$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===types.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr},types$1.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?types.b_stat:types.b_expr),this.exprAllowed=!0},types$1.dollarBraceL.updateContext=function(){this.context.push(types.b_tmpl),this.exprAllowed=!0},types$1.parenL.updateContext=function(e){var t=e===types$1._if||e===types$1._for||e===types$1._with||e===types$1._while;this.context.push(t?types.p_stat:types.p_expr),this.exprAllowed=!0},types$1.incDec.updateContext=function(){},types$1._function.updateContext=types$1._class.updateContext=function(e){e.beforeExpr&&e!==types$1._else&&!(e===types$1.semi&&this.curContext()!==types.p_stat)&&!(e===types$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===types$1.colon||e===types$1.braceL)&&this.curContext()===types.b_stat)?this.context.push(types.f_expr):this.context.push(types.f_stat),this.exprAllowed=!1},types$1.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},types$1.backQuote.updateContext=function(){this.curContext()===types.q_tmpl?this.context.pop():this.context.push(types.q_tmpl),this.exprAllowed=!1},types$1.star.updateContext=function(e){if(e===types$1._function){var t=this.context.length-1;this.context[t]===types.f_expr?this.context[t]=types.f_expr_gen:this.context[t]=types.f_gen}this.exprAllowed=!0},types$1.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==types$1.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var pp$5=Parser.prototype;pp$5.checkPropClash=function(e,t,o){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var a=e.key,u;switch(a.type){case"Identifier":u=a.name;break;case"Literal":u=String(a.value);break;default:return}var l=e.kind;if(this.options.ecmaVersion>=6){u==="__proto__"&&l==="init"&&(t.proto&&(o?o.doubleProto<0&&(o.doubleProto=a.start):this.raiseRecoverable(a.start,"Redefinition of __proto__ property")),t.proto=!0);return}u="$"+u;var p=t[u];if(p){var d;l==="init"?d=this.strict&&p.init||p.get||p.set:d=p.init||p[l],d&&this.raiseRecoverable(a.start,"Redefinition of property")}else p=t[u]={init:!1,get:!1,set:!1};p[l]=!0}},pp$5.parseExpression=function(e,t){var o=this.start,a=this.startLoc,u=this.parseMaybeAssign(e,t);if(this.type===types$1.comma){var l=this.startNodeAt(o,a);for(l.expressions=[u];this.eat(types$1.comma);)l.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(l,"SequenceExpression")}return u},pp$5.parseMaybeAssign=function(e,t,o){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var a=!1,u=-1,l=-1,p=-1;t?(u=t.parenthesizedAssign,l=t.trailingComma,p=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new DestructuringErrors,a=!0);var d=this.start,g=this.startLoc;(this.type===types$1.parenL||this.type===types$1.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var f=this.parseMaybeConditional(e,t);if(o&&(f=o.call(this,f,d,g)),this.type.isAssign){var A=this.startNodeAt(d,g);return A.operator=this.value,this.type===types$1.eq&&(f=this.toAssignable(f,!1,t)),a||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=f.start&&(t.shorthandAssign=-1),this.type===types$1.eq?this.checkLValPattern(f):this.checkLValSimple(f),A.left=f,this.next(),A.right=this.parseMaybeAssign(e),p>-1&&(t.doubleProto=p),this.finishNode(A,"AssignmentExpression")}else a&&this.checkExpressionErrors(t,!0);return u>-1&&(t.parenthesizedAssign=u),l>-1&&(t.trailingComma=l),f},pp$5.parseMaybeConditional=function(e,t){var o=this.start,a=this.startLoc,u=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return u;if(this.eat(types$1.question)){var l=this.startNodeAt(o,a);return l.test=u,l.consequent=this.parseMaybeAssign(),this.expect(types$1.colon),l.alternate=this.parseMaybeAssign(e),this.finishNode(l,"ConditionalExpression")}return u},pp$5.parseExprOps=function(e,t){var o=this.start,a=this.startLoc,u=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||u.start===o&&u.type==="ArrowFunctionExpression"?u:this.parseExprOp(u,o,a,-1,e)},pp$5.parseExprOp=function(e,t,o,a,u){var l=this.type.binop;if(l!=null&&(!u||this.type!==types$1._in)&&l>a){var p=this.type===types$1.logicalOR||this.type===types$1.logicalAND,d=this.type===types$1.coalesce;d&&(l=types$1.logicalAND.binop);var g=this.value;this.next();var f=this.start,A=this.startLoc,b=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,u),f,A,l,u),F=this.buildBinary(t,o,e,b,g,p||d);return(p&&this.type===types$1.coalesce||d&&(this.type===types$1.logicalOR||this.type===types$1.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(F,t,o,a,u)}return e},pp$5.buildBinary=function(e,t,o,a,u,l){a.type==="PrivateIdentifier"&&this.raise(a.start,"Private identifier can only be left side of binary expression");var p=this.startNodeAt(e,t);return p.left=o,p.operator=u,p.right=a,this.finishNode(p,l?"LogicalExpression":"BinaryExpression")},pp$5.parseMaybeUnary=function(e,t,o,a){var u=this.start,l=this.startLoc,p;if(this.isContextual("await")&&this.canAwait)p=this.parseAwait(a),t=!0;else if(this.type.prefix){var d=this.startNode(),g=this.type===types$1.incDec;d.operator=this.value,d.prefix=!0,this.next(),d.argument=this.parseMaybeUnary(null,!0,g,a),this.checkExpressionErrors(e,!0),g?this.checkLValSimple(d.argument):this.strict&&d.operator==="delete"&&isLocalVariableAccess(d.argument)?this.raiseRecoverable(d.start,"Deleting local variable in strict mode"):d.operator==="delete"&&isPrivateFieldAccess(d.argument)?this.raiseRecoverable(d.start,"Private fields can not be deleted"):t=!0,p=this.finishNode(d,g?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===types$1.privateId)(a||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),p=this.parsePrivateIdent(),this.type!==types$1._in&&this.unexpected();else{if(p=this.parseExprSubscripts(e,a),this.checkExpressionErrors(e))return p;for(;this.type.postfix&&!this.canInsertSemicolon();){var f=this.startNodeAt(u,l);f.operator=this.value,f.prefix=!1,f.argument=p,this.checkLValSimple(p),this.next(),p=this.finishNode(f,"UpdateExpression")}}if(!o&&this.eat(types$1.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(u,l,p,this.parseMaybeUnary(null,!1,!1,a),"**",!1);else return p};function isLocalVariableAccess(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&isLocalVariableAccess(e.expression)}function isPrivateFieldAccess(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&isPrivateFieldAccess(e.expression)||e.type==="ParenthesizedExpression"&&isPrivateFieldAccess(e.expression)}pp$5.parseExprSubscripts=function(e,t){var o=this.start,a=this.startLoc,u=this.parseExprAtom(e,t);if(u.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return u;var l=this.parseSubscripts(u,o,a,!1,t);return e&&l.type==="MemberExpression"&&(e.parenthesizedAssign>=l.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=l.start&&(e.parenthesizedBind=-1),e.trailingComma>=l.start&&(e.trailingComma=-1)),l},pp$5.parseSubscripts=function(e,t,o,a,u){for(var l=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,p=!1;;){var d=this.parseSubscript(e,t,o,a,l,p,u);if(d.optional&&(p=!0),d===e||d.type==="ArrowFunctionExpression"){if(p){var g=this.startNodeAt(t,o);g.expression=d,d=this.finishNode(g,"ChainExpression")}return d}e=d}},pp$5.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(types$1.arrow)},pp$5.parseSubscriptAsyncArrow=function(e,t,o,a){return this.parseArrowExpression(this.startNodeAt(e,t),o,!0,a)},pp$5.parseSubscript=function(e,t,o,a,u,l,p){var d=this.options.ecmaVersion>=11,g=d&&this.eat(types$1.questionDot);a&&g&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var f=this.eat(types$1.bracketL);if(f||g&&this.type!==types$1.parenL&&this.type!==types$1.backQuote||this.eat(types$1.dot)){var A=this.startNodeAt(t,o);A.object=e,f?(A.property=this.parseExpression(),this.expect(types$1.bracketR)):this.type===types$1.privateId&&e.type!=="Super"?A.property=this.parsePrivateIdent():A.property=this.parseIdent(this.options.allowReserved!=="never"),A.computed=!!f,d&&(A.optional=g),e=this.finishNode(A,"MemberExpression")}else if(!a&&this.eat(types$1.parenL)){var b=new DestructuringErrors,F=this.yieldPos,S=this.awaitPos,k=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var $=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1,b);if(u&&!g&&this.shouldParseAsyncArrow())return this.checkPatternErrors(b,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=F,this.awaitPos=S,this.awaitIdentPos=k,this.parseSubscriptAsyncArrow(t,o,$,p);this.checkExpressionErrors(b,!0),this.yieldPos=F||this.yieldPos,this.awaitPos=S||this.awaitPos,this.awaitIdentPos=k||this.awaitIdentPos;var R=this.startNodeAt(t,o);R.callee=e,R.arguments=$,d&&(R.optional=g),e=this.finishNode(R,"CallExpression")}else if(this.type===types$1.backQuote){(g||l)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var I=this.startNodeAt(t,o);I.tag=e,I.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(I,"TaggedTemplateExpression")}return e},pp$5.parseExprAtom=function(e,t,o){this.type===types$1.slash&&this.readRegexp();var a,u=this.potentialArrowAt===this.start;switch(this.type){case types$1._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),a=this.startNode(),this.next(),this.type===types$1.parenL&&!this.allowDirectSuper&&this.raise(a.start,"super() call outside constructor of a subclass"),this.type!==types$1.dot&&this.type!==types$1.bracketL&&this.type!==types$1.parenL&&this.unexpected(),this.finishNode(a,"Super");case types$1._this:return a=this.startNode(),this.next(),this.finishNode(a,"ThisExpression");case types$1.name:var l=this.start,p=this.startLoc,d=this.containsEsc,g=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!d&&g.name==="async"&&!this.canInsertSemicolon()&&this.eat(types$1._function))return this.overrideContext(types.f_expr),this.parseFunction(this.startNodeAt(l,p),0,!1,!0,t);if(u&&!this.canInsertSemicolon()){if(this.eat(types$1.arrow))return this.parseArrowExpression(this.startNodeAt(l,p),[g],!1,t);if(this.options.ecmaVersion>=8&&g.name==="async"&&this.type===types$1.name&&!d&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return g=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(types$1.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(l,p),[g],!0,t)}return g;case types$1.regexp:var f=this.value;return a=this.parseLiteral(f.value),a.regex={pattern:f.pattern,flags:f.flags},a;case types$1.num:case types$1.string:return this.parseLiteral(this.value);case types$1._null:case types$1._true:case types$1._false:return a=this.startNode(),a.value=this.type===types$1._null?null:this.type===types$1._true,a.raw=this.type.keyword,this.next(),this.finishNode(a,"Literal");case types$1.parenL:var A=this.start,b=this.parseParenAndDistinguishExpression(u,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(b)&&(e.parenthesizedAssign=A),e.parenthesizedBind<0&&(e.parenthesizedBind=A)),b;case types$1.bracketL:return a=this.startNode(),this.next(),a.elements=this.parseExprList(types$1.bracketR,!0,!0,e),this.finishNode(a,"ArrayExpression");case types$1.braceL:return this.overrideContext(types.b_expr),this.parseObj(!1,e);case types$1._function:return a=this.startNode(),this.next(),this.parseFunction(a,0);case types$1._class:return this.parseClass(this.startNode(),!1);case types$1._new:return this.parseNew();case types$1.backQuote:return this.parseTemplate();case types$1._import:return this.options.ecmaVersion>=11?this.parseExprImport(o):this.unexpected();default:return this.parseExprAtomDefault()}},pp$5.parseExprAtomDefault=function(){this.unexpected()},pp$5.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===types$1.parenL&&!e)return this.parseDynamicImport(t);if(this.type===types$1.dot){var o=this.startNodeAt(t.start,t.loc&&t.loc.start);return o.name="import",t.meta=this.finishNode(o,"Identifier"),this.parseImportMeta(t)}else this.unexpected()},pp$5.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(types$1.parenR)?e.options=null:(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(types$1.parenR)||(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)||this.unexpected())));else if(!this.eat(types$1.parenR)){var t=this.start;this.eat(types$1.comma)&&this.eat(types$1.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},pp$5.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},pp$5.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},pp$5.parseParenExpression=function(){this.expect(types$1.parenL);var e=this.parseExpression();return this.expect(types$1.parenR),e},pp$5.shouldParseArrow=function(e){return!this.canInsertSemicolon()},pp$5.parseParenAndDistinguishExpression=function(e,t){var o=this.start,a=this.startLoc,u,l=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var p=this.start,d=this.startLoc,g=[],f=!0,A=!1,b=new DestructuringErrors,F=this.yieldPos,S=this.awaitPos,k;for(this.yieldPos=0,this.awaitPos=0;this.type!==types$1.parenR;)if(f?f=!1:this.expect(types$1.comma),l&&this.afterTrailingComma(types$1.parenR,!0)){A=!0;break}else if(this.type===types$1.ellipsis){k=this.start,g.push(this.parseParenItem(this.parseRestBinding())),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else g.push(this.parseMaybeAssign(!1,b,this.parseParenItem));var $=this.lastTokEnd,R=this.lastTokEndLoc;if(this.expect(types$1.parenR),e&&this.shouldParseArrow(g)&&this.eat(types$1.arrow))return this.checkPatternErrors(b,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=F,this.awaitPos=S,this.parseParenArrowList(o,a,g,t);(!g.length||A)&&this.unexpected(this.lastTokStart),k&&this.unexpected(k),this.checkExpressionErrors(b,!0),this.yieldPos=F||this.yieldPos,this.awaitPos=S||this.awaitPos,g.length>1?(u=this.startNodeAt(p,d),u.expressions=g,this.finishNodeAt(u,"SequenceExpression",$,R)):u=g[0]}else u=this.parseParenExpression();if(this.options.preserveParens){var I=this.startNodeAt(o,a);return I.expression=u,this.finishNode(I,"ParenthesizedExpression")}else return u},pp$5.parseParenItem=function(e){return e},pp$5.parseParenArrowList=function(e,t,o,a){return this.parseArrowExpression(this.startNodeAt(e,t),o,!1,a)};var empty=[];pp$5.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===types$1.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var o=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),o&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var a=this.start,u=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),a,u,!0,!1),this.eat(types$1.parenL)?e.arguments=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1):e.arguments=empty,this.finishNode(e,"NewExpression")},pp$5.parseTemplateElement=function(e){var t=e.isTagged,o=this.startNode();return this.type===types$1.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),o.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):o.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),o.tail=this.type===types$1.backQuote,this.finishNode(o,"TemplateElement")},pp$5.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var o=this.startNode();this.next(),o.expressions=[];var a=this.parseTemplateElement({isTagged:t});for(o.quasis=[a];!a.tail;)this.type===types$1.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(types$1.dollarBraceL),o.expressions.push(this.parseExpression()),this.expect(types$1.braceR),o.quasis.push(a=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(o,"TemplateLiteral")},pp$5.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===types$1.name||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$5.parseObj=function(e,t){var o=this.startNode(),a=!0,u={};for(o.properties=[],this.next();!this.eat(types$1.braceR);){if(a)a=!1;else if(this.expect(types$1.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1.braceR))break;var l=this.parseProperty(e,t);e||this.checkPropClash(l,u,t),o.properties.push(l)}return this.finishNode(o,e?"ObjectPattern":"ObjectExpression")},pp$5.parseProperty=function(e,t){var o=this.startNode(),a,u,l,p;if(this.options.ecmaVersion>=9&&this.eat(types$1.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(o.argument=this.parseMaybeAssign(!1,t),this.type===types$1.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(l=this.start,p=this.startLoc),e||(a=this.eat(types$1.star)));var d=this.containsEsc;return this.parsePropertyName(o),!e&&!d&&this.options.ecmaVersion>=8&&!a&&this.isAsyncProp(o)?(u=!0,a=this.options.ecmaVersion>=9&&this.eat(types$1.star),this.parsePropertyName(o)):u=!1,this.parsePropertyValue(o,e,a,u,l,p,t,d),this.finishNode(o,"Property")},pp$5.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var o=e.kind==="get"?0:1;if(e.value.params.length!==o){var a=e.value.start;e.kind==="get"?this.raiseRecoverable(a,"getter should have no params"):this.raiseRecoverable(a,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")},pp$5.parsePropertyValue=function(e,t,o,a,u,l,p,d){(o||a)&&this.type===types$1.colon&&this.unexpected(),this.eat(types$1.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,p),e.kind="init"):this.options.ecmaVersion>=6&&this.type===types$1.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(o,a),e.kind="init"):!t&&!d&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==types$1.comma&&this.type!==types$1.braceR&&this.type!==types$1.eq?((o||a)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((o||a)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=u),t?e.value=this.parseMaybeDefault(u,l,this.copyNode(e.key)):this.type===types$1.eq&&p?(p.shorthandAssign<0&&(p.shorthandAssign=this.start),e.value=this.parseMaybeDefault(u,l,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected()},pp$5.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(types$1.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(types$1.bracketR),e.key;e.computed=!1}return e.key=this.type===types$1.num||this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},pp$5.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},pp$5.parseMethod=function(e,t,o){var a=this.startNode(),u=this.yieldPos,l=this.awaitPos,p=this.awaitIdentPos;return this.initFunction(a),this.options.ecmaVersion>=6&&(a.generator=e),this.options.ecmaVersion>=8&&(a.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(t,a.generator)|SCOPE_SUPER|(o?SCOPE_DIRECT_SUPER:0)),this.expect(types$1.parenL),a.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(a,!1,!0,!1),this.yieldPos=u,this.awaitPos=l,this.awaitIdentPos=p,this.finishNode(a,"FunctionExpression")},pp$5.parseArrowExpression=function(e,t,o,a){var u=this.yieldPos,l=this.awaitPos,p=this.awaitIdentPos;return this.enterScope(functionFlags(o,!1)|SCOPE_ARROW),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!o),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,a),this.yieldPos=u,this.awaitPos=l,this.awaitIdentPos=p,this.finishNode(e,"ArrowFunctionExpression")},pp$5.parseFunctionBody=function(e,t,o,a){var u=t&&this.type!==types$1.braceL,l=this.strict,p=!1;if(u)e.body=this.parseMaybeAssign(a),e.expression=!0,this.checkParams(e,!1);else{var d=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!l||d)&&(p=this.strictDirective(this.end),p&&d&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var g=this.labels;this.labels=[],p&&(this.strict=!0),this.checkParams(e,!l&&!p&&!t&&!o&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,BIND_OUTSIDE),e.body=this.parseBlock(!1,void 0,p&&!l),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=g}this.exitScope()},pp$5.isSimpleParamList=function(e){for(var t=0,o=e;t<o.length;t+=1){var a=o[t];if(a.type!=="Identifier")return!1}return!0},pp$5.checkParams=function(e,t){for(var o=Object.create(null),a=0,u=e.params;a<u.length;a+=1){var l=u[a];this.checkLValInnerPattern(l,BIND_VAR,t?null:o)}},pp$5.parseExprList=function(e,t,o,a){for(var u=[],l=!0;!this.eat(e);){if(l)l=!1;else if(this.expect(types$1.comma),t&&this.afterTrailingComma(e))break;var p=void 0;o&&this.type===types$1.comma?p=null:this.type===types$1.ellipsis?(p=this.parseSpread(a),a&&this.type===types$1.comma&&a.trailingComma<0&&(a.trailingComma=this.start)):p=this.parseMaybeAssign(!1,a),u.push(p)}return u},pp$5.checkUnreserved=function(e){var t=e.start,o=e.end,a=e.name;if(this.inGenerator&&a==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&a==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&SCOPE_VAR)&&a==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(a==="arguments"||a==="await")&&this.raise(t,"Cannot use "+a+" in class static initialization block"),this.keywords.test(a)&&this.raise(t,"Unexpected keyword '"+a+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,o).indexOf("\\")!==-1)){var u=this.strict?this.reservedWordsStrict:this.reservedWords;u.test(a)&&(!this.inAsync&&a==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+a+"' is reserved"))}},pp$5.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t},pp$5.parseIdentNode=function(){var e=this.startNode();return this.type===types$1.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=types$1.name):this.unexpected(),e},pp$5.parsePrivateIdent=function(){var e=this.startNode();return this.type===types$1.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e},pp$5.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===types$1.semi||this.canInsertSemicolon()||this.type!==types$1.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(types$1.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},pp$5.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var pp$4=Parser.prototype;pp$4.raise=function(e,t){var o=getLineInfo(this.input,e);t+=" ("+o.line+":"+o.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var a=new SyntaxError(t);throw a.pos=e,a.loc=o,a.raisedAt=this.pos,a},pp$4.raiseRecoverable=pp$4.raise,pp$4.curPosition=function(){if(this.options.locations)return new Position(this.curLine,this.pos-this.lineStart)};var pp$3=Parser.prototype,Scope=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};pp$3.enterScope=function(e){this.scopeStack.push(new Scope(e))},pp$3.exitScope=function(){this.scopeStack.pop()},pp$3.treatFunctionsAsVarInScope=function(e){return e.flags&SCOPE_FUNCTION||!this.inModule&&e.flags&SCOPE_TOP},pp$3.declareName=function(e,t,o){var a=!1;if(t===BIND_LEXICAL){var u=this.currentScope();a=u.lexical.indexOf(e)>-1||u.functions.indexOf(e)>-1||u.var.indexOf(e)>-1,u.lexical.push(e),this.inModule&&u.flags&SCOPE_TOP&&delete this.undefinedExports[e]}else if(t===BIND_SIMPLE_CATCH){var l=this.currentScope();l.lexical.push(e)}else if(t===BIND_FUNCTION){var p=this.currentScope();this.treatFunctionsAsVar?a=p.lexical.indexOf(e)>-1:a=p.lexical.indexOf(e)>-1||p.var.indexOf(e)>-1,p.functions.push(e)}else for(var d=this.scopeStack.length-1;d>=0;--d){var g=this.scopeStack[d];if(g.lexical.indexOf(e)>-1&&!(g.flags&SCOPE_SIMPLE_CATCH&&g.lexical[0]===e)||!this.treatFunctionsAsVarInScope(g)&&g.functions.indexOf(e)>-1){a=!0;break}if(g.var.push(e),this.inModule&&g.flags&SCOPE_TOP&&delete this.undefinedExports[e],g.flags&SCOPE_VAR)break}a&&this.raiseRecoverable(o,"Identifier '"+e+"' has already been declared")},pp$3.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)},pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},pp$3.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK))return t}},pp$3.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK)&&!(t.flags&SCOPE_ARROW))return t}};var Node=function(t,o,a){this.type="",this.start=o,this.end=0,t.options.locations&&(this.loc=new SourceLocation(t,a)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[o,0])},pp$2=Parser.prototype;pp$2.startNode=function(){return new Node(this,this.start,this.startLoc)},pp$2.startNodeAt=function(e,t){return new Node(this,e,t)};function finishNodeAt(e,t,o,a){return e.type=t,e.end=o,this.options.locations&&(e.loc.end=a),this.options.ranges&&(e.range[1]=o),e}pp$2.finishNode=function(e,t){return finishNodeAt.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},pp$2.finishNodeAt=function(e,t,o,a){return finishNodeAt.call(this,e,t,o,a)},pp$2.copyNode=function(e){var t=new Node(this,e.start,this.startLoc);for(var o in e)t[o]=e[o];return t};var scriptValuesAddedInUnicode="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",ecma9BinaryProperties="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ecma10BinaryProperties=ecma9BinaryProperties+" Extended_Pictographic",ecma11BinaryProperties=ecma10BinaryProperties,ecma12BinaryProperties=ecma11BinaryProperties+" EBase EComp EMod EPres ExtPict",ecma13BinaryProperties=ecma12BinaryProperties,ecma14BinaryProperties=ecma13BinaryProperties,unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties,14:ecma14BinaryProperties},ecma14BinaryPropertiesOfStrings="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",unicodeBinaryPropertiesOfStrings={9:"",10:"",11:"",12:"",13:"",14:ecma14BinaryPropertiesOfStrings},unicodeGeneralCategoryValues="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ecma9ScriptValues="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ecma10ScriptValues=ecma9ScriptValues+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ecma11ScriptValues=ecma10ScriptValues+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ecma12ScriptValues=ecma11ScriptValues+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ecma13ScriptValues=ecma12ScriptValues+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ecma14ScriptValues=ecma13ScriptValues+" "+scriptValuesAddedInUnicode,unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues,14:ecma14ScriptValues},data={};function buildUnicodeData(e){var t=data[e]={binary:wordsRegexp(unicodeBinaryProperties[e]+" "+unicodeGeneralCategoryValues),binaryOfStrings:wordsRegexp(unicodeBinaryPropertiesOfStrings[e]),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var i=0,list=[9,10,11,12,13,14];i<list.length;i+=1){var ecmaVersion=list[i];buildUnicodeData(ecmaVersion)}var pp$1=Parser.prototype,BranchID=function(t,o){this.parent=t,this.base=o||this};BranchID.prototype.separatedFrom=function(t){for(var o=this;o;o=o.parent)for(var a=t;a;a=a.parent)if(o.base===a.base&&o!==a)return!0;return!1},BranchID.prototype.sibling=function(){return new BranchID(this.parent,this.base)};var RegExpValidationState=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=data[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};RegExpValidationState.prototype.reset=function(t,o,a){var u=a.indexOf("v")!==-1,l=a.indexOf("u")!==-1;this.start=t|0,this.source=o+"",this.flags=a,u&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=l&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=l&&this.parser.options.ecmaVersion>=9)},RegExpValidationState.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},RegExpValidationState.prototype.at=function(t,o){o===void 0&&(o=!1);var a=this.source,u=a.length;if(t>=u)return-1;var l=a.charCodeAt(t);if(!(o||this.switchU)||l<=55295||l>=57344||t+1>=u)return l;var p=a.charCodeAt(t+1);return p>=56320&&p<=57343?(l<<10)+p-56613888:l},RegExpValidationState.prototype.nextIndex=function(t,o){o===void 0&&(o=!1);var a=this.source,u=a.length;if(t>=u)return u;var l=a.charCodeAt(t),p;return!(o||this.switchU)||l<=55295||l>=57344||t+1>=u||(p=a.charCodeAt(t+1))<56320||p>57343?t+1:t+2},RegExpValidationState.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)},RegExpValidationState.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},RegExpValidationState.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)},RegExpValidationState.prototype.eat=function(t,o){return o===void 0&&(o=!1),this.current(o)===t?(this.advance(o),!0):!1},RegExpValidationState.prototype.eatChars=function(t,o){o===void 0&&(o=!1);for(var a=this.pos,u=0,l=t;u<l.length;u+=1){var p=l[u],d=this.at(a,o);if(d===-1||d!==p)return!1;a=this.nextIndex(a,o)}return this.pos=a,!0},pp$1.validateRegExpFlags=function(e){for(var t=e.validFlags,o=e.flags,a=!1,u=!1,l=0;l<o.length;l++){var p=o.charAt(l);t.indexOf(p)===-1&&this.raise(e.start,"Invalid regular expression flag"),o.indexOf(p,l+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),p==="u"&&(a=!0),p==="v"&&(u=!0)}this.options.ecmaVersion>=15&&a&&u&&this.raise(e.start,"Invalid regular expression flag")};function hasProp(e){for(var t in e)return!0;return!1}pp$1.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&hasProp(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))},pp$1.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,o=e.backReferenceNames;t<o.length;t+=1){var a=o[t];e.groupNames[a]||e.raise("Invalid named capture referenced")}},pp$1.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new BranchID(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},pp$1.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},pp$1.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1},pp$1.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var o=!1;if(this.options.ecmaVersion>=9&&(o=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!o,!0}return e.pos=t,!1},pp$1.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1},pp$1.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},pp$1.regexp_eatBracedQuantifier=function(e,t){var o=e.pos;if(e.eat(123)){var a=0,u=-1;if(this.regexp_eatDecimalDigits(e)&&(a=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(u=e.lastIntValue),e.eat(125)))return u!==-1&&u<a&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=o}return!1},pp$1.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},pp$1.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},pp$1.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var o=this.regexp_eatModifiers(e),a=e.eat(45);if(o||a){for(var u=0;u<o.length;u++){var l=o.charAt(u);o.indexOf(l,u+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(a){var p=this.regexp_eatModifiers(e);!o&&!p&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var d=0;d<p.length;d++){var g=p.charAt(d);(p.indexOf(g,d+1)>-1||o.indexOf(g)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1},pp$1.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},pp$1.regexp_eatModifiers=function(e){for(var t="",o=0;(o=e.current())!==-1&&isRegularExpressionModifier(o);)t+=codePointToString(o),e.advance();return t};function isRegularExpressionModifier(e){return e===105||e===109||e===115}pp$1.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},pp$1.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},pp$1.regexp_eatSyntaxCharacter=function(e){var t=e.current();return isSyntaxCharacter(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isSyntaxCharacter(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}pp$1.regexp_eatPatternCharacters=function(e){for(var t=e.pos,o=0;(o=e.current())!==-1&&!isSyntaxCharacter(o);)e.advance();return e.pos!==t},pp$1.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1},pp$1.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,o=e.groupNames[e.lastStringValue];if(o)if(t)for(var a=0,u=o;a<u.length;a+=1){var l=u[a];l.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(o||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}},pp$1.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},pp$1.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=codePointToString(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=codePointToString(e.lastIntValue);return!0}return!1},pp$1.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,a=e.current(o);return e.advance(o),a===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(a=e.lastIntValue),isRegExpIdentifierStart(a)?(e.lastIntValue=a,!0):(e.pos=t,!1)};function isRegExpIdentifierStart(e){return isIdentifierStart(e,!0)||e===36||e===95}pp$1.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,a=e.current(o);return e.advance(o),a===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(a=e.lastIntValue),isRegExpIdentifierPart(a)?(e.lastIntValue=a,!0):(e.pos=t,!1)};function isRegExpIdentifierPart(e){return isIdentifierChar(e,!0)||e===36||e===95||e===8204||e===8205}pp$1.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},pp$1.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var o=e.lastIntValue;if(e.switchU)return o>e.maxBackReference&&(e.maxBackReference=o),!0;if(o<=e.numCapturingParens)return!0;e.pos=t}return!1},pp$1.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},pp$1.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},pp$1.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},pp$1.regexp_eatZero=function(e){return e.current()===48&&!isDecimalDigit(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1},pp$1.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1},pp$1.regexp_eatControlLetter=function(e){var t=e.current();return isControlLetter(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function isControlLetter(e){return e>=65&&e<=90||e>=97&&e<=122}pp$1.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var o=e.pos,a=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var u=e.lastIntValue;if(a&&u>=55296&&u<=56319){var l=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var p=e.lastIntValue;if(p>=56320&&p<=57343)return e.lastIntValue=(u-55296)*1024+(p-56320)+65536,!0}e.pos=l,e.lastIntValue=u}return!0}if(a&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&isValidUnicode(e.lastIntValue))return!0;a&&e.raise("Invalid unicode escape"),e.pos=o}return!1};function isValidUnicode(e){return e>=0&&e<=1114111}pp$1.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1},pp$1.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var CharSetNone=0,CharSetOk=1,CharSetString=2;pp$1.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(isCharacterClassEscape(t))return e.lastIntValue=-1,e.advance(),CharSetOk;var o=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((o=t===80)||t===112)){e.lastIntValue=-1,e.advance();var a;if(e.eat(123)&&(a=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return o&&a===CharSetString&&e.raise("Invalid property name"),a;e.raise("Invalid property name")}return CharSetNone};function isCharacterClassEscape(e){return e===100||e===68||e===115||e===83||e===119||e===87}pp$1.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var o=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var a=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,o,a),CharSetOk}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var u=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,u)}return CharSetNone},pp$1.regexp_validateUnicodePropertyNameAndValue=function(e,t,o){hasOwn(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(o)||e.raise("Invalid property value")},pp$1.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return CharSetOk;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return CharSetString;e.raise("Invalid property name")},pp$1.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyNameCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyNameCharacter(e){return isControlLetter(e)||e===95}pp$1.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyValueCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyValueCharacter(e){return isUnicodePropertyNameCharacter(e)||isDecimalDigit(e)}pp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},pp$1.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),o=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&o===CharSetString&&e.raise("Negated character class may contain strings"),!0}return!1},pp$1.regexp_classContents=function(e){return e.current()===93?CharSetOk:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),CharSetOk)},pp$1.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var o=e.lastIntValue;e.switchU&&(t===-1||o===-1)&&e.raise("Invalid character class"),t!==-1&&o!==-1&&t>o&&e.raise("Range out of order in character class")}}},pp$1.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var o=e.current();(o===99||isOctalDigit(o))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var a=e.current();return a!==93?(e.lastIntValue=a,e.advance(),!0):!1},pp$1.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},pp$1.regexp_classSetExpression=function(e){var t=CharSetOk,o;if(!this.regexp_eatClassSetRange(e))if(o=this.regexp_eatClassSetOperand(e)){o===CharSetString&&(t=CharSetString);for(var a=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(o=this.regexp_eatClassSetOperand(e))){o!==CharSetString&&(t=CharSetOk);continue}e.raise("Invalid character in character class")}if(a!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(a!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(o=this.regexp_eatClassSetOperand(e),!o)return t;o===CharSetString&&(t=CharSetString)}},pp$1.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var o=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var a=e.lastIntValue;return o!==-1&&a!==-1&&o>a&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1},pp$1.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?CharSetOk:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)},pp$1.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var o=e.eat(94),a=this.regexp_classContents(e);if(e.eat(93))return o&&a===CharSetString&&e.raise("Negated character class may contain strings"),a;e.pos=t}if(e.eat(92)){var u=this.regexp_eatCharacterClassEscape(e);if(u)return u;e.pos=t}return null},pp$1.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var o=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return o}else e.raise("Invalid escape");e.pos=t}return null},pp$1.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===CharSetString&&(t=CharSetString);return t},pp$1.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?CharSetOk:CharSetString},pp$1.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var o=e.current();return o<0||o===e.lookahead()&&isClassSetReservedDoublePunctuatorCharacter(o)||isClassSetSyntaxCharacter(o)?!1:(e.advance(),e.lastIntValue=o,!0)};function isClassSetReservedDoublePunctuatorCharacter(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function isClassSetSyntaxCharacter(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}pp$1.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return isClassSetReservedPunctuator(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isClassSetReservedPunctuator(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}pp$1.regexp_eatClassControlLetter=function(e){var t=e.current();return isDecimalDigit(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1},pp$1.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},pp$1.regexp_eatDecimalDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isDecimalDigit(o=e.current());)e.lastIntValue=10*e.lastIntValue+(o-48),e.advance();return e.pos!==t};function isDecimalDigit(e){return e>=48&&e<=57}pp$1.regexp_eatHexDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isHexDigit(o=e.current());)e.lastIntValue=16*e.lastIntValue+hexToInt(o),e.advance();return e.pos!==t};function isHexDigit(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function hexToInt(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}pp$1.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var o=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+o*8+e.lastIntValue:e.lastIntValue=t*8+o}else e.lastIntValue=t;return!0}return!1},pp$1.regexp_eatOctalDigit=function(e){var t=e.current();return isOctalDigit(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function isOctalDigit(e){return e>=48&&e<=55}pp$1.regexp_eatFixedHexDigits=function(e,t){var o=e.pos;e.lastIntValue=0;for(var a=0;a<t;++a){var u=e.current();if(!isHexDigit(u))return e.pos=o,!1;e.lastIntValue=16*e.lastIntValue+hexToInt(u),e.advance()}return!0};var Token=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new SourceLocation(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},pp=Parser.prototype;pp.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Token(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},pp.getToken=function(){return this.next(),new Token(this)},typeof Symbol<"u"&&(pp[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===types$1.eof,value:t}}}}),pp.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(types$1.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())},pp.readToken=function(e){return isIdentifierStart(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)},pp.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888},pp.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,o=this.input.indexOf("*/",this.pos+=2);if(o===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=o+2,this.options.locations)for(var a=void 0,u=t;(a=nextLineBreak(this.input,u,this.pos))>-1;)++this.curLine,u=this.lineStart=a;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,o),t,this.pos,e,this.curPosition())},pp.skipLineComment=function(e){for(var t=this.pos,o=this.options.onComment&&this.curPosition(),a=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!isNewLine(a);)a=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,o,this.curPosition())},pp.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&nonASCIIwhitespace.test(String.fromCharCode(e)))++this.pos;else break e}}},pp.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var o=this.type;this.type=e,this.value=t,this.updateContext(o)},pp.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(types$1.ellipsis)):(++this.pos,this.finishToken(types$1.dot))},pp.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.slash,1)},pp.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),o=1,a=e===42?types$1.star:types$1.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++o,a=types$1.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(types$1.assign,o+1):this.finishOp(a,o)},pp.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var o=this.input.charCodeAt(this.pos+2);if(o===61)return this.finishOp(types$1.assign,3)}return this.finishOp(e===124?types$1.logicalOR:types$1.logicalAND,2)}return t===61?this.finishOp(types$1.assign,2):this.finishOp(e===124?types$1.bitwiseOR:types$1.bitwiseAND,1)},pp.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.bitwiseXOR,1)},pp.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(types$1.incDec,2):t===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.plusMin,1)},pp.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),o=1;return t===e?(o=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+o)===61?this.finishOp(types$1.assign,o+1):this.finishOp(types$1.bitShift,o)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(o=2),this.finishOp(types$1.relational,o))},pp.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(types$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(types$1.arrow)):this.finishOp(e===61?types$1.eq:types$1.prefix,1)},pp.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var o=this.input.charCodeAt(this.pos+2);if(o<48||o>57)return this.finishOp(types$1.questionDot,2)}if(t===63){if(e>=12){var a=this.input.charCodeAt(this.pos+2);if(a===61)return this.finishOp(types$1.assign,3)}return this.finishOp(types$1.coalesce,2)}}return this.finishOp(types$1.question,1)},pp.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),isIdentifierStart(t,!0)||t===92))return this.finishToken(types$1.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+codePointToString(t)+"'")},pp.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(types$1.parenL);case 41:return++this.pos,this.finishToken(types$1.parenR);case 59:return++this.pos,this.finishToken(types$1.semi);case 44:return++this.pos,this.finishToken(types$1.comma);case 91:return++this.pos,this.finishToken(types$1.bracketL);case 93:return++this.pos,this.finishToken(types$1.bracketR);case 123:return++this.pos,this.finishToken(types$1.braceL);case 125:return++this.pos,this.finishToken(types$1.braceR);case 58:return++this.pos,this.finishToken(types$1.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(types$1.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(types$1.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+codePointToString(e)+"'")},pp.finishOp=function(e,t){var o=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,o)},pp.readRegexp=function(){for(var e,t,o=this.pos;;){this.pos>=this.input.length&&this.raise(o,"Unterminated regular expression");var a=this.input.charAt(this.pos);if(lineBreak.test(a)&&this.raise(o,"Unterminated regular expression"),e)e=!1;else{if(a==="[")t=!0;else if(a==="]"&&t)t=!1;else if(a==="/"&&!t)break;e=a==="\\"}++this.pos}var u=this.input.slice(o,this.pos);++this.pos;var l=this.pos,p=this.readWord1();this.containsEsc&&this.unexpected(l);var d=this.regexpState||(this.regexpState=new RegExpValidationState(this));d.reset(o,u,p),this.validateRegExpFlags(d),this.validateRegExpPattern(d);var g=null;try{g=new RegExp(u,p)}catch{}return this.finishToken(types$1.regexp,{pattern:u,flags:p,value:g})},pp.readInt=function(e,t,o){for(var a=this.options.ecmaVersion>=12&&t===void 0,u=o&&this.input.charCodeAt(this.pos)===48,l=this.pos,p=0,d=0,g=0,f=t??1/0;g<f;++g,++this.pos){var A=this.input.charCodeAt(this.pos),b=void 0;if(a&&A===95){u&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),d===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),g===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),d=A;continue}if(A>=97?b=A-97+10:A>=65?b=A-65+10:A>=48&&A<=57?b=A-48:b=1/0,b>=e)break;d=A,p=p*e+b}return a&&d===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===l||t!=null&&this.pos-l!==t?null:p};function stringToNumber(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function stringToBigInt(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}pp.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var o=this.readInt(e);return o==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(o=stringToBigInt(this.input.slice(t,this.pos)),++this.pos):isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,o)},pp.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var o=this.pos-t>=2&&this.input.charCodeAt(t)===48;o&&this.strict&&this.raise(t,"Invalid number");var a=this.input.charCodeAt(this.pos);if(!o&&!e&&this.options.ecmaVersion>=11&&a===110){var u=stringToBigInt(this.input.slice(t,this.pos));return++this.pos,isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,u)}o&&/[89]/.test(this.input.slice(t,this.pos))&&(o=!1),a===46&&!o&&(++this.pos,this.readInt(10),a=this.input.charCodeAt(this.pos)),(a===69||a===101)&&!o&&(a=this.input.charCodeAt(++this.pos),(a===43||a===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var l=stringToNumber(this.input.slice(t,this.pos),o);return this.finishToken(types$1.num,l)},pp.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var o=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(o,"Code point out of bounds")}else t=this.readHexChar(4);return t},pp.readString=function(e){for(var t="",o=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var a=this.input.charCodeAt(this.pos);if(a===e)break;a===92?(t+=this.input.slice(o,this.pos),t+=this.readEscapedChar(!1),o=this.pos):a===8232||a===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(isNewLine(a)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(o,this.pos++),this.finishToken(types$1.string,t)};var INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===INVALID_TEMPLATE_ESCAPE_ERROR)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1},pp.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw INVALID_TEMPLATE_ESCAPE_ERROR;this.raise(e,t)},pp.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var o=this.input.charCodeAt(this.pos);if(o===96||o===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===types$1.template||this.type===types$1.invalidTemplate)?o===36?(this.pos+=2,this.finishToken(types$1.dollarBraceL)):(++this.pos,this.finishToken(types$1.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(types$1.template,e));if(o===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(isNewLine(o)){switch(e+=this.input.slice(t,this.pos),++this.pos,o){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(o);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},pp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(types$1.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},pp.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return codePointToString(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var o=this.pos-1;this.invalidStringToken(o,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var a=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],u=parseInt(a,8);return u>255&&(a=a.slice(0,-1),u=parseInt(a,8)),this.pos+=a.length-1,t=this.input.charCodeAt(this.pos),(a!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-a.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(u)}return isNewLine(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}},pp.readHexChar=function(e){var t=this.pos,o=this.readInt(16,e);return o===null&&this.invalidStringToken(t,"Bad character escape sequence"),o},pp.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,o=this.pos,a=this.options.ecmaVersion>=6;this.pos<this.input.length;){var u=this.fullCharCodeAtPos();if(isIdentifierChar(u,a))this.pos+=u<=65535?1:2;else if(u===92){this.containsEsc=!0,e+=this.input.slice(o,this.pos);var l=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var p=this.readCodePoint();(t?isIdentifierStart:isIdentifierChar)(p,a)||this.invalidStringToken(l,"Invalid Unicode escape"),e+=codePointToString(p),o=this.pos}else break;t=!1}return e+this.input.slice(o,this.pos)},pp.readWord=function(){var e=this.readWord1(),t=types$1.name;return this.keywords.test(e)&&(t=keywords[e]),this.finishToken(t,e)};var version$1="8.15.0";Parser.acorn={Parser,version:version$1,defaultOptions,Position,SourceLocation,getLineInfo,Node,TokenType,tokTypes:types$1,keywordTypes:keywords,TokContext,tokContexts:types,isIdentifierChar,isIdentifierStart,Token,isNewLine,lineBreak,lineBreakG,nonASCIIwhitespace};function parse$a(e,t){return Parser.parse(e,t)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var o=function a(){var u=!1;try{u=this instanceof a}catch{}return u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var u=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(o,a,u.get?u:{enumerable:!0,get:function(){return e[a]}})}),o}var escodegen$1={},estraverse={},hasRequiredEstraverse;function requireEstraverse(){return hasRequiredEstraverse||(hasRequiredEstraverse=1,(function(e){(function t(o){var a,u,l,p,d,g;function f(O){var ee={},re,oe;for(re in O)O.hasOwnProperty(re)&&(oe=O[re],typeof oe=="object"&&oe!==null?ee[re]=f(oe):ee[re]=oe);return ee}function A(O,ee){var re,oe,_e,ue;for(oe=O.length,_e=0;oe;)re=oe>>>1,ue=_e+re,ee(O[ue])?oe=re:(_e=ue+1,oe-=re+1);return _e}a={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},l={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},p={},d={},g={},u={Break:p,Skip:d,Remove:g};function b(O,ee){this.parent=O,this.key=ee}b.prototype.replace=function(ee){this.parent[this.key]=ee},b.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function F(O,ee,re,oe){this.node=O,this.path=ee,this.wrap=re,this.ref=oe}function S(){}S.prototype.path=function(){var ee,re,oe,_e,ue,Ce;function me(he,ve){if(Array.isArray(ve))for(oe=0,_e=ve.length;oe<_e;++oe)he.push(ve[oe]);else he.push(ve)}if(!this.__current.path)return null;for(ue=[],ee=2,re=this.__leavelist.length;ee<re;++ee)Ce=this.__leavelist[ee],me(ue,Ce.path);return me(ue,this.__current.path),ue},S.prototype.type=function(){var O=this.current();return O.type||this.__current.wrap},S.prototype.parents=function(){var ee,re,oe;for(oe=[],ee=1,re=this.__leavelist.length;ee<re;++ee)oe.push(this.__leavelist[ee].node);return oe},S.prototype.current=function(){return this.__current.node},S.prototype.__execute=function(ee,re){var oe,_e;return _e=void 0,oe=this.__current,this.__current=re,this.__state=null,ee&&(_e=ee.call(this,re.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=oe,_e},S.prototype.notify=function(ee){this.__state=ee},S.prototype.skip=function(){this.notify(d)},S.prototype.break=function(){this.notify(p)},S.prototype.remove=function(){this.notify(g)},S.prototype.__initialize=function(O,ee){this.visitor=ee,this.root=O,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,ee.fallback==="iteration"?this.__fallback=Object.keys:typeof ee.fallback=="function"&&(this.__fallback=ee.fallback),this.__keys=l,ee.keys&&(this.__keys=Object.assign(Object.create(this.__keys),ee.keys))};function k(O){return O==null?!1:typeof O=="object"&&typeof O.type=="string"}function $(O,ee){return(O===a.ObjectExpression||O===a.ObjectPattern)&&ee==="properties"}function R(O,ee){for(var re=O.length-1;re>=0;--re)if(O[re].node===ee)return!0;return!1}S.prototype.traverse=function(ee,re){var oe,_e,ue,Ce,me,he,ve,Fe,Se,Ee,Pe,Ye;for(this.__initialize(ee,re),Ye={},oe=this.__worklist,_e=this.__leavelist,oe.push(new F(ee,null,null,null)),_e.push(new F(null,null,null,null));oe.length;){if(ue=oe.pop(),ue===Ye){if(ue=_e.pop(),he=this.__execute(re.leave,ue),this.__state===p||he===p)return;continue}if(ue.node){if(he=this.__execute(re.enter,ue),this.__state===p||he===p)return;if(oe.push(Ye),_e.push(ue),this.__state===d||he===d)continue;if(Ce=ue.node,me=Ce.type||ue.wrap,Ee=this.__keys[me],!Ee)if(this.__fallback)Ee=this.__fallback(Ce);else throw new Error("Unknown node type "+me+".");for(Fe=Ee.length;(Fe-=1)>=0;)if(ve=Ee[Fe],Pe=Ce[ve],!!Pe){if(Array.isArray(Pe)){for(Se=Pe.length;(Se-=1)>=0;)if(Pe[Se]&&!R(_e,Pe[Se])){if($(me,Ee[Fe]))ue=new F(Pe[Se],[ve,Se],"Property",null);else if(k(Pe[Se]))ue=new F(Pe[Se],[ve,Se],null,null);else continue;oe.push(ue)}}else if(k(Pe)){if(R(_e,Pe))continue;oe.push(new F(Pe,ve,null,null))}}}}},S.prototype.replace=function(ee,re){var oe,_e,ue,Ce,me,he,ve,Fe,Se,Ee,Pe,Ye,He;function et(de){var Le,ot,Ve,Oe;if(de.ref.remove()){for(ot=de.ref.key,Oe=de.ref.parent,Le=oe.length;Le--;)if(Ve=oe[Le],Ve.ref&&Ve.ref.parent===Oe){if(Ve.ref.key<ot)break;--Ve.ref.key}}}for(this.__initialize(ee,re),Pe={},oe=this.__worklist,_e=this.__leavelist,Ye={root:ee},he=new F(ee,null,null,new b(Ye,"root")),oe.push(he),_e.push(he);oe.length;){if(he=oe.pop(),he===Pe){if(he=_e.pop(),me=this.__execute(re.leave,he),me!==void 0&&me!==p&&me!==d&&me!==g&&he.ref.replace(me),(this.__state===g||me===g)&&et(he),this.__state===p||me===p)return Ye.root;continue}if(me=this.__execute(re.enter,he),me!==void 0&&me!==p&&me!==d&&me!==g&&(he.ref.replace(me),he.node=me),(this.__state===g||me===g)&&(et(he),he.node=null),this.__state===p||me===p)return Ye.root;if(ue=he.node,!!ue&&(oe.push(Pe),_e.push(he),!(this.__state===d||me===d))){if(Ce=ue.type||he.wrap,Se=this.__keys[Ce],!Se)if(this.__fallback)Se=this.__fallback(ue);else throw new Error("Unknown node type "+Ce+".");for(ve=Se.length;(ve-=1)>=0;)if(He=Se[ve],Ee=ue[He],!!Ee)if(Array.isArray(Ee)){for(Fe=Ee.length;(Fe-=1)>=0;)if(Ee[Fe]){if($(Ce,Se[ve]))he=new F(Ee[Fe],[He,Fe],"Property",new b(Ee,Fe));else if(k(Ee[Fe]))he=new F(Ee[Fe],[He,Fe],null,new b(Ee,Fe));else continue;oe.push(he)}}else k(Ee)&&oe.push(new F(Ee,He,null,new b(ue,He)))}}return Ye.root};function I(O,ee){var re=new S;return re.traverse(O,ee)}function z(O,ee){var re=new S;return re.replace(O,ee)}function ie(O,ee){var re;return re=A(ee,function(_e){return _e.range[0]>O.range[0]}),O.extendedRange=[O.range[0],O.range[1]],re!==ee.length&&(O.extendedRange[1]=ee[re].range[0]),re-=1,re>=0&&(O.extendedRange[0]=ee[re].range[1]),O}function U(O,ee,re){var oe=[],_e,ue,Ce,me;if(!O.range)throw new Error("attachComments needs range information");if(!re.length){if(ee.length){for(Ce=0,ue=ee.length;Ce<ue;Ce+=1)_e=f(ee[Ce]),_e.extendedRange=[0,O.range[0]],oe.push(_e);O.leadingComments=oe}return O}for(Ce=0,ue=ee.length;Ce<ue;Ce+=1)oe.push(ie(f(ee[Ce]),re));return me=0,I(O,{enter:function(he){for(var ve;me<oe.length&&(ve=oe[me],!(ve.extendedRange[1]>he.range[0]));)ve.extendedRange[1]===he.range[0]?(he.leadingComments||(he.leadingComments=[]),he.leadingComments.push(ve),oe.splice(me,1)):me+=1;if(me===oe.length)return u.Break;if(oe[me].extendedRange[0]>he.range[1])return u.Skip}}),me=0,I(O,{leave:function(he){for(var ve;me<oe.length&&(ve=oe[me],!(he.range[1]<ve.extendedRange[0]));)he.range[1]===ve.extendedRange[0]?(he.trailingComments||(he.trailingComments=[]),he.trailingComments.push(ve),oe.splice(me,1)):me+=1;if(me===oe.length)return u.Break;if(oe[me].extendedRange[0]>he.range[1])return u.Skip}}),O}return o.Syntax=a,o.traverse=I,o.replace=z,o.attachComments=U,o.VisitorKeys=l,o.VisitorOption=u,o.Controller=S,o.cloneEnvironment=function(){return t({})},o})(e)})(estraverse)),estraverse}var utils={},ast={exports:{}},hasRequiredAst;function requireAst(){return hasRequiredAst||(hasRequiredAst=1,(function(){function e(p){if(p==null)return!1;switch(p.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(p){if(p==null)return!1;switch(p.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function o(p){if(p==null)return!1;switch(p.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function a(p){return o(p)||p!=null&&p.type==="FunctionDeclaration"}function u(p){switch(p.type){case"IfStatement":return p.alternate!=null?p.alternate:p.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return p.body}return null}function l(p){var d;if(p.type!=="IfStatement"||p.alternate==null)return!1;d=p.consequent;do{if(d.type==="IfStatement"&&d.alternate==null)return!0;d=u(d)}while(d);return!1}ast.exports={isExpression:e,isStatement:o,isIterationStatement:t,isSourceElement:a,isProblematicIfStatement:l,trailingStatement:u}})()),ast.exports}var code={exports:{}},hasRequiredCode;function requireCode(){return hasRequiredCode||(hasRequiredCode=1,(function(){var e,t,o,a,u,l;t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function p(R){return 48<=R&&R<=57}function d(R){return 48<=R&&R<=57||97<=R&&R<=102||65<=R&&R<=70}function g(R){return R>=48&&R<=55}o=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function f(R){return R===32||R===9||R===11||R===12||R===160||R>=5760&&o.indexOf(R)>=0}function A(R){return R===10||R===13||R===8232||R===8233}function b(R){if(R<=65535)return String.fromCharCode(R);var I=String.fromCharCode(Math.floor((R-65536)/1024)+55296),z=String.fromCharCode((R-65536)%1024+56320);return I+z}for(a=new Array(128),l=0;l<128;++l)a[l]=l>=97&&l<=122||l>=65&&l<=90||l===36||l===95;for(u=new Array(128),l=0;l<128;++l)u[l]=l>=97&&l<=122||l>=65&&l<=90||l>=48&&l<=57||l===36||l===95;function F(R){return R<128?a[R]:t.NonAsciiIdentifierStart.test(b(R))}function S(R){return R<128?u[R]:t.NonAsciiIdentifierPart.test(b(R))}function k(R){return R<128?a[R]:e.NonAsciiIdentifierStart.test(b(R))}function $(R){return R<128?u[R]:e.NonAsciiIdentifierPart.test(b(R))}code.exports={isDecimalDigit:p,isHexDigit:d,isOctalDigit:g,isWhiteSpace:f,isLineTerminator:A,isIdentifierStartES5:F,isIdentifierPartES5:S,isIdentifierStartES6:k,isIdentifierPartES6:$}})()),code.exports}var keyword={exports:{}},hasRequiredKeyword;function requireKeyword(){return hasRequiredKeyword||(hasRequiredKeyword=1,(function(){var e=requireCode();function t(F){switch(F){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function o(F,S){return!S&&F==="yield"?!1:a(F,S)}function a(F,S){if(S&&t(F))return!0;switch(F.length){case 2:return F==="if"||F==="in"||F==="do";case 3:return F==="var"||F==="for"||F==="new"||F==="try";case 4:return F==="this"||F==="else"||F==="case"||F==="void"||F==="with"||F==="enum";case 5:return F==="while"||F==="break"||F==="catch"||F==="throw"||F==="const"||F==="yield"||F==="class"||F==="super";case 6:return F==="return"||F==="typeof"||F==="delete"||F==="switch"||F==="export"||F==="import";case 7:return F==="default"||F==="finally"||F==="extends";case 8:return F==="function"||F==="continue"||F==="debugger";case 10:return F==="instanceof";default:return!1}}function u(F,S){return F==="null"||F==="true"||F==="false"||o(F,S)}function l(F,S){return F==="null"||F==="true"||F==="false"||a(F,S)}function p(F){return F==="eval"||F==="arguments"}function d(F){var S,k,$;if(F.length===0||($=F.charCodeAt(0),!e.isIdentifierStartES5($)))return!1;for(S=1,k=F.length;S<k;++S)if($=F.charCodeAt(S),!e.isIdentifierPartES5($))return!1;return!0}function g(F,S){return(F-55296)*1024+(S-56320)+65536}function f(F){var S,k,$,R,I;if(F.length===0)return!1;for(I=e.isIdentifierStartES6,S=0,k=F.length;S<k;++S){if($=F.charCodeAt(S),55296<=$&&$<=56319){if(++S,S>=k||(R=F.charCodeAt(S),!(56320<=R&&R<=57343)))return!1;$=g($,R)}if(!I($))return!1;I=e.isIdentifierPartES6}return!0}function A(F,S){return d(F)&&!u(F,S)}function b(F,S){return f(F)&&!l(F,S)}keyword.exports={isKeywordES5:o,isKeywordES6:a,isReservedWordES5:u,isReservedWordES6:l,isRestrictedWord:p,isIdentifierNameES5:d,isIdentifierNameES6:f,isIdentifierES5:A,isIdentifierES6:b}})()),keyword.exports}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(){utils.ast=requireAst(),utils.code=requireCode(),utils.keyword=requireKeyword()})()),utils}var sourceMap={},sourceMapGenerator={},base64Vlq={},base64={},hasRequiredBase64;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},base64.decode=function(t){var o=65,a=90,u=97,l=122,p=48,d=57,g=43,f=47,A=26,b=52;return o<=t&&t<=a?t-o:u<=t&&t<=l?t-u+A:p<=t&&t<=d?t-p+b:t==g?62:t==f?63:-1},base64}var hasRequiredBase64Vlq;function requireBase64Vlq(){if(hasRequiredBase64Vlq)return base64Vlq;hasRequiredBase64Vlq=1;var e=requireBase64(),t=5,o=1<<t,a=o-1,u=o;function l(d){return d<0?(-d<<1)+1:(d<<1)+0}function p(d){var g=(d&1)===1,f=d>>1;return g?-f:f}return base64Vlq.encode=function(g){var f="",A,b=l(g);do A=b&a,b>>>=t,b>0&&(A|=u),f+=e.encode(A);while(b>0);return f},base64Vlq.decode=function(g,f,A){var b=g.length,F=0,S=0,k,$;do{if(f>=b)throw new Error("Expected more digits in base 64 VLQ value.");if($=e.decode(g.charCodeAt(f++)),$===-1)throw new Error("Invalid base64 digit: "+g.charAt(f-1));k=!!($&u),$&=a,F=F+($<<S),S+=t}while(k);A.value=p(F),A.rest=f},base64Vlq}var util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(e){function t(U,O,ee){if(O in U)return U[O];if(arguments.length===3)return ee;throw new Error('"'+O+'" is a required argument.')}e.getArg=t;var o=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,a=/^data:.+\,.+$/;function u(U){var O=U.match(o);return O?{scheme:O[1],auth:O[2],host:O[3],port:O[4],path:O[5]}:null}e.urlParse=u;function l(U){var O="";return U.scheme&&(O+=U.scheme+":"),O+="//",U.auth&&(O+=U.auth+"@"),U.host&&(O+=U.host),U.port&&(O+=":"+U.port),U.path&&(O+=U.path),O}e.urlGenerate=l;function p(U){var O=U,ee=u(U);if(ee){if(!ee.path)return U;O=ee.path}for(var re=e.isAbsolute(O),oe=O.split(/\/+/),_e,ue=0,Ce=oe.length-1;Ce>=0;Ce--)_e=oe[Ce],_e==="."?oe.splice(Ce,1):_e===".."?ue++:ue>0&&(_e===""?(oe.splice(Ce+1,ue),ue=0):(oe.splice(Ce,2),ue--));return O=oe.join("/"),O===""&&(O=re?"/":"."),ee?(ee.path=O,l(ee)):O}e.normalize=p;function d(U,O){U===""&&(U="."),O===""&&(O=".");var ee=u(O),re=u(U);if(re&&(U=re.path||"/"),ee&&!ee.scheme)return re&&(ee.scheme=re.scheme),l(ee);if(ee||O.match(a))return O;if(re&&!re.host&&!re.path)return re.host=O,l(re);var oe=O.charAt(0)==="/"?O:p(U.replace(/\/+$/,"")+"/"+O);return re?(re.path=oe,l(re)):oe}e.join=d,e.isAbsolute=function(U){return U.charAt(0)==="/"||o.test(U)};function g(U,O){U===""&&(U="."),U=U.replace(/\/$/,"");for(var ee=0;O.indexOf(U+"/")!==0;){var re=U.lastIndexOf("/");if(re<0||(U=U.slice(0,re),U.match(/^([^\/]+:\/)?\/*$/)))return O;++ee}return Array(ee+1).join("../")+O.substr(U.length+1)}e.relative=g;var f=(function(){var U=Object.create(null);return!("__proto__"in U)})();function A(U){return U}function b(U){return S(U)?"$"+U:U}e.toSetString=f?A:b;function F(U){return S(U)?U.slice(1):U}e.fromSetString=f?A:F;function S(U){if(!U)return!1;var O=U.length;if(O<9||U.charCodeAt(O-1)!==95||U.charCodeAt(O-2)!==95||U.charCodeAt(O-3)!==111||U.charCodeAt(O-4)!==116||U.charCodeAt(O-5)!==111||U.charCodeAt(O-6)!==114||U.charCodeAt(O-7)!==112||U.charCodeAt(O-8)!==95||U.charCodeAt(O-9)!==95)return!1;for(var ee=O-10;ee>=0;ee--)if(U.charCodeAt(ee)!==36)return!1;return!0}function k(U,O,ee){var re=R(U.source,O.source);return re!==0||(re=U.originalLine-O.originalLine,re!==0)||(re=U.originalColumn-O.originalColumn,re!==0||ee)||(re=U.generatedColumn-O.generatedColumn,re!==0)||(re=U.generatedLine-O.generatedLine,re!==0)?re:R(U.name,O.name)}e.compareByOriginalPositions=k;function $(U,O,ee){var re=U.generatedLine-O.generatedLine;return re!==0||(re=U.generatedColumn-O.generatedColumn,re!==0||ee)||(re=R(U.source,O.source),re!==0)||(re=U.originalLine-O.originalLine,re!==0)||(re=U.originalColumn-O.originalColumn,re!==0)?re:R(U.name,O.name)}e.compareByGeneratedPositionsDeflated=$;function R(U,O){return U===O?0:U===null?1:O===null?-1:U>O?1:-1}function I(U,O){var ee=U.generatedLine-O.generatedLine;return ee!==0||(ee=U.generatedColumn-O.generatedColumn,ee!==0)||(ee=R(U.source,O.source),ee!==0)||(ee=U.originalLine-O.originalLine,ee!==0)||(ee=U.originalColumn-O.originalColumn,ee!==0)?ee:R(U.name,O.name)}e.compareByGeneratedPositionsInflated=I;function z(U){return JSON.parse(U.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=z;function ie(U,O,ee){if(O=O||"",U&&(U[U.length-1]!=="/"&&O[0]!=="/"&&(U+="/"),O=U+O),ee){var re=u(ee);if(!re)throw new Error("sourceMapURL could not be parsed");if(re.path){var oe=re.path.lastIndexOf("/");oe>=0&&(re.path=re.path.substring(0,oe+1))}O=d(l(re),O)}return p(O)}e.computeSourceURL=ie})(util)),util}var arraySet={},hasRequiredArraySet;function requireArraySet(){if(hasRequiredArraySet)return arraySet;hasRequiredArraySet=1;var e=requireUtil(),t=Object.prototype.hasOwnProperty,o=typeof Map<"u";function a(){this._array=[],this._set=o?new Map:Object.create(null)}return a.fromArray=function(l,p){for(var d=new a,g=0,f=l.length;g<f;g++)d.add(l[g],p);return d},a.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},a.prototype.add=function(l,p){var d=o?l:e.toSetString(l),g=o?this.has(l):t.call(this._set,d),f=this._array.length;(!g||p)&&this._array.push(l),g||(o?this._set.set(l,f):this._set[d]=f)},a.prototype.has=function(l){if(o)return this._set.has(l);var p=e.toSetString(l);return t.call(this._set,p)},a.prototype.indexOf=function(l){if(o){var p=this._set.get(l);if(p>=0)return p}else{var d=e.toSetString(l);if(t.call(this._set,d))return this._set[d]}throw new Error('"'+l+'" is not in the set.')},a.prototype.at=function(l){if(l>=0&&l<this._array.length)return this._array[l];throw new Error("No element indexed by "+l)},a.prototype.toArray=function(){return this._array.slice()},arraySet.ArraySet=a,arraySet}var mappingList={},hasRequiredMappingList;function requireMappingList(){if(hasRequiredMappingList)return mappingList;hasRequiredMappingList=1;var e=requireUtil();function t(a,u){var l=a.generatedLine,p=u.generatedLine,d=a.generatedColumn,g=u.generatedColumn;return p>l||p==l&&g>=d||e.compareByGeneratedPositionsInflated(a,u)<=0}function o(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return o.prototype.unsortedForEach=function(u,l){this._array.forEach(u,l)},o.prototype.add=function(u){t(this._last,u)?(this._last=u,this._array.push(u)):(this._sorted=!1,this._array.push(u))},o.prototype.toArray=function(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},mappingList.MappingList=o,mappingList}var hasRequiredSourceMapGenerator;function requireSourceMapGenerator(){if(hasRequiredSourceMapGenerator)return sourceMapGenerator;hasRequiredSourceMapGenerator=1;var e=requireBase64Vlq(),t=requireUtil(),o=requireArraySet().ArraySet,a=requireMappingList().MappingList;function u(l){l||(l={}),this._file=t.getArg(l,"file",null),this._sourceRoot=t.getArg(l,"sourceRoot",null),this._skipValidation=t.getArg(l,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new a,this._sourcesContents=null}return u.prototype._version=3,u.fromSourceMap=function(p){var d=p.sourceRoot,g=new u({file:p.file,sourceRoot:d});return p.eachMapping(function(f){var A={generated:{line:f.generatedLine,column:f.generatedColumn}};f.source!=null&&(A.source=f.source,d!=null&&(A.source=t.relative(d,A.source)),A.original={line:f.originalLine,column:f.originalColumn},f.name!=null&&(A.name=f.name)),g.addMapping(A)}),p.sources.forEach(function(f){var A=f;d!==null&&(A=t.relative(d,f)),g._sources.has(A)||g._sources.add(A);var b=p.sourceContentFor(f);b!=null&&g.setSourceContent(f,b)}),g},u.prototype.addMapping=function(p){var d=t.getArg(p,"generated"),g=t.getArg(p,"original",null),f=t.getArg(p,"source",null),A=t.getArg(p,"name",null);this._skipValidation||this._validateMapping(d,g,f,A),f!=null&&(f=String(f),this._sources.has(f)||this._sources.add(f)),A!=null&&(A=String(A),this._names.has(A)||this._names.add(A)),this._mappings.add({generatedLine:d.line,generatedColumn:d.column,originalLine:g!=null&&g.line,originalColumn:g!=null&&g.column,source:f,name:A})},u.prototype.setSourceContent=function(p,d){var g=p;this._sourceRoot!=null&&(g=t.relative(this._sourceRoot,g)),d!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(g)]=d):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(g)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},u.prototype.applySourceMap=function(p,d,g){var f=d;if(d==null){if(p.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);f=p.file}var A=this._sourceRoot;A!=null&&(f=t.relative(A,f));var b=new o,F=new o;this._mappings.unsortedForEach(function(S){if(S.source===f&&S.originalLine!=null){var k=p.originalPositionFor({line:S.originalLine,column:S.originalColumn});k.source!=null&&(S.source=k.source,g!=null&&(S.source=t.join(g,S.source)),A!=null&&(S.source=t.relative(A,S.source)),S.originalLine=k.line,S.originalColumn=k.column,k.name!=null&&(S.name=k.name))}var $=S.source;$!=null&&!b.has($)&&b.add($);var R=S.name;R!=null&&!F.has(R)&&F.add(R)},this),this._sources=b,this._names=F,p.sources.forEach(function(S){var k=p.sourceContentFor(S);k!=null&&(g!=null&&(S=t.join(g,S)),A!=null&&(S=t.relative(A,S)),this.setSourceContent(S,k))},this)},u.prototype._validateMapping=function(p,d,g,f){if(d&&typeof d.line!="number"&&typeof d.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(p&&"line"in p&&"column"in p&&p.line>0&&p.column>=0&&!d&&!g&&!f)){if(p&&"line"in p&&"column"in p&&d&&"line"in d&&"column"in d&&p.line>0&&p.column>=0&&d.line>0&&d.column>=0&&g)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:p,source:g,original:d,name:f}))}},u.prototype._serializeMappings=function(){for(var p=0,d=1,g=0,f=0,A=0,b=0,F="",S,k,$,R,I=this._mappings.toArray(),z=0,ie=I.length;z<ie;z++){if(k=I[z],S="",k.generatedLine!==d)for(p=0;k.generatedLine!==d;)S+=";",d++;else if(z>0){if(!t.compareByGeneratedPositionsInflated(k,I[z-1]))continue;S+=","}S+=e.encode(k.generatedColumn-p),p=k.generatedColumn,k.source!=null&&(R=this._sources.indexOf(k.source),S+=e.encode(R-b),b=R,S+=e.encode(k.originalLine-1-f),f=k.originalLine-1,S+=e.encode(k.originalColumn-g),g=k.originalColumn,k.name!=null&&($=this._names.indexOf(k.name),S+=e.encode($-A),A=$)),F+=S}return F},u.prototype._generateSourcesContent=function(p,d){return p.map(function(g){if(!this._sourcesContents)return null;d!=null&&(g=t.relative(d,g));var f=t.toSetString(g);return Object.prototype.hasOwnProperty.call(this._sourcesContents,f)?this._sourcesContents[f]:null},this)},u.prototype.toJSON=function(){var p={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(p.file=this._file),this._sourceRoot!=null&&(p.sourceRoot=this._sourceRoot),this._sourcesContents&&(p.sourcesContent=this._generateSourcesContent(p.sources,p.sourceRoot)),p},u.prototype.toString=function(){return JSON.stringify(this.toJSON())},sourceMapGenerator.SourceMapGenerator=u,sourceMapGenerator}var sourceMapConsumer={},binarySearch={},hasRequiredBinarySearch;function requireBinarySearch(){return hasRequiredBinarySearch||(hasRequiredBinarySearch=1,(function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(o,a,u,l,p,d){var g=Math.floor((a-o)/2)+o,f=p(u,l[g],!0);return f===0?g:f>0?a-g>1?t(g,a,u,l,p,d):d==e.LEAST_UPPER_BOUND?a<l.length?a:-1:g:g-o>1?t(o,g,u,l,p,d):d==e.LEAST_UPPER_BOUND?g:o<0?-1:o}e.search=function(a,u,l,p){if(u.length===0)return-1;var d=t(-1,u.length,a,u,l,p||e.GREATEST_LOWER_BOUND);if(d<0)return-1;for(;d-1>=0&&l(u[d],u[d-1],!0)===0;)--d;return d}})(binarySearch)),binarySearch}var quickSort={},hasRequiredQuickSort;function requireQuickSort(){if(hasRequiredQuickSort)return quickSort;hasRequiredQuickSort=1;function e(a,u,l){var p=a[u];a[u]=a[l],a[l]=p}function t(a,u){return Math.round(a+Math.random()*(u-a))}function o(a,u,l,p){if(l<p){var d=t(l,p),g=l-1;e(a,d,p);for(var f=a[p],A=l;A<p;A++)u(a[A],f)<=0&&(g+=1,e(a,g,A));e(a,g+1,A);var b=g+1;o(a,u,l,b-1),o(a,u,b+1,p)}}return quickSort.quickSort=function(a,u){o(a,u,0,a.length-1)},quickSort}var hasRequiredSourceMapConsumer;function requireSourceMapConsumer(){if(hasRequiredSourceMapConsumer)return sourceMapConsumer;hasRequiredSourceMapConsumer=1;var e=requireUtil(),t=requireBinarySearch(),o=requireArraySet().ArraySet,a=requireBase64Vlq(),u=requireQuickSort().quickSort;function l(f,A){var b=f;return typeof f=="string"&&(b=e.parseSourceMapInput(f)),b.sections!=null?new g(b,A):new p(b,A)}l.fromSourceMap=function(f,A){return p.fromSourceMap(f,A)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(A,b){var F=A.charAt(b);return F===";"||F===","},l.prototype._parseMappings=function(A,b){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(A,b,F){var S=b||null,k=F||l.GENERATED_ORDER,$;switch(k){case l.GENERATED_ORDER:$=this._generatedMappings;break;case l.ORIGINAL_ORDER:$=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var R=this.sourceRoot;$.map(function(I){var z=I.source===null?null:this._sources.at(I.source);return z=e.computeSourceURL(R,z,this._sourceMapURL),{source:z,generatedLine:I.generatedLine,generatedColumn:I.generatedColumn,originalLine:I.originalLine,originalColumn:I.originalColumn,name:I.name===null?null:this._names.at(I.name)}},this).forEach(A,S)},l.prototype.allGeneratedPositionsFor=function(A){var b=e.getArg(A,"line"),F={source:e.getArg(A,"source"),originalLine:b,originalColumn:e.getArg(A,"column",0)};if(F.source=this._findSourceIndex(F.source),F.source<0)return[];var S=[],k=this._findMapping(F,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(k>=0){var $=this._originalMappings[k];if(A.column===void 0)for(var R=$.originalLine;$&&$.originalLine===R;)S.push({line:e.getArg($,"generatedLine",null),column:e.getArg($,"generatedColumn",null),lastColumn:e.getArg($,"lastGeneratedColumn",null)}),$=this._originalMappings[++k];else for(var I=$.originalColumn;$&&$.originalLine===b&&$.originalColumn==I;)S.push({line:e.getArg($,"generatedLine",null),column:e.getArg($,"generatedColumn",null),lastColumn:e.getArg($,"lastGeneratedColumn",null)}),$=this._originalMappings[++k]}return S},sourceMapConsumer.SourceMapConsumer=l;function p(f,A){var b=f;typeof f=="string"&&(b=e.parseSourceMapInput(f));var F=e.getArg(b,"version"),S=e.getArg(b,"sources"),k=e.getArg(b,"names",[]),$=e.getArg(b,"sourceRoot",null),R=e.getArg(b,"sourcesContent",null),I=e.getArg(b,"mappings"),z=e.getArg(b,"file",null);if(F!=this._version)throw new Error("Unsupported version: "+F);$&&($=e.normalize($)),S=S.map(String).map(e.normalize).map(function(ie){return $&&e.isAbsolute($)&&e.isAbsolute(ie)?e.relative($,ie):ie}),this._names=o.fromArray(k.map(String),!0),this._sources=o.fromArray(S,!0),this._absoluteSources=this._sources.toArray().map(function(ie){return e.computeSourceURL($,ie,A)}),this.sourceRoot=$,this.sourcesContent=R,this._mappings=I,this._sourceMapURL=A,this.file=z}p.prototype=Object.create(l.prototype),p.prototype.consumer=l,p.prototype._findSourceIndex=function(f){var A=f;if(this.sourceRoot!=null&&(A=e.relative(this.sourceRoot,A)),this._sources.has(A))return this._sources.indexOf(A);var b;for(b=0;b<this._absoluteSources.length;++b)if(this._absoluteSources[b]==f)return b;return-1},p.fromSourceMap=function(A,b){var F=Object.create(p.prototype),S=F._names=o.fromArray(A._names.toArray(),!0),k=F._sources=o.fromArray(A._sources.toArray(),!0);F.sourceRoot=A._sourceRoot,F.sourcesContent=A._generateSourcesContent(F._sources.toArray(),F.sourceRoot),F.file=A._file,F._sourceMapURL=b,F._absoluteSources=F._sources.toArray().map(function(ee){return e.computeSourceURL(F.sourceRoot,ee,b)});for(var $=A._mappings.toArray().slice(),R=F.__generatedMappings=[],I=F.__originalMappings=[],z=0,ie=$.length;z<ie;z++){var U=$[z],O=new d;O.generatedLine=U.generatedLine,O.generatedColumn=U.generatedColumn,U.source&&(O.source=k.indexOf(U.source),O.originalLine=U.originalLine,O.originalColumn=U.originalColumn,U.name&&(O.name=S.indexOf(U.name)),I.push(O)),R.push(O)}return u(F.__originalMappings,e.compareByOriginalPositions),F},p.prototype._version=3,Object.defineProperty(p.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function d(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}p.prototype._parseMappings=function(A,b){for(var F=1,S=0,k=0,$=0,R=0,I=0,z=A.length,ie=0,U={},O={},ee=[],re=[],oe,_e,ue,Ce,me;ie<z;)if(A.charAt(ie)===";")F++,ie++,S=0;else if(A.charAt(ie)===",")ie++;else{for(oe=new d,oe.generatedLine=F,Ce=ie;Ce<z&&!this._charIsMappingSeparator(A,Ce);Ce++);if(_e=A.slice(ie,Ce),ue=U[_e],ue)ie+=_e.length;else{for(ue=[];ie<Ce;)a.decode(A,ie,O),me=O.value,ie=O.rest,ue.push(me);if(ue.length===2)throw new Error("Found a source, but no line and column");if(ue.length===3)throw new Error("Found a source and line, but no column");U[_e]=ue}oe.generatedColumn=S+ue[0],S=oe.generatedColumn,ue.length>1&&(oe.source=R+ue[1],R+=ue[1],oe.originalLine=k+ue[2],k=oe.originalLine,oe.originalLine+=1,oe.originalColumn=$+ue[3],$=oe.originalColumn,ue.length>4&&(oe.name=I+ue[4],I+=ue[4])),re.push(oe),typeof oe.originalLine=="number"&&ee.push(oe)}u(re,e.compareByGeneratedPositionsDeflated),this.__generatedMappings=re,u(ee,e.compareByOriginalPositions),this.__originalMappings=ee},p.prototype._findMapping=function(A,b,F,S,k,$){if(A[F]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+A[F]);if(A[S]<0)throw new TypeError("Column must be greater than or equal to 0, got "+A[S]);return t.search(A,b,k,$)},p.prototype.computeColumnSpans=function(){for(var A=0;A<this._generatedMappings.length;++A){var b=this._generatedMappings[A];if(A+1<this._generatedMappings.length){var F=this._generatedMappings[A+1];if(b.generatedLine===F.generatedLine){b.lastGeneratedColumn=F.generatedColumn-1;continue}}b.lastGeneratedColumn=1/0}},p.prototype.originalPositionFor=function(A){var b={generatedLine:e.getArg(A,"line"),generatedColumn:e.getArg(A,"column")},F=this._findMapping(b,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositionsDeflated,e.getArg(A,"bias",l.GREATEST_LOWER_BOUND));if(F>=0){var S=this._generatedMappings[F];if(S.generatedLine===b.generatedLine){var k=e.getArg(S,"source",null);k!==null&&(k=this._sources.at(k),k=e.computeSourceURL(this.sourceRoot,k,this._sourceMapURL));var $=e.getArg(S,"name",null);return $!==null&&($=this._names.at($)),{source:k,line:e.getArg(S,"originalLine",null),column:e.getArg(S,"originalColumn",null),name:$}}}return{source:null,line:null,column:null,name:null}},p.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(A){return A==null}):!1},p.prototype.sourceContentFor=function(A,b){if(!this.sourcesContent)return null;var F=this._findSourceIndex(A);if(F>=0)return this.sourcesContent[F];var S=A;this.sourceRoot!=null&&(S=e.relative(this.sourceRoot,S));var k;if(this.sourceRoot!=null&&(k=e.urlParse(this.sourceRoot))){var $=S.replace(/^file:\/\//,"");if(k.scheme=="file"&&this._sources.has($))return this.sourcesContent[this._sources.indexOf($)];if((!k.path||k.path=="/")&&this._sources.has("/"+S))return this.sourcesContent[this._sources.indexOf("/"+S)]}if(b)return null;throw new Error('"'+S+'" is not in the SourceMap.')},p.prototype.generatedPositionFor=function(A){var b=e.getArg(A,"source");if(b=this._findSourceIndex(b),b<0)return{line:null,column:null,lastColumn:null};var F={source:b,originalLine:e.getArg(A,"line"),originalColumn:e.getArg(A,"column")},S=this._findMapping(F,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,e.getArg(A,"bias",l.GREATEST_LOWER_BOUND));if(S>=0){var k=this._originalMappings[S];if(k.source===F.source)return{line:e.getArg(k,"generatedLine",null),column:e.getArg(k,"generatedColumn",null),lastColumn:e.getArg(k,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},sourceMapConsumer.BasicSourceMapConsumer=p;function g(f,A){var b=f;typeof f=="string"&&(b=e.parseSourceMapInput(f));var F=e.getArg(b,"version"),S=e.getArg(b,"sections");if(F!=this._version)throw new Error("Unsupported version: "+F);this._sources=new o,this._names=new o;var k={line:-1,column:0};this._sections=S.map(function($){if($.url)throw new Error("Support for url field in sections not implemented.");var R=e.getArg($,"offset"),I=e.getArg(R,"line"),z=e.getArg(R,"column");if(I<k.line||I===k.line&&z<k.column)throw new Error("Section offsets must be ordered and non-overlapping.");return k=R,{generatedOffset:{generatedLine:I+1,generatedColumn:z+1},consumer:new l(e.getArg($,"map"),A)}})}return g.prototype=Object.create(l.prototype),g.prototype.constructor=l,g.prototype._version=3,Object.defineProperty(g.prototype,"sources",{get:function(){for(var f=[],A=0;A<this._sections.length;A++)for(var b=0;b<this._sections[A].consumer.sources.length;b++)f.push(this._sections[A].consumer.sources[b]);return f}}),g.prototype.originalPositionFor=function(A){var b={generatedLine:e.getArg(A,"line"),generatedColumn:e.getArg(A,"column")},F=t.search(b,this._sections,function(k,$){var R=k.generatedLine-$.generatedOffset.generatedLine;return R||k.generatedColumn-$.generatedOffset.generatedColumn}),S=this._sections[F];return S?S.consumer.originalPositionFor({line:b.generatedLine-(S.generatedOffset.generatedLine-1),column:b.generatedColumn-(S.generatedOffset.generatedLine===b.generatedLine?S.generatedOffset.generatedColumn-1:0),bias:A.bias}):{source:null,line:null,column:null,name:null}},g.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(A){return A.consumer.hasContentsOfAllSources()})},g.prototype.sourceContentFor=function(A,b){for(var F=0;F<this._sections.length;F++){var S=this._sections[F],k=S.consumer.sourceContentFor(A,!0);if(k)return k}if(b)return null;throw new Error('"'+A+'" is not in the SourceMap.')},g.prototype.generatedPositionFor=function(A){for(var b=0;b<this._sections.length;b++){var F=this._sections[b];if(F.consumer._findSourceIndex(e.getArg(A,"source"))!==-1){var S=F.consumer.generatedPositionFor(A);if(S){var k={line:S.line+(F.generatedOffset.generatedLine-1),column:S.column+(F.generatedOffset.generatedLine===S.line?F.generatedOffset.generatedColumn-1:0)};return k}}}return{line:null,column:null}},g.prototype._parseMappings=function(A,b){this.__generatedMappings=[],this.__originalMappings=[];for(var F=0;F<this._sections.length;F++)for(var S=this._sections[F],k=S.consumer._generatedMappings,$=0;$<k.length;$++){var R=k[$],I=S.consumer._sources.at(R.source);I=e.computeSourceURL(S.consumer.sourceRoot,I,this._sourceMapURL),this._sources.add(I),I=this._sources.indexOf(I);var z=null;R.name&&(z=S.consumer._names.at(R.name),this._names.add(z),z=this._names.indexOf(z));var ie={source:I,generatedLine:R.generatedLine+(S.generatedOffset.generatedLine-1),generatedColumn:R.generatedColumn+(S.generatedOffset.generatedLine===R.generatedLine?S.generatedOffset.generatedColumn-1:0),originalLine:R.originalLine,originalColumn:R.originalColumn,name:z};this.__generatedMappings.push(ie),typeof ie.originalLine=="number"&&this.__originalMappings.push(ie)}u(this.__generatedMappings,e.compareByGeneratedPositionsDeflated),u(this.__originalMappings,e.compareByOriginalPositions)},sourceMapConsumer.IndexedSourceMapConsumer=g,sourceMapConsumer}var sourceNode={},hasRequiredSourceNode;function requireSourceNode(){if(hasRequiredSourceNode)return sourceNode;hasRequiredSourceNode=1;var e=requireSourceMapGenerator().SourceMapGenerator,t=requireUtil(),o=/(\r?\n)/,a=10,u="$$$isSourceNode$$$";function l(p,d,g,f,A){this.children=[],this.sourceContents={},this.line=p??null,this.column=d??null,this.source=g??null,this.name=A??null,this[u]=!0,f!=null&&this.add(f)}return l.fromStringWithSourceMap=function(d,g,f){var A=new l,b=d.split(o),F=0,S=function(){var z=U(),ie=U()||"";return z+ie;function U(){return F<b.length?b[F++]:void 0}},k=1,$=0,R=null;return g.eachMapping(function(z){if(R!==null)if(k<z.generatedLine)I(R,S()),k++,$=0;else{var ie=b[F]||"",U=ie.substr(0,z.generatedColumn-$);b[F]=ie.substr(z.generatedColumn-$),$=z.generatedColumn,I(R,U),R=z;return}for(;k<z.generatedLine;)A.add(S()),k++;if($<z.generatedColumn){var ie=b[F]||"";A.add(ie.substr(0,z.generatedColumn)),b[F]=ie.substr(z.generatedColumn),$=z.generatedColumn}R=z},this),F<b.length&&(R&&I(R,S()),A.add(b.splice(F).join(""))),g.sources.forEach(function(z){var ie=g.sourceContentFor(z);ie!=null&&(f!=null&&(z=t.join(f,z)),A.setSourceContent(z,ie))}),A;function I(z,ie){if(z===null||z.source===void 0)A.add(ie);else{var U=f?t.join(f,z.source):z.source;A.add(new l(z.originalLine,z.originalColumn,U,ie,z.name))}}},l.prototype.add=function(d){if(Array.isArray(d))d.forEach(function(g){this.add(g)},this);else if(d[u]||typeof d=="string")d&&this.children.push(d);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+d);return this},l.prototype.prepend=function(d){if(Array.isArray(d))for(var g=d.length-1;g>=0;g--)this.prepend(d[g]);else if(d[u]||typeof d=="string")this.children.unshift(d);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+d);return this},l.prototype.walk=function(d){for(var g,f=0,A=this.children.length;f<A;f++)g=this.children[f],g[u]?g.walk(d):g!==""&&d(g,{source:this.source,line:this.line,column:this.column,name:this.name})},l.prototype.join=function(d){var g,f,A=this.children.length;if(A>0){for(g=[],f=0;f<A-1;f++)g.push(this.children[f]),g.push(d);g.push(this.children[f]),this.children=g}return this},l.prototype.replaceRight=function(d,g){var f=this.children[this.children.length-1];return f[u]?f.replaceRight(d,g):typeof f=="string"?this.children[this.children.length-1]=f.replace(d,g):this.children.push("".replace(d,g)),this},l.prototype.setSourceContent=function(d,g){this.sourceContents[t.toSetString(d)]=g},l.prototype.walkSourceContents=function(d){for(var g=0,f=this.children.length;g<f;g++)this.children[g][u]&&this.children[g].walkSourceContents(d);for(var A=Object.keys(this.sourceContents),g=0,f=A.length;g<f;g++)d(t.fromSetString(A[g]),this.sourceContents[A[g]])},l.prototype.toString=function(){var d="";return this.walk(function(g){d+=g}),d},l.prototype.toStringWithSourceMap=function(d){var g={code:"",line:1,column:0},f=new e(d),A=!1,b=null,F=null,S=null,k=null;return this.walk(function($,R){g.code+=$,R.source!==null&&R.line!==null&&R.column!==null?((b!==R.source||F!==R.line||S!==R.column||k!==R.name)&&f.addMapping({source:R.source,original:{line:R.line,column:R.column},generated:{line:g.line,column:g.column},name:R.name}),b=R.source,F=R.line,S=R.column,k=R.name,A=!0):A&&(f.addMapping({generated:{line:g.line,column:g.column}}),b=null,A=!1);for(var I=0,z=$.length;I<z;I++)$.charCodeAt(I)===a?(g.line++,g.column=0,I+1===z?(b=null,A=!1):A&&f.addMapping({source:R.source,original:{line:R.line,column:R.column},generated:{line:g.line,column:g.column},name:R.name})):g.column++}),this.walkSourceContents(function($,R){f.setSourceContent($,R)}),{code:g.code,map:f}},sourceNode.SourceNode=l,sourceNode}var hasRequiredSourceMap;function requireSourceMap(){return hasRequiredSourceMap||(hasRequiredSourceMap=1,sourceMap.SourceMapGenerator=requireSourceMapGenerator().SourceMapGenerator,sourceMap.SourceMapConsumer=requireSourceMapConsumer().SourceMapConsumer,sourceMap.SourceNode=requireSourceNode().SourceNode),sourceMap}const version="2.1.0",require$$3={version};var hasRequiredEscodegen;function requireEscodegen(){return hasRequiredEscodegen||(hasRequiredEscodegen=1,(function(e){(function(){var t,o,a,u,l,p,d,g,f,A,b,F,S,k,$,R,I,z,ie,U,O,ee,re,oe,_e,ue;l=requireEstraverse(),p=requireUtils(),t=l.Syntax;function Ce(M){return Ge.Expression.hasOwnProperty(M.type)}function me(M){return Ge.Statement.hasOwnProperty(M.type)}o={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},a={"??":o.Coalesce,"||":o.LogicalOR,"&&":o.LogicalAND,"|":o.BitwiseOR,"^":o.BitwiseXOR,"&":o.BitwiseAND,"==":o.Equality,"!=":o.Equality,"===":o.Equality,"!==":o.Equality,is:o.Equality,isnt:o.Equality,"<":o.Relational,">":o.Relational,"<=":o.Relational,">=":o.Relational,in:o.Relational,instanceof:o.Relational,"<<":o.BitwiseSHIFT,">>":o.BitwiseSHIFT,">>>":o.BitwiseSHIFT,"+":o.Additive,"-":o.Additive,"*":o.Multiplicative,"%":o.Multiplicative,"/":o.Multiplicative,"**":o.Exponentiation};var he=1,ve=2,Fe=4,Se=8,Ee=16,Pe=32,Ye=64,He=ve|Fe,et=he|ve,de=he|ve|Fe,Le=he,ot=Fe,Ve=he|Fe,Oe=he,Je=he|Pe,We=0,qe=he|Ee,yt=he|Se;function pt(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Qe(M,B){var N="";for(B|=0;B>0;B>>>=1,M+=M)B&1&&(N+=M);return N}function At(M){return/[\r\n]/g.test(M)}function it(M){var B=M.length;return B&&p.code.isLineTerminator(M.charCodeAt(B-1))}function vt(M,B){var N;for(N in B)B.hasOwnProperty(N)&&(M[N]=B[N]);return M}function at(M,B){var N,L;function Z(ae){return typeof ae=="object"&&ae instanceof Object&&!(ae instanceof RegExp)}for(N in B)B.hasOwnProperty(N)&&(L=B[N],Z(L)?Z(M[N])?at(M[N],L):M[N]=at({},L):M[N]=L);return M}function Ct(M){var B,N,L,Z,ae;if(M!==M)throw new Error("Numeric literal whose value is NaN");if(M<0||M===0&&1/M<0)throw new Error("Numeric literal whose value is negative");if(M===1/0)return f?"null":A?"1e400":"1e+400";if(B=""+M,!A||B.length<3)return B;for(N=B.indexOf("."),!f&&B.charCodeAt(0)===48&&N===1&&(N=0,B=B.slice(1)),L=B,B=B.replace("e+","e"),Z=0,(ae=L.indexOf("e"))>0&&(Z=+L.slice(ae+1),L=L.slice(0,ae)),N>=0&&(Z-=L.length-N-1,L=+(L.slice(0,N)+L.slice(N+1))+""),ae=0;L.charCodeAt(L.length+ae-1)===48;)--ae;return ae!==0&&(Z-=ae,L=L.slice(0,ae)),Z!==0&&(L+="e"+Z),(L.length<B.length||b&&M>1e12&&Math.floor(M)===M&&(L="0x"+M.toString(16)).length<B.length)&&+L===M&&(B=L),B}function Mt(M,B){return(M&-2)===8232?(B?"u":"\\u")+(M===8232?"2028":"2029"):M===10||M===13?(B?"":"\\")+(M===10?"n":"r"):String.fromCharCode(M)}function te(M){var B,N,L,Z,ae,fe,ge,xe;if(N=M.toString(),M.source){if(B=N.match(/\/([^/]*)$/),!B)return N;for(L=B[1],N="",ge=!1,xe=!1,Z=0,ae=M.source.length;Z<ae;++Z)fe=M.source.charCodeAt(Z),xe?(N+=Mt(fe,xe),xe=!1):(ge?fe===93&&(ge=!1):fe===47?N+="\\":fe===91&&(ge=!0),N+=Mt(fe,xe),xe=fe===92);return"/"+N+"/"+L}return N}function se(M,B){var N;return M===8?"\\b":M===12?"\\f":M===9?"\\t":(N=M.toString(16).toUpperCase(),f||M>255?"\\u"+"0000".slice(N.length)+N:M===0&&!p.code.isDecimalDigit(B)?"\\0":M===11?"\\x0B":"\\x"+"00".slice(N.length)+N)}function q(M){if(M===92)return"\\\\";if(M===10)return"\\n";if(M===13)return"\\r";if(M===8232)return"\\u2028";if(M===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function le(M){var B,N,L,Z;for(Z=F==="double"?'"':"'",B=0,N=M.length;B<N;++B)if(L=M.charCodeAt(B),L===39){Z='"';break}else if(L===34){Z="'";break}else L===92&&++B;return Z+M+Z}function be(M){var B="",N,L,Z,ae=0,fe=0,ge,xe;for(N=0,L=M.length;N<L;++N){if(Z=M.charCodeAt(N),Z===39)++ae;else if(Z===34)++fe;else if(Z===47&&f)B+="\\";else if(p.code.isLineTerminator(Z)||Z===92){B+=q(Z);continue}else if(!p.code.isIdentifierPartES5(Z)&&(f&&Z<32||!f&&!S&&(Z<32||Z>126))){B+=se(Z,M.charCodeAt(N+1));continue}B+=String.fromCharCode(Z)}if(ge=!(F==="double"||F==="auto"&&fe<ae),xe=ge?"'":'"',!(ge?ae:fe))return xe+B+xe;for(M=B,B=xe,N=0,L=M.length;N<L;++N)Z=M.charCodeAt(N),(Z===39&&ge||Z===34&&!ge)&&(B+="\\"),B+=String.fromCharCode(Z);return B+xe}function Me(M){var B,N,L,Z="";for(B=0,N=M.length;B<N;++B)L=M[B],Z+=Array.isArray(L)?Me(L):L;return Z}function ye(M,B){if(!ee)return Array.isArray(M)?Me(M):M;if(B==null){if(M instanceof u)return M;B={}}return B.loc==null?new u(null,null,ee,M,B.name||null):new u(B.loc.start.line,B.loc.start.column,ee===!0?B.loc.source||null:ee,M,B.name||null)}function $e(){return $||" "}function Ae(M,B){var N,L,Z,ae;return N=ye(M).toString(),N.length===0?[B]:(L=ye(B).toString(),L.length===0?[M]:(Z=N.charCodeAt(N.length-1),ae=L.charCodeAt(0),(Z===43||Z===45)&&Z===ae||p.code.isIdentifierPartES5(Z)&&p.code.isIdentifierPartES5(ae)||Z===47&&ae===105?[M,$e(),B]:p.code.isWhiteSpace(Z)||p.code.isLineTerminator(Z)||p.code.isWhiteSpace(ae)||p.code.isLineTerminator(ae)?[M,B]:[M,$,B]))}function De(M){return[d,M]}function Ne(M){var B;B=d,d+=g,M(d),d=B}function nt(M){var B;for(B=M.length-1;B>=0&&!p.code.isLineTerminator(M.charCodeAt(B));--B);return M.length-1-B}function rt(M,B){var N,L,Z,ae,fe,ge,xe,ze;for(N=M.split(/\r\n|[\r\n]/),ge=Number.MAX_VALUE,L=1,Z=N.length;L<Z;++L){for(ae=N[L],fe=0;fe<ae.length&&p.code.isWhiteSpace(ae.charCodeAt(fe));)++fe;ge>fe&&(ge=fe)}for(typeof B<"u"?(xe=d,N[1][ge]==="*"&&(B+=" "),d=B):(ge&1&&--ge,xe=d),L=1,Z=N.length;L<Z;++L)ze=ye(De(N[L].slice(ge))),N[L]=ee?ze.join(""):ze;return d=xe,N.join(`
`)}function je(M,B){if(M.type==="Line"){if(it(M.value))return"//"+M.value;var N="//"+M.value;return oe||(N+=`
`),N}return U.format.indent.adjustMultilineComment&&/[\n\r]/.test(M.value)?rt("/*"+M.value+"*/",B):"/*"+M.value+"*/"}function Xe(M,B){var N,L,Z,ae,fe,ge,xe,ze,ut,Dt,kt,Ot,Wt,xt;if(M.leadingComments&&M.leadingComments.length>0){if(ae=B,oe){for(Z=M.leadingComments[0],B=[],ze=Z.extendedRange,ut=Z.range,kt=re.substring(ze[0],ut[0]),xt=(kt.match(/\n/g)||[]).length,xt>0?(B.push(Qe(`
`,xt)),B.push(De(je(Z)))):(B.push(kt),B.push(je(Z))),Dt=ut,N=1,L=M.leadingComments.length;N<L;N++)Z=M.leadingComments[N],ut=Z.range,Ot=re.substring(Dt[1],ut[0]),xt=(Ot.match(/\n/g)||[]).length,B.push(Qe(`
`,xt)),B.push(De(je(Z))),Dt=ut;Wt=re.substring(ut[1],ze[1]),xt=(Wt.match(/\n/g)||[]).length,B.push(Qe(`
`,xt))}else for(Z=M.leadingComments[0],B=[],z&&M.type===t.Program&&M.body.length===0&&B.push(`
`),B.push(je(Z)),it(ye(B).toString())||B.push(`
`),N=1,L=M.leadingComments.length;N<L;++N)Z=M.leadingComments[N],xe=[je(Z)],it(ye(xe).toString())||xe.push(`
`),B.push(De(xe));B.push(De(ae))}if(M.trailingComments)if(oe)Z=M.trailingComments[0],ze=Z.extendedRange,ut=Z.range,kt=re.substring(ze[0],ut[0]),xt=(kt.match(/\n/g)||[]).length,xt>0?(B.push(Qe(`
`,xt)),B.push(De(je(Z)))):(B.push(kt),B.push(je(Z)));else for(fe=!it(ye(B).toString()),ge=Qe(" ",nt(ye([d,B,g]).toString())),N=0,L=M.trailingComments.length;N<L;++N)Z=M.trailingComments[N],fe?(N===0?B=[B,g]:B=[B,ge],B.push(je(Z,ge))):B=[B,De(je(Z))],N!==L-1&&!it(ye(B).toString())&&(B=[B,`
`]);return B}function ct(M,B,N){var L,Z=0;for(L=M;L<B;L++)re[L]===`
`&&Z++;for(L=1;L<Z;L++)N.push(k)}function Re(M,B,N){return B<N?["(",M,")"]:M}function ft(M){var B,N,L;for(L=M.split(/\r\n|\n/),B=1,N=L.length;B<N;B++)L[B]=k+d+L[B];return L}function ht(M,B){var N,L,Z;return N=M[U.verbatim],typeof N=="string"?L=Re(ft(N),o.Sequence,B):(L=ft(N.content),Z=N.precedence!=null?N.precedence:o.Sequence,L=Re(L,Z,B)),ye(L,M)}function Ge(){}Ge.prototype.maybeBlock=function(M,B){var N,L,Z=this;return L=!U.comment||!M.leadingComments,M.type===t.BlockStatement&&L?[$,this.generateStatement(M,B)]:M.type===t.EmptyStatement&&L?";":(Ne(function(){N=[k,De(Z.generateStatement(M,B))]}),N)},Ge.prototype.maybeBlockSuffix=function(M,B){var N=it(ye(B).toString());return M.type===t.BlockStatement&&(!U.comment||!M.leadingComments)&&!N?[B,$]:N?[B,d]:[B,k,d]};function Ze(M){return ye(M.name,M)}function Ke(M,B){return M.async?"async"+(B?$e():$):""}function tt(M){var B=M.generator&&!U.moz.starlessGenerator;return B?"*"+$:""}function mt(M){var B=M.value,N="";return B.async&&(N+=Ke(B,!M.computed)),B.generator&&(N+=tt(B)?"*":""),N}Ge.prototype.generatePattern=function(M,B,N){return M.type===t.Identifier?Ze(M):this.generateExpression(M,B,N)},Ge.prototype.generateFunctionParams=function(M){var B,N,L,Z;if(Z=!1,M.type===t.ArrowFunctionExpression&&!M.rest&&(!M.defaults||M.defaults.length===0)&&M.params.length===1&&M.params[0].type===t.Identifier)L=[Ke(M,!0),Ze(M.params[0])];else{for(L=M.type===t.ArrowFunctionExpression?[Ke(M,!1)]:[],L.push("("),M.defaults&&(Z=!0),B=0,N=M.params.length;B<N;++B)Z&&M.defaults[B]?L.push(this.generateAssignment(M.params[B],M.defaults[B],"=",o.Assignment,de)):L.push(this.generatePattern(M.params[B],o.Assignment,de)),B+1<N&&L.push(","+$);M.rest&&(M.params.length&&L.push(","+$),L.push("..."),L.push(Ze(M.rest))),L.push(")")}return L},Ge.prototype.generateFunctionBody=function(M){var B,N;return B=this.generateFunctionParams(M),M.type===t.ArrowFunctionExpression&&(B.push($),B.push("=>")),M.expression?(B.push($),N=this.generateExpression(M.body,o.Assignment,de),N.toString().charAt(0)==="{"&&(N=["(",N,")"]),B.push(N)):B.push(this.maybeBlock(M.body,yt)),B},Ge.prototype.generateIterationForStatement=function(M,B,N){var L=["for"+(B.await?$e()+"await":"")+$+"("],Z=this;return Ne(function(){B.left.type===t.VariableDeclaration?Ne(function(){L.push(B.left.kind+$e()),L.push(Z.generateStatement(B.left.declarations[0],We))}):L.push(Z.generateExpression(B.left,o.Call,de)),L=Ae(L,M),L=[Ae(L,Z.generateExpression(B.right,o.Assignment,de)),")"]}),L.push(this.maybeBlock(B.body,N)),L},Ge.prototype.generatePropertyKey=function(M,B){var N=[];return B&&N.push("["),N.push(this.generateExpression(M,o.Assignment,de)),B&&N.push("]"),N},Ge.prototype.generateAssignment=function(M,B,N,L,Z){return o.Assignment<L&&(Z|=he),Re([this.generateExpression(M,o.Call,Z),$+N+$,this.generateExpression(B,o.Assignment,Z)],o.Assignment,L)},Ge.prototype.semicolon=function(M){return!I&&M&Pe?"":";"},Ge.Statement={BlockStatement:function(M,B){var N,L,Z=["{",k],ae=this;return Ne(function(){M.body.length===0&&oe&&(N=M.range,N[1]-N[0]>2&&(L=re.substring(N[0]+1,N[1]-1),L[0]===`
`&&(Z=["{"]),Z.push(L)));var fe,ge,xe,ze;for(ze=Oe,B&Se&&(ze|=Ee),fe=0,ge=M.body.length;fe<ge;++fe)oe&&(fe===0&&(M.body[0].leadingComments&&(N=M.body[0].leadingComments[0].extendedRange,L=re.substring(N[0],N[1]),L[0]===`
`&&(Z=["{"])),M.body[0].leadingComments||ct(M.range[0],M.body[0].range[0],Z)),fe>0&&!M.body[fe-1].trailingComments&&!M.body[fe].leadingComments&&ct(M.body[fe-1].range[1],M.body[fe].range[0],Z)),fe===ge-1&&(ze|=Pe),M.body[fe].leadingComments&&oe?xe=ae.generateStatement(M.body[fe],ze):xe=De(ae.generateStatement(M.body[fe],ze)),Z.push(xe),it(ye(xe).toString())||oe&&fe<ge-1&&M.body[fe+1].leadingComments||Z.push(k),oe&&fe===ge-1&&(M.body[fe].trailingComments||ct(M.body[fe].range[1],M.range[1],Z))}),Z.push(De("}")),Z},BreakStatement:function(M,B){return M.label?"break "+M.label.name+this.semicolon(B):"break"+this.semicolon(B)},ContinueStatement:function(M,B){return M.label?"continue "+M.label.name+this.semicolon(B):"continue"+this.semicolon(B)},ClassBody:function(M,B){var N=["{",k],L=this;return Ne(function(Z){var ae,fe;for(ae=0,fe=M.body.length;ae<fe;++ae)N.push(Z),N.push(L.generateExpression(M.body[ae],o.Sequence,de)),ae+1<fe&&N.push(k)}),it(ye(N).toString())||N.push(k),N.push(d),N.push("}"),N},ClassDeclaration:function(M,B){var N,L;return N=["class"],M.id&&(N=Ae(N,this.generateExpression(M.id,o.Sequence,de))),M.superClass&&(L=Ae("extends",this.generateExpression(M.superClass,o.Unary,de)),N=Ae(N,L)),N.push($),N.push(this.generateStatement(M.body,Je)),N},DirectiveStatement:function(M,B){return U.raw&&M.raw?M.raw+this.semicolon(B):le(M.directive)+this.semicolon(B)},DoWhileStatement:function(M,B){var N=Ae("do",this.maybeBlock(M.body,Oe));return N=this.maybeBlockSuffix(M.body,N),Ae(N,["while"+$+"(",this.generateExpression(M.test,o.Sequence,de),")"+this.semicolon(B)])},CatchClause:function(M,B){var N,L=this;return Ne(function(){var Z;M.param?(N=["catch"+$+"(",L.generateExpression(M.param,o.Sequence,de),")"],M.guard&&(Z=L.generateExpression(M.guard,o.Sequence,de),N.splice(2,0," if ",Z))):N=["catch"]}),N.push(this.maybeBlock(M.body,Oe)),N},DebuggerStatement:function(M,B){return"debugger"+this.semicolon(B)},EmptyStatement:function(M,B){return";"},ExportDefaultDeclaration:function(M,B){var N=["export"],L;return L=B&Pe?Je:Oe,N=Ae(N,"default"),me(M.declaration)?N=Ae(N,this.generateStatement(M.declaration,L)):N=Ae(N,this.generateExpression(M.declaration,o.Assignment,de)+this.semicolon(B)),N},ExportNamedDeclaration:function(M,B){var N=["export"],L,Z=this;return L=B&Pe?Je:Oe,M.declaration?Ae(N,this.generateStatement(M.declaration,L)):(M.specifiers&&(M.specifiers.length===0?N=Ae(N,"{"+$+"}"):M.specifiers[0].type===t.ExportBatchSpecifier?N=Ae(N,this.generateExpression(M.specifiers[0],o.Sequence,de)):(N=Ae(N,"{"),Ne(function(ae){var fe,ge;for(N.push(k),fe=0,ge=M.specifiers.length;fe<ge;++fe)N.push(ae),N.push(Z.generateExpression(M.specifiers[fe],o.Sequence,de)),fe+1<ge&&N.push(","+k)}),it(ye(N).toString())||N.push(k),N.push(d+"}")),M.source?N=Ae(N,["from"+$,this.generateExpression(M.source,o.Sequence,de),this.semicolon(B)]):N.push(this.semicolon(B))),N)},ExportAllDeclaration:function(M,B){return["export"+$,"*"+$,"from"+$,this.generateExpression(M.source,o.Sequence,de),this.semicolon(B)]},ExpressionStatement:function(M,B){var N,L;function Z(ge){var xe;return ge.slice(0,5)!=="class"?!1:(xe=ge.charCodeAt(5),xe===123||p.code.isWhiteSpace(xe)||p.code.isLineTerminator(xe))}function ae(ge){var xe;return ge.slice(0,8)!=="function"?!1:(xe=ge.charCodeAt(8),xe===40||p.code.isWhiteSpace(xe)||xe===42||p.code.isLineTerminator(xe))}function fe(ge){var xe,ze,ut;if(ge.slice(0,5)!=="async"||!p.code.isWhiteSpace(ge.charCodeAt(5)))return!1;for(ze=6,ut=ge.length;ze<ut&&p.code.isWhiteSpace(ge.charCodeAt(ze));++ze);return ze===ut||ge.slice(ze,ze+8)!=="function"?!1:(xe=ge.charCodeAt(ze+8),xe===40||p.code.isWhiteSpace(xe)||xe===42||p.code.isLineTerminator(xe))}return N=[this.generateExpression(M.expression,o.Sequence,de)],L=ye(N).toString(),L.charCodeAt(0)===123||Z(L)||ae(L)||fe(L)||ie&&B&Ee&&M.expression.type===t.Literal&&typeof M.expression.value=="string"?N=["(",N,")"+this.semicolon(B)]:N.push(this.semicolon(B)),N},ImportDeclaration:function(M,B){var N,L,Z=this;return M.specifiers.length===0?["import",$,this.generateExpression(M.source,o.Sequence,de),this.semicolon(B)]:(N=["import"],L=0,M.specifiers[L].type===t.ImportDefaultSpecifier&&(N=Ae(N,[this.generateExpression(M.specifiers[L],o.Sequence,de)]),++L),M.specifiers[L]&&(L!==0&&N.push(","),M.specifiers[L].type===t.ImportNamespaceSpecifier?N=Ae(N,[$,this.generateExpression(M.specifiers[L],o.Sequence,de)]):(N.push($+"{"),M.specifiers.length-L===1?(N.push($),N.push(this.generateExpression(M.specifiers[L],o.Sequence,de)),N.push($+"}"+$)):(Ne(function(ae){var fe,ge;for(N.push(k),fe=L,ge=M.specifiers.length;fe<ge;++fe)N.push(ae),N.push(Z.generateExpression(M.specifiers[fe],o.Sequence,de)),fe+1<ge&&N.push(","+k)}),it(ye(N).toString())||N.push(k),N.push(d+"}"+$)))),N=Ae(N,["from"+$,this.generateExpression(M.source,o.Sequence,de),this.semicolon(B)]),N)},VariableDeclarator:function(M,B){var N=B&he?de:He;return M.init?[this.generateExpression(M.id,o.Assignment,N),$,"=",$,this.generateExpression(M.init,o.Assignment,N)]:this.generatePattern(M.id,o.Assignment,N)},VariableDeclaration:function(M,B){var N,L,Z,ae,fe,ge=this;N=[M.kind],fe=B&he?Oe:We;function xe(){for(ae=M.declarations[0],U.comment&&ae.leadingComments?(N.push(`
`),N.push(De(ge.generateStatement(ae,fe)))):(N.push($e()),N.push(ge.generateStatement(ae,fe))),L=1,Z=M.declarations.length;L<Z;++L)ae=M.declarations[L],U.comment&&ae.leadingComments?(N.push(","+k),N.push(De(ge.generateStatement(ae,fe)))):(N.push(","+$),N.push(ge.generateStatement(ae,fe)))}return M.declarations.length>1?Ne(xe):xe(),N.push(this.semicolon(B)),N},ThrowStatement:function(M,B){return[Ae("throw",this.generateExpression(M.argument,o.Sequence,de)),this.semicolon(B)]},TryStatement:function(M,B){var N,L,Z,ae;if(N=["try",this.maybeBlock(M.block,Oe)],N=this.maybeBlockSuffix(M.block,N),M.handlers)for(L=0,Z=M.handlers.length;L<Z;++L)N=Ae(N,this.generateStatement(M.handlers[L],Oe)),(M.finalizer||L+1!==Z)&&(N=this.maybeBlockSuffix(M.handlers[L].body,N));else{for(ae=M.guardedHandlers||[],L=0,Z=ae.length;L<Z;++L)N=Ae(N,this.generateStatement(ae[L],Oe)),(M.finalizer||L+1!==Z)&&(N=this.maybeBlockSuffix(ae[L].body,N));if(M.handler)if(Array.isArray(M.handler))for(L=0,Z=M.handler.length;L<Z;++L)N=Ae(N,this.generateStatement(M.handler[L],Oe)),(M.finalizer||L+1!==Z)&&(N=this.maybeBlockSuffix(M.handler[L].body,N));else N=Ae(N,this.generateStatement(M.handler,Oe)),M.finalizer&&(N=this.maybeBlockSuffix(M.handler.body,N))}return M.finalizer&&(N=Ae(N,["finally",this.maybeBlock(M.finalizer,Oe)])),N},SwitchStatement:function(M,B){var N,L,Z,ae,fe,ge=this;if(Ne(function(){N=["switch"+$+"(",ge.generateExpression(M.discriminant,o.Sequence,de),")"+$+"{"+k]}),M.cases)for(fe=Oe,Z=0,ae=M.cases.length;Z<ae;++Z)Z===ae-1&&(fe|=Pe),L=De(this.generateStatement(M.cases[Z],fe)),N.push(L),it(ye(L).toString())||N.push(k);return N.push(De("}")),N},SwitchCase:function(M,B){var N,L,Z,ae,fe,ge=this;return Ne(function(){for(M.test?N=[Ae("case",ge.generateExpression(M.test,o.Sequence,de)),":"]:N=["default:"],Z=0,ae=M.consequent.length,ae&&M.consequent[0].type===t.BlockStatement&&(L=ge.maybeBlock(M.consequent[0],Oe),N.push(L),Z=1),Z!==ae&&!it(ye(N).toString())&&N.push(k),fe=Oe;Z<ae;++Z)Z===ae-1&&B&Pe&&(fe|=Pe),L=De(ge.generateStatement(M.consequent[Z],fe)),N.push(L),Z+1!==ae&&!it(ye(L).toString())&&N.push(k)}),N},IfStatement:function(M,B){var N,L,Z,ae=this;return Ne(function(){N=["if"+$+"(",ae.generateExpression(M.test,o.Sequence,de),")"]}),Z=B&Pe,L=Oe,Z&&(L|=Pe),M.alternate?(N.push(this.maybeBlock(M.consequent,Oe)),N=this.maybeBlockSuffix(M.consequent,N),M.alternate.type===t.IfStatement?N=Ae(N,["else ",this.generateStatement(M.alternate,L)]):N=Ae(N,Ae("else",this.maybeBlock(M.alternate,L)))):N.push(this.maybeBlock(M.consequent,L)),N},ForStatement:function(M,B){var N,L=this;return Ne(function(){N=["for"+$+"("],M.init?M.init.type===t.VariableDeclaration?N.push(L.generateStatement(M.init,We)):(N.push(L.generateExpression(M.init,o.Sequence,He)),N.push(";")):N.push(";"),M.test&&(N.push($),N.push(L.generateExpression(M.test,o.Sequence,de))),N.push(";"),M.update&&(N.push($),N.push(L.generateExpression(M.update,o.Sequence,de))),N.push(")")}),N.push(this.maybeBlock(M.body,B&Pe?Je:Oe)),N},ForInStatement:function(M,B){return this.generateIterationForStatement("in",M,B&Pe?Je:Oe)},ForOfStatement:function(M,B){return this.generateIterationForStatement("of",M,B&Pe?Je:Oe)},LabeledStatement:function(M,B){return[M.label.name+":",this.maybeBlock(M.body,B&Pe?Je:Oe)]},Program:function(M,B){var N,L,Z,ae,fe;for(ae=M.body.length,N=[z&&ae>0?`
`:""],fe=qe,Z=0;Z<ae;++Z)!z&&Z===ae-1&&(fe|=Pe),oe&&(Z===0&&(M.body[0].leadingComments||ct(M.range[0],M.body[Z].range[0],N)),Z>0&&!M.body[Z-1].trailingComments&&!M.body[Z].leadingComments&&ct(M.body[Z-1].range[1],M.body[Z].range[0],N)),L=De(this.generateStatement(M.body[Z],fe)),N.push(L),Z+1<ae&&!it(ye(L).toString())&&(oe&&M.body[Z+1].leadingComments||N.push(k)),oe&&Z===ae-1&&(M.body[Z].trailingComments||ct(M.body[Z].range[1],M.range[1],N));return N},FunctionDeclaration:function(M,B){return[Ke(M,!0),"function",tt(M)||$e(),M.id?Ze(M.id):"",this.generateFunctionBody(M)]},ReturnStatement:function(M,B){return M.argument?[Ae("return",this.generateExpression(M.argument,o.Sequence,de)),this.semicolon(B)]:["return"+this.semicolon(B)]},WhileStatement:function(M,B){var N,L=this;return Ne(function(){N=["while"+$+"(",L.generateExpression(M.test,o.Sequence,de),")"]}),N.push(this.maybeBlock(M.body,B&Pe?Je:Oe)),N},WithStatement:function(M,B){var N,L=this;return Ne(function(){N=["with"+$+"(",L.generateExpression(M.object,o.Sequence,de),")"]}),N.push(this.maybeBlock(M.body,B&Pe?Je:Oe)),N}},vt(Ge.prototype,Ge.Statement),Ge.Expression={SequenceExpression:function(M,B,N){var L,Z,ae;for(o.Sequence<B&&(N|=he),L=[],Z=0,ae=M.expressions.length;Z<ae;++Z)L.push(this.generateExpression(M.expressions[Z],o.Assignment,N)),Z+1<ae&&L.push(","+$);return Re(L,o.Sequence,B)},AssignmentExpression:function(M,B,N){return this.generateAssignment(M.left,M.right,M.operator,B,N)},ArrowFunctionExpression:function(M,B,N){return Re(this.generateFunctionBody(M),o.ArrowFunction,B)},ConditionalExpression:function(M,B,N){return o.Conditional<B&&(N|=he),Re([this.generateExpression(M.test,o.Coalesce,N),$+"?"+$,this.generateExpression(M.consequent,o.Assignment,N),$+":"+$,this.generateExpression(M.alternate,o.Assignment,N)],o.Conditional,B)},LogicalExpression:function(M,B,N){return M.operator==="??"&&(N|=Ye),this.BinaryExpression(M,B,N)},BinaryExpression:function(M,B,N){var L,Z,ae,fe,ge,xe;return fe=a[M.operator],Z=M.operator==="**"?o.Postfix:fe,ae=M.operator==="**"?fe:fe+1,fe<B&&(N|=he),ge=this.generateExpression(M.left,Z,N),xe=ge.toString(),xe.charCodeAt(xe.length-1)===47&&p.code.isIdentifierPartES5(M.operator.charCodeAt(0))?L=[ge,$e(),M.operator]:L=Ae(ge,M.operator),ge=this.generateExpression(M.right,ae,N),M.operator==="/"&&ge.toString().charAt(0)==="/"||M.operator.slice(-1)==="<"&&ge.toString().slice(0,3)==="!--"?(L.push($e()),L.push(ge)):L=Ae(L,ge),M.operator==="in"&&!(N&he)?["(",L,")"]:(M.operator==="||"||M.operator==="&&")&&N&Ye?["(",L,")"]:Re(L,fe,B)},CallExpression:function(M,B,N){var L,Z,ae;for(L=[this.generateExpression(M.callee,o.Call,et)],M.optional&&L.push("?."),L.push("("),Z=0,ae=M.arguments.length;Z<ae;++Z)L.push(this.generateExpression(M.arguments[Z],o.Assignment,de)),Z+1<ae&&L.push(","+$);return L.push(")"),N&ve?Re(L,o.Call,B):["(",L,")"]},ChainExpression:function(M,B,N){o.OptionalChaining<B&&(N|=ve);var L=this.generateExpression(M.expression,o.OptionalChaining,N);return Re(L,o.OptionalChaining,B)},NewExpression:function(M,B,N){var L,Z,ae,fe,ge;if(Z=M.arguments.length,ge=N&Fe&&!R&&Z===0?Ve:Le,L=Ae("new",this.generateExpression(M.callee,o.New,ge)),!(N&Fe)||R||Z>0){for(L.push("("),ae=0,fe=Z;ae<fe;++ae)L.push(this.generateExpression(M.arguments[ae],o.Assignment,de)),ae+1<fe&&L.push(","+$);L.push(")")}return Re(L,o.New,B)},MemberExpression:function(M,B,N){var L,Z;return L=[this.generateExpression(M.object,o.Call,N&ve?et:Le)],M.computed?(M.optional&&L.push("?."),L.push("["),L.push(this.generateExpression(M.property,o.Sequence,N&ve?de:Ve)),L.push("]")):(!M.optional&&M.object.type===t.Literal&&typeof M.object.value=="number"&&(Z=ye(L).toString(),Z.indexOf(".")<0&&!/[eExX]/.test(Z)&&p.code.isDecimalDigit(Z.charCodeAt(Z.length-1))&&!(Z.length>=2&&Z.charCodeAt(0)===48)&&L.push(" ")),L.push(M.optional?"?.":"."),L.push(Ze(M.property))),Re(L,o.Member,B)},MetaProperty:function(M,B,N){var L;return L=[],L.push(typeof M.meta=="string"?M.meta:Ze(M.meta)),L.push("."),L.push(typeof M.property=="string"?M.property:Ze(M.property)),Re(L,o.Member,B)},UnaryExpression:function(M,B,N){var L,Z,ae,fe,ge;return Z=this.generateExpression(M.argument,o.Unary,de),$===""?L=Ae(M.operator,Z):(L=[M.operator],M.operator.length>2?L=Ae(L,Z):(fe=ye(L).toString(),ge=fe.charCodeAt(fe.length-1),ae=Z.toString().charCodeAt(0),((ge===43||ge===45)&&ge===ae||p.code.isIdentifierPartES5(ge)&&p.code.isIdentifierPartES5(ae))&&L.push($e()),L.push(Z))),Re(L,o.Unary,B)},YieldExpression:function(M,B,N){var L;return M.delegate?L="yield*":L="yield",M.argument&&(L=Ae(L,this.generateExpression(M.argument,o.Yield,de))),Re(L,o.Yield,B)},AwaitExpression:function(M,B,N){var L=Ae(M.all?"await*":"await",this.generateExpression(M.argument,o.Await,de));return Re(L,o.Await,B)},UpdateExpression:function(M,B,N){return M.prefix?Re([M.operator,this.generateExpression(M.argument,o.Unary,de)],o.Unary,B):Re([this.generateExpression(M.argument,o.Postfix,de),M.operator],o.Postfix,B)},FunctionExpression:function(M,B,N){var L=[Ke(M,!0),"function"];return M.id?(L.push(tt(M)||$e()),L.push(Ze(M.id))):L.push(tt(M)||$),L.push(this.generateFunctionBody(M)),L},ArrayPattern:function(M,B,N){return this.ArrayExpression(M,B,N,!0)},ArrayExpression:function(M,B,N,L){var Z,ae,fe=this;return M.elements.length?(ae=L?!1:M.elements.length>1,Z=["[",ae?k:""],Ne(function(ge){var xe,ze;for(xe=0,ze=M.elements.length;xe<ze;++xe)M.elements[xe]?(Z.push(ae?ge:""),Z.push(fe.generateExpression(M.elements[xe],o.Assignment,de))):(ae&&Z.push(ge),xe+1===ze&&Z.push(",")),xe+1<ze&&Z.push(","+(ae?k:$))}),ae&&!it(ye(Z).toString())&&Z.push(k),Z.push(ae?d:""),Z.push("]"),Z):"[]"},RestElement:function(M,B,N){return"..."+this.generatePattern(M.argument)},ClassExpression:function(M,B,N){var L,Z;return L=["class"],M.id&&(L=Ae(L,this.generateExpression(M.id,o.Sequence,de))),M.superClass&&(Z=Ae("extends",this.generateExpression(M.superClass,o.Unary,de)),L=Ae(L,Z)),L.push($),L.push(this.generateStatement(M.body,Je)),L},MethodDefinition:function(M,B,N){var L,Z;return M.static?L=["static"+$]:L=[],M.kind==="get"||M.kind==="set"?Z=[Ae(M.kind,this.generatePropertyKey(M.key,M.computed)),this.generateFunctionBody(M.value)]:Z=[mt(M),this.generatePropertyKey(M.key,M.computed),this.generateFunctionBody(M.value)],Ae(L,Z)},Property:function(M,B,N){return M.kind==="get"||M.kind==="set"?[M.kind,$e(),this.generatePropertyKey(M.key,M.computed),this.generateFunctionBody(M.value)]:M.shorthand?M.value.type==="AssignmentPattern"?this.AssignmentPattern(M.value,o.Sequence,de):this.generatePropertyKey(M.key,M.computed):M.method?[mt(M),this.generatePropertyKey(M.key,M.computed),this.generateFunctionBody(M.value)]:[this.generatePropertyKey(M.key,M.computed),":"+$,this.generateExpression(M.value,o.Assignment,de)]},ObjectExpression:function(M,B,N){var L,Z,ae,fe=this;return M.properties.length?(L=M.properties.length>1,Ne(function(){ae=fe.generateExpression(M.properties[0],o.Sequence,de)}),!L&&!At(ye(ae).toString())?["{",$,ae,$,"}"]:(Ne(function(ge){var xe,ze;if(Z=["{",k,ge,ae],L)for(Z.push(","+k),xe=1,ze=M.properties.length;xe<ze;++xe)Z.push(ge),Z.push(fe.generateExpression(M.properties[xe],o.Sequence,de)),xe+1<ze&&Z.push(","+k)}),it(ye(Z).toString())||Z.push(k),Z.push(d),Z.push("}"),Z)):"{}"},AssignmentPattern:function(M,B,N){return this.generateAssignment(M.left,M.right,"=",B,N)},ObjectPattern:function(M,B,N){var L,Z,ae,fe,ge,xe=this;if(!M.properties.length)return"{}";if(fe=!1,M.properties.length===1)ge=M.properties[0],ge.type===t.Property&&ge.value.type!==t.Identifier&&(fe=!0);else for(Z=0,ae=M.properties.length;Z<ae;++Z)if(ge=M.properties[Z],ge.type===t.Property&&!ge.shorthand){fe=!0;break}return L=["{",fe?k:""],Ne(function(ze){var ut,Dt;for(ut=0,Dt=M.properties.length;ut<Dt;++ut)L.push(fe?ze:""),L.push(xe.generateExpression(M.properties[ut],o.Sequence,de)),ut+1<Dt&&L.push(","+(fe?k:$))}),fe&&!it(ye(L).toString())&&L.push(k),L.push(fe?d:""),L.push("}"),L},ThisExpression:function(M,B,N){return"this"},Super:function(M,B,N){return"super"},Identifier:function(M,B,N){return Ze(M)},ImportDefaultSpecifier:function(M,B,N){return Ze(M.id||M.local)},ImportNamespaceSpecifier:function(M,B,N){var L=["*"],Z=M.id||M.local;return Z&&L.push($+"as"+$e()+Ze(Z)),L},ImportSpecifier:function(M,B,N){var L=M.imported,Z=[L.name],ae=M.local;return ae&&ae.name!==L.name&&Z.push($e()+"as"+$e()+Ze(ae)),Z},ExportSpecifier:function(M,B,N){var L=M.local,Z=[L.name],ae=M.exported;return ae&&ae.name!==L.name&&Z.push($e()+"as"+$e()+Ze(ae)),Z},Literal:function(M,B,N){var L;if(M.hasOwnProperty("raw")&&O&&U.raw)try{if(L=O(M.raw).body[0].expression,L.type===t.Literal&&L.value===M.value)return M.raw}catch{}return M.regex?"/"+M.regex.pattern+"/"+M.regex.flags:typeof M.value=="bigint"?M.value.toString()+"n":M.bigint?M.bigint+"n":M.value===null?"null":typeof M.value=="string"?be(M.value):typeof M.value=="number"?Ct(M.value):typeof M.value=="boolean"?M.value?"true":"false":te(M.value)},GeneratorExpression:function(M,B,N){return this.ComprehensionExpression(M,B,N)},ComprehensionExpression:function(M,B,N){var L,Z,ae,fe,ge=this;return L=M.type===t.GeneratorExpression?["("]:["["],U.moz.comprehensionExpressionStartsWithAssignment&&(fe=this.generateExpression(M.body,o.Assignment,de),L.push(fe)),M.blocks&&Ne(function(){for(Z=0,ae=M.blocks.length;Z<ae;++Z)fe=ge.generateExpression(M.blocks[Z],o.Sequence,de),Z>0||U.moz.comprehensionExpressionStartsWithAssignment?L=Ae(L,fe):L.push(fe)}),M.filter&&(L=Ae(L,"if"+$),fe=this.generateExpression(M.filter,o.Sequence,de),L=Ae(L,["(",fe,")"])),U.moz.comprehensionExpressionStartsWithAssignment||(fe=this.generateExpression(M.body,o.Assignment,de),L=Ae(L,fe)),L.push(M.type===t.GeneratorExpression?")":"]"),L},ComprehensionBlock:function(M,B,N){var L;return M.left.type===t.VariableDeclaration?L=[M.left.kind,$e(),this.generateStatement(M.left.declarations[0],We)]:L=this.generateExpression(M.left,o.Call,de),L=Ae(L,M.of?"of":"in"),L=Ae(L,this.generateExpression(M.right,o.Sequence,de)),["for"+$+"(",L,")"]},SpreadElement:function(M,B,N){return["...",this.generateExpression(M.argument,o.Assignment,de)]},TaggedTemplateExpression:function(M,B,N){var L=et;N&ve||(L=Le);var Z=[this.generateExpression(M.tag,o.Call,L),this.generateExpression(M.quasi,o.Primary,ot)];return Re(Z,o.TaggedTemplate,B)},TemplateElement:function(M,B,N){return M.value.raw},TemplateLiteral:function(M,B,N){var L,Z,ae;for(L=["`"],Z=0,ae=M.quasis.length;Z<ae;++Z)L.push(this.generateExpression(M.quasis[Z],o.Primary,de)),Z+1<ae&&(L.push("${"+$),L.push(this.generateExpression(M.expressions[Z],o.Sequence,de)),L.push($+"}"));return L.push("`"),L},ModuleSpecifier:function(M,B,N){return this.Literal(M,B,N)},ImportExpression:function(M,B,N){return Re(["import(",this.generateExpression(M.source,o.Assignment,de),")"],o.Call,B)}},vt(Ge.prototype,Ge.Expression),Ge.prototype.generateExpression=function(M,B,N){var L,Z;return Z=M.type||t.Property,U.verbatim&&M.hasOwnProperty(U.verbatim)?ht(M,B):(L=this[Z](M,B,N),U.comment&&(L=Xe(M,L)),ye(L,M))},Ge.prototype.generateStatement=function(M,B){var N,L;return N=this[M.type](M,B),U.comment&&(N=Xe(M,N)),L=ye(N).toString(),M.type===t.Program&&!z&&k===""&&L.charAt(L.length-1)===`
`&&(N=ee?ye(N).replaceRight(/\s+$/,""):L.replace(/\s+$/,"")),ye(N,M)};function bt(M){var B;if(B=new Ge,me(M))return B.generateStatement(M,Oe);if(Ce(M))return B.generateExpression(M,o.Sequence,de);throw new Error("Unknown node type: "+M.type)}function Pt(M,B){var N=pt(),L,Z;return B!=null?(typeof B.indent=="string"&&(N.format.indent.style=B.indent),typeof B.base=="number"&&(N.format.indent.base=B.base),B=at(N,B),g=B.format.indent.style,typeof B.base=="string"?d=B.base:d=Qe(g,B.format.indent.base)):(B=N,g=B.format.indent.style,d=Qe(g,B.format.indent.base)),f=B.format.json,A=B.format.renumber,b=f?!1:B.format.hexadecimal,F=f?"double":B.format.quotes,S=B.format.escapeless,k=B.format.newline,$=B.format.space,B.format.compact&&(k=$=g=d=""),R=B.format.parentheses,I=B.format.semicolons,z=B.format.safeConcatenation,ie=B.directive,O=f?null:B.parse,ee=B.sourceMap,re=B.sourceCode,oe=B.format.preserveBlankLines&&re!==null,U=B,ee&&(e.browser?u=commonjsGlobal.sourceMap.SourceNode:u=requireSourceMap().SourceNode),L=bt(M),ee?(Z=L.toStringWithSourceMap({file:B.file,sourceRoot:B.sourceMapRoot}),B.sourceContent&&Z.map.setSourceContent(B.sourceMap,B.sourceContent),B.sourceMapWithCode?Z:Z.map.toString()):(Z={code:L.toString(),map:null},B.sourceMapWithCode?Z:Z.code)}_e={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},ue=pt().format,e.version=require$$3.version,e.generate=Pt,e.attachComments=l.attachComments,e.Precedence=at({},o),e.browser=!1,e.FORMAT_MINIFY=_e,e.FORMAT_DEFAULTS=ue})()})(escodegen$1)),escodegen$1}var escodegenExports=requireEscodegen();const escodegen=getDefaultExportFromCjs(escodegenExports);class WalkerBase{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:t=>this.replacement=t}}replace(t,o,a,u){t&&o&&(a!=null?t[o][a]=u:t[o]=u)}remove(t,o,a){t&&o&&(a!=null?t[o].splice(a,1):delete t[o])}}class SyncWalker extends WalkerBase{constructor(t,o){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:a=>this.replacement=a},this.enter=t,this.leave=o}visit(t,o,a,u){if(t){if(this.enter){const p=this.should_skip,d=this.should_remove,g=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,t,o,a,u),this.replacement&&(t=this.replacement,this.replace(o,a,u,t)),this.should_remove&&this.remove(o,a,u);const f=this.should_skip,A=this.should_remove;if(this.should_skip=p,this.should_remove=d,this.replacement=g,f)return t;if(A)return null}let l;for(l in t){const p=t[l];if(p&&typeof p=="object")if(Array.isArray(p)){const d=p;for(let g=0;g<d.length;g+=1){const f=d[g];isNode(f)&&(this.visit(f,t,l,g)||g--)}}else isNode(p)&&this.visit(p,t,l,null)}if(this.leave){const p=this.replacement,d=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,t,o,a,u),this.replacement&&(t=this.replacement,this.replace(o,a,u,t)),this.should_remove&&this.remove(o,a,u);const g=this.should_remove;if(this.replacement=p,this.should_remove=d,g)return null}}return t}}function isNode(e){return e!==null&&typeof e=="object"&&"type"in e&&typeof e.type=="string"}function walk(e,{enter:t,leave:o}){return new SyncWalker(t,o).visit(e,null)}let widgetMethods=[],languages=new Map;function transpiler(e,t={}){const{wrapAsync:o=!1,addReturn:a=!0,emitMiniLocations:u=!0,emitWidgets:l=!0}=t;let p=parse$a(e,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),d=[];const g=(F,S)=>{const k=languages.get("minilang");if(k){const $=`[${F}]`,R=k.getLocations($,S.start);d=d.concat(R)}else{const $=getLeafLocations(`"${F}"`,S.start,e);d=d.concat($)}};let f=[];walk(p,{enter(F,S){if(isLanguageLiteral(F)){const{name:k}=F.tag,$=languages.get(k),R=F.quasi.quasis[0].value.raw,I=F.quasi.start+1;if(u){const z=$.getLocations(R,I);d=d.concat(z)}return this.skip(),this.replace(languageWithLocation(k,R,I))}if(isTemplateLiteral(F,"tidal")){const k=F.quasi.quasis[0].value.raw,$=F.quasi.start+1;if(u){const R=collectHaskellMiniLocations(k,$);d=d.concat(R)}return this.skip(),this.replace(tidalWithLocation(k,$))}if(isBackTickString(F,S)){const{quasis:k}=F,{raw:$}=k[0].value;return this.skip(),u&&g($,F),this.replace(miniWithLocation($,F))}if(isStringWithDoubleQuotes(F)){const{value:k}=F;return this.skip(),u&&g(k,F),this.replace(miniWithLocation(k,F))}if(isSliderFunction(F))return l&&f.push({from:F.arguments[0].start,to:F.arguments[0].end,value:F.arguments[0].raw,min:F.arguments[1]?.value??0,max:F.arguments[2]?.value??1,step:F.arguments[3]?.value,type:"slider"}),this.replace(sliderWithLocation(F));if(isWidgetMethod(F)){const k=F.callee.property.name,$=f.filter(I=>I.type===k).length,R={to:F.end,index:$,type:k,id:t.id};return l&&f.push(R),this.replace(widgetWithLocation(F,R))}if(isBareSamplesCall(F,S))return this.replace(withAwait(F));if(isLabelStatement(F))return this.replace(labelToP(F))},leave(F,S,k,$){}});let{body:A}=p;if(!A.length)console.warn("empty body -> fallback to silence"),A.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!A?.[A.length-1]?.expression)throw new Error("unexpected ast format without body expression");if(a){const{expression:F}=A[A.length-1];A[A.length-1]={type:"ReturnStatement",argument:F}}let b=escodegen.generate(p);return o&&(b=`(async ()=>{${b}})()`),u?{output:b,miniLocations:d,widgets:f}:{output:b}}function isStringWithDoubleQuotes(e,t,o){return e.type!=="Literal"?!1:e.raw[0]==='"'}function isBackTickString(e,t){return e.type==="TemplateLiteral"&&t.type!=="TaggedTemplateExpression"}function miniWithLocation(e,t){const{start:o}=t,a=languages.get("minilang");let u="m";return a&&a.name&&(u=a.name),{type:"CallExpression",callee:{type:"Identifier",name:u},arguments:[{type:"Literal",value:e},{type:"Literal",value:o}],optional:!1}}function isSliderFunction(e){return e.type==="CallExpression"&&e.callee.name==="slider"}function isWidgetMethod(e){return e.type==="CallExpression"&&widgetMethods.includes(e.callee.property?.name)}function sliderWithLocation(e){const t="slider_"+e.arguments[0].start;return e.arguments.unshift({type:"Literal",value:t,raw:t}),e.callee.name="sliderWithID",e}function getWidgetID(e){return`${e.id||""}_widget_${e.type}_${e.index}`}function widgetWithLocation(e,t){const o=getWidgetID(t);return e.arguments.unshift({type:"Literal",value:o,raw:o}),e}function isBareSamplesCall(e,t){return e.type==="CallExpression"&&e.callee.name==="samples"&&t.type!=="AwaitExpression"}function withAwait(e){return{type:"AwaitExpression",argument:e}}function isLabelStatement(e){return e.type==="LabeledStatement"}function labelToP(e){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:e.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:e.label.name,raw:`'${e.label.name}'`}]}}}function isLanguageLiteral(e){return e.type==="TaggedTemplateExpression"&&languages.has(e.tag.name)}function isTemplateLiteral(e,t){return e.type==="TaggedTemplateExpression"&&e.tag.name===t}function collectHaskellMiniLocations(e,t){return e.split("").reduce((o,a,u)=>(a!=='"'||(!o.length||o[o.length-1].length>1?o.push([u+1]):o[o.length-1].push(u)),o),[]).map(([o,a])=>{const u=e.slice(o,a);return getLeafLocations(`"${u}"`,t+o-1)}).flat()}function tidalWithLocation(e,t){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}function languageWithLocation(e,t,o){return{type:"CallExpression",callee:{type:"Identifier",name:e},arguments:[{type:"Literal",value:t},{type:"Literal",value:o}],optional:!1}}const gm={gm_piano:["0000_JCLive_sf2_file","0000_FluidR3_GM_sf2_file","0000_Aspirin_sf2_file","0000_Chaos_sf2_file","0000_GeneralUserGS_sf2_file","0001_FluidR3_GM_sf2_file","0001_GeneralUserGS_sf2_file","0010_Aspirin_sf2_file","0010_Chaos_sf2_file","0010_FluidR3_GM_sf2_file","0010_GeneralUserGS_sf2_file","0010_JCLive_sf2_file","0011_Aspirin_sf2_file","0011_FluidR3_GM_sf2_file","0011_GeneralUserGS_sf2_file","0012_GeneralUserGS_sf2_file","0020_Aspirin_sf2_file","0020_Chaos_sf2_file","0020_FluidR3_GM_sf2_file","0020_GeneralUserGS_sf2_file","0020_JCLive_sf2_file","0021_Aspirin_sf2_file","0021_GeneralUserGS_sf2_file","0022_Aspirin_sf2_file","0030_Aspirin_sf2_file","0030_Chaos_sf2_file","0030_FluidR3_GM_sf2_file","0030_GeneralUserGS_sf2_file","0030_JCLive_sf2_file","0031_Aspirin_sf2_file","0031_FluidR3_GM_sf2_file","0031_GeneralUserGS_sf2_file"],gm_epiano1:["0040_JCLive_sf2_file","0040_FluidR3_GM_sf2_file","0040_Aspirin_sf2_file","0040_Chaos_sf2_file","0040_GeneralUserGS_sf2_file","0041_FluidR3_GM_sf2_file","0041_GeneralUserGS_sf2_file","0042_GeneralUserGS_sf2_file","0043_GeneralUserGS_sf2_file","0044_GeneralUserGS_sf2_file","0046_GeneralUserGS_sf2_file"],gm_epiano2:["0050_JCLive_sf2_file","0050_FluidR3_GM_sf2_file","0050_Aspirin_sf2_file","0050_Chaos_sf2_file","0050_GeneralUserGS_sf2_file","0051_FluidR3_GM_sf2_file","0051_GeneralUserGS_sf2_file","0053_GeneralUserGS_sf2_file","0054_GeneralUserGS_sf2_file"],gm_harpsichord:["0060_JCLive_sf2_file","0060_FluidR3_GM_sf2_file","0060_Aspirin_sf2_file","0060_Chaos_sf2_file","0060_GeneralUserGS_sf2_file","0061_Aspirin_sf2_file","0061_GeneralUserGS_sf2_file","0062_GeneralUserGS_sf2_file"],gm_clavinet:["0070_JCLive_sf2_file","0070_FluidR3_GM_sf2_file","0070_Aspirin_sf2_file","0070_Chaos_sf2_file"],gm_celesta:["0080_JCLive_sf2_file","0080_Aspirin_sf2_file","0080_Chaos_sf2_file","0080_FluidR3_GM_sf2_file","0080_GeneralUserGS_sf2_file","0081_FluidR3_GM_sf2_file"],gm_glockenspiel:["0090_JCLive_sf2_file","0090_Aspirin_sf2_file","0090_Chaos_sf2_file","0090_FluidR3_GM_sf2_file","0090_GeneralUserGS_sf2_file"],gm_music_box:["0100_JCLive_sf2_file","0100_Aspirin_sf2_file","0100_Chaos_sf2_file","0100_FluidR3_GM_sf2_file","0100_GeneralUserGS_sf2_file"],gm_vibraphone:["0110_JCLive_sf2_file","0110_Aspirin_sf2_file","0110_Chaos_sf2_file","0110_FluidR3_GM_sf2_file","0110_GeneralUserGS_sf2_file","0111_FluidR3_GM_sf2_file"],gm_marimba:["0120_JCLive_sf2_file","0120_Aspirin_sf2_file","0120_Chaos_sf2_file","0120_FluidR3_GM_sf2_file","0120_GeneralUserGS_sf2_file","0121_FluidR3_GM_sf2_file","0121_GeneralUserGS_sf2_file"],gm_xylophone:["0130_JCLive_sf2_file","0130_Aspirin_sf2_file","0130_Chaos_sf2_file","0130_FluidR3_GM_sf2_file","0130_GeneralUserGS_sf2_file","0131_FluidR3_GM_sf2_file"],gm_tubular_bells:["0140_JCLive_sf2_file","0140_Aspirin_sf2_file","0140_FluidR3_GM_sf2_file","0140_GeneralUserGS_sf2_file","0141_FluidR3_GM_sf2_file","0142_GeneralUserGS_sf2_file"],gm_dulcimer:["0150_Aspirin_sf2_file","0150_Chaos_sf2_file","0150_FluidR3_GM_sf2_file","0150_GeneralUserGS_sf2_file","0151_FluidR3_GM_sf2_file"],gm_drawbar_organ:["0160_JCLive_sf2_file","0160_Aspirin_sf2_file","0160_Chaos_sf2_file","0160_FluidR3_GM_sf2_file","0160_GeneralUserGS_sf2_file","0161_Aspirin_sf2_file","0161_FluidR3_GM_sf2_file"],gm_percussive_organ:["0170_JCLive_sf2_file","0170_Aspirin_sf2_file","0170_Chaos_sf2_file","0170_FluidR3_GM_sf2_file","0171_FluidR3_GM_sf2_file","0172_FluidR3_GM_sf2_file"],gm_rock_organ:["0180_JCLive_sf2_file","0180_Aspirin_sf2_file","0180_Chaos_sf2_file","0180_FluidR3_GM_sf2_file","0180_GeneralUserGS_sf2_file"],gm_church_organ:["0190_JCLive_sf2_file","0190_Aspirin_sf2_file","0190_Chaos_sf2_file","0190_FluidR3_GM_sf2_file","0190_GeneralUserGS_sf2_file"],gm_reed_organ:["0200_JCLive_sf2_file","0200_Aspirin_sf2_file","0200_Chaos_sf2_file","0200_FluidR3_GM_sf2_file","0200_GeneralUserGS_sf2_file","0201_Aspirin_sf2_file","0201_FluidR3_GM_sf2_file","0201_GeneralUserGS_sf2_file"],gm_accordion:["0210_JCLive_sf2_file","0210_FluidR3_GM_sf2_file","0210_GeneralUserGS_sf2_file","0211_Aspirin_sf2_file","0211_FluidR3_GM_sf2_file","0211_GeneralUserGS_sf2_file","0212_GeneralUserGS_sf2_file"],gm_harmonica:["0220_FluidR3_GM_sf2_file","0220_JCLive_sf2_file","0220_Aspirin_sf2_file","0220_Chaos_sf2_file","0220_GeneralUserGS_sf2_file","0221_FluidR3_GM_sf2_file"],gm_bandoneon:["0230_Aspirin_sf2_file","0230_JCLive_sf2_file","0230_Chaos_sf2_file","0230_FluidR3_GM_sf2_file","0230_GeneralUserGS_sf2_file","0231_FluidR3_GM_sf2_file","0231_GeneralUserGS_sf2_file","0231_JCLive_sf2_file","0232_FluidR3_GM_sf2_file","0233_FluidR3_GM_sf2_file"],gm_acoustic_guitar_nylon:["0240_JCLive_sf2_file","0240_Aspirin_sf2_file","0240_Chaos_sf2_file","0240_FluidR3_GM_sf2_file","0240_GeneralUserGS_sf2_file","0240_LK_Godin_Nylon_SF2_file","0241_JCLive_sf2_file","0242_JCLive_sf2_file","0243_JCLive_sf2_file"],gm_acoustic_guitar_steel:["0253_Acoustic_Guitar_sf2_file","0250_Aspirin_sf2_file","0250_Chaos_sf2_file","0250_FluidR3_GM_sf2_file","0250_GeneralUserGS_sf2_file","0250_LK_AcousticSteel_SF2_file","0253_Acoustic_Guitar_sf2_file","0253_GeneralUserGS_sf2_file","0254_Acoustic_Guitar_sf2_file","0254_GeneralUserGS_sf2_file"],gm_electric_guitar_jazz:["0260_JCLive_sf2_file","0260_Aspirin_sf2_file","0260_Chaos_sf2_file","0260_FluidR3_GM_sf2_file","0260_GeneralUserGS_sf2_file","0260_Stratocaster_sf2_file","0261_GeneralUserGS_sf2_file","0261_Stratocaster_sf2_file","0262_Stratocaster_sf2_file"],gm_electric_guitar_clean:["0270_Aspirin_sf2_file","0270_Chaos_sf2_file","0270_FluidR3_GM_sf2_file","0270_GeneralUserGS_sf2_file","0270_SBAWE32_sf2_file","0270_Stratocaster_sf2_file","0271_GeneralUserGS_sf2_file","0271_Stratocaster_sf2_file","0272_Stratocaster_sf2_file"],gm_electric_guitar_muted:["0280_Aspirin_sf2_file","0280_Chaos_sf2_file","0280_GeneralUserGS_sf2_file","0280_JCLive_sf2_file","0280_LesPaul_sf2_file","0280_SBAWE32_sf2_file","0281_Aspirin_sf2_file","0281_FluidR3_GM_sf2_file","0281_GeneralUserGS_sf2_file","0282_FluidR3_GM_sf2_file"],gm_overdriven_guitar:["0290_FluidR3_GM_sf2_file","0290_Aspirin_sf2_file","0290_Chaos_sf2_file","0290_GeneralUserGS_sf2_file","0290_LesPaul_sf2_file","0290_SBAWE32_sf2_file","0291_LesPaul_sf2_file","0291_SBAWE32_sf2_file","0292_Aspirin_sf2_file","0292_LesPaul_sf2_file"],gm_distortion_guitar:["0300_FluidR3_GM_sf2_file","0300_Aspirin_sf2_file","0300_Chaos_sf2_file","0300_GeneralUserGS_sf2_file","0300_LesPaul_sf2_file","0302_Aspirin_sf2_file","0304_Aspirin_sf2_file"],gm_guitar_harmonics:["0310_Aspirin_sf2_file","0310_FluidR3_GM_sf2_file","0310_Chaos_sf2_file"],gm_acoustic_bass:["0320_JCLive_sf2_file","0320_FluidR3_GM_sf2_file","0320_Aspirin_sf2_file","0320_Chaos_sf2_file"],gm_electric_bass_finger:["0330_JCLive_sf2_file","0330_FluidR3_GM_sf2_fible","0330_Aspirin_sf2_file","0330_GeneralUserGS_sf2_file"],gm_electric_bass_pick:["0340_JCLive_sf2_file","0340_FluidR3_GM_sf2_file","0340_Aspirin_sf2_file","0340_GeneralUserGS_sf2_file","0341_Aspirin_sf2_file"],gm_fretless_bass:["0350_Aspirin_sf2_file","0350_JCLive_sf2_file"],gm_slap_bass_1:["0360_Aspirin_sf2_file","0360_JCLive_sf2_file","0360_FluidR3_GM_sf2_file","0360_Chaos_sf2_file"],gm_slap_bass_2:["0370_Aspirin_sf2_file","0370_FluidR3_GM_sf2_file","0370_GeneralUserGS_sf2_fil e","0370_JCLive_sf2_file"],gm_synth_bass_1:["0380_Chaos_sf2_file","0380_FluidR3_GM_sf2_file","0380_JCLive_sf2_file","0381_FluidR3_GM_sf2_file","0381_GeneralUserGS_sf2_file","0382_GeneralUserGS_sf2_file","0383_GeneralUserGS_sf2_file","0384_GeneralUserGS_sf2_file","0387_GeneralUserGS_sf2_file"],gm_synth_bass_2:["0390_Aspirin_sf2_file","0390_FluidR3_GM_sf2_file","0390_GeneralUserGS_sf2_file","0390_JCLive_sf2_file","0391_FluidR3_GM_sf2_file","0392_FluidR3_GM_sf2_file","0393_GeneralUserGS_sf2_file"],gm_violin:["0400_Aspirin_sf2_file","0400_Chaos_sf2_file","0400_JCLive_sf2_file","0400_FluidR3_GM_sf2_file","0400_GeneralUserGS_sf2_file","0401_Aspirin_sf2_file","0401_FluidR3_GM_sf2_file","0401_GeneralUserGS_sf2_file","0402_GeneralUserGS_sf2_file"],gm_viola:["0410_Aspirin_sf2_file","0410_FluidR3_GM_sf2_file","0410_GeneralUserGS_sf2_file","0410_JCLive_sf2_file","0411_FluidR3_GM_sf2_file"],gm_cello:["0420_Aspirin_sf2_file","0420_FluidR3_GM_sf2_file","0420_GeneralUserGS_sf2_file","0420_JCLive_sf2_file","0421_FluidR3_GM_sf2_file","0421_GeneralUserGS_sf2_file"],gm_contrabass:["0430_Aspirin_sf2_file","0430_Chaos_sf2_file","0430_GeneralUserGS_sf2_file"],gm_tremolo_strings:["0440_Aspirin_sf2_file","0440_Chaos_sf2_file","0440_GeneralUserGS_sf2_file","0440_JCLive_sf2_file","0441_GeneralUserGS_sf2_file","0442_GeneralUserGS_sf2_file"],gm_pizzicato_strings:["0450_Aspirin_sf2_file","0450_Chaos_sf2_file","0450_FluidR3_GM_sf2_file","0450_GeneralUserGS_sf2_file","0450_JCLive_sf2_file","0451_FluidR3_GM_sf2_file"],gm_orchestral_harp:["0460_Aspirin_sf2_file","0460_FluidR3_GM_sf2_file","0460_GeneralUserGS_sf2_file","0460_JCLive_sf2_file","0461_FluidR3_GM_sf2_file"],gm_timpani:["0470_Aspirin_sf2_file","0470_Chaos_sf2_file","0470_FluidR3_GM_sf2_file","0470_GeneralUserGS_sf2_file","0471_FluidR3_GM_sf2_file","0471_GeneralUserGS_sf2_file"],gm_string_ensemble_1:["0480_Aspirin_sf2_file","0480_Chaos_sf2_file","0480_FluidR3_GM_sf2_file","0480_GeneralUserGS_sf2_file","0480_JCLive_sf2_file","0481_Aspirin_sf2_file","0481_FluidR3_GM_sf2_file","0481_GeneralUserGS_sf2_file","0482_Aspirin_sf2_file","0482_GeneralUserGS_sf2_file","0483_GeneralUserGS_sf2_file"],gm_string_ensemble_2:["0490_Aspirin_sf2_file","0490_Chaos_sf2_file","0490_FluidR3_GM_sf2_file","0490_GeneralUserGS_sf2_file","0490_JCLive_sf2_file","0491_GeneralUserGS_sf2_file","0492_GeneralUserGS_sf2_file"],gm_synth_strings_1:["0500_Aspirin_sf2_file","0500_GeneralUserGS_sf2_file","0500_JCLive_sf2_file","0501_FluidR3_GM_sf2_file","0502_GeneralUserGS_sf2_file","0503_FluidR3_GM_sf2_file","0505_FluidR3_GM_sf2_file"],gm_synth_strings_2:["0510_Aspirin_sf2_file","0510_Chaos_sf2_file","0510_GeneralUserGS_sf2_file","0511_GeneralUserGS_sf2_file"],gm_choir_aahs:["0520_Aspirin_sf2_file","0520_Chaos_sf2_file","0520_FluidR3_GM_sf2_file","0520_GeneralUserGS_sf2_file","0520_JCLive_sf2_file","0520_Soul_Ahhs_sf2_file","0521_FluidR3_GM_sf2_file","0521_Soul_Ahhs_sf2_file","0522_Soul_Ahhs_sf2_file"],gm_voice_oohs:["0530_Aspirin_sf2_file","0530_Chaos_sf2_file","0530_FluidR3_GM_sf2_file","0530_GeneralUserGS_sf2_file","0531_FluidR3_GM_sf2_file","0531_JCLive_sf2_file"],gm_synth_choir:["0540_Aspirin_sf2_file","0540_Chaos_sf2_file","0540_FluidR3_GM_sf2_file","0540_GeneralUserGS_sf2_file","0541_FluidR3_GM_sf2_file"],gm_orchestra_hit:["0550_Aspirin_sf2_file","0550_Chaos_sf2_file","0550_FluidR3_GM_sf2_file","0550_GeneralUserGS_sf2_file","0551_FluidR3_GM_sf2_file"],gm_trumpet:["0560_FluidR3_GM_sf2_file","0560_JCLive_sf2_file","0560_Aspirin_sf2_file","0560_Chaos_sf2_file"],gm_trombone:["0570_Aspirin_sf2_file","0570_Chaos_sf2_file","0570_FluidR3_GM_sf2_file","0570_GeneralUserGS_sf2_file","0571_GeneralUserGS_sf2_file"],gm_tuba:["0580_FluidR3_GM_sf2_file","0580_Aspirin_sf2_file","0580_Chaos_sf2_file","0580_GeneralUserGS_sf2_file"],gm_muted_trumpet:["0590_JCLive_sf2_file","0590_Aspirin_sf2_file","0590_Chaos_sf2_file","0590_FluidR3_GM_sf2_file","0590_GeneralUserGS_sf2_file"],gm_french_horn:["0600_Aspirin_sf2_file","0600_FluidR3_GM_sf2_file","0600_GeneralUserGS_sf2_file","0600_JCLive_sf2_file","0601_FluidR3_GM_sf2_file"],gm_brass_section:["0610_JCLive_sf2_file","0610_Aspirin_sf2_file","0610_Chaos_sf2_file","0610_FluidR3_GM_sf2_file","0610_GeneralUserGS_sf2_file"],gm_synth_brass_1:["0620_Aspirin_sf2_file","0620_FluidR3_GM_sf2_file","0621_Aspirin_sf2_file","0621_FluidR3_GM_sf2_file"],gm_synth_brass_2:["0630_Aspirin_sf2_file","0630_Chaos_sf2_file","0630_FluidR3_GM_sf2_file","0630_JCLive_sf2_file","0631_FluidR3_GM_sf2_file","0632_FluidR3_GM_sf2_file","0633_FluidR3_GM_sf2_file"],gm_soprano_sax:["0640_JCLive_sf2_file","0640_Aspirin_sf2_file","0640_Chaos_sf2_file","0640_FluidR3_GM_sf2_file","0641_FluidR3_GM_sf2_file"],gm_alto_sax:["0650_JCLive_sf2_file","0650_Chaos_sf2_file","0650_FluidR3_GM_sf2_file","0650_GeneralUserGS_sf2_file","0651_Aspirin_sf2_file","0651_FluidR3_GM_sf2_file"],gm_tenor_sax:["0660_JCLive_sf2_file","0660_Aspirin_sf2_file","0660_Chaos_sf2_file","0660_GeneralUserGS_sf2_file"],gm_baritone_sax:["0670_JCLive_sf2_file","0670_Aspirin_sf2_file","0670_Chaos_sf2_file","0670_FluidR3_GM_sf2_file","0670_GeneralUserGS_sf2_file","0671_FluidR3_GM_sf2_file"],gm_oboe:["0680_JCLive_sf2_file","0680_Chaos_sf2_file","0680_FluidR3_GM_sf2_file","0680_GeneralUserGS_sf2_file","0681_FluidR3_GM_sf2_file"],gm_english_horn:["0690_JCLive_sf2_file","0690_Aspirin_sf2_file","0690_FluidR3_GM_sf2_file","0691_FluidR3_GM_sf2_file"],gm_bassoon:["0700_JCLive_sf2_file","0700_FluidR3_GM_sf2_file","0700_GeneralUserGS_sf2_file","0701_FluidR3_GM_sf2_file"],gm_clarinet:["0710_JCLive_sf2_file","0710_Aspirin_sf2_file","0710_Chaos_sf2_file","0710_FluidR3_GM_sf2_file","0710_GeneralUserGS_sf2_file","0711_FluidR3_GM_sf2_file"],gm_piccolo:["0720_JCLive_sf2_file","0720_Aspirin_sf2_file","0720_FluidR3_GM_sf2_file","0720_GeneralUserGS_sf2_file","0721_FluidR3_GM_sf2_file"],gm_flute:["0730_JCLive_sf2_file","0730_Aspirin_sf2_file","0730_FluidR3_GM_sf2_file","0730_GeneralUserGS_sf2_file","0731_FluidR3_GM_sf2_file"],gm_recorder:["0740_JCLive_sf2_file","0740_Aspirin_sf2_file","0740_Chaos_sf2_file","0740_FluidR3_GM_sf2_file","0740_GeneralUserGS_sf2_file"],gm_pan_flute:["0750_JCLive_sf2_file","0750_FluidR3_GM_sf2_file","0750_Aspirin_sf2_file","0750_Chaos_sf2_file","0750_GeneralUserGS_sf2_file","0751_Aspirin_sf2_file","0751_FluidR3_GM_sf2_file","0751_GeneralUserGS_sf2_file"],gm_blown_bottle:["0760_FluidR3_GM_sf2_file","0760_JCLive_sf2_file","0760_Chaos_sf2_file","0760_GeneralUserGS_sf2_file","0761_FluidR3_GM_sf2_file"],gm_shakuhachi:["0770_JCLive_sf2_file","0771_FluidR3_GM_sf2_file","0770_Aspirin_sf2_file","0770_FluidR3_GM_sf2_file","0770_GeneralUserGS_sf2_file"],gm_whistle:["0780_FluidR3_GM_sf2_file","0780_JCLive_sf2_file","0780_Aspirin_sf2_file","0780_Chaos_sf2_file"],gm_ocarina:["0790_FluidR3_GM_sf2_file","0790_JCLive_sf2_file","0790_Aspirin_sf2_file","0790_GeneralUserGS_sf2_file"],gm_lead_1_square:["0800_Aspirin_sf2_file","0800_Chaos_sf2_file","0800_FluidR3_GM_sf2_file"],gm_lead_2_sawtooth:["0810_JCLive_sf2_file","0810_Aspirin_sf2_file","0810_Chaos_sf2_file","0810_FluidR3_GM_sf2_file","0810_GeneralUserGS_sf2_file","0811_Aspirin_sf2_file","0811_GeneralUserGS_sf2_file"],gm_lead_3_calliope:["0820_JCLive_sf2_file","0820_Aspirin_sf2_file","0820_Chaos_sf2_file","0820_FluidR3_GM_sf2_file","0820_GeneralUserGS_sf2_file","0821_FluidR3_GM_sf2_file","0821_GeneralUserGS_sf2_file"],gm_lead_4_chiff:["0830_JCLive_sf2_file","0830_Aspirin_sf2_file","0830_FluidR3_GM_sf2_file","0830_GeneralUserGS_sf2_file","0831_FluidR3_GM_sf2_file","0831_GeneralUserGS_sf2_file"],gm_lead_5_charang:["0840_JCLive_sf2_file","0840_FluidR3_GM_sf2_file","0840_Aspirin_sf2_file","0840_Chaos_sf2_file","0840_GeneralUserGS_sf2_file","0841_Aspirin_sf2_file","0841_Chaos_sf2_file","0841_FluidR3_GM_sf2_file","0841_GeneralUserGS_sf2_file","0842_FluidR3_GM_sf2_file"],gm_lead_6_voice:["0850_JCLive_sf2_file","0850_Aspirin_sf2_file","0850_FluidR3_GM_sf2_file","0851_FluidR3_GM_sf2_file","0851_GeneralUserGS_sf2_file","0851_JCLive_sf2_file"],gm_lead_7_fifths:["0860_JCLive_sf2_file","0860_Aspirin_sf2_file","0860_Chaos_sf2_file","0860_GeneralUserGS_sf2_file","0861_Aspirin_sf2_file"],gm_lead_8_bass_lead:["0870_JCLive_sf2_file","0870_Aspirin_sf2_file","0870_Chaos_sf2_file","0870_FluidR3_GM_sf2_file","0870_GeneralUserGS_sf2_file"],gm_pad_new_age:["0880_JCLive_sf2_file","0880_Aspirin_sf2_file","0880_Chaos_sf2_file","0880_FluidR3_GM_sf2_file","0880_GeneralUserGS_sf2_file","0881_Aspirin_sf2_file","0881_FluidR3_GM_sf2_file","0881_GeneralUserGS_sf2_file","0882_Aspirin_sf2_file","0882_GeneralUserGS_sf2_file","0885_GeneralUserGS_sf2_file","0887_GeneralUserGS_sf2_file"],gm_pad_warm:["0890_JCLive_sf2_file","0890_Aspirin_sf2_file","0890_Chaos_sf2_file","0890_FluidR3_GM_sf2_file","0890_GeneralUserGS_sf2_file","0891_Aspirin_sf2_file","0891_FluidR3_GM_sf2_file"],gm_pad_poly:["0900_JCLive_sf2_file","0900_Chaos_sf2_file","0900_FluidR3_GM_sf2_file","0900_GeneralUserGS_sf2_file","0901_Aspirin_sf2_file","0901_FluidR3_GM_sf2_file","0901_GeneralUserGS_sf2_file"],gm_pad_choir:["0910_FluidR3_GM_sf2_file","0910_JCLive_sf2_file","0910_Aspirin_sf2_file","0910_GeneralUserGS_sf2_file","0911_GeneralUserGS_sf2_file","0911_JCLive_sf2_file"],gm_pad_bowed:["0920_JCLive_sf2_file","0920_Aspirin_sf2_file","0920_GeneralUserGS_sf2_file","0921_Aspirin_sf2_file","0921_GeneralUserGS_sf2_file"],gm_pad_metallic:["0930_Aspirin_sf2_file","0930_Chaos_sf2_file","0930_FluidR3_GM_sf2_file","0930_GeneralUserGS_sf2_file","0931_Aspirin_sf2_file","0931_FluidR3_GM_sf2_file","0931_GeneralUserGS_sf2_file"],gm_pad_halo:["0940_Chaos_sf2_file","0940_FluidR3_GM_sf2_file","0940_GeneralUserGS_sf2_file","0940_JCLive_sf2_file","0941_Aspirin_sf2_file","0941_FluidR3_GM_sf2_file","0941_GeneralUserGS_sf2_file","0941_JCLive_sf2_file"],gm_pad_sweep:["0950_Aspirin_sf2_file","0950_Chaos_sf2_file","0950_FluidR3_GM_sf2_file","0950_GeneralUserGS_sf2_file","0950_JCLive_sf2_file","0951_FluidR3_GM_sf2_file","0951_GeneralUserGS_sf2_file"],gm_fx_rain:["0960_FluidR3_GM_sf2_file","0960_Chaos_sf2_file","0960_GeneralUserGS_sf2_file","0961_Aspirin_sf2_file","0961_FluidR3_GM_sf2_file","0962_GeneralUserGS_sf2_file"],gm_fx_soundtrack:["0970_FluidR3_GM_sf2_file","0970_Aspirin_sf2_file","0970_GeneralUserGS_sf2_file","0971_FluidR3_GM_sf2_file","0971_GeneralUserGS_sf2_file"],gm_fx_crystal:["0980_Aspirin_sf2_file","0980_JCLive_sf2_file","0980_Chaos_sf2_file","0980_GeneralUserGS_sf2_file","0981_FluidR3_GM_sf2_file","0981_Aspirin_sf2_file","0981_GeneralUserGS_sf2_file","0982_GeneralUserGS_sf2_file","0983_GeneralUserGS_sf2_file","0984_GeneralUserGS_sf2_file"],gm_fx_atmosphere:["0990_JCLive_sf2_file","0990_Aspirin_sf2_file","0990_Chaos_sf2_file","0990_FluidR3_GM_sf2_file","0990_GeneralUserGS_sf2_file","0991_Aspirin_sf2_file","0991_FluidR3_GM_sf2_file","0991_GeneralUserGS_sf2_file","0991_JCLive_sf2_file","0992_FluidR3_GM_sf2_file","0992_JCLive_sf2_file","0993_JCLive_sf2_file","0994_JCLive_sf2_file"],gm_fx_brightness:["1000_JCLive_sf2_file","1000_Aspirin_sf2_file","1000_Chaos_sf2_file","1000_FluidR3_GM_sf2_file","1000_GeneralUserGS_sf2_file","1001_Aspirin_sf2_file","1001_FluidR3_GM_sf2_file","1001_GeneralUserGS_sf2_file","1001_JCLive_sf2_file","1002_Aspirin_sf2_file","1002_FluidR3_GM_sf2_file","1002_GeneralUserGS_sf2_file"],gm_fx_goblins:["1010_FluidR3_GM_sf2_file","1010_JCLive_sf2_file","1010_Aspirin_sf2_file","1010_Chaos_sf2_file","1010_GeneralUserGS_sf2_file","1011_Aspirin_sf2_file","1011_FluidR3_GM_sf2_file","1011_JCLive_sf2_file","1012_Aspirin_sf2_file"],gm_fx_echoes:["1020_FluidR3_GM_sf2_file","1020_JCLive_sf2_file","1020_Aspirin_sf2_file","1020_Chaos_sf2_file","1020_GeneralUserGS_sf2_file","1021_Aspirin_sf2_file","1021_FluidR3_GM_sf2_file","1021_GeneralUserGS_sf2_file","1021_JCLive_sf2_file","1022_GeneralUserGS_sf2_file"],gm_fx_sci_fi:["1030_FluidR3_GM_sf2_file","1030_Aspirin_sf2_file","1030_Chaos_sf2_file","1030_GeneralUserGS_sf2_file","1030_JCLive_sf2_file","1031_Aspirin_sf2_file","1031_FluidR3_GM_sf2_file","1031_GeneralUserGS_sf2_file","1032_FluidR3_GM_sf2_file"],gm_sitar:["1040_Aspirin_sf2_file","1040_FluidR3_GM_sf2_file","1040_JCLive_sf2_file","1040_Chaos_sf2_file","1040_GeneralUserGS_sf2_file","1041_FluidR3_GM_sf2_file","1041_GeneralUserGS_sf2_file"],gm_banjo:["1050_FluidR3_GM_sf2_file","1050_JCLive_sf2_file","1050_Aspirin_sf2_file","1050_Chaos_sf2_file","1050_GeneralUserGS_sf2_file","1051_GeneralUserGS_sf2_file"],gm_shamisen:["1060_JCLive_sf2_file","1060_FluidR3_GM_sf2_file","1060_Aspirin_sf2_file","1060_Chaos_sf2_file","1060_GeneralUserGS_sf2_file","1061_FluidR3_GM_sf2_file","1061_GeneralUserGS_sf2_file"],gm_koto:["1070_FluidR3_GM_sf2_file","1070_JCLive_sf2_file","1070_Aspirin_sf2_file","1070_Chaos_sf2_file","1070_GeneralUserGS_sf2_file","1071_FluidR3_GM_sf2_file","1071_GeneralUserGS_sf2_file","1072_GeneralUserGS_sf2_file","1073_GeneralUserGS_sf2_file"],gm_kalimba:["1080_JCLive_sf2_file","1080_FluidR3_GM_sf2_file","1080_Aspirin_sf2_file","1080_Chaos_sf2_file","1080_GeneralUserGS_sf2_file"],gm_bagpipe:["1090_Aspirin_sf2_file"],gm_fiddle:["1100_JCLive_sf2_file","1100_Aspirin_sf2_file","1100_Chaos_sf2_file","1100_FluidR3_GM_sf2_file","1100_GeneralUserGS_sf2_file","1101_Aspirin_sf2_file","1101_FluidR3_GM_sf2_file","1101_GeneralUserGS_sf2_file","1102_GeneralUserGS_sf2_file"],gm_shanai:["1110_Aspirin_sf2_file","1110_FluidR3_GM_sf2_file","1110_JCLive_sf2_file","1110_Chaos_sf2_file","1110_GeneralUserGS_sf2_file"],gm_tinkle_bell:["1120_Aspirin_sf2_file"],gm_agogo:["1130_JCLive_sf2_file","1130_Aspirin_sf2_file","1130_Chaos_sf2_file","1130_FluidR3_GM_sf2_file","1130_GeneralUserGS_sf2_file","1131_FluidR3_GM_sf2_file"],gm_steel_drums:["1140_FluidR3_GM_sf2_file","1140_Aspirin_sf2_file","1140_JCLive_sf2_file","1140_Chaos_sf2_file","1140_GeneralUserGS_sf2_file","1141_FluidR3_GM_sf2_file"],gm_woodblock:["1150_JCLive_sf2_file","1150_Aspirin_sf2_file","1150_Chaos_sf2_file","1150_FluidR3_GM_sf2_file","1150_GeneralUserGS_sf2_file","1151_FluidR3_GM_sf2_file","1151_GeneralUserGS_sf2_file","1152_FluidR3_GM_sf2_file","1152_GeneralUserGS_sf2_file"],gm_taiko_drum:["1160_JCLive_sf2_file","1160_FluidR3_GM_sf2_file","1160_Aspirin_sf2_file","1160_Chaos_sf2_file","1160_GeneralUserGS_sf2_file","1161_FluidR3_GM_sf2_file","1161_GeneralUserGS_sf2_file","1162_FluidR3_GM_sf2_file","1162_GeneralUserGS_sf2_file","1163_FluidR3_GM_sf2_file"],gm_melodic_tom:["1170_JCLive_sf2_file","1170_Aspirin_sf2_file","1170_Chaos_sf2_file","1170_FluidR3_GM_sf2_file","1170_GeneralUserGS_sf2_file","1171_FluidR3_GM_sf2_file","1171_GeneralUserGS_sf2_file","1172_FluidR3_GM_sf2_file","1173_FluidR3_GM_sf2_file"],gm_synth_drum:["1180_JCLive_sf2_file","1180_Aspirin_sf2_file","1180_Chaos_sf2_file","1180_FluidR3_GM_sf2_file","1180_GeneralUserGS_sf2_file","1181_FluidR3_GM_sf2_file","1181_GeneralUserGS_sf2_file"],gm_reverse_cymbal:["1190_JCLive_sf2_file","1190_Aspirin_sf2_file","1190_Chaos_sf2_file","1190_FluidR3_GM_sf2_file","1190_GeneralUserGS_sf2_file","1191_GeneralUserGS_sf2_file","1192_GeneralUserGS_sf2_file","1193_GeneralUserGS_sf2_file","1194_GeneralUserGS_sf2_file"],gm_guitar_fret_noise:["1200_JCLive_sf2_file","1200_Aspirin_sf2_file","1200_Chaos_sf2_file","1200_FluidR3_GM_sf2_file","1200_GeneralUserGS_sf2_file","1201_Aspirin_sf2_file","1201_GeneralUserGS_sf2_file","1202_GeneralUserGS_sf2_file"],gm_breath_noise:["1210_FluidR3_GM_sf2_file","1210_JCLive_sf2_file","1210_Aspirin_sf2_file","1210_Chaos_sf2_file","1210_GeneralUserGS_sf2_file","1211_Aspirin_sf2_file","1211_GeneralUserGS_sf2_file","1212_GeneralUserGS_sf2_file"],gm_seashore:["1220_JCLive_sf2_file","1220_Aspirin_sf2_file","1220_Chaos_sf2_file","1220_FluidR3_GM_sf2_file","1220_GeneralUserGS_sf2_file","1221_Aspirin_sf2_file","1221_GeneralUserGS_sf2_file","1221_JCLive_sf2_file","1222_Aspirin_sf2_file","1222_GeneralUserGS_sf2_file","1223_Aspirin_sf2_file","1223_GeneralUserGS_sf2_file","1224_Aspirin_sf2_file","1224_GeneralUserGS_sf2_file","1225_GeneralUserGS_sf2_file","1226_GeneralUserGS_sf2_file"],gm_bird_tweet:["1230_FluidR3_GM_sf2_file","1230_JCLive_sf2_file","1230_Aspirin_sf2_file","1230_GeneralUserGS_sf2_file","1231_GeneralUserGS_sf2_file","1232_GeneralUserGS_sf2_file","1234_GeneralUserGS_sf2_file"],gm_telephone:["1240_JCLive_sf2_file","1240_Aspirin_sf2_file","1240_Chaos_sf2_file","1240_FluidR3_GM_sf2_file","1241_Aspirin_sf2_file","1242_GeneralUserGS_sf2_file","1243_Aspirin_sf2_file","1243_GeneralUserGS_sf2_file","1244_Aspirin_sf2_file","1244_GeneralUserGS_sf2_file"],gm_helicopter:["1250_JCLive_sf2_file","1250_Aspirin_sf2_file","1250_FluidR3_GM_sf2_file","1250_GeneralUserGS_sf2_file","1251_FluidR3_GM_sf2_file","1251_GeneralUserGS_sf2_file","1252_Aspirin_sf2_file","1252_FluidR3_GM_sf2_file","1252_GeneralUserGS_sf2_file","1253_GeneralUserGS_sf2_file","1254_GeneralUserGS_sf2_file","1255_GeneralUserGS_sf2_file","1256_GeneralUserGS_sf2_file","1257_GeneralUserGS_sf2_file","1258_GeneralUserGS_sf2_file","1259_GeneralUserGS_sf2_file"],gm_applause:["1260_JCLive_sf2_file","1260_Aspirin_sf2_file","1260_Chaos_sf2_file","1260_FluidR3_GM_sf2_file","1260_GeneralUserGS_sf2_file","1261_Aspirin_sf2_file","1261_GeneralUserGS_sf2_file","1262_Aspirin_sf2_file","1262_GeneralUserGS_sf2_file","1263_Aspirin_sf2_file","1263_GeneralUserGS_sf2_file","1264_Aspirin_sf2_file","1264_GeneralUserGS_sf2_file","1265_Aspirin_sf2_file","1265_GeneralUserGS_sf2_file"],gm_gunshot:["1270_JCLive_sf2_file","1270_Aspirin_sf2_file","1270_Chaos_sf2_file","1270_FluidR3_GM_sf2_file","1270_GeneralUserGS_sf2_file","1271_Aspirin_sf2_file","1271_GeneralUserGS_sf2_file","1272_Aspirin_sf2_file","1272_GeneralUserGS_sf2_file","1273_GeneralUserGS_sf2_file","1274_GeneralUserGS_sf2_file",""]};let defaultSoundfontUrl="https://felixroos.github.io/webaudiofontdata/sound",soundfontUrl=defaultSoundfontUrl,loadCache={};async function loadFont(name){if(loadCache[name])return loadCache[name];const load=async()=>{const url=`${soundfontUrl}/${name}.js`,preset=await fetch(url).then(e=>e.text());let[_,data]=preset.split("={");return eval("{"+data)};return loadCache[name]=load(),loadCache[name]}async function getFontBufferSource(e,t,o){let{note:a="c3",freq:u}=t,l;if(u)l=freqToMidi$2(u);else if(typeof a=="string")l=noteToMidi$1(a);else if(typeof a=="number")l=a;else throw new Error(`unexpected "note" type "${typeof a}"`);const{buffer:p,zone:d}=await getFontPitch(e,l,o),g=o.createBufferSource();g.buffer=p;const f=d.originalPitch-100*d.coarseTune-d.fineTune,A=1*Math.pow(2,(100*l-f)/1200);return g.playbackRate.value=A,d.loopStart>1&&d.loopStart<d.loopEnd&&(g.loop=!0,g.loopStart=d.loopStart/d.sampleRate,g.loopEnd=d.loopEnd/d.sampleRate),g}let bufferCache={};async function getFontPitch(e,t,o){const a=`${e}:::${t}`;if(bufferCache[a])return bufferCache[a];const u=async()=>{const l=await loadFont(e);if(!l)throw new Error(`Could not load soundfont ${e}`);const p=findZone(l,t);if(!p)throw new Error("no soundfont zone found for preset ",e,"pitch",t);const d=await getBuffer(p,o);if(!d)throw new Error(`no soundfont buffer found for preset ${e}, pitch: ${t}`);return{buffer:d,zone:p}};return bufferCache[a]=u(),bufferCache[a]}function findZone(e,t){return e.find(o=>o.keyRangeLow<=t&&o.keyRangeHigh+1>=t)}async function getBuffer(e,t){if(e.sample){console.warn("zone.sample untested!");const a=atob(e.sample);e.buffer=t.createBuffer(1,a.length/2,e.sampleRate);const u=e.buffer.getChannelData(0);let l,p,d;for(var o=0;o<a.length/2;o++)l=a.charCodeAt(o*2),p=a.charCodeAt(o*2+1),l<0&&(l=256+l),p<0&&(p=256+p),d=p*256+l,d>=65536/2&&(d=d-65536),u[o]=d/65536}else if(e.file){const a=e.file.length,u=new ArrayBuffer(a),l=new Uint8Array(u),p=atob(e.file);let d;for(let g=0;g<p.length;g++)d=p.charCodeAt(g),l[g]=d;return new Promise(g=>t.decodeAudioData(u,g))}}function registerSoundfonts(){Object.entries(gm).forEach(([e,t])=>{registerSound(e,async(o,a,u)=>{const[l,p,d,g]=getADSRValues([a.attack,a.decay,a.sustain,a.release]),{duration:f}=a,A=getSoundIndex$1(a.n,t.length),b=t[A],F=getAudioContext(),S=await getFontBufferSource(b,a,F);S.start(o);const k=F.createGain(),$=S.connect(k),R=o+f;getParamADSR($.gain,l,p,d,g,0,.3,o,R,"linear");let I=R+g+.01,z=getVibratoOscillator(S.detune,a,o);getPitchEnvelope(S.detune,a,o,R),S.stop(I);const ie=U=>{};return S.onended=()=>{S.disconnect(),z?.stop(),$.disconnect(),u()},{node:$,stop:ie}},{type:"soundfont",prebake:!0,fonts:t})})}var SoundFont2={exports:{}},hasRequiredSoundFont2;function requireSoundFont2(){return hasRequiredSoundFont2||(hasRequiredSoundFont2=1,(function(e,t){(function(o,a){e.exports=a()})(window,function(){return(function(o){var a={};function u(l){if(a[l])return a[l].exports;var p=a[l]={i:l,l:!1,exports:{}};return o[l].call(p.exports,p,p.exports,u),p.l=!0,p.exports}return u.m=o,u.c=a,u.d=function(l,p,d){u.o(l,p)||Object.defineProperty(l,p,{enumerable:!0,get:d})},u.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},u.t=function(l,p){if(1&p&&(l=u(l)),8&p||4&p&&typeof l=="object"&&l&&l.__esModule)return l;var d=Object.create(null);if(u.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:l}),2&p&&typeof l!="string")for(var g in l)u.d(d,g,function(f){return l[f]}.bind(null,g));return d},u.n=function(l){var p=l&&l.__esModule?function(){return l.default}:function(){return l};return u.d(p,"a",p),p},u.o=function(l,p){return Object.prototype.hasOwnProperty.call(l,p)},u.p="",u(u.s="./src/index.ts")})({"./src/chunk.ts":function(o,a,u){u.r(a),u.d(a,"SF2Chunk",function(){return S});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=u("./src/chunks/index.ts");function g(k){return(g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(k)}function f(k,$){for(var R=0;R<$.length;R++){var I=$[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(k,I.key,I)}}function A(k){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})(k)}function b(k,$){return(b=Object.setPrototypeOf||function(R,I){return R.__proto__=I,R})(k,$)}function F(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}var S=(function(k){function $(z){var ie,U,O,ee,re,oe;return(function(_e,ue){if(!(_e instanceof ue))throw new TypeError("Cannot call a class as a function")})(this,$),U=this,ie=!(O=A($).call(this,z.id,z.length,z.buffer,z.subChunks))||g(O)!=="object"&&typeof O!="function"?F(U):O,ee=F(F(ie)),oe=void 0,(re="subChunks")in ee?Object.defineProperty(ee,re,{value:oe,enumerable:!0,configurable:!0,writable:!0}):ee[re]=oe,ie.subChunks=z.subChunks.map(function(_e){return new $(_e)}),ie}var R,I;return(function(z,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Super expression must either be null or a function");z.prototype=Object.create(ie&&ie.prototype,{constructor:{value:z,writable:!0,configurable:!0}}),ie&&b(z,ie)})($,l.RIFFChunk),R=$,(I=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new l.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var z=this.subChunks.reduce(function(ie,U){if(U.id==="ifil"||U.id==="iver"){if(U.length!==p.SF_VERSION_LENGTH)throw new l.ParseError("Invalid size for the '".concat(U.id,"' sub-chunk"));ie[U.id]="".concat(U.getInt16(),".").concat(U.getInt16(2))}else ie[U.id]=U.getString();return ie},{});if(!z.ifil)throw new l.ParseError("Missing required 'ifil' sub-chunk");if(!z.INAM)throw new l.ParseError("Missing required 'INAM' sub-chunk");return{version:z.ifil,soundEngine:z.isng||"EMU8000",name:z.INAM,rom:z.irom,romVersion:z.iver,creationDate:z.ICRD,author:z.IENG,product:z.IPRD,copyright:z.ICOP,comments:z.ICMT,createdBy:z.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new l.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var z=this.subChunks[0];if(z.id!=="smpl")throw new l.ParseError("Invalid chunk signature","'smpl'","'".concat(z.id,"'"));return z.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new l.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(d.getPresetHeaders)(this.subChunks[0]),presetZones:Object(d.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(d.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(d.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(d.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(d.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(d.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(d.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(d.getSampleHeaders)(this.subChunks[8])}}}])&&f(R.prototype,I),$})()},"./src/chunks/generators.ts":function(o,a,u){u.r(a),u.d(a,"getGenerators",function(){return b});var l=u("./src/riff/index.ts"),p=u("./src/types/index.ts"),d=u("./src/constants.ts"),g=[p.GeneratorType.StartAddrsOffset,p.GeneratorType.EndAddrsOffset,p.GeneratorType.StartLoopAddrsOffset,p.GeneratorType.EndLoopAddrsOffset,p.GeneratorType.StartAddrsCoarseOffset,p.GeneratorType.EndAddrsCoarseOffset,p.GeneratorType.StartLoopAddrsCoarseOffset,p.GeneratorType.KeyNum,p.GeneratorType.Velocity,p.GeneratorType.EndLoopAddrsCoarseOffset,p.GeneratorType.SampleModes,p.GeneratorType.ExclusiveClass,p.GeneratorType.OverridingRootKey],f=[p.GeneratorType.Unused1,p.GeneratorType.Unused2,p.GeneratorType.Unused3,p.GeneratorType.Unused4,p.GeneratorType.Reserved1,p.GeneratorType.Reserved2,p.GeneratorType.Reserved3],A=[p.GeneratorType.KeyRange,p.GeneratorType.VelRange],b=function(F,S){if(F.id!==S)throw new l.ParseError("Unexpected chunk ID","'".concat(S,"'"),"'".concat(F.id,"'"));if(F.length%d.SF_GENERATOR_SIZE)throw new l.ParseError("Invalid size for the '".concat(S,"' sub-chunk"));return F.iterate(function(k){var $=k.getInt16();return p.GeneratorType[$]?S==="pgen"&&g.includes($)||S==="igen"&&f.includes($)?null:A.includes($)?{id:$,range:{lo:k.getByte(),hi:k.getByte()}}:{id:$,value:k.getInt16BE()}:null})}},"./src/chunks/index.ts":function(o,a,u){u.r(a);var l=u("./src/chunks/instruments/index.ts");u.d(a,"getInstrumentHeaders",function(){return l.getInstrumentHeaders});var p=u("./src/chunks/presets/index.ts");u.d(a,"getPresetHeaders",function(){return p.getPresetHeaders});var d=u("./src/chunks/samples/index.ts");u.d(a,"getSampleHeaders",function(){return d.getSampleHeaders});var g=u("./src/chunks/generators.ts");u.d(a,"getGenerators",function(){return g.getGenerators});var f=u("./src/chunks/modulators.ts");u.d(a,"getModulators",function(){return f.getModulators});var A=u("./src/chunks/zones.ts");u.d(a,"getZones",function(){return A.getZones}),u.d(a,"getItemsInZone",function(){return A.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(o,a,u){u.r(a),u.d(a,"getInstrumentHeaders",function(){return d});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=function(g){if(g.id!=="inst")throw new l.ParseError("Unexpected chunk ID","'inst'","'".concat(g.id,"'"));if(g.length%p.SF_INSTRUMENT_HEADER_SIZE)throw new l.ParseError("Invalid size for the 'inst' sub-chunk");return g.iterate(function(f){return{name:f.getString(),bagIndex:f.getInt16()}})}},"./src/chunks/instruments/index.ts":function(o,a,u){u.r(a);var l=u("./src/chunks/instruments/headers.ts");u.d(a,"getInstrumentHeaders",function(){return l.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(o,a,u){u.r(a),u.d(a,"getModulators",function(){return g});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=function(f){return{type:f>>10&63,polarity:f>>9&1,direction:f>>8&1,palette:f>>7&1,index:127&f}},g=function(f,A){if(f.id!==A)throw new l.ParseError("Unexpected chunk ID","'".concat(A,"'"),"'".concat(f.id,"'"));if(f.length%p.SF_MODULATOR_SIZE)throw new l.ParseError("Invalid size for the '".concat(A,"' sub-chunk"));return f.iterate(function(b){return{source:d(b.getInt16BE()),id:b.getInt16BE(),value:b.getInt16BE(),valueSource:d(b.getInt16BE()),transform:b.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(o,a,u){u.r(a),u.d(a,"getPresetHeaders",function(){return d});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=function(g){if(g.id!=="phdr")throw new l.ParseError("Invalid chunk ID","'phdr'","'".concat(g.id,"'"));if(g.length%p.SF_PRESET_HEADER_SIZE)throw new l.ParseError("Invalid size for the 'phdr' sub-chunk");return g.iterate(function(f){return{name:f.getString(),preset:f.getInt16(),bank:f.getInt16(),bagIndex:f.getInt16(),library:f.getUInt32(),genre:f.getUInt32(),morphology:f.getUInt32()}})}},"./src/chunks/presets/index.ts":function(o,a,u){u.r(a);var l=u("./src/chunks/presets/headers.ts");u.d(a,"getPresetHeaders",function(){return l.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(o,a,u){u.r(a),u.d(a,"getSampleHeaders",function(){return d});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=function(g){if(g.id!=="shdr")throw new l.ParseError("Unexpected chunk ID","'shdr'","'".concat(g.id,"'"));if(g.length%p.SF_SAMPLE_HEADER_SIZE)throw new l.ParseError("Invalid size for the 'shdr' sub-chunk");return g.iterate(function(f){return{name:f.getString(),start:f.getUInt32(),end:f.getUInt32(),startLoop:f.getUInt32(),endLoop:f.getUInt32(),sampleRate:f.getUInt32(),originalPitch:f.getByte(),pitchCorrection:f.getChar(),link:f.getInt16(),type:f.getInt16()}})}},"./src/chunks/samples/index.ts":function(o,a,u){u.r(a);var l=u("./src/chunks/samples/headers.ts");u.d(a,"getSampleHeaders",function(){return l.getSampleHeaders})},"./src/chunks/zones.ts":function(o,a,u){u.r(a),u.d(a,"getZones",function(){return g}),u.d(a,"getItemsInZone",function(){return f});var l=u("./src/riff/index.ts"),p=u("./src/constants.ts"),d=u("./src/types/index.ts"),g=function(S,k){if(S.id!==k)throw new l.ParseError("Unexpected chunk ID","'".concat(k,"'"),"'".concat(S.id,"'"));if(S.length%p.SF_BAG_SIZE)throw new l.ParseError("Invalid size for the '".concat(k,"' sub-chunk"));return S.iterate(function($){return{generatorIndex:$.getInt16(),modulatorIndex:$.getInt16()}})},f=function(S,k,$,R,I,z){for(var ie=[],U=0;U<S.length;U++){for(var O=S[U],ee=S[U+1],re=O.bagIndex,oe=ee?ee.bagIndex:k.length,_e=[],ue=void 0,Ce=re;Ce<oe;Ce++){var me=A(Ce,k,$),he=b(Ce,k,R),ve=he[d.GeneratorType.KeyRange]&&he[d.GeneratorType.KeyRange].range,Fe=he[z];if(Fe){var Se=I[Fe.value];Se&&_e.push({keyRange:ve,modulators:me,generators:he,reference:Se})}else Ce-re==0&&(ue={keyRange:ve,modulators:me,generators:he})}ie.push({header:O,globalZone:ue,zones:_e})}return ie},A=function(S,k,$){var R=k[S],I=k[S+1],z=R.modulatorIndex,ie=I?I.modulatorIndex:k.length;return F(z,ie,$)},b=function(S,k,$){var R=k[S],I=k[S+1],z=R.generatorIndex,ie=I?I.generatorIndex:k.length;return F(z,ie,$)},F=function(S,k,$){for(var R={},I=S;I<k;I++){var z=$[I];z&&(R[z.id]=z)}return R}},"./src/constants.ts":function(o,a,u){u.r(a),u.d(a,"SF_VERSION_LENGTH",function(){return l}),u.d(a,"SF_PRESET_HEADER_SIZE",function(){return p}),u.d(a,"SF_BAG_SIZE",function(){return d}),u.d(a,"SF_MODULATOR_SIZE",function(){return g}),u.d(a,"SF_GENERATOR_SIZE",function(){return f}),u.d(a,"SF_INSTRUMENT_HEADER_SIZE",function(){return A}),u.d(a,"SF_SAMPLE_HEADER_SIZE",function(){return b}),u.d(a,"DEFAULT_SAMPLE_RATE",function(){return F});var l=4,p=38,d=4,g=10,f=4,A=22,b=46,F=22050},"./src/index.ts":function(o,a,u){u.r(a);var l=u("./src/types/index.ts");for(var p in l)p!=="default"&&(function(A){u.d(a,A,function(){return l[A]})})(p);var d=u("./src/chunk.ts");u.d(a,"SF2Chunk",function(){return d.SF2Chunk});var g=u("./src/constants.ts");u.d(a,"SF_VERSION_LENGTH",function(){return g.SF_VERSION_LENGTH}),u.d(a,"SF_PRESET_HEADER_SIZE",function(){return g.SF_PRESET_HEADER_SIZE}),u.d(a,"SF_BAG_SIZE",function(){return g.SF_BAG_SIZE}),u.d(a,"SF_MODULATOR_SIZE",function(){return g.SF_MODULATOR_SIZE}),u.d(a,"SF_GENERATOR_SIZE",function(){return g.SF_GENERATOR_SIZE}),u.d(a,"SF_INSTRUMENT_HEADER_SIZE",function(){return g.SF_INSTRUMENT_HEADER_SIZE}),u.d(a,"SF_SAMPLE_HEADER_SIZE",function(){return g.SF_SAMPLE_HEADER_SIZE}),u.d(a,"DEFAULT_SAMPLE_RATE",function(){return g.DEFAULT_SAMPLE_RATE});var f=u("./src/soundFont2.ts");u.d(a,"SoundFont2",function(){return f.SoundFont2})},"./src/riff/chunkIterator.ts":function(o,a,u){u.r(a),u.d(a,"ChunkIterator",function(){return g});var l=u("./src/utils/index.ts");function p(f,A){for(var b=0;b<A.length;b++){var F=A[b];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(f,F.key,F)}}function d(f,A,b){return A in f?Object.defineProperty(f,A,{value:b,enumerable:!0,configurable:!0,writable:!0}):f[A]=b,f}var g=(function(){function f(F){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(function(k,$){if(!(k instanceof $))throw new TypeError("Cannot call a class as a function")})(this,f),d(this,"target",[]),d(this,"chunk",void 0),d(this,"position",0),this.chunk=F,this.position=S}var A,b;return A=f,(b=[{key:"iterate",value:function(F){for(;this.position<this.chunk.length;){var S=F(this);S&&this.target.push(S)}}},{key:"getString",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,S=Object(l.getStringFromBuffer)(this.getBuffer(this.position,F));return this.position+=F,S}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(F){this.position+=F}},{key:"getBuffer",value:function(F,S){return this.chunk.buffer.subarray(F,F+S)}},{key:"currentPosition",get:function(){return this.position}}])&&p(A.prototype,b),f})()},"./src/riff/index.ts":function(o,a,u){u.r(a);var l=u("./src/riff/chunkIterator.ts");u.d(a,"ChunkIterator",function(){return l.ChunkIterator});var p=u("./src/riff/parseError.ts");u.d(a,"ParseError",function(){return p.ParseError});var d=u("./src/riff/parser.ts");u.d(a,"parseBuffer",function(){return d.parseBuffer}),u.d(a,"getChunk",function(){return d.getChunk}),u.d(a,"getChunkLength",function(){return d.getChunkLength}),u.d(a,"getSubChunks",function(){return d.getSubChunks}),u.d(a,"getChunkId",function(){return d.getChunkId});var g=u("./src/riff/riffChunk.ts");u.d(a,"RIFFChunk",function(){return g.RIFFChunk})},"./src/riff/parseError.ts":function(o,a,u){function l(F){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(F)}function p(F,S){return!S||l(S)!=="object"&&typeof S!="function"?(function(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k})(F):S}function d(F){var S=typeof Map=="function"?new Map:void 0;return(d=function(k){if(k===null||($=k,Function.toString.call($).indexOf("[native code]")===-1))return k;var $;if(typeof k!="function")throw new TypeError("Super expression must either be null or a function");if(S!==void 0){if(S.has(k))return S.get(k);S.set(k,R)}function R(){return g(k,arguments,A(this).constructor)}return R.prototype=Object.create(k.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),f(R,k)})(F)}function g(F,S,k){return(g=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}})()?Reflect.construct:function($,R,I){var z=[null];z.push.apply(z,R);var ie=new(Function.bind.apply($,z));return I&&f(ie,I.prototype),ie}).apply(null,arguments)}function f(F,S){return(f=Object.setPrototypeOf||function(k,$){return k.__proto__=$,k})(F,S)}function A(F){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)})(F)}u.r(a),u.d(a,"ParseError",function(){return b});var b=(function(F){function S(k,$,R){return(function(I,z){if(!(I instanceof z))throw new TypeError("Cannot call a class as a function")})(this,S),p(this,A(S).call(this,"".concat(k).concat($&&R?", expected ".concat($,", received ").concat(R):"")))}return(function(k,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create($&&$.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),$&&f(k,$)})(S,d(Error)),S})()},"./src/riff/parser.ts":function(o,a,u){u.r(a),u.d(a,"parseBuffer",function(){return g}),u.d(a,"getChunk",function(){return f}),u.d(a,"getChunkLength",function(){return A}),u.d(a,"getSubChunks",function(){return b}),u.d(a,"getChunkId",function(){return F});var l=u("./src/riff/parseError.ts"),p=u("./src/utils/buffer.ts"),d=u("./src/riff/riffChunk.ts"),g=function(S){var k=F(S);if(k!=="RIFF")throw new l.ParseError("Invalid file format","RIFF",k);var $=F(S,8);if($!=="sfbk")throw new l.ParseError("Invalid signature","sfbk",$);var R=S.subarray(8),I=b(R.subarray(4));return new d.RIFFChunk(k,R.length,R,I)},f=function(S,k){var $=F(S,k),R=A(S,k+4),I=[];return $!=="RIFF"&&$!=="LIST"||(I=b(S.subarray(k+12))),new d.RIFFChunk($,R,S.subarray(k+8),I)},A=function(S,k){return((S=S.subarray(k,k+4))[0]|S[1]<<8|S[2]<<16|S[3]<<24)>>>0},b=function(S){for(var k=[],$=0;$<=S.length-8;){var R=f(S,$);k.push(R),$=($+=8+R.length)%2?$+1:$}return k},F=function(S){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(p.getStringFromBuffer)(S.subarray(k,k+4))}},"./src/riff/riffChunk.ts":function(o,a,u){u.r(a),u.d(a,"RIFFChunk",function(){return f});var l=u("./src/riff/chunkIterator.ts"),p=u("./src/utils/index.ts");function d(A,b){for(var F=0;F<b.length;F++){var S=b[F];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(A,S.key,S)}}function g(A,b,F){return b in A?Object.defineProperty(A,b,{value:F,enumerable:!0,configurable:!0,writable:!0}):A[b]=F,A}var f=(function(){function A(S,k,$,R){(function(I,z){if(!(I instanceof z))throw new TypeError("Cannot call a class as a function")})(this,A),g(this,"id",void 0),g(this,"length",void 0),g(this,"buffer",void 0),g(this,"subChunks",void 0),this.id=S,this.length=k,this.buffer=$,this.subChunks=R}var b,F;return b=A,(F=[{key:"getString",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,k=arguments.length>1?arguments[1]:void 0;return Object(p.getStringFromBuffer)(this.getBuffer(S,k||this.length-S))}},{key:"getInt16",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[S++]|this.buffer[S]<<8}},{key:"getUInt32",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[S++]|this.buffer[S++]<<8|this.buffer[S++]<<16|this.buffer[S]<<24)>>>0}},{key:"getByte",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[S]}},{key:"getChar",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[S]<<24>>24}},{key:"iterator",value:function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new l.ChunkIterator(this,S)}},{key:"iterate",value:function(S){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=new l.ChunkIterator(this,k);return $.iterate(S),$.target}},{key:"getBuffer",value:function(S,k){return this.buffer.subarray(S,S+k)}}])&&d(b.prototype,F),A})()},"./src/soundFont2.ts":function(o,a,u){u.r(a),u.d(a,"SoundFont2",function(){return k});var l=u("./src/types/index.ts"),p=u("./src/chunk.ts"),d=u("./src/riff/index.ts"),g=u("./src/chunks/index.ts"),f=u("./src/utils/index.ts");function A($){for(var R=1;R<arguments.length;R++){var I=arguments[R]!=null?arguments[R]:{},z=Object.keys(I);typeof Object.getOwnPropertySymbols=="function"&&(z=z.concat(Object.getOwnPropertySymbols(I).filter(function(ie){return Object.getOwnPropertyDescriptor(I,ie).enumerable}))),z.forEach(function(ie){S($,ie,I[ie])})}return $}function b($,R){for(var I=0;I<R.length;I++){var z=R[I];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty($,z.key,z)}}function F($,R,I){return R&&b($.prototype,R),I&&b($,I),$}function S($,R,I){return R in $?Object.defineProperty($,R,{value:I,enumerable:!0,configurable:!0,writable:!0}):$[R]=I,$}var k=(function(){function $(R){if((function(z,ie){if(!(z instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,$),S(this,"chunk",void 0),S(this,"metaData",void 0),S(this,"sampleData",void 0),S(this,"samples",void 0),S(this,"presetData",void 0),S(this,"instruments",void 0),S(this,"presets",void 0),S(this,"banks",void 0),!(R instanceof p.SF2Chunk)){var I=Object(d.parseBuffer)(R);R=new p.SF2Chunk(I)}if(R.subChunks.length!==3)throw new d.ParseError("Invalid sfbk structure","3 chunks","".concat(R.subChunks.length," chunks"));this.chunk=R,this.metaData=R.subChunks[0].getMetaData(),this.sampleData=R.subChunks[1].getSampleData(),this.presetData=R.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return F($,null,[{key:"from",value:function(R){return new $(R)}}]),F($,[{key:"getKeyData",value:function(R){var I=this,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(f.memoize)(function(U,O,ee){var re=I.banks[O];if(re){var oe=re.presets[ee];if(oe){var _e=oe.zones.find(function(Fe){return I.isKeyInRange(Fe,U)});if(_e){var ue=_e.instrument,Ce=ue.zones.find(function(Fe){return I.isKeyInRange(Fe,U)});if(Ce){var me=Ce.sample,he=A({},_e.generators,Ce.generators),ve=A({},_e.modulators,Ce.modulators);return{keyNumber:U,preset:oe,instrument:ue,sample:me,generators:he,modulators:ve}}}}}return null})(R,z,ie)}},{key:"isKeyInRange",value:function(R,I){return R.keyRange===void 0||R.keyRange.lo<=I&&R.keyRange.hi>=I}},{key:"getBanks",value:function(){return this.presets.reduce(function(R,I){var z=I.header.bank;return R[z]||(R[z]={presets:[]}),R[z].presets[I.header.preset]=I,R},[])}},{key:"getPresets",value:function(){var R=this.presetData,I=R.presetHeaders,z=R.presetZones,ie=R.presetGenerators,U=R.presetModulators;return Object(g.getItemsInZone)(I,z,U,ie,this.instruments,l.GeneratorType.Instrument).filter(function(O){return O.header.name!=="EOP"}).map(function(O){return{header:O.header,globalZone:O.globalZone,zones:O.zones.map(function(ee){return{keyRange:ee.keyRange,generators:ee.generators,modulators:ee.modulators,instrument:ee.reference}})}})}},{key:"getInstruments",value:function(){var R=this.presetData,I=R.instrumentHeaders,z=R.instrumentZones,ie=R.instrumentModulators,U=R.instrumentGenerators;return Object(g.getItemsInZone)(I,z,ie,U,this.samples,l.GeneratorType.SampleId).filter(function(O){return O.header.name!=="EOI"}).map(function(O){return{header:O.header,globalZone:O.globalZone,zones:O.zones.map(function(ee){return{keyRange:ee.keyRange,generators:ee.generators,modulators:ee.modulators,sample:ee.reference}})}})}},{key:"getSamples",value:function(){var R=this;return this.presetData.sampleHeaders.filter(function(I){return I.name!=="EOS"}).map(function(I){if(I.name!=="EOS"&&I.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(I.sampleRate," hz in sample '").concat(I.name,"'"));return I.originalPitch>=128&&I.originalPitch<=254&&(I.originalPitch=60),I.startLoop-=I.start,I.endLoop-=I.start,{header:I,data:new Int16Array(new Uint8Array(R.sampleData.subarray(2*I.start,2*I.end)).buffer)}})}}]),$})()},"./src/types/bank.ts":function(o,a){},"./src/types/generator.ts":function(o,a,u){var l,p;function d(f,A,b){return A in f?Object.defineProperty(f,A,{value:b,enumerable:!0,configurable:!0,writable:!0}):f[A]=b,f}u.r(a),u.d(a,"GeneratorType",function(){return p}),u.d(a,"DEFAULT_GENERATOR_VALUES",function(){return g}),(function(f){f[f.StartAddrsOffset=0]="StartAddrsOffset",f[f.EndAddrsOffset=1]="EndAddrsOffset",f[f.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",f[f.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",f[f.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",f[f.ModLFOToPitch=5]="ModLFOToPitch",f[f.VibLFOToPitch=6]="VibLFOToPitch",f[f.ModEnvToPitch=7]="ModEnvToPitch",f[f.InitialFilterFc=8]="InitialFilterFc",f[f.InitialFilterQ=9]="InitialFilterQ",f[f.ModLFOToFilterFc=10]="ModLFOToFilterFc",f[f.ModEnvToFilterFc=11]="ModEnvToFilterFc",f[f.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",f[f.ModLFOToVolume=13]="ModLFOToVolume",f[f.Unused1=14]="Unused1",f[f.ChorusEffectsSend=15]="ChorusEffectsSend",f[f.ReverbEffectsSend=16]="ReverbEffectsSend",f[f.Pan=17]="Pan",f[f.Unused2=18]="Unused2",f[f.Unused3=19]="Unused3",f[f.Unused4=20]="Unused4",f[f.DelayModLFO=21]="DelayModLFO",f[f.FreqModLFO=22]="FreqModLFO",f[f.DelayVibLFO=23]="DelayVibLFO",f[f.FreqVibLFO=24]="FreqVibLFO",f[f.DelayModEnv=25]="DelayModEnv",f[f.AttackModEnv=26]="AttackModEnv",f[f.HoldModEnv=27]="HoldModEnv",f[f.DecayModEnv=28]="DecayModEnv",f[f.SustainModEnv=29]="SustainModEnv",f[f.ReleaseModEnv=30]="ReleaseModEnv",f[f.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",f[f.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",f[f.DelayVolEnv=33]="DelayVolEnv",f[f.AttackVolEnv=34]="AttackVolEnv",f[f.HoldVolEnv=35]="HoldVolEnv",f[f.DecayVolEnv=36]="DecayVolEnv",f[f.SustainVolEnv=37]="SustainVolEnv",f[f.ReleaseVolEnv=38]="ReleaseVolEnv",f[f.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",f[f.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",f[f.Instrument=41]="Instrument",f[f.Reserved1=42]="Reserved1",f[f.KeyRange=43]="KeyRange",f[f.VelRange=44]="VelRange",f[f.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",f[f.KeyNum=46]="KeyNum",f[f.Velocity=47]="Velocity",f[f.InitialAttenuation=48]="InitialAttenuation",f[f.Reserved2=49]="Reserved2",f[f.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",f[f.CoarseTune=51]="CoarseTune",f[f.FineTune=52]="FineTune",f[f.SampleId=53]="SampleId",f[f.SampleModes=54]="SampleModes",f[f.Reserved3=55]="Reserved3",f[f.ScaleTuning=56]="ScaleTuning",f[f.ExclusiveClass=57]="ExclusiveClass",f[f.OverridingRootKey=58]="OverridingRootKey",f[f.Unused5=59]="Unused5",f[f.EndOper=60]="EndOper"})(p||(p={}));var g=(d(l={},p.StartAddrsOffset,0),d(l,p.EndAddrsOffset,0),d(l,p.StartLoopAddrsOffset,0),d(l,p.EndLoopAddrsOffset,0),d(l,p.StartAddrsCoarseOffset,0),d(l,p.ModLFOToPitch,0),d(l,p.VibLFOToPitch,0),d(l,p.ModEnvToPitch,0),d(l,p.InitialFilterFc,13500),d(l,p.InitialFilterQ,0),d(l,p.ModLFOToFilterFc,0),d(l,p.ModEnvToFilterFc,0),d(l,p.EndAddrsCoarseOffset,0),d(l,p.ModLFOToVolume,0),d(l,p.ChorusEffectsSend,0),d(l,p.ReverbEffectsSend,0),d(l,p.Pan,0),d(l,p.DelayModLFO,-12e3),d(l,p.FreqModLFO,0),d(l,p.DelayVibLFO,-12e3),d(l,p.FreqVibLFO,0),d(l,p.DelayModEnv,-12e3),d(l,p.AttackModEnv,-12e3),d(l,p.HoldModEnv,-12e3),d(l,p.DecayModEnv,-12e3),d(l,p.SustainModEnv,0),d(l,p.ReleaseModEnv,-12e3),d(l,p.KeyNumToModEnvHold,0),d(l,p.KeyNumToModEnvDecay,0),d(l,p.DelayVolEnv,-12e3),d(l,p.AttackVolEnv,-12e3),d(l,p.HoldVolEnv,-12e3),d(l,p.DecayVolEnv,-12e3),d(l,p.SustainVolEnv,0),d(l,p.ReleaseVolEnv,-12e3),d(l,p.KeyNumToVolEnvHold,0),d(l,p.KeyNumToVolEnvDecay,0),d(l,p.StartLoopAddrsCoarseOffset,0),d(l,p.KeyNum,-1),d(l,p.Velocity,-1),d(l,p.InitialAttenuation,0),d(l,p.EndLoopAddrsCoarseOffset,0),d(l,p.CoarseTune,0),d(l,p.FineTune,0),d(l,p.SampleModes,0),d(l,p.ScaleTuning,100),d(l,p.ExclusiveClass,0),d(l,p.OverridingRootKey,-1),l)},"./src/types/index.ts":function(o,a,u){u.r(a);var l=u("./src/types/bank.ts");for(var p in l)p!=="default"&&(function(R){u.d(a,R,function(){return l[R]})})(p);var d=u("./src/types/generator.ts");u.d(a,"GeneratorType",function(){return d.GeneratorType}),u.d(a,"DEFAULT_GENERATOR_VALUES",function(){return d.DEFAULT_GENERATOR_VALUES});var g=u("./src/types/instrument.ts");for(var p in g)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return g[I]})})(p);var f=u("./src/types/key.ts");for(var p in f)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return f[I]})})(p);var A=u("./src/types/metaData.ts");for(var p in A)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return A[I]})})(p);var b=u("./src/types/modulator.ts");u.d(a,"ControllerType",function(){return b.ControllerType}),u.d(a,"ControllerPolarity",function(){return b.ControllerPolarity}),u.d(a,"ControllerDirection",function(){return b.ControllerDirection}),u.d(a,"ControllerPalette",function(){return b.ControllerPalette}),u.d(a,"Controller",function(){return b.Controller}),u.d(a,"TransformType",function(){return b.TransformType}),u.d(a,"DEFAULT_INSTRUMENT_MODULATORS",function(){return b.DEFAULT_INSTRUMENT_MODULATORS});var F=u("./src/types/preset.ts");for(var p in F)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return F[I]})})(p);var S=u("./src/types/presetData.ts");for(var p in S)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return S[I]})})(p);var k=u("./src/types/sample.ts");u.d(a,"SampleType",function(){return k.SampleType});var $=u("./src/types/zone.ts");for(var p in $)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType","default"].indexOf(p)<0&&(function(I){u.d(a,I,function(){return $[I]})})(p)},"./src/types/instrument.ts":function(o,a){},"./src/types/key.ts":function(o,a){},"./src/types/metaData.ts":function(o,a){},"./src/types/modulator.ts":function(o,a,u){u.r(a),u.d(a,"ControllerType",function(){return l}),u.d(a,"ControllerPolarity",function(){return p}),u.d(a,"ControllerDirection",function(){return d}),u.d(a,"ControllerPalette",function(){return g}),u.d(a,"Controller",function(){return f}),u.d(a,"TransformType",function(){return A}),u.d(a,"DEFAULT_INSTRUMENT_MODULATORS",function(){return F});var l,p,d,g,f,A,b=u("./src/types/generator.ts");(function(S){S[S.Linear=0]="Linear",S[S.Concave=1]="Concave",S[S.Convex=2]="Convex",S[S.Switch=3]="Switch"})(l||(l={})),(function(S){S[S.Unipolar=0]="Unipolar",S[S.Bipolar=1]="Bipolar"})(p||(p={})),(function(S){S[S.Increasing=0]="Increasing",S[S.Decreasing=1]="Decreasing"})(d||(d={})),(function(S){S[S.GeneralController=0]="GeneralController",S[S.MidiController=1]="MidiController"})(g||(g={})),(function(S){S[S.NoController=0]="NoController",S[S.NoteOnVelocity=2]="NoteOnVelocity",S[S.NoteOnKeyNumber=3]="NoteOnKeyNumber",S[S.PolyPressure=10]="PolyPressure",S[S.ChannelPressure=13]="ChannelPressure",S[S.PitchWheel=14]="PitchWheel",S[S.PitchWheelSensitivity=16]="PitchWheelSensitivity",S[S.Link=127]="Link"})(f||(f={})),(function(S){S[S.Linear=0]="Linear",S[S.Absolute=2]="Absolute"})(A||(A={}));var F=[{id:b.GeneratorType.InitialAttenuation,source:{type:l.Concave,polarity:p.Unipolar,direction:d.Decreasing,palette:g.GeneralController,index:f.NoteOnVelocity},value:960,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.InitialFilterFc,source:{type:l.Linear,polarity:p.Unipolar,direction:d.Decreasing,palette:g.GeneralController,index:f.NoteOnVelocity},value:-2400,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.VibLFOToPitch,source:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.ChannelPressure},value:50,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.VibLFOToPitch,source:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.MidiController,index:1},value:50,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.InitialAttenuation,source:{type:l.Concave,polarity:p.Unipolar,direction:d.Decreasing,palette:g.MidiController,index:7},value:960,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.InitialAttenuation,source:{type:l.Linear,polarity:p.Bipolar,direction:d.Increasing,palette:g.MidiController,index:10},value:1e3,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.InitialAttenuation,source:{type:l.Concave,polarity:p.Unipolar,direction:d.Decreasing,palette:g.MidiController,index:11},value:960,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.ReverbEffectsSend,source:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.MidiController,index:91},value:200,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.ChorusEffectsSend,source:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.MidiController,index:93},value:200,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.NoController},transform:A.Linear},{id:b.GeneratorType.CoarseTune,source:{type:l.Linear,polarity:p.Bipolar,direction:d.Increasing,palette:g.GeneralController,index:f.PitchWheel},value:12700,valueSource:{type:l.Linear,polarity:p.Unipolar,direction:d.Increasing,palette:g.GeneralController,index:f.PitchWheelSensitivity},transform:A.Linear}]},"./src/types/preset.ts":function(o,a){},"./src/types/presetData.ts":function(o,a){},"./src/types/sample.ts":function(o,a,u){var l;u.r(a),u.d(a,"SampleType",function(){return l}),(function(p){p[p.EOS=0]="EOS",p[p.Mono=1]="Mono",p[p.Right=2]="Right",p[p.Left=4]="Left",p[p.Linked=8]="Linked",p[p.RomMono=32769]="RomMono",p[p.RomRight=32770]="RomRight",p[p.RomLeft=32772]="RomLeft",p[p.RomLinked=32776]="RomLinked"})(l||(l={}))},"./src/types/zone.ts":function(o,a){},"./src/utils/buffer.ts":function(o,a,u){u.r(a),u.d(a,"getStringFromBuffer",function(){return l});var l=function(p){return new TextDecoder("utf8").decode(p).split(/\0/)[0].trim()}},"./src/utils/index.ts":function(o,a,u){u.r(a);var l=u("./src/utils/buffer.ts");u.d(a,"getStringFromBuffer",function(){return l.getStringFromBuffer});var p=u("./src/utils/memoize.ts");u.d(a,"memoize",function(){return p.memoize})},"./src/utils/memoize.ts":function(o,a,u){u.r(a),u.d(a,"memoize",function(){return l});var l=function(p){var d={};return function(){for(var g=arguments.length,f=new Array(g),A=0;A<g;A++)f[A]=arguments[A];var b=JSON.stringify(f);if(b in d)return d[b];var F=p.apply(void 0,f);return d[b]=F,F}}}})})})(SoundFont2)),SoundFont2.exports}var SoundFont2Exports=requireSoundFont2();const m=e=>Math.pow(2,e/1200),Q=e=>e/1e3,G=(e,t)=>{const o=Math.pow(10,t);return Math.round(e*o)/o};typeof AudioParam<"u"&&(AudioParam.prototype.dahdsr=function(e,t,o,a,u,l,p,d,g){u=Math.max(G(u,4),.001),p=Math.max(G(p,4),.001),g=G(g,4),t=Math.max(t,.001);let f=e;return this.setValueAtTime(t,f),this.setValueAtTime(t,f+=a),this.exponentialRampToValueAtTime(o,f+=u),this.setValueAtTime(o,f+=l),this.exponentialRampToValueAtTime(Math.max(d*o,.001),f+=p),(A,b)=>{this.cancelAndHoldAtTime(A);const F=Math.max(b??t,.001);this.exponentialRampToValueAtTime(F,A+g)}});const T={0:"startAddrOffset",1:"endAddrOffset",2:"startloopAddrsOffset",3:"endloopAddrsOffset",4:"startAddrsCoarseOffset",5:"modLfoToPitch",6:"vibLfoToPitch",7:"modEnvToPitch",8:"initialFilterFc",9:"initialFilterQ",10:"modLfoToFilterFc",11:"modEnvToFilterFc",12:"endAddrsCoarseOffset",13:"modLfoToVolume",14:"unused1",15:"chorusEffectsSend",16:"reverbEffectsSend",17:"pan",18:"unused2",19:"unused3",20:"unused4",21:"delayModLFO",22:"freqModLFO",23:"delayVibLFO",24:"freqVibLFO",25:"delayModEnv",26:"attackModEnv",27:"holdModEnv",28:"decayModEnv",29:"sustainModEnv",30:"releaseModEnv",31:"keyNumToModEnvHold",32:"keyNumToModEnvDecay",33:"delayVolEnv",34:"attackVolEnv",35:"holdVolEnv",36:"decayVolEnv",37:"sustainVolEnv",38:"releaseVolEnv",39:"keyNumToVolEnvHold",40:"keyNumToVolEnvDecay",41:"instrument",42:"reserved1",43:"keyRange",44:"velRange",45:"startloopAddrsCoarseOffset",46:"keyNum",47:"velocity",48:"initialAttenuation",49:"reserved2",50:"endloopAddrsCoarseOffset",51:"coarseTune",52:"fineTune",53:"sampleID",54:"sampleModes",55:"reserved3",56:"scaleTuning",57:"exclusiveClass",58:"overridingRootKey",59:"unused5",60:"endOper"};Object.fromEntries(Object.entries(SoundFont2Exports.DEFAULT_GENERATOR_VALUES).map(([e,t])=>[T[e],t]));const D=(e,t,o,a,u)=>{var l,p,d,g,f,A,b;const F=SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e];if(typeof F!="number")throw new Error(`no default value found for generator with index ${e}`);const S=t.generators[e],k=(p=(l=o.globalZone)==null?void 0:l.generators)==null?void 0:p[e],$=(d=a?.generators)==null?void 0:d[e],R=(f=(g=u.globalZone)==null?void 0:g.generators)==null?void 0:f[e],I=S&&"value"in S?S.value:void 0,z=k&&"value"in k?k.value:void 0,ie=$&&"value"in $?$.value:void 0,U=R&&"value"in R?R.value:void 0,O=(A=I??z)!=null?A:F,ee=(b=ie??U)!=null?b:0;return O+ee},J=e=>SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e]!==void 0,W=(e,t,o)=>{var a,u,l,p;return Object.fromEntries(Array.from(new Set([Object.keys((u=(a=o.globalZone)==null?void 0:a.generators)!=null?u:{}),Object.keys(t.generators),Object.keys((p=(l=t.instrument.globalZone)==null?void 0:l.generators)!=null?p:{}),Object.keys(e.generators)].flat())).filter(J).map(d=>[T[d],D(parseInt(d),e,t.instrument,t,o)]))};function X(e,t,o){let{time:a=e.currentTime}=o;const{midi:u,start:l,velocity:p=.3,startLoop:d,endLoop:g,sampleRate:f,originalPitch:A,pitchCorrection:b,type:F,sampleModes:S=0,overridingRootKey:k,fineTune:$=0,startloopAddrsOffset:R=0,startloopAddrsCoarseOffset:I=0,endloopAddrsOffset:z=0,endloopAddrsCoarseOffset:ie=0,delayVolEnv:U=-12e3,attackVolEnv:O=-12e3,holdVolEnv:ee=-12e3,decayVolEnv:re=-12e3,sustainVolEnv:oe=0,releaseVolEnv:_e=-12e3,pan:ue=0,...Ce}=o,me=100*(k!==void 0&&k!==-1?k:A)+b-$,he=u*100-me,ve=1*Math.pow(2,he/1200);t.playbackRate.value=ve;const Fe=d+R+I*32768,Se=g+z+ie*32768;Se>Fe&&S===1?(t.loopStart=Fe/f,t.loopEnd=Se/f,t.loop=!0):S===3&&console.warn("unimplemented sampleMode 3 (play till end on note off)"),Object.keys(Ce).filter(et=>!["name","instrument","keyRange","sampleID","end"].includes(et)).length;const Ee=e.createGain(),Pe=[a,0,p,m(U),m(O),m(ee),m(re),oe>=960?0:1-Q(oe),m(_e)],Ye=Ee.gain.dahdsr(...Pe),He=e.createStereoPanner();return He.pan.value=ue/1e3,Ee.connect(He),t.connect(Ee),He.connect(e.destination),t.start(a),(et=e.currentTime)=>{t.stop(et+m(_e)),Ye(et)}}function Y(e,t,o={}){const{header:a,data:u}=t,l=new Float32Array(u.length);for(let g=0;g<u.length;g++)l[g]=u[g]/32768;const p=e.createBuffer(1,l.length,a.sampleRate);p.getChannelData(0).set(l);const d=e.createBufferSource();return d.buffer=p,o={...a,...o},X(e,d,o)}const C=(e,t)=>!e.keyRange||e.keyRange.lo<=t&&t<=e.keyRange.hi,x=(e,t)=>e.zones.filter(o=>C(o,t)&&o.instrument).map(o=>o.instrument.zones.filter(a=>C(a,t)).map(a=>{const u=W(a,o,e);return{...a,mergedGenerators:u}})).flat(),ce=(e,t,o,a=e.currentTime)=>{const u=x(t,o).map(l=>Y(e,l.sample,{...l.mergedGenerators,midi:o,time:a}));return(l=e.currentTime)=>{u.forEach(p=>p(l))}};Pattern$1.prototype.soundfont=function(e,t=0){return this.onTrigger((o,a,u,l)=>{const p=getAudioContext(),d=getPlayableNoteValue(o),g=e.presets[t%e.presets.length],f=l,A=[p,g,noteToMidi$1(d),f];ce(...A)(f+o.duration)})};let latestOptions,hydra;async function initHydra(e={}){if(latestOptions&&JSON.stringify(latestOptions)!==JSON.stringify(e)&&document.getElementById("hydra-canvas")?.remove(),latestOptions=e,!document.getElementById("hydra-canvas")){const{src:t="https://unpkg.com/hydra-synth",feedStrudel:o=!1,contextType:a="webgl",pixelRatio:u=1,pixelated:l=!0,...p}={detectAudio:!1,...e},{canvas:d}=getDrawContext("hydra-canvas",{contextType:a,pixelRatio:u,pixelated:l});if(p.canvas=d,await import(t),hydra=new Hydra(p),o){const{canvas:g}=getDrawContext();g.style.display="none",hydra.synth.s0.init({src:g})}}return hydra}function clearHydra(){hydra&&hydra.hush(),globalThis.s0?.clear(),document.getElementById("hydra-canvas")?.remove(),globalThis.speed=speed,globalThis.shape=shape}const H=e=>()=>reify(e).queryArc(getTime(),getTime())[0].value;App.last_eval_error="",App.handle_eval_error=e=>{App.has_error=!0,App.last_eval_error=e?.message||`${e}`,App.set_status(App.last_eval_error)};const{evaluate,scheduler}=webaudioRepl({transpiler,onEvalError:e=>{App.handle_eval_error(e)}});App.scheduler=scheduler,App.app_name="Slide",App.code_query_key="code",App.song_query_key="song",App.cpm_query_key="cpm",App.beat_query_key="beat",App.current_song="",App.events_started=!1,App.audio_started=!1,App.fetch_in_flight=!1,App.status_watch_cancelled=!1,App.default_cpm=60,App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.color_index=0,App.color_cycle_timer=void 0,App.do_partial_updates=!1,App.fetch_delay_seconds=5,App.code_url_max=1800,App.cycle_colors=["#94dd94","rgb(197, 187, 106)","rgb(222, 143, 143)","rgb(127, 155, 210)"],App.get_config=async()=>{let e=await fetch("config/config.json");try{App.config=await e.json()}catch(t){console.error("Failed to parse config.json",t),App.config={}}},App.strudel_init=async()=>{if(App.audio_started){console.info("Audio already initialized");return}console.info("Initializing Audio...");try{console.info("Loading scope..."),await App.ensure_scope(),console.info("Scope loaded"),console.info("Initializing audio context..."),await initAudio(),miniAllStrings();const e="https://raw.githubusercontent.com/felixroos/dough-samples/main";console.info("Loading samples and soundfonts..."),await Promise.all([registerSynthSounds(),registerSoundfonts(),samples("github:tidalcycles/dirt-samples"),samples(`${e}/tidal-drum-machines.json`)]),App.audio_started=!0,App.apply_volume(),console.info("Audio Ready."),App.code_to_play&&(App.play_action(App.code_to_play),App.code_to_play="")}catch(e){throw console.error("Audio Failed:",e),e}},App.set_tempo=()=>{try{App.scheduler.setCps(App.tempo/60)}catch(e){console.debug("Tempo will be applied when audio starts",e)}},App.clear_draw_context=()=>{try{cleanupDraw(!0)}catch(e){console.warn("Failed to clear draw context",e)}},App.reset_eval_state=()=>{App.has_error=!1},App.report_eval_failure=e=>{const t=e?.message||App.last_eval_error||"Failed to evaluate Strudel code";App.last_eval_error=t,App.set_status(t)},App.run_eval=async e=>{App.reset_eval_state(),e=App.filter_code(e),App.set_input(e);try{await evaluate(e)}catch(t){return{ok:!1,error:t}}return App.has_error?{ok:!1,error:new Error(App.last_eval_error||"Evaluation error")}:{ok:!0}},App.normalize_code=(e="")=>e.replace(/\r\n/g,`
`).trim(),App.strip_set_cpm=e=>e.split(`
`).filter(t=>!t.trim().match(/^setCpm\s*\(/)).join(`
`),App.split_by_newlines=e=>{let t="",o=null,a=0,u=0,l=0;const p=[],d=()=>{const g=t.trim();g&&p.push(g),t=""};for(let g=0;g<e.length;g+=1){let f=e[g],A=e[g-1];if(t+=f,o){f===o&&A!=="\\"&&(o=null);continue}if(f==='"'||f==="'"||f==="`"){o=f;continue}if(f==="("?a+=1:f===")"?a=Math.max(0,a-1):f==="["?u+=1:f==="]"?u=Math.max(0,u-1):f==="{"?l+=1:f==="}"&&(l=Math.max(0,l-1)),f!==`
`)continue;const b=e[g+1];a===0&&u===0&&l===0&&!(b===" "||b==="	")&&!(b===`
`)&&d()}return d(),p},App.segment_code=e=>{const t=App.normalize_code(e);if(!t)return[];const o=t.split(/\n{2,}/g).map(u=>u.trim()).filter(Boolean),a=[];for(const u of o){if(!u.includes(`
`)){a.push(u);continue}const l=App.split_by_newlines(u);l.length?a.push(...l):a.push(u)}if(a.length<=1&&t.includes(`
`)){const u=t.split(/\n+/g).map(l=>l.trim()).filter(Boolean);if(u.length>1)return u}return a},App.apply_partial_update=async e=>{const t=App.segment_code(e);if(!t.length)return!1;const o=[];let a=0;for(const l of t){const p=await App.run_eval(l);if(p.ok){o.push(l);continue}a+=1,console.warn("Skipping segment due to error",p.error)}if(!o.length)return!1;const u=o.join(`

`);return App.set_input(u),a>0?App.playing(`Skipped ${a} segment(s)`):App.playing(),!0},App.ensure_strudel_ready=async()=>App.strudel_init?(await App.strudel_init(),!0):(App.set_status("Bundle not loaded. Check console for errors"),console.error("strudel.bundle.js is missing or failed to load"),!1),App.restart_code_scroll=()=>{let e=App.get_input();e&&(e.scrollTop=0),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.start_events=async()=>{if(App.events_started)return;App.events_started=!0,await App.get_config(),App.load_all_storage(),App.create_modals(),App.start_visual(),DOM.ev("#btn-play","click",()=>{let o=App.get_input(),a=o?o.value:"";App.play_action(a,!0)}),DOM.ev("#btn-auto","click",()=>{App.open_auto_modal()}),DOM.ev("#btn-stop","click",()=>{App.stop_action()}),DOM.ev("#btn-songs","click",()=>{App.open_songs_modal()});let e=DOM.el("#image");e&&DOM.ev(e,"click",()=>{App.open_settings_modal()});let t=DOM.el("#title");t&&DOM.ev(t,"click",()=>{App.open_about_modal()}),App.setup_status(),App.setup_volume(),App.setup_auto(),App.setup_input(),App.setup_scope(),App.init_volume_controls(),App.init_tempo_controls(),App.init_code_input_controls(),App.start_keyboard(),DOM.ev(window,"resize",()=>{App.handle_scope_resize()}),App.make_main_visible(),App.set_cpm_from_query(),App.set_beat_title_from_query(),await App.load_song_from_query()||App.load_code_from_query()||App.load_last_code()},App.make_main_visible=()=>{DOM.el("#main").classList.remove("invisible")},App.set_title=e=>{if(e){document.title=`${App.app_name} - ${e}`;return}document.title=App.app_name},App.update_url=(e="")=>{if(!window?.history?.replaceState)return;let t=new URL(window.location.href),o=App.get_input().value.trim();e?t.searchParams.set(App.song_query_key,e):t.searchParams.delete(App.song_query_key),e||o?t.searchParams.set(App.cpm_query_key,`${App.tempo}`):t.searchParams.delete(App.cpm_query_key),o&&!e&&o.length<=App.code_url_max?t.searchParams.set(App.code_query_key,o):t.searchParams.delete(App.code_query_key),!e&&App.beat_title?t.searchParams.set(App.beat_query_key,App.beat_title):t.searchParams.delete(App.beat_query_key),window.history.replaceState({},document.title,`${t.pathname}${t.search}${t.hash}`)},App.get_query_params=()=>new URLSearchParams(window.location.search),App.update_title=()=>{let e=App.app_name,t=App.get_matched_song();t?e=`${e} - ${t.clean_name}`:App.beat_title&&(e=`${e} - ${App.beat_title}`),document.title=e},window.H=H,window.initHydra=initHydra,window.clearHydra=clearHydra,App.filter_code=e=>(e=e.replace(/setcps\s*\([^)]*\)/gi,""),e=e.replace(/setbpm\s*\([^)]*\)/gi,""),e=e.replace(/setcpm\s*\([^)]*\)/gi,""),e=e.replace(/\._?cpm\s*\([^)]*\)/gi,""),e=e.replace(/\n\s*\n\s*\n+/g,`

`),e.trim()),App.code_scroll_frame=void 0,App.code_scroll_last_ts=0,App.code_scroll_direction=1,App.code_scroll_active=!1,App.code_scroll_speed_px_per_second=80,App.code_scroll_pause_until=0,App.code_scroll_wheel_pause_ms=350,App.code_scroll_song_pause_ms=1.2*1e3,App.code_scroll_pending_delay_ms=0,App.input_mirror_time=2.8*1e3,App.setup_input=()=>{App.start_input_resize_observer()},App.get_input=()=>DOM.el("#code-input"),App.defer_code_scroll=e=>{if(!Number.isFinite(e)||e<=0){App.code_scroll_pending_delay_ms=0;return}App.code_scroll_pending_delay_ms=e},App.reset_code_scroll_for_content=(e={})=>{let t=0,o=e.scroll_delay_ms??App.code_scroll_song_pause_ms,a=e.direction??1;if(App.code_scroll_active&&(Number.isFinite(App.code_scroll_pending_delay_ms)&&App.code_scroll_pending_delay_ms>0?t=App.code_scroll_pending_delay_ms:Number.isFinite(o)&&o>0&&(t=o)),App.code_scroll_pending_delay_ms=0,App.code_scroll_direction=a,App.code_scroll_last_ts=0,t<=0||typeof window>"u"){App.code_scroll_pause_until=0;return}window.performance?.now?App.code_scroll_pause_until=window.performance.now()+t:App.code_scroll_pause_until=t},App.set_input=e=>{const t=App.get_input();t&&(t.value=e,t.scrollTop=0,App.reset_code_scroll_for_content())},App.set_code_scroll_button_active=e=>{let t=DOM.el("#code-input-scroll");if(t){if(e){t.classList.add("active");return}t.classList.remove("active")}},App.code_scroll_tick=e=>{if(!App.code_scroll_active){App.code_scroll_frame=void 0;return}let t=App.get_input();if(!t){App.stop_code_scroll();return}if(App.code_scroll_last_ts||(App.code_scroll_last_ts=e),App.code_scroll_pause_until&&e<App.code_scroll_pause_until){App.code_scroll_last_ts=e,App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick);return}App.code_scroll_pause_until=0;let o=e-App.code_scroll_last_ts;App.code_scroll_last_ts=e;let a=App.code_scroll_speed_px_per_second*o/1e3,u=t.scrollTop+a*App.code_scroll_direction,l=Math.max(0,t.scrollHeight-t.clientHeight);if(t.scrollTop=u,l<=0){App.stop_code_scroll();return}App.code_scroll_direction>0&&Math.ceil(t.scrollTop)+1>=l?(t.scrollTop=l,App.reset_code_scroll_for_content({direction:-1})):App.code_scroll_direction<0&&t.scrollTop<=0&&(t.scrollTop=0,App.reset_code_scroll_for_content({direction:1})),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick)},App.start_code_scroll=()=>{if(App.code_scroll_active)return;let e=App.get_input();!e||Math.max(0,e.scrollHeight-e.clientHeight)<=0||(App.code_scroll_active=!0,App.code_scroll_direction=1,App.code_scroll_last_ts=window.performance.now()-16,App.code_scroll_pause_until=0,App.set_code_scroll_button_active(!0),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick))},App.stop_code_scroll=()=>{!App.code_scroll_active&&!App.code_scroll_frame||(App.code_scroll_active=!1,App.code_scroll_direction=1,App.code_scroll_last_ts=0,App.code_scroll_pause_until=0,App.code_scroll_frame&&(window.cancelAnimationFrame(App.code_scroll_frame),App.code_scroll_frame=void 0),App.set_code_scroll_button_active(!1))},App.init_code_input_controls=()=>{let e=DOM.el("#code-input-wrapper"),t=App.get_input(),o=DOM.el("#code-input-scroll"),a=DOM.el("#code-input-max"),u=DOM.el("#code-input-top"),l=DOM.el("#code-input-bottom"),p=DOM.el("#code-input-sounds"),d=DOM.el("#code-input-notes"),g=DOM.el("#code-input-banks");if(u&&DOM.ev(u,"click",f=>{f.preventDefault(),t.scrollTop=0,App.reset_code_scroll_for_content()}),l&&DOM.ev(l,"click",f=>{f.preventDefault(),t.scrollTop=t.scrollHeight,App.reset_code_scroll_for_content({direction:-1})}),o&&DOM.ev(o,"click",f=>{if(f.preventDefault(),App.code_scroll_active){App.stop_code_scroll();return}App.start_code_scroll()}),a&&DOM.ev(a,"click",f=>{App.toggle_max()}),p&&DOM.ev(p,"click",f=>{f.preventDefault(),App.show_sounds_context(f)}),d&&DOM.ev(d,"click",f=>{f.preventDefault(),App.show_notes_context(f)}),g&&DOM.ev(g,"click",f=>{f.preventDefault(),App.show_banks_context(f)}),t){if(DOM.ev(t,"pointerdown",f=>{if(!App.code_scroll_active)return;let b=f.target.getBoundingClientRect();f.clientX>b.right-20&&f.clientY>b.bottom-20||App.stop_code_scroll()}),e){let f=DOM.el("#resize-handle");if(f){let A=!1;DOM.ev(f,"mousedown",b=>{b.preventDefault(),A=!0,document.body.style.userSelect="none",document.body.style.cursor="se-resize",App.activate_top_input_controls(),App.activate_bottom_input_controls(),f.style.opacity="1",f.style.pointerEvents="auto",f.classList.add("active");let F=b.clientX,S=b.clientY,k=e.offsetWidth,$=e.offsetHeight,R=z=>{if(!A)return;let ie=k+(z.clientX-F),U=$+(z.clientY-S),O=getComputedStyle(document.documentElement),ee=parseInt(O.getPropertyValue("--input_min_width")),re=parseInt(O.getPropertyValue("--input_min_height")),oe=parseInt(O.getPropertyValue("--input_max_height"));ie=Math.max(ee,ie),U=Math.max(re,Math.min(oe,U)),e.style.width=`${ie}px`,e.style.height=`${U}px`},I=()=>{A=!1,document.body.style.userSelect="",document.body.style.cursor="",App.deactivate_top_input_controls(),App.deactivate_bottom_input_controls(),f.style.opacity="",f.style.pointerEvents="",f.classList.remove("active"),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",I)};document.addEventListener("mousemove",R),document.addEventListener("mouseup",I)}),DOM.ev(f,"dblclick",b=>{App.toggle_max("restore")})}DOM.ev(e,"mouseover",()=>{let A=DOM.el("#code-input-max");App.input_is_maxed()?A.classList.add("disabled"):A.classList.remove("disabled")})}DOM.ev(t,"wheel",f=>{App.code_scroll_active&&(window.performance?.now?App.code_scroll_pause_until=window.performance.now()+App.code_scroll_wheel_pause_ms:App.code_scroll_pause_until=App.code_scroll_wheel_pause_ms,f.deltaY<0?App.code_scroll_direction=-1:f.deltaY>0&&(App.code_scroll_direction=1))},{passive:!0})}},App.start_input_resize_observer=()=>{let e=DOM.el("#code-input-wrapper");if(!e)return;new ResizeObserver(()=>{App.scope_debouncer.call()}).observe(e)},App.toggle_max=(e="toggle")=>{let t=DOM.el("#code-input-wrapper");if(!t)return;let o=getComputedStyle(document.documentElement),a=parseInt(o.getPropertyValue("--input_height")),u=parseInt(o.getPropertyValue("--input_max_height")),l=parseInt(o.getPropertyValue("--input_max_width"));e==="restore"?(t.style.height=`${a}px`,t.style.width=`${l}%`):App.input_is_maxed()?(t.style.height=`${a}px`,t.style.width=`${l}%`):(t.style.height=`${u}px`,t.style.width=`${l}%`)},App.input_is_maxed=()=>{let e=DOM.el("#code-input-wrapper");if(!e)return;let t=2,o=DOM.el("#main"),a=window.innerWidth,u=getComputedStyle(document.documentElement),l=parseInt(u.getPropertyValue("--input_max_height")),p=parseInt(u.getPropertyValue("--input_max_width")),d=e.offsetHeight,g=e.getBoundingClientRect().width;if(o){let A=getComputedStyle(o),b=parseFloat(A.paddingLeft)||0,F=parseFloat(A.paddingRight)||0,S=o.clientWidth||o.getBoundingClientRect().width;a=Math.max(0,S-b-F)}let f=p/100*a;return!(Math.abs(d-l)>t||Math.abs(g-f)>t)},App.restart_code_scroll=()=>{let e=App.get_input();e&&(e.scrollTop=0),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.add_word_to_input=e=>{let t=App.get_input(),o=t.selectionStart,a=t.selectionEnd;t.value=t.value.substring(0,o)+e+t.value.substring(a),t.selectionStart=t.selectionEnd=o+e.length,t.focus()},App.focus_input=()=>{App.get_input().focus()},App.activate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.activate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.deactivate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.deactivate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.mirror_input=()=>{let e=DOM.el("#code-input");e.classList.add("mirror"),clearTimeout(App.input_mirror_timeout),setTimeout(()=>{e.classList.remove("mirror")},App.input_mirror_time)},App.volume=100,App.volume_step=1,App.setup_volume=()=>{App.update_volume(App.volume)},App.get_volume_slider=()=>DOM.el("#volume-slider"),App.get_volume_value=()=>DOM.el("#volume-value"),App.read_volume_value=e=>{if(!e)return App.volume;const t=e.valueAsNumber;if(Number.isFinite(t))return t;const o=parseInt(e.value,10);return Number.isFinite(o)?o:App.volume},App.refresh_volume_ui=()=>{const e=App.get_volume_slider(),t=App.get_volume_value();e&&(e.value=`${App.volume}`),t&&(t.innerText=`${App.volume}%`)},App.apply_volume=()=>{if(App.audio_started)try{const t=getSuperdoughAudioController()?.output?.destinationGain;if(!t){console.warn("Destination gain node missing");return}t.gain.value=App.volume/100}catch(e){console.error("Failed to apply volume",e)}},App.update_volume=e=>{let t=Number(e);Number.isFinite(t)||(t=App.volume),t=Math.min(100,Math.max(0,t)),App.volume=t,App.refresh_volume_ui(),App.stor_save_volume(),App.apply_volume()},App.init_volume_controls=()=>{const e=App.get_volume_slider(),t=DOM.el("#volume-control"),o=DOM.el("#volume-decrement"),a=DOM.el("#volume-increment");if(!e)return;App.refresh_volume_ui(),App.stor_save_volume(),DOM.ev(e,"input",l=>{App.update_volume(App.read_volume_value(l.target))});const u=l=>{App.update_volume(App.volume+l*App.volume_step)};o&&DOM.ev(o,"click",()=>{u(-1)}),a&&DOM.ev(a,"click",()=>{u(1)}),DOM.ev(t,"auxclick",l=>{l.button===1&&App.update_volume(50)}),DOM.ev(t,"wheel",l=>{l.preventDefault();let p=parseInt(e.step,10)||App.volume_step,d=parseInt(e.value,10);l.deltaY<0?e.value=d+p:e.value=d-p,App.update_volume(App.read_volume_value(e))},{passive:!1})},App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.tempo_commit_delay_ms=500,App.min_tempo=20,App.max_tempo=120,App.tempo_step=5,App.tempo_wheel_commit_timer=void 0,App.tempo_wheel_commit_delay_ms=150,App.schedule_tempo_commit=e=>{if(typeof window>"u"){e();return}App.tempo_debounce_timer&&window.clearTimeout(App.tempo_debounce_timer),App.tempo_debounce_timer=window.setTimeout(()=>{App.tempo_debounce_timer=void 0,e()},App.tempo_commit_delay_ms)},App.schedule_tempo_wheel_commit=()=>{if(typeof window>"u"){App.on_tempo_change(!0,App.tempo);return}App.tempo_wheel_commit_timer&&window.clearTimeout(App.tempo_wheel_commit_timer),App.tempo_wheel_commit_timer=window.setTimeout(()=>{App.tempo_wheel_commit_timer=void 0,App.on_tempo_change(!0,App.tempo)},App.tempo_wheel_commit_delay_ms)},App.get_tempo_slider=()=>DOM.el("#tempo-slider"),App.get_tempo_value=()=>DOM.el("#tempo-value"),App.refresh_tempo_ui=()=>{let e=App.get_tempo_slider(),t=App.get_tempo_value();e&&(e.value=`${App.tempo}`),t&&(t.textContent=`${App.tempo} cpm`)},App.persist_tempo=()=>{if(!(typeof window>"u"))try{App.stor_save_tempo()}catch(e){console.warn("Failed to persist tempo",e)}},App.update_tempo=e=>{let t=parseInt(e,10);Number.isFinite(t)||(t=App.tempo),t=Math.round(t/App.tempo_step)*App.tempo_step,t=Math.min(App.max_tempo,Math.max(App.min_tempo,t)),App.tempo=t,App.refresh_tempo_ui()},App.on_tempo_change=(e=!1,t=void 0)=>{let o=t;o===null&&(o=App.get_tempo_slider()?.value),App.update_tempo(o),e&&App.schedule_tempo_commit(()=>{App.persist_tempo(),App.current_song&&App.update_url(App.current_song),App.set_tempo()})},App.init_tempo_controls=()=>{let e=App.get_tempo_slider(),t=DOM.el("#tempo-control"),o=DOM.el("#tempo-decrement"),a=DOM.el("#tempo-increment");if(!e)return;App.refresh_tempo_ui(),App.persist_tempo(),DOM.ev(e,"input",l=>{App.update_tempo(l.target.value)}),DOM.ev(t,"auxclick",l=>{l.button===1&&(e.value=App.default_cpm,App.update_tempo(App.default_cpm),App.set_tempo())}),DOM.ev(t,"wheel",l=>{if(l.preventDefault(),!e)return;let p=parseInt(e.step,10);(!Number.isFinite(p)||p<=0)&&(p=App.tempo_step);let d=e.valueAsNumber;if(Number.isFinite(d)||(d=App.tempo),l.deltaY<0)d+=p;else if(l.deltaY>0)d-=p;else return;App.on_tempo_change(!1,d),App.schedule_tempo_wheel_commit()},{passive:!1}),DOM.ev(t,"change",()=>{App.on_tempo_change(!0)});let u=l=>{let p=App.tempo+l*App.tempo_step;App.on_tempo_change(!0,p)};o&&DOM.ev(o,"click",()=>{u(-1)}),a&&DOM.ev(a,"click",()=>{u(1)})};function isNamedPitch$6(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$6(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$6=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$6=FIFTHS$6.map(e=>Math.floor(e*7/12));function coordinates$6(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$6[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$6[t]-4*o;return[u*l,u*p]}var FIFTHS_TO_STEPS$3=[3,0,4,1,5,2,6];function pitch$3(e){const[t,o,a]=e,u=FIFTHS_TO_STEPS$3[unaltered$3(t)],l=Math.floor((t+1)/7);if(o===void 0)return{step:u,alt:l,dir:a};const p=o+4*l+STEPS_TO_OCTS$6[u];return{step:u,alt:l,oct:p,dir:a}}function unaltered$3(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$9=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$5=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$5="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$5="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$c=new RegExp("^"+INTERVAL_TONAL_REGEX$5+"|"+INTERVAL_SHORTHAND_REGEX$5+"$");function tokenizeInterval$5(e){const t=REGEX$c.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$9={};function interval$5(e){return typeof e=="string"?cache$9[e]||(cache$9[e]=parse$9(e)):isPitch$6(e)?interval$5(pitchName$7(e)):isNamedPitch$6(e)?interval$5(e.name):NoInterval$5}var SIZES$6=[0,2,4,5,7,9,11],TYPES$5="PMMPPMM";function parse$9(e){const t=tokenizeInterval$5(e);if(t[0]==="")return NoInterval$5;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES$5[u];if(l==="M"&&a==="P")return NoInterval$5;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt$5(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES$6[u]+A+12*b),S=(g*(SIZES$6[u]+A)%12+12)%12,k=coordinates$6({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function coordToInterval$2(e,t){const[o,a=0]=e,u=o*7+a*12<0,l=t||u?[-o,-a,-1]:[o,a,1];return interval$5(pitch$3(l))}function qToAlt$5(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$7(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES$5[t]==="M"?"majorable":"perfectable";return d+p+altToQ$5(g,o)}function altToQ$5(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$9("A",t):fillStr$9("d",e==="perfectable"?t:t+1)}function isNamedPitch$5(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$5(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$5=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$5=FIFTHS$5.map(e=>Math.floor(e*7/12));function coordinates$5(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$5[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$5[t]-4*o;return[u*l,u*p]}var FIFTHS_TO_STEPS$2=[3,0,4,1,5,2,6];function pitch$2(e){const[t,o,a]=e,u=FIFTHS_TO_STEPS$2[unaltered$2(t)],l=Math.floor((t+1)/7);if(o===void 0)return{step:u,alt:l,dir:a};const p=o+4*l+STEPS_TO_OCTS$5[u];return{step:u,alt:l,oct:p,dir:a}}function unaltered$2(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$8=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote$1=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),cache$8=new Map,stepToLetter$1=e=>"CDEFGAB".charAt(e),altToAcc$1=e=>e<0?fillStr$8("b",-e):fillStr$8("#",e),accToAlt$1=e=>e[0]==="b"?-e.length:e.length;function note$1(e){const t=JSON.stringify(e),o=cache$8.get(t);if(o)return o;const a=typeof e=="string"?parse$8(e):isPitch$5(e)?note$1(pitchName$6(e)):isNamedPitch$5(e)?note$1(e.name):NoNote$1;return cache$8.set(t,a),a}var REGEX$b=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote$1(e){const t=REGEX$b.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote$1(e){return note$1(pitch$2(e))}var mod$1=(e,t)=>(e%t+t)%t,SEMI$1=[0,2,4,5,7,9,11];function parse$8(e){const t=tokenizeNote$1(e);if(t[0]===""||t[3]!=="")return NoNote$1;const o=t[0],a=t[1],u=t[2],l=(o.charCodeAt(0)+3)%7,p=accToAlt$1(a),d=u.length?+u:void 0,g=coordinates$5({step:l,alt:p,oct:d}),f=o+a+u,A=o+a,b=(SEMI$1[l]+p+120)%12,F=d===void 0?mod$1(SEMI$1[l]+p,12)-1188:SEMI$1[l]+p+12*(d+1),S=F>=0&&F<=127?F:null,k=d===void 0?null:Math.pow(2,(F-69)/12)*440;return{empty:!1,acc:a,alt:p,chroma:b,coord:g,freq:k,height:F,letter:o,midi:S,name:f,oct:d,pc:A,step:l}}function pitchName$6(e){const{step:t,alt:o,oct:a}=e,u=stepToLetter$1(t);if(!u)return"";const l=u+altToAcc$1(o);return a||a===0?l+a:l}function transpose$5(e,t){const o=note$1(e),a=Array.isArray(t)?t:interval$5(t).coord;if(o.empty||!a||a.length<2)return"";const u=o.coord,l=u.length===1?[u[0]+a[0]]:[u[0]+a[0],u[1]+a[1]];return coordToNote$1(l).name}function tonicIntervalsTransposer$1(e,t){const o=e.length;return a=>{if(!t)return"";const u=a<0?(o- -a%o)%o:a%o,l=Math.floor(a/o),p=transpose$5(t,[0,l]);return transpose$5(p,e[u])}}function distance$5(e,t){const o=note$1(e),a=note$1(t);if(o.empty||a.empty)return"";const u=o.coord,l=a.coord,p=l[0]-u[0],d=u.length===2&&l.length===2?l[1]-u[1]:-Math.floor(p*7/12),g=a.height===o.height&&a.midi!==null&&o.oct===a.oct&&o.step>a.step;return coordToInterval$2([p,d],g).name}var fillStr$7=(e,t)=>Array(t+1).join(e),REGEX$a=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function tokenize$4(e){const t=REGEX$a.exec(e);return t?[t[1],t[2],t[3]]:["","",""]}function abcToScientificNotation(e){const[t,o,a]=tokenize$4(e);if(o==="")return"";let u=4;for(let p=0;p<a.length;p++)u+=a.charAt(p)===","?-1:1;const l=t[0]==="_"?t.replace(/_/g,"b"):t[0]==="^"?t.replace(/\^/g,"#"):"";return o.charCodeAt(0)>96?o.toUpperCase()+l+(u+1):o+l+u}function scientificToAbcNotation(e){const t=note$1(e);if(t.empty||!t.oct&&t.oct!==0)return"";const{letter:o,acc:a,oct:u}=t,l=a[0]==="b"?a.replace(/b/g,"_"):a.replace(/#/g,"^"),p=u>4?o.toLowerCase():o,d=u===5?"":u>4?fillStr$7("'",u-5):fillStr$7(",",4-u);return l+p+d}function transpose$4(e,t){return scientificToAbcNotation(transpose$5(abcToScientificNotation(e),t))}function distance$4(e,t){return distance$5(abcToScientificNotation(e),abcToScientificNotation(t))}var abc_notation_default={abcToScientificNotation,scientificToAbcNotation,tokenize:tokenize$4,transpose:transpose$4,distance:distance$4};function ascR$1(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR$1(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range$1(e,t){return e<t?ascR$1(e,t-e+1):descR$1(e,e-t+1)}function rotate$1(e,t){const o=t.length,a=(e%o+o)%o;return t.slice(a,o).concat(t.slice(0,a))}function compact$1(e){return e.filter(t=>t===0||t)}function sortedNoteNames(e){return e.map(o=>note$1(o)).filter(o=>!o.empty).sort((o,a)=>o.height-a.height).map(o=>o.name)}function sortedUniqNoteNames(e){return sortedNoteNames(e).filter((t,o,a)=>o===0||t!==a[o-1])}function shuffle$1(e,t=Math.random){let o,a,u=e.length;for(;u;)o=Math.floor(t()*u--),a=e[u],e[u]=e[o],e[o]=a;return e}function permutations$1(e){return e.length===0?[[]]:permutations$1(e.slice(1)).reduce((t,o)=>t.concat(e.map((a,u)=>{const l=o.slice();return l.splice(u,0,e[0]),l})),[])}const index$6=Object.freeze(Object.defineProperty({__proto__:null,compact:compact$1,permutations:permutations$1,range:range$1,rotate:rotate$1,shuffle:shuffle$1,sortedNoteNames,sortedUniqNoteNames},Symbol.toStringTag,{value:"Module"}));function ascR(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range(e,t){return e<t?ascR(e,t-e+1):descR(e,e-t+1)}function rotate(e,t){const o=t.length,a=(e%o+o)%o;return t.slice(a,o).concat(t.slice(0,a))}function compact(e){return e.filter(t=>t===0||t)}function shuffle(e,t=Math.random){let o,a,u=e.length;for(;u;)o=Math.floor(t()*u--),a=e[u],e[u]=e[o],e[o]=a;return e}function permutations(e){return e.length===0?[[]]:permutations(e.slice(1)).reduce((t,o)=>t.concat(e.map((a,u)=>{const l=o.slice();return l.splice(u,0,e[0]),l})),[])}var collection_default={compact,permutations,range,rotate,shuffle};function isNamedPitch$4(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$4(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$4=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$4=FIFTHS$4.map(e=>Math.floor(e*7/12));function coordinates$4(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$4[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$4[t]-4*o;return[u*l,u*p]}var fillStr$6=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$4=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$4="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$4="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$9=new RegExp("^"+INTERVAL_TONAL_REGEX$4+"|"+INTERVAL_SHORTHAND_REGEX$4+"$");function tokenizeInterval$4(e){const t=REGEX$9.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$7={};function interval$4(e){return typeof e=="string"?cache$7[e]||(cache$7[e]=parse$7(e)):isPitch$4(e)?interval$4(pitchName$5(e)):isNamedPitch$4(e)?interval$4(e.name):NoInterval$4}var SIZES$5=[0,2,4,5,7,9,11],TYPES$4="PMMPPMM";function parse$7(e){const t=tokenizeInterval$4(e);if(t[0]==="")return NoInterval$4;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES$4[u];if(l==="M"&&a==="P")return NoInterval$4;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt$4(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES$5[u]+A+12*b),S=(g*(SIZES$5[u]+A)%12+12)%12,k=coordinates$4({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function qToAlt$4(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$5(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES$4[t]==="M"?"majorable":"perfectable";return d+p+altToQ$4(g,o)}function altToQ$4(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$6("A",t):fillStr$6("d",e==="perfectable"?t:t+1)}var EmptyPcset={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},setNumToChroma=e=>Number(e).toString(2).padStart(12,"0"),chromaToNumber=e=>parseInt(e,2),REGEX$8=/^[01]{12}$/;function isChroma(e){return REGEX$8.test(e)}var isPcsetNum=e=>typeof e=="number"&&e>=0&&e<=4095,isPcset=e=>e&&isChroma(e.chroma),cache$6={[EmptyPcset.chroma]:EmptyPcset};function get$b(e){const t=isChroma(e)?e:isPcsetNum(e)?setNumToChroma(e):Array.isArray(e)?listToChroma(e):isPcset(e)?e.chroma:EmptyPcset.chroma;return cache$6[t]=cache$6[t]||chromaToPcset(t)}var pcset$1=get$b,chroma$3=e=>get$b(e).chroma,intervals=e=>get$b(e).intervals,num$1=e=>get$b(e).setNum,IVLS=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function chromaToIntervals(e){const t=[];for(let o=0;o<12;o++)e.charAt(o)==="1"&&t.push(IVLS[o]);return t}function notes$1(e){return get$b(e).intervals.map(t=>transpose$5("C",t))}function chromas(){return range(2048,4095).map(setNumToChroma)}function modes$1(e,t=!0){const a=get$b(e).chroma.split("");return compact(a.map((u,l)=>{const p=rotate(l,a);return t&&p[0]==="0"?null:p.join("")}))}function isEqual(e,t){return get$b(e).setNum===get$b(t).setNum}function isSubsetOf(e){const t=get$b(e).setNum;return o=>{const a=get$b(o).setNum;return t&&t!==a&&(a&t)===a}}function isSupersetOf(e){const t=get$b(e).setNum;return o=>{const a=get$b(o).setNum;return t&&t!==a&&(a|t)===a}}function isNoteIncludedIn(e){const t=get$b(e);return o=>{const a=note$1(o);return t&&!a.empty&&t.chroma.charAt(a.chroma)==="1"}}function filter(e){const t=isNoteIncludedIn(e);return o=>o.filter(t)}var pcset_default={get:get$b,chroma:chroma$3,num:num$1,intervals,chromas,isSupersetOf,isSubsetOf,isNoteIncludedIn,isEqual,filter,modes:modes$1,notes:notes$1,pcset:pcset$1};function chromaRotations(e){const t=e.split("");return t.map((o,a)=>rotate(a,t).join(""))}function chromaToPcset(e){const t=chromaToNumber(e),o=chromaRotations(e).map(chromaToNumber).filter(l=>l>=2048).sort()[0],a=setNumToChroma(o),u=chromaToIntervals(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:a,intervals:u}}function listToChroma(e){if(e.length===0)return EmptyPcset.chroma;let t;const o=[0,0,0,0,0,0,0,0,0,0,0,0];for(let a=0;a<e.length;a++)t=note$1(e[a]),t.empty&&(t=interval$4(e[a])),t.empty||(o[t.chroma]=1);return o.join("")}var CHORDS$3=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$5=CHORDS$3;({...EmptyPcset});var dictionary$4=[],index$5={};function all$4(){return dictionary$4.slice()}function add$6(e,t,o){const a=getQuality$3(e),u={...get$b(e),name:o||"",quality:a,intervals:e,aliases:t};dictionary$4.push(u),u.name&&(index$5[u.name]=u),index$5[u.setNum]=u,index$5[u.chroma]=u,u.aliases.forEach(l=>addAlias$4(u,l))}function addAlias$4(e,t){index$5[t]=e}function getQuality$3(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$5.forEach(([e,t,o])=>add$6(e.split(" "),o.split(" "),t)),dictionary$4.sort((e,t)=>e.setNum-t.setNum);var namedSet=e=>{const t=e.reduce((o,a)=>{const u=note$1(a).chroma;return u!==void 0&&(o[u]=o[u]||note$1(a).name),o},{});return o=>t[o]};function detect$1(e,t={}){const o=e.map(u=>note$1(u).pc).filter(u=>u);return note$1.length===0?[]:findMatches(o,1,t).filter(u=>u.weight).sort((u,l)=>l.weight-u.weight).map(u=>u.name)}var BITMASK={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},testChromaNumber=e=>t=>!!(t&e),hasAnyThird=testChromaNumber(BITMASK.anyThirds),hasPerfectFifth=testChromaNumber(BITMASK.perfectFifth),hasAnySeventh=testChromaNumber(BITMASK.anySeventh),hasNonPerfectFifth=testChromaNumber(BITMASK.nonPerfectFifths);function hasAnyThirdAndPerfectFifthAndAnySeventh(e){const t=parseInt(e.chroma,2);return hasAnyThird(t)&&hasPerfectFifth(t)&&hasAnySeventh(t)}function withPerfectFifth(e){const t=parseInt(e,2);return hasNonPerfectFifth(t)?e:(t|16).toString(2)}function findMatches(e,t,o){const a=e[0],u=note$1(a).chroma,l=namedSet(e),p=modes$1(e,!1),d=[];return p.forEach((g,f)=>{const A=o.assumePerfectFifth&&withPerfectFifth(g);all$4().filter(F=>o.assumePerfectFifth&&hasAnyThirdAndPerfectFifthAndAnySeventh(F)?F.chroma===A:F.chroma===g).forEach(F=>{const S=F.aliases[0],k=l(f);f!==u?d.push({weight:.5*t,name:`${k}${S}/${a}`}):d.push({weight:1*t,name:`${k}${S}`})})}),d}function isNamedPitch$3(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}var SIZES$4=[0,2,4,5,7,9,11],chroma$2=({step:e,alt:t})=>(SIZES$4[e]+t+120)%12,height=({step:e,alt:t,oct:o,dir:a=1})=>a*(SIZES$4[e]+t+12*(o===void 0?-100:o)),midi$1=e=>{const t=height(e);return e.oct!==void 0&&t>=-12&&t<=115?t+12:null};function isPitch$3(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var FIFTHS$3=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$3=FIFTHS$3.map(e=>Math.floor(e*7/12));function coordinates$3(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$3[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$3[t]-4*o;return[u*l,u*p]}var FIFTHS_TO_STEPS$1=[3,0,4,1,5,2,6];function pitch$1(e){const[t,o,a]=e,u=FIFTHS_TO_STEPS$1[unaltered$1(t)],l=Math.floor((t+1)/7);if(o===void 0)return{step:u,alt:l,dir:a};const p=o+4*l+STEPS_TO_OCTS$3[u];return{step:u,alt:l,oct:p,dir:a}}function unaltered$1(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$5=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$3={empty:!0,name:"",acc:""},INTERVAL_TONAL_REGEX$3="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$3="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$7=new RegExp("^"+INTERVAL_TONAL_REGEX$3+"|"+INTERVAL_SHORTHAND_REGEX$3+"$");function tokenizeInterval$3(e){const t=REGEX$7.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$5={};function interval$3(e){return typeof e=="string"?cache$5[e]||(cache$5[e]=parse$6(e)):isPitch$3(e)?interval$3(pitchName$4(e)):isNamedPitch$3(e)?interval$3(e.name):NoInterval$3}var SIZES$3=[0,2,4,5,7,9,11],TYPES$3="PMMPPMM";function parse$6(e){const t=tokenizeInterval$3(e);if(t[0]==="")return NoInterval$3;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES$3[u];if(l==="M"&&a==="P")return NoInterval$3;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt$3(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES$3[u]+A+12*b),S=(g*(SIZES$3[u]+A)%12+12)%12,k=coordinates$3({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function coordToInterval$1(e,t){const[o,a=0]=e,u=o*7+a*12<0,l=t||u?[-o,-a,-1]:[o,a,1];return interval$3(pitch$1(l))}function qToAlt$3(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$4(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES$3[t]==="M"?"majorable":"perfectable";return d+p+altToQ$3(g,o)}function altToQ$3(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$5("A",t):fillStr$5("d",e==="perfectable"?t:t+1)}var fillStr$4=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote={empty:!0,name:"",pc:"",acc:""},cache$4=new Map,stepToLetter=e=>"CDEFGAB".charAt(e),altToAcc=e=>e<0?fillStr$4("b",-e):fillStr$4("#",e),accToAlt=e=>e[0]==="b"?-e.length:e.length;function note(e){const t=JSON.stringify(e),o=cache$4.get(t);if(o)return o;const a=typeof e=="string"?parse$5(e):isPitch$3(e)?note(pitchName$3(e)):isNamedPitch$3(e)?note(e.name):NoNote;return cache$4.set(t,a),a}var REGEX$6=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote(e){const t=REGEX$6.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote(e){return note(pitch$1(e))}var mod=(e,t)=>(e%t+t)%t,SEMI=[0,2,4,5,7,9,11];function parse$5(e){const t=tokenizeNote(e);if(t[0]===""||t[3]!=="")return NoNote;const o=t[0],a=t[1],u=t[2],l=(o.charCodeAt(0)+3)%7,p=accToAlt(a),d=u.length?+u:void 0,g=coordinates$3({step:l,alt:p,oct:d}),f=o+a+u,A=o+a,b=(SEMI[l]+p+120)%12,F=d===void 0?mod(SEMI[l]+p,12)-1188:SEMI[l]+p+12*(d+1),S=F>=0&&F<=127?F:null,k=d===void 0?null:Math.pow(2,(F-69)/12)*440;return{empty:!1,acc:a,alt:p,chroma:b,coord:g,freq:k,height:F,letter:o,midi:S,name:f,oct:d,pc:A,step:l}}function pitchName$3(e){const{step:t,alt:o,oct:a}=e,u=stepToLetter(t);if(!u)return"";const l=u+altToAcc(o);return a||a===0?l+a:l}function transpose$3(e,t){const o=note(e),a=Array.isArray(t)?t:interval$3(t).coord;if(o.empty||!a||a.length<2)return"";const u=o.coord,l=u.length===1?[u[0]+a[0]]:[u[0]+a[0],u[1]+a[1]];return coordToNote(l).name}function tonicIntervalsTransposer(e,t){const o=e.length;return a=>{if(!t)return"";const u=a<0?(o- -a%o)%o:a%o,l=Math.floor(a/o),p=transpose$3(t,[0,l]);return transpose$3(p,e[u])}}function distance$3(e,t){const o=note(e),a=note(t);if(o.empty||a.empty)return"";const u=o.coord,l=a.coord,p=l[0]-u[0],d=u.length===2&&l.length===2?l[1]-u[1]:-Math.floor(p*7/12),g=a.height===o.height&&a.midi!==null&&o.midi!==null&&o.step>a.step;return coordToInterval$1([p,d],g).name}var fillStr$3=(e,t)=>Array(Math.abs(t)+1).join(e);function deprecate(e,t,o){return function(...a){return console.warn(`${e} is deprecated. Use ${t}.`),o.apply(this,a)}}var isNamed=deprecate("isNamed","isNamedPitch",isNamedPitch$3);const Core=Object.freeze(Object.defineProperty({__proto__:null,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"}));var CHORDS$2=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$4=CHORDS$2,NoChordType={...EmptyPcset,name:"",quality:"Unknown",intervals:[],aliases:[]},dictionary$3=[],index$4={};function get$a(e){return index$4[e]||NoChordType}var chordType=deprecate("ChordType.chordType","ChordType.get",get$a);function names$8(){return dictionary$3.map(e=>e.name).filter(e=>e)}function symbols(){return dictionary$3.map(e=>e.aliases[0]).filter(e=>e)}function keys$1(){return Object.keys(index$4)}function all$3(){return dictionary$3.slice()}var entries$2=deprecate("ChordType.entries","ChordType.all",all$3);function removeAll$1(){dictionary$3=[],index$4={}}function add$5(e,t,o){const a=getQuality$2(e),u={...get$b(e),name:o||"",quality:a,intervals:e,aliases:t};dictionary$3.push(u),u.name&&(index$4[u.name]=u),index$4[u.setNum]=u,index$4[u.chroma]=u,u.aliases.forEach(l=>addAlias$3(u,l))}function addAlias$3(e,t){index$4[t]=e}function getQuality$2(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$4.forEach(([e,t,o])=>add$5(e.split(" "),o.split(" "),t)),dictionary$3.sort((e,t)=>e.setNum-t.setNum);var chord_type_default={names:names$8,symbols,get:get$a,all:all$3,add:add$5,removeAll:removeAll$1,keys:keys$1,entries:entries$2,chordType},SCALES=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],data_default$3=SCALES,NoScaleType={...EmptyPcset,intervals:[],aliases:[]},dictionary$2=[],index$3={};function names$7(){return dictionary$2.map(e=>e.name)}function get$9(e){return index$3[e]||NoScaleType}var scaleType=get$9;function all$2(){return dictionary$2.slice()}var entries$1=all$2;function keys(){return Object.keys(index$3)}function removeAll(){dictionary$2=[],index$3={}}function add$4(e,t,o=[]){const a={...get$b(e),name:t,intervals:e,aliases:o};return dictionary$2.push(a),index$3[a.name]=a,index$3[a.setNum]=a,index$3[a.chroma]=a,a.aliases.forEach(u=>addAlias$2(a,u)),a}function addAlias$2(e,t){index$3[t]=e}data_default$3.forEach(([e,t,...o])=>add$4(e.split(" "),t,o));var scale_type_default={names:names$7,get:get$9,all:all$2,add:add$4,removeAll,keys,entries:entries$1,scaleType},NoChord={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize$3(e){const[t,o,a,u]=tokenizeNote(e);return t===""?["",e]:t==="A"&&u==="ug"?["","aug"]:[t+o,a+u]}function get$8(e){if(e==="")return NoChord;if(Array.isArray(e)&&e.length===2)return getChord(e[1],e[0]);{const[t,o]=tokenize$3(e),a=getChord(o,t);return a.empty?getChord(e):a}}function getChord(e,t,o){const a=get$a(e),u=note(t||""),l=note(o||"");if(a.empty||t&&u.empty||o&&l.empty)return NoChord;const p=distance$3(u.pc,l.pc),d=a.intervals.indexOf(p)+1;if(!l.empty&&!d)return NoChord;const g=Array.from(a.intervals);for(let F=1;F<d;F++){const S=g[0][0],k=g[0][1],$=parseInt(S,10)+7;g.push(`${$}${k}`),g.shift()}const f=u.empty?[]:g.map(F=>transpose$3(u,F));e=a.aliases.indexOf(e)!==-1?e:a.aliases[0];const A=`${u.empty?"":u.pc}${e}${l.empty||d<=1?"":"/"+l.pc}`,b=`${t?u.pc+" ":""}${a.name}${d>1&&o?" over "+l.pc:""}`;return{...a,name:b,symbol:A,type:a.name,root:l.name,intervals:g,rootDegree:d,tonic:u.name,notes:f}}var chord=deprecate("Chord.chord","Chord.get",get$8);function transpose$2(e,t){const[o,a]=tokenize$3(e);return o?transpose$3(o,t)+a:e}function chordScales(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$2().filter(a=>o(a.chroma)).map(a=>a.name)}function extended$1(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$3().filter(a=>o(a.chroma)).map(a=>t.tonic+a.aliases[0])}function reduced$1(e){const t=get$8(e),o=isSubsetOf(t.chroma);return all$3().filter(a=>o(a.chroma)).map(a=>t.tonic+a.aliases[0])}function degrees$1(e){const{intervals:t,tonic:o}=get$8(e),a=tonicIntervalsTransposer(t,o);return u=>u?a(u>0?u-1:u):""}function steps$1(e){const{intervals:t,tonic:o}=get$8(e);return tonicIntervalsTransposer(t,o)}var chord_default={getChord,get:get$8,detect:detect$1,chordScales,extended:extended$1,reduced:reduced$1,tokenize:tokenize$3,transpose:transpose$2,degrees:degrees$1,steps:steps$1,chord},DATA=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],data_default$2=DATA,VALUES=[];data_default$2.forEach(([e,t,o])=>add$3(e,t,o));var NoDuration={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function names$6(){return VALUES.reduce((e,t)=>(t.names.forEach(o=>e.push(o)),e),[])}function shorthands(){return VALUES.map(e=>e.shorthand)}var REGEX$5=/^([^.]+)(\.*)$/;function get$7(e){const[t,o,a]=REGEX$5.exec(e)||[],u=VALUES.find(d=>d.shorthand===o||d.names.includes(o));if(!u)return NoDuration;const l=calcDots(u.fraction,a.length),p=l[0]/l[1];return{...u,name:e,dots:a,value:p,fraction:l}}var value=e=>get$7(e).value,fraction=e=>get$7(e).fraction,duration_value_default={names:names$6,shorthands,get:get$7,value,fraction};function add$3(e,t,o){VALUES.push({empty:!1,dots:"",name:"",value:1/e,fraction:e<1?[1/e,1]:[1,e],shorthand:t,names:o})}function calcDots(e,t){const o=Math.pow(2,t);let a=e[0]*o,u=e[1]*o;const l=a;for(let p=0;p<t;p++)a+=l/Math.pow(2,p+1);for(;a%2===0&&u%2===0;)a/=2,u/=2;return[a,u]}function names$5(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var get$6=interval$3,name$1=e=>interval$3(e).name,semitones=e=>interval$3(e).semitones,quality=e=>interval$3(e).q,num=e=>interval$3(e).num;function simplify$2(e){const t=interval$3(e);return t.empty?"":t.simple+t.q}function invert(e){const t=interval$3(e);if(t.empty)return"";const o=(7-t.step)%7,a=t.type==="perfectable"?-t.alt:-(t.alt+1);return interval$3({step:o,alt:a,oct:t.oct,dir:t.dir}).name}var IN=[1,2,2,3,3,4,5,5,6,6,7,7],IQ="P m M m M P d P m M m M".split(" ");function fromSemitones(e){const t=e<0?-1:1,o=Math.abs(e),a=o%12,u=Math.floor(o/12);return t*(IN[a]+7*u)+IQ[a]}var distance$2=distance$5,add$2=combinator((e,t)=>[e[0]+t[0],e[1]+t[1]]),addTo=e=>t=>add$2(e,t),substract=combinator((e,t)=>[e[0]-t[0],e[1]-t[1]]);function transposeFifths$2(e,t){const o=get$6(e);if(o.empty)return"";const[a,u,l]=o.coord;return coordToInterval$1([a+t,u,l]).name}var interval_default={names:names$5,get:get$6,name:name$1,num,semitones,quality,fromSemitones,distance:distance$2,invert,simplify:simplify$2,add:add$2,addTo,substract,transposeFifths:transposeFifths$2};function combinator(e){return(t,o)=>{const a=interval$3(t).coord,u=interval$3(o).coord;if(a&&u){const l=e(a,u);return coordToInterval$1(l).name}}}function isMidi(e){return+e>=0&&+e<=127}function toMidi(e){if(isMidi(e))return+e;const t=note$1(e);return t.empty?null:t.midi}function midiToFreq(e,t=440){return Math.pow(2,(e-69)/12)*t}var L2=Math.log(2),L440=Math.log(440);function freqToMidi(e){const t=12*(Math.log(e)-L440)/L2+69;return Math.round(t*100)/100}var SHARPS="C C# D D# E F F# G G# A A# B".split(" "),FLATS="C Db D Eb E F Gb G Ab A Bb B".split(" ");function midiToNoteName(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const a=(t.sharps===!0?SHARPS:FLATS)[e%12];if(t.pitchClass)return a;const u=Math.floor(e/12)-1;return a+u}function chroma$1(e){return e%12}function pcsetFromChroma(e){return e.split("").reduce((t,o,a)=>(a<12&&o==="1"&&t.push(a),t),[])}function pcsetFromMidi(e){return e.map(chroma$1).sort((t,o)=>t-o).filter((t,o,a)=>o===0||t!==a[o-1])}function pcset(e){return Array.isArray(e)?pcsetFromMidi(e):pcsetFromChroma(e)}function pcsetNearest(e){const t=pcset(e);return o=>{const a=chroma$1(o);for(let u=0;u<12;u++){if(t.includes(a+u))return o+u;if(t.includes(a-u))return o-u}}}function pcsetSteps(e,t){const o=pcset(e),a=o.length;return u=>{const l=u<0?(a- -u%a)%a:u%a,p=Math.floor(u/a);return o[l]+p*12+t}}function pcsetDegrees(e,t){const o=pcsetSteps(e,t);return a=>{if(a!==0)return o(a>0?a-1:a)}}var index_default$4={chroma:chroma$1,freqToMidi,isMidi,midiToFreq,midiToNoteName,pcsetNearest,pcset,pcsetDegrees,pcsetSteps,toMidi},NAMES$2=["C","D","E","F","G","A","B"],toName=e=>e.name,onlyNotes=e=>e.map(note$1).filter(t=>!t.empty);function names$4(e){return e===void 0?NAMES$2.slice():Array.isArray(e)?onlyNotes(e).map(toName):[]}var get$5=note$1,name=e=>get$5(e).name,pitchClass=e=>get$5(e).pc,accidentals=e=>get$5(e).acc,octave=e=>get$5(e).oct,midi=e=>get$5(e).midi,freq=e=>get$5(e).freq,chroma=e=>get$5(e).chroma;function fromMidi(e){return midiToNoteName(e)}function fromFreq(e){return midiToNoteName(freqToMidi(e))}function fromFreqSharps(e){return midiToNoteName(freqToMidi(e),{sharps:!0})}function fromMidiSharps(e){return midiToNoteName(e,{sharps:!0})}var distance$1=distance$5,transpose$1=transpose$5,tr=transpose$5,transposeBy=e=>t=>transpose$1(t,e),trBy=transposeBy,transposeFrom=e=>t=>transpose$1(e,t),trFrom=transposeFrom;function transposeFifths$1(e,t){return transpose$1(e,[t,0])}var trFifths=transposeFifths$1;function transposeOctaves(e,t){return transpose$1(e,[0,t])}var ascending=(e,t)=>e.height-t.height,descending=(e,t)=>t.height-e.height;function sortedNames(e,t){return t=t||ascending,onlyNotes(e).sort(t).map(toName)}function sortedUniqNames(e){return sortedNames(e,ascending).filter((t,o,a)=>o===0||t!==a[o-1])}var simplify$1=e=>{const t=get$5(e);return t.empty?"":midiToNoteName(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function enharmonic(e,t){const o=get$5(e);if(o.empty)return"";const a=get$5(t||midiToNoteName(o.midi||o.chroma,{sharps:o.alt<0,pitchClass:!0}));if(a.empty||a.chroma!==o.chroma)return"";if(o.oct===void 0)return a.pc;const u=o.chroma-o.alt,l=a.chroma-a.alt,p=u>11||l<0?-1:u<0||l>11?1:0,d=o.oct+p;return a.pc+d}var index_default$3={names:names$4,get:get$5,name,pitchClass,accidentals,octave,midi,ascending,descending,distance:distance$1,sortedNames,sortedUniqNames,fromMidi,fromMidiSharps,freq,fromFreq,fromFreqSharps,chroma,transpose:transpose$1,tr,transposeBy,trBy,transposeFrom,trFrom,transposeFifths:transposeFifths$1,transposeOctaves,trFifths,simplify:simplify$1,enharmonic};function isNamedPitch$2(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$2(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$2=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$2=FIFTHS$2.map(e=>Math.floor(e*7/12));function coordinates$2(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$2[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$2[t]-4*o;return[u*l,u*p]}var fillStr$2=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$2=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$2="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$2="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$4=new RegExp("^"+INTERVAL_TONAL_REGEX$2+"|"+INTERVAL_SHORTHAND_REGEX$2+"$");function tokenizeInterval$2(e){const t=REGEX$4.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$3={};function interval$2(e){return typeof e=="string"?cache$3[e]||(cache$3[e]=parse$4(e)):isPitch$2(e)?interval$2(pitchName$2(e)):isNamedPitch$2(e)?interval$2(e.name):NoInterval$2}var SIZES$2=[0,2,4,5,7,9,11],TYPES$2="PMMPPMM";function parse$4(e){const t=tokenizeInterval$2(e);if(t[0]==="")return NoInterval$2;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES$2[u];if(l==="M"&&a==="P")return NoInterval$2;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt$2(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES$2[u]+A+12*b),S=(g*(SIZES$2[u]+A)%12+12)%12,k=coordinates$2({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function qToAlt$2(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$2(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES$2[t]==="M"?"majorable":"perfectable";return d+p+altToQ$2(g,o)}function altToQ$2(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$2("A",t):fillStr$2("d",e==="perfectable"?t:t+1)}var NoRomanNumeral={empty:!0,name:"",chordType:""},cache$2={};function get$4(e){return typeof e=="string"?cache$2[e]||(cache$2[e]=parse$3(e)):typeof e=="number"?get$4(NAMES$1[e]||""):isPitch$2(e)?fromPitch(e):isNamedPitch$2(e)?get$4(e.name):NoRomanNumeral}var romanNumeral=get$4;function names$3(e=!0){return(e?NAMES$1:NAMES_MINOR).slice()}function fromPitch(e){return get$4(altToAcc$1(e.alt)+NAMES$1[e.step])}var REGEX$3=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function tokenize$2(e){return REGEX$3.exec(e)||["","","",""]}var ROMANS="I II III IV V VI VII",NAMES$1=ROMANS.split(" "),NAMES_MINOR=ROMANS.toLowerCase().split(" ");function parse$3(e){const[t,o,a,u]=tokenize$2(e);if(!a)return NoRomanNumeral;const l=a.toUpperCase(),p=NAMES$1.indexOf(l),d=accToAlt$1(o),g=1;return{empty:!1,name:t,roman:a,interval:interval$2({step:p,alt:d,dir:g}).name,acc:o,chordType:u,alt:d,step:p,major:a===l,oct:0,dir:g}}var roman_numeral_default={names:names$3,get:get$4,romanNumeral},Empty=Object.freeze([]),NoKey={type:"major",tonic:"",alteration:0,keySignature:""},NoKeyScale={tonic:"",grades:Empty,intervals:Empty,scale:Empty,triads:Empty,chords:Empty,chordsHarmonicFunction:Empty,chordScales:Empty,secondaryDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty,substituteDominants:Empty,substituteDominantSupertonics:Empty,secondaryDominantsMinorRelative:Empty},NoMajorKey={...NoKey,...NoKeyScale,type:"major",minorRelative:"",scale:Empty,substituteDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty},NoMinorKey={...NoKey,type:"minor",relativeMajor:"",natural:NoKeyScale,harmonic:NoKeyScale,melodic:NoKeyScale},mapScaleToType=(e,t,o="")=>t.map((a,u)=>`${e[u]}${o}${a}`);function keyScale(e,t,o,a,u){return l=>{const p=e.map(S=>get$4(S).interval||""),d=p.map(S=>transpose$1(l,S)),g=mapScaleToType(d,o),f=d.map(S=>transpose$1(S,"5P")).map(S=>d.includes(S)&&!g.includes(S+"7")?S+"7":""),A=supertonics(f,t),b=f.map(S=>{if(!S)return"";const k=S.slice(0,-1);return transpose$1(k,"5d")+"7"}),F=supertonics(b,t);return{tonic:l,grades:e,intervals:p,scale:d,triads:mapScaleToType(d,t),chords:g,chordsHarmonicFunction:a.slice(),chordScales:mapScaleToType(d,u," "),secondaryDominants:f,secondaryDominantSupertonics:A,substituteDominants:b,substituteDominantSupertonics:F,secondaryDominantsMinorRelative:A,substituteDominantsMinorRelative:F}}}var supertonics=(e,t)=>e.map((o,a)=>{if(!o)return"";const u=o.slice(0,-1),l=transpose$1(u,"5P");return t[a].endsWith("m")?l+"m7":l+"m7b5"}),distInFifths=(e,t)=>{const o=note$1(e),a=note$1(t);return o.empty||a.empty?0:a.coord[0]-o.coord[0]},MajorScale=keyScale("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),NaturalScale=keyScale("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),HarmonicScale=keyScale("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),MelodicScale=keyScale("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function majorKey(e){const t=note$1(e).pc;if(!t)return NoMajorKey;const o=MajorScale(t),a=distInFifths("C",t);return{...o,type:"major",minorRelative:transpose$1(t,"-3m"),alteration:a,keySignature:altToAcc$1(a)}}function minorKey(e){const t=note$1(e).pc;if(!t)return NoMinorKey;const o=distInFifths("C",t)-3;return{type:"minor",tonic:t,relativeMajor:transpose$1(t,"3m"),alteration:o,keySignature:altToAcc$1(o),natural:NaturalScale(t),harmonic:HarmonicScale(t),melodic:MelodicScale(t)}}function majorTonicFromKeySignature(e){return typeof e=="number"?transposeFifths$1("C",e):typeof e=="string"&&/^b+|#+$/.test(e)?transposeFifths$1("C",accToAlt$1(e)):null}var index_default$2={majorKey,majorTonicFromKeySignature,minorKey};function isNamedPitch$1(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$1(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$1=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$1=FIFTHS$1.map(e=>Math.floor(e*7/12));function coordinates$1(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS$1[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS$1[t]-4*o;return[u*l,u*p]}var FIFTHS_TO_STEPS=[3,0,4,1,5,2,6];function pitch(e){const[t,o,a]=e,u=FIFTHS_TO_STEPS[unaltered(t)],l=Math.floor((t+1)/7);if(o===void 0)return{step:u,alt:l,dir:a};const p=o+4*l+STEPS_TO_OCTS$1[u];return{step:u,alt:l,oct:p,dir:a}}function unaltered(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$1=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$1=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$1="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$1="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$2=new RegExp("^"+INTERVAL_TONAL_REGEX$1+"|"+INTERVAL_SHORTHAND_REGEX$1+"$");function tokenizeInterval$1(e){const t=REGEX$2.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$1={};function interval$1(e){return typeof e=="string"?cache$1[e]||(cache$1[e]=parse$2(e)):isPitch$1(e)?interval$1(pitchName$1(e)):isNamedPitch$1(e)?interval$1(e.name):NoInterval$1}var SIZES$1=[0,2,4,5,7,9,11],TYPES$1="PMMPPMM";function parse$2(e){const t=tokenizeInterval$1(e);if(t[0]==="")return NoInterval$1;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES$1[u];if(l==="M"&&a==="P")return NoInterval$1;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt$1(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES$1[u]+A+12*b),S=(g*(SIZES$1[u]+A)%12+12)%12,k=coordinates$1({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function coordToInterval(e,t){const[o,a=0]=e,l=o*7+a*12<0?[-o,-a,-1]:[o,a,1];return interval$1(pitch(l))}function qToAlt$1(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$1(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES$1[t]==="M"?"majorable":"perfectable";return d+p+altToQ$1(g,o)}function altToQ$1(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$1("A",t):fillStr$1("d",e==="perfectable"?t:t+1)}var get$3=interval$1;function simplify(e){const t=interval$1(e);return t.empty?"":t.simple+t.q}function transposeFifths(e,t){const o=get$3(e);if(o.empty)return"";const[a,u,l]=o.coord;return coordToInterval([a+t,u,l]).name}var MODES=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],NoMode={...EmptyPcset,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},modes=MODES.map(toMode),index$2={};modes.forEach(e=>{index$2[e.name]=e,e.aliases.forEach(t=>{index$2[t]=e})});function get$2(e){return typeof e=="string"?index$2[e.toLowerCase()]||NoMode:e&&e.name?get$2(e.name):NoMode}var mode=get$2;function all$1(){return modes.slice()}var entries=all$1;function names$2(){return modes.map(e=>e.name)}function toMode(e){const[t,o,a,u,l,p,d]=e,g=d?[d]:[],f=Number(o).toString(2);return{empty:!1,intervals:get$9(u).intervals,modeNum:t,chroma:f,normalized:f,name:u,setNum:o,alt:a,triad:l,seventh:p,aliases:g}}function notes(e,t){return get$2(e).intervals.map(o=>transpose$5(t,o))}function chords(e){return(t,o)=>{const a=get$2(t);if(a.empty)return[];const u=rotate(a.modeNum,e),l=a.intervals.map(p=>transpose$5(o,p));return u.map((p,d)=>l[d]+p)}}var triads$1=chords(MODES.map(e=>e[4])),seventhChords=chords(MODES.map(e=>e[5]));function distance(e,t){const o=get$2(t),a=get$2(e);return o.empty||a.empty?"":simplify(transposeFifths("1P",a.alt-o.alt))}function relativeTonic(e,t,o){return transpose$5(o,distance(e,t))}var mode_default={get:get$2,names:names$2,all:all$1,distance,relativeTonic,notes,triads:triads$1,seventhChords,entries,mode},CHORDS$1=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$1=CHORDS$1;({...EmptyPcset});var dictionary$1=[],index$1={};function add$1(e,t,o){const a=getQuality$1(e),u={...get$b(e),name:o||"",quality:a,intervals:e,aliases:t};dictionary$1.push(u),u.name&&(index$1[u.name]=u),index$1[u.setNum]=u,index$1[u.chroma]=u,u.aliases.forEach(l=>addAlias$1(u,l))}function addAlias$1(e,t){index$1[t]=e}function getQuality$1(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$1.forEach(([e,t,o])=>add$1(e.split(" "),o.split(" "),t)),dictionary$1.sort((e,t)=>e.setNum-t.setNum);function isNamedPitch(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS=[0,2,4,-1,1,3,5],STEPS_TO_OCTS=FIFTHS.map(e=>Math.floor(e*7/12));function coordinates(e){const{step:t,alt:o,oct:a,dir:u=1}=e,l=FIFTHS[t]+7*o;if(a===void 0)return[u*l];const p=a-STEPS_TO_OCTS[t]-4*o;return[u*l,u*p]}var fillStr=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$1=new RegExp("^"+INTERVAL_TONAL_REGEX+"|"+INTERVAL_SHORTHAND_REGEX+"$");function tokenizeInterval(e){const t=REGEX$1.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache={};function interval(e){return typeof e=="string"?cache[e]||(cache[e]=parse$1(e)):isPitch(e)?interval(pitchName(e)):isNamedPitch(e)?interval(e.name):NoInterval}var SIZES=[0,2,4,5,7,9,11],TYPES="PMMPPMM";function parse$1(e){const t=tokenizeInterval(e);if(t[0]==="")return NoInterval;const o=+t[0],a=t[1],u=(Math.abs(o)-1)%7,l=TYPES[u];if(l==="M"&&a==="P")return NoInterval;const p=l==="M"?"majorable":"perfectable",d=""+o+a,g=o<0?-1:1,f=o===8||o===-8?o:g*(u+1),A=qToAlt(p,a),b=Math.floor((Math.abs(o)-1)/7),F=g*(SIZES[u]+A+12*b),S=(g*(SIZES[u]+A)%12+12)%12,k=coordinates({step:u,alt:A,oct:b,dir:g});return{empty:!1,name:d,num:o,q:a,step:u,alt:A,dir:g,type:p,simple:f,semitones:F,chroma:S,coord:k,oct:b}}function qToAlt(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName(e){const{step:t,alt:o,oct:a=0,dir:u}=e;if(!u)return"";const l=t+1+7*a,p=l===0?t+1:l,d=u<0?"-":"",g=TYPES[t]==="M"?"majorable":"perfectable";return d+p+altToQ(g,o)}function altToQ(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr("A",t):fillStr("d",e==="perfectable"?t:t+1)}function tokenize$1(e){const[t,o,a,u]=tokenizeNote$1(e);return t===""?tokenizeBass("",e):t==="A"&&u==="ug"?tokenizeBass("","aug"):tokenizeBass(t+o,a+u)}function tokenizeBass(e,t){const o=t.split("/");if(o.length===1)return[e,o[0],""];const[a,u,l,p]=tokenizeNote$1(o[1]);return a!==""&&l===""&&p===""?[e,o[0],a+u]:[e,t,""]}function fromRomanNumerals(e,t){return t.map(get$4).map(a=>transpose$5(e,interval(a))+a.chordType)}function toRomanNumerals(e,t){return t.map(o=>{const[a,u]=tokenize$1(o),l=distance$5(e,a);return get$4(interval(l)).name+u})}var progression_default={fromRomanNumerals,toRomanNumerals};function numeric(e){const t=compact(e.map(o=>typeof o=="number"?o:toMidi(o)));return!e.length||t.length!==e.length?[]:t.reduce((o,a)=>{const u=o[o.length-1];return o.concat(range(u,a).slice(1))},[t[0]])}function chromatic(e,t){return numeric(e).map(o=>midiToNoteName(o,t))}var index_default$1={numeric,chromatic},CHORDS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default=CHORDS;({...EmptyPcset});var dictionary=[],index={};function all(){return dictionary.slice()}function add(e,t,o){const a=getQuality(e),u={...get$b(e),name:o||"",quality:a,intervals:e,aliases:t};dictionary.push(u),u.name&&(index[u.name]=u),index[u.setNum]=u,index[u.chroma]=u,u.aliases.forEach(l=>addAlias(u,l))}function addAlias(e,t){index[t]=e}function getQuality(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default.forEach(([e,t,o])=>add(e.split(" "),o.split(" "),t)),dictionary.sort((e,t)=>e.setNum-t.setNum);var NoScale={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),o=note$1(e.substring(0,t));if(o.empty){const u=note$1(e);return u.empty?["",e.toLowerCase()]:[u.name,""]}const a=e.substring(o.name.length+1).toLowerCase();return[o.name,a.length?a:""]}var names$1=names$7;function get$1(e){const t=Array.isArray(e)?e:tokenize(e),o=note$1(t[0]).name,a=get$9(t[1]);if(a.empty)return NoScale;const u=a.name,l=o?a.intervals.map(d=>transpose$5(o,d)):[],p=o?o+" "+u:u;return{...a,name:p,type:u,tonic:o,notes:l}}var scale$1=get$1;function detect(e,t={}){const o=chroma$3(e),a=note$1(t.tonic??e[0]??""),u=a.chroma;if(u===void 0)return[];const l=o.split("");l[u]="1";const p=rotate(u,l).join(""),d=all$2().find(f=>f.chroma===p),g=[];return d&&g.push(a.name+" "+d.name),t.match==="exact"||extended(p).forEach(f=>{g.push(a.name+" "+f)}),g}function scaleChords(e){const t=get$1(e),o=isSubsetOf(t.chroma);return all().filter(a=>o(a.chroma)).map(a=>a.aliases[0])}function extended(e){const t=isChroma(e)?e:get$1(e).chroma,o=isSupersetOf(t);return all$2().filter(a=>o(a.chroma)).map(a=>a.name)}function reduced(e){const t=isSubsetOf(get$1(e).chroma);return all$2().filter(o=>t(o.chroma)).map(o=>o.name)}function scaleNotes(e){const t=e.map(u=>note$1(u).pc).filter(u=>u),o=t[0],a=sortedUniqNames(t);return rotate(a.indexOf(o),a)}function modeNames(e){const t=get$1(e);if(t.empty)return[];const o=t.tonic?t.notes:t.intervals;return modes$1(t.chroma).map((a,u)=>{const l=get$1(a).name;return l?[o[u],l]:["",""]}).filter(a=>a[0])}function getNoteNameOf(e){const t=Array.isArray(e)?scaleNotes(e):get$1(e).notes,o=t.map(a=>note$1(a).chroma);return a=>{const u=note$1(typeof a=="number"?fromMidi(a):a),l=u.height;if(l===void 0)return;const p=l%12,d=o.indexOf(p);if(d!==-1)return enharmonic(u.name,t[d])}}function rangeOf(e){const t=getNoteNameOf(e);return(o,a)=>{const u=note$1(o).height,l=note$1(a).height;return u===void 0||l===void 0?[]:range(u,l).map(t).filter(p=>p)}}function degrees(e){const{intervals:t,tonic:o}=get$1(e),a=tonicIntervalsTransposer$1(t,o);return u=>u?a(u>0?u-1:u):""}function steps(e){const{intervals:t,tonic:o}=get$1(e);return tonicIntervalsTransposer$1(t,o)}var index_default={degrees,detect,extended,get:get$1,modeNames,names:names$1,rangeOf,reduced,scaleChords,scaleNotes,steps,tokenize,scale:scale$1},NONE={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},NAMES=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function names(){return NAMES.slice()}var REGEX=/^(\d*\d(?:\+\d)*)\/(\d+)$/,CACHE=new Map;function get(e){const t=JSON.stringify(e),o=CACHE.get(t);if(o)return o;const a=build(parse(e));return CACHE.set(t,a),a}function parse(e){if(typeof e=="string"){const[l,p,d]=REGEX.exec(e)||[];return parse([p,d])}const[t,o]=e,a=+o;if(typeof t=="number")return[t,a];const u=t.split("+").map(l=>+l);return u.length===1?[u[0],a]:[u,a]}var time_signature_default={names,parse,get},isPowerOfTwo=e=>Math.log(e)/Math.log(2)%1===0;function build([e,t]){const o=Array.isArray(e)?e.reduce((d,g)=>d+g,0):e,a=t;if(o===0||a===0)return NONE;const u=Array.isArray(e)?`${e.join("+")}/${t}`:`${e}/${t}`,l=Array.isArray(e)?e:[],p=a===4||a===2?"simple":a===8&&o%3===0?"compound":isPowerOfTwo(a)?"irregular":"irrational";return{empty:!1,name:u,type:p,upper:o,lower:a,additive:l}}var Tonal=Core,PcSet=pcset_default,ChordDictionary=chord_type_default,ScaleDictionary=scale_type_default;const dist$1=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:abc_notation_default,Array:index$6,Chord:chord_default,ChordDictionary,ChordType:chord_type_default,Collection:collection_default,Core,DurationValue:duration_value_default,Interval:interval_default,Key:index_default$2,Midi:index_default$4,Mode:mode_default,Note:index_default$3,PcSet,Pcset:pcset_default,Progression:progression_default,Range:index_default$1,RomanNumeral:roman_numeral_default,Scale:index_default,ScaleDictionary,ScaleType:scale_type_default,TimeSignature:time_signature_default,Tonal,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"})),flats=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],pcs=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],sharps=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],accs={b:-1,"#":1},pc2chroma=e=>{const[t,...o]=e.split("");return pcs.indexOf(t.toLowerCase())+o.reduce((a,u)=>a+accs[u],0)};function tokenizeChord$1(e){const t=(e||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}const midi2chroma=e=>e%12,step2semitones=e=>{let t=Number(e);return isNaN(t)?interval_default.semitones(e):t},x2midi=(e,t)=>{if(typeof e=="number")return e;if(typeof e=="string")return noteToMidi$1(e,t)},midi2note=(e,t=!1)=>{const o=Math.floor(e/12)-1;return(t?sharps:flats)[e%12]+o};function scaleStep$1(e,t,o=1){e=e.map(u=>typeof u=="string"?noteToMidi$1(u):u);const a=Math.floor(t/e.length)*o*12;return t=_mod$2(t,e.length),e[t]+a}function nearestNumberIndex(e,t,o){let a=0,u=1/0;return t.forEach((l,p)=>{const d=Math.abs(l-e);(!o&&d<u||o&&d<=u)&&(a=p,u=d)}),a}let scaleSteps={};function stepInNamedScale(e,t,o,a){const[u,l]=index_default.tokenize(t),p=x2midi(u),d=midi2chroma(p);if(!scaleSteps[l]){const{intervals:F}=index_default.get(`C ${l}`);scaleSteps[l]=F.map(step2semitones)}const g=scaleSteps[l];if(!g)return null;let f=p;if(o){o=x2midi(o,3);const F=midi2chroma(o),S=_mod$2(F-d,12),k=nearestNumberIndex(S,g,a);e=e+k,f=o-S}const A=Math.floor(e/g.length)*12;return e=_mod$2(e,g.length),g[e]+f+A}let modeTarget={below:e=>e.slice(-1)[0],duck:e=>e.slice(-1)[0],above:e=>e[0],root:e=>e[0]};function renderVoicing({chord:e,dictionary:t,offset:o=0,n:a,mode:u="below",anchor:l="c5",octaves:p=1}){const[d,g]=tokenizeChord$1(e),f=pc2chroma(d);l=x2midi(l?.note||l,4);const A=midi2chroma(l),b=t[g].map(ee=>(typeof ee=="string"?ee.split(" "):ee).map(step2semitones));let F,S,k=b.map((ee,re)=>{const oe=modeTarget[u](ee),_e=_mod$2(A-oe-f,12);return(F===void 0||_e<F)&&(F=_e,S=re),_e});u==="root"&&(S=0);const $=Math.ceil(o/b.length)*12,R=_mod$2(S+o,b.length),I=b[R],z=modeTarget[u](I),ie=l-k[R]+$,U=I.map(ee=>ie-z+ee);let O=U.map(ee=>midi2note(ee));return u==="duck"&&(O=O.filter((ee,re)=>U[re]!==l)),a!==void 0?[scaleStep$1(O,a,p)]:O}const octavesInterval=e=>(e<=0?-1:1)+e*7+"P";function getScale(e){e=e.replaceAll(":"," ");const t=index_default.get(e),{tonic:o,empty:a}=t;if(a&&isNote(e)||a&&!o)throw new Error(`Scale name ${e} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(a)throw new Error(`Invalid scale name "${e}"`);return t}function scaleStep(e,t){e=Math.ceil(e);let{intervals:o,tonic:a}=getScale(t);a=a||"C";const{pc:u,oct:l=3}=index_default$3.get(a),p=Math.floor(e/o.length),d=_mod$2(e,o.length),g=interval_default.add(o[d],octavesInterval(p));return index_default$3.transpose(u+l,g)}function scaleOffset(e,t,o){let{notes:a}=getScale(e);if(a=a.map(b=>index_default$3.get(b).pc),t=Number(t),isNaN(t))throw new Error(`scale offset "${t}" not a number`);const{pc:u,oct:l=3}=index_default$3.get(o),p=a.indexOf(u);if(p===-1)throw new Error(`note "${o}" is not in scale "${e}"`);let d=p,g=l,f=u;const A=Math.sign(t);for(;Math.abs(d-p)<Math.abs(t);){d+=A;const b=_mod$2(d,a.length);A<0&&f[0]==="C"&&(g+=A),f=a[b],A>0&&f[0]==="C"&&(g+=A)}return f+g}const{transpose,trans}=register(["transpose","trans"],function e(t,o){return o.withHap(a=>{const u=a.value.note??a.value;if(typeof u=="number"){let d;typeof t=="number"?d=t:typeof t=="string"&&(d=interval_default.semitones(t)||0);const g=u+d;return typeof a.value=="object"?a.withValue(()=>({...a.value,note:g})):a.withValue(()=>g)}if(typeof u!="string"||!isNote(u))return logger$2(`[tonal] transpose: not a note "${u}"`,"warning"),a;const l=isNaN(Number(t))?String(t):interval_default.fromSemitones(t),p=index_default$3.transpose(u,l);return typeof a.value=="object"?a.withValue(()=>({...a.value,note:p})):a.withValue(()=>p)})}),{scaleTranspose,scaleTrans,strans}=register(["scaleTranspose","scaleTrans","strans"],function(e,t){return t.withHap(o=>{if(!o.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof o.value=="object")return o.withValue(()=>({...o.value,note:scaleOffset(o.context.scale,Number(e),o.value.note)}));if(typeof o.value!="string")throw new Error("can only use scaleTranspose with notes");return o.withValue(()=>scaleOffset(o.context.scale,Number(e),o.value))})});function _convertStepToNumberAndOffset(e){let t=Number(e),o=0;if(isNaN(t)){e=String(e);const a=/^(-?\d+)([#bsf]*)$/.exec(e);if(!a)throw new Error(`invalid scale step "${e}", expected number or integer with optional # b suffixes`);t=Number(a[1]);const u=a[2]||"";o=getAccidentalsOffset$1(u)}return[t,o]}let scaleToMidisAndNotes={};function _getNearestScaleNote(e,t,o=!0){let a=typeof t=="string"?noteToMidi$1(t):t;if(scaleToMidisAndNotes[e]===void 0){const{intervals:b,tonic:F}=getScale(e),{pc:S}=index_default$3.get(F),$=b.concat("8P").map(I=>index_default$3.transpose(S+"0",I)),R=$.map(noteToMidi$1);scaleToMidisAndNotes[e]=[R,$]}const[u,l]=scaleToMidisAndNotes[e],p=u[0],d=Math.floor((a-p)/12),g=u.map(b=>b+12*d),f=nearestNumberIndex(a,g,o),A=l[f];return index_default$3.transpose(A,interval_default.fromSemitones(12*d))}const scale=register("scale",function(e,t){return Array.isArray(e)&&(e=e.flat().join(" ")),t.withHaps(o=>(o=o.map(a=>{let u=a.value;const l=typeof u=="object";u=l?u:{n:u};const{note:p,n:d,value:g,...f}=u,A=p??d??g;if(A===void 0)return logger$2(`[tonal] Invalid value format for 'scale'. Value must contain n, note, or value but received keys [${Object.keys(u).join(", ")}]`,"error"),a;let b;if(isNote(A))b=_getNearestScaleNote(e,A),a.value={...f,note:b};else try{const[F,S]=_convertStepToNumberAndOffset(A);f.anchor?b=stepInNamedScale(F,e,f.anchor):b=scaleStep(F,e),S!=0&&(b=index_default$3.transpose(b,interval_default.fromSemitones(S)))}catch(F){errorLogger$1(F,"tonal");return}return a.value=l?{...f,note:b}:b,a.setContext({...a.context,scale:e})}),removeUndefineds(o)))},!0,!0);var dist={},dictionaryVoicing$1={},getBestVoicing={},hasRequiredGetBestVoicing;function requireGetBestVoicing(){if(hasRequiredGetBestVoicing)return getBestVoicing;hasRequiredGetBestVoicing=1,getBestVoicing.__esModule=!0,getBestVoicing.getBestVoicing=void 0;function e(t){var o=t.chord,a=t.range,u=t.finder,l=t.picker,p=t.lastVoicing,d=u(o,a);return d.length?l(d,p):[]}return getBestVoicing.getBestVoicing=e,getBestVoicing}var voicingsInRange={};const require$$0=getAugmentedNamespace(dist$1);var tokenizeChord={},hasRequiredTokenizeChord;function requireTokenizeChord(){if(hasRequiredTokenizeChord)return tokenizeChord;hasRequiredTokenizeChord=1,tokenizeChord.__esModule=!0,tokenizeChord.tokenizeChord=void 0;function e(t){var o=(t||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return o?o.slice(1):[]}return tokenizeChord.tokenizeChord=e,tokenizeChord}var hasRequiredVoicingsInRange;function requireVoicingsInRange(){if(hasRequiredVoicingsInRange)return voicingsInRange;hasRequiredVoicingsInRange=1,voicingsInRange.__esModule=!0,voicingsInRange.voicingsInRange=void 0;var e=require$$0,t=requireDictionaryVoicing(),o=requireTokenizeChord();function a(u,l,p){l===void 0&&(l=t.lefthand),p===void 0&&(p=["D3","A4"]);var d=(0,o.tokenizeChord)(u),g=d[0],f=d[1];if(!l[f])return[];var A=l[f].map(function(F){return F.split(" ")}),b=e.Range.chromatic(p);return A.reduce(function(F,S){var k=S.map(function(z){return e.Interval.substract(z,S[0])}),$=e.Note.transpose(g,S[0]),R=b.filter(function(z){return e.Note.chroma(z)===e.Note.chroma($)}).filter(function(z){return e.Note.midi(e.Note.transpose(z,k[k.length-1]))<=e.Note.midi(p[1])}).map(function(z){return e.Note.enharmonic(z,$)}),I=R.map(function(z){return k.map(function(ie){return e.Note.transpose(z,ie)})});return F.concat(I)},[])}return voicingsInRange.voicingsInRange=a,voicingsInRange}var hasRequiredDictionaryVoicing;function requireDictionaryVoicing(){return hasRequiredDictionaryVoicing||(hasRequiredDictionaryVoicing=1,(function(e){var t=dictionaryVoicing$1&&dictionaryVoicing$1.__assign||function(){return t=Object.assign||function(d){for(var g,f=1,A=arguments.length;f<A;f++){g=arguments[f];for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(d[b]=g[b])}return d},t.apply(this,arguments)},o=dictionaryVoicing$1&&dictionaryVoicing$1.__rest||function(d,g){var f={};for(var A in d)Object.prototype.hasOwnProperty.call(d,A)&&g.indexOf(A)<0&&(f[A]=d[A]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,A=Object.getOwnPropertySymbols(d);b<A.length;b++)g.indexOf(A[b])<0&&Object.prototype.propertyIsEnumerable.call(d,A[b])&&(f[A[b]]=d[A[b]]);return f};e.__esModule=!0,e.dictionaryVoicing=e.dictionaryVoicingFinder=e.triads=e.guidetones=e.lefthand=void 0;var a=requireGetBestVoicing(),u=requireVoicingsInRange();e.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},e.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},e.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var l=function(d){return function(g,f){return(0,u.voicingsInRange)(g,d,f)}};e.dictionaryVoicingFinder=l;var p=function(d){var g=d.dictionary,f=d.range,A=o(d,["dictionary","range"]);return(0,a.getBestVoicing)(t(t({},A),{range:f,finder:(0,e.dictionaryVoicingFinder)(g)}))};e.dictionaryVoicing=p})(dictionaryVoicing$1)),dictionaryVoicing$1}var minTopNoteDiff$1={},hasRequiredMinTopNoteDiff;function requireMinTopNoteDiff(){if(hasRequiredMinTopNoteDiff)return minTopNoteDiff$1;hasRequiredMinTopNoteDiff=1,minTopNoteDiff$1.__esModule=!0,minTopNoteDiff$1.minTopNoteDiff=void 0;var e=require$$0;function t(o,a){if(!a)return o[0];var u=function(l){return Math.abs(e.Note.midi(a[a.length-1])-e.Note.midi(l[l.length-1]))};return o.reduce(function(l,p){return u(p)<u(l)?p:l},o[0])}return minTopNoteDiff$1.minTopNoteDiff=t,minTopNoteDiff$1}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(e){e.__esModule=!0;var t=requireDictionaryVoicing(),o=requireMinTopNoteDiff(),a=requireGetBestVoicing(),u=requireTokenizeChord();e.default={tokenizeChord:u.tokenizeChord,getBestVoicing:a.getBestVoicing,dictionaryVoicing:t.dictionaryVoicing,dictionaryVoicingFinder:t.dictionaryVoicingFinder,lefthand:t.lefthand,guidetones:t.guidetones,triads:t.triads,minTopNoteDiff:o.minTopNoteDiff}})(dist)),dist}var distExports=requireDist();const _voicings=getDefaultExportFromCjs(distExports),simple={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},complex={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing,minTopNoteDiff}=_voicings.default||_voicings,lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},triads={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},defaultDictionary={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},voicingRegistry={lefthand:{dictionary:lefthand,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:triads,mode:"below",anchor:"a4"},guidetones:{dictionary:guidetones,mode:"above",anchor:"a4"},legacy:{dictionary:defaultDictionary,mode:"below",anchor:"a4"}};let defaultDict="ireal";const setDefaultVoicings=e=>defaultDict=e,setVoicingRange=(e,t)=>addVoicings(e,voicingRegistry[e].dictionary,t),addVoicings=(e,t,o=["F3","A4"])=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,range:o}})},registerVoicings=(e,t,o={})=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,...o}})},getVoicing=(e,t,o)=>{const{dictionary:a,range:u}=voicingRegistry[t];return dictionaryVoicing({chord:e,dictionary:a,range:u,picker:minTopNoteDiff,lastVoicing:o})};let lastVoicing;const voicings=register("voicings",function(e,t){return t.fmap(o=>(lastVoicing=getVoicing(o,e,lastVoicing),stack(...lastVoicing))).outerJoin()}),rootNotes=register("rootNotes",function(e,t){return t.fmap(o=>{const l=(o.chord||o).match(/^([a-gA-G][b#]?).*$/)[1]+e;return o.chord?{note:l}:l})}),voicing=register("voicing",function(e){return e.fmap(t=>{t=typeof t=="string"?{chord:t}:t;let{dictionary:o=defaultDict,chord:a,anchor:u,offset:l,mode:p,n:d,octaves:g,...f}=t;o=typeof o=="string"?voicingRegistry[o]:{dictionary:o,mode:"below",anchor:"c5"};try{let A=renderVoicing({...o,chord:a,anchor:u,offset:l,mode:p,n:d,octaves:g});return stack(...A).note().set(f)}catch{return logger$2(`[voicing]: unknown chord "${a}"`),silence}}).outerJoin()});function voicingAlias(e,t,o){o=Array.isArray(o)?o:[o],o.forEach(a=>{a[t]=a[e]})}voicingAlias("^","",[simple,complex]),Object.keys(simple).forEach(e=>{if(e.includes("-")){let t=e.replace("-","m");voicingAlias(e,t,[complex,simple])}if(e.includes("^")){let t=e.replace("^","M");voicingAlias(e,t,[complex,simple])}if(e.includes("+")){let t=e.replace("+","aug");voicingAlias(e,t,[complex,simple])}}),registerVoicings("ireal",simple),registerVoicings("ireal-ext",complex);function resetVoicings(){lastVoicing=void 0,setDefaultVoicings("ireal")}const packageName="@strudel/tonal",strudelTonal=Object.freeze(Object.defineProperty({__proto__:null,addVoicings,complex,packageName,registerVoicings,resetVoicings,rootNotes,scale,scaleTrans,scaleTranspose,setDefaultVoicings,setVoicingRange,simple,strans,trans,transpose,voicing,voicingAlias,voicingRegistry,voicings},Symbol.toStringTag,{value:"Module"})),{evalScope}=strudelCore;App.scope_container_el=void 0,App.scope_canvas_el=void 0,App.scope_canvas_ctx=void 0,App.scope_analyser=void 0,App.scope_waveform=void 0,App.scope_animation_id=void 0,App.scope_connected=!1,App.scope_pixel_ratio=1,App.scope_enabled=!0,App.scope_max_y=-1,App.scope_min_y=-1,App.scope_background="#111111da",App.scope_color="rgba(204, 198, 239, 1)",App.scope_click_color_1="rgba(162, 171, 234, 0.5)",App.scope_click_color_2="rgba(255, 137, 204, 1)",App.scope_click_color_3="rgba(222, 242, 92, 1)",App.scope_border_color="#444",App.scope_click_level=1,App.scope_sine_time=0,App.scope_clicks=[],App.scope_click_time=3*1e3,App.scope_click_size=18,App.scope_is_drawing=!1,App.scope_click_distance=180,App.scope_mousedown_date=0,App.scope_beep_delay=300,App.scope_slide_delay=800,App.scope_slide_distance=250,App.scope_panning_zone=100,App.scope_padding_amount=.9,App.scope_enable_date=0,App.scope_click_lock=250,App.scope_debouncer_delay=50,App.max_scope_slide_y_dff=45,App.scope_click_level_time=2.8*1e3,App.setup_scope=()=>{App.scope_debouncer=App.create_debouncer(()=>{App.resize_scope_canvas()},App.scope_debouncer_delay),App.stor_load_scope(),App.init_scope_checkbox(),App.setup_scope_canvas(),App.start_scope_visualizer(),App.scope_enabled?App.enable_scope_visualizer():App.disable_scope_visualizer()},App.get_scope_container=()=>(App.scope_container_el||(App.scope_container_el=DOM.el("#scope-container")),App.scope_container_el),App.get_scope_canvas=()=>(App.scope_canvas_el||(App.scope_canvas_el=DOM.el("#scope-canvas")),App.scope_canvas_el),App.get_scope_dimensions=()=>{if(!App.scope_canvas_el)return{width:0,height:0};let e=App.scope_canvas_el.clientWidth,t=App.scope_canvas_el.clientHeight;return e||(e=App.scope_canvas_el.width/App.scope_pixel_ratio),t||(t=App.scope_canvas_el.height/App.scope_pixel_ratio),{width:Math.max(0,e||0),height:Math.max(0,t||0)}},App.setup_scope_canvas=()=>{let e=App.get_scope_canvas();if(e){if(!App.scope_canvas_ctx){let t=e.getContext("2d");if(!t){console.warn("Scope canvas context unavailable");return}App.scope_canvas_ctx=t}return App.scope_debouncer.call(),e}},App.resize_scope_canvas=()=>{if(!App.scope_enabled||!App.scope_canvas_el||!App.scope_canvas_ctx)return;DOM.show("#scope-container",2);let e=1;typeof window<"u"&&(e=window.devicePixelRatio||1),App.scope_pixel_ratio=e;let t=DOM.el("#code-input-wrapper"),o=t&&t.clientWidth||App.scope_canvas_el.clientWidth||App.scope_canvas_el.width/e||320,a=App.scope_canvas_el.clientHeight||App.scope_canvas_el.height/e||80,u=Math.max(1,Math.round(o*e)),l=Math.max(1,Math.round(a*e));(App.scope_canvas_el.width!==u||App.scope_canvas_el.height!==l)&&(App.scope_canvas_el.width=u,App.scope_canvas_el.height=l),App.scope_canvas_ctx.setTransform(1,0,0,1,0,0),App.scope_canvas_ctx.scale(e,e),App.clear_scope_canvas()},App.clear_scope_canvas=()=>{if(!App.scope_canvas_ctx)return;let{width:e,height:t}=App.get_scope_dimensions();!e||!t||(App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(0,0,e,t))},App.ensure_scope_waveform=()=>{if(App.scope_analyser)return(!App.scope_waveform||App.scope_waveform.length!==App.scope_analyser.fftSize)&&(App.scope_waveform=new Uint8Array(App.scope_analyser.fftSize)),App.scope_waveform},App.ensure_scope_analyser=()=>{if(App.scope_analyser)return App.scope_analyser;try{let t=getAudioContext().createAnalyser();t.fftSize=2048,t.minDecibels=-90,t.maxDecibels=-10,t.smoothingTimeConstant=.85,App.scope_analyser=t,App.ensure_scope_waveform()}catch(e){console.error("Failed to create scope analyser",e),App.scope_analyser=void 0,App.scope_waveform=void 0}return App.scope_analyser},App.connect_scope_analyser=()=>{if(App.scope_connected)return!0;let e=App.ensure_scope_analyser();if(!e)return!1;try{let o=getSuperdoughAudioController()?.output?.destinationGain;return o?(o.connect(e),App.scope_connected=!0,!0):(console.warn("Scope destination missing"),!1)}catch(t){return console.warn("Failed to connect scope analyser",t),!1}},App.stop_scope_loop=()=>{App.scope_animation_id&&(cancelAnimationFrame(App.scope_animation_id),App.scope_animation_id=void 0)},App.handle_scope_click=e=>{let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top;App.scope_clicks.push({x:a,y:u,timestamp:Date.now()})},App.handle_scope_mouse_down=e=>{App.mouse_down_coords=App.get_scope_coords(e),App.scope_mousedown_date=Date.now(),App.scope_is_drawing=!0,App.handle_scope_click(e)},App.handle_scope_mouse_move=e=>{if(App.scope_is_drawing){let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top;if((App.scope_max_y===-1||u>App.scope_max_y)&&(App.scope_max_y=u),(App.scope_min_y===-1||u<App.scope_min_y)&&(App.scope_min_y=u),App.scope_last_point){let l=App.scope_last_point.x,p=App.scope_last_point.y,d=a-l,g=u-p,f=Math.sqrt(d*d+g*g),A=Math.ceil(f/App.scope_click_distance);for(let b=1;b<=A;b++){let F=l+d*b/A,S=p+g*b/A;App.scope_clicks.push({x:F,y:S,timestamp:Date.now()})}}App.scope_clicks.push({x:a,y:u,timestamp:Date.now()}),App.scope_last_point={x:a,y:u}}},App.handle_scope_mouse_up=e=>{App.mouse_up_coords=App.get_scope_coords(e),Date.now()-App.scope_mousedown_date<=App.scope_beep_delay&&(App.splash_reverb(2),App.check_scope_panning()||App.beep_sound()),Date.now()-App.scope_mousedown_date<=App.scope_slide_delay&&App.check_scope_slide(),App.triangle_gesture()?(App.cycle_panning(.9,12),App.increase_scope_click_level(2)):App.circle_gesture()&&(App.increase_scope_click_level(3),App.mirror_input())},App.increase_scope_click_level=e=>{App.scope_click_level=e,clearTimeout(App.scope_click_level_timeout),App.scope_click_level_timeout=setTimeout(()=>{App.scope_click_level=1},App.scope_click_level_time)},App.draw_star=(e,t,o,a,u,l)=>{let p=Math.PI/2*3,d=Math.PI/u;e.beginPath(),e.moveTo(t,o-l);for(let g=0;g<u;g++){let f=t+Math.cos(p)*l,A=o+Math.sin(p)*l;e.lineTo(f,A),p+=d;let b=t+Math.cos(p)*a,F=o+Math.sin(p)*a;e.lineTo(b,F),p+=d}e.lineTo(t,o-l),e.closePath()},App.draw_scope_frame=()=>{if(!App.scope_enabled){App.stop_scope_loop();return}if(!App.scope_canvas_ctx){App.stop_scope_loop();return}let{width:e,height:t}=App.get_scope_dimensions();if(!e||!t){App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame);return}let o=10;App.scope_canvas_ctx.clearRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.strokeStyle=App.scope_color,App.scope_canvas_ctx.lineWidth=2,App.scope_canvas_ctx.beginPath();let a=App.scope_analyser,u=App.ensure_scope_waveform();if(App.is_playing&&a&&u){a.getByteTimeDomainData(u);let p=e/u.length,d=0;for(let g=0;g<u.length;g+=1){let A=u[g]/128-1,b=t/2+A*(t/2);g===0?App.scope_canvas_ctx.moveTo(d,b):App.scope_canvas_ctx.lineTo(d,b),d+=p}}else{App.scope_sine_time+=.012;let p=u?u.length:2048,d=e/p,g=0;for(let f=0;f<p;f+=1){let A=f/p*(Math.PI*2)*6,F=Math.sin(A+App.scope_sine_time)*.3,S=t/2+F*(t/2);f===0?App.scope_canvas_ctx.moveTo(g,S):App.scope_canvas_ctx.lineTo(g,S),g+=d}}App.scope_canvas_ctx.stroke();let l=Date.now();App.scope_clicks=App.scope_clicks.filter(p=>l-p.timestamp<App.scope_click_time);for(let p of App.scope_clicks)App.scope_click_level===1?App.scope_canvas_ctx.fillStyle=App.scope_click_color_1:App.scope_click_level===2?App.scope_canvas_ctx.fillStyle=App.scope_click_color_2:App.scope_click_level===3&&(App.scope_canvas_ctx.fillStyle=App.scope_click_color_3),App.draw_star(App.scope_canvas_ctx,p.x,p.y,3,5,App.scope_click_size),App.scope_canvas_ctx.fill();App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame)},App.start_scope_loop=()=>{App.scope_animation_id||(App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame))},App.set_scope_visibility=e=>{let t=App.get_scope_container();t&&(e?DOM.show(t):DOM.hide(t))},App.stop_scope_visualizer=()=>{App.stop_scope_loop(),App.set_scope_visibility(!1),App.clear_scope_canvas()},App.start_scope_visualizer=()=>{App.setup_scope_canvas()&&(App.scope_connected||App.connect_scope_analyser())},App.scope_mouse_enabled=()=>Date.now()-App.scope_enable_date>=App.scope_click_lock,App.init_scope_click_handler=()=>{let e=App.get_scope_canvas();e&&(DOM.ev(e,"mousedown",t=>{App.scope_max_y=-1,App.scope_min_y=-1,App.scope_mouse_enabled()&&App.handle_scope_mouse_down(t)}),DOM.ev(e,"mousemove",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_move(t)}),DOM.ev(e,"click",t=>{App.scope_mouse_enabled()&&App.handle_scope_click(t)}),DOM.ev(document,"mouseup",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_up(t),App.scope_is_drawing=!1,App.scope_last_point=null}),DOM.ev(e,"contextmenu",t=>{t.preventDefault()}))},App.toggle_scope=()=>{App.scope_enabled?App.disable_scope_visualizer():App.enable_scope_visualizer()},App.enable_scope_visualizer=()=>{App.scope_enabled=!0,App.set_scope_visibility(!0),App.handle_scope_resize(),App.setup_scope_canvas()&&!App.scope_animation_id&&App.start_scope_loop(),App.scope_enable_date=Date.now(),App.start_scope_visualizer(),App.init_scope_click_handler(),App.stor_save_scope()},App.disable_scope_visualizer=()=>{App.scope_enabled=!1,App.stop_scope_visualizer(),App.stor_save_scope()},App.handle_scope_resize=()=>{App.scope_canvas_el&&(App.scope_debouncer.call(),App.scope_enabled||App.clear_scope_canvas())},App.init_scope_checkbox=()=>{let e=DOM.el("#scope-checkbox");e&&(e.checked=App.scope_enabled,App.scope_enabled?App.enable_scope_visualizer():App.set_scope_visibility(!1),DOM.ev(e,"change",t=>{t.target.checked?App.enable_scope_visualizer():App.disable_scope_visualizer()}))},App.ensure_scope=()=>(App.scope_promise||(App.scope_promise=evalScope(strudelCore,strudelMini,strudelWebAudio,strudelTonal).catch(e=>{throw App.scope_promise=void 0,console.error("Strudel scope failed to load",e),e})),App.scope_promise),App.get_scope_coords=e=>{let t=App.get_scope_canvas();if(t){let o=t.getBoundingClientRect(),a=e.clientX-o.left,u=e.clientY-o.top;return{x:a,y:u}}},App.clear_clicks=()=>{setTimeout(()=>{App.scope_clicks=[]},100)},App.song_cache={},App.fetch_songs_list=async()=>{try{let e=await fetch("/songs/list");if(!e.ok)throw new Error("Failed to fetch songs list");let t=await e.json();return Array.isArray(t)?t:(console.error("Songs list payload was not an array"),[])}catch(e){return console.error("Error fetching songs",e),[]}},App.fetch_song_content=async e=>{try{let t=await fetch(`/songs/${e}.js`);if(!t.ok)throw new Error(`Failed to fetch song ${e}`);let o=await t.text(),a={};return a.name=e,a.clean_name=App.underspace(e),a.raw=o,a.filtered=App.filter_code(o),App.song_cache[e]=a,App.last_code=o,o}catch(t){throw console.error("Error fetching song content",t),t}},App.create_songs_modal=()=>{let e=App.create_list_modal("songs"),t=DOM.el(".modal-title",e);t.textContent="Select Song"},App.open_songs_modal=async()=>{let e=await App.fetch_songs_list(),t=[];for(let o of e)t.push({text:o,title:"Click to load and play this song"});App.show_items_modal("songs",{items:t,action:o=>{App.load_song(o.text)}})},App.load_song=async e=>{App.close_all_modals();try{App.set_status(`Loading ${e}...`);let t=await App.fetch_song_content(e);App.stop_status_watch(),App.stop_color_cycle(),App.clear_draw_context(),App.code_scroll_active&&App.defer_code_scroll(App.code_scroll_song_pause_ms),await App.play_action(t,!0),App.set_song_context(e),App.set_status(`Playing: ${App.underspace(e)}`)}catch(t){App.set_status(`Failed to load song: ${t.message}`),console.error("Failed to load song:",t)}},App.load_song_from_query=async()=>{if(!window||!window.location)return!1;let t=App.get_query_params().get(App.song_query_key);if(!t)return!1;try{App.set_status(`Loading ${t}...`);let o=await App.fetch_song_content(t);return App.set_input(o),App.set_song_context(t),App.set_status(`Loaded: ${App.underspace(t)}`),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.set_song_context=(e="")=>{App.current_song=e||"",App.set_title(App.underspace(App.current_song)),e?(App.update_url(App.current_song),App.update_title()):App.clear_url_if_no_song()},App.random_song=async()=>{try{let e=await App.fetch_songs_list();if(!e.length){console.error("No songs available to pick from");return}let t=e.filter(u=>u!==App.current_song);if(!t.length){console.error("No songs available after filtering out the current song");return}let o=App.random_int({min:0,max:t.length-1}),a=t[o];await App.load_song(a)}catch(e){console.error("Error selecting a random song",e)}},App.clear_url_if_no_song=()=>{App.get_matched_song()||(App.update_url(),App.update_title())},App.get_matched_song=()=>{for(let e in App.song_cache){let t=App.song_cache[e];if(t.filtered===App.last_code)return t;if(t.raw===App.last_code)return t}},App.modal_factory=(e,t)=>{let o=DOM.el(`#${t}`),a=DOM.create("div");a.innerHTML=o.innerHTML,DOM.el("#modals").appendChild(a);let u=DOM.el(".modal",a);return u.id=`${e}-modal`,u},App.create_modal=e=>App.modal_factory(e,"template-modal"),App.create_list_modal=e=>{let t=App.modal_factory(e,"template-list-modal"),o=DOM.el(".modal-filter",t);return o.id=`${e}-modal-filter`,t},App.create_modals=()=>{App.create_about_modal(),App.create_songs_modal(),App.create_auto_modal(),App.create_visual_modal(),App.create_settings_modal(),DOM.ev("#main","click",e=>{let t=e.target.closest(".modal-close");if(t){let o=t.closest(".modal");o&&App.do_close_modal(o)}}),DOM.ev("#modal-overlay","click",e=>{App.close_all_modals()})},App.show_items_modal=async(e,t={})=>{let o={loaded:!1,active:-1,capitalize:!0,icons:!0};App.def_args(o,t);let a=t.loaded||!1,u=DOM.el(`#${e}-modal`),l=DOM.el(".modal-body",u),p=DOM.el(".modal-filter",u);if(a&&(l.innerHTML='<div class="loading">Loading items...</div>'),p&&(p.value="",p.disabled=!0,p.oninput=null,p.onkeydown=null),!t.items.length){l.innerHTML='<div class="loading">Nothing found</div>';return}let d=f=>{if(l.innerHTML="",!f.length){l.innerHTML='<div class="loading">No results</div>';return}for(let[A,b]of f.entries()){let F=DOM.create("div"),S=DOM.create("div");F.className="modal-item";let k=b.alt_text||b.text;if(t.icons){let $=DOM.create("canvas","modal-icon");$.width=25,$.height=25,F.appendChild($),jdenticon.update($,k)}t.capitalize&&(k=App.capitalize(k)),S.textContent=App.underspace(k),F.title=b.title,DOM.ev(F,"click",()=>t.action(b)),t.active===A&&F.classList.add("modal-active-item"),F.appendChild(S),l.appendChild(F)}};if(d(t.items),!p)return;let g=()=>{let f=p.value.trim().toLowerCase();if(!f){d(t.items);return}let A=t.items.filter(b=>(b.alt_text||b.text).toLowerCase().includes(f));d(A)};p.disabled=!1,p.focus(),p.oninput=g,p.onkeydown=f=>{if(f.key!=="Enter")return;f.preventDefault();let A=DOM.els(".modal-item",l);for(let b of A){b.click();break}},App.do_open_modal(u),App.focus_modal_filter(e)},App.open_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_open_modal(t)},App.do_open_modal=e=>{let t=DOM.el(".modal-body",e);App.show_overlay(),e.classList.add("active"),t.scrollTop=0},App.close_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_close_modal(t)},App.do_close_modal=e=>{e.classList.remove("active"),DOM.els(".modal.active").length===0&&App.hide_overlay()},App.close_all_modals=()=>{let e=DOM.els(".modal");for(let t of e)App.do_close_modal(t)},App.close_current_modal=()=>{let e=DOM.els(".modal.active");if(e.length>0){let t=e[e.length-1];App.do_close_modal(t)}},App.modal_open=()=>DOM.els(".modal.active").length>0,App.show_overlay=()=>{DOM.show("#modal-overlay")},App.hide_overlay=()=>{DOM.hide("#modal-overlay")},App.focus_modal_filter=e=>{let t=DOM.el(`#${e}-modal-filter`);t&&t.focus()},App.create_about_modal=()=>{let e=App.create_modal("about"),t=DOM.el(".modal-header",e),o=DOM.create("img","","modal-about-image");o.src="/img/slide.png",t.prepend(o);let a=DOM.el(".modal-title",e),u=`v${App.config.version}`;a.textContent=`Slide ${u} | Merkoba | 2025`,a.id="modal-title-about";let l=DOM.el(".modal-body",e);l.id="modal-body-about",l.innerHTML=`
    <div class="about-item">Slide is a music player that uses <a target=_blank class="popup" href="https://strudel.cc">strudel</a> code.</div>
    <div class="about-item">It's meant to allow automatic & seamless code updates.</a></div>
    <div class="about-item">There's a song picker to play elaborate tunes.</a></div>
    <div class="about-item">The code can be edited in real time and applied with Play.</a></div>
    <div class="about-item">The scope visualizer can be clicked in the left/center/right.</a></div>
    <div class="about-item">Clicking the scope produces a tone and a reverb affect.</a></div>
    <div class="about-item">Clicking the scope on the left produces left panning.</a></div>
    <div class="about-item">Clicking the scope on the right produces right panning.</a></div>
    <div class="about-item">A straight line to the left on the scope sets the next visual.</a></div>
    <div class="about-item">A straight line to the right on the scope opens a random song.</a></div>
    <div class="about-item">Ctrl+s = Starts playback / Updates code.</a></div>
    <div class="about-item">Escape = Closes top modal or stops playback.</a></div>
    <div class="about-item">Ctrl+1 = Show the sound context.</a></div>
    <div class="about-item">Ctrl+2 = Show the note context.</a></div>
    <div class="about-item">Ctrl+3 = Show the bank context.</a></div>
  `},App.open_about_modal=()=>{App.open_modal("about")},App.auto_delay=5,App.auto_endpoint="/status",App.setup_auto=()=>{let e=DOM.el("#auto-start");e&&DOM.ev(e,"click",()=>{let u=DOM.el("#auto-input");u&&App.start_auto(u.value)});let t=DOM.el("#auto-default");t&&DOM.ev(t,"click",()=>{App.start_auto("/status")});let o=DOM.el("#auto-input");o&&DOM.ev(o,"keydown",u=>{if(u.key==="Enter"){u.preventDefault();let l=DOM.el("#auto-input");l&&App.start_auto(l.value)}});let a=DOM.el("#auto-delay");a&&DOM.ev(a,"change",u=>{App.auto_delay=parseInt(u.target.value,10),App.stor_save_auto_delay(),App.fetch_timer&&App.strudel_watch_status()})},App.create_auto_modal=()=>{let e=App.create_modal("auto"),t=DOM.el(".modal-title",e);t.textContent="Auto Mode";let o=DOM.el(".modal-body",e),a=DOM.create("div","","auto-info");a.textContent="Code will be fetched periodically";let u=DOM.create("select","modal-select","auto-delay");u.innerHTML=`
    <option value="1">1 second</option>
    <option value="5" selected>5 seconds</option>
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300">5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="900">15 minutes</option>
    <option value="1200">20 minutes</option>
    <option value="1800">30 minutes</option>
    <option value="3600">1 hour</option>
  `;let l=DOM.create("input","","auto-input");l.classList.add("modal-input"),l.placeholder="Endpoint URL";let p=DOM.create("div","modal-buttons","auto-buttons");p.innerHTML=`
    <button id="auto-default">Default</button>
    <button id="auto-start">Start</button>
  `,o.appendChild(a),o.appendChild(u),o.appendChild(l),o.appendChild(p)},App.open_auto_modal=()=>{App.open_modal("auto"),DOM.el("#auto-delay").value=App.auto_delay,DOM.el("#auto-input").value=App.auto_endpoint},App.start_auto=async e=>{if(App.close_modal("auto"),!e||!e.trim()){App.set_status("Invalid endpoint");return}if(App.auto_endpoint=e.trim(),App.stor_save_auto_endpoint(),!await App.ensure_strudel_ready())return;App.strudel_watch_status();let o=App.truncate_path(App.auto_endpoint);App.set_status(`Auto mode running (${o})`)},App.fetch_status_code=async()=>{const e=await fetch(App.auto_endpoint,{cache:"no-store"});if(!e.ok)throw new Error(`Status endpoint returned ${e.status}`);return e.text()},App.stop_status_watch=()=>{App.clear_status_watch()},App.strudel_watch_status=()=>{if(!App.strudel_watch_status){console.warn("Polling function missing. Did strudel bundle load?");return}if(!App.auto_delay||App.auto_delay<=0){console.error("Provide a fetch interval in seconds greater than zero");return}App.status_watch_cancelled=!1;const e=App.auto_delay*1e3,t=async()=>{if(console.info("Fetching status..."),!App.fetch_in_flight){App.fetch_in_flight=!0;try{const a=(await App.fetch_status_code()).trim();if(!a)return;if(App.status_watch_cancelled){console.info("Status watch was cancelled, skipping play action");return}App.set_song_context(),App.audio_started?await App.play_action(a):App.code_to_play=a}catch(o){console.error("Failed to update Strudel status",o)}finally{App.fetch_in_flight=!1}}};App.clear_status_watch(!1),t(),App.fetch_timer=setInterval(()=>{t()},e),console.info("Interval started.")},App.clear_status_watch=(e=!0)=>{App.fetch_timer&&(console.info("Interval cleared."),clearInterval(App.fetch_timer),App.fetch_timer=void 0,e&&(App.status_watch_cancelled=!0))},App.animation_frames=0,App.visual_items=[{text:"auto",alt_text:"Auto - The code sets it",title:"Let the code decide. If the code contains animation calls they will be visible, else it will be a solid background"},{text:"none",alt_text:"None - Solid background",title:"Use a solid background. Most performant option"},{text:"flux surface",title:"A shimmering, flowing horizon where colors swirl like a sunset blending into dawn, a landscape in constant motion that feels alive and mysterious, like walking through a translucent, rippling lake of light"},{text:"hyper rose",title:"A surreal garden of glowing petals that pulse with vibrant energy, blossoms blooming in impossible hues, evoking a sense of wonder and infinite growth in a dreamlike meadow"},{text:"bio tunnel",title:"A lush, organic corridor woven with twisting vines and luminous flora, evoking the feeling of wandering through an underground rainforest alive with whispers of nature’s secret life"},{text:"liquid aether",title:"A flowing, translucent river of ethereal substance, shimmering with iridescent waves that pulse softly, inviting you to drift through an otherworldly sea of pure energy and serenity"},{text:"aurora borealis",title:"A celestial dance of shimmering lights in the night sky, ribbons of green, pink, and purple swirling gracefully over icy mountains, evoking awe and the mysterious beauty of the polar skies"},{text:"orb balloons",title:"A whimsical cluster of floating orbs, each glowing softly like lanterns drifting lazily in a gentle breeze, creating a playful, dreamlike atmosphere of floating serenity and joyful levity"}],App.start_visual=()=>{App.visual=App.visual||"flux surface",App.background_canvas=DOM.el("#background-canvas"),App.background_canvas_ctx=App.background_canvas.getContext("2d"),App.visual_animations=[App.anim_neon_waves],window.addEventListener("resize",()=>{App.background_canvas&&(App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight)}),App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight,App.apply_visual(App.visual)},App.create_visual_modal=()=>{let e=App.create_list_modal("visual"),t=DOM.el(".modal-title",e);t.textContent="Select Visual"},App.open_visual_modal=async()=>{let e=App.visual_items;App.show_items_modal("visual",{items:e,action:t=>{let o=t.text.toLowerCase();App.apply_visual(o),App.close_modal("visual")},active:App.get_active_visual_index()})},App.apply_visual=e=>{App.visual=e,App.stor_save_visual(),["auto"].includes(e)?(App.clear_visual(),App.background_canvas.classList.add("under")):["none"].includes(e)?(App.clear_visual(),App.background_canvas.classList.remove("under")):(App.background_canvas.classList.remove("under"),App.render_animation())},App.anim_bio_tunnel=(e,t,o,a)=>{let u=t/2,l=o/2,p=a*.02;for(let d=0;d<40;d++){let g=(d*20+a*5)%1e3,f=1e3/(g+10);if(f>20)continue;e.beginPath(),e.lineWidth=2*f;let A=(p*50+g*.5)%360;e.strokeStyle=`hsla(${A}, 80%, 60%, ${g/1e3})`;for(let b=0;b<=6;b++){let F=b/6*Math.PI*2,k=(200+Math.sin(p*3+F*4)*50)*f,$=p*.5,R=u+Math.cos(F+$)*k,I=l+Math.sin(F+$)*k;b===0?e.moveTo(R,I):e.lineTo(R,I)}e.closePath(),e.stroke()}},App.anim_flux_surface=(e,t,o,a)=>{const l=a*.03;e.lineWidth=2;for(let p=-100;p<o+100;p+=25){e.beginPath();let d=(p*.2+a*.5)%360;e.strokeStyle=`hsla(${d}, 60%, 60%, 0.8)`;for(let g=0;g<=t;g+=20){let f=Math.sin(g*.005+l)*50,A=Math.sin(g*.02-l*2+p*.01)*15,b=f+A;e.lineTo(g,p+b)}e.stroke()}},App.anim_hyper_rose=(e,t,o,a)=>{let u=t/2,l=o/2,p=Math.max(t,o)*.8,d=a*.002;e.lineWidth=1,e.globalCompositeOperation="lighter";for(let g=0;g<15;g++){let f=g/15,A=p*(1-f),b=(a*.2+g*10)%360;e.strokeStyle=`hsla(${b}, 80%, 50%, 0.5)`,e.beginPath();for(let F=0;F<Math.PI*4;F+=.05){let S=Math.sin(F*7+d*5)*Math.cos(F*3-d),k=A*(.5+.5*S),$=d*(g+1),R=u+Math.cos(F+$)*k,I=l+Math.sin(F+$)*k;e.lineTo(R,I)}e.closePath(),e.stroke()}e.globalCompositeOperation="source-over"},App.anim_liquid_aether=(e,t,o,a)=>{(!App.flow_particles||App.flow_particles.length!==1e3)&&(App.flow_particles=Array(1e3).fill().map(()=>({x:Math.random()*t,y:Math.random()*o,speed:Math.random()*1.5+.5,life:Math.random()*100}))),(!App.bg_orbs||App.bg_orbs.length!==5)&&(App.bg_orbs=Array(5).fill().map((g,f)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*2,radius:Math.random()*200+300,hue:f*120}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(10, 5, 20, 0.1)",e.fillRect(0,0,t,o);const p=a*.002;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(g=>{g.x+=g.vx+Math.sin(p)*2,g.y+=g.vy+Math.cos(p)*2,g.x<-g.radius&&(g.x=t+g.radius),g.x>t+g.radius&&(g.x=-g.radius),g.y<-g.radius&&(g.y=o+g.radius),g.y>o+g.radius&&(g.y=-g.radius);const f=e.createRadialGradient(g.x,g.y,0,g.x,g.y,g.radius),A=.1+Math.sin(p*3+g.hue)*.05;f.addColorStop(0,`hsla(${g.hue+a*.1}, 60%, 40%, ${A})`),f.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=f,e.beginPath(),e.arc(g.x,g.y,g.radius,0,Math.PI*2),e.fill()}),e.lineWidth=.5;let d=.002+Math.sin(p*.5)*.001;App.flow_particles.forEach(g=>{g.life--,g.life<=0&&(g.x=Math.random()*t,g.y=Math.random()*o,g.life=100+Math.random()*100),e.beginPath();let f=(a*.2+g.x*.05+g.y*.05)%360,A=40+g.speed*30;e.strokeStyle=`hsla(${f}, 80%, ${A}%, 0.6)`,e.moveTo(g.x,g.y);const b=(Math.cos(g.x*d+p)+Math.sin(g.y*d+p))*Math.PI*2;g.x+=Math.cos(b)*g.speed*2,g.y+=Math.sin(b)*g.speed*2,e.lineTo(g.x,g.y),e.stroke(),g.x<0&&(g.x=t),g.x>t&&(g.x=0),g.y<0&&(g.y=o),g.y>o&&(g.y=0)}),e.globalCompositeOperation="source-over"},App.anim_orb_balloons=(e,t,o,a)=>{let u=8;(!App.bg_orbs||App.bg_orbs.length!==u)&&(App.bg_orbs=Array(u).fill().map((p,d)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*3,vy:(Math.random()-.5)*3,base_radius:Math.random()*150+100,hue:Math.random()*360,phase:Math.random()*Math.PI*2}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(15, 5, 25, 0.2)",e.fillRect(0,0,t,o);let l=a*.01;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(p=>{p.x+=p.vx,p.y+=p.vy,p.x<-p.base_radius&&(p.vx*=-1),p.x>t+p.base_radius&&(p.vx*=-1),p.y<-p.base_radius&&(p.vy*=-1),p.y>o+p.base_radius&&(p.vy*=-1);let d=p.base_radius+Math.sin(l+p.phase)*50,g=e.createRadialGradient(p.x,p.y,0,p.x,p.y,d),f=(p.hue+a*.5)%360;g.addColorStop(0,`hsla(${f}, 80%, 60%, 0.6)`),g.addColorStop(1,`hsla(${f}, 80%, 40%, 0)`),e.fillStyle=g,e.beginPath(),e.arc(p.x,p.y,d,0,Math.PI*2),e.fill()}),e.globalCompositeOperation="source-over"},App.anim_aurora_borealis=(e,t,o,a)=>{let u=a*.02;e.lineWidth=2,e.globalCompositeOperation="lighter";for(let l=0;l<5;l++){e.beginPath();let p=o*.8,d=(a*.5+l*50)%360;e.fillStyle=`hsla(${d}, 60%, 50%, 0.3)`,e.moveTo(0,o);for(let g=0;g<=t;g+=20){let f=Math.sin(g*.002+u+l)*100+Math.sin(g*.01-u*2)*50;e.lineTo(g,p+f-l*100)}e.lineTo(t,o),e.closePath(),e.fill()}e.globalCompositeOperation="source-over"},App.render_animation=()=>{if(["auto","none"].includes(App.visual))return;let e=window.innerWidth,t=window.innerHeight,o="rgba(0, 0, 0, 0.12)";if(App.background_canvas_ctx.fillStyle=o,App.background_canvas_ctx.fillRect(0,0,e,t),App.visual==="bio tunnel")App.anim_bio_tunnel(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="flux surface")App.anim_flux_surface(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="hyper rose")App.anim_hyper_rose(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="liquid aether")App.anim_liquid_aether(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="aurora borealis")App.anim_aurora_borealis(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="orb balloons")App.anim_orb_balloons(App.background_canvas_ctx,e,t,App.animation_frames);else{App.apply_visual("auto");return}App.animation_frames++,requestAnimationFrame(App.render_animation)},App.clear_visual=()=>{let e=window.innerWidth,t=window.innerHeight;App.background_canvas_ctx.clearRect(0,0,e,t)},App.get_active_visual_index=()=>App.visual_items.map(e=>e.text).indexOf(App.visual),App.next_visual=()=>{let e=App.get_active_visual_index();e+=1,e>=App.visual_items.length&&(e=0),e<=1&&(e=2);let t=App.visual_items[e];App.apply_visual(t.text)},App.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},App.escape_regex=e=>e.replace(/[\^$*+?.()|[\]{}-]/g,"\\$&"),App.underspace=e=>e.replace(/_+/g," ").trim(),App.clean_canvas=()=>{let e=document.body,t=DOM.els("canvas");for(let o of t)["scope-canvas","background-canvas"].includes(o.id)||Array.from(o.classList).some(u=>["modal-icon"].includes(u))||e.removeChild(o)},App.truncate_path=(e,t=20)=>e.length<=t?e:e.substring(0,t)+"...",App.random_int=(e={})=>{let t={exclude:[]};if(App.def_args(t,e),e.exclude.length>0){let o=[];for(let u=e.min;u<=e.max;u++)e.exclude.includes(u)||o.push(u);if(o.length===0)return;let a;return e.rand?a=Math.floor(e.rand()*o.length):a=Math.floor(Math.random()*o.length),o[a]}return e.rand?Math.floor(e.rand()*(e.max-e.min+1)+e.min):Math.floor(Math.random()*(e.max-e.min+1)+e.min)},App.create_debouncer=(e,t)=>{if(typeof e!="function"){App.error("Invalid debouncer function");return}if(typeof t!="number"||t<1){App.error("Invalid debouncer delay");return}let o,a={};function u(){clearTimeout(o),o=void 0}function l(...p){e(...p)}return a.call=(...p)=>{u(),o=setTimeout(()=>{l(...p)},t)},a.call_2=(...p)=>{o||a.call(p)},a.now=(...p)=>{u(),l(...p)},a.cancel=()=>{u()},a},App.boolstring=e=>e&&e==="true",App.capitalize=e=>e.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),App.tempo_storage_key="slide.tempo",App.auto_endpoint_storage_key="slide.auto_endpoint",App.auto_delay_storage_key="slide.auto_delay",App.volume_storage_key="slide.volume",App.visual_storage_key="slide.visual",App.scope_storage_key="slide.scope",App.colors_storage_key="slide.colors",App.code_storage_key="slide.code",App.load_storage=(e,t)=>{let o=localStorage.getItem(App[`${e}_storage_key`]);[null,void 0].includes(o)||t(o)},App.save_storage=(e,t)=>{localStorage.setItem(App[`${e}_storage_key`],t)},App.load_all_storage=()=>{App.stor_load_auto_endpoint(),App.stor_load_auto_delay(),App.stor_load_tempo(),App.stor_load_volume(),App.stor_load_visual(),App.stor_load_scope(),App.stor_load_colors(),App.stor_load_code()},App.stor_load_auto_endpoint=()=>{App.load_storage("auto_endpoint",e=>{App.auto_endpoint=e})},App.stor_load_auto_delay=()=>{App.load_storage("auto_delay",e=>{App.auto_delay=parseInt(e)})},App.stor_load_tempo=()=>{App.load_storage("tempo",e=>{App.tempo=parseInt(e)})},App.stor_load_volume=()=>{App.load_storage("volume",e=>{App.volume=parseInt(e)})},App.stor_load_visual=()=>{App.load_storage("visual",e=>{App.visual=e})},App.stor_load_scope=()=>{App.load_storage("scope",e=>{App.scope_enabled=App.boolstring(e)})},App.stor_load_colors=()=>{App.load_storage("colors",e=>{App.colors_enabled=App.boolstring(e)})},App.stor_load_code=()=>{App.load_storage("code",e=>{App.last_code=e})},App.stor_save_auto_delay=()=>{App.save_storage("auto_delay",App.auto_delay)},App.stor_save_auto_endpoint=()=>{App.save_storage("auto_endpoint",App.auto_endpoint)},App.stor_save_tempo=()=>{App.save_storage("tempo",App.tempo)},App.stor_save_volume=()=>{App.save_storage("volume",App.volume)},App.stor_save_visual=()=>{App.save_storage("visual",App.visual)},App.stor_save_scope=()=>{App.save_storage("scope",App.scope_enabled)},App.stor_save_colors=()=>{App.save_storage("colors",App.colors_enabled)},App.stor_save_code=()=>{App.save_storage("code",App.last_code)},App.beep_sound=()=>{try{let e=App.get_audio_context(),t=e.createOscillator(),o=e.createGain();t.type="triangle",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.linearRampToValueAtTime(445,e.currentTime+.1),o.gain.setValueAtTime(.05,e.currentTime),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),t.connect(o),o.connect(e.destination),t.start(),t.stop(e.currentTime+.2)}catch(e){console.error("Failed to play sound",e)}},App.get_audio_context=()=>{if(window.master_fx&&window.master_fx.context)return window.master_fx.context;if(App.audio_context)return App.audio_context;try{return App.audio_context=new(AudioContext||window.webkitAudioContext),App.audio_context}catch{return console.error("Web Audio API is not supported"),null}},App.splash_reverb=e=>{window.master_fx.splash_reverb(e)},App.set_panning=(e,t=0)=>{if(window.master_fx.set_panning(e),t>0){clearInterval(App.panning_interval);let o=e/(t*1e3/50),a=e;App.panning_interval=setInterval(()=>{a-=o,Math.abs(a)<=Math.abs(o)?(window.master_fx.set_panning(0),clearInterval(App.panning_interval)):window.master_fx.set_panning(a)},50)}},App.get_panning=()=>App.panning.pan.value,App.set_gain=e=>{window.master_fx.set_volume(e)},App.set_eq=(e,t,o)=>{window.master_fx.set_eq_freqs(e,t,o)},App.is_playing=!1,App.play_running=!1,App.reset_playing=()=>{App.play_running=!1},App.play_action=async(e="",t=!1)=>{if(App.play_running)return;if(App.play_running=!0,App.update_url(),!await App.ensure_strudel_ready()){App.reset_playing();return}if(e||(e=App.get_input().value),!e){App.reset_playing();return}if(!t&&e===App.last_code){App.reset_playing();return}App.stop_status_watch(),App.restart_code_scroll(),App.last_code=e,App.stor_save_code(),App.clear_draw_context(),App.start_color_cycle(),App.clean_canvas(),App.update_title(),App.is_playing=!0;try{await App.strudel_update(e)}catch(a){App.set_status(`Error: ${a.message}`)}App.reset_playing()},App.stop_action=()=>{App.stop_status_watch(),App.stop_strudel(),App.stop_code_scroll(),App.clear_draw_context(),App.set_stop_status(),App.set_song_context(""),App.is_playing=!1},App.stop_strudel=()=>{App.stop_color_cycle(),App.clear_draw_context(),App.scheduler.stop(),App.clean_canvas()},App.strudel_update=async e=>{if(!App.audio_started){console.warn("Audio not started yet. Call strudel_init() first.");return}console.info("Updating 💨"),await App.ensure_scope(),App.set_tempo();const t=await App.run_eval(e);if(t.ok){App.playing();return}App.do_partial_updates&&await App.apply_partial_update(e)||App.report_eval_failure(t.error)},App.playing=e=>{let t="",o=App.get_matched_song();o&&(t=`Playing: ${o.clean_name}`,App.update_url(o.name)),t||(App.beat_title?t=`Playing: ${App.beat_title}`:t="Playing 🥁",App.update_url()),e&&(t=`${t} - ${e}`.trim()),App.set_status(t)},App.set_stop_status=()=>{let e=App.get_matched_song();e?App.set_status(`Stopped: ${e.clean_name}`):App.set_status("Stopped")},App.load_last_code=()=>{App.last_code&&App.set_input(App.last_code)},App.load_code_from_query=()=>{let t=new URLSearchParams(window.location.search).get(App.code_query_key);if(!t)return!1;try{return App.last_code=t,App.load_last_code(),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.set_cpm_from_query=()=>{let t=App.get_query_params().get(App.cpm_query_key);if(t){let o=parseInt(t,10);Number.isFinite(o)&&(App.update_tempo(o),App.set_tempo())}},App.set_beat_title_from_query=()=>{let t=App.get_query_params().get(App.beat_query_key);t&&(App.beat_title=t)},App.tempo_madness=()=>{},App.create_settings_modal=()=>{let e=App.create_modal("settings"),t=DOM.el(".modal-title",e);t.textContent="Settings";let o=DOM.el(".modal-body",e),a=App.register_setting("Select Visual","Change the background animation",()=>{App.open_visual_modal()}),u=App.register_setting("Toggle Scope","Show or hide the scope visualizer",()=>{App.toggle_scope()}),l=App.register_setting("Toggle Colors","Enable or disable the color animation",()=>{App.toggle_colors()});o.appendChild(a),o.appendChild(u),o.appendChild(l)},App.register_setting=(e,t,o)=>{let a=DOM.create("button");return a.textContent=e,a.title=t,DOM.ev(a,"click",()=>{o(),App.close_modal("settings")}),a},App.open_settings_modal=()=>{App.open_modal("settings")},App.beat_title="",App.setup_status=()=>{App.status_debouncer=App.create_debouncer(e=>{App.do_set_status(e)},300),DOM.ev("#status","click",()=>{App.ask_for_title()})},App.set_status=e=>{App.status_debouncer&&App.status_debouncer.call(e)},App.do_set_status=e=>{let t=DOM.el("#status");t.innerText=e},App.ask_for_title=()=>{if(App.get_matched_song())return;let t=prompt("Title of this beat");t&&(App.beat_title=t.trim(),App.update_url(),App.update_title(),App.is_playing&&App.playing())},App.start_keyboard=()=>{DOM.ev(document,"keydown",e=>{if(e.key==="s")e.ctrlKey&&(e.preventDefault(),App.play_action());else if(e.key==="Escape"){if(e.preventDefault(),NeedContext.open)return;App.modal_open()?App.close_current_modal():App.stop_action()}else e.key==="1"?e.ctrlKey&&App.show_sounds_context():e.key==="2"?e.ctrlKey&&App.show_notes_context():e.key==="3"&&e.ctrlKey&&App.show_banks_context()})},NeedContext.init(),NeedContext.after_hide=()=>{App.focus_input()},App.show_sounds_context=e=>{let t=[];for(let o of App.strudel_sounds)t.push({text:o,action:()=>{App.add_word_to_input(o)}});App.show_context(t,e,"Sounds")},App.show_notes_context=e=>{let t=[];for(let o of App.strudel_notes)t.push({text:o,action:()=>{App.add_word_to_input(o)}});App.show_context(t,e,"Notes")},App.show_banks_context=e=>{let t=[];for(let o of App.strudel_banks)t.push({text:o,action:()=>{App.add_word_to_input(o)}});App.show_context(t,e,"Banks")},App.show_context=(e,t,o)=>{let a={items:e,title:o};t&&(a.x=t.x,a.y=t.y),NeedContext.show(a)},App.strudel_banks=["AJKPercusyn","AkaiLinn","AkaiMPC60","AkaiXR10","AlesisHR16","AlesisSR16","BossDR110","BossDR220","BossDR55","BossDR550","CasioRZ1","CasioSK1","CasioVL1","DoepferMS404","EmuDrumulator","EmuSP12","KorgDDM110","KorgKPR77","KorgKR55","KorgKRZ","KorgM1","KorgMinipops","KorgPoly800","KorgT3","Linn9000","LinnLM1","LinnLM2","MoogConcertMateMG1","OberheimDMX","RhodesPolaris","RhythmAce","RolandCompurhythm1000","RolandCompurhythm78","RolandCompurhythm8000","RolandD110","RolandD70","RolandDDR30","RolandJD990","RolandMC202","RolandMC303","RolandMT32","RolandR8","RolandS50","RolandSH09","RolandSystem100","RolandTR505","RolandTR606","RolandTR626","RolandTR707","RolandTR727","RolandTR808","RolandTR909","SakataDPM48","SequentialCircuitsDrumtracks","SequentialCircuitsTom","SimmonsSDS400","SimmonsSDS5","SoundmastersR88","UnivoxMicroRhythmer12","ViscoSpaceDrum","XdrumLM8953","YamahaRM50","YamahaRX21","YamahaRX5","YamahaRY30","YamahaTG33"],App.strudel_sounds=["sawtooth","square","triangle","sine","sax","gtr","moog","white","pink","brown","bd","sd","rim","hh","oh","lt","mt","ht","rd","cr"],App.strudel_notes=["c4","e4","g4","a4","f4","d4","b4","c3","e3","g3","a3","f3","d3","b3","f#4","bb4","c#4","eb4","g#4","f#3","bb3","c#3","eb3","g#3","c5","e5","g5","a5","f5","d5","b5","c2","e2","g2","a2","f2","d2","b2","f#5","bb5","c#5","eb5","g#5","f#2","bb2","c#2","eb2","g#2","c6","e6","g6","a6","f6","d6","b6","c1","e1","g1","a1","f1","d1","b1","f#6","bb6","c#6","eb6","g#6","f#1","bb1","c#1","eb1","g#1","c7","e7","g7","c0","e0","g0"],App.colors_enabled=!0,App.apply_color=e=>{let t=App.get_input(),o=DOM.el("#volume-value"),a=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),l=DOM.el("#tempo-slider"),p=DOM.el("#status"),d=DOM.el("#image"),g=DOM.el("#scope-container"),f=DOM.el("#scope-canvas");t&&(t.style.color=e),o&&(o.style.color=e),a&&(a.style.accentColor=e),u&&(u.style.color=e),l&&(l.style.accentColor=e),p&&(p.style.color=e),d&&(d.style.filter=`drop-shadow(0 0 0.15rem ${e})`),g&&(g.style.borderColor=App.scope_border_color,g.style.boxShadow=`0 0 0.35rem ${App.scope_border_color}33`),f&&(f.style.boxShadow=`inset 0 0 0.4rem ${App.scope_border_color}1a`)},App.start_color_cycle=()=>{App.colors_enabled&&(App.color_cycle_timer||(App.color_index=0,App.apply_color(App.cycle_colors[0],0),App.color_cycle_timer=setInterval(()=>{App.color_index=(App.color_index+1)%App.cycle_colors.length,App.apply_color(App.cycle_colors[App.color_index],App.color_index)},3*1e3)))},App.stop_color_cycle=()=>{App.color_cycle_timer&&(clearInterval(App.color_cycle_timer),App.color_cycle_timer=void 0),App.color_index=0;let e=App.cycle_colors[0],t=App.get_input(),o=DOM.el("#volume-value"),a=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),l=DOM.el("#tempo-slider"),p=DOM.el("#status"),d=DOM.el("#image");t&&(t.style.color=e),o&&(o.style.color=e),a&&(a.style.accentColor=e),u&&(u.style.color=e),l&&(l.style.accentColor=e),p&&(p.style.color=e),d&&(d.style.filter="")},App.toggle_colors=()=>{App.colors_enabled=!App.colors_enabled,App.stor_save_colors(),App.is_playing&&(App.colors_enabled?App.start_color_cycle():App.is_playing&&App.stop_color_cycle())},App.check_scope_slide=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords;Math.abs(App.scope_max_y-App.scope_min_y)>=App.max_scope_slide_y_dff||Math.abs(e.x-t.x)>=App.scope_slide_distance&&(e.x<t.x?App.random_song():App.next_visual(),App.clear_clicks())},App.check_scope_panning=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords,{width:o,height:a}=App.get_scope_dimensions(),u=App.scope_panning_zone,l=App.scope_padding_amount;return e.x<=u||t.x<=u?(App.set_panning(-l,3),!0):e.x>=o-u||t.x>=o-u?(App.set_panning(l,3),!0):!1},App.triangle_gesture=()=>{let e=(u,l)=>{let p=u.x-l.x,d=u.y-l.y;return p*p+d*d},t=(u,l,p)=>{let d=e(l,p);if(d===0)return e(u,l);let g=((u.x-l.x)*(p.x-l.x)+(u.y-l.y)*(p.y-l.y))/d;return g=Math.max(0,Math.min(1,g)),e(u,{x:l.x+g*(p.x-l.x),y:l.y+g*(p.y-l.y)})},o=(u,l)=>{if(u.length<=2)return u;let p=0,d=0,g=u.length-1;for(let f=1;f<g;f++){let A=t(u[f],u[0],u[g]);A>p&&(p=A,d=f)}if(p>l*l){let f=o(u.slice(0,d+1),l),A=o(u.slice(d),l);return f.slice(0,f.length-1).concat(A)}return[u[0],u[g]]};return(u=>{let l=u.length;if(l<10)return!1;let p=1/0,d=-1/0,g=1/0,f=-1/0;for(let I=0;I<l;I++)p=Math.min(p,u[I].x),d=Math.max(d,u[I].x),g=Math.min(g,u[I].y),f=Math.max(f,u[I].y);let A=Math.hypot(d-p,f-g),b=u[0],F=u[l-1];if(Math.hypot(b.x-F.x,b.y-F.y)/A>.2)return!1;let k=A*.15,R=o(u,k).length;return R===3||R===4})(App.scope_clicks)},App.circle_gesture=()=>{let e=App.scope_clicks;if(!e||!Array.isArray(e))return!1;let t=e.length;if(t<8)return!1;let o=1/0,a=-1/0,u=1/0,l=-1/0,p=0,d=0;for(let re=0;re<t;re++){let oe=e[re];oe.x<o&&(o=oe.x),oe.x>a&&(a=oe.x),oe.y<u&&(u=oe.y),oe.y>l&&(l=oe.y),p+=oe.x,d+=oe.y}let g=Math.hypot(a-o,l-u),f=e[0],A=e[t-1];if(Math.hypot(f.x-A.x,f.y-A.y)/g>.35)return!1;let F=a-o,S=l-u,k=F/S;if(k<.4||k>2.5)return!1;let $=p/t,R=d/t,I=0,z=[];for(let re=0;re<t;re++){let oe=e[re].x-$,_e=e[re].y-R,ue=Math.hypot(oe,_e);z.push(ue),I+=ue}let ie=I/t,U=0;for(let re=0;re<t;re++){let oe=z[re]-ie;U+=oe*oe}return Math.sqrt(U/t)/ie<.3},App.cycle_panning=(e,t)=>{let o=App.get_panning(),a=0,l=setInterval(()=>{let p=a%2===0?-1:1,d=e*p,g=o+d;App.set_panning(g),a=a+1,a>=t&&(clearInterval(l),App.set_panning(o))},200)};const start_app_events=()=>{window?.App?.start_events&&window.App.start_events()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{start_app_events()},{once:!0}):start_app_events()})();
