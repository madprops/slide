(function(){"use strict";const App$1={};window.App=App$1;const DOM$1={};DOM$1.dataset_obj={},DOM$1.dataset_id=0,DOM$1.el=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),t.querySelector(e)),DOM$1.els=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),Array.from(t.querySelectorAll(e))),DOM$1.el_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=t.querySelector(e);return o||t.classList.contains(DOM$1.clean_dot(e))&&(o=t),o},DOM$1.els_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=Array.from(t.querySelectorAll(e));return o.length===0&&t.classList.contains(DOM$1.clean_dot(e))&&(o=[t]),o},DOM$1.clone=e=>(e=DOM$1.element(e),e.cloneNode(!0)),DOM$1.clone_children=e=>{e=DOM$1.element(e);let t=Array.from(e.children),o=[];for(let u of t)o.push(DOM$1.clone(u));return o},DOM$1.dataset=(e,t,o)=>{if(e=DOM$1.element(e),!e)return;let u=e.dataset.dataset_id;if(u||(u=DOM$1.dataset_id,DOM$1.dataset_id+=1,e.dataset.dataset_id=u,DOM$1.dataset_obj[u]={}),o!==void 0)DOM$1.dataset_obj[u][t]=o;else return DOM$1.dataset_obj[u][t]},DOM$1.create=(e,t="",o="")=>{let u=document.createElement(e);if(t){let p=t.split(" ").filter(f=>f!=="");for(let f of p)u.classList.add(f)}return o&&(u.id=o),u},DOM$1.ev=(e,t,o,u)=>{e=DOM$1.element(e),e.addEventListener(t,o,u)},DOM$1.evs=(e,t,o,u)=>{e=DOM$1.element(e);for(let p of t)e.addEventListener(p,o,u)},DOM$1.index=e=>(e=DOM$1.element(e),Array.from(e.parentNode.children).indexOf(e)),DOM$1.class=(e,t)=>{e=DOM$1.element(e);for(let o of t)if(e.classList.contains(DOM$1.clean_dot(o)))return!0;return!1},DOM$1.parent=(e,t)=>{e=DOM$1.element(e);for(let o of t){let u=e.closest(o);if(u)return u}},DOM$1.clean_dot=e=>e.replace(".",""),DOM$1.show=(e,t=1)=>{e=DOM$1.element(e),e.classList.remove(DOM$1.hidden(t))},DOM$1.hide=(e,t=1)=>{e=DOM$1.element(e),e.classList.add(DOM$1.hidden(t))},DOM$1.hidden=(e=1)=>{let t="hidden";return e>1&&(t+=`_${e}`),t},DOM$1.is_hidden=(e,t=1)=>e.classList.contains(DOM$1.hidden(t)),DOM$1.element=e=>typeof e=="string"?DOM$1.el(e):e,typeof window<"u"&&(window.DOM=DOM$1);const NeedContext$1={};NeedContext$1.created=!1,NeedContext$1.after_show=()=>{},NeedContext$1.after_hide=()=>{},NeedContext$1.min_width="25px",NeedContext$1.min_height="25px",NeedContext$1.back_icon="⬅️",NeedContext$1.back_text="Back",NeedContext$1.clear_text="Clear",NeedContext$1.item_sep="4px",NeedContext$1.layers={},NeedContext$1.level=0,NeedContext$1.gap="0.5rem",NeedContext$1.side_padding="0.5rem",NeedContext$1.compact_padding="0.3rem",NeedContext$1.center_top=20,NeedContext$1.dragging=!1,NeedContext$1.autohide_delay=500,NeedContext$1.autoclick_delay=500,NeedContext$1.autohide_threshold=5,NeedContext$1.set_defaults=()=>{NeedContext$1.open=!1,NeedContext$1.mousedown=!1,NeedContext$1.first_mousedown=!1,NeedContext$1.keydown=!1,NeedContext$1.filtered=!1,NeedContext$1.last_x=0,NeedContext$1.last_y=0,NeedContext$1.layers={},NeedContext$1.mouse_activity={},NeedContext$1.autohide_enabled=!1,NeedContext$1.reset_debouncers()},NeedContext$1.clear_filter=()=>{NeedContext$1.filter.value="",NeedContext$1.do_filter(),NeedContext$1.filter.focus()},NeedContext$1.do_filter=()=>{let e=NeedContext$1.filter.value,t=NeedContext$1.remove_spaces_2(e).toLowerCase(),o=t.includes(":"),u=!1;for(let b of document.querySelectorAll(".needcontext-separator"))t?b.classList.add("needcontext-hidden"):b.classList.remove("needcontext-hidden");for(let b of document.querySelectorAll(".needcontext-text")){let M=b.closest(".needcontext-item"),F=b.textContent.toLowerCase();F=NeedContext$1.remove_spaces(F),o||(F=F.replace(/:/g,"")),F.includes(t)?(M.classList.remove("needcontext-hidden"),u||(NeedContext$1.select_item(parseInt(M.dataset.index)),u=!0)):M.classList.add("needcontext-hidden")}let p=document.querySelector("#needcontext-back"),f=document.querySelector("#needcontext-clear");if(NeedContext$1.filtered=t!=="",NeedContext$1.filtered){let b=document.querySelector("#needcontext-clear-text");b.textContent=e.trim(),f.classList.remove("needcontext-hidden"),p&&p.classList.add("needcontext-hidden")}else f.classList.add("needcontext-hidden"),p&&p.classList.remove("needcontext-hidden");NeedContext$1.scroll_to_selected()},NeedContext$1.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},NeedContext$1.show=(e={})=>{let t={root:!0,expand:!1,picker_mode:!1,margin:0,compact:!1,autohide:!1,autoclick:!1};if(NeedContext$1.def_args(t,e),!e.items.length)return;if(NeedContext$1.reset_debouncers(),NeedContext$1.created||NeedContext$1.create(),e.e&&e.e.clientX!==void 0&&e.e.clientY!==void 0)e.x=e.e.clientX,e.y=e.e.clientY;else if(e.element){let S=e.element.getBoundingClientRect();e.x=S.left,e.y=S.top+e.margin}e.root&&(NeedContext$1.level=0);let o=e.x===void 0||e.y===void 0;if(e.items=e.items.slice(0),e.index===void 0){let S=e.items.filter(k=>!k.separator);for(let[k,N]of S.entries())if(N.selected){e.index=k;break}}e.index===void 0&&(e.index=0),e.index>=e.items.length&&(e.index=e.items.length-1);let u,p=NeedContext$1.get_layer();p?u=p.last_index:u=e.index,u=u||0;for(let[S,k]of e.items.entries())S===u?k.selected=!0:k.selected=!1;let f=0,b=NeedContext$1.container;if(b.innerHTML="",b.style.left="unset",b.style.top="unset",b.style.transform="unset",b.style.minWidth="unset",b.style.minHeight="unset",e.title&&!e.compact){let S=document.createElement("div");S.id="needcontext-title",e.title_icon&&(document.createElement("div").classList.add("needcontext-title-icon"),S.append(e.title_icon));let k=document.createElement("div");if(k.textContent=e.title.trim(),S.append(k),b.append(S),e.title_number){let N=document.createElement("div");N.classList.add("needcontext-title-number"),S.append(N)}b.classList.add("with_title"),b.classList.remove("without_title")}else b.classList.remove("with_title"),b.classList.add("without_title");e.root||b.append(NeedContext$1.back_button()),b.append(NeedContext$1.clear_button());let M=[];e.compact?b.classList.add("needcontext-compact"):b.classList.remove("needcontext-compact");for(let S of e.items){if(e.compact&&!S.icon)continue;let k=document.createElement("div");if(k.classList.add("needcontext-item"),S.separator)k.classList.add("needcontext-separator");else{if(k.classList.add("needcontext-normal"),S.highlight&&k.classList.add("needcontext-highlight"),S.image){let N=document.createElement("img");N.loading="lazy",N.addEventListener("error",$=>{$.target.classList.add("needcontext-hidden")}),N.classList.add("needcontext-image"),N.src=S.image,k.append(N)}if(S.icon){let N=document.createElement("div");N.classList.add("needcontext-icon"),S.icon_action&&N.addEventListener("click",$=>{S.icon_action($,N)}),N.append(S.icon),k.append(N)}if(S.text){let N=document.createElement("div");N.classList.add("needcontext-text"),N.textContent=S.text.trim(),k.append(N)}if(e.compact){if(e.compact){let N=[S.text,S.info].filter(Boolean);k.title=N.join(" - ")}}else S.info&&(k.title=S.info.trim());S.bold&&k.classList.add("needcontext-bold"),S.direct_action&&k.addEventListener("click",()=>{S.direct_action(),NeedContext$1.hide()}),k.dataset.index=f,S.index=f,k.addEventListener("mousemove",()=>{let N=parseInt(k.dataset.index);NeedContext$1.index!==N&&NeedContext$1.select_item(N)}),f+=1,M.push(S)}e.on_drag&&(k.draggable=!0),S.element=k,S.picked=!1,b.append(k)}NeedContext$1.layers[NeedContext$1.level]={root:e.root,items:e.items,normal_items:M,last_index:u,x:e.x,y:e.y},NeedContext$1.main.classList.remove("needcontext-hidden"),NeedContext$1.update_title(),o&&(b.style.left="50%",b.style.transform="translateX(-50%)",e.y=NeedContext$1.center_top),e.y<5&&(e.y=5),e.x<5&&(e.x=5);let F=5;if(e.y+b.offsetHeight+5>window.innerHeight){let S=Math.abs(e.y+b.offsetHeight-window.innerHeight);e.y-=S+F}if(e.x+b.offsetWidth+5>window.innerWidth){let S=Math.abs(e.x+b.offsetWidth-window.innerWidth);e.x-=S+F}NeedContext$1.last_x=e.x,NeedContext$1.last_y=e.y,e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),b.style.top=`${e.y}px`,o||(b.style.left=`${e.x}px`,b.style.transform="unset"),NeedContext$1.filter.value="",NeedContext$1.filter.focus(),e.expand&&e.element?b.style.minWidth=`${e.element.clientWidth}px`:b.style.minWidth=NeedContext$1.min_width,b.style.minHeight=NeedContext$1.min_height,NeedContext$1.filter.value="",NeedContext$1.filtered=!1,NeedContext$1.select_item(u),NeedContext$1.scroll_to_selected(),NeedContext$1.open=!0,NeedContext$1.after_show(),e.root&&(NeedContext$1.args=e)},NeedContext$1.hide=e=>{NeedContext$1.open&&(NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.set_defaults(),NeedContext$1.after_hide(),NeedContext$1.args.after_hide&&NeedContext$1.args.after_hide(e))},NeedContext$1.select_item=e=>{let t=Array.from(document.querySelectorAll(".needcontext-normal"));for(let o of t)parseInt(o.dataset.index)===e?o.classList.add("needcontext-item-selected"):o.classList.remove("needcontext-item-selected");NeedContext$1.index=e},NeedContext$1.scroll_to_selected=(e="center")=>{let t=document.querySelector(".needcontext-item-selected");t&&t.scrollIntoView({block:e})},NeedContext$1.select_next=(e="down",t=!1)=>{let o=!1,u,p=NeedContext$1.get_layer().normal_items.slice(0);p=p.filter(f=>!f.removed),e==="up"&&p.reverse();for(let f of p)if(NeedContext$1.is_visible(f.element)){if(u===void 0&&(u=f.index),o){NeedContext$1.select_item(f.index),NeedContext$1.scroll_to_selected("nearest");return}f.index===NeedContext$1.index&&(o=!0)}if(!t)return NeedContext$1.select_item(u),NeedContext$1.scroll_to_selected("nearest"),!0;NeedContext$1.select_next("up")},NeedContext$1.select_action=(e,t=NeedContext$1.index,o="mouse")=>{if(o==="mouse"&&!e.target.closest(".needcontext-normal"))return;let u=NeedContext$1.get_layer().normal_items[t];if(!u)return;let p=NeedContext$1.last_x,f=NeedContext$1.last_y,b=S=>{NeedContext$1.get_layer().last_index=t,NeedContext$1.level+=1,e.clientY&&(f=e.clientY),NeedContext$1.show({x:p,y:f,items:S,root:!1})},M=S=>{S.length===1&&S[0].direct?NeedContext$1.action(S[0],e):b(S)};async function F(){if(u.action){e.shiftKey?u.shift_action&&NeedContext$1.shift_action(u,e):e.ctrlKey?u.ctrl_action&&NeedContext$1.ctrl_action(u,e):e.altKey?u.alt_action&&NeedContext$1.alt_action(u,e):NeedContext$1.action(u,e);return}else if(u.items)M(u.items);else if(u.get_items){let S=await u.get_items();M(S)}}if(o==="keyboard"){F();return}e.button===0?e.shiftKey?u.shift_action&&NeedContext$1.shift_action(u,e):e.ctrlKey?u.ctrl_action&&NeedContext$1.ctrl_action(u,e):e.altKey?u.alt_action&&NeedContext$1.alt_action(u,e):F():e.button===1?u.middle_action&&NeedContext$1.middle_action(u,e):e.button===2&&u.context_action&&NeedContext$1.context_action(u,e)},NeedContext$1.is_visible=e=>!e.classList.contains("needcontext-hidden"),NeedContext$1.remove_spaces=e=>e.replace(/[\s-]+/g,""),NeedContext$1.remove_spaces_2=e=>e.replace(/\s+/g,""),NeedContext$1.init=()=>{let e=document.createElement("style"),t=`
    #needcontext-main {
      position: fixed;
      z-index: 999999999;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }

    .needcontext-hidden {
      display: none !important;
    }

    #needcontext-container {
      z-index: 2;
      position: absolute;
      background-color: white;
      color: black;
      font-size: 16px;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      user-select: none;
      border: 1px solid #2B2F39;
      border-radius: 5px;
      padding-bottom: 5px;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: hidden;
      text-align: left;
      max-width: 98%;
    }

    #needcontext-container.needcontext-compact {
      flex-direction: row;
      flex-wrap: wrap;
      padding-left: ${NeedContext$1.compact_padding};
      padding-right: ${NeedContext$1.compact_padding};
    }

    .needcontext-compact .needcontext-text {
      display: none;
    }

    .needcontext-compact .needcontext-separator {
      display: none;
    }

    #needcontext-container.without_title {
      padding-top: 5px;
    }

    #needcontext-title {
      font-weight: bold;
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      background-color: rgba(67, 220, 255, 0.47);
      padding-top: 4px;
      padding-bottom: 4px;
      margin-bottom: 2px;
      display: flex;
      flex-direction: row;
      gap: ${NeedContext$1.gap};
      align-items: center;
      justify-content: flex-start;
    }

    #needcontext-filter {
      opacity: 0;
    }

    .needcontext-item {
      white-space: nowrap;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
    }

    .needcontext-normal {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      cursor: pointer;
    }

    .needcontext-highlight {
      border: 1px solid currentColor !important;
      border-radius: 10px;
    }

    .needcontext-picked .needcontext-text {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .needcontext-button {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
      cursor: pointer;
    }

    .needcontext-button:hover {
      text-shadow: 0 0 1rem currentColor;
    }

    .needcontext-separator {
      border-top: 1px solid currentColor;
      margin-left: ${NeedContext$1.side_padding};
      margin-right: ${NeedContext$1.side_padding};
      margin-top: ${NeedContext$1.item_sep};
      margin-bottom: ${NeedContext$1.item_sep};
      opacity: 0.7;
    }

    .needcontext-item-selected {
      background-color: rgba(0, 0, 0, 0.18);
    }

    .needcontext-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .needcontext-image {
      width: 1.11rem;
      height: 1.11rem;
      object-fit: contain;
      margin-right: 0.1rem;
    }

    .needcontext-bold {
      font-weight: bold;
    }
  `;e.innerText=t,document.head.appendChild(e),document.addEventListener("mousedown",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.first_mousedown=!0,o.target.closest("#needcontext-container")&&(NeedContext$1.mousedown=!0))}),document.addEventListener("mouseup",o=>{!NeedContext$1.open||!o.target||(o.target.closest("#needcontext-container")?o.target.closest(".needcontext-back")?o.button===0&&NeedContext$1.go_back():o.target.closest(".needcontext-clear")?o.button===0&&NeedContext$1.clear_filter():NeedContext$1.mousedown&&NeedContext$1.select_action(o):NeedContext$1.first_mousedown&&NeedContext$1.dismiss(o),NeedContext$1.mousedown=!1)}),document.addEventListener("mousemove",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.addEventListener("mouseover",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.documentElement.addEventListener("mouseleave",o=>{NeedContext$1.open&&NeedContext$1.args.autohide&&NeedContext$1.autohide_debouncer.call_2(o)}),document.addEventListener("keydown",o=>{NeedContext$1.open&&(NeedContext$1.keydown=!0,["ArrowUp","ArrowLeft"].includes(o.key)?(NeedContext$1.select_next("up"),o.preventDefault()):["ArrowDown","ArrowRight"].includes(o.key)?(NeedContext$1.select_next(),o.preventDefault()):o.key==="Backspace"&&(NeedContext$1.filtered||(NeedContext$1.go_back(),o.preventDefault())))}),document.addEventListener("keyup",o=>{NeedContext$1.open&&NeedContext$1.keydown&&(NeedContext$1.keydown=!1,o.key==="Escape"?(NeedContext$1.dismiss(o),o.preventDefault()):o.key==="Enter"&&(NeedContext$1.select_action(o,void 0,"keyboard"),o.preventDefault()))}),NeedContext$1.start_autohide(),NeedContext$1.start_autoclick(),NeedContext$1.set_defaults()},NeedContext$1.create=()=>{NeedContext$1.main=document.createElement("div"),NeedContext$1.main.id="needcontext-main",NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.container=document.createElement("div"),NeedContext$1.container.id="needcontext-container",NeedContext$1.filter=document.createElement("input"),NeedContext$1.filter.id="needcontext-filter",NeedContext$1.filter.type="text",NeedContext$1.filter.autocomplete="off",NeedContext$1.filter.spellcheck=!1,NeedContext$1.filter.placeholder="Filter",NeedContext$1.filter.addEventListener("input",e=>{NeedContext$1.do_filter()}),NeedContext$1.main.addEventListener("contextmenu",e=>{e.preventDefault()}),NeedContext$1.container.addEventListener("dragstart",e=>{NeedContext$1.dragging=!0,NeedContext$1.dragstart_action(e)}),NeedContext$1.container.addEventListener("dragenter",e=>{NeedContext$1.dragenter_action(e)}),NeedContext$1.container.addEventListener("dragend",e=>{NeedContext$1.dragging=!1,NeedContext$1.dragend_action(e)}),NeedContext$1.main.append(NeedContext$1.filter),NeedContext$1.main.append(NeedContext$1.container),document.body.appendChild(NeedContext$1.main),NeedContext$1.created=!0},NeedContext$1.dragstart_action=e=>{NeedContext$1.dragged_item=e.target;let t=NeedContext$1.container,o=Array.from(t.querySelectorAll(".needcontext-item"));NeedContext$1.dragged_index=o.indexOf(e.target)},NeedContext$1.dragenter_action=e=>{let t=NeedContext$1.dragged_item;if(t===e.target)return;let o=NeedContext$1.container,u=Array.from(o.querySelectorAll(".needcontext-item")),p=u.indexOf(t),f=u.indexOf(e.target);if(p<0||f<0)return;p<f?o.insertBefore(t,e.target.nextSibling):o.insertBefore(t,e.target),u=Array.from(o.querySelectorAll(".needcontext-item"));let b=u.indexOf(t),M=u.indexOf(e.target);t.dataset.index=b,e.target.dataset.index=M,NeedContext$1.select_item(b)},NeedContext$1.dragend_action=e=>{let t=NeedContext$1.container,o=NeedContext$1.dragged_item,p=Array.from(t.querySelectorAll(".needcontext-item")).indexOf(o);NeedContext$1.hide(e),NeedContext$1.args.on_drag(NeedContext$1.dragged_index,p)},NeedContext$1.get_layer=()=>NeedContext$1.layers[NeedContext$1.level],NeedContext$1.prev_layer=()=>NeedContext$1.layers[NeedContext$1.level-1],NeedContext$1.go_back=()=>{if(NeedContext$1.level===0)return;let e=NeedContext$1.prev_layer();NeedContext$1.level-=1;let t={x:e.x,y:e.y,items:e.items,root:e.root};t.compact=NeedContext$1.args.compact,t.autohide=NeedContext$1.args.autohide,t.autoclick=NeedContext$1.args.autoclick,NeedContext$1.show(t)},NeedContext$1.back_button=()=>{let e=document.createElement("div");e.id="needcontext-back",e.classList.add("needcontext-back"),e.classList.add("needcontext-button");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.textContent=NeedContext$1.back_text.trim(),e.append(t),e.append(o),e.title="Shortcut: Backspace",e},NeedContext$1.clear_button=()=>{let e=document.createElement("div");e.id="needcontext-clear",e.classList.add("needcontext-clear"),e.classList.add("needcontext-button"),e.classList.add("needcontext-hidden");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.id="needcontext-clear-text",o.textContent=NeedContext$1.clear_text.trim(),e.append(t),e.append(o),e.title="Type to filter. Click to clear",e},NeedContext$1.action=(e,t)=>{if(e.element&&(!NeedContext$1.is_visible(e.element)||t.target.closest(".needcontext-icon")&&e.icon_action))return;let o=NeedContext$1.args,u=NeedContext$1.args.after_action;if(o.picker_mode){e.element.classList.add("needcontext-picked"),NeedContext$1.filter.focus(),e.picked=!0;let p=!0;for(let f of o.items)if(!f.picked){p=!1;break}p&&NeedContext$1.hide(t)}else NeedContext$1.hide(t);e.action(t),u&&u(t)},NeedContext$1.dismiss=e=>{NeedContext$1.args.after_dismiss&&NeedContext$1.args.after_dismiss(e),NeedContext$1.hide(e)},NeedContext$1.shift_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_shift_action&&NeedContext$1.args.after_shift_action(t),NeedContext$1.hide(t),e.shift_action(t))},NeedContext$1.ctrl_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_ctrl_action&&NeedContext$1.args.after_ctrl_action(t),NeedContext$1.hide(t),e.ctrl_action(t))},NeedContext$1.alt_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_alt_action&&NeedContext$1.args.after_alt_action(t),NeedContext$1.hide(t),e.alt_action(t))},NeedContext$1.middle_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_middle_action&&NeedContext$1.args.after_middle_action(t),NeedContext$1.args.middle_action_remove?NeedContext$1.remove_item(e):NeedContext$1.hide(t),e.middle_action(t))},NeedContext$1.context_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_context_action&&NeedContext$1.args.after_context_action(t),NeedContext$1.hide(t),e.context_action(t))},NeedContext$1.remove_item=e=>{NeedContext$1.select_next("down",!0),e.removed=!0,e.element.remove(),NeedContext$1.update_title()},NeedContext$1.update_title=()=>{let e=document.querySelector("#needcontext-title");if(!e)return;let t=e.querySelector(".needcontext-title-number");if(!t)return;let o=NeedContext$1.count_items();t.textContent=`(${o})`},NeedContext$1.count_items=()=>{let e=NeedContext$1.get_layer().normal_items;return e=e.filter(t=>!t.removed),e=e.filter(t=>!t.fake),e.length},NeedContext$1.create_debouncer=(e,t)=>{let o,u={};function p(){clearTimeout(o),o=void 0}function f(...b){e(...b)}return u.call=(...b)=>{p(),o=setTimeout(()=>{f(...b)},t)},u.call_2=(...b)=>{o||u.call(b)},u.now=(...b)=>{p(),f(...b)},u.cancel=()=>{p()},u},NeedContext$1.reset_debouncers=()=>{NeedContext$1.autohide_debouncer.cancel(),NeedContext$1.autoclick_debouncer.cancel()},NeedContext$1.check_auto_funcs=e=>{if(!NeedContext$1.open||!e.target)return;let t=e.target.id==="needcontext-main";if(t||NeedContext$1.reset_debouncers(),NeedContext$1.args.autohide&&t&&NeedContext$1.autohide_enabled&&NeedContext$1.autohide_debouncer.call_2(e),NeedContext$1.args.autoclick){let o=e.target.closest(".needcontext-item");o||(o=e.target.closest(".needcontext-back")),o&&NeedContext$1.autoclick_debouncer.call(o,e)}},NeedContext$1.check_mouse_range=e=>{if(NeedContext$1.autohide_enabled||e.target.id!=="needcontext-main")return;let t=e.clientX,o=e.clientY;if(NeedContext$1.mouse_activity.initial_x===void 0){NeedContext$1.mouse_activity.initial_x=t,NeedContext$1.mouse_activity.initial_y=o;return}let u=NeedContext$1.container.getBoundingClientRect();function p(f){let b=f>NeedContext$1.autohide_threshold;return b&&(NeedContext$1.autohide_enabled=!0),b}if(o<u.top&&o<NeedContext$1.mouse_activity.initial_y&&o<u.top){let f=u.top-o;if(p(f))return}if(o>u.bottom&&o>NeedContext$1.mouse_activity.initial_y&&o>u.bottom){let f=o-u.bottom;if(p(f))return}if(t<u.left&&t<NeedContext$1.mouse_activity.initial_x&&t<u.left){let f=u.left-t;if(p(f))return}if(t>u.right&&t>NeedContext$1.mouse_activity.initial_x&&t>u.right){let f=t-u.right;if(p(f))return}},NeedContext$1.start_autohide=e=>{NeedContext$1.autohide_debouncer=NeedContext$1.create_debouncer(t=>{NeedContext$1.hide(t)},e||NeedContext$1.autohide_delay)},NeedContext$1.start_autoclick=e=>{NeedContext$1.autoclick_debouncer=NeedContext$1.create_debouncer((t,o)=>{t.closest(".needcontext-item")?NeedContext$1.select_action(o):t.closest(".needcontext-back")&&NeedContext$1.go_back()},e||NeedContext$1.autoclick_delay)},typeof window<"u"&&(window.NeedContext=NeedContext$1),(function(e,t){var o=t(e);typeof module<"u"&&"exports"in module?module.exports=o:typeof define=="function"&&define.amd?define([],function(){return o}):e.jdenticon=o})(typeof self<"u"?self:void 0,function(e){function t(Ae,Ce,ge){return parseInt(Ae.substr(Ce,ge),16)}function o(Ae){return Ae|=0,Ae<0?"00":Ae<16?"0"+Ae.toString(16):Ae<256?Ae.toString(16):"ff"}function u(Ae,Ce,ge){return ge=ge<0?ge+6:ge>6?ge-6:ge,o(255*(ge<1?Ae+(Ce-Ae)*ge:ge<3?Ce:ge<4?Ae+(Ce-Ae)*(4-ge):Ae))}function p(Ae){if(/^#[0-9a-f]{3,8}$/i.test(Ae)){var Ce,ge=Ae.length;if(ge<6){var Te=Ae[1],ze=Ae[2],Ne=Ae[3],De=Ae[4]||"";Ce="#"+Te+Te+ze+ze+Ne+Ne+De+De}return(ge==7||ge>8)&&(Ce=Ae),Ce}}function f(Ae){var Ce=t(Ae,7,2),ge;if(isNaN(Ce))ge=Ae;else{var Te=t(Ae,1,2),ze=t(Ae,3,2),Ne=t(Ae,5,2);ge="rgba("+Te+","+ze+","+Ne+","+(Ce/255).toFixed(2)+")"}return ge}function b(Ae,Ce,ge){var Te;if(Ce==0){var ze=o(ge*255);Te=ze+ze+ze}else{var Ne=ge<=.5?ge*(Ce+1):ge+Ce-ge*Ce,De=ge*2-Ne;Te=u(De,Ne,Ae*6+2)+u(De,Ne,Ae*6)+u(De,Ne,Ae*6-2)}return"#"+Te}function M(Ae,Ce,ge){var Te=[.55,.5,.5,.46,.6,.55,.55],ze=Te[Ae*6+.5|0];return ge=ge<.5?ge*ze*2:ze+(ge-.5)*(1-ze)*2,b(Ae,Ce,ge)}var F=e,S={G:"jdenticon_config",n:"config"},k={};function N(Ae){k=Ae}function $(Ae){return arguments.length&&(k[S.n]=Ae),k[S.n]}function R(Ae,Ce){var ge=typeof Ae=="object"&&Ae||k[S.n]||F[S.G]||{},Te=ge.lightness||{},ze=ge.saturation||{},Ne="color"in ze?ze.color:ze,De=ze.grayscale,Ie=ge.backColor,Ge=ge.padding;function He(Gt,zt){var Ue=Te[Gt];return Ue&&Ue.length>1||(Ue=zt),function(Dt){return Dt=Ue[0]+Dt*(Ue[1]-Ue[0]),Dt<0?0:Dt>1?1:Dt}}function it(Gt){var zt=ge.hues,Ue;return zt&&zt.length>0&&(Ue=zt[0|.999*Gt*zt.length]),typeof Ue=="number"?(Ue/360%1+1)%1:Gt}return{X:it,p:typeof Ne=="number"?Ne:.5,H:typeof De=="number"?De:0,q:He("color",[.4,.8]),I:He("grayscale",[.3,.9]),J:p(Ie),Y:typeof Ae=="number"?Ae:typeof Ge=="number"?Ge:Ce}}var U=1,V=2,z={t:"data-jdenticon-hash",o:"data-jdenticon-value"},K="["+z.t+"],["+z.o+"]",ie=typeof document<"u"&&document.querySelectorAll.bind(document);function he(Ae){if(Ae){var Ce=Ae.tagName;if(/^svg$/i.test(Ce))return U;if(/^canvas$/i.test(Ce)&&"getContext"in Ae)return V}}function se(Ae){if(typeof MutationObserver<"u"){var Ce=new MutationObserver(function(Te){for(var ze=0;ze<Te.length;ze++){for(var Ne=Te[ze],De=Ne.addedNodes,Ie=0;De&&Ie<De.length;Ie++){var Ge=De[Ie];if(Ge.nodeType==1)if(he(Ge))Ae(Ge);else for(var He=Ge.querySelectorAll(K),it=0;it<He.length;it++)Ae(He[it])}Ne.type=="attributes"&&he(Ne.target)&&Ae(Ne.target)}});Ce.observe(document.body,{childList:!0,attributes:!0,attributeFilter:[z.o,z.t,"width","height"],subtree:!0})}}function ee(Ae,Ce){this.x=Ae,this.y=Ce}function pe(Ae,Ce,ge,Te){this.u=Ae,this.v=Ce,this.K=ge,this.Z=Te}pe.prototype.L=function(Ce,ge,Te,ze){var Ne=this.u+this.K,De=this.v+this.K,Ie=this.Z;return Ie===1?new ee(Ne-ge-(ze||0),this.v+Ce):Ie===2?new ee(Ne-Ce-(Te||0),De-ge-(ze||0)):Ie===3?new ee(this.u+ge,De-Ce-(Te||0)):new ee(this.u+Ce,this.v+ge)};var _e=new pe(0,0,0,0);function ve(Ae){this.M=Ae,this.A=_e}var we=ve.prototype;we.g=function(Ce,ge){for(var Te=this,ze=ge?-2:2,Ne=[],De=ge?Ce.length-2:0;De<Ce.length&&De>=0;De+=ze)Ne.push(Te.A.L(Ce[De],Ce[De+1]));this.M.g(Ne)},we.h=function(Ce,ge,Te,ze){var Ne=this.A.L(Ce,ge,Te,Te);this.M.h(Ne,Te,ze)},we.i=function(Ce,ge,Te,ze,Ne){this.g([Ce,ge,Ce+Te,ge,Ce+Te,ge+ze,Ce,ge+ze],Ne)},we.j=function(Ce,ge,Te,ze,Ne,De){var Ie=[Ce+Te,ge,Ce+Te,ge+ze,Ce,ge+ze,Ce,ge];Ie.splice((Ne||0)%4*2,2),this.g(Ie,De)},we.N=function(Ce,ge,Te,ze,Ne){this.g([Ce+Te/2,ge,Ce+Te,ge+ze/2,Ce+Te/2,ge+ze,Ce,ge+ze/2],Ne)};function xe(Ae,Ce,ge,Te){Ae=Ae%14;var ze,Ne,De,Ie,Ge,He;Ae?Ae==1?(De=0|ge*.5,Ie=0|ge*.8,Ce.j(ge-De,0,De,Ie,2)):Ae==2?(De=0|ge/3,Ce.i(De,De,ge-De,ge-De)):Ae==3?(Ge=ge*.1,He=ge<6?1:ge<8?2:0|ge*.25,Ge=Ge>1?0|Ge:Ge>.5?1:Ge,Ce.i(He,He,ge-Ge-He,ge-Ge-He)):Ae==4?(Ne=0|ge*.15,De=0|ge*.5,Ce.h(ge-De-Ne,ge-De-Ne,De)):Ae==5?(Ge=ge*.1,He=Ge*4,He>3&&(He=0|He),Ce.i(0,0,ge,ge),Ce.g([He,He,ge-Ge,He,He+(ge-He-Ge)/2,ge-Ge],!0)):Ae==6?Ce.g([0,0,ge,0,ge,ge*.7,ge*.4,ge*.4,ge*.7,ge,0,ge]):Ae==7?Ce.j(ge/2,ge/2,ge/2,ge/2,3):Ae==8?(Ce.i(0,0,ge,ge/2),Ce.i(0,ge/2,ge/2,ge/2),Ce.j(ge/2,ge/2,ge/2,ge/2,1)):Ae==9?(Ge=ge*.14,He=ge<4?1:ge<6?2:0|ge*.35,Ge=ge<8?Ge:0|Ge,Ce.i(0,0,ge,ge),Ce.i(He,He,ge-He-Ge,ge-He-Ge,!0)):Ae==10?(Ge=ge*.12,He=Ge*3,Ce.i(0,0,ge,ge),Ce.h(He,He,ge-Ge-He,!0)):Ae==11?Ce.j(ge/2,ge/2,ge/2,ge/2,3):Ae==12?(Ne=ge*.25,Ce.i(0,0,ge,ge),Ce.N(Ne,Ne,ge-Ne,ge-Ne,!0)):!Te&&(Ne=ge*.4,De=ge*1.2,Ce.h(Ne,Ne,De)):(ze=ge*.42,Ce.g([0,0,ge,0,ge,ge-ze*2,ge-ze,ge,0,ge]))}function Oe(Ae,Ce,ge){Ae=Ae%4;var Te;Ae?Ae==1?Ce.j(0,ge/2,ge,ge/2,0):Ae==2?Ce.N(0,0,ge,ge):(Te=ge/6,Ce.h(Te,Te,ge-2*Te)):Ce.j(0,0,ge,ge,0)}function Pe(Ae,Ce){return Ae=Ce.X(Ae),[M(Ae,Ce.H,Ce.I(0)),M(Ae,Ce.p,Ce.q(.5)),M(Ae,Ce.H,Ce.I(1)),M(Ae,Ce.p,Ce.q(1)),M(Ae,Ce.p,Ce.q(0))]}function Le(Ae,Ce,ge){var Te=R(ge,.08);Te.J&&Ae.m(Te.J);var ze=Ae.k,Ne=.5+ze*Te.Y|0;ze-=Ne*2;var De=new ve(Ae),Ie=0|ze/4,Ge=0|Ne+ze/2-Ie*2,He=0|Ne+ze/2-Ie*2;function it(Bt,on,tt,Ct,Mt){var Zt=t(Ce,tt,1),nn=Ct?t(Ce,Ct,1):0;Ae.O(zt[Ue[Bt]]);for(var an=0;an<Mt.length;an++)De.A=new pe(Ge+Mt[an][0]*Ie,He+Mt[an][1]*Ie,Ie,nn++%4),on(Zt,De,Ie,an);Ae.P()}var Gt=t(Ce,-7)/268435455,zt=Pe(Gt,Te),Ue=[],Dt;function It(Bt){if(Bt.indexOf(Dt)>=0){for(var on=0;on<Bt.length;on++)if(Ue.indexOf(Bt[on])>=0)return!0}}for(var Qe=0;Qe<3;Qe++)Dt=t(Ce,8+Qe,1)%zt.length,(It([0,4])||It([2,3]))&&(Dt=1),Ue.push(Dt);it(0,Oe,2,3,[[1,0],[2,0],[2,3],[1,3],[0,1],[3,1],[3,2],[0,2]]),it(1,Oe,4,5,[[0,0],[3,0],[3,3],[0,3]]),it(2,xe,1,null,[[1,1],[2,1],[2,2],[1,2]]),Ae.finish()}function Xe(Ae){var Ce=40,ge=16,Te=0,ze=0,Ne=encodeURI(Ae)+"%80",De=[],Ie,Ge=[],He=1732584193,it=4023233417,Gt=~He,zt=~it,Ue=3285377520,Dt=[He,it,Gt,zt,Ue],It=0,Qe="";function Bt(on,tt){return on<<tt|on>>>32-tt}for(;Te<Ne.length;ze++)De[ze>>2]=De[ze>>2]|(Ne[Te]=="%"?parseInt(Ne.substring(Te+1,Te+=3),16):Ne.charCodeAt(Te++))<<(3-(ze&3))*8;for(Ie=((ze+7>>6)+1)*ge,De[Ie-1]=ze*8-8;It<Ie;It+=ge){for(Te=0;Te<80;Te++)ze=Bt(He,5)+Ue+(Te<20?(it&Gt^~it&zt)+1518500249:Te<40?(it^Gt^zt)+1859775393:Te<60?(it&Gt^it&zt^Gt&zt)+2400959708:(it^Gt^zt)+3395469782)+(Ge[Te]=Te<ge?De[It+Te]|0:Bt(Ge[Te-3]^Ge[Te-8]^Ge[Te-14]^Ge[Te-16],1)),Ue=zt,zt=Gt,Gt=Bt(it,30),it=He,He=ze;Dt[0]=He=Dt[0]+He|0,Dt[1]=it=Dt[1]+it|0,Dt[2]=Gt=Dt[2]+Gt|0,Dt[3]=zt=Dt[3]+zt|0,Dt[4]=Ue=Dt[4]+Ue|0}for(Te=0;Te<Ce;Te++)Qe+=(Dt[Te>>3]>>>(7-(Te&7))*4&15).toString(16);return Qe}function Ke(Ae){return/^[0-9a-f]{11,}$/i.test(Ae)&&Ae}function me(Ae){return Xe(Ae==null?"":""+Ae)}function ye(Ae,Ce){var ge=Ae.canvas,Te=ge.width,ze=ge.height;Ae.save(),Ce||(Ce=Math.min(Te,ze),Ae.translate((Te-Ce)/2|0,(ze-Ce)/2|0)),this.l=Ae,this.k=Ce,Ae.clearRect(0,0,Ce,Ce)}var Se=ye.prototype;Se.m=function(Ce){var ge=this.l,Te=this.k;ge.fillStyle=f(Ce),ge.fillRect(0,0,Te,Te)},Se.O=function(Ce){var ge=this.l;ge.fillStyle=f(Ce),ge.beginPath()},Se.P=function(){this.l.fill()},Se.g=function(Ce){var ge=this.l;ge.moveTo(Ce[0].x,Ce[0].y);for(var Te=1;Te<Ce.length;Te++)ge.lineTo(Ce[Te].x,Ce[Te].y);ge.closePath()},Se.h=function(Ce,ge,Te){var ze=this.l,Ne=ge/2;ze.moveTo(Ce.x+Ne,Ce.y+Ne),ze.arc(Ce.x+Ne,Ce.y+Ne,Ne,0,Math.PI*2,Te),ze.closePath()},Se.finish=function(){this.l.restore()};function qe(Ae,Ce,ge,Te){if(!Ae)throw new Error("No canvas specified.");Le(new ye(Ae,ge),Ke(Ce)||me(Ce),Te)}function st(Ae){return(Ae*10+.5|0)/10}function mt(){this.B=""}var Ee=mt.prototype;Ee.g=function(Ce){for(var ge="",Te=0;Te<Ce.length;Te++)ge+=(Te?"L":"M")+st(Ce[Te].x)+" "+st(Ce[Te].y);this.B+=ge+"Z"},Ee.h=function(Ce,ge,Te){var ze=Te?0:1,Ne=st(ge/2),De=st(ge),Ie="a"+Ne+","+Ne+" 0 1,"+ze+" ";this.B+="M"+st(Ce.x)+" "+st(Ce.y+ge/2)+Ie+De+",0"+Ie+-De+",0"};function rt(Ae){this.C,this.D={},this.R=Ae,this.k=Ae.k}var St=rt.prototype;St.m=function(Ce){var ge=/^(#......)(..)?/.exec(Ce),Te=ge[2]?t(ge[2],0)/255:1;this.R.m(ge[1],Te)},St.O=function(Ce){this.C=this.D[Ce]||(this.D[Ce]=new mt)},St.P=function(){},St.g=function(Ce){this.C.g(Ce)},St.h=function(Ce,ge,Te){this.C.h(Ce,ge,Te)},St.finish=function(){var Ce=this,ge=this.D;for(var Te in ge)ge.hasOwnProperty(Te)&&Ce.R.S(Te,ge[Te].B)};var pt={T:"http://www.w3.org/2000/svg",U:"width",V:"height"};function bt(Ae){this.k=Ae,this.F='<svg xmlns="'+pt.T+'" width="'+Ae+'" height="'+Ae+'" viewBox="0 0 '+Ae+" "+Ae+'">'}var yt=bt.prototype;yt.m=function(Ce,ge){ge&&(this.F+='<rect width="100%" height="100%" fill="'+Ce+'" opacity="'+ge.toFixed(2)+'"/>')},yt.S=function(Ce,ge){this.F+='<path fill="'+Ce+'" d="'+ge+'"/>'},yt.toString=function(){return this.F+"</svg>"};function At(Ae,Ce,ge){var Te=new bt(Ce);return Le(new rt(Te),Ke(Ae)||me(Ae),ge),Te.toString()}function Et(Ae,Ce){for(var ge=[],Te=arguments.length-2;Te-- >0;)ge[Te]=arguments[Te+2];for(var ze=document.createElementNS(pt.T,Ce),Ne=0;Ne+1<ge.length;Ne+=2)ze.setAttribute(ge[Ne],ge[Ne+1]);Ae.appendChild(ze)}function Kt(Ae){var Ce=this.k=Math.min(Number(Ae.getAttribute(pt.U))||100,Number(Ae.getAttribute(pt.V))||100);for(this.W=Ae;Ae.firstChild;)Ae.removeChild(Ae.firstChild);Ae.setAttribute("viewBox","0 0 "+Ce+" "+Ce),Ae.setAttribute("preserveAspectRatio","xMidYMid meet")}var jt=Kt.prototype;jt.m=function(Ce,ge){ge&&Et(this.W,"rect",pt.U,"100%",pt.V,"100%","fill",Ce,"opacity",ge)},jt.S=function(Ce,ge){Et(this.W,"path","fill",Ce,"d",ge)};function Nt(){ie&&_t(K)}function _t(Ae,Ce,ge){$t(Ae,Ce,ge,function(Te,ze){if(ze)return ze==U?new rt(new Kt(Te)):new ye(Te.getContext("2d"))})}function $t(Ae,Ce,ge,Te){if(typeof Ae=="string"){if(ie)for(var ze=ie(Ae),Ne=0;Ne<ze.length;Ne++)$t(ze[Ne],Ce,ge,Te);return}var De=Ke(Ce)||Ce!=null&&me(Ce)||Ke(Ae.getAttribute(z.t))||Ae.hasAttribute(z.o)&&me(Ae.getAttribute(z.o));if(De){var Ie=Te(Ae,he(Ae));Ie&&Le(Ie,De,ge)}}function sn(Ae,Ce){return this.each(function(ge,Te){_t(Te,Ae,Ce)}),this}var kt=Nt;N(kt),kt.configure=$,kt.drawIcon=qe,kt.toSvg=At,kt.update=_t,kt.updateCanvas=_t,kt.updateSvg=_t,kt.version="3.1.1",kt.bundle="browser-umd";var Ot=F.jQuery;Ot&&(Ot.fn.jdenticon=sn);function Wt(){var Ae=(kt[S.n]||F[S.G]||{}).replaceMode;Ae!="never"&&(Nt(),Ae=="observe"&&se(_t))}return typeof setTimeout=="function"&&setTimeout(Wt,0),kt}),(function(){let e=window.AudioContext||window.webkitAudioContext;function t(u,p=3,f=2){let b=u.sampleRate,M=b*p,F=u.createBuffer(2,M,b),S=F.getChannelData(0),k=F.getChannelData(1);for(let N=0;N<M;N++){let $=N/M,R=Math.pow(1-$,f);S[N]=(Math.random()*2-1)*R,k[N]=(Math.random()*2-1)*R}return F}class o extends e{constructor(...p){super(...p);let f=this;const b=!window.master_fx;console.log(b?"Intercepted MAIN AudioContext (Seamless Reverb + LFO Mode)":"Intercepted SECONDARY AudioContext");let M=f.createBiquadFilter();M.type="lowshelf",M.frequency.value=320,M.gain.value=0;let F=f.createBiquadFilter();F.type="peaking",F.frequency.value=1e3,F.Q.value=1,F.gain.value=0;let S=f.createBiquadFilter();S.type="highshelf",S.frequency.value=4e3,S.gain.value=0,App.panning=f.createStereoPanner(),App.panning.pan.value=0;let k=f.createOscillator();k.type="sine",k.frequency.value=0;let N=f.createGain();N.gain.value=0,k.connect(N),N.connect(App.panning.pan),k.start();let $=f.createConvolver();$.buffer=t(f);let R=f.createGain();R.gain.value=0;let U=f.createGain();if(U.gain.value=1,M.connect(F),F.connect(S),S.connect(App.panning),App.panning.connect(U),U.connect(super.destination),Object.defineProperty(M,"maxChannelCount",{get:()=>super.destination.maxChannelCount}),Object.defineProperty(f,"destination",{get:()=>M,configurable:!0}),b){let V={timer:null,is_connected:!1};window.master_fx={context:f,nodes:{eq_low:M,eq_mid:F,eq_high:S,panner:App.panning,reverb_gain:R,master_gain:U,lfo:k,lfo_gain:N},set_eq:(z,K,ie)=>{let he=f.currentTime,se=.1;z!==void 0&&M.gain.setTargetAtTime(z,he,se),K!==void 0&&F.gain.setTargetAtTime(K,he,se),ie!==void 0&&S.gain.setTargetAtTime(ie,he,se)},set_volume:z=>{U.gain.setTargetAtTime(z,f.currentTime,.1)},set_panning:z=>{App.panning.pan.setTargetAtTime(z,f.currentTime+.02,.1)},set_auto_pan:(z,K)=>{let ie=f.currentTime;k.frequency.setTargetAtTime(z,ie,.1),N.gain.setTargetAtTime(K,ie,.1)},splash_reverb:(z=3)=>{let K=f.currentTime,ie=.1,he=.5,se=.5;V.timer&&(clearTimeout(V.timer),V.timer=null),R.gain.cancelScheduledValues(K),V.is_connected||(App.panning.connect($),$.connect(R),R.connect(U),R.gain.setValueAtTime(0,K),V.is_connected=!0),R.gain.linearRampToValueAtTime(se,K+ie);let ee=K+z;R.gain.setValueAtTime(se,ee),R.gain.linearRampToValueAtTime(0,ee+he),V.timer=setTimeout(()=>{R.disconnect(),$.disconnect(),V.is_connected=!1},(z+he)*1e3+100)}}}}}window.AudioContext=o,window.webkitAudioContext&&(window.webkitAudioContext=o)})(),typeof globalThis.process>"u"&&(globalThis.process={env:{}}),typeof globalThis.process.env>"u"&&(globalThis.process.env={}),typeof globalThis.process.env.NODE_ENV>"u"&&(globalThis.process.env.NODE_ENV="production");function peg$subclass(e,t){function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o}function peg$SyntaxError(e,t,o,u){var p=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(p,peg$SyntaxError.prototype),p.expected=t,p.found=o,p.location=u,p.name="SyntaxError",p}peg$subclass(peg$SyntaxError,Error);function peg$padEnd(e,t,o){return o=o||" ",e.length>t?e:(t-=e.length,o+=o.repeat(t),e+o.slice(0,t))}peg$SyntaxError.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var o=null,u;for(u=0;u<e.length;u++)if(e[u].source===this.location.source){o=e[u].text.split(/\r\n|\n|\r/g);break}var p=this.location.start,f=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(p):p,b=this.location.source+":"+f.line+":"+f.column;if(o){var M=this.location.end,F=peg$padEnd("",f.line.toString().length," "),S=o[p.line-1],k=p.line===M.line?M.column:S.length+1,N=k-p.column||1;t+=`
 --> `+b+`
`+F+` |
`+f.line+" | "+S+`
`+F+" | "+peg$padEnd("",p.column-1," ")+peg$padEnd("",N,"^")}else t+=`
 at `+b}return t},peg$SyntaxError.buildMessage=function(e,t){var o={literal:function(S){return'"'+p(S.text)+'"'},class:function(S){var k=S.parts.map(function(N){return Array.isArray(N)?f(N[0])+"-"+f(N[1]):f(N)});return"["+(S.inverted?"^":"")+k.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};function u(S){return S.charCodeAt(0).toString(16).toUpperCase()}function p(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(k){return"\\x0"+u(k)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(k){return"\\x"+u(k)})}function f(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(k){return"\\x0"+u(k)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(k){return"\\x"+u(k)})}function b(S){return o[S.type](S)}function M(S){var k=S.map(b),N,$;if(k.sort(),k.length>0){for(N=1,$=1;N<k.length;N++)k[N-1]!==k[N]&&(k[$]=k[N],$++);k.length=$}switch(k.length){case 1:return k[0];case 2:return k[0]+" or "+k[1];default:return k.slice(0,-1).join(", ")+", or "+k[k.length-1]}}function F(S){return S?'"'+p(S)+'"':"end of input"}return"Expected "+M(e)+" but "+F(t)+" found."};function peg$parse(e,t){t=t!==void 0?t:{};var o={},u=t.grammarSource,p={start:Ti},f=Ti,b=".",M="-",F="0",S=",",k="|",N="[",$="]",R="{",U="}",V="%",z="<",K=">",ie="!",he="(",se=")",ee="/",pe="*",_e="?",ve=":",we="..",xe="^",Oe="struct",Pe="target",Le="euclid",Xe="slow",Ke="rotL",me="rotR",ye="fast",Se="scale",qe="//",st="cat",mt="$",Ee="setcps",rt="setbpm",St="hush",pt=/^[1-9]/,bt=/^[eE]/,yt=/^[+\-]/,At=/^[0-9]/,Et=/^[ \n\r\t\xA0]/,Kt=/^["']/,jt=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Nt=/^[@_]/,_t=/^[^\n]/,$t=Kr("number"),sn=Rt(".",!1),kt=Xn([["1","9"]],!1,!1),Ot=Xn(["e","E"],!1,!1),Wt=Xn(["+","-"],!1,!1),Ae=Rt("-",!1),Ce=Rt("0",!1),ge=Xn([["0","9"]],!1,!1),Te=Kr("whitespace"),ze=Xn([" ",`
`,"\r","	"," "],!1,!1),Ne=Rt(",",!1),De=Rt("|",!1),Ie=Xn(['"',"'"],!1,!1),Ge=Kr('a letter, a number, "-", "#", ".", "^", "_"'),He=Xn(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),it=Rt("[",!1),Gt=Rt("]",!1),zt=Rt("{",!1),Ue=Rt("}",!1),Dt=Rt("%",!1),It=Rt("<",!1),Qe=Rt(">",!1),Bt=Xn(["@","_"],!1,!1),on=Rt("!",!1),tt=Rt("(",!1),Ct=Rt(")",!1),Mt=Rt("/",!1),Zt=Rt("*",!1),nn=Rt("?",!1),an=Rt(":",!1),An=Rt("..",!1),B=Rt("^",!1),te=Rt("struct",!1),q=Rt("target",!1),re=Rt("euclid",!1),ue=Rt("slow",!1),ke=Rt("rotL",!1),Be=Rt("rotR",!1),Ve=Rt("fast",!1),nt=Rt("scale",!1),Lt=Rt("//",!1),Jt=Xn([`
`],!0,!1),Rn=Rt("cat",!1),Sn=Rt("$",!1),zr=Rt("setcps",!1),Hr=Rt("setbpm",!1),yn=Rt("hush",!1),Ai=function(){return parseFloat(io())},hr=function(I){const oe=I.join("");return oe==="."||oe==="_"},eo=function(I){return new ks(I.join(""))},er=function(I){return I},Ci=function(I,oe){return I.arguments_.stepsPerCycle=oe,I},is=function(I){return I},en=function(I){return I.arguments_.alignment="polymeter_slowcat",I},ot=function(I){return oe=>oe.options_.weight=(oe.options_.weight??1)+(I??2)-1},nr=function(I){return oe=>{const de=(oe.options_.reps??1)+(I??2)-1;oe.options_.reps=de,oe.options_.ops=oe.options_.ops.filter(Re=>Re.type_!=="replicate"),oe.options_.ops.push({type_:"replicate",arguments_:{amount:de}}),oe.options_.weight=de}},Mi=function(I,oe,de){return Re=>Re.options_.ops.push({type_:"bjorklund",arguments_:{pulse:I,step:oe,rotation:de}})},On=function(I){return oe=>oe.options_.ops.push({type_:"stretch",arguments_:{amount:I,type:"slow"}})},Xt=function(I){return oe=>oe.options_.ops.push({type_:"stretch",arguments_:{amount:I,type:"fast"}})},rr=function(I){return oe=>oe.options_.ops.push({type_:"degradeBy",arguments_:{amount:I,seed:ii++}})},kr=function(I){return oe=>oe.options_.ops.push({type_:"tail",arguments_:{element:I}})},xi=function(I){return oe=>oe.options_.ops.push({type_:"range",arguments_:{element:I}})},We=function(I,oe){const de=new zn(I,{ops:[],weight:1,reps:1});for(const Re of oe)Re(de);return de},xt=function(I,oe){return new Ar(oe,"fastcat",void 0,!!I)},Pi=function(I){return{alignment:"stack",list:I}},Si=function(I){return{alignment:"rand",list:I,seed:ii++}},Ur=function(I){return{alignment:"feet",list:I,seed:ii++}},jr=function(I,oe){return oe&&oe.list.length>0?new Ar([I,...oe.list],oe.alignment,oe.seed):I},ss=function(I,oe){return new Ar(oe?[I,...oe.list]:[I],"polymeter")},Pt=function(I){return I},to=function(I){return{name:"struct",args:{mini:I}}},os=function(I){return{name:"target",args:{name:I}}},Yr=function(I,oe,de){return{name:"bjorklund",args:{pulse:I,step:parseInt(oe)}}},Wn=function(I){return{name:"stretch",args:{amount:I}}},us=function(I){return{name:"shift",args:{amount:"-"+I}}},ls=function(I){return{name:"shift",args:{amount:I}}},Tr=function(I){return{name:"stretch",args:{amount:"1/"+I}}},wi=function(I){return{name:"scale",args:{scale:I.join("")}}},Di=function(I,oe){return oe},Fi=function(I,oe){return oe.unshift(I),new Ar(oe,"slowcat")},cs=function(I){return I},ps=function(I,oe){return new Cr(I.name,I.args,oe)},fs=function(I){return I},hs=function(I){return I},no=function(I){return new ri("setcps",{value:I})},ro=function(I){return new ri("setcps",{value:I/120/2})},ms=function(){return new ri("hush")},le=t.peg$currPos|0,Ft=le,mr=[{line:1,column:1}],Cn=le,Kn=t.peg$maxFailExpected||[],at=t.peg$silentFails|0,Nr;if(t.startRule){if(!(t.startRule in p))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');f=p[t.startRule]}function io(){return e.substring(Ft,le)}function gs(){return gr(Ft,le)}function Rt(I,oe){return{type:"literal",text:I,ignoreCase:oe}}function Xn(I,oe,de){return{type:"class",parts:I,inverted:oe,ignoreCase:de}}function so(){return{type:"end"}}function Kr(I){return{type:"other",description:I}}function Ei(I){var oe=mr[I],de;if(oe)return oe;if(I>=mr.length)de=mr.length-1;else for(de=I;!mr[--de];);for(oe=mr[de],oe={line:oe.line,column:oe.column};de<I;)e.charCodeAt(de)===10?(oe.line++,oe.column=1):oe.column++,de++;return mr[I]=oe,oe}function gr(I,oe,de){var Re=Ei(I),ut=Ei(oe),Ht={source:u,start:{offset:I,line:Re.line,column:Re.column},end:{offset:oe,line:ut.line,column:ut.column}};return Ht}function ft(I){le<Cn||(le>Cn&&(Cn=le,Kn=[]),Kn.push(I))}function ki(I,oe,de){return new peg$SyntaxError(peg$SyntaxError.buildMessage(I,oe),I,oe,de)}function Ti(){var I;return I=Co(),I}function Vn(){var I,oe;return at++,I=le,Ni(),oe=Jr(),oe!==o?(ao(),Bn(),Ft=I,I=Ai()):(le=I,I=o),at--,I===o&&at===0&&ft($t),I}function qr(){var I;return e.charCodeAt(le)===46?(I=b,le++):(I=o,at===0&&ft(sn)),I}function oo(){var I;return I=e.charAt(le),pt.test(I)?le++:(I=o,at===0&&ft(kt)),I}function _s(){var I;return I=e.charAt(le),bt.test(I)?le++:(I=o,at===0&&ft(Ot)),I}function Bn(){var I,oe,de,Re,ut;if(I=le,oe=_s(),oe!==o){if(de=e.charAt(le),yt.test(de)?le++:(de=o,at===0&&ft(Wt)),de===o&&(de=null),Re=[],ut=wn(),ut!==o)for(;ut!==o;)Re.push(ut),ut=wn();else Re=o;Re!==o?(oe=[oe,de,Re],I=oe):(le=I,I=o)}else le=I,I=o;return I}function ao(){var I,oe,de,Re;if(I=le,oe=qr(),oe!==o){if(de=[],Re=wn(),Re!==o)for(;Re!==o;)de.push(Re),Re=wn();else de=o;de!==o?(oe=[oe,de],I=oe):(le=I,I=o)}else le=I,I=o;return I}function Jr(){var I,oe,de,Re;if(I=ys(),I===o)if(I=le,oe=oo(),oe!==o){for(de=[],Re=wn();Re!==o;)de.push(Re),Re=wn();oe=[oe,de],I=oe}else le=I,I=o;return I}function Ni(){var I;return e.charCodeAt(le)===45?(I=M,le++):(I=o,at===0&&ft(Ae)),I}function ys(){var I;return e.charCodeAt(le)===48?(I=F,le++):(I=o,at===0&&ft(Ce)),I}function wn(){var I;return I=e.charAt(le),At.test(I)?le++:(I=o,at===0&&ft(ge)),I}function vt(){var I,oe;for(at++,I=[],oe=e.charAt(le),Et.test(oe)?le++:(oe=o,at===0&&ft(ze));oe!==o;)I.push(oe),oe=e.charAt(le),Et.test(oe)?le++:(oe=o,at===0&&ft(ze));return at--,oe=o,at===0&&ft(Te),I}function Mn(){var I,oe,de,Re;return I=le,oe=vt(),e.charCodeAt(le)===44?(de=S,le++):(de=o,at===0&&ft(Ne)),de!==o?(Re=vt(),oe=[oe,de,Re],I=oe):(le=I,I=o),I}function Lr(){var I,oe,de,Re;return I=le,oe=vt(),e.charCodeAt(le)===124?(de=k,le++):(de=o,at===0&&ft(De)),de!==o?(Re=vt(),oe=[oe,de,Re],I=oe):(le=I,I=o),I}function Qr(){var I,oe,de,Re;return I=le,oe=vt(),e.charCodeAt(le)===46?(de=b,le++):(de=o,at===0&&ft(sn)),de!==o?(Re=vt(),oe=[oe,de,Re],I=oe):(le=I,I=o),I}function $n(){var I;return I=e.charAt(le),Kt.test(I)?le++:(I=o,at===0&&ft(Ie)),I}function ei(){var I;return at++,I=e.charAt(le),jt.test(I)?le++:(I=o,at===0&&ft(He)),at--,I===o&&at===0&&ft(Ge),I}function vs(){var I,oe,de,Re;if(I=le,vt(),oe=[],de=ei(),de!==o)for(;de!==o;)oe.push(de),de=ei();else oe=o;return oe!==o?(de=vt(),Ft=le,Re=hr(oe),Re?Re=o:Re=void 0,Re!==o?(Ft=I,I=eo(oe)):(le=I,I=o)):(le=I,I=o),I}function uo(){var I,oe,de,Re;return I=le,vt(),e.charCodeAt(le)===91?(oe=N,le++):(oe=o,at===0&&ft(it)),oe!==o?(vt(),de=Li(),de!==o?(vt(),e.charCodeAt(le)===93?(Re=$,le++):(Re=o,at===0&&ft(Gt)),Re!==o?(vt(),Ft=I,I=er(de)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function lo(){var I,oe,de,Re,ut;return I=le,vt(),e.charCodeAt(le)===123?(oe=R,le++):(oe=o,at===0&&ft(zt)),oe!==o?(vt(),de=br(),de!==o?(vt(),e.charCodeAt(le)===125?(Re=U,le++):(Re=o,at===0&&ft(Ue)),Re!==o?(ut=bs(),ut===o&&(ut=null),vt(),Ft=I,I=Ci(de,ut)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function bs(){var I,oe,de;return I=le,e.charCodeAt(le)===37?(oe=V,le++):(oe=o,at===0&&ft(Dt)),oe!==o?(de=_r(),de!==o?(Ft=I,I=is(de)):(le=I,I=o)):(le=I,I=o),I}function As(){var I,oe,de,Re;return I=le,vt(),e.charCodeAt(le)===60?(oe=z,le++):(oe=o,at===0&&ft(It)),oe!==o?(vt(),de=br(),de!==o?(vt(),e.charCodeAt(le)===62?(Re=K,le++):(Re=o,at===0&&ft(Qe)),Re!==o?(vt(),Ft=I,I=en(de)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function _r(){var I;return I=vs(),I===o&&(I=uo(),I===o&&(I=lo(),I===o&&(I=As()))),I}function Cs(){var I;return I=co(),I===o&&(I=Ms(),I===o&&(I=fo(),I===o&&(I=xs(),I===o&&(I=po(),I===o&&(I=ti(),I===o&&(I=yr(),I===o&&(I=ho()))))))),I}function co(){var I,oe,de;return I=le,vt(),oe=e.charAt(le),Nt.test(oe)?le++:(oe=o,at===0&&ft(Bt)),oe!==o?(de=Vn(),de===o&&(de=null),Ft=I,I=ot(de)):(le=I,I=o),I}function po(){var I,oe,de;return I=le,vt(),e.charCodeAt(le)===33?(oe=ie,le++):(oe=o,at===0&&ft(on)),oe!==o?(de=Vn(),de===o&&(de=null),Ft=I,I=nr(de)):(le=I,I=o),I}function Ms(){var I,oe,de,Re,ut,Ht,Nn;return I=le,e.charCodeAt(le)===40?(oe=he,le++):(oe=o,at===0&&ft(tt)),oe!==o?(vt(),de=Gr(),de!==o?(vt(),Re=Mn(),Re!==o?(vt(),ut=Gr(),ut!==o?(vt(),Mn(),vt(),Ht=Gr(),Ht===o&&(Ht=null),vt(),e.charCodeAt(le)===41?(Nn=se,le++):(Nn=o,at===0&&ft(Ct)),Nn!==o?(Ft=I,I=Mi(de,ut,Ht)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function fo(){var I,oe,de;return I=le,e.charCodeAt(le)===47?(oe=ee,le++):(oe=o,at===0&&ft(Mt)),oe!==o?(de=_r(),de!==o?(Ft=I,I=On(de)):(le=I,I=o)):(le=I,I=o),I}function xs(){var I,oe,de;return I=le,e.charCodeAt(le)===42?(oe=pe,le++):(oe=o,at===0&&ft(Zt)),oe!==o?(de=_r(),de!==o?(Ft=I,I=Xt(de)):(le=I,I=o)):(le=I,I=o),I}function ti(){var I,oe,de;return I=le,e.charCodeAt(le)===63?(oe=_e,le++):(oe=o,at===0&&ft(nn)),oe!==o?(de=Vn(),de===o&&(de=null),Ft=I,I=rr(de)):(le=I,I=o),I}function yr(){var I,oe,de;return I=le,e.charCodeAt(le)===58?(oe=ve,le++):(oe=o,at===0&&ft(an)),oe!==o?(de=_r(),de!==o?(Ft=I,I=kr(de)):(le=I,I=o)):(le=I,I=o),I}function ho(){var I,oe,de;return I=le,e.substr(le,2)===we?(oe=we,le+=2):(oe=o,at===0&&ft(An)),oe!==o?(de=_r(),de!==o?(Ft=I,I=xi(de)):(le=I,I=o)):(le=I,I=o),I}function Gr(){var I,oe,de,Re;if(I=le,oe=_r(),oe!==o){for(de=[],Re=Cs();Re!==o;)de.push(Re),Re=Cs();Ft=I,I=We(oe,de)}else le=I,I=o;return I}function qn(){var I,oe,de,Re;if(I=le,e.charCodeAt(le)===94?(oe=xe,le++):(oe=o,at===0&&ft(B)),oe===o&&(oe=null),de=[],Re=Gr(),Re!==o)for(;Re!==o;)de.push(Re),Re=Gr();else de=o;return de!==o?(Ft=I,I=xt(oe,de)):(le=I,I=o),I}function vr(){var I,oe,de,Re,ut;if(I=le,oe=[],de=le,Re=Mn(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o),de!==o)for(;de!==o;)oe.push(de),de=le,Re=Mn(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o);else oe=o;return oe!==o&&(Ft=I,oe=Pi(oe)),I=oe,I}function un(){var I,oe,de,Re,ut;if(I=le,oe=[],de=le,Re=Lr(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o),de!==o)for(;de!==o;)oe.push(de),de=le,Re=Lr(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o);else oe=o;return oe!==o&&(Ft=I,oe=Si(oe)),I=oe,I}function mo(){var I,oe,de,Re,ut;if(I=le,oe=[],de=le,Re=Qr(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o),de!==o)for(;de!==o;)oe.push(de),de=le,Re=Qr(),Re!==o?(ut=qn(),ut!==o?de=ut:(le=de,de=o)):(le=de,de=o);else oe=o;return oe!==o&&(Ft=I,oe=Ur(oe)),I=oe,I}function Li(){var I,oe,de;return I=le,oe=qn(),oe!==o?(de=vr(),de===o&&(de=un(),de===o&&(de=mo())),de===o&&(de=null),Ft=I,I=jr(oe,de)):(le=I,I=o),I}function br(){var I,oe,de;return I=le,oe=qn(),oe!==o?(de=vr(),de===o&&(de=null),Ft=I,I=ss(oe,de)):(le=I,I=o),I}function go(){var I,oe,de,Re;return I=le,vt(),oe=$n(),oe!==o?(vt(),de=Li(),de!==o?(vt(),Re=$n(),Re!==o?(Ft=I,I=Pt(de)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function Ps(){var I;return I=bo(),I===o&&(I=yo(),I===o&&(I=Ds(),I===o&&(I=Gi(),I===o&&(I=Ss(),I===o&&(I=_o(),I===o&&(I=ws(),I===o&&(I=vo()))))))),I}function _o(){var I,oe,de;return I=le,e.substr(le,6)===Oe?(oe=Oe,le+=6):(oe=o,at===0&&ft(te)),oe!==o?(vt(),de=Jn(),de!==o?(Ft=I,I=to(de)):(le=I,I=o)):(le=I,I=o),I}function Gi(){var I,oe,de,Re,ut;return I=le,e.substr(le,6)===Pe?(oe=Pe,le+=6):(oe=o,at===0&&ft(q)),oe!==o?(vt(),de=$n(),de!==o?(Re=vs(),Re!==o?(ut=$n(),ut!==o?(Ft=I,I=os(Re)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function Ss(){var I,oe,de,Re;return I=le,e.substr(le,6)===Le?(oe=Le,le+=6):(oe=o,at===0&&ft(re)),oe!==o?(vt(),de=Jr(),de!==o?(vt(),Re=Jr(),Re!==o?(vt(),Jr(),Ft=I,I=Yr(de,Re)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o),I}function yo(){var I,oe,de;return I=le,e.substr(le,4)===Xe?(oe=Xe,le+=4):(oe=o,at===0&&ft(ue)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=Wn(de)):(le=I,I=o)):(le=I,I=o),I}function vo(){var I,oe,de;return I=le,e.substr(le,4)===Ke?(oe=Ke,le+=4):(oe=o,at===0&&ft(ke)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=us(de)):(le=I,I=o)):(le=I,I=o),I}function ws(){var I,oe,de;return I=le,e.substr(le,4)===me?(oe=me,le+=4):(oe=o,at===0&&ft(Be)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=ls(de)):(le=I,I=o)):(le=I,I=o),I}function Ds(){var I,oe,de;return I=le,e.substr(le,4)===ye?(oe=ye,le+=4):(oe=o,at===0&&ft(Ve)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=Tr(de)):(le=I,I=o)):(le=I,I=o),I}function bo(){var I,oe,de,Re,ut;if(I=le,e.substr(le,5)===Se?(oe=Se,le+=5):(oe=o,at===0&&ft(nt)),oe!==o)if(vt(),de=$n(),de!==o){if(Re=[],ut=ei(),ut!==o)for(;ut!==o;)Re.push(ut),ut=ei();else Re=o;Re!==o?(ut=$n(),ut!==o?(Ft=I,I=wi(Re)):(le=I,I=o)):(le=I,I=o)}else le=I,I=o;else le=I,I=o;return I}function sr(){var I,oe,de,Re;if(I=le,e.substr(le,2)===qe?(oe=qe,le+=2):(oe=o,at===0&&ft(Lt)),oe!==o){for(de=[],Re=e.charAt(le),_t.test(Re)?le++:(Re=o,at===0&&ft(Jt));Re!==o;)de.push(Re),Re=e.charAt(le),_t.test(Re)?le++:(Re=o,at===0&&ft(Jt));oe=[oe,de],I=oe}else le=I,I=o;return I}function Hn(){var I,oe,de,Re,ut,Ht,Nn,lr;if(I=le,e.substr(le,3)===st?(oe=st,le+=3):(oe=o,at===0&&ft(Rn)),oe!==o)if(vt(),e.charCodeAt(le)===91?(de=N,le++):(de=o,at===0&&ft(it)),de!==o)if(vt(),Re=Jn(),Re!==o){for(ut=[],Ht=le,Nn=Mn(),Nn!==o?(lr=Jn(),lr!==o?(Ft=Ht,Ht=Di(Re,lr)):(le=Ht,Ht=o)):(le=Ht,Ht=o);Ht!==o;)ut.push(Ht),Ht=le,Nn=Mn(),Nn!==o?(lr=Jn(),lr!==o?(Ft=Ht,Ht=Di(Re,lr)):(le=Ht,Ht=o)):(le=Ht,Ht=o);Ht=vt(),e.charCodeAt(le)===93?(Nn=$,le++):(Nn=o,at===0&&ft(Gt)),Nn!==o?(Ft=I,I=Fi(Re,ut)):(le=I,I=o)}else le=I,I=o;else le=I,I=o;else le=I,I=o;return I}function ni(){var I;return I=Hn(),I===o&&(I=go()),I}function Jn(){var I,oe,de,Re,ut;if(I=le,oe=ni(),oe!==o){for(vt(),de=[],Re=sr();Re!==o;)de.push(Re),Re=sr();Ft=I,I=cs(oe)}else le=I,I=o;return I===o&&(I=le,oe=Ps(),oe!==o?(vt(),e.charCodeAt(le)===36?(de=mt,le++):(de=o,at===0&&ft(Sn)),de!==o?(Re=vt(),ut=Jn(),ut!==o?(Ft=I,I=ps(oe,ut)):(le=I,I=o)):(le=I,I=o)):(le=I,I=o)),I}function Fs(){var I,oe;return I=le,oe=Jn(),oe!==o&&(Ft=I,oe=fs(oe)),I=oe,I===o&&(I=sr()),I}function Zn(){var I;return I=Fs(),I}function ur(){var I,oe;return I=le,vt(),oe=Ri(),oe===o&&(oe=Ao(),oe===o&&(oe=Es())),oe!==o?(vt(),Ft=I,I=hs(oe)):(le=I,I=o),I}function Ri(){var I,oe,de;return I=le,e.substr(le,6)===Ee?(oe=Ee,le+=6):(oe=o,at===0&&ft(zr)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=no(de)):(le=I,I=o)):(le=I,I=o),I}function Ao(){var I,oe,de;return I=le,e.substr(le,6)===rt?(oe=rt,le+=6):(oe=o,at===0&&ft(Hr)),oe!==o?(vt(),de=Vn(),de!==o?(Ft=I,I=ro(de)):(le=I,I=o)):(le=I,I=o),I}function Es(){var I,oe;return I=le,e.substr(le,4)===St?(oe=St,le+=4):(oe=o,at===0&&ft(yn)),oe!==o&&(Ft=I,oe=ms()),I=oe,I}function Co(){var I;return I=Zn(),I===o&&(I=ur()),I}var ks=function(I){this.type_="atom",this.source_=I,this.location_=gs()},Ar=function(I,oe,de,Re){this.type_="pattern",this.arguments_={alignment:oe,_steps:Re},de!==void 0&&(this.arguments_.seed=de),this.source_=I},Cr=function(I,oe,de){this.type_=I,this.arguments_=oe,this.source_=de},zn=function(I,oe){this.type_="element",this.source_=I,this.options_=oe,this.location_=gs()},ri=function(I,oe){this.type_="command",this.name_=I,this.options_=oe},ii=0;if(Nr=f(),t.peg$library)return{peg$result:Nr,peg$currPos:le,peg$FAILED:o,peg$maxFailExpected:Kn,peg$maxFailPos:Cn};if(Nr!==o&&le===e.length)return Nr;throw Nr!==o&&le<e.length&&ft(so()),ki(Kn,Cn<e.length?e.charAt(Cn):null,Cn<e.length?gr(Cn,Cn+1):gr(Cn,Cn))}const peg$allowedStartRules=["start"];typeof BigInt>"u"&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const C_ZERO=BigInt(0),C_ONE=BigInt(1),C_TWO=BigInt(2),C_FIVE=BigInt(5),C_TEN=BigInt(10),MAX_CYCLE_LEN=2e3,P={s:C_ONE,n:C_ZERO,d:C_ONE};function assign(e,t){try{e=BigInt(e)}catch{throw InvalidParameter()}return e*t}function trunc(e){return typeof e=="bigint"?e:Math.floor(e)}function newFraction(e,t){if(t===C_ZERO)throw DivisionByZero();const o=Object.create(Fraction$1.prototype);o.s=e<C_ZERO?-C_ONE:C_ONE,e=e<C_ZERO?-e:e;const u=gcd$1(e,t);return o.n=e/u,o.d=t/u,o}function factorize(e){const t={};let o=e,u=C_TWO,p=C_FIVE-C_ONE;for(;p<=o;){for(;o%u===C_ZERO;)o/=u,t[u]=(t[u]||C_ZERO)+C_ONE;p+=C_ONE+C_TWO*u++}return o!==e?o>1&&(t[o]=(t[o]||C_ZERO)+C_ONE):t[e]=(t[e]||C_ZERO)+C_ONE,t}const parse$b=function(e,t){let o=C_ZERO,u=C_ONE,p=C_ONE;if(e!=null)if(t!==void 0){if(typeof e=="bigint")o=e;else{if(isNaN(e))throw InvalidParameter();if(e%1!==0)throw NonIntegerParameter();o=BigInt(e)}if(typeof t=="bigint")u=t;else{if(isNaN(t))throw InvalidParameter();if(t%1!==0)throw NonIntegerParameter();u=BigInt(t)}p=o*u}else if(typeof e=="object"){if("d"in e&&"n"in e)o=BigInt(e.n),u=BigInt(e.d),"s"in e&&(o*=BigInt(e.s));else if(0 in e)o=BigInt(e[0]),1 in e&&(u=BigInt(e[1]));else if(typeof e=="bigint")o=e;else throw InvalidParameter();p=o*u}else if(typeof e=="number"){if(isNaN(e))throw InvalidParameter();if(e<0&&(p=-C_ONE,e=-e),e%1===0)o=BigInt(e);else if(e>0){let f=1,b=0,M=1,F=1,S=1,k=1e7;for(e>=1&&(f=10**Math.floor(1+Math.log10(e)),e/=f);M<=k&&S<=k;){let N=(b+F)/(M+S);if(e===N){M+S<=k?(o=b+F,u=M+S):S>M?(o=F,u=S):(o=b,u=M);break}else e>N?(b+=F,M+=S):(F+=b,S+=M),M>k?(o=F,u=S):(o=b,u=M)}o=BigInt(o)*BigInt(f),u=BigInt(u)}}else if(typeof e=="string"){let f=0,b=C_ZERO,M=C_ZERO,F=C_ZERO,S=C_ONE,k=C_ONE,N=e.replace(/_/g,"").match(/\d+|./g);if(N===null)throw InvalidParameter();if(N[f]==="-"?(p=-C_ONE,f++):N[f]==="+"&&f++,N.length===f+1?M=assign(N[f++],p):N[f+1]==="."||N[f]==="."?(N[f]!=="."&&(b=assign(N[f++],p)),f++,(f+1===N.length||N[f+1]==="("&&N[f+3]===")"||N[f+1]==="'"&&N[f+3]==="'")&&(M=assign(N[f],p),S=C_TEN**BigInt(N[f].length),f++),(N[f]==="("&&N[f+2]===")"||N[f]==="'"&&N[f+2]==="'")&&(F=assign(N[f+1],p),k=C_TEN**BigInt(N[f+1].length)-C_ONE,f+=3)):N[f+1]==="/"||N[f+1]===":"?(M=assign(N[f],p),S=assign(N[f+2],C_ONE),f+=3):N[f+3]==="/"&&N[f+1]===" "&&(b=assign(N[f],p),M=assign(N[f+2],p),S=assign(N[f+4],C_ONE),f+=5),N.length<=f)u=S*k,p=o=F+u*b+k*M;else throw InvalidParameter()}else if(typeof e=="bigint")o=e,p=e,u=C_ONE;else throw InvalidParameter();if(u===C_ZERO)throw DivisionByZero();P.s=p<C_ZERO?-C_ONE:C_ONE,P.n=o<C_ZERO?-o:o,P.d=u<C_ZERO?-u:u};function modpow(e,t,o){let u=C_ONE;for(;t>C_ZERO;e=e*e%o,t>>=C_ONE)t&C_ONE&&(u=u*e%o);return u}function cycleLen(e,t){for(;t%C_TWO===C_ZERO;t/=C_TWO);for(;t%C_FIVE===C_ZERO;t/=C_FIVE);if(t===C_ONE)return C_ZERO;let o=C_TEN%t,u=1;for(;o!==C_ONE;u++)if(o=o*C_TEN%t,u>MAX_CYCLE_LEN)return C_ZERO;return BigInt(u)}function cycleStart(e,t,o){let u=C_ONE,p=modpow(C_TEN,o,t);for(let f=0;f<300;f++){if(u===p)return BigInt(f);u=u*C_TEN%t,p=p*C_TEN%t}return 0}function gcd$1(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function Fraction$1(e,t){if(parse$b(e,t),this instanceof Fraction$1)e=gcd$1(P.d,P.n),this.s=P.s,this.n=P.n/e,this.d=P.d/e;else return newFraction(P.s*P.n,P.d)}var DivisionByZero=function(){return new Error("Division by Zero")},InvalidParameter=function(){return new Error("Invalid argument")},NonIntegerParameter=function(){return new Error("Parameters must be integer")};Fraction$1.prototype={s:C_ONE,n:C_ZERO,d:C_ONE,abs:function(){return newFraction(this.n,this.d)},neg:function(){return newFraction(-this.s*this.n,this.d)},add:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d+P.s*this.d*P.n,this.d*P.d)},sub:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d-P.s*this.d*P.n,this.d*P.d)},mul:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.n,this.d*P.d)},div:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.d,this.d*P.n)},clone:function(){return newFraction(this.s*this.n,this.d)},mod:function(e,t){if(e===void 0)return newFraction(this.s*this.n%this.d,C_ONE);if(parse$b(e,t),C_ZERO===P.n*this.d)throw DivisionByZero();return newFraction(this.s*(P.d*this.n)%(P.n*this.d),P.d*this.d)},gcd:function(e,t){return parse$b(e,t),newFraction(gcd$1(P.n,this.n)*gcd$1(P.d,this.d),P.d*this.d)},lcm:function(e,t){return parse$b(e,t),P.n===C_ZERO&&this.n===C_ZERO?newFraction(C_ZERO,C_ONE):newFraction(P.n*this.n,gcd$1(P.n,this.n)*gcd$1(P.d,this.d))},inverse:function(){return newFraction(this.s*this.d,this.n)},pow:function(e,t){if(parse$b(e,t),P.d===C_ONE)return P.s<C_ZERO?newFraction((this.s*this.d)**P.n,this.n**P.n):newFraction((this.s*this.n)**P.n,this.d**P.n);if(this.s<C_ZERO)return null;let o=factorize(this.n),u=factorize(this.d),p=C_ONE,f=C_ONE;for(let b in o)if(b!=="1"){if(b==="0"){p=C_ZERO;break}if(o[b]*=P.n,o[b]%P.d===C_ZERO)o[b]/=P.d;else return null;p*=BigInt(b)**o[b]}for(let b in u)if(b!=="1"){if(u[b]*=P.n,u[b]%P.d===C_ZERO)u[b]/=P.d;else return null;f*=BigInt(b)**u[b]}return P.s<C_ZERO?newFraction(f,p):newFraction(p,f)},log:function(e,t){if(parse$b(e,t),this.s<=C_ZERO||P.s<=C_ZERO)return null;const o={},u=factorize(P.n),p=factorize(P.d),f=factorize(this.n),b=factorize(this.d);for(const S in p)u[S]=(u[S]||C_ZERO)-p[S];for(const S in b)f[S]=(f[S]||C_ZERO)-b[S];for(const S in u)S!=="1"&&(o[S]=!0);for(const S in f)S!=="1"&&(o[S]=!0);let M=null,F=null;for(const S in o){const k=u[S]||C_ZERO,N=f[S]||C_ZERO;if(k===C_ZERO){if(N!==C_ZERO)return null;continue}let $=N,R=k;const U=gcd$1($,R);if($/=U,R/=U,M===null&&F===null)M=$,F=R;else if($*F!==M*R)return null}return M!==null&&F!==null?newFraction(M,F):null},equals:function(e,t){return parse$b(e,t),this.s*this.n*P.d===P.s*P.n*this.d},lt:function(e,t){return parse$b(e,t),this.s*this.n*P.d<P.s*P.n*this.d},lte:function(e,t){return parse$b(e,t),this.s*this.n*P.d<=P.s*P.n*this.d},gt:function(e,t){return parse$b(e,t),this.s*this.n*P.d>P.s*P.n*this.d},gte:function(e,t){return parse$b(e,t),this.s*this.n*P.d>=P.s*P.n*this.d},compare:function(e,t){parse$b(e,t);let o=this.s*this.n*P.d-P.s*P.n*this.d;return(C_ZERO<o)-(o<C_ZERO)},ceil:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+(e*this.n%this.d>C_ZERO&&this.s>=C_ZERO?C_ONE:C_ZERO),e)},floor:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)-(e*this.n%this.d>C_ZERO&&this.s<C_ZERO?C_ONE:C_ZERO),e)},round:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+this.s*((this.s>=C_ZERO?C_ONE:C_ZERO)+C_TWO*(e*this.n%this.d)>this.d?C_ONE:C_ZERO),e)},roundTo:function(e,t){parse$b(e,t);const o=this.n*P.d,u=this.d*P.n,p=o%u;let f=trunc(o/u);return p+p>=u&&f++,newFraction(this.s*f*P.n,P.d)},divisible:function(e,t){return parse$b(e,t),!(!(P.n*this.d)||this.n*P.d%(P.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,o=this.d;e=e||15;let u=cycleLen(t,o),p=cycleStart(t,o,u),f=this.s<C_ZERO?"-":"";if(f+=trunc(t/o),t%=o,t*=C_TEN,t&&(f+="."),u){for(let b=p;b--;)f+=trunc(t/o),t%=o,t*=C_TEN;f+="(";for(let b=u;b--;)f+=trunc(t/o),t%=o,t*=C_TEN;f+=")"}else for(let b=e;t&&b--;)f+=trunc(t/o),t%=o,t*=C_TEN;return f},toFraction:function(e){let t=this.n,o=this.d,u=this.s<C_ZERO?"-":"";if(o===C_ONE)u+=t;else{let p=trunc(t/o);e&&p>C_ZERO&&(u+=p,u+=" ",t%=o),u+=t,u+="/",u+=o}return u},toLatex:function(e){let t=this.n,o=this.d,u=this.s<C_ZERO?"-":"";if(o===C_ONE)u+=t;else{let p=trunc(t/o);e&&p>C_ZERO&&(u+=p,t%=o),u+="\\frac{",u+=t,u+="}{",u+=o,u+="}"}return u},toContinued:function(){let e=this.n,t=this.d,o=[];do{o.push(trunc(e/t));let u=e%t;e=t,t=u}while(e!==C_ONE);return o},simplify:function(e){const t=BigInt(1/(e||.001)|0),o=this.abs(),u=o.toContinued();for(let p=1;p<u.length;p++){let f=newFraction(u[p-1],C_ONE);for(let M=p-2;M>=0;M--)f=f.inverse().add(u[M]);let b=f.sub(o);if(b.n*t<b.d)return f.mul(this.s)}return this}};const logKey="strudel.log";let debounce=1e3,lastMessage,lastTime;function errorLogger$1(e,t="cyclist"){process.env.NODE_ENV==="development"&&console.error(e),logger$2(`[${t}] error: ${e.message}`)}function logger$2(e,t,o={}){let u=performance.now();lastMessage===e&&u-lastTime<debounce||(lastMessage=e,lastTime=u,console.log(`%c${e}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(logKey,{detail:{message:e,type:t,data:o}})))}logger$2.key=logKey;const isNoteWithOctave=e=>/^[a-gA-G][#bsf]*[0-9]*$/.test(e),isNote=e=>/^[a-gA-G][#bsf]*-?[0-9]*$/.test(e),tokenizeNote$3=e=>{if(typeof e!="string")return[];const[t,o="",u]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,u?Number(u):void 0]:[]},chromas$2={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$2={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset$1=e=>e?.split("").reduce((t,o)=>t+accs$2[o],0)||0,noteToMidi$1=(e,t=3)=>{const[o,u,p=t]=tokenizeNote$3(e);if(!o)throw new Error('not a note: "'+e+'"');const f=chromas$2[o.toLowerCase()],b=getAccidentalsOffset$1(u);return(Number(p)+1)*12+f+b},midiToFreq$2=e=>Math.pow(2,(e-69)/12)*440,freqToMidi$2=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi$1=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:u}=e;if(typeof o=="number")return freqToMidi$2(o);if(typeof u=="string")return noteToMidi$1(u);if(typeof u=="number")return u;if(!t)throw new Error("valueToMidi: expected freq or note to be set");return t},getEventOffsetMs=(e,t)=>(e-t)*1e3,getFreq=e=>midiToFreq$2(typeof e=="number"?e:noteToMidi$1(e)),pcs$1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],midi2note$1=e=>{const t=Math.floor(e/12)-1;return pcs$1[e%12]+t},_mod$2=(e,t)=>(e%t+t)%t,averageArray=e=>e.reduce((t,o)=>t+o)/e.length;function nanFallback$1(e,t=0){return isNaN(Number(e))?(logger$2(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const getSoundIndex$1=(e,t)=>_mod$2(Math.round(nanFallback$1(e??0,0)),t),getPlayableNoteValue=e=>{let{value:t,context:o}=e,u=t;if(typeof u=="object"&&!Array.isArray(u)&&(u=u.note||u.n||u.value,u===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(t)}`);if(typeof u=="number"&&o.type!=="frequency")u=midiToFreq$2(e.value);else if(typeof u=="number"&&o.type==="frequency")u=e.value;else if(typeof u!="string"||!isNote(u))throw new Error("not a note: "+JSON.stringify(u));return u},getFrequency=e=>{let{value:t,context:o}=e;if(typeof t=="object")return t.freq?t.freq:getFreq(t.note||t.n||t.value);if(typeof t=="number"&&o.type!=="frequency")t=midiToFreq$2(e.value);else if(typeof t=="string"&&isNote(t))t=midiToFreq$2(noteToMidi$1(e.value));else if(typeof t!="number")throw new Error("not a note or frequency: "+t);return t},rotate$2=(e,t)=>e.slice(t).concat(e.slice(0,t)),pipe=(...e)=>e.reduce((t,o)=>(...u)=>t(o(...u)),t=>t),compose=(...e)=>pipe(...e.reverse()),removeUndefineds=e=>e.filter(t=>t!=null),flatten=e=>[].concat(...e),id=e=>e,constant=(e,t)=>e,listRange=(e,t)=>Array.from({length:t-e+1},(o,u)=>u+e);function curry(e,t,o=e.length){const u=function p(...f){if(f.length>=o)return e.apply(this,f);{const b=function(...M){return p.apply(this,f.concat(M))};return t&&t(b,f),b}};return t&&t(u,[]),u}function parseNumeral(e){const t=Number(e);if(!isNaN(t))return t;if(isNote(e))return noteToMidi$1(e);throw new Error(`cannot parse as numeral: "${e}"`)}function mapArgs(e,t){return(...o)=>e(...o.map(t))}function numeralArgs(e){return mapArgs(e,parseNumeral)}function parseFractional(e){const t=Number(e);if(!isNaN(t))return t;const o={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[e];if(typeof o<"u")return o;throw new Error(`cannot parse as fractional: "${e}"`)}const fractionalArgs=e=>mapArgs(e,parseFractional),splitAt=function(e,t){return[t.slice(0,e),t.slice(e)]},zipWith=(e,t,o)=>t.map((u,p)=>e(u,o[p])),pairs=function(e){const t=[];for(let o=0;o<e.length-1;++o)t.push([e[o],e[o+1]]);return t},clamp$1=(e,t,o)=>Math.min(Math.max(e,t),o),solfeggio=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],indian=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],german=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],byzantine=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],japanese=["I","Ro","Ha","Ni","Ho","He","To"],english=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],sol2note=(e,t="letters")=>{const u=(t==="solfeggio"?solfeggio:t==="indian"?indian:t==="german"?german:t==="byzantine"?byzantine:t==="japanese"?japanese:english)[e%12],p=Math.floor(e/12)-1;return u+p};function uniq(e){var t={};return e.filter(function(o){return t.hasOwn(o)?!1:t[o]=!0})}function uniqsort(e){return e.sort().filter(function(t,o,u){return!o||t!=u[o-1]})}function uniqsortr(e){return e.sort((t,o)=>t.compare(o)).filter(function(t,o,u){return!o||t.ne(u[o-1])})}function unicodeToBase64(e){const t=new TextEncoder().encode(e);return btoa(String.fromCharCode(...t))}function base64ToUnicode(e){const t=new Uint8Array(atob(e).split("").map(u=>u.charCodeAt(0)));return new TextDecoder().decode(t)}function code2hash(e){return encodeURIComponent(unicodeToBase64(e))}function hash2code(e){return base64ToUnicode(decodeURIComponent(e))}function objectMap(e,t){return Array.isArray(e)?e.map(t):Object.fromEntries(Object.entries(e).map(([o,u],p)=>[o,t(u,o,p)]))}function cycleToSeconds$1(e,t){return e/t}class ClockCollator{constructor({getTargetClockTime:t=getUnixTimeSeconds,weight:o=16,offsetDelta:u=.005,checkAfterTime:p=2,resetAfterTime:f=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=t,this.weight=o,this.offsetDelta=u,this.checkAfterTime=p,this.resetAfterTime=f,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(t){const o=this.getTargetClockTime(),u=o-this.timeAtPrevOffsetSample,p=o-t;if(u>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=p),this.prevOffsetTimes.push(p),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||u>this.checkAfterTime){this.timeAtPrevOffsetSample=o;const f=averageArray(this.prevOffsetTimes);Math.abs(f-this.offsetTime)>this.offsetDelta&&(this.offsetTime=f)}return this.offsetTime}calculateTimestamp(t,o){return this.calculateOffset(t)+o}}function getPerformanceTimeSeconds(){return performance.now()*.001}function getUnixTimeSeconds(){return Date.now()*.001}const keyAlias=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let keyState;function getCurrentKeyboardState(){if(keyState==null){if(typeof window>"u")return;keyState={},window.addEventListener("keydown",e=>{keyState[e.key]=!0}),window.addEventListener("keyup",e=>{keyState[e.key]=!1})}return{...keyState}}function stringifyValues(e,t=!1){return typeof e=="object"?t?JSON.stringify(e).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(e):e}Fraction$1.prototype.sam=function(){return this.floor()},Fraction$1.prototype.nextSam=function(){return this.sam().add(1)},Fraction$1.prototype.wholeCycle=function(){return new TimeSpan(this.sam(),this.nextSam())},Fraction$1.prototype.cyclePos=function(){return this.sub(this.sam())},Fraction$1.prototype.lt=function(e){return this.compare(e)<0},Fraction$1.prototype.gt=function(e){return this.compare(e)>0},Fraction$1.prototype.lte=function(e){return this.compare(e)<=0},Fraction$1.prototype.gte=function(e){return this.compare(e)>=0},Fraction$1.prototype.eq=function(e){return this.compare(e)==0},Fraction$1.prototype.ne=function(e){return this.compare(e)!=0},Fraction$1.prototype.max=function(e){return this.gt(e)?this:e},Fraction$1.prototype.maximum=function(...e){return e=e.map(t=>new Fraction$1(t)),e.reduce((t,o)=>o.max(t),this)},Fraction$1.prototype.min=function(e){return this.lt(e)?this:e},Fraction$1.prototype.mulmaybe=function(e){return e!==void 0?this.mul(e):void 0},Fraction$1.prototype.divmaybe=function(e){return e!==void 0?this.div(e):void 0},Fraction$1.prototype.addmaybe=function(e){return e!==void 0?this.add(e):void 0},Fraction$1.prototype.submaybe=function(e){return e!==void 0?this.sub(e):void 0},Fraction$1.prototype.show=function(){return this.s*this.n+"/"+this.d},Fraction$1.prototype.or=function(e){return this.eq(0)?e:this};const fraction$1=e=>Fraction$1(e),gcd=(...e)=>{if(e=removeUndefineds(e),e.length!==0)return e.reduce((t,o)=>t.gcd(o),fraction$1(1))},lcm=(...e)=>{if(e=removeUndefineds(e),e.length===0)return;const t=e.pop();return e.reduce((o,u)=>o===void 0||u===void 0?void 0:o.lcm(u),t)},isFraction=e=>e instanceof Fraction$1;fraction$1._original=Fraction$1;const Fraction=fraction$1;class TimeSpan{constructor(t,o){this.begin=Fraction(t),this.end=Fraction(o)}get spanCycles(){const t=[];var o=this.begin;const u=this.end,p=u.sam();if(o.equals(u))return[new TimeSpan(o,u)];for(;u.gt(o);){if(o.sam().equals(p)){t.push(new TimeSpan(o,this.end));break}const f=o.nextSam();t.push(new TimeSpan(o,f)),o=f}return t}get duration(){return this.end.sub(this.begin)}cycleArc(){const t=this.begin.cyclePos(),o=t.add(this.duration);return new TimeSpan(t,o)}withTime(t){return new TimeSpan(t(this.begin),t(this.end))}withEnd(t){return new TimeSpan(this.begin,t(this.end))}withCycle(t){const o=this.begin.sam(),u=o.add(t(this.begin.sub(o))),p=o.add(t(this.end.sub(o)));return new TimeSpan(u,p)}intersection(t){const o=this.begin.max(t.begin),u=this.end.min(t.end);if(!o.gt(u)&&!(o.equals(u)&&(o.equals(this.end)&&this.begin.lt(this.end)||o.equals(t.end)&&t.begin.lt(t.end))))return new TimeSpan(o,u)}intersection_e(t){const o=this.intersection(t);if(o==null)throw"TimeSpans do not intersect";return o}midpoint(){return this.begin.add(this.duration.div(Fraction(2)))}equals(t){return this.begin.equals(t.begin)&&this.end.equals(t.end)}show(){return this.begin.show()+" → "+this.end.show()}}class Hap{constructor(t,o,u,p={},f=!1){this.whole=t,this.part=o,this.value=u,this.context=p,this.stateful=f,f&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){let t;return typeof this.value?.duration=="number"?t=Fraction(this.value.duration):t=this.whole.end.sub(this.whole.begin),typeof this.value?.clip=="number"?t.mul(this.value.clip):t}get endClipped(){return this.whole.begin.add(this.duration)}isActive(t){return this.whole.begin<=t&&this.endClipped>=t}isInPast(t){return t>this.endClipped}isInNearPast(t,o){return o-t<=this.endClipped}isInFuture(t){return t<this.whole.begin}isInNearFuture(t,o){return o<this.whole.begin&&o>this.whole.begin-t}isWithinTime(t,o){return this.whole.begin<=o&&this.endClipped>=t}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(t){const o=this.whole?t(this.whole):void 0;return new Hap(o,t(this.part),this.value,this.context)}withValue(t){return new Hap(this.whole,this.part,t(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(t){return this.context.tags?.includes(t)}resolveState(t){if(this.stateful&&this.hasOnset()){console.log("stateful");const o=this.value,[u,p]=o(t);return[u,new Hap(this.whole,this.part,p,this.context,!1)]}return[t,this]}spanEquals(t){return this.whole==null&&t.whole==null||this.whole.equals(t.whole)}equals(t){return this.spanEquals(t)&&this.part.equals(t.part)&&this.value===t.value}show(t=!1){const o=typeof this.value=="object"?t?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var u="";if(this.whole==null)u="~"+this.part.show;else{var p=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(u=this.whole.begin.show()+" ⇜ "),p||(u+="("),u+=this.part.show(),p||(u+=")"),this.whole.end.equals(this.part.end)||(u+=" ⇝ "+this.whole.end.show())}return"[ "+u+" | "+o+" ]"}showWhole(t=!1){return`${this.whole==null?"~":this.whole.show()}: ${stringifyValues(this.value,t)}`}combineContext(t){const o=this;return{...o.context,...t.context,locations:(o.context.locations||[]).concat(t.context.locations||[])}}setContext(t){return new Hap(this.whole,this.part,this.value,t)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class State{constructor(t,o={}){this.span=t,this.controls=o}setSpan(t){return new State(t,this.controls)}withSpan(t){return this.setSpan(t(this.span))}setControls(t){return new State(this.span,{...this.controls,...t})}}function unionWithObj(e,t,o){if(t?.value!==void 0&&Object.keys(t).length===1)return logger$2("[warn]: Can't do arithmetic on control pattern."),e;const u=Object.keys(e).filter(p=>Object.keys(t).includes(p));return Object.assign({},e,t,Object.fromEntries(u.map(p=>[p,o(e[p],t[p])])))}curry((e,t)=>e*t),curry((e,t)=>t.map(e));function drawLine(e,t=60){let o=0,u=Fraction(0),p=[""],f="";for(;p[0].length<t;){const b=e.queryArc(o,o+1),M=b.filter(k=>k.hasOnset()).map(k=>k.duration),F=gcd(...M),S=F.inverse();p=p.map(k=>k+"|"),f+="|";for(let k=0;k<S;k++){const[N,$]=[u,u.add(F)],R=b.filter(V=>V.whole.begin.lte(N)&&V.whole.end.gte($)),U=R.length-p.length;U>0&&(p=p.concat(Array(U).fill(f))),p=p.map((V,z)=>{const K=R[z];if(K){const he=K.whole.begin.eq(N)?""+K.value:"-";return V+he}return V+"."}),f+=".",u=u.add(F)}o++}return p.join(`
`)}let stringParser,__steps=!0;const calculateSteps=function(e){__steps=!!e},setStringParser=e=>stringParser=e;let Pattern$1=class _n{constructor(t,o=void 0){this.query=t,this._Pattern=!0,this._steps=o}get _steps(){return this.__steps}set _steps(t){this.__steps=t===void 0?void 0:Fraction(t)}setSteps(t){return this._steps=t,this}withSteps(t){return __steps?new _n(this.query,this._steps===void 0?void 0:t(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(t){const o=new _n(u=>this.query(u).map(p=>p.withValue(t)));return o._steps=this._steps,o}withState(t){return new _n(o=>this.query(t(o)))}fmap(t){return this.withValue(t)}appWhole(t,o){const u=this,p=function(f){const b=u.query(f),M=o.query(f),F=function(S,k){const N=S.part.intersection(k.part);if(N!=null)return new Hap(t(S.whole,k.whole),N,S.value(k.value),k.combineContext(S))};return flatten(b.map(S=>removeUndefineds(M.map(k=>F(S,k)))))};return new _n(p)}appBoth(t){const o=this,u=function(f,b){if(!(f==null||b==null))return f.intersection_e(b)},p=o.appWhole(u,t);return __steps&&(p._steps=lcm(t._steps,o._steps)),p}appLeft(t){const o=this,u=function(f){const b=[];for(const M of o.query(f)){const F=t.query(f.setSpan(M.wholeOrPart()));for(const S of F){const k=M.whole,N=M.part.intersection(S.part);if(N){const $=M.value(S.value),R=S.combineContext(M),U=new Hap(k,N,$,R);b.push(U)}}}return b},p=new _n(u);return p._steps=this._steps,p}appRight(t){const o=this,u=function(f){const b=[];for(const M of t.query(f)){const F=o.query(f.setSpan(M.wholeOrPart()));for(const S of F){const k=M.whole,N=S.part.intersection(M.part);if(N){const $=S.value(M.value),R=M.combineContext(S),U=new Hap(k,N,$,R);b.push(U)}}}return b},p=new _n(u);return p._steps=t._steps,p}bindWhole(t,o){const u=this,p=function(f){const b=function(F,S){return new Hap(t(F.whole,S.whole),S.part,S.value,Object.assign({},F.context,S.context,{locations:(F.context.locations||[]).concat(S.context.locations||[])}))},M=function(F){return o(F.value).query(f.setSpan(F.part)).map(S=>b(F,S))};return flatten(u.query(f).map(F=>M(F)))};return new _n(p)}bind(t){const o=function(u,p){if(!(u==null||p==null))return u.intersection_e(p)};return this.bindWhole(o,t)}join(){return this.bind(id)}outerBind(t){return this.bindWhole(o=>o,t).setSteps(this._steps)}outerJoin(){return this.outerBind(id)}innerBind(t){return this.bindWhole((o,u)=>u,t)}innerJoin(){return this.innerBind(id)}resetJoin(t=!1){const o=this;return new _n(u=>o.discreteOnly().query(u).map(p=>p.value.late(t?p.whole.begin:p.whole.begin.cyclePos()).query(u).map(f=>new Hap(f.whole?f.whole.intersection(p.whole):void 0,f.part.intersection(p.part),f.value).setContext(p.combineContext(f))).filter(f=>f.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const t=this;function o(u){const p=t.discreteOnly().query(u);function f(M){const S=M.value._focusSpan(M.wholeOrPart()).query(u.setSpan(M.part));function k(N,$){let R;if($.whole&&N.whole&&(R=$.whole.intersection(N.whole),!R))return;const U=$.part.intersection(N.part);if(!U)return;const V=$.combineContext(N);return new Hap(R,U,$.value,V)}return S.map(N=>k(M,N))}return flatten(p.map(f)).filter(M=>M)}return new _n(o)}squeezeBind(t){return this.fmap(t).squeezeJoin()}polyJoin=function(){const t=this;return t.fmap(o=>o.extend(t._steps.div(o._steps))).outerJoin()};polyBind(t){return this.fmap(t).polyJoin()}queryArc(t,o,u={}){try{return this.query(new State(new TimeSpan(t,o),u))}catch(p){return errorLogger$1(p,"query"),[]}}splitQueries(){const t=this,o=u=>flatten(u.span.spanCycles.map(p=>t.query(u.setSpan(p))));return new _n(o)}withQuerySpan(t){return new _n(o=>this.query(o.withSpan(t)))}withQuerySpanMaybe(t){const o=this;return new _n(u=>{const p=u.withSpan(t);return p.span?o.query(p):[]})}withQueryTime(t){return new _n(o=>this.query(o.withSpan(u=>u.withTime(t))))}withHapSpan(t){return new _n(o=>this.query(o).map(u=>u.withSpan(t)))}withHapTime(t){return this.withHapSpan(o=>o.withTime(t))}withHaps(t){const o=new _n(u=>t(this.query(u),u));return o._steps=this._steps,o}withHap(t){return this.withHaps(o=>o.map(t))}setContext(t){return this.withHap(o=>o.setContext(t))}withContext(t){const o=this.withHap(u=>u.setContext(t(u.context)));return this.__pure!==void 0&&(o.__pure=this.__pure,o.__pure_loc=this.__pure_loc),o}stripContext(){return this.withHap(t=>t.setContext({}))}withLoc(t,o){const u={start:t,end:o},p=this.withContext(f=>{const b=(f.locations||[]).concat([u]);return{...f,locations:b}});return this.__pure&&(p.__pure=this.__pure,p.__pure_loc=u),p}filterHaps(t){return new _n(o=>this.query(o).filter(t))}filterValues(t){return new _n(o=>this.query(o).filter(u=>t(u.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(t=>t!=null)}onsetsOnly(){return this.filterHaps(t=>t.hasOnset())}discreteOnly(){return this.filterHaps(t=>t.whole)}defragmentHaps(){return this.discreteOnly().withHaps(o=>{const u=[];for(var p=0;p<o.length;++p){for(var f=!0,b=o[p];f;){const S=JSON.stringify(o[p].value);for(var M=!1,F=p+1;F<o.length;F++){const k=o[F];if(b.whole.equals(k.whole)){if(b.part.begin.eq(k.part.end)){if(S===JSON.stringify(k.value)){b=new Hap(b.whole,new TimeSpan(k.part.begin,b.part.end),b.value),o.splice(F,1),M=!0;break}}else if(k.part.begin.eq(b.part.end)&&S==JSON.stringify(k.value)){b=new Hap(b.whole,new TimeSpan(b.part.begin,k.part.end),b.value),o.splice(F,1),M=!0;break}}}f=M}u.push(b)}return u})}firstCycle(t=!1){var o=this;return t||(o=o.stripContext()),o.query(new State(new TimeSpan(Fraction(0),Fraction(1))))}get firstCycleValues(){return this.firstCycle().map(t=>t.value)}get showFirstCycle(){return this.firstCycle().map(t=>`${t.value}: ${t.whole.begin.toFraction()} - ${t.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(t=>t.sort((o,u)=>o.part.begin.sub(u.part.begin).or(o.part.end.sub(u.part.end)).or(o.whole.begin.sub(u.whole.begin).or(o.whole.end.sub(u.whole.end)))))}asNumber(){return this.fmap(parseNumeral)}_opIn(t,o){return this.fmap(o).appLeft(reify(t))}_opOut(t,o){return this.fmap(o).appRight(reify(t))}_opMix(t,o){return this.fmap(o).appBoth(reify(t))}_opSqueeze(t,o){const u=reify(t);return this.fmap(p=>u.fmap(f=>o(p)(f))).squeezeJoin()}_opSqueezeOut(t,o){const u=this;return reify(t).fmap(f=>u.fmap(b=>o(b)(f))).squeezeJoin()}_opReset(t,o){return reify(t).fmap(p=>this.fmap(f=>o(f)(p))).resetJoin()}_opRestart(t,o){return reify(t).fmap(p=>this.fmap(f=>o(f)(p))).restartJoin()}_opPoly(t,o){const u=reify(t);return this.fmap(p=>u.fmap(f=>o(f)(p))).polyJoin()}layer(...t){return stack(...t.map(o=>o(this)))}superimpose(...t){return this.stack(...t.map(o=>o(this)))}stack(...t){return stack(this,...t)}sequence(...t){return sequence(this,...t)}seq(...t){return sequence(this,...t)}cat(...t){return cat(this,...t)}fastcat(...t){return fastcat(this,...t)}slowcat(...t){return slowcat(this,...t)}onTrigger(t,o=!0){return this.withHap(u=>u.setContext({...u.context,onTrigger:(...p)=>{u.context.onTrigger?.(...p),t(...p)},dominantTrigger:u.context.dominantTrigger||o}))}log(t=u=>`[hap] ${u.showWhole(!0)}`,o=u=>({hap:u})){return this.onTrigger((...u)=>{logger$2(t(...u),void 0,o(...u))},!1)}logValues(t=o=>`[hap] ${stringifyValues(o,!0)}`){return this.log(o=>t(o.value))}drawLine(){return console.log(drawLine(this)),this}unjoin(t,o=id){return t.withHap(u=>u.withValue(p=>p?o(this.ribbon(u.whole.begin,u.whole.duration)):this))}into(t,o){return this.unjoin(t,o).innerJoin()}};function groupHapsBy(e,t){let o=[];return t.forEach(u=>{const p=o.findIndex(([f])=>e(u,f));p===-1?o.push([u]):o[p].push(u)}),o}const congruent=(e,t)=>e.spanEquals(t);Pattern$1.prototype.collect=function(){return this.withHaps(e=>groupHapsBy(congruent,e).map(t=>new Hap(t[0].whole,t[0].part,t,{})))};const arpWith=register("arpWith",(e,t)=>t.collect().fmap(o=>reify(e(o))).innerJoin().withHap(o=>new Hap(o.whole,o.part,o.value.value,o.combineContext(o.value)))),arp=register("arp",(e,t)=>t.arpWith(o=>reify(e).fmap(u=>o[u%o.length])),!1);function _nonArrayObject(e){return!Array.isArray(e)&&typeof e=="object"&&!isFraction(e)}function _composeOp(e,t,o){return _nonArrayObject(e)||_nonArrayObject(t)?(_nonArrayObject(e)||(e={value:e}),_nonArrayObject(t)||(t={value:t}),unionWithObj(e,t,o)):o(e,t)}(function(){const e={set:[(o,u)=>u],keep:[o=>o],keepif:[(o,u)=>u?o:void 0],add:[numeralArgs((o,u)=>o+u)],sub:[numeralArgs((o,u)=>o-u)],mul:[numeralArgs((o,u)=>o*u)],div:[numeralArgs((o,u)=>o/u)],mod:[numeralArgs(_mod$2)],pow:[numeralArgs(Math.pow)],log2:[numeralArgs(Math.log2)],band:[numeralArgs((o,u)=>o&u)],bor:[numeralArgs((o,u)=>o|u)],bxor:[numeralArgs((o,u)=>o^u)],blshift:[numeralArgs((o,u)=>o<<u)],brshift:[numeralArgs((o,u)=>o>>u)],lt:[(o,u)=>o<u],gt:[(o,u)=>o>u],lte:[(o,u)=>o<=u],gte:[(o,u)=>o>=u],eq:[(o,u)=>o==u],eqt:[(o,u)=>o===u],ne:[(o,u)=>o!=u],net:[(o,u)=>o!==u],and:[(o,u)=>o&&u],or:[(o,u)=>o||u],func:[(o,u)=>u(o)]},t=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[o,[u,p]]of Object.entries(e)){Pattern$1.prototype["_"+o]=function(f){return this.fmap(b=>u(b,f))},Object.defineProperty(Pattern$1.prototype,o,{get:function(){const f=this,b=(...M)=>f[o].in(...M);for(const M of t)b[M.toLowerCase()]=function(...F){var S=f;F=sequence(F),p&&(S=p(S),F=p(F));var k;return o==="keepif"?(k=S["_op"+M](F,N=>$=>u(N,$)),k=k.removeUndefineds()):k=S["_op"+M](F,N=>$=>_composeOp(N,$,u)),k};return b.squeezein=b.squeeze,b}});for(const f of t)Pattern$1.prototype[f.toLowerCase()]=function(...b){return this.set[f.toLowerCase()](b)}}Pattern$1.prototype.struct=function(...o){return this.keepif.out(...o)},Pattern$1.prototype.structAll=function(...o){return this.keep.out(...o)},Pattern$1.prototype.mask=function(...o){return this.keepif.in(...o)},Pattern$1.prototype.maskAll=function(...o){return this.keep.in(...o)},Pattern$1.prototype.reset=function(...o){return this.keepif.reset(...o)},Pattern$1.prototype.resetAll=function(...o){return this.keep.reset(...o)},Pattern$1.prototype.restart=function(...o){return this.keepif.restart(...o)},Pattern$1.prototype.restartAll=function(...o){return this.keep.restart(...o)}})();const polyrhythm=stack,pr=stack,pm=polymeter,gap=e=>new Pattern$1(()=>[],e),silence=gap(1),nothing=gap(0);function pure(e){function t(u){return u.span.spanCycles.map(p=>new Hap(Fraction(p.begin).wholeCycle(),p,e))}const o=new Pattern$1(t,1);return o.__pure=e,o}function isPattern(e){return e instanceof Pattern$1||e?._Pattern}function reify(e){return isPattern(e)?e:stringParser&&typeof e=="string"?stringParser(e):pure(e)}function sequenceP(e){let t=pure([]);for(const o of e)t=t.bind(u=>o.fmap(p=>u.concat([p])));return t}function stack(...e){e=e.map(u=>Array.isArray(u)?sequence(...u):reify(u));const t=u=>flatten(e.map(p=>p.query(u))),o=new Pattern$1(t);return __steps&&(o._steps=lcm(...e.map(u=>u._steps))),o}function _stackWith(e,t){if(t=t.map(f=>Array.isArray(f)?sequence(...f):reify(f)),t.length===0)return silence;if(t.length===1)return t[0];const[o,...u]=t.map(f=>f._steps),p=__steps?o.maximum(...u):void 0;return stack(...e(p,t))}function stackLeft(...e){return _stackWith((t,o)=>o.map(u=>u._steps.eq(t)?u:stepcat(u,gap(t.sub(u._steps)))),e)}function stackRight(...e){return _stackWith((t,o)=>o.map(u=>u._steps.eq(t)?u:stepcat(gap(t.sub(u._steps)),u)),e)}function stackCentre(...e){return _stackWith((t,o)=>o.map(u=>{if(u._steps.eq(t))return u;const p=gap(t.sub(u._steps).div(2));return stepcat(p,u,p)}),e)}function stackBy(e,...t){const[o,...u]=t.map(b=>b._steps),p=o.maximum(...u),f={centre:stackCentre,left:stackLeft,right:stackRight,expand:stack,repeat:(...b)=>polymeter(...b).steps(p)};return e.inhabit(f).fmap(b=>b(...t)).innerJoin().setSteps(p)}function slowcat(...e){if(e=e.map(u=>Array.isArray(u)?fastcat(...u):reify(u)),e.length==1)return e[0];const t=function(u){const p=u.span,f=_mod$2(p.begin.sam(),e.length),b=e[f];if(!b)return[];const M=p.begin.floor().sub(p.begin.div(e.length).floor());return b.withHapTime(F=>F.add(M)).query(u.setSpan(p.withTime(F=>F.sub(M))))},o=__steps?lcm(...e.map(u=>u._steps)):void 0;return new Pattern$1(t).splitQueries().setSteps(o)}function slowcatPrime(...e){e=e.map(reify);const t=function(o){const u=Math.floor(o.span.begin)%e.length;return e[u]?.query(o)||[]};return new Pattern$1(t).splitQueries()}function cat(...e){return slowcat(...e)}function arrange(...e){const t=e.reduce((o,[u])=>o+u,0);return e=e.map(([o,u])=>[o,u.fast(o)]),stepcat(...e).slow(t)}function seqPLoop(...e){let t=Fraction(0);for(let o of e)o.length==2&&o.unshift(t),t=o[1];return stack(...e.map(([o,u,p])=>pure(reify(p)).compress(Fraction(o).div(t),Fraction(u).div(t)))).slow(t).innerJoin()}function fastcat(...e){let t=slowcat(...e);return e.length>1&&(t=t._fast(e.length),t._steps=e.length),e.length==1&&e[0].__steps_source&&(e._steps=e[0]._steps),t}function sequence(...e){return fastcat(...e)}function seq(...e){return fastcat(...e)}function _sequenceCount(e){return Array.isArray(e)?e.length==0?[silence,0]:e.length==1?_sequenceCount(e[0]):[fastcat(...e.map(t=>_sequenceCount(t)[0])),e.length]:[reify(e),1]}const mask=curry((e,t)=>reify(t).mask(e)),struct=curry((e,t)=>reify(t).struct(e)),superimpose=curry((e,t)=>reify(t).superimpose(...e)),withValue=curry((e,t)=>reify(t).withValue(e)),bind=curry((e,t)=>reify(t).bind(e)),innerBind=curry((e,t)=>reify(t).innerBind(e)),outerBind=curry((e,t)=>reify(t).outerBind(e)),squeezeBind=curry((e,t)=>reify(t).squeezeBind(e)),stepBind=curry((e,t)=>reify(t).stepBind(e)),polyBind=curry((e,t)=>reify(t).polyBind(e)),set=curry((e,t)=>reify(t).set(e)),keep=curry((e,t)=>reify(t).keep(e)),keepif=curry((e,t)=>reify(t).keepif(e)),add$7=curry((e,t)=>reify(t).add(e)),sub=curry((e,t)=>reify(t).sub(e)),mul=curry((e,t)=>reify(t).mul(e)),div=curry((e,t)=>reify(t).div(e)),mod$3=curry((e,t)=>reify(t).mod(e)),pow=curry((e,t)=>reify(t).pow(e)),band=curry((e,t)=>reify(t).band(e)),bor=curry((e,t)=>reify(t).bor(e)),bxor=curry((e,t)=>reify(t).bxor(e)),blshift=curry((e,t)=>reify(t).blshift(e)),brshift=curry((e,t)=>reify(t).brshift(e)),lt=curry((e,t)=>reify(t).lt(e)),gt=curry((e,t)=>reify(t).gt(e)),lte=curry((e,t)=>reify(t).lte(e)),gte=curry((e,t)=>reify(t).gte(e)),eq=curry((e,t)=>reify(t).eq(e)),eqt=curry((e,t)=>reify(t).eqt(e)),ne=curry((e,t)=>reify(t).ne(e)),net=curry((e,t)=>reify(t).net(e)),and=curry((e,t)=>reify(t).and(e)),or=curry((e,t)=>reify(t).or(e)),func=curry((e,t)=>reify(t).func(e));function register(e,t,o=!0,u=!1,p=f=>f.innerJoin()){if(Array.isArray(e)){const M={};for(const F of e)M[F]=register(F,t,o,u,p);return M}const f=t.length;var b;return o?b=function(...M){M=M.map(reify);const F=M[M.length-1];let S;if(f===1)S=t(F);else{const k=M.slice(0,-1);if(k.every(N=>N.__pure!=null)){const N=k.map(R=>R.__pure),$=k.filter(R=>R.__pure_loc).map(R=>R.__pure_loc);S=t(...N,F),S=S.withContext(R=>{const U=(R.locations||[]).concat($);return{...R,locations:U}})}else{const[N,...$]=k;let R=(...U)=>t(...U,F);R=curry(R,null,f-1),S=p($.reduce((U,V)=>U.appLeft(V),N.fmap(R)))}}return u&&(S._steps=F._steps),S}:b=function(...M){M=M.map(reify);const F=t(...M);return u&&(F._steps=M[M.length-1]._steps),F},Pattern$1.prototype[e]=function(...M){if(f===2&&M.length!==1)M=[sequence(...M)];else if(f!==M.length+1)throw new Error(`.${e}() expects ${f-1} inputs but got ${M.length}.`);return M=M.map(reify),b(...M,this)},f>1&&(Pattern$1.prototype["_"+e]=function(...M){const F=t(...M,this);return u&&F.setSteps(this._steps),F}),curry(b,null,f)}function stepRegister(e,t,o=!0,u=!1,p=f=>f.stepJoin()){return register(e,t,o,u,p)}const round=register("round",function(e){return e.asNumber().fmap(t=>Math.round(t))}),floor=register("floor",function(e){return e.asNumber().fmap(t=>Math.floor(t))}),ceil=register("ceil",function(e){return e.asNumber().fmap(t=>Math.ceil(t))}),toBipolar=register("toBipolar",function(e){return e.fmap(t=>t*2-1)}),fromBipolar=register("fromBipolar",function(e){return e.fmap(t=>(t+1)/2)}),range$2=register("range",function(e,t,o){return o.mul(t-e).add(e)}),rangex=register("rangex",function(e,t,o){return o._range(Math.log(e),Math.log(t)).fmap(Math.exp)}),range2=register("range2",function(e,t,o){return o.fromBipolar()._range(e,t)}),ratio=register("ratio",e=>e.fmap(t=>Array.isArray(t)?t.slice(1).reduce((o,u)=>o/u,t[0]):t)),compress=register("compress",function(e,t,o){return e=Fraction(e),t=Fraction(t),e.gt(t)||e.gt(1)||t.gt(1)||e.lt(0)||t.lt(0)?silence:o._fastGap(Fraction(1).div(t.sub(e)))._late(e)}),{compressSpan,compressspan}=register(["compressSpan","compressspan"],function(e,t){return t._compress(e.begin,e.end)}),{fastGap,fastgap}=register(["fastGap","fastgap"],function(e,t){const o=function(p){const f=p.begin.sam(),b=p.begin.sub(f).mul(e).min(1),M=p.end.sub(f).mul(e).min(1);if(!(b>=1))return new TimeSpan(f.add(b),f.add(M))},u=function(p){const f=p.part.begin,b=p.part.end,M=f.sam(),F=f.sub(M).div(e).min(1),S=b.sub(M).div(e).min(1),k=new TimeSpan(M.add(F),M.add(S)),N=p.whole?new TimeSpan(k.begin.sub(f.sub(p.whole.begin).div(e)),k.end.add(p.whole.end.sub(b).div(e))):void 0;return new Hap(N,k,p.value,p.context)};return t.withQuerySpanMaybe(o).withHap(u).splitQueries()}),focus=register("focus",function(e,t,o){return e=Fraction(e),t=Fraction(t),o._early(e.sam())._fast(Fraction(1).div(t.sub(e)))._late(e)}),{focusSpan,focusspan}=register(["focusSpan","focusspan"],function(e,t){return t._focus(e.begin,e.end)}),ply=register("ply",function(e,t){const o=t.fmap(u=>pure(u)._fast(e)).squeezeJoin();return __steps&&(o._steps=Fraction(e).mulmaybe(t._steps)),o}),{fast,density:density$1}=register(["fast","density"],function(e,t){return e===0?silence:(e=Fraction(e),t.withQueryTime(u=>u.mul(e)).withHapTime(u=>u.div(e)).setSteps(t._steps))},!0,!0),hurry=register("hurry",function(e,t){return t._fast(e).mul(pure({speed:e}))}),{slow,sparsity}=register(["slow","sparsity"],function(e,t){return e===0?silence:t._fast(Fraction(1).div(e))}),inside=register("inside",function(e,t,o){return t(o._slow(e))._fast(e)}),outside=register("outside",function(e,t,o){return t(o._fast(e))._slow(e)}),lastOf=register("lastOf",function(e,t,o){const u=Array(e-1).fill(o);return u.push(t(o)),slowcatPrime(...u)}),{firstOf,every}=register(["firstOf","every"],function(e,t,o){const u=Array(e-1).fill(o);return u.unshift(t(o)),slowcatPrime(...u)}),apply=register("apply",function(e,t){return e(t)}),cpm=register("cpm",function(e,t){return t._fast(e/60/1)}),early=register("early",function(e,t){return e=Fraction(e),t.withQueryTime(o=>o.add(e)).withHapTime(o=>o.sub(e))},!0,!0),late=register("late",function(e,t){return e=Fraction(e),t._early(Fraction(0).sub(e))},!0,!0),zoom=register("zoom",function(e,t,o){if(t=Fraction(t),e=Fraction(e),e.gte(t))return nothing;const u=t.sub(e),p=__steps?o._steps?.mulmaybe(u):void 0;return o.withQuerySpan(f=>f.withCycle(b=>b.mul(u).add(e))).withHapSpan(f=>f.withCycle(b=>b.sub(e).div(u))).splitQueries().setSteps(p)}),{zoomArc,zoomarc}=register(["zoomArc","zoomarc"],function(e,t){return t.zoom(e.begin,e.end)}),bite=register("bite",(e,t,o)=>t.fmap(u=>p=>{const f=Fraction(u).div(p).mod(1),b=f.add(Fraction(1).div(p));return o.zoom(f,b)}).appLeft(e).squeezeJoin(),!1),linger=register("linger",function(e,t){return e==0?silence:e<0?t._zoom(e.add(1),1)._slow(e):t._zoom(0,e)._slow(e)},!0,!0),{segment,seg}=register(["segment","seg"],function(e,t){return t.struct(pure(!0)._fast(e)).setSteps(e)}),swingBy=register("swingBy",(e,t,o)=>o.inside(t,late(seq(0,e/2)))),swing=register("swing",(e,t)=>t.swingBy(1/3,e)),{invert:invert$1,inv}=register(["invert","inv"],function(e){return e.fmap(t=>!t)},!0,!0),when=register("when",function(e,t,o){return e?t(o):o}),off=register("off",function(e,t,o){return stack(o,t(o.late(e)))}),brak=register("brak",function(e){return e.when(slowcat(!1,!0),t=>fastcat(t,silence)._late(.25))}),rev=register("rev",function(e){const t=function(o){const u=o.span,p=u.begin.sam(),f=u.begin.nextSam(),b=function(F){const S=F.withTime(N=>p.add(f.sub(N))),k=S.begin;return S.begin=S.end,S.end=k,S};return e.query(o.setSpan(b(u))).map(F=>F.withSpan(b))};return new Pattern$1(t).splitQueries()},!1,!0),revv=register("revv",function(e){const t=o=>new TimeSpan(Fraction(0).sub(o.end),Fraction(0).sub(o.begin));return e.withQuerySpan(t).withHapSpan(t)}),pressBy=register("pressBy",function(e,t){return t.fmap(o=>pure(o).compress(e,1)).squeezeJoin()}),press=register("press",function(e){return e._pressBy(.5)});Pattern$1.prototype.hush=function(){return silence};const palindrome=register("palindrome",function(e){return e.lastOf(2,rev)},!0,!0),{juxBy,juxby}=register(["juxBy","juxby"],function(e,t,o){e/=2;const u=function(b,M,F){return M in b?b[M]:F},p=o.withValue(b=>Object.assign({},b,{pan:u(b,"pan",.5)-e})),f=t(o.withValue(b=>Object.assign({},b,{pan:u(b,"pan",.5)+e})));return stack(p,f).setSteps(__steps?lcm(p._steps,f._steps):void 0)}),jux=register("jux",function(e,t){return t._juxBy(1,e,t)}),{echoWith,echowith,stutWith,stutwith}=register(["echoWith","echowith","stutWith","stutwith"],function(e,t,o,u){return stack(...listRange(0,e-1).map(p=>o(u.late(Fraction(t).mul(p)),p)))}),echo=register("echo",function(e,t,o,u){return u._echoWith(e,t,(p,f)=>p.gain(Math.pow(o,f)))}),stut=register("stut",function(e,t,o,u){return u._echoWith(e,o,(p,f)=>p.gain(Math.pow(t,f)))}),applyN=register("applyN",function(e,t,o){let u=o;for(let p=0;p<e;p++)u=t(u);return u}),plyWith=register(["plyWith","plywith"],function(e,t,o){const u=o.fmap(p=>cat(...listRange(0,e-1).map(f=>applyN(f,t,p)))._fast(e)).squeezeJoin();return __steps&&(u._steps=Fraction(e).mulmaybe(o._steps)),u}),plyForEach=register(["plyForEach","plyforeach"],function(e,t,o){const u=o.fmap(p=>cat(cat(pure(p),...listRange(1,e-1).map(f=>t(pure(p),f))))._fast(e)).squeezeJoin();return __steps&&(u._steps=Fraction(e).mulmaybe(o._steps)),u}),_iter=function(e,t,o=!1){return e=Fraction(e),slowcat(...listRange(0,e.sub(1)).map(u=>o?t.late(Fraction(u).div(e)):t.early(Fraction(u).div(e))))},iter=register("iter",function(e,t){return _iter(e,t,!1)},!0,!0),{iterBack,iterback}=register(["iterBack","iterback"],function(e,t){return _iter(e,t,!0)},!0,!0),{repeatCycles}=register("repeatCycles",function(e,t){return new Pattern$1(function(o){const u=o.span.begin.sam(),p=u.div(e).sam(),f=u.sub(p);return o=o.withSpan(b=>b.withTime(M=>M.sub(f))),t.query(o).map(b=>b.withSpan(M=>M.withTime(F=>F.add(f))))}).splitQueries()},!0,!0),_chunk=function(e,t,o,u=!1,p=!1){const f=Array(e-1).fill(!1);f.unshift(!0);const b=_iter(e,sequence(...f),!u);return p||(o=o.repeatCycles(e)),o.when(b,t)},{chunk,slowchunk,slowChunk}=register(["chunk","slowchunk","slowChunk"],function(e,t,o){return _chunk(e,t,o,!1,!1)},!0,!0),{chunkBack,chunkback}=register(["chunkBack","chunkback"],function(e,t,o){return _chunk(e,t,o,!0)},!0,!0),{fastchunk,fastChunk}=register(["fastchunk","fastChunk"],function(e,t,o){return _chunk(e,t,o,!1,!0)},!0,!0),{chunkinto,chunkInto}=register(["chunkinto","chunkInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iterback(e),t)}),{chunkbackinto,chunkBackInto}=register(["chunkbackinto","chunkBackInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iter(e)._early(1),t)}),bypass=register("bypass",function(e,t){return e=!!parseInt(e),e?silence:t},!0,!0),{ribbon,rib}=register(["ribbon","rib"],(e,t,o)=>o.early(e).restart(pure(1).slow(t))),hsla=register("hsla",(e,t,o,u,p)=>p.color(`hsla(${e}turn,${t*100}%,${o*100}%,${u})`)),hsl=register("hsl",(e,t,o,u)=>u.color(`hsl(${e}turn,${t*100}%,${o*100}%)`));Pattern$1.prototype.tag=function(e){return this.withContext(t=>({...t,tags:(t.tags||[]).concat([e])}))};const filter$1=register("filter",(e,t)=>t.withHaps(o=>o.filter(e))),filterWhen=register("filterWhen",(e,t)=>t.filter(o=>e(o.whole.begin))),within=register("within",(e,t,o,u)=>stack(o(u.filterWhen(p=>p.cyclePos()>=e&&p.cyclePos()<=t)),u.filterWhen(p=>p.cyclePos()<e||p.cyclePos()>t)));Pattern$1.prototype.stepJoin=function(){const e=this,t=stepcat(..._retime(_slices(e.queryArc(0,1))))._steps,o=function(u){const f=e.early(u.span.begin.sam()).query(u.setSpan(new TimeSpan(Fraction(0),Fraction(1))));return stepcat(..._retime(_slices(f))).query(u)};return new Pattern$1(o,t)},Pattern$1.prototype.stepBind=function(e){return this.fmap(e).stepJoin()};function _retime(e){const t=e.filter((f,b)=>b.hasSteps).reduce((f,b)=>f.add(b),Fraction(0)),o=removeUndefineds(e.map((f,b)=>b._steps)).reduce((f,b)=>f.add(b),Fraction(0)),u=t.eq(0)?void 0:o.div(t);function p(f,b){return b._steps===void 0?[f.mulmaybe(u),b]:[b._steps,b]}return e.map(f=>p(...f))}function _slices(e){const t=flatten(e.map(p=>[p.part.begin,p.part.end])),o=uniqsortr([Fraction(0),Fraction(1),...t]);return pairs(o).map(p=>[p[1].sub(p[0]),stack(..._fitslice(new TimeSpan(...p),e).map(f=>f.value.withHap(b=>b.setContext(b.combineContext(f)))))])}function _fitslice(e,t){return removeUndefineds(t.map(o=>_match(e,o)))}function _match(e,t){const o=e.intersection(t.part);if(o!=null)return new Hap(t.whole,o,t.value,t.context)}const pace=register("pace",function(e,t){return t._steps===void 0?t:t._steps.eq(Fraction(0))?nothing:t._fast(Fraction(e).div(t._steps)).setSteps(e)});function _polymeterListSteps(e,...t){const o=t.map(p=>_sequenceCount(p));if(o.length==0)return silence;e==0&&(e=o[0][1]);const u=[];for(const p of o)p[1]!=0&&(e==p[1]?u.push(p[0]):u.push(p[0]._fast(Fraction(e).div(Fraction(p[1])))));return stack(...u)}function polymeter(...e){if(Array.isArray(e[0]))return _polymeterListSteps(0,...e);if(e=e.filter(u=>u.hasSteps),e.length==0)return silence;const t=lcm(...e.map(u=>u._steps));if(t.eq(Fraction(0)))return nothing;const o=stack(...e.map(u=>u.pace(t)));return o._steps=t,o}function stepcat(...e){if(e.length===0)return nothing;const t=b=>Array.isArray(b)?b:[b._steps??1,b];if(e=e.map(t),e.find(b=>b[0]===void 0)){const b=e.map(F=>F[0]).filter(F=>F!==void 0);if(b.length===0)return fastcat(...e.map(F=>F[1]));if(b.length===e.length)return nothing;const M=b.reduce((F,S)=>F.add(S),Fraction(0)).div(b.length);for(let F of e)F[0]===void 0&&(F[0]=M)}if(e.length==1)return reify(e[0][1]).withSteps(M=>e[0][0]);const o=e.map(b=>b[0]).reduce((b,M)=>b.add(M),Fraction(0));let u=Fraction(0);const p=[];for(const[b,M]of e){if(Fraction(b).eq(0))continue;const F=u.add(b);p.push(reify(M)._compress(u.div(o),F.div(o))),u=F}const f=stack(...p);return f._steps=o,f}function stepalt(...e){e=e.map(p=>Array.isArray(p)?p.map(reify):[reify(p)]);const t=lcm(...e.map(p=>Fraction(p.length)));let o=[];for(let p=0;p<t;++p)o.push(...e.map(f=>f.length==0?silence:f[p%f.length]));o=o.filter(p=>p.hasSteps&&p._steps>0);const u=o.reduce((p,f)=>p.add(f._steps),Fraction(0));return o=stepcat(...o),o._steps=u,o}const take=stepRegister("take",function(e,t){if(!t.hasSteps||t._steps.lte(0)||(e=Fraction(e),e.eq(0)))return nothing;const o=e<0;o&&(e=e.abs());const u=e.div(t._steps);return u.lte(0)?nothing:u.gte(1)?t:o?t.zoom(Fraction(1).sub(u),1):t.zoom(0,u)}),drop=stepRegister("drop",function(e,t){return t.hasSteps?(e=Fraction(e),e.lt(0)?t.take(t._steps.add(e)):t.take(Fraction(0).sub(t._steps.sub(e)))):nothing}),extend=stepRegister("extend",function(e,t){return t.fast(e).expand(e)}),replicate=stepRegister("replicate",function(e,t){return t.repeatCycles(e).fast(e).expand(e)}),expand=stepRegister("expand",function(e,t){return t.withSteps(o=>o.mul(Fraction(e)))}),contract=stepRegister("contract",function(e,t){return t.withSteps(o=>o.div(Fraction(e)))});Pattern$1.prototype.shrinklist=function(e){const t=this;if(!t.hasSteps)return[t];let[o,u]=Array.isArray(e)?e:[e,t._steps];if(o=Fraction(o),u===0||o===0)return[t];const p=o>0,f=[];if(p){const b=Fraction(1).div(t._steps).mul(o);for(let M=0;M<u;++M){const F=b.mul(M);if(F.gt(1))break;f.push([F,1])}}else{o=Fraction(0).sub(o);const b=Fraction(1).div(t._steps).mul(o);for(let M=0;M<u;++M){const F=Fraction(1).sub(b.mul(M));if(F.lt(0))break;f.push([Fraction(0),F])}}return f.map(b=>t.zoom(...b))};const shrinklist=(e,t)=>t.shrinklist(e),shrink=register("shrink",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(e),u=stepcat(...o);return u._steps=o.reduce((p,f)=>p.add(f._steps),Fraction(0)),u},!0,!1,e=>e.stepJoin()),grow=register("grow",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(Fraction(0).sub(e));o.reverse();const u=stepcat(...o);return u._steps=o.reduce((p,f)=>p.add(f._steps),Fraction(0)),u},!0,!1,e=>e.stepJoin()),tour=function(e,...t){return e.tour(...t)};Pattern$1.prototype.tour=function(...e){return stepcat(...[].concat(...e.map((t,o)=>[...e.slice(0,e.length-o),this,...e.slice(e.length-o)]),this,...e))};const zip=function(...e){e=e.filter(u=>u.hasSteps);const t=slowcat(...e.map(u=>u._slow(u._steps))),o=lcm(...e.map(u=>u._steps));return t._fast(o).setSteps(o)},timecat=stepcat,timeCat=stepcat,s_cat=stepcat,s_alt=stepalt,s_polymeter=polymeter;Pattern$1.prototype.s_polymeter=Pattern$1.prototype.polymeter;const s_taper=shrink;Pattern$1.prototype.s_taper=Pattern$1.prototype.shrink;const s_taperlist=shrinklist;Pattern$1.prototype.s_taperlist=Pattern$1.prototype.shrinklist;const s_add=take;Pattern$1.prototype.s_add=Pattern$1.prototype.take;const s_sub=drop;Pattern$1.prototype.s_sub=Pattern$1.prototype.drop;const s_expand=expand;Pattern$1.prototype.s_expand=Pattern$1.prototype.expand;const s_extend=extend;Pattern$1.prototype.s_extend=Pattern$1.prototype.extend;const s_contract=contract;Pattern$1.prototype.s_contract=Pattern$1.prototype.contract;const s_tour=tour;Pattern$1.prototype.s_tour=Pattern$1.prototype.tour;const s_zip=zip;Pattern$1.prototype.s_zip=Pattern$1.prototype.zip;const steps$2=pace;Pattern$1.prototype.steps=Pattern$1.prototype.pace;const chop=register("chop",function(e,t){const u=Array.from({length:e},(b,M)=>M).map(b=>({begin:b/e,end:(b+1)/e})),p=function(b,M){if("begin"in b&&"end"in b&&b.begin!==void 0&&b.end!==void 0){const F=b.end-b.begin;M={begin:b.begin+M.begin*F,end:b.begin+M.end*F}}return Object.assign({},b,M)},f=function(b){return sequence(u.map(M=>p(b,M)))};return t.squeezeBind(f).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),striate=register("striate",function(e,t){const u=Array.from({length:e},(f,b)=>b).map(f=>({begin:f/e,end:(f+1)/e})),p=slowcat(...u);return t.set(p)._fast(e).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),_loopAt=function(e,t,o=.5){return t.speed(1/e*o).unit("c").slow(e)},slice=register("slice",function(e,t,o){return e.innerBind(u=>t.outerBind(p=>o.outerBind(f=>{f=f instanceof Object?f:{s:f};const b=Array.isArray(u)?u[p]:p/u,M=Array.isArray(u)?u[p+1]:(p+1)/u;return pure({begin:b,end:M,_slices:u,...f})}))).setSteps(t._steps)},!1);Pattern$1.prototype.onTriggerTime=function(e){return this.onTrigger((t,o,u,p)=>{const f=p-o;window.setTimeout(()=>{e(t)},f*1e3)},!1)};const splice=register("splice",function(e,t,o){const u=slice(e,t,o);return new Pattern$1(p=>{const f=p.controls._cps||1;return u.query(p).map(M=>M.withValue(F=>({speed:f/F._slices/M.whole.duration*(F.speed||1),unit:"c",...F})))}).setSteps(t._steps)},!1),{loopAt,loopat}=register(["loopAt","loopat"],function(e,t){const o=t._steps?t._steps.div(e):void 0;return new Pattern$1(u=>_loopAt(e,t,u.controls._cps).query(u),o)}),fit=register("fit",e=>e.withHaps((t,o)=>t.map(u=>u.withValue(p=>{const f=("end"in p?p.end:1)-("begin"in p?p.begin:0);return{...p,speed:(o.controls._cps||1)/u.whole.duration*f,unit:"c"}})))),{loopAtCps,loopatcps}=register(["loopAtCps","loopatcps"],function(e,t,o){return _loopAt(e,o,t)}),ref$1=e=>pure(1).withValue(()=>reify(e())).innerJoin();let fadeGain=e=>e<.5?1:1-(e-.5)/.5,xfade=(e,t,o)=>{t=reify(t),e=reify(e),o=reify(o);let u=t.fmap(f=>({gain:fadeGain(f)})),p=t.fmap(f=>({gain:fadeGain(1-f)}));return stack(e.mul(u),o.mul(p))};Pattern$1.prototype.xfade=function(e,t){return xfade(this,e,t)};const __beat=e=>(t,o,u)=>{t=Fraction(t).mod(o),o=Fraction(o);const p=t.div(o),f=t.add(1).div(o);return e(u.fmap(b=>pure(b)._compress(p,f)))},{beat}=register(["beat"],__beat(e=>e.innerJoin())),_morph=(e,t,o)=>{o=Fraction(o);const u=Fraction(1).div(e.length),p=M=>{const F=[];for(const[S,k]of M.entries())k&&F.push([Fraction(S).div(M.length),k]);return F},f=zipWith(([M,F],[S,k])=>{const N=o.mul(S-M).add(M),$=N.add(u);return new TimeSpan(N,$)},p(e),p(t));function b(M){const F=M.span.begin.sam(),S=M.span.cycleArc(),k=[];for(const N of f){const $=N.intersection(S);$!==void 0&&k.push(new Hap(N.withTime(R=>R.add(F)),$.withTime(R=>R.add(F)),!0))}return k}return new Pattern$1(b).splitQueries()},morph=(e,t,o)=>(e=reify(e),t=reify(t),o=reify(o),e.innerBind(u=>t.innerBind(p=>o.innerBind(f=>_morph(u,p,f))))),distAlgoNames=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const e of distAlgoNames)Pattern$1.prototype[e]=function(t){const o=reify(t).fmap(u=>Array.isArray(u)?[...u,e]:[u,1,e]);return this.distort(o)};const parray=e=>{let o=pure(curry((...u)=>u,null,e.length));for(const u of e)o=o.appBoth(reify(u));return o},_ensureListPattern=e=>Array.isArray(e)?parray(e):reify(e);Pattern$1.prototype.partials=function(e){return this.withValue(t=>o=>({...t,partials:o})).appLeft(_ensureListPattern(e))};const partials=e=>_ensureListPattern(e).as("partials");Pattern$1.prototype.phases=function(e){return this.withValue(t=>o=>({...t,phases:o})).appLeft(_ensureListPattern(e))};const phases=e=>_ensureListPattern(e).as("phases");function createParam(e){let t=Array.isArray(e);e=t?e:[e];const o=e[0],u=f=>{let b;if(typeof f=="object"&&f.value!==void 0&&(b={...f},f=f.value,delete b.value),t&&Array.isArray(f)){const M=b||{};return f.forEach((F,S)=>{S<e.length&&(M[e[S]]=F)}),M}else return b?(b[o]=f,b):{[o]:f}},p=function(f,b){return b?typeof f>"u"?b.fmap(u):b.set(reify(f).withValue(u)):reify(f).withValue(u)};return Pattern$1.prototype[o]=function(f){return p(f,this)},p}const controlAlias=new Map;function isControlName(e){return controlAlias.has(e)}function registerControl(e,...t){const o=Array.isArray(e)?e[0]:e;let u={};return u[o]=createParam(e),controlAlias.set(o,o),t.forEach(p=>{u[p]=u[o],controlAlias.set(p,o),Pattern$1.prototype[p]=Pattern$1.prototype[o]}),u}const{s,sound}=registerControl(["s","n","gain"],"sound"),{wt,wavetablePosition}=registerControl("wt","wavetablePosition"),{wtenv}=registerControl("wtenv"),{wtattack,wtatt}=registerControl("wtattack","wtatt"),{wtdecay,wtdec}=registerControl("wtdecay","wtdec"),{wtsustain,wtsus}=registerControl("wtsustain","wtsus"),{wtrelease,wtrel}=registerControl("wtrelease","wtrel"),{wtrate}=registerControl("wtrate"),{wtsync}=registerControl("wtsync"),{wtdepth}=registerControl("wtdepth"),{wtshape}=registerControl("wtshape"),{wtdc}=registerControl("wtdc"),{wtskew}=registerControl("wtskew"),{warp,wavetableWarp}=registerControl("warp","wavetableWarp"),{warpattack,warpatt}=registerControl("warpattack","warpatt"),{warpdecay,warpdec}=registerControl("warpdecay","warpdec"),{warpsustain,warpsus}=registerControl("warpsustain","warpsus"),{warprelease,warprel}=registerControl("warprelease","warprel"),{warprate}=registerControl("warprate"),{warpdepth}=registerControl("warpdepth"),{warpshape}=registerControl("warpshape"),{warpdc}=registerControl("warpdc"),{warpskew}=registerControl("warpskew"),{warpmode,wavetableWarpMode}=registerControl("warpmode","wavetableWarpMode"),{wtphaserand,wavetablePhaseRand}=registerControl("wtphaserand","wavetablePhaseRand"),{warpenv}=registerControl("warpenv"),{warpsync}=registerControl("warpsync"),{source,src}=registerControl("source","src"),{n}=registerControl("n"),{note:note$2}=registerControl(["note","n"]),{accelerate}=registerControl("accelerate"),{velocity}=registerControl("velocity"),{gain}=registerControl("gain"),{postgain}=registerControl("postgain"),{amp}=registerControl("amp"),{attack,att}=registerControl("attack","att"),{fmh}=registerControl(["fmh","fmi"],"fmh"),{fmi,fm:fm$1}=registerControl(["fmi","fmh"],"fm"),{fmenv}=registerControl("fmenv"),{fmattack}=registerControl("fmattack"),{fmwave}=registerControl("fmwave"),{fmdecay}=registerControl("fmdecay"),{fmsustain}=registerControl("fmsustain"),{fmrelease}=registerControl("fmrelease"),{fmvelocity}=registerControl("fmvelocity"),{bank}=registerControl("bank"),{chorus}=registerControl("chorus"),{analyze}=registerControl("analyze"),{fft}=registerControl("fft"),{decay,dec}=registerControl("decay","dec"),{sustain,sus}=registerControl("sustain","sus"),{release,rel}=registerControl("release","rel"),{hold}=registerControl("hold"),{bandf,bpf,bp}=registerControl(["bandf","bandq","bpenv"],"bpf","bp"),{bandq,bpq}=registerControl("bandq","bpq"),{begin}=registerControl("begin"),{end}=registerControl("end"),{loop}=registerControl("loop"),{loopBegin,loopb}=registerControl("loopBegin","loopb"),{loopEnd,loope}=registerControl("loopEnd","loope"),{crush}=registerControl("crush"),{coarse}=registerControl("coarse"),{tremolo}=registerControl(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync}=registerControl(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth}=registerControl("tremolodepth","tremdepth"),{tremoloskew}=registerControl("tremoloskew","tremskew"),{tremolophase}=registerControl("tremolophase","tremphase"),{tremoloshape}=registerControl("tremoloshape","tremshape"),{drive}=registerControl("drive"),{duck}=registerControl("duckorbit","duck"),{duckdepth}=registerControl("duckdepth"),{duckonset}=registerControl("duckonset","duckons"),{duckattack}=registerControl("duckattack","duckatt"),{byteBeatExpression,bbexpr}=registerControl("byteBeatExpression","bbexpr"),{byteBeatStartTime,bbst}=registerControl("byteBeatStartTime","bbst"),{channels,ch}=registerControl("channels","ch"),{pw}=registerControl(["pw","pwrate","pwsweep"]),{pwrate}=registerControl("pwrate"),{pwsweep}=registerControl("pwsweep"),{phaserrate,ph,phaser}=registerControl(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep,phs}=registerControl("phasersweep","phs"),{phasercenter,phc}=registerControl("phasercenter","phc"),{phaserdepth,phd,phasdp}=registerControl("phaserdepth","phd","phasdp"),{channel}=registerControl("channel"),{cut}=registerControl("cut"),{cutoff,ctf,lpf,lp}=registerControl(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv,lpe}=registerControl("lpenv","lpe"),{hpenv,hpe}=registerControl("hpenv","hpe"),{bpenv,bpe}=registerControl("bpenv","bpe"),{lpattack,lpa}=registerControl("lpattack","lpa"),{hpattack,hpa}=registerControl("hpattack","hpa"),{bpattack,bpa}=registerControl("bpattack","bpa"),{lpdecay,lpd}=registerControl("lpdecay","lpd"),{hpdecay,hpd}=registerControl("hpdecay","hpd"),{bpdecay,bpd}=registerControl("bpdecay","bpd"),{lpsustain,lps}=registerControl("lpsustain","lps"),{hpsustain,hps}=registerControl("hpsustain","hps"),{bpsustain,bps}=registerControl("bpsustain","bps"),{lprelease,lpr}=registerControl("lprelease","lpr"),{hprelease,hpr}=registerControl("hprelease","hpr"),{bprelease,bpr}=registerControl("bprelease","bpr"),{ftype}=registerControl("ftype"),{fanchor}=registerControl("fanchor"),{lprate}=registerControl("lprate"),{lpsync}=registerControl("lpsync"),{lpdepth}=registerControl("lpdepth"),{lpdepthfrequency}=registerControl("lpdepthfrequency","lpdepthfreq"),{lpshape}=registerControl("lpshape"),{lpdc}=registerControl("lpdc"),{lpskew}=registerControl("lpskew"),{bprate}=registerControl("bprate"),{bpsync}=registerControl("bpsync"),{bpdepth}=registerControl("bpdepth"),{bpdepthfrequency}=registerControl("bpdepthfrequency","bpdepthfreq"),{bpshape}=registerControl("bpshape"),{bpdc}=registerControl("bpdc"),{bpskew}=registerControl("bpskew"),{hprate}=registerControl("hprate"),{hpsync}=registerControl("hpsync"),{hpdepth,hpdepthfreq}=registerControl("hpdepth"),{hpdepthfrequency}=registerControl("hpdepthfrequency","hpdepthfreq"),{hpshape}=registerControl("hpshape"),{hpdc}=registerControl("hpdc"),{hpskew}=registerControl("hpskew"),{vib,vibrato,v}=registerControl(["vib","vibmod"],"vibrato","v"),{noise}=registerControl("noise"),{vibmod,vmod}=registerControl(["vibmod","vib"],"vmod"),{hcutoff,hpf,hp}=registerControl(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance,hpq}=registerControl("hresonance","hpq"),{resonance,lpq}=registerControl("resonance","lpq"),{djf}=registerControl("djf"),{delay}=registerControl(["delay","delaytime","delayfeedback"]),{delayfeedback,delayfb,dfb}=registerControl("delayfeedback","delayfb","dfb"),{delayspeed}=registerControl("delayspeed"),{delaytime,delayt,dt}=registerControl("delaytime","delayt","dt"),{delaysync}=registerControl("delaysync"),{lock}=registerControl("lock"),{detune,det}=registerControl("detune","det"),{unison}=registerControl("unison"),{spread}=registerControl("spread"),{dry}=registerControl("dry"),{fadeTime,fadeOutTime}=registerControl("fadeTime","fadeOutTime"),{fadeInTime}=registerControl("fadeInTime"),{freq:freq$1}=registerControl("freq"),{pattack,patt}=registerControl("pattack","patt"),{pdecay,pdec}=registerControl("pdecay","pdec"),{psustain,psus}=registerControl("psustain","psus"),{prelease,prel}=registerControl("prelease","prel"),{penv}=registerControl("penv"),{pcurve}=registerControl("pcurve"),{panchor}=registerControl("panchor"),{gate,gat}=registerControl("gate","gat"),{leslie}=registerControl("leslie"),{lrate}=registerControl("lrate"),{lsize}=registerControl("lsize"),{activeLabel}=registerControl("activeLabel"),{label}=registerControl(["label","activeLabel"]),{degree}=registerControl("degree"),{mtranspose}=registerControl("mtranspose"),{ctranspose}=registerControl("ctranspose"),{harmonic}=registerControl("harmonic"),{stepsPerOctave}=registerControl("stepsPerOctave"),{octaveR}=registerControl("octaveR"),{nudge}=registerControl("nudge"),{octave:octave$1,oct}=registerControl("octave","oct"),{orbit}=registerControl("orbit","o"),{overgain}=registerControl("overgain"),{overshape}=registerControl("overshape"),{pan}=registerControl("pan"),{panspan}=registerControl("panspan"),{pansplay}=registerControl("pansplay"),{panwidth}=registerControl("panwidth"),{panorient}=registerControl("panorient"),{rate}=registerControl("rate"),{slide}=registerControl("slide"),{semitone}=registerControl("semitone"),{voice}=registerControl("voice"),{chord:chord$1}=registerControl("chord"),{dictionary:dictionary$5,dict}=registerControl("dictionary","dict"),{anchor}=registerControl("anchor"),{offset}=registerControl("offset"),{octaves}=registerControl("octaves"),{mode:mode$1}=registerControl(["mode","anchor"]),{room}=registerControl(["room","size"]),{roomlp,rlp}=registerControl("roomlp","rlp"),{roomdim,rdim}=registerControl("roomdim","rdim"),{roomfade,rfade}=registerControl("roomfade","rfade"),{ir,iresponse}=registerControl(["ir","i"],"iresponse"),{irspeed}=registerControl("irspeed"),{irbegin}=registerControl("irbegin"),{roomsize,size,sz,rsize}=registerControl("roomsize","size","sz","rsize"),{shape}=registerControl(["shape","shapevol"]),{distort,dist:dist$2}=registerControl(["distort","distortvol","distorttype"],"dist"),{distortvol}=registerControl("distortvol","distvol"),{distorttype}=registerControl("distorttype","disttype"),{compressor}=registerControl(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee}=registerControl("compressorKnee"),{compressorRatio}=registerControl("compressorRatio"),{compressorAttack}=registerControl("compressorAttack"),{compressorRelease}=registerControl("compressorRelease"),{speed}=registerControl("speed"),{stretch}=registerControl("stretch"),{unit}=registerControl("unit"),{squiz}=registerControl("squiz"),{vowel}=registerControl("vowel"),{waveloss}=registerControl("waveloss"),{density}=registerControl("density"),{expression}=registerControl("expression"),{sustainpedal}=registerControl("sustainpedal"),{fshift}=registerControl("fshift"),{fshiftnote}=registerControl("fshiftnote"),{fshiftphase}=registerControl("fshiftphase"),{triode}=registerControl("triode"),{krush}=registerControl("krush"),{kcutoff}=registerControl("kcutoff"),{octer}=registerControl("octer"),{octersub}=registerControl("octersub"),{octersubsub}=registerControl("octersubsub"),{ring}=registerControl("ring"),{ringf}=registerControl("ringf"),{ringdf}=registerControl("ringdf"),{freeze}=registerControl("freeze"),{xsdelay}=registerControl("xsdelay"),{tsdelay}=registerControl("tsdelay"),{real}=registerControl("real"),{imag}=registerControl("imag"),{enhance}=registerControl("enhance"),{comb}=registerControl("comb"),{smear:smear$1}=registerControl("smear"),{scram}=registerControl("scram"),{binshift}=registerControl("binshift"),{hbrick}=registerControl("hbrick"),{lbrick}=registerControl("lbrick"),{frameRate}=registerControl("frameRate"),{frames}=registerControl("frames"),{hours}=registerControl("hours"),{minutes}=registerControl("minutes"),{seconds}=registerControl("seconds"),{songPtr}=registerControl("songPtr"),{uid}=registerControl("uid"),{val}=registerControl("val"),{cps}=registerControl("cps"),{clip,legato}=registerControl("clip","legato"),{duration,dur}=registerControl("duration","dur"),{zrand}=registerControl("zrand"),{curve}=registerControl("curve"),{deltaSlide}=registerControl("deltaSlide"),{pitchJump}=registerControl("pitchJump"),{pitchJumpTime}=registerControl("pitchJumpTime"),{lfo,repeatTime}=registerControl("lfo","repeatTime"),{znoise}=registerControl("znoise"),{zmod}=registerControl("zmod"),{zcrush}=registerControl("zcrush"),{zdelay}=registerControl("zdelay"),{zzfx}=registerControl("zzfx"),{color,colour}=registerControl(["color","colour"]);let createParams=(...e)=>e.reduce((t,o)=>Object.assign(t,{[o]:createParam(o)}),{});const adsr=register("adsr",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u,p,f]=e;return t.set({attack:o,decay:u,sustain:p,release:f})}),ad=register("ad",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=o]=e;return t.attack(o).decay(u)}),ds=register("ds",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=0]=e;return t.set({decay:o,sustain:u})}),ar=register("ar",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=o]=e;return t.set({attack:o,release:u})}),{midichan}=registerControl("midichan"),{midimap}=registerControl("midimap"),{midiport}=registerControl("midiport"),{midicmd}=registerControl("midicmd"),control=register("control",(e,t)=>{if(!Array.isArray(e))throw new Error("control expects an array of [ccn, ccv]");const[o,u]=e;return t.ccn(o).ccv(u)}),{ccn}=registerControl("ccn"),{ccv}=registerControl("ccv"),{ctlNum}=registerControl("ctlNum"),{nrpnn}=registerControl("nrpnn"),{nrpv}=registerControl("nrpv"),{progNum}=registerControl("progNum"),sysex=register("sysex",(e,t)=>{if(!Array.isArray(e))throw new Error("sysex expects an array of [id, data]");const[o,u]=e;return t.sysexid(o).sysexdata(u)}),{sysexid}=registerControl("sysexid"),{sysexdata}=registerControl("sysexdata"),{midibend}=registerControl("midibend"),{miditouch}=registerControl("miditouch"),{polyTouch}=registerControl("polyTouch"),{oschost}=registerControl("oschost"),{oscport}=registerControl("oscport"),getControlName=e=>controlAlias.has(e)?controlAlias.get(e):e,as=register("as",(e,t)=>(e=Array.isArray(e)?e:[e],t.fmap(o=>(o=Array.isArray(o)?o:[o],o=Object.fromEntries(e.map((u,p)=>[getControlName(u),o[p]])),o)))),scrub=register("scrub",(e,t)=>e.outerBind(o=>{Array.isArray(o)||(o=[o]);const[u,p=1]=o;return t.begin(u).mul(speed(p)).clip(1)}),!1),controls=Object.freeze(Object.defineProperty({__proto__:null,accelerate,activeLabel,ad,adsr,amp,analyze,anchor,ar,as,att,attack,bandf,bandq,bank,bbexpr,bbst,begin,binshift,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,byteBeatExpression,byteBeatStartTime,ccn,ccv,ch,channel,channels,chord:chord$1,chorus,clip,coarse,color,colour,comb,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,control,cps,createParam,createParams,crush,ctf,ctlNum,ctranspose,curve,cut,cutoff,dec,decay,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,density,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,djf,drive,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,end,enhance,expression,fadeInTime,fadeOutTime,fadeTime,fanchor,fft,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,frameRate,frames,freeze,freq:freq$1,fshift,fshiftnote,fshiftphase,ftype,gain,gat,gate,getControlName,harmonic,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,imag,ir,irbegin,iresponse,irspeed,isControlName,kcutoff,krush,label,lbrick,legato,leslie,lfo,lock,loop,loopBegin,loopEnd,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mode:mode$1,mtranspose,n,noise,note:note$2,nrpnn,nrpv,nudge,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,offset,orbit,oschost,oscport,overgain,overshape,pan,panchor,panorient,panspan,pansplay,panwidth,patt,pattack,pcurve,pdec,pdecay,penv,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phc,phd,phs,pitchJump,pitchJumpTime,polyTouch,postgain,prel,prelease,progNum,psus,psustain,pw,pwrate,pwsweep,rate,rdim,real,registerControl,rel,release,repeatTime,resonance,rfade,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rsize,s,scram,scrub,seconds,semitone,shape,size,slide,smear:smear$1,songPtr,sound,source,speed,spread,squiz,src,stepsPerOctave,stretch,sus,sustain,sustainpedal,sysex,sysexdata,sysexid,sz,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,triode,tsdelay,uid,unison,unit,v,val,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xsdelay,zcrush,zdelay,zmod,znoise,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),left=function(e,t){const[o,u]=e,[p,f]=t,[b,M]=splitAt(u,p);return[[u,o-u],[zipWith((F,S)=>F.concat(S),b,f),M]]},right=function(e,t){const[o,u]=e,[p,f]=t,[b,M]=splitAt(o,f);return[[o,u-o],[zipWith((S,k)=>S.concat(k),p,b),M]]},_bjorklund=function(e,t){const[o,u]=e;return Math.min(o,u)<=1?[e,t]:_bjorklund(...o>u?left(e,t):right(e,t))},bjorklund=function(e,t){const o=e<0,u=Math.abs(e),p=t-u,f=Array(u).fill([1]),b=Array(p).fill([0]),M=_bjorklund([u,p],[f,b]),F=flatten(M[1][0]).concat(flatten(M[1][1]));return o?F.map(S=>1-S):F},_euclidRot=function(e,t,o){const u=bjorklund(e,t);return o?rotate$2(u,-o):u},euclid=register("euclid",function(e,t,o){return o.struct(_euclidRot(e,t,0))}),bjork=register("bjork",function(e,t){Array.isArray(e)||(e=[e]);const[o,u=o,p=0]=e;return t.struct(_euclidRot(o,u,p))}),{euclidrot,euclidRot}=register(["euclidrot","euclidRot"],function(e,t,o,u){return u.struct(_euclidRot(e,t,o))}),_euclidLegato=function(e,t,o,u){if(e<1)return silence;const f=_euclidRot(e,t,0).join("").split("1").slice(1).map(b=>[b.length+1,!0]);return u.struct(timeCat(...f)).late(Fraction(o).div(t))},euclidLegato=register(["euclidLegato"],function(e,t,o){return _euclidLegato(e,t,0,o)}),euclidLegatoRot=register(["euclidLegatoRot"],function(e,t,o,u){return _euclidLegato(e,t,o,u)}),{euclidish,eish}=register(["euclidish","eish"],function(e,t,o,u){const p=_morph(bjorklund(e,t),new Array(e).fill(1),o);return u.struct(p).setSteps(t)});function createClock(e,t,o=.05,u=.1,p=.1,f=globalThis.setInterval,b=globalThis.clearInterval,M=!0){let F=0,S=0,k=10**4,N=.01;const $=se=>o=se(o);p=p||u/2;const R=()=>{const se=e(),ee=se+u+p;for(S===0&&(S=se+N);S<ee;)S=M?Math.round(S*k)/k:S,t(S,o,F,se),S+=o,F++};let U;const V=()=>{z(),R(),U=f(R,u*1e3)},z=()=>{U!==void 0&&b(U),U=void 0};return{setDuration:$,start:V,stop:()=>{F=0,S=0,z()},pause:()=>z(),duration:o,interval:u,getPhase:()=>S,minLatency:N}}function steady(e){return new Pattern$1(t=>[new Hap(void 0,t.span,e)])}const signal=e=>{const t=o=>[new Hap(void 0,o.span,e(o.span.begin))];return new Pattern$1(t)},saw=signal(e=>e%1),saw2=saw.toBipolar(),isaw=signal(e=>1-e%1),isaw2=isaw.toBipolar(),sine2=signal(e=>Math.sin(Math.PI*2*e)),sine=sine2.fromBipolar(),cosine=sine._early(Fraction(1).div(4)),cosine2=sine2._early(Fraction(1).div(4)),square=signal(e=>Math.floor(e*2%2)),square2=square.toBipolar(),tri=fastcat(saw,isaw),tri2=fastcat(saw2,isaw2),itri=fastcat(isaw,saw),itri2=fastcat(isaw2,saw2),time$1=signal(id);let _mouseY=0,_mouseX=0;typeof window<"u"&&document.addEventListener("mousemove",e=>{_mouseY=e.clientY/document.body.clientHeight,_mouseX=e.clientX/document.body.clientWidth});const mousey=signal(()=>_mouseY),mouseY=signal(()=>_mouseY),mousex=signal(()=>_mouseX),mouseX=signal(()=>_mouseX),xorwise=e=>{const t=e<<13^e,o=t>>17^t;return o<<5^o},_frac=e=>e-Math.trunc(e),timeToIntSeed=e=>xorwise(Math.trunc(_frac(e/300)*536870912)),intSeedToRand=e=>e%536870912/536870912,timeToRand=e=>Math.abs(intSeedToRand(timeToIntSeed(e))),timeToRandsPrime=(e,t)=>{const o=[];for(let u=0;u<t;++u)o.push(intSeedToRand(e)),e=xorwise(e);return o},timeToRands=(e,t)=>timeToRandsPrime(timeToIntSeed(e),t),run=e=>saw.range(0,e).round().segment(e),binary=e=>{const t=reify(e).log2(0).floor().add(1);return binaryN(e,t)},binaryN=(e,t=16)=>{t=reify(t);const o=run(t).mul(-1).add(t.sub(1));return reify(e).segment(t).brshift(o).band(pure(1))},binaryL=e=>{const t=reify(e).log2(0).floor().add(1);return binaryNL(e,t)},binaryNL=(e,t=16)=>reify(e).withValue(o=>u=>{const p=[];for(let f=u-1;f>=0;f--)p.push(o>>f&1);return p}).appLeft(reify(t)),randL=e=>signal(t=>o=>timeToRands(t,o).map(Math.abs)).appLeft(reify(e)),randrun=e=>signal(t=>{const u=timeToRands(t.floor().add(.5),e).map((f,b)=>[f,b]).sort((f,b)=>(f[0]>b[0])-(f[0]<b[0])).map(f=>f[1]),p=t.cyclePos().mul(e).floor()%e;return u[p]})._segment(e),_rearrangeWith=(e,t,o)=>{const u=[...Array(t).keys()].map(p=>o.zoom(Fraction(p).div(t),Fraction(p+1).div(t)));return e.fmap(p=>u[p].repeatCycles(t)._fast(t)).innerJoin()},shuffle$2=register("shuffle",(e,t)=>_rearrangeWith(randrun(e),e,t)),scramble=register("scramble",(e,t)=>_rearrangeWith(_irand(e)._segment(e),e,t)),rand=signal(timeToRand),rand2=rand.toBipolar(),_brandBy=e=>rand.fmap(t=>t<e),brandBy=e=>reify(e).fmap(_brandBy).innerJoin(),brand=_brandBy(.5),_irand=e=>rand.fmap(t=>Math.trunc(t*e)),irand=e=>reify(e).fmap(_irand).innerJoin(),__chooseWith=(e,t)=>(t=t.map(reify),t.length==0?silence:e.range(0,t.length).fmap(o=>{const u=Math.min(Math.max(Math.floor(o),0),t.length-1);return t[u]})),chooseWith=(e,t)=>__chooseWith(e,t).outerJoin(),chooseInWith=(e,t)=>__chooseWith(e,t).innerJoin(),choose=(...e)=>chooseWith(rand,e),chooseIn=(...e)=>chooseInWith(rand,e),chooseOut=choose;Pattern$1.prototype.choose=function(...e){return chooseWith(this,e)},Pattern$1.prototype.choose2=function(...e){return chooseWith(this.fromBipolar(),e)};const chooseCycles=(...e)=>chooseInWith(rand.segment(1),e),randcat=chooseCycles,_wchooseWith=function(e,...t){const o=t.map(M=>reify(M[0])),u=[];let p=pure(0);for(const M of t)p=p.add(M[1]),u.push(p);const f=sequenceP(u),b=function(M){const F=p.mul(M);return f.fmap(S=>k=>o[S.findIndex(N=>N>k,S)]).appLeft(F)};return e.bind(b)},wchooseWith=(...e)=>_wchooseWith(...e).outerJoin(),wchoose=(...e)=>wchooseWith(rand,...e),wchooseCycles=(...e)=>_wchooseWith(rand.segment(1),...e).innerJoin(),wrandcat=wchooseCycles;function _perlin(e){let t=Math.floor(e),o=t+1;const u=b=>6*b**5-15*b**4+10*b**3;return(b=>M=>F=>M+u(b)*(F-M))(e-t)(timeToRand(t))(timeToRand(o))}const perlinWith=e=>e.fmap(_perlin);function _berlin(e){const t=Math.floor(e),o=t+1,u=timeToRand(t),p=timeToRand(o)+u,f=(e-t)/(o-t);return((M,F,S)=>M+(F-M)*S)(u,p,f)/2}const berlinWith=e=>e.fmap(_berlin),perlin=perlinWith(time$1.fmap(e=>Number(e))),berlin=berlinWith(time$1.fmap(e=>Number(e))),degradeByWith=register("degradeByWith",(e,t,o)=>o.fmap(u=>p=>u).appLeft(e.filterValues(u=>u>t)),!0,!0),degradeBy=register("degradeBy",function(e,t){return t._degradeByWith(rand,e)},!0,!0),degrade=register("degrade",e=>e._degradeBy(.5),!0,!0),undegradeBy=register("undegradeBy",function(e,t){return t._degradeByWith(rand.fmap(o=>1-o),e)},!0,!0),undegrade=register("undegrade",e=>e._undegradeBy(.5),!0,!0),sometimesBy=register("sometimesBy",function(e,t,o){return reify(e).fmap(u=>stack(o._degradeBy(u),t(o._undegradeBy(1-u)))).innerJoin()}),sometimes=register("sometimes",function(e,t){return t._sometimesBy(.5,e)}),someCyclesBy=register("someCyclesBy",function(e,t,o){return reify(e).fmap(u=>stack(o._degradeByWith(rand._segment(1),u),t(o._degradeByWith(rand.fmap(p=>1-p)._segment(1),1-u)))).innerJoin()}),someCycles=register("someCycles",function(e,t){return t._someCyclesBy(.5,e)}),often=register("often",function(e,t){return t.sometimesBy(.75,e)}),rarely=register("rarely",function(e,t){return t.sometimesBy(.25,e)}),almostNever=register("almostNever",function(e,t){return t.sometimesBy(.1,e)}),almostAlways=register("almostAlways",function(e,t){return t.sometimesBy(.9,e)}),never=register("never",function(e,t){return t}),always=register("always",function(e,t){return e(t)});function _keyDown(e){Array.isArray(e)===!1&&(e=[e]);const t=getCurrentKeyboardState();return e.every(o=>{const u=keyAlias.get(o)??o;return t[u]})}const whenKey=register("whenKey",function(e,t,o){return o.when(_keyDown(e),t)}),keyDown=register("keyDown",function(e){return e.fmap(_keyDown)}),_pick=function(e,t,o=!0){const u=Array.isArray(e),p=Object.keys(e).length;return e=objectMap(e,reify),p===0?silence:t.fmap(f=>{let b=f;return u&&(b=o?Math.round(b)%p:clamp$1(Math.round(b),0,e.length-1)),e[b]})},pick=function(e,t){return Array.isArray(t)&&([t,e]=[e,t]),__pick(e,t)},__pick=register("pick",function(e,t){return _pick(e,t,!1).innerJoin()}),pickmod=register("pickmod",function(e,t){return _pick(e,t,!0).innerJoin()}),pickF=register("pickF",function(e,t,o){return o.apply(pick(e,t))}),pickmodF=register("pickmodF",function(e,t,o){return o.apply(pickmod(e,t))}),pickOut=register("pickOut",function(e,t){return _pick(e,t,!1).outerJoin()}),pickmodOut=register("pickmodOut",function(e,t){return _pick(e,t,!0).outerJoin()}),pickRestart=register("pickRestart",function(e,t){return _pick(e,t,!1).restartJoin()}),pickmodRestart=register("pickmodRestart",function(e,t){return _pick(e,t,!0).restartJoin()}),pickReset=register("pickReset",function(e,t){return _pick(e,t,!1).resetJoin()}),pickmodReset=register("pickmodReset",function(e,t){return _pick(e,t,!0).resetJoin()}),{inhabit,pickSqueeze}=register(["inhabit","pickSqueeze"],function(e,t){return _pick(e,t,!1).squeezeJoin()}),{inhabitmod,pickmodSqueeze}=register(["inhabitmod","pickmodSqueeze"],function(e,t){return _pick(e,t,!0).squeezeJoin()}),squeeze=(e,t)=>(t=t.map(reify),t.length==0?silence:e.fmap(o=>{const u=_mod$2(Math.round(o),t.length);return t[u]}).squeezeJoin());let synth;try{synth=window?.speechSynthesis}catch(e){console.warn("cannot use window: not in browser?")}let allVoices=synth?.getVoices();function triggerSpeech(e,t,o){synth.cancel();const u=new SpeechSynthesisUtterance(e);u.lang=t,allVoices=synth.getVoices();const p=allVoices.filter(f=>f.lang.includes(t));typeof o=="number"?u.voice=p[o%p.length]:typeof o=="string"&&(u.voice=p.find(f=>f.name===f)),speechSynthesis.speak(u)}const speak=register("speak",function(e,t,o){return o.onTrigger(u=>{triggerSpeech(u.value,e,t)})}),strudelScope={},evalScope$1=async(...e)=>{const t=await Promise.allSettled(e),o=t.filter(u=>u.status==="fulfilled").map(u=>u.value);return t.forEach((u,p)=>{u.status==="rejected"&&console.warn(`evalScope: module with index ${p} could not be loaded:`,u.reason)}),o.forEach(u=>{Object.entries(u).forEach(([p,f])=>{globalThis[p]=f,strudelScope[p]=f})}),o};function safeEval(e,t={}){const{wrapExpression:o=!0,wrapAsync:u=!0}=t;o&&(e=`{${e}}`),u&&(e=`(async ()=>${e})()`);const p=`"use strict";return (${e})`;return Function(p)()}const evaluate$1=async(e,t,o)=>{let u={};if(t){const b=t(e,o);e=b.output,u=b}return{mode:"javascript",pattern:await safeEval(e,{wrapExpression:!!t}),meta:u}},jsContent=`(function(){"use strict";function L(){return performance.now()*.001}let _=0,r=0,o=.5;const h=new Map,m=.1,M=new BroadcastChannel("strudeltick"),b=(s,e)=>{M.postMessage({type:s,payload:e})},C=E(L,(s,e,t,n)=>{const i=r*e,d=s-n,c=n+d,u=i*o,l=_+u,g=n-c-e,f=e*o,p=l+f,y=l+g*o;b("tick",{begin:l,end:p,cps:o,time:n,cycle:y}),r++},m);let k=!1;const I=s=>{h.set(s,{started:!0}),!k&&(C.start(),k=!0)},A=async s=>{h.set(s,{started:!1});const e=Array.from(h.values()).some(t=>t.started);!k||e||(C.stop(),w(0),k=!1)},w=s=>{r=0,_=s},D=s=>{const{type:e,payload:t}=s;switch(e){case"cpschange":{if(t.cps!==o){const n=r*m;_=_+n*o,o=t.cps,r=0}break}case"setcycle":{w(t.cycle);break}case"toggle":{t.started?I(s.id):A(s.id);break}}};self.onconnect=function(s){const e=s.ports[0];e.addEventListener("message",function(t){D(t.data)}),e.start()};function E(s,e,t=.05,n=.1,i=.1){let d=0,c=0,u=10**4,l=.01;const g=a=>t=a(t);i=i||n/2;const f=()=>{const a=s(),O=a+n+i;for(c===0&&(c=a+l);c<O;)c=Math.round(c*u)/u,c>=a&&e(c,t,d,a),c<a&&console.log("TOO LATE",c),c+=t,d++};let p;const y=()=>{T(),f(),p=setInterval(f,n*1e3)},T=()=>p!==void 0&&clearInterval(p);return{setDuration:g,start:y,stop:()=>{d=0,c=0,T()},pause:()=>T(),duration:t,interval:n,getPhase:()=>c,minLatency:l}}})();
`,blob=typeof self<"u"&&self.Blob&&new Blob(["(self.URL || self.webkitURL).revokeObjectURL(self.location.href);",jsContent],{type:"text/javascript;charset=utf-8"});function WorkerWrapper(e){let t;try{if(t=blob&&(self.URL||self.webkitURL).createObjectURL(blob),!t)throw"";const o=new Worker(t,{name:e?.name});return o.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),o}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(jsContent),{name:e?.name})}}class NeoCyclist{constructor({onTrigger:t,onToggle:o,getTime:u}){this.started=!1,this.cps=.5,this.getTime=u,this.time_at_last_tick_message=0,this.collator=new ClockCollator({getTargetClockTime:u}),this.onToggle=o,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(WorkerWrapper),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const p=b=>{const{cps:M,begin:F,end:S,cycle:k,time:N}=b;this.cps=M,this.cycle=k;const $=this.collator.calculateOffset(N)+N;f(F,S,$),this.time_at_last_tick_message=$},f=(b,M,F)=>{if(this.started===!1)return;this.pattern.queryArc(b,M,{_cps:this.cps,cyclist:"neocyclist"}).forEach(k=>{if(k.hasOnset()){const $=cycleToSeconds$1(k.whole.begin-this.cycle,this.cps)+F+this.latency,R=cycleToSeconds$1(k.duration,this.cps);t?.(k,0,R,this.cps,$)}})};this.channel.onmessage=b=>{if(!this.started)return;const{payload:M,type:F}=b.data;switch(F){case"tick":p(M)}}}sendMessage(t,o){this.worker.port.postMessage({type:t,payload:o,id:this.id})}now(){const t=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+t}setCps(t=1){this.sendMessage("cpschange",{cps:t})}setCycle(t){this.sendMessage("setcycle",{cycle:t})}setStarted(t){this.sendMessage("toggle",{started:t}),this.started=t,this.onToggle?.(t)}start(){logger$2("[cyclist] start"),this.setStarted(!0)}stop(){logger$2("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(t,o=!1){this.pattern=t,o&&!this.started&&this.start()}log(t,o,u){const p=u.filter(f=>f.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(p.length).fill("I").join("")}`)}}class Cyclist{constructor({interval:t,onTrigger:o,onToggle:u,onError:p,getTime:f,latency:b=.1,setInterval:M,clearInterval:F,beforeStart:S}){this.started=!1,this.beforeStart=S,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=f,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=u,this.latency=b,this.clock=createClock(f,(k,N,$,R)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=k),this.num_ticks_since_cps_change++;const V=this.num_ticks_since_cps_change*N*this.cps;try{const z=this.lastEnd;this.lastBegin=z;const K=this.num_cycles_at_cps_change+V;if(this.lastEnd=K,this.lastTick=k,k<R){console.log("skip query: too late");return}this.pattern.queryArc(z,K,{_cps:this.cps,cyclist:"cyclist"}).forEach(he=>{if(he.hasOnset()){const se=(he.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+b,ee=he.duration/this.cps,pe=se-k;o?.(he,pe,ee,this.cps,se),he.value.cps!==void 0&&this.cps!=he.value.cps&&(this.cps=he.value.cps,this.num_ticks_since_cps_change=0)}})}catch(z){errorLogger$1(z),p?.(z)}},t,.1,.1,M,F)}now(){if(!this.started)return 0;const t=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+t*this.cps}setStarted(t){this.started=t,this.onToggle?.(t)}async start(){if(await this.beforeStart?.(),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");logger$2("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){logger$2("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){logger$2("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(t,o=!1){this.pattern=t,o&&!this.started&&await this.start()}setCps(t=.5){this.cps!==t&&(this.cps=t,this.num_ticks_since_cps_change=0)}log(t,o,u){const p=u.filter(f=>f.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(p.length).fill("I").join("")}`)}}let time;function getTime(){if(!time)throw new Error("no time set! use setTime to define a time source");return time()}function setTime(e){time=e}function repl$1({defaultOutput:e,onEvalError:t,beforeEval:o,beforeStart:u,afterEval:p,getTime:f,transpiler:b,onToggle:M,editPattern:F,onUpdateState:S,sync:k=!1,setInterval:N,clearInterval:$,id:R,mondo:U=!1}){const V={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},z={id:R},K=Ee=>{Object.assign(V,Ee),V.isDirty=V.code!==V.activeCode,V.error=V.evalError||V.schedulerError,S?.(V)},ie={onTrigger:getTrigger({defaultOutput:e,getTime:f}),getTime:f,onToggle:Ee=>{K({started:Ee}),M?.(Ee)},setInterval:N,clearInterval:$,beforeStart:u},he=k&&typeof SharedWorker<"u"?new NeoCyclist(ie):new Cyclist(ie);let se={},ee=0,pe;const _e=function(){return se={},ee=0,pe=void 0,silence};function ve(Ee){return Ee._Pattern?Ee.__pure:Ee}const we=async(Ee,rt=!0)=>(Ee=F?.(Ee)||Ee,await he.setPattern(Ee,rt),Ee);setTime(()=>he.now());const xe=()=>he.stop(),Oe=()=>he.start(),Pe=()=>he.pause(),Le=()=>he.toggle(),Xe=Ee=>(he.setCps(ve(Ee)),silence),Ke=Ee=>(he.setCps(ve(Ee)/60),silence);let me=[];const ye=function(Ee){return me.push(Ee),silence},Se=function(Ee){return pe=Ee,silence},qe=()=>{Pattern$1.prototype.p=function(rt){return typeof rt=="string"&&(rt.startsWith("_")||rt.endsWith("_"))?silence:(rt.includes("$")&&(rt=`${rt}${ee}`,ee++),se[rt]=this,this)},Pattern$1.prototype.q=function(rt){return silence};try{for(let rt=1;rt<10;++rt)Object.defineProperty(Pattern$1.prototype,`d${rt}`,{get(){return this.p(rt)},configurable:!0}),Object.defineProperty(Pattern$1.prototype,`p${rt}`,{get(){return this.p(rt)},configurable:!0}),Pattern$1.prototype[`q${rt}`]=silence}catch(rt){console.warn("injectPatternMethods: error:",rt)}const Ee=register("cpm",function(rt,St){return St._fast(rt/60/he.cps)});return evalScope$1({all:ye,each:Se,hush:_e,cpm:Ee,setCps:Xe,setcps:Xe,setCpm:Ke,setcpm:Ke})};return{scheduler:he,evaluate:async(Ee,rt=!0,St=!0)=>{if(!Ee)throw new Error("no code to evaluate");try{K({code:Ee,pending:!0}),await qe(),setTime(()=>he.now()),await o?.({code:Ee}),me=[],St&&_e(),U&&(Ee=`mondolang\`${Ee}\``);let{pattern:pt,meta:bt}=await evaluate$1(Ee,b,z);if(Object.keys(se).length){let yt=[],At=!1;for(const[Et,Kt]of Object.entries(se)){const jt=Et.length>1&&Et.startsWith("S");if(jt&&At===!1&&(yt=[],At=!0),!At||At&&jt){const Nt=Kt.withState(_t=>_t.setControls({id:Et}));yt.push(Nt)}}pe&&(yt=yt.map(Et=>pe(Et))),pt=stack(...yt)}else pe&&(pt=pe(pt));if(me.length)for(const yt of me)pt=yt(pt);return isPattern(pt)||(pt=silence),logger$2("[eval] code updated"),pt=await we(pt,rt),K({miniLocations:bt?.miniLocations||[],widgets:bt?.widgets||[],activeCode:Ee,pattern:pt,evalError:void 0,schedulerError:void 0,pending:!1}),p?.({code:Ee,pattern:pt,meta:bt}),pt}catch(pt){logger$2(`[eval] error: ${pt.message}`,"error"),console.error(pt),K({evalError:pt,pending:!1}),t?.(pt)}},start:Oe,stop:xe,pause:Pe,setCps:Xe,setPattern:we,setCode:Ee=>K({code:Ee}),toggle:Le,state:V}}const getTrigger=({getTime:e,defaultOutput:t})=>async(o,u,p,f,b)=>{try{(!o.context.onTrigger||!o.context.dominantTrigger)&&await t(o,u,p,f,b),o.context.onTrigger&&await o.context.onTrigger(o,e(),f,b)}catch(M){errorLogger$1(M,"getTrigger")}},backgroundImage=function(e,t={}){const o=document.getElementById("code"),u="background-image:url("+e+");background-size:contain;";o.style=u;const{className:p}=o,f=(F,S)=>{({style:()=>o.style=u+";"+S,className:()=>o.className=S+" "+p})[F]()},b=Object.entries(t).filter(([F,S])=>typeof S=="function");Object.entries(t).filter(([F,S])=>typeof S=="string").forEach(([F,S])=>f(F,S)),b.length},cleanupUi=()=>{const e=document.getElementById("code");e&&(e.style="")};logger$2("🌀 @strudel/core loaded 🌀"),globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`),globalThis._strudelLoaded=!0;const strudelCore=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator,Cyclist,Fraction,Hap,Pattern:Pattern$1,State,TimeSpan,__chooseWith,_brandBy,_fitslice,_irand,_keyDown,_match,_mod:_mod$2,_morph,_polymeterListSteps,_retime,_slices,accelerate,activeLabel,ad,add:add$7,adsr,almostAlways,almostNever,always,amp,analyze,anchor,and,apply,applyN,ar,arp,arpWith,arrange,as,att,attack,averageArray,backgroundImage,band,bandf,bandq,bank,base64ToUnicode,bbexpr,bbst,beat,begin,berlin,berlinWith,binary,binaryL,binaryN,binaryNL,bind,binshift,bite,bjork,bjorklund,blshift,bor,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,brak,brand,brandBy,brshift,bxor,bypass,byteBeatExpression,byteBeatStartTime,calculateSteps,cat,ccn,ccv,ceil,ch,channel,channels,choose,chooseCycles,chooseIn,chooseInWith,chooseOut,chooseWith,chop,chord:chord$1,chorus,chunk,chunkBack,chunkBackInto,chunkInto,chunkback,chunkbackinto,chunkinto,clamp:clamp$1,cleanupUi,clip,coarse,code2hash,color,colour,comb,compose,compress,compressSpan,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,compressspan,constant,contract,control,controls,cosine,cosine2,cpm,cps,createClock,createParam,createParams,crush,ctf,ctlNum,ctranspose,curry,curve,cut,cutoff,cycleToSeconds:cycleToSeconds$1,dec,decay,degrade,degradeBy,degradeByWith,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,div,djf,drawLine,drive,drop,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,early,echo,echoWith,echowith,eish,end,enhance,eq,eqt,errorLogger:errorLogger$1,euclid,euclidLegato,euclidLegatoRot,euclidRot,euclidish,euclidrot,evalScope:evalScope$1,evaluate:evaluate$1,every,expand,expression,extend,fadeInTime,fadeOutTime,fadeTime,fanchor,fast,fastChunk,fastGap,fastcat,fastchunk,fastgap,fft,filter:filter$1,filterWhen,firstOf,fit,flatten,floor,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,focus,focusSpan,focusspan,fractionalArgs,frameRate,frames,freeze,freq:freq$1,freqToMidi:freqToMidi$2,fromBipolar,fshift,fshiftnote,fshiftphase,ftype,func,gain,gap,gat,gate,getAccidentalsOffset:getAccidentalsOffset$1,getControlName,getCurrentKeyboardState,getEventOffsetMs,getFreq,getFrequency,getPerformanceTimeSeconds,getPlayableNoteValue,getSoundIndex:getSoundIndex$1,getTime,getTrigger,grow,gt,gte,harmonic,hash2code,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,hsl,hsla,hurry,id,imag,inhabit,inhabitmod,innerBind,inside,inv,invert:invert$1,ir,irand,irbegin,iresponse,irspeed,isControlName,isNote,isNoteWithOctave,isPattern,isaw,isaw2,iter,iterBack,iterback,itri,itri2,jux,juxBy,juxby,kcutoff,keep,keepif,keyAlias,keyDown,krush,label,lastOf,late,lbrick,legato,leslie,lfo,linger,listRange,lock,logKey,logger:logger$2,loop,loopAt,loopAtCps,loopBegin,loopEnd,loopat,loopatcps,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,lt,lte,mapArgs,mask,midi2note:midi2note$1,midiToFreq:midiToFreq$2,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mod:mod$3,mode:mode$1,morph,mouseX,mouseY,mousex,mousey,mtranspose,mul,n,nanFallback:nanFallback$1,ne,net,never,noise,note:note$2,noteToMidi:noteToMidi$1,nothing,nrpnn,nrpv,nudge,numeralArgs,objectMap,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,off,offset,often,or,orbit,oschost,oscport,outerBind,outside,overgain,overshape,pace,pairs,palindrome,pan,panchor,panorient,panspan,pansplay,panwidth,parray,parseFractional,parseNumeral,partials,patt,pattack,pcurve,pdec,pdecay,penv,perlin,perlinWith,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phases,phc,phd,phs,pick,pickF,pickOut,pickReset,pickRestart,pickSqueeze,pickmod,pickmodF,pickmodOut,pickmodReset,pickmodRestart,pickmodSqueeze,pipe,pitchJump,pitchJumpTime,ply,plyForEach,plyWith,pm,polyBind,polyTouch,polymeter,polyrhythm,postgain,pow,pr,prel,prelease,press,pressBy,progNum,psus,psustain,pure,pw,pwrate,pwsweep,rand,rand2,randL,randcat,randrun,range:range$2,range2,rangex,rarely,rate,ratio,rdim,real,ref:ref$1,register,registerControl,reify,rel,release,removeUndefineds,repeatCycles,repeatTime,repl:repl$1,replicate,resonance,rev,revv,rfade,rib,ribbon,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rotate:rotate$2,round,rsize,run,s,s_add,s_alt,s_cat,s_contract,s_expand,s_extend,s_polymeter,s_sub,s_taper,s_taperlist,s_tour,s_zip,saw,saw2,scram,scramble,scrub,seconds,seg,segment,semitone,seq,seqPLoop,sequence,sequenceP,set,setStringParser,setTime,shape,shrink,shrinklist,shuffle:shuffle$2,signal,silence,sine,sine2,size,slice,slide,slow,slowChunk,slowcat,slowcatPrime,slowchunk,smear:smear$1,sol2note,someCycles,someCyclesBy,sometimes,sometimesBy,songPtr,sound,source,sparsity,speak,speed,splice,splitAt,spread,square,square2,squeeze,squeezeBind,squiz,src,stack,stackBy,stackCentre,stackLeft,stackRight,steady,stepBind,stepalt,stepcat,steps:steps$2,stepsPerOctave,stretch,striate,stringifyValues,struct,strudelScope,stut,stutWith,stutwith,sub,superimpose,sus,sustain,sustainpedal,swing,swingBy,sysex,sysexdata,sysexid,sz,take,time:time$1,timeCat,timecat,toBipolar,tokenizeNote:tokenizeNote$3,tour,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,tri,tri2,triode,tsdelay,uid,undegrade,undegradeBy,unicodeToBase64,uniq,uniqsort,uniqsortr,unison,unit,v,val,valueToMidi:valueToMidi$1,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wchoose,wchooseCycles,when,whenKey,withValue,within,wrandcat,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xfade,xsdelay,zcrush,zdelay,zip,zipWith,zmod,znoise,zoom,zoomArc,zoomarc,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),randOffset=3e-4,applyOptions=(e,t)=>(o,u)=>{const b=e.source_[u].options_?.ops,M=o.__steps_source;if(b)for(const F of b)switch(F.type_){case"stretch":{const S=["fast","slow"],{type:k,amount:N}=F.arguments_;if(!S.includes(k))throw new Error(`mini: stretch: type must be one of ${S.join("|")} but got ${k}`);o=reify(o)[k](t(N));break}case"replicate":{const{amount:S}=F.arguments_;o=reify(o),o=o._repeatCycles(S)._fast(S);break}case"bjorklund":{F.arguments_.rotation?o=o.euclidRot(t(F.arguments_.pulse),t(F.arguments_.step),t(F.arguments_.rotation)):o=o.euclid(t(F.arguments_.pulse),t(F.arguments_.step));break}case"degradeBy":{o=reify(o)._degradeByWith(rand.early(randOffset*F.arguments_.seed),F.arguments_.amount??.5);break}case"tail":{const S=t(F.arguments_.element);o=o.fmap(k=>N=>Array.isArray(k)?[...k,N]:[k,N]).appLeft(S);break}case"range":{const S=t(F.arguments_.element);o=reify(o);const k=($,R,U=1)=>Array.from({length:Math.abs(R-$)/U+1},(V,z)=>$<R?$+z*U:$-z*U);o=(($,R)=>$.squeezeBind(U=>R.bind(V=>fastcat(...k(U,V)))))(o,S);break}default:console.warn(`operator "${F.type_}" not implemented`)}return o.__steps_source=o.__steps_source||M,o};function patternifyAST(e,t,o,u=0){o?.(e);const p=f=>patternifyAST(f,t,o,u);switch(e.type_){case"pattern":{const f=e.source_.map(S=>p(S)).map(applyOptions(e,p)),b=e.arguments_.alignment,M=f.filter(S=>S.__steps_source);let F;switch(b){case"stack":{F=stack(...f),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"polymeter_slowcat":{F=stack(...f.map(S=>S._slow(S.__weight))),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"polymeter":{const S=e.arguments_.stepsPerCycle?p(e.arguments_.stepsPerCycle).fmap(N=>Fraction(N)):pure(Fraction(f.length>0?f[0].__weight:1)),k=f.map(N=>N.fast(S.fmap($=>$.div(N.__weight))));F=stack(...k);break}case"rand":{F=chooseInWith(rand.early(randOffset*e.arguments_.seed).segment(1),f),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"feet":{F=fastcat(...f);break}default:{if(e.source_.some(k=>!!k.options_?.weight)){const k=e.source_.reduce((N,$)=>N.add($.options_?.weight||Fraction(1)),Fraction(0));F=timeCat(...e.source_.map((N,$)=>[N.options_?.weight||Fraction(1),f[$]])),F.__weight=k,F._steps=k,M.length&&(F._steps=F._steps.mul(lcm(...M.map(N=>Fraction(N._steps)))))}else F=sequence(...f),F._steps=f.length;e.arguments_._steps&&(F.__steps_source=!0)}}return M.length&&(F.__steps_source=!0),F}case"element":return p(e.source_);case"atom":{if(e.source_==="~"||e.source_==="-")return silence;if(!e.location_)return console.warn("no location for",e),e.source_;const f=isNaN(Number(e.source_))?e.source_:Number(e.source_);if(u===-1)return pure(f);const[b,M]=getLeafLocation(t,e,u);return pure(f).withLoc(b,M)}case"stretch":return p(e.source_).slow(p(e.arguments_.amount));default:return console.warn(`node type "${e.type_}" not implemented -> returning silence`),silence}}const getLeafLocation=(e,t,o=0)=>{const{start:u,end:p}=t.location_,f=e?.split("").slice(u.offset,p.offset).join(""),[b=0,M=0]=f?f.split(t.source_).map(F=>F.split("").filter(S=>S===" ").length):[];return[u.offset+b+o,p.offset-M+o]},mini2ast=(e,t=0,o=e)=>{try{return peg$parse(e)}catch(u){const p=[u.location.start.offset+t,u.location.end.offset+t],f=o.slice(0,p[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${f}: ${u.message}`)}},getLeaves=(e,t,o)=>{const u=mini2ast(e,t,o);let p=[];return patternifyAST(u,e,f=>{f.type_==="atom"&&p.push(f)},-1),p},getLeafLocations=(e,t=0,o)=>getLeaves(e,t,o).map(u=>getLeafLocation(e,u,t)),mini=(...e)=>{const t=e.map(o=>{const u=`"${o}"`,p=mini2ast(u);return patternifyAST(p,u)});return sequence(...t)},m$1=(e,t)=>{const o=`"${e}"`,u=mini2ast(o);return patternifyAST(u,o,null,t)},h$1=e=>{const t=mini2ast(e);return patternifyAST(t,e)};function minify(e){return typeof e=="string"?mini(e):reify(e)}function miniAllStrings(){setStringParser(mini)}const strudelMini=Object.freeze(Object.defineProperty({__proto__:null,StartRules:peg$allowedStartRules,SyntaxError:peg$SyntaxError,getLeafLocation,getLeafLocations,getLeaves,h:h$1,m:m$1,mini,mini2ast,miniAllStrings,minify,parse:peg$parse,patternifyAST},Symbol.toStringTag,{value:"Module"}));if(typeof DelayNode<"u"){class e extends DelayNode{constructor(o,u,p,f){super(o),u=Math.abs(u),this.delayTime.value=p;const b=o.createGain();b.gain.value=Math.min(Math.abs(f),.995),this.feedback=b.gain;const M=o.createGain();return M.gain.value=u,this.delayGain=M,this.connect(b),this.connect(M),b.connect(this),this.connect=F=>M.connect(F),this}start(o){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,o+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(t,o,u){return new e(this,t,o,u)}}var reverbGen={};reverbGen.generateReverb=function(e,t){for(var o=e.audioContext||new AudioContext,u=o.sampleRate,p=e.numChannels||2,f=e.decayTime*1.5,b=Math.round(e.decayTime*u),M=Math.round(f*u),F=Math.round((e.fadeInTime||0)*u),S=Math.pow(1/1e3,1/b),k=o.createBuffer(p,M,u),N=0;N<p;N++){for(var $=k.getChannelData(N),R=0;R<M;R++)$[R]=randomSample()*Math.pow(S,R);for(var R=0;R<F;R++)$[R]*=R/F}applyGradualLowpass(k,e.lpFreqStart||0,e.lpFreqEnd||0,e.decayTime,t)},reverbGen.generateGraph=function(e,t,o,u,p){var f=document.createElement("canvas");f.width=t,f.height=o;var b=f.getContext("2d");b.fillStyle="#000",b.fillRect(0,0,f.width,f.height),b.fillStyle="#fff";for(var M=t/e.length,F=o/(p-u),S=0;S<e.length;S++)b.fillRect(S*M,o-(e[S]-u)*F,1,1);return f};var applyGradualLowpass=function(e,t,o,u,p){if(t==0){p(e);return}var f=getAllChannelData(e),b=new OfflineAudioContext(e.numberOfChannels,f[0].length,e.sampleRate),M=b.createBufferSource();M.buffer=e;var F=b.createBiquadFilter();t=Math.min(t,e.sampleRate/2),o=Math.min(o,e.sampleRate/2),F.type="lowpass",F.Q.value=1e-4,F.frequency.setValueAtTime(t,0),F.frequency.linearRampToValueAtTime(o,u),M.connect(F),F.connect(b.destination),M.start(),b.oncomplete=function(S){p(S.renderedBuffer),F.disconnect(),M.disconnect()},b.startRendering(),window.filterNode=F},getAllChannelData=function(e){for(var t=[],o=0;o<e.numberOfChannels;o++)t[o]=e.getChannelData(o);return t},randomSample=function(){return Math.random()*2-1};let log=e=>console.log(e);function errorLogger(e,t="superdough"){process.env.NODE_ENV==="development"&&console.error(e),logger$1(`[${t}] error: ${e.message}`)}const logger$1=(...e)=>log(...e),setLogger=e=>{log=e},tokenizeNote$2=e=>{if(typeof e!="string")return[];const[t,o="",u]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,u?Number(u):void 0]:[]},chromas$1={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$1={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset=e=>e?.split("").reduce((t,o)=>t+accs$1[o],0)||0,noteToMidi=(e,t=3)=>{const[o,u,p=t]=tokenizeNote$2(e);if(!o)throw new Error('not a note: "'+e+'"');const f=chromas$1[o.toLowerCase()],b=getAccidentalsOffset(u);return(Number(p)+1)*12+f+b},midiToFreq$1=e=>Math.pow(2,(e-69)/12)*440,clamp=(e,t,o)=>Math.min(Math.max(e,t),o),freqToMidi$1=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:u}=e;return typeof o=="number"?freqToMidi$1(o):typeof u=="string"?noteToMidi(u):typeof u=="number"?u:t};function nanFallback(e,t=0,o){return isNaN(Number(e))?(!o&&logger$1(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const _mod$1=(e,t)=>(e%t+t)%t,getSoundIndex=(e,t)=>_mod$1(Math.round(nanFallback(e,0)),t);function cycleToSeconds(e,t){return e/t}function getCommonSampleInfo(e,t){const{s:o,n:u=0}=e;let p=valueToMidi(e,36),f=p-36,b,M=0;if(Array.isArray(t))M=getSoundIndex(u,t.length),b=t[M];else{const S=N=>noteToMidi(N)-p,k=Object.keys(t).filter(N=>!N.startsWith("_")).reduce((N,$,R)=>!N||Math.abs(S($))<Math.abs(S(N))?$:N,null);f=-S(k),M=getSoundIndex(u,t[k].length),b=t[k][M]}const F=`${o}:${M}`;return{transpose:f,url:b,index:M,midi:p,label:F}}const pickAndRename=(e,t)=>Object.fromEntries(Object.entries(t).map(([o,u])=>[o,e[u]])),getBaseURL=e=>{try{return new URL(".",new URL(e)).href.replace(/\/$/,"")}catch{return e.split("/").slice(0,-1).join("/")}};typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(e,t,o=1,u=0){const p=Math.floor(clamp(u,0,1)*t.length),f=t.sampleRate*e,b=this.createBuffer(t.numberOfChannels,t.length,t.sampleRate);for(let M=0;M<t.numberOfChannels;M++){let F=t.getChannelData(M),S=b.getChannelData(M);for(let k=0;k<f;k++){let N=(p+k*Math.abs(o))%F.length;o<1&&(N=N*-1),S[k]=F.at(N)||0}}return b},AudioContext.prototype.createReverb=function(e,t,o,u,p,f,b){const M=this.createConvolver();return M.generate=(F=2,S=.1,k=15e3,N=1e3,$,R,U)=>{M.duration=F,M.fade=S,M.lp=k,M.dim=N,M.ir=$,M.irspeed=R,M.irbegin=U,$?M.buffer=this.adjustLength(F,$,R,U):reverbGen.generateReverb({audioContext:this,numChannels:2,decayTime:F,fadeInTime:S,lpFreqStart:k,lpFreqEnd:N},V=>{M.buffer=V})},M.generate(e,t,o,u,p,f,b),M});var vowelFormant={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class e extends GainNode{constructor(o,u){if(super(o),!vowelFormant[u])throw new Error("vowel: unknown vowel "+u);const{gains:p,qs:f,freqs:b}=vowelFormant[u];this.makeupGain=o.createGain(),this.audioNodes=[];for(let M=0;M<5;M++){const F=o.createGain();F.gain.value=p[M];const S=o.createBiquadFilter();S.type="bandpass",S.Q.value=f[M],S.frequency.value=b[M],super.connect(S),S.connect(F),this.audioNodes.push(S),F.connect(this.makeupGain),this.audioNodes.push(F)}return this.makeupGain.gain.value=8,this}connect(o){this.makeupGain.connect(o)}disconnect(){this.makeupGain.disconnect(),this.audioNodes.forEach(o=>o.disconnect()),super.disconnect(),this.makeupGain=null,this.audioNodes=null}}AudioContext.prototype.createVowelFilter=function(t){return new e(this,t)}}const workletsUrl="data:text/javascript;base64,dmFyIF89KGZ1bmN0aW9uKGZ0KXsidXNlIHN0cmljdCI7Y2xhc3Mga3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5zdGFydGVkPSExLHRoaXMubmJJbnB1dHM9dC5udW1iZXJPZklucHV0cyx0aGlzLm5iT3V0cHV0cz10Lm51bWJlck9mT3V0cHV0cyx0aGlzLmJsb2NrU2l6ZT10LnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplLHRoaXMuaG9wU2l6ZT0xMjgsdGhpcy5uYk92ZXJsYXBzPXRoaXMuYmxvY2tTaXplL3RoaXMuaG9wU2l6ZSx0aGlzLmlucHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkPW5ldyBBcnJheSh0aGlzLm5iSW5wdXRzKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iSW5wdXRzO2UrKyl0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhlLDEpO3RoaXMub3V0cHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmU9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTtmb3IobGV0IGU9MDtlPHRoaXMubmJPdXRwdXRzO2UrKyl0aGlzLmFsbG9jYXRlT3V0cHV0Q2hhbm5lbHMoZSwxKX1yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpe2ZvcihsZXQgcz0wO3M8dGhpcy5uYklucHV0cztzKyspe2xldCByPXRbc10ubGVuZ3RoO3IhPXRoaXMuaW5wdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMocyxyKX1mb3IobGV0IHM9MDtzPHRoaXMubmJPdXRwdXRzO3MrKyl7bGV0IHI9ZVtzXS5sZW5ndGg7ciE9dGhpcy5vdXRwdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHMscil9fWFsbG9jYXRlSW5wdXRDaGFubmVscyh0LGUpe3RoaXMuaW5wdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUrMTI4KSx0aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XT1uZXcgQXJyYXkoZSksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW3NdPXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdLnN1YmFycmF5KDAsdGhpcy5ibG9ja1NpemUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpfWFsbG9jYXRlT3V0cHV0Q2hhbm5lbHModCxlKXt0aGlzLm91dHB1dEJ1ZmZlcnNbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW3NdLmZpbGwoMCl9cmVhZElucHV0cyh0KXtpZih0WzBdLmxlbmd0aCYmdFswXVswXS5sZW5ndGg9PTApe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXRoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLmZpbGwoMCx0aGlzLmJsb2NrU2l6ZSk7cmV0dXJufWZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10W2VdW3NdO3RoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLnNldChyLHRoaXMuYmxvY2tTaXplKX19d3JpdGVPdXRwdXRzKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10aGlzLm91dHB1dEJ1ZmZlcnNbZV1bc10uc3ViYXJyYXkoMCwxMjgpO3RbZV1bc10uc2V0KHIpfX1zaGlmdElucHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpfXNoaWZ0T3V0cHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5zdWJhcnJheSh0aGlzLmJsb2NrU2l6ZS0xMjgpLmZpbGwoMCl9cHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW2VdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF1bZV0pfWhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCl7Zm9yKGxldCB0PTA7dDx0aGlzLm5iT3V0cHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLm91dHB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuYmxvY2tTaXplO3MrKyl0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV1bc10rPXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bZV1bc10vdGhpcy5uYk92ZXJsYXBzfXByb2Nlc3ModCxlLHMpe2NvbnN0IGk9dFswXVswXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5zdGFydGVkJiYhaT8hMToodGhpcy5zdGFydGVkPWksdGhpcy5yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpLHRoaXMucmVhZElucHV0cyh0KSx0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCksdGhpcy5wcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCksdGhpcy5wcm9jZXNzT0xBKHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUscyksdGhpcy5oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpLHRoaXMud3JpdGVPdXRwdXRzKGUpLHRoaXMuc2hpZnRPdXRwdXRCdWZmZXJzKCksITApfXByb2Nlc3NPTEEodCxlLHMpe2NvbnNvbGUuYXNzZXJ0KCExLCJOb3Qgb3ZlcnJpZGVuIil9fWNsYXNzIEV0e2NvbnN0cnVjdG9yKHQpe2lmKHRoaXMuc2l6ZT10fDAsdGhpcy5zaXplPD0xfHwodGhpcy5zaXplJnRoaXMuc2l6ZS0xKSE9PTApdGhyb3cgbmV3IEVycm9yKCJGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxIik7dGhpcy5fY3NpemU9dDw8MTtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuc2l6ZSoyKSxzPTA7czxlLmxlbmd0aDtzKz0yKXtjb25zdCBjPU1hdGguUEkqcy90aGlzLnNpemU7ZVtzXT1NYXRoLmNvcyhjKSxlW3MrMV09LU1hdGguc2luKGMpfXRoaXMudGFibGU9ZTtmb3IodmFyIHI9MCxpPTE7dGhpcy5zaXplPmk7aTw8PTEpcisrO3RoaXMuX3dpZHRoPXIlMj09PTA/ci0xOnIsdGhpcy5fYml0cmV2PW5ldyBBcnJheSgxPDx0aGlzLl93aWR0aCk7Zm9yKHZhciBvPTA7bzx0aGlzLl9iaXRyZXYubGVuZ3RoO28rKyl7dGhpcy5fYml0cmV2W29dPTA7Zm9yKHZhciBhPTA7YTx0aGlzLl93aWR0aDthKz0yKXt2YXIgdT10aGlzLl93aWR0aC1hLTI7dGhpcy5fYml0cmV2W29dfD0obz4+PmEmMyk8PHV9fXRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbCx0aGlzLl9pbnY9MH1mcm9tQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fG5ldyBBcnJheSh0Lmxlbmd0aD4+PjEpLHI9MDtyPHQubGVuZ3RoO3IrPTIpc1tyPj4+MV09dFtyXTtyZXR1cm4gc31jcmVhdGVDb21wbGV4QXJyYXkoKXtjb25zdCB0PW5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXT0wO3JldHVybiB0fXRvQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fHRoaXMuY3JlYXRlQ29tcGxleEFycmF5KCkscj0wO3I8cy5sZW5ndGg7cis9MilzW3JdPXRbcj4+PjFdLHNbcisxXT0wO3JldHVybiBzfWNvbXBsZXRlU3BlY3RydW0odCl7Zm9yKHZhciBlPXRoaXMuX2NzaXplLHM9ZT4+PjEscj0yO3I8cztyKz0yKXRbZS1yXT10W3JdLHRbZS1yKzFdPS10W3IrMV19dHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fdHJhbnNmb3JtNCgpLHRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1yZWFsVHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fcmVhbFRyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9aW52ZXJzZVRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0xLHRoaXMuX3RyYW5zZm9ybTQoKTtmb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl0W3NdLz10aGlzLnNpemU7dGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfV90cmFuc2Zvcm00KCl7dmFyIHQ9dGhpcy5fb3V0LGU9dGhpcy5fY3NpemUscz10aGlzLl93aWR0aCxyPTE8PHMsaT1lL3I8PDEsbyxhLHU9dGhpcy5fYml0cmV2O2lmKGk9PT00KWZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgbT11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTIobyxtLHIpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBtPXVbYV07dGhpcy5fc2luZ2xlVHJhbnNmb3JtNChvLG0scil9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+Mjtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgZD1vK2YsbD1vLHA9MDtsPGQ7bCs9MixwKz1yKXtjb25zdCBtPWwsST1tK2YsZz1JK2Ysdj1nK2Ysdz10W21dLFA9dFttKzFdLFM9dFtJXSxWPXRbSSsxXSxNPXRbZ10seD10W2crMV0seT10W3ZdLEE9dFt2KzFdLFc9dyxOPVAsRT1oW3BdLE89YypoW3ArMV0sRj1TKkUtVipPLEQ9UypPK1YqRSxMPWhbMipwXSxDPWMqaFsyKnArMV0sZXQ9TSpMLXgqQyxzdD1NKkMreCpMLHJ0PWhbMypwXSxudD1jKmhbMypwKzFdLGl0PXkqcnQtQSpudCxvdD15Km50K0EqcnQsYXQ9VytldCwkPU4rc3QsRz1XLWV0LGN0PU4tc3QsdXQ9RitpdCxRPUQrb3QsSj1jKihGLWl0KSxodD1jKihELW90KSxsdD1hdCt1dCxidD0kK1EsSXQ9YXQtdXQsX3Q9JC1RLEJ0PUcraHQsd3Q9Y3QtSixUdD1HLWh0LFB0PWN0K0o7dFttXT1sdCx0W20rMV09YnQsdFtJXT1CdCx0W0krMV09d3QsdFtnXT1JdCx0W2crMV09X3QsdFt2XT1UdCx0W3YrMV09UHR9fX1fc2luZ2xlVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZSsxXSx1PWlbZStzXSxjPWlbZStzKzFdLGg9byt1LGY9YStjLGQ9by11LGw9YS1jO3JbdF09aCxyW3QrMV09ZixyW3QrMl09ZCxyW3QrM109bH1fc2luZ2xlVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlKzFdLGY9aVtlK3NdLGQ9aVtlK3MrMV0sbD1pW2UrYV0scD1pW2UrYSsxXSxtPWlbZSt1XSxJPWlbZSt1KzFdLGc9YytsLHY9aCtwLHc9Yy1sLFA9aC1wLFM9ZittLFY9ZCtJLE09byooZi1tKSx4PW8qKGQtSSkseT1nK1MsQT12K1YsVz13K3gsTj1QLU0sRT1nLVMsTz12LVYsRj13LXgsRD1QK007clt0XT15LHJbdCsxXT1BLHJbdCsyXT1XLHJbdCszXT1OLHJbdCs0XT1FLHJbdCs1XT1PLHJbdCs2XT1GLHJbdCs3XT1EfV9yZWFsVHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IE10PXVbYV07dGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIobyxNdD4+PjEscj4+PjEpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBNdD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG8sTXQ+Pj4xLHI+Pj4xKX12YXIgYz10aGlzLl9pbnY/LTE6MSxoPXRoaXMudGFibGU7Zm9yKHI+Pj0yO3I+PTI7cj4+PTIpe2k9ZS9yPDwxO3ZhciBmPWk+Pj4xLGQ9Zj4+PjEsbD1kPj4+MTtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgcD0wLG09MDtwPD1sO3ArPTIsbSs9cil7dmFyIEk9bytwLGc9SStkLHY9ZytkLHc9ditkLFA9dFtJXSxTPXRbSSsxXSxWPXRbZ10sTT10W2crMV0seD10W3ZdLHk9dFt2KzFdLEE9dFt3XSxXPXRbdysxXSxOPVAsRT1TLE89aFttXSxGPWMqaFttKzFdLEQ9VipPLU0qRixMPVYqRitNKk8sQz1oWzIqbV0sZXQ9YypoWzIqbSsxXSxzdD14KkMteSpldCxydD14KmV0K3kqQyxudD1oWzMqbV0saXQ9YypoWzMqbSsxXSxvdD1BKm50LVcqaXQsYXQ9QSppdCtXKm50LCQ9TitzdCxHPUUrcnQsY3Q9Ti1zdCx1dD1FLXJ0LFE9RCtvdCxKPUwrYXQsaHQ9YyooRC1vdCksbHQ9YyooTC1hdCksYnQ9JCtRLEl0PUcrSixfdD1jdCtsdCxCdD11dC1odDtpZih0W0ldPWJ0LHRbSSsxXT1JdCx0W2ddPV90LHRbZysxXT1CdCxwPT09MCl7dmFyIHd0PSQtUSxUdD1HLUo7dFt2XT13dCx0W3YrMV09VHQ7Y29udGludWV9aWYocCE9PWwpe3ZhciBQdD1jdCxnZT0tdXQsYmU9JCxJZT0tRyxfZT0tYypsdCxCZT0tYypodCx3ZT0tYypKLFRlPS1jKlEsUGU9UHQrX2UsTWU9Z2UrQmUsU2U9YmUrVGUsVmU9SWUtd2UsQ3Q9bytkLXAsUnQ9bytmLXA7dFtDdF09UGUsdFtDdCsxXT1NZSx0W1J0XT1TZSx0W1J0KzFdPVZlfX19fV9zaW5nbGVSZWFsVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZStzXSx1PW8rYSxjPW8tYTtyW3RdPXUsclt0KzFdPTAsclt0KzJdPWMsclt0KzNdPTB9X3NpbmdsZVJlYWxUcmFuc2Zvcm00KHQsZSxzKXtjb25zdCByPXRoaXMuX291dCxpPXRoaXMuX2RhdGEsbz10aGlzLl9pbnY/LTE6MSxhPXMqMix1PXMqMyxjPWlbZV0saD1pW2Urc10sZj1pW2UrYV0sZD1pW2UrdV0sbD1jK2YscD1jLWYsbT1oK2QsST1vKihoLWQpLGc9bCttLHY9cCx3PS1JLFA9bC1tLFM9cCxWPUk7clt0XT1nLHJbdCsxXT0wLHJbdCsyXT12LHJbdCszXT13LHJbdCs0XT1QLHJbdCs1XT0wLHJbdCs2XT1TLHJbdCs3XT1WfX1sZXQgRHQ9bj0+Y29uc29sZS5sb2cobik7Y29uc3QgenQ9KC4uLm4pPT5EdCguLi5uKSxXdD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFN0PW49Pm4vKDErbikscXQ9KG4sdCk9PihuJXQrdCkldCxMdD0obix0KT0+KDErdCkqbi8oMSt0Kk1hdGguYWJzKG4pKSxZPShuLHQpPT5NYXRoLnRhbmgobiooMSt0KSksWXQ9KG4sdCk9Pld0KCgxK3QpKm4sLTEsMSksVnQ9KG4sdCk9PntsZXQgZT0oMSsuNSp0KSpuO2NvbnN0IHM9cXQoZSsxLDQpO3JldHVybiAxLU1hdGguYWJzKHMtMil9LGp0PShuLHQpPT5NYXRoLnNpbihNYXRoLlBJLzIqVnQobix0KSksSHQ9KG4sdCk9Pntjb25zdCBlPVN0KE1hdGgubG9nMXAodCkpLHM9KG4tZS8zKm4qbipuKS8oMS1lLzMpO3JldHVybiBZKHMsdCl9LHh0PShuLHQsZT0hMSk9Pntjb25zdCBzPTErMip0LGk9LjA3KlN0KE1hdGgubG9nMXAodCkpLG89WShuK2ksMip0KSxhPVkoZT9pOi1uK2ksMip0KSx1PW8tYSxjPTEvTWF0aC5jb3NoKHMqaSksaD1jKmMsZj1NYXRoLm1heCgxZS04LChlPzE6MikqcypoKTtyZXR1cm4gWSh1L2YsdCl9LHl0PXtzY3VydmU6THQsc29mdDpZLGhhcmQ6WXQsY3ViaWM6SHQsZGlvZGU6eHQsYXN5bToobix0KT0+eHQobix0LCEwKSxmb2xkOlZ0LHNpbmVmb2xkOmp0LGNoZWJ5c2hldjoobix0KT0+e2NvbnN0IGU9MTAqTWF0aC5sb2cxcCh0KTtsZXQgcz0xLHI9bixpLG89MDtmb3IobGV0IGE9MTthPDY0O2ErKyl7aWYoYTwyKXtvKz1hPT0wP3M6cjtjb250aW51ZX1pPTIqbipzLXIscj1zLHM9aSxhJTI9PT0wJiYobys9TWF0aC5taW4oMS4zKmUvYSwyKSppKX1yZXR1cm4gWShvLGUvMjApfX0sWD1PYmplY3QuZnJlZXplKE9iamVjdC5rZXlzKHl0KSksS3Q9bj0+e2xldCB0PW47dHlwZW9mIG49PSJzdHJpbmciJiYodD1YLmluZGV4T2YobiksdD09PS0xJiYoenQoYFtzdXBlcmRvdWdoXSBDb3VsZCBub3QgZmluZCB3YXZlc2hhcGluZyBhbGdvcml0aG0gJHtufS4KICAgICAgICBBdmFpbGFibGUgb3B0aW9ucyBhcmUgJHtYLmpvaW4oIiwgIil9LgogICAgICAgIERlZmF1bHRpbmcgdG8gJHtYWzBdfS5gKSx0PTApKTtjb25zdCBlPVhbdCVYLmxlbmd0aF07cmV0dXJuIHl0W2VdfSxqPTEyOCxSPU1hdGguUEksaz0yKlIscT0xL3NhbXBsZVJhdGUsVD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFV0PShuLHQsZSk9PmUqKHQtbikrbixiPShuLHQpPT5uW3RdPz9uWzBdLEg9bj0+bi1NYXRoLmZsb29yKG4pLEs9bj0+bnwwLFU9bj0+SyhuKy41KSxadD1uPT5LKG4rMSksQXQ9bj0+bi1LKG4pLHo9bj0+e2NvbnN0IHQ9bioqMjtyZXR1cm4gbiooMjcrdCkvKDI3KzkqdCl9LE50PShuLHQpPT57aWYobjwyKXJldHVybiByPT4wO2NvbnN0IGU9dC8obi0xKSxzPXQqLjU7cmV0dXJuIHI9PnIqZS1zfSxaPShuLHQpPT5uKk1hdGgucG93KDIsdC8xMik7ZnVuY3Rpb24gJHQobix0KXt0PU1hdGgubWluKHQsMS10KTtjb25zdCBlPTEvdDtyZXR1cm4gbjx0PyhuKj1lLDIqbi1uKioyLTEpOm4+MS10PyhuPShuLTEpKmUsbioqMisyKm4rMSk6MH1jb25zdCBkdD17dHJpKG4sdD0uNSl7Y29uc3QgZT0xLXQ7cmV0dXJuIG4+PXQ/MS9lLW4vZTpuL3R9LHNpbmUobil7cmV0dXJuIE1hdGguc2luKGsqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPVQodFtzXSwwLDEpLGE9VCh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtJHQobix0KX19LEd0PU9iamVjdC5rZXlzKGR0KTtjbGFzcyBRdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ0aW1lIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6InNrZXciLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6ImRlcHRoIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InBoYXNlb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6InNoYXBlIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImN1cnZlIixkZWZhdWx0VmFsdWU6MX0se25hbWU6ImRjb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1pbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJtYXgiLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucGhhc2V9aW5jcmVtZW50UGhhc2UodCl7dGhpcy5waGFzZSs9dCx0aGlzLnBoYXNlPjEmJih0aGlzLnBoYXNlPXRoaXMucGhhc2UtMSl9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1zLmJlZ2luWzBdO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cilyZXR1cm4hMDtjb25zdCBpPWVbMF0sbz1zLmZyZXF1ZW5jeVswXSxhPXMudGltZVswXSx1PXMuZGVwdGhbMF0sYz1zLnNrZXdbMF0saD1zLnBoYXNlb2Zmc2V0WzBdLGY9cy5jdXJ2ZVswXSxkPXMuZGNvZmZzZXRbMF0sbD1zLm1pblswXSxwPXMubWF4WzBdLG09R3Rbcy5zaGFwZVswXV0sST1pWzBdLmxlbmd0aD8/MDt0aGlzLnBoYXNlPT1udWxsJiYodGhpcy5waGFzZT1BdChhKm8raCkpO2NvbnN0IGc9bypxO2ZvcihsZXQgdj0wO3Y8STt2Kyspe2ZvcihsZXQgdz0wO3c8aS5sZW5ndGg7dysrKXtsZXQgUD0oZHRbbV0odGhpcy5waGFzZSxjKStkKSp1O1A9TWF0aC5wb3coUCxmKSxpW3ddW3ZdPVQoUCxsLHApfXRoaXMuaW5jcmVtZW50UGhhc2UoZyl9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsZm8tcHJvY2Vzc29yIixRdCk7Y2xhc3MgSnQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY29hcnNlIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNvYXJzZVswXT8/MDthPU1hdGgubWF4KDEsYSk7Zm9yKGxldCB1PTA7dTxqO3UrKylmb3IobGV0IGM9MDtjPHIubGVuZ3RoO2MrKylpW2NdW3VdPXUlYT09PTA/cltjXVt1XTppW2NdW3UtMV07cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjb2Fyc2UtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY3J1c2giLGRlZmF1bHRWYWx1ZTowfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuY3J1c2hbMF0/Pzg7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8ajt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspe2NvbnN0IGg9TWF0aC5wb3coMixhLTEpO2lbY11bdV09TWF0aC5yb3VuZChyW2NdW3VdKmgpL2h9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjcnVzaC1wcm9jZXNzb3IiLFh0KTtjbGFzcyB0ZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5zaGFwZVswXTthPWE8MT9hOi45OTk5OTk5OTk2LGE9MiphLygxLWEpO2NvbnN0IHU9TWF0aC5tYXgoLjAwMSxNYXRoLm1pbigxLHMucG9zdGdhaW5bMF0pKTtmb3IobGV0IGM9MDtjPGo7YysrKWZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKWlbaF1bY109KDErYSkqcltoXVtjXS8oMSthKk1hdGguYWJzKHJbaF1bY10pKSp1O3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic2hhcGUtcHJvY2Vzc29yIix0ZSk7Y2xhc3MgT3R7czA9MDtzMT0wO3VwZGF0ZSh0LGUscz0wKXtzPVQocywwLDEpLGU9VChlLDAsc2FtcGxlUmF0ZS8yLTEpO2NvbnN0IHI9VCgyKk1hdGguc2luKGUqUipxKSwwLDEuMTQpLG89MS1NYXRoLnBvdyguNSw4KnMrMSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBPdCxuZXcgT3RdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9VChzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgZD0wO2Q8ajtkKyspdT09Im5vbmUiP2lbZl1bZF09cltmXVtkXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW2RdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW2RdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtkXT1yW2ZdW2RdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW2RdPXJbZl1bZF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsZWUpO2NsYXNzIHNlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjUwMH0se25hbWU6InEiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZHJpdmUiLGRlZmF1bHRWYWx1ZTouNjl9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMucDA9WzAsMF0sdGhpcy5wMT1bMCwwXSx0aGlzLnAyPVswLDBdLHRoaXMucDM9WzAsMF0sdGhpcy5wMzI9WzAsMF0sdGhpcy5wMzM9WzAsMF0sdGhpcy5wMzQ9WzAsMF19cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztjb25zdCBhPXMucVswXSx1PVQoTWF0aC5leHAocy5kcml2ZVswXSksLjEsMmUzKTtsZXQgYz1zLmZyZXF1ZW5jeVswXTtjPWMqaypxLGM9Yz4xPzE6Yztjb25zdCBoPU1hdGgubWluKDgsYSouMTMpO2xldCBmPTEvdSpNYXRoLm1pbigxLjc1LDEraCk7Zm9yKGxldCBkPTA7ZDxqO2QrKylmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKyl7Y29uc3QgcD10aGlzLnAzW2xdKi4zNjA4OTErdGhpcy5wMzJbbF0qLjQxNzI5K3RoaXMucDMzW2xdKi4xNzc4OTYrdGhpcy5wMzRbbF0qLjA0Mzk3MjU7dGhpcy5wMzRbbF09dGhpcy5wMzNbbF0sdGhpcy5wMzNbbF09dGhpcy5wMzJbbF0sdGhpcy5wMzJbbF09dGhpcy5wM1tsXSx0aGlzLnAwW2xdKz0oeihyW2xdW2RdKnUtaCpwKS16KHRoaXMucDBbbF0pKSpjLHRoaXMucDFbbF0rPSh6KHRoaXMucDBbbF0pLXoodGhpcy5wMVtsXSkpKmMsdGhpcy5wMltsXSs9KHoodGhpcy5wMVtsXSkteih0aGlzLnAyW2xdKSkqYyx0aGlzLnAzW2xdKz0oeih0aGlzLnAyW2xdKS16KHRoaXMucDNbbF0pKSpjLGlbbF1bZF09cCpmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGFkZGVyLXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImRpc3RvcnQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3Ioe3Byb2Nlc3Nvck9wdGlvbnM6dH0pe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMuYWxnb3JpdGhtPUt0KHQuYWxnb3JpdGhtKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2ZvcihsZXQgYT0wO2E8ajthKyspe2NvbnN0IHU9VChiKHMucG9zdGdhaW4sYSksLjAwMSwxKSxjPU1hdGguZXhwbTEoYihzLmRpc3RvcnQsYSkpO2ZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKXtjb25zdCBmPXJbaF1bYV07aVtoXVthXT11KnRoaXMuYWxnb3JpdGhtKGYsYyl9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGlzdG9ydC1wcm9jZXNzb3IiLHJlKTtjbGFzcyBuZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZT1bXX1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJwYW5zcHJlYWQiLGRlZmF1bHRWYWx1ZTouNCxtaW46MCxtYXg6MX0se25hbWU6ImZyZXFzcHJlYWQiLGRlZmF1bHRWYWx1ZTouMixtaW46MH0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjAsbWluOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZTo1LG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifV19cHJvY2Vzcyh0LGUscyl7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXSxpPXMudm9pY2VzWzBdO2ZvcihsZXQgbz0wO288clswXS5sZW5ndGg7bysrKXtjb25zdCBhPWIocy5kZXR1bmUsbyksdT1iKHMuZnJlcXNwcmVhZCxvKSxjPWIocy5wYW5zcHJlYWQsbykqLjUrLjU7bGV0IGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyksZD1iKHMuZnJlcXVlbmN5LG8pO2Q9WihkLGEvMTAwKTtjb25zdCBsPU50KGksdSk7Zm9yKGxldCBwPTA7cDxpO3ArKyl7Y29uc3QgbT1aKGQsbChwKSksST1IKG0qcSk7dGhpcy5waGFzZVtwXT10aGlzLnBoYXNlW3BdPz9NYXRoLnJhbmRvbSgpO2NvbnN0IGc9ZHQuc2F3YmxlcCh0aGlzLnBoYXNlW3BdLEkpO3JbMF1bb10rPWcqaCxyWzFdW29dKz1nKmY7bGV0IHY9dGhpcy5waGFzZVtwXStJO3Y+PTEmJih2LT0xKSx0aGlzLnBoYXNlW3BdPXY7Y29uc3Qgdz1oO2g9ZixmPXd9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic3VwZXJzYXctb3NjaWxsYXRvciIsbmUpO2NvbnN0IGllPTIwNDgscHQ9bmV3IE1hcDtmdW5jdGlvbiBvZShuKXtpZighcHQuaGFzKG4pKXtjb25zdCB0PW5ldyBGbG9hdDMyQXJyYXkobik7Zm9yKGxldCBlPTA7ZTxuO2UrKyl0W2VdPS41KigxLU1hdGguY29zKGsqZS9uKSk7cHQuc2V0KG4sdCl9cmV0dXJuIHB0LmdldChuKX1jbGFzcyBhZSBleHRlbmRzIGt0e3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOmllfSxzdXBlcih0KSx0aGlzLnRpbWVDdXJzb3I9MCx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy5pbnZmZnRTaXplPTEvdGhpcy5mZnRTaXplLHRoaXMuaGFubldpbmRvdz1vZSh0aGlzLmZmdFNpemUpLHRoaXMuZmZ0PW5ldyBFdCh0aGlzLmZmdFNpemUpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy50aW1lQ29tcGxleEJ1ZmZlcj10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLm1hZ25pdHVkZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLmZmdFNpemUvMisxKSx0aGlzLnBlYWtJbmRleGVzPW5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpLHRoaXMubmJQZWFrcz0wfXByb2Nlc3NPTEEodCxlLHMpe2xldCByPXMucGl0Y2hGYWN0b3Jbcy5waXRjaEZhY3Rvci5sZW5ndGgtMV07cjwwJiYocj1yKi4yNSkscj1NYXRoLm1heCgwLHIrMSk7Zm9yKGxldCBpPTA7aTx0aGlzLm5iSW5wdXRzO2krKylmb3IobGV0IG89MDtvPHRbaV0ubGVuZ3RoO28rKyl7Y29uc3QgYT10W2ldW29dLHU9ZVtpXVtvXTt0aGlzLmFwcGx5SGFubldpbmRvdyhhKSx0aGlzLmZmdC5yZWFsVHJhbnNmb3JtKHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIsYSksdGhpcy5jb21wdXRlTWFnbml0dWRlcygpLHRoaXMuZmluZFBlYWtzKCksdGhpcy5zaGlmdFBlYWtzKHIpLHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpLHRoaXMuZmZ0LmludmVyc2VUcmFuc2Zvcm0odGhpcy50aW1lQ29tcGxleEJ1ZmZlcix0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHUpLHRoaXMuYXBwbHlIYW5uV2luZG93KHUpfXRoaXMudGltZUN1cnNvcis9dGhpcy5ob3BTaXplfWFwcGx5SGFubldpbmRvdyh0KXtmb3IobGV0IGU9MDtlPHRoaXMuYmxvY2tTaXplO2UrKyl0W2VdKj10aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2xldCB0PTAsZT0wO2Zvcig7dDx0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyl7Y29uc3Qgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDtsZXQgdD0yO2NvbnN0IGU9dGhpcy5tYWduaXR1ZGVzLmxlbmd0aC0yO2Zvcig7dDxlOyl7Y29uc3Qgcz10aGlzLm1hZ25pdHVkZXNbdF07aWYodGhpcy5tYWduaXR1ZGVzW3QtMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0LTJdPj1zKXt0Kys7Y29udGludWV9aWYodGhpcy5tYWduaXR1ZGVzW3QrMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0KzJdPj1zKXt0Kys7Y29udGludWV9dGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3NdPXQsdGhpcy5uYlBlYWtzKyssdCs9Mn19c2hpZnRQZWFrcyh0KXt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZC5maWxsKDApO2ZvcihsZXQgZT0wO2U8dGhpcy5uYlBlYWtzO2UrKyl7Y29uc3Qgcz10aGlzLnBlYWtJbmRleGVzW2VdLHI9VShzKnQpO2lmKHI+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgaT0wLG89dGhpcy5mZnRTaXplO2U+MCYmKGk9cy1VKChzLXRoaXMucGVha0luZGV4ZXNbZS0xXSkvMikpLGU8dGhpcy5uYlBlYWtzLTEmJihvPXMrWnQoKHRoaXMucGVha0luZGV4ZXNbZSsxXS1zKS8yKSk7Y29uc3QgYT1pLXMsdT1vLXMsYz1rKnRoaXMuaW52ZmZ0U2l6ZSooci1zKSxoPU1hdGguY29zKGMqdGhpcy50aW1lQ3Vyc29yKSxmPU1hdGguc2luKGMqdGhpcy50aW1lQ3Vyc29yKTtmb3IobGV0IGQ9YTtkPHU7ZCsrKXtjb25zdCBsPXMrZCxwPXIrZDtpZihwPj10aGlzLm1hZ25pdHVkZXMubGVuZ3RoKWJyZWFrO2NvbnN0IG09MipsLEk9bSsxLGc9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlclttXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbSV0sdz1nKmgtdipmLFA9ZypmK3YqaCxTPTIqcCxWPVMrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtTXSs9dyx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtWXSs9UH19fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLGFlKTtjbGFzcyBjZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGk9LVIsdGhpcy5ZMD0wLHRoaXMuWTE9MCx0aGlzLlBXPVIsdGhpcy5CPTIuMyx0aGlzLmRwaGlmPTAsdGhpcy5lbnZmPTB9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJwdWxzZXdpZHRoIixkZWZhdWx0VmFsdWU6MSxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXTtsZXQgaT0xLG87Zm9yKGxldCBhPTA7YTwoclswXS5sZW5ndGg/PzApO2ErKyl7Y29uc3QgdT0oMS1UKGIocy5wdWxzZXdpZHRoLGEpLC0uOTksLjk5KSkqUixjPWIocy5kZXR1bmUsYSksaD1aKGIocy5mcmVxdWVuY3ksYSksYy8xMDApO289aCprKnEsdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49UiYmKHRoaXMucGhpLT1rKTtsZXQgZj1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMCk7dGhpcy5ZMD0uNSooZit0aGlzLlkwKTtsZXQgZD1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMSt1KTt0aGlzLlkxPS41KihkK3RoaXMuWTEpO2ZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXJbbF1bYV09LjE1KihmLWQpKnRoaXMuZW52Zn1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInB1bHNlLW9zY2lsbGF0b3IiLGNlKTtjb25zdCBtdD17Yml0QzpmdW5jdGlvbihuLHQsZSl7cmV0dXJuIG4mdD9lOjB9LGJyOmZ1bmN0aW9uKG4sdD04KXtpZih0PjMyKXRocm93IG5ldyBFcnJvcigiYnIoKSBTaXplIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gMzIiKTtsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dDtzKyspZXw9bXQuYml0QyhuLDE8PHMsMTw8dC0ocysxKSk7cmV0dXJuIGV9LHNpbmY6ZnVuY3Rpb24obil7cmV0dXJuIE1hdGguc2luKG4qUi8xMjgpfSxjb3NmOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLmNvcyhuKlIvMTI4KX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obipSLzEyOCl9LHJlZ0c6ZnVuY3Rpb24obix0KXtyZXR1cm4gdC50ZXN0KG4udG9TdHJpbmcoMikpfX07bGV0IHR0LHZ0O2Z1bmN0aW9uIHVlKG4pe2lmKHR0PT1udWxsKXt0dD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhNYXRoKSx2dD10dC5tYXAocz0+TWF0aFtzXSk7Y29uc3QgdD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhtdCksZT10Lm1hcChzPT5tdFtzXSk7dHQucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSx2dC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLnR0LCJ0IixgcmV0dXJuIDAsCiR7bnx8MH07YCkuYmluZChnbG9iYWxUaGlzLC4uLnZ0KX1jbGFzcyBoZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5wb3J0Lm9ubWVzc2FnZT10PT57bGV0e2NvZGVUZXh0OmV9PXQuZGF0YTtjb25zdHtieXRlQmVhdFN0YXJ0VGltZTpzfT10LmRhdGE7cyE9bnVsbCYmKHRoaXMudD0wLHRoaXMuaW5pdGlhbE9mZnNldD1NYXRoLmZsb29yKHMpKSxlPWUudHJpbSgpLnJlcGxhY2UoL15ldmFsXCh1bmVzY2FwZVwoZXNjYXBlKD86YHxcKCd8XCgifFwoYCkoLio/KSg/OmB8J1wpfCJcKXxgXCkpLnJlcGxhY2VcKFwvdVwoXC5cLlwpXC9nLFsiJ2BdXCQxJVsiJ2BdXClcKVwpJC8sKHIsaSk9PnVuZXNjYXBlKGVzY2FwZShpKS5yZXBsYWNlKC91KC4uKS9nLCIkMSUiKSkpLHRoaXMuZnVuYz11ZShlKX0sdGhpcy5pbml0aWFsT2Zmc2V0PTAsdGhpcy50PW51bGwsdGhpcy5mdW5jPW51bGx9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7dGhpcy50PT1udWxsJiYodGhpcy50PXMuYmVnaW5bMF0qc2FtcGxlUmF0ZSk7Y29uc3Qgcj1lWzBdLGk9MjU2KnE7Zm9yKGxldCBvPTA7bzxyWzBdLmxlbmd0aDtvKyspe2NvbnN0IGE9YihzLmRldHVuZSxvKSx1PVooYihzLmZyZXF1ZW5jeSxvKSxhLzEwMCksYz1pKnUqdGhpcy50K3RoaXMuaW5pdGlhbE9mZnNldCxmPSh0aGlzLmZ1bmMoYykmMjU1KS8xMjcuNS0xLGQ9VChmKi4yLC0uNCwuNCk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVtvXT1kO3RoaXMudCsrfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsaGUpO2NsYXNzIGxlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJhdHRhY2siLGRlZmF1bHRWYWx1ZTouMDA1LG1pblZhbHVlOjB9LHtuYW1lOiJkZWNheSIsZGVmYXVsdFZhbHVlOi4xNCxtaW5WYWx1ZTowfSx7bmFtZToic3VzdGFpbiIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6MCxtYXhWYWx1ZToxfSx7bmFtZToicmVsZWFzZSIsZGVmYXVsdFZhbHVlOi4xLG1pblZhbHVlOjB9LHtuYW1lOiJhdHRhY2tDdXJ2ZSIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6LTEsbWF4VmFsdWU6MX0se25hbWU6ImRlY2F5Q3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJyZWxlYXNlQ3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJwZWFrIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InJldHJpZ2dlciIsZGVmYXVsdFZhbHVlOjEsbWluVmFsdWU6MCxtYXhWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMudmFsPTAsdGhpcy5zZWdJZHg9MCx0aGlzLnN0YXRlPTAsdGhpcy5iZWdpblRpbWU9MCx0aGlzLmVuZFRpbWU9MCx0aGlzLmF0dGFja1N0YXJ0PTB9X3dhcnAodCxlLHM9OCl7aWYodD09PTB8fHQ9PT0xKXJldHVybiB0O2lmKGU+MCl7Y29uc3Qgcj0xK3MqZTtyZXR1cm4gMS1NYXRoLnBvdygxLXQscil9ZWxzZXtjb25zdCByPTEtcyplO3JldHVybiBNYXRoLnBvdyh0LHIpfX1fYWR2YW5jZSh0LGUscyxyKXtpZihzPT09MHx8dD09PWUpdGhpcy52YWw9ZTtlbHNle2NvbnN0IGk9TWF0aC5taW4oMSwoY3VycmVudFRpbWUtdGhpcy5iZWdpblRpbWUpL3MpLG89dGhpcy5fd2FycChpLHIpO3RoaXMudmFsPXQrKGUtdCkqb319cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1lWzBdWzBdO2lmKCFyKXJldHVybiEwO2NvbnN0IGk9YihzLmJlZ2luLDApLG89YihzLnJldHJpZ2dlciwwKT49LjU7aSE9PXRoaXMuYmVnaW5UaW1lJiYodGhpcy5zdGF0ZT09PTB8fG8pJiYodGhpcy5iZWdpblRpbWU9aSx0aGlzLnN0YXRlPTEsdGhpcy5lbmRUaW1lPWIocy5lbmQsMCksdGhpcy5hdHRhY2tTdGFydD10aGlzLnZhbCk7Y29uc3QgYT10aGlzLmVuZFRpbWUtdGhpcy5iZWdpblRpbWU7Zm9yKGxldCB1PTA7dTxyLmxlbmd0aDt1Kyspe2NvbnN0IGM9YihzLmF0dGFjayx1KSxoPWIocy5kZWNheSx1KSxmPWIocy5zdXN0YWluLHUpLGQ9YihzLnJlbGVhc2UsdSksbD1iKHMuYXR0YWNrQ3VydmUsdSkscD1iKHMuZGVjYXlDdXJ2ZSx1KSxtPWIocy5yZWxlYXNlQ3VydmUsdSksST1iKHMucGVhayx1KSxnPVt7dGltZTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksc3RhcnQ6MCx0YXJnZXQ6MH0se3RpbWU6YyxzdGFydDp0aGlzLmF0dGFja1N0YXJ0LHRhcmdldDoxLGN1cnZlOmx9LHt0aW1lOmMraCxzdGFydDoxLHRhcmdldDpmLGN1cnZlOnB9LHt0aW1lOmEsc3RhcnQ6Zix0YXJnZXQ6Zn0se3RpbWU6YStkLHN0YXJ0OmYsdGFyZ2V0OjAsY3VydmU6bX1dO2xldHt0aW1lOnYsc3RhcnQ6dyx0YXJnZXQ6UCxjdXJ2ZTpTfT1nW3RoaXMuc3RhdGVdO2Zvcih0aGlzLl9hZHZhbmNlKHcsUCx2LFMpO2N1cnJlbnRUaW1lLXRoaXMuYmVnaW5UaW1lPj12Oyl0aGlzLnN0YXRlPSh0aGlzLnN0YXRlKzEpJWcubGVuZ3RoLHY9Z1t0aGlzLnN0YXRlXS50aW1lO3JbdV09dGhpcy52YWwqSX1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoImVudmVsb3BlLXByb2Nlc3NvciIsbGUpO2NvbnN0IEI9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gZmUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBGdD1uPT4oZmUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBkZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBwZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1GdCh0KSxyPUZ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBtZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKnBlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IGd0PXt9O2NsYXNzIHZlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhZ3RbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgZD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspZFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBkfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha31ndFtpXT1vfXRoaXMudGFibGVzPWd0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOlUoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIEIuTk9ORTpyZXR1cm4gdDtjYXNlIEIuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBCLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsQi5BU1lNKSk7Y2FzZSBCLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIEIuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIEIuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgQi5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqKjIpO3JldHVybiB0KnIlMX1jYXNlIEIuUVVBTlQ6e2NvbnN0e246cn09dGhpcy5fdG9CaXRzKGUpO3JldHVybiBLKHQqcikvcn1jYXNlIEIuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsVSg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoQXQoaSp0KS0uNSkqMn1jYXNlIEIuUFdNOntjb25zdCByPVQoLjUrLjQ5KigyKmUtMSksMCwxKTtyZXR1cm4gdDxyP3QvciouNTouNSsodC1yKS8oMS1yKSouNX1jYXNlIEIuT1JCSVQ6e2NvbnN0IHI9LjUqZTtyZXR1cm4gSCh0K3IqTWF0aC5zaW4oayozKnQpKX1jYXNlIEIuU1BJTjp7Y29uc3Qgcj0uNSplLHtuOml9PXRoaXMuX3RvQml0cyhlLDEsNik7cmV0dXJuIEgodCtyKk1hdGguc2luKGsqaSp0KSl9Y2FzZSBCLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gVCgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgQi5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKioyPD1vO2ErPTIpaWYobyVhPT09MClyZXR1cm4hMTtyZXR1cm4hMH07bGV0e246aX09dGhpcy5fdG9CaXRzKGUsMyk7Zm9yKDshcihpKTspaSsrO3JldHVybiBLKHQqaSkvaX1jYXNlIEIuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPVUocik7Y29uc3QgaT0xPDxyLG89Syh0KmkpO3JldHVybiBkZShvLHIpL2l9Y2FzZSBCLkJST1dOSUFOOntjb25zdCByPS4yNSplKm1lKDY0KnQsNCk7cmV0dXJuIEgodCtyKX1jYXNlIEIuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIFQoYSwwLDEpfWNhc2UgQi5XT1JNSE9MRTp7Y29uc3Qgcj1UKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIEIuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErVSgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIFQociwwLDEpfWNhc2UgQi5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgQi5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKGsqdCkqZTtyZXR1cm4gSCh0K3IpfWNhc2UgQi5GTElQOnJldHVybiB0O2RlZmF1bHQ6cmV0dXJuIHR9fV9zYW1wbGVGcmFtZSh0LGUpe2NvbnN0IHM9dC5sZW5ndGgscj1lKnM7bGV0IGk9cnwwO2k+PXMmJihpPTApO2NvbnN0IG89ci1pLGE9dFtpXTtsZXQgdT1pKzE7dT49cyYmKHU9MCk7Y29uc3QgYz10W3VdO3JldHVybiBhKyhjLWEpKm99X2Nob29zZU1pcCh0KXtjb25zdCBlPVQodCwxZS02LDY0KTtsZXQgcz0wO2Zvcig7cysxPCh0aGlzLnRhYmxlcz8ubGVuZ3RofHwxKSYmZTx0aGlzLnRhYmxlc1tzXVswXS5sZW5ndGgvODspcysrO3JldHVybiBzfXByb2Nlc3ModCxlLHMpe2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtjb25zdCByPWVbMF1bMF0saT1lWzBdWzFdfHxlWzBdWzBdO2lmKCF0aGlzLnRhYmxlcylyZXR1cm4gci5maWxsKDApLGkhPT1yJiZpLnNldChyKSwhMDtjb25zdCBvPXMudm9pY2VzWzBdO2ZvcihsZXQgYT0wO2E8ci5sZW5ndGg7YSsrKXtjb25zdCB1PWIocy5kZXR1bmUsYSksYz1iKHMuZnJlcXNwcmVhZCxhKSxmPVQoYihzLnBvc2l0aW9uLGEpLDAsMSkqKHRoaXMubnVtRnJhbWVzLTEpLGQ9ZnwwLGw9Zi1kLHA9VChiKHMud2FycCxhKSwwLDEpLG09YihzLndhcnBNb2RlLGEpLEk9VChiKHMucGhhc2VyYW5kLGEpLDAsMSksZz1vPjE/VChiKHMucGFuc3ByZWFkLGEpLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpnKSx3PU1hdGguc3FydCguNSsuNSpnKTtsZXQgUD1iKHMuZnJlcXVlbmN5LGEpO1A9WihQLHUvMTAwKTtjb25zdCBTPTEvTWF0aC5zcXJ0KG8pLFY9TnQobyxjKTtmb3IobGV0IE09MDtNPG87TSsrKXtjb25zdCB4PShNJjEpPT0xO2xldCB5PXYsQT13O3gmJih5PXcsQT12KTtjb25zdCBOPVooUCxWKE0pKSpxLEU9dGhpcy5fY2hvb3NlTWlwKE4pLE89dGhpcy50YWJsZXNbRV07dGhpcy5waGFzZVtNXT10aGlzLnBoYXNlW01dPz9NYXRoLnJhbmRvbSgpKkk7Y29uc3QgRj10aGlzLl93YXJwUGhhc2UodGhpcy5waGFzZVtNXSxwLG0pLEQ9dGhpcy5fc2FtcGxlRnJhbWUoT1tkXSxGKSxMPXRoaXMuX3NhbXBsZUZyYW1lKE9bTWF0aC5taW4odGhpcy5udW1GcmFtZXMtMSxkKzEpXSxGKTtsZXQgQz1VdChELEwsbCk7bT09PUIuRkxJUCYmdGhpcy5waGFzZVtNXTxwJiYoQz0tQyksclthXSs9Qyp5KlMsaVthXSs9QypBKlMsdGhpcy5waGFzZVtNXT1IKHRoaXMucGhhc2VbTV0rTil9fXJldHVybiEwfX1yZXR1cm4gcmVnaXN0ZXJQcm9jZXNzb3IoIndhdmV0YWJsZS1vc2NpbGxhdG9yLXByb2Nlc3NvciIsdmUpLGZ0LldhcnBNb2RlPUIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGZ0LFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxmdH0pKHt9KTsK";let audioContext;const setDefaultAudioContext=()=>(audioContext=new AudioContext,audioContext),getAudioContext=()=>audioContext||setDefaultAudioContext();function getAudioContextCurrentTime(){return getAudioContext().currentTime}let noiseCache={};function getNoiseBuffer(e,t){const o=getAudioContext();if(noiseCache[e])return noiseCache[e];const u=2*o.sampleRate,p=o.createBuffer(1,u,o.sampleRate),f=p.getChannelData(0);let b=0,M,F,S,k,N,$,R;M=F=S=k=N=$=R=0;for(let U=0;U<u;U++)if(e==="white")f[U]=Math.random()*2-1;else if(e==="brown"){let V=Math.random()*2-1;f[U]=(b+.02*V)/1.02,b=f[U]}else if(e==="pink"){let V=Math.random()*2-1;M=.99886*M+V*.0555179,F=.99332*F+V*.0750759,S=.969*S+V*.153852,k=.8665*k+V*.3104856,N=.55*N+V*.5329522,$=-.7616*$-V*.016898,f[U]=M+F+S+k+N+$+R+V*.5362,f[U]*=.11,R=V*.115926}else if(e==="crackle"){const V=t*.01;Math.random()<V?f[U]=Math.random()*2-1:f[U]=0}return e!=="crackle"&&(noiseCache[e]=p),p}function getNoiseOscillator(e="white",t,o=.02){const p=getAudioContext().createBufferSource();return p.buffer=getNoiseBuffer(e,o),p.loop=!0,p.start(t),{node:p,stop:f=>p.stop(f)}}function getNoiseMix(e,t,o){const u=getNoiseOscillator("pink",o),p=drywet(e,u.node,t);return u.node.onended=()=>p.onended(),{node:p.node,stop:f=>u?.stop(f)}}const noises=["pink","white","brown","crackle"];function gainNode(e){const t=getAudioContext().createGain();return t.gain.value=e,t}function effectSend(e,t,o){const u=gainNode(o);return e.connect(u),u.connect(t),u}const getSlope=(e,t,o,u)=>u-o===0?0:(t-e)/(u-o);function getWorklet(e,t,o,u){const p=new AudioWorkletNode(e,t,u);return Object.entries(o).forEach(([f,b])=>{b!==void 0&&(p.parameters.get(f).value=b)}),p}const getParamADSR=(e,t,o,u,p,f,b,M,F,S="exponential")=>{t=nanFallback(t),o=nanFallback(o),u=nanFallback(u),p=nanFallback(p);const k=S==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";S==="exponential"&&(f=f===0?.001:f,b=b===0?.001:b);const N=b-f,$=b,R=f+u*N,U=F-M,V=z=>{let K;if(t>z){let ie=getSlope(f,$,0,t);K=z*ie+(f>$?f:0)}else K=(z-t)*getSlope($,R,0,o)+$;return S==="exponential"&&(K=K||.001),K};e.setValueAtTime(f,M),t>U?e[k](V(U),F):t+o>U?(e[k](V(t),M+t),e[k](V(U),F)):(e[k](V(t),M+t),e[k](V(t+o),M+t+o),e.setValueAtTime(R,F)),e[k](f,F+p)};function getModulationShapeInput(e){return typeof e=="number"?e%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[e]??0}function getLfo(e,t,o,u={}){const{shape:p=0,...f}=u,{dcoffset:b=-.5,depth:M=1}=u,F={frequency:1,depth:M,skew:.5,phaseoffset:0,time:t,begin:t,end:o,shape:getModulationShapeInput(p),dcoffset:b,min:b*M,max:b*M+M,curve:1,...f};return getWorklet(e,"lfo-processor",F)}function getCompressor(e,t,o,u,p,f){const b={threshold:t??-3,ratio:o??10,knee:u??10,attack:p??.005,release:f??.05};return new DynamicsCompressorNode(e,b)}const getADSRValues=(e,t="linear",o)=>{const[b,M,F,S]=e;if(b==null&&M==null&&F==null&&S==null)return o??[.001,.001,1,.01];const k=F??(b!=null&&M==null||b==null&&M==null?1:.001);return[Math.max(b??0,.001),Math.max(M??0,.001),Math.min(k,1),Math.max(S??0,.01)]};function getParamLfo(e,t,o,u,p){let{defaultDepth:f=1,depth:b,dcoffset:M,...F}=p;b==null&&(b=Object.values(F).some(N=>N!=null)?f:0);let S;return b&&(S=getLfo(e,o,u,{depth:b,dcoffset:M,...F}),S.connect(t)),S}function applyParameterModulators(e,t,o,u,p,f){let{amount:b,offset:M,defaultAmount:F=1,curve:S="linear",values:k,holdEnd:N,defaultValues:$}=p;b==null&&(b=k.some(ie=>ie!=null)?F:0);const R=M??0,U=b+R;if(Math.abs(U-R)){const[K,ie,he,se]=getADSRValues(k,S,$);getParamADSR(t,K,ie,he,se,R,U,o,N,S)}const z=getParamLfo(e,t,o,u,f);return{lfo:z,disconnect:()=>z?.disconnect()}}function createFilter(e,t,o,u,p,f){let{frequency:b,anchor:M,env:F,type:S,model:k,q:N=1,drive:$=.69,depth:R,depthfrequency:U,dcoffset:V=-.5,skew:z,shape:K,rate:ie,sync:he}=u,se,ee;k==="ladder"?(ee=getWorklet(e,"ladder-processor",{frequency:b,q:N,drive:$}),se=ee.parameters.get("frequency")):(ee=e.createBiquadFilter(),ee.type=S,ee.Q.value=N,ee.frequency.value=b,se=ee.frequency);const pe=[u.attack,u.decay,u.sustain,u.release],[_e,ve,we,xe]=getADSRValues(pe,"exponential",[.005,.14,0,.1]);if([...pe,F].some(Xe=>Xe!==void 0)){F=nanFallback(F,1,!0),M=nanFallback(M,0,!0);const Xe=Math.abs(F),Ke=Xe*M;let me=clamp(2**-Ke*b,0,2e4),ye=clamp(2**(Xe-Ke)*b,0,2e4);F<0&&([me,ye]=[ye,me]),getParamADSR(se,_e,ve,we,xe,me,ye,t,o,"exponential")}he!=null&&(ie=p*he);const Pe=[R,U,z,K,ie].some(Xe=>Xe!==void 0);let Le;if(Pe){R=R??1;const Xe=f/p,me={depth:U??(R??1)*b,dcoffset:V,skew:z,shape:K,frequency:ie??p,min:-b+30,max:2e4-b,time:Xe,curve:1};Le=getParamLfo(e,se,t,o,me)}return{filter:ee,lfo:Le}}let wetfade=e=>e<.5?1:1-(e-.5)/.5;function drywet(e,t,o=0){const u=getAudioContext();if(!o)return e;let p=u.createGain(),f=u.createGain();e.connect(p),t.connect(f),p.gain.value=wetfade(o),f.gain.value=wetfade(1-o);let b=u.createGain();return p.connect(b),f.connect(b),{node:b,onended:()=>{p.disconnect(b),f.disconnect(b),e.disconnect(p),t.disconnect(f)}}}let curves=["linear","exponential"];function getPitchEnvelope(e,t,o,u){if((t.pattack??t.pdecay??t.psustain??t.prelease??t.penv)===void 0)return;const f=nanFallback(t.penv,1,!0),b=curves[t.pcurve??0];let[M,F,S,k]=getADSRValues([t.pattack,t.pdecay,t.psustain,t.prelease],b,[.2,.001,1,.001]),N=t.panchor??S;const $=f*100,R=0-$*N,U=$-$*N;getParamADSR(e,M,F,S,k,R,U,o,u,b)}function getVibratoOscillator(e,t,o){const{vibmod:u=.5,vib:p}=t;let f;if(p>0){f=getAudioContext().createOscillator(),f.frequency.value=p;const b=getAudioContext().createGain();return b.gain.value=u*100,f.connect(b),b.connect(e),f.onended=()=>{b.disconnect(e),f.disconnect(b)},f.start(o),f}}function scheduleAtTime(e,t,o=getAudioContext()){const u=o.currentTime;webAudioTimeout(o,e,u,t)}function webAudioTimeout(e,t,o,u){const p=new ConstantSourceNode(e),f=gainNode(0);return f.connect(e.destination),p.connect(f),p.onended=()=>{try{f.disconnect()}catch{}try{p.disconnect()}catch{}t()},p.start(o),p.stop(u),p}const mod$2=(e,t=1,o="sine")=>{const u=getAudioContext();let p;noises.includes(o)?(p=u.createBufferSource(),p.buffer=getNoiseBuffer(o,2),p.loop=!0):(p=u.createOscillator(),p.type=o,p.frequency.value=e),p.start();const f=gainNode(t);return p.connect(f),{node:f,stop:b=>p.stop(b),osc:p}},fm=(e,t,o,u="sine")=>{const f=e.value*t,b=f*o;return mod$2(f,b,u)};function applyFM(e,t,o){const{fmh:u=1,fmi:p,fmenv:f="exp",fmattack:b,fmdecay:M,fmsustain:F,fmrelease:S,fmvelocity:k,fmwave:N="sine",duration:$}=t;let R,U=()=>{};if(p){const z=getAudioContext().createGain(),K=fm(e,u,p,N);if(R=K.node,U=K.stop,![b,M,F,S,k].some(ie=>ie!==void 0))R.connect(e);else{const[ie,he,se,ee]=getADSRValues([b,M,F,S]),pe=o+$;getParamADSR(z.gain,ie,he,se,ee,0,1,o,pe,f==="exp"?"exponential":"linear"),R.connect(z),z.connect(e)}K.osc.onended=()=>{z.disconnect(),R.disconnect(),K.osc.disconnect()}}return{stop:U}}const __squash=e=>e/(1+e),_mod=(e,t)=>(e%t+t)%t,_scurve=(e,t)=>(1+t)*e/(1+t*Math.abs(e)),_soft=(e,t)=>Math.tanh(e*(1+t)),_hard=(e,t)=>clamp((1+t)*e,-1,1),_fold=(e,t)=>{let o=(1+.5*t)*e;const u=_mod(o+1,4);return 1-Math.abs(u-2)},_sineFold=(e,t)=>Math.sin(Math.PI/2*_fold(e,t)),_cubic=(e,t)=>{const o=__squash(Math.log1p(t)),u=(e-o/3*e*e*e)/(1-o/3);return _soft(u,t)},_diode=(e,t,o=!1)=>{const u=1+2*t,f=.07*__squash(Math.log1p(t)),b=_soft(e+f,2*t),M=_soft(o?f:-e+f,2*t),F=b-M,S=1/Math.cosh(u*f),k=S*S,N=Math.max(1e-8,(o?1:2)*u*k);return _soft(F/N,t)},_asym=(e,t)=>_diode(e,t,!0),_chebyshev=(e,t)=>{const o=10*Math.log1p(t);let u=1,p=e,f,b=0;for(let M=1;M<64;M++){if(M<2){b+=M==0?u:p;continue}f=2*e*u-p,p=u,u=f,M%2===0&&(b+=Math.min(1.3*o/M,2)*f)}return _soft(b,o/20)},distortionAlgorithms={scurve:_scurve,soft:_soft,hard:_hard,cubic:_cubic,diode:_diode,asym:_asym,fold:_fold,sinefold:_sineFold,chebyshev:_chebyshev},_algoNames=Object.freeze(Object.keys(distortionAlgorithms)),getDistortionAlgorithm=e=>{let t=e;typeof e=="string"&&(t=_algoNames.indexOf(e),t===-1&&(logger$1(`[superdough] Could not find waveshaping algorithm ${e}.
        Available options are ${_algoNames.join(", ")}.
        Defaulting to ${_algoNames[0]}.`),t=0));const o=_algoNames[t%_algoNames.length];return distortionAlgorithms[o]},getDistortion=(e,t,o)=>getWorklet(getAudioContext(),"distort-processor",{distort:e,postgain:t},{processorOptions:{algorithm:o}}),getFrequencyFromValue=(e,t=36)=>{let{note:o,freq:u,octave:p=0}=e;return o=o||t,typeof o=="string"&&(o=noteToMidi(o)),!u&&typeof o=="number"&&(u=midiToFreq$1(o)),u*=Math.pow(2,p),Number(u)},destroyAudioWorkletNode=e=>{e!=null&&(e.disconnect(),e.parameters.get("end")?.setValueAtTime(0,0))};let clean=Symbol("clean"),listenerQueue=[],lqIndex=0;const QUEUE_ITEMS_PER_LISTENER=4;let atom=e=>{let t=[],o={get(){return o.lc||o.listen(()=>{})(),o.value},lc:0,listen(u){return o.lc=t.push(u),()=>{for(let f=lqIndex+QUEUE_ITEMS_PER_LISTENER;f<listenerQueue.length;)listenerQueue[f]===u?listenerQueue.splice(f,QUEUE_ITEMS_PER_LISTENER):f+=QUEUE_ITEMS_PER_LISTENER;let p=t.indexOf(u);~p&&(t.splice(p,1),--o.lc||o.off())}},notify(u,p){let f=!listenerQueue.length;for(let b of t)listenerQueue.push(b,o.value,u,p);if(f){for(lqIndex=0;lqIndex<listenerQueue.length;lqIndex+=QUEUE_ITEMS_PER_LISTENER)listenerQueue[lqIndex](listenerQueue[lqIndex+1],listenerQueue[lqIndex+2],listenerQueue[lqIndex+3]);listenerQueue.length=0}},off(){},set(u){let p=o.value;p!==u&&(o.value=u,o.notify(p))},subscribe(u){let p=o.listen(u);return u(o.value),p},value:e};return process.env.NODE_ENV!=="production"&&(o[clean]=()=>{t=[],o.lc=0,o.off()}),o},map=(e={})=>{let t=atom(e);return t.setKey=function(o,u){let p=t.value;typeof u>"u"&&o in t.value?(t.value={...t.value},delete t.value[o],t.notify(p,o)):t.value[o]!==u&&(t.value={...t.value,[o]:u},t.notify(p,o))},t};const bufferCache$1={},loadCache$2={},getCachedBuffer=e=>bufferCache$1[e];function humanFileSize$1(e,t){var o=1024;if(e<o)return e+" B";var u=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],p=-1;do e/=o,++p;while(e>=o);return e.toFixed(1)+" "+u[p]}function getSampleInfo(e,t){const{speed:o=1}=e,{transpose:u,url:p,index:f,midi:b,label:M}=getCommonSampleInfo(e,t);let F=Math.abs(o)*Math.pow(2,u/12);return{transpose:u,url:p,index:f,midi:b,label:M,playbackRate:F}}const getSampleBuffer=async(e,t,o)=>{let{url:u,label:p,playbackRate:f}=getSampleInfo(e,t);o&&(u=await o(u));const b=getAudioContext(),M=await loadBuffer$1(u,b,p);return e.unit==="c"&&(f=f*M.duration),{buffer:M,playbackRate:f}},getSampleBufferSource=async(e,t,o)=>{let{buffer:u,playbackRate:p}=await getSampleBuffer(e,t,o);e.speed<0&&(u=reverseBuffer(u));const b=getAudioContext().createBufferSource();b.buffer=u,b.playbackRate.value=p;const{loopBegin:M=0,loopEnd:F=1,begin:S=0,end:k=1}=e,N=S*b.buffer.duration;e.loop&&(b.loop=!0,b.loopStart=M*b.buffer.duration-N,b.loopEnd=F*b.buffer.duration-N);const R=b.buffer.duration/b.playbackRate.value,U=(k-S)*R;return{bufferSource:b,offset:N,bufferDuration:R,sliceDuration:U}},loadBuffer$1=(e,t,o,u=0)=>{const p=o?`sound "${o}:${u}"`:"sample";if(e=e.replace("#","%23"),!loadCache$2[e]){logger$1(`[sampler] load ${p}..`,"load-sample",{url:e});const f=Date.now();loadCache$2[e]=fetch(e).then(b=>b.arrayBuffer()).then(async b=>{const M=Date.now()-f,F=humanFileSize$1(b.byteLength);logger$1(`[sampler] load ${p}... done! loaded ${F} in ${M}ms`,"loaded-sample",{url:e});const S=await t.decodeAudioData(b);return bufferCache$1[e]=S,S})}return loadCache$2[e]};function reverseBuffer(e){const t=getAudioContext(),o=t.createBuffer(e.numberOfChannels,e.length,t.sampleRate);for(let u=0;u<e.numberOfChannels;u++)o.copyToChannel(e.getChannelData(u).slice().reverse(),u,u);return o}const getLoadedBuffer=e=>bufferCache$1[e];function resolveSpecialPaths(e){if(e.startsWith("bubo:")){const[t,o]=e.split(":");e=`github:Bubobubobubobubo/dough-${o}`}return e}function githubPath$2(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let o=e.slice(7);o=o.endsWith("/")?o.slice(0,-1):o;let u=o.split("/"),p=u[0],f=u.length>=2?u[1]:"samples",b=u.length>=3?u[2]:"main",M=u.slice(3);return M.push(t||""),M=M.join("/"),`https://raw.githubusercontent.com/${p}/${f}/${b}/${M}`}const processSampleMap=(e,t,o=e._base||"")=>Object.entries(e).forEach(([u,p])=>{if(typeof p=="string"&&(p=[p]),typeof p!="object")throw new Error("wrong sample map format for "+u);o=p._base||o,o=resolveSpecialPaths(o),o.startsWith("github:")&&(o=githubPath$2(o,""));const f=b=>o+b;Array.isArray(p)?p=p.map(f):p=Object.fromEntries(Object.entries(p).map(([b,M])=>[b,(typeof M=="string"?[M]:M).map(f)])),t(u,p)});let resourcePrefixHandlers={};function registerSamplesPrefix(e,t){resourcePrefixHandlers[e]=t}function getSamplesPrefixHandler(e){const t=Object.entries(resourcePrefixHandlers).find(([o])=>e.startsWith(o));if(t)return t[1]}async function fetchSampleMap$1(e){const t=getSamplesPrefixHandler(e);if(t)return t(e);if(e=resolveSpecialPaths(e),e.startsWith("github:")&&(e=githubPath$2(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[p,f]=e.split("shabda:");e=`https://shabda.ndre.gr/${f}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[p,f]=e.split("shabda/speech");f=f.startsWith("/")?f.substring(1):f;let[b,M]=f.split(":"),F="f",S="en-GB";b&&([S,F]=b.split("/")),e=`https://shabda.ndre.gr/speech/${M}.json?gender=${F}&language=${S}&strudel=1'`}if(typeof fetch!="function")return;const o=getBaseURL(e);if(typeof fetch>"u")return;const u=await fetch(e).then(p=>p.json()).catch(p=>{throw console.error(p),new Error(`error loading "${e}"`)});return[u,u._base||o]}const samples=async(e,t=e._base||"",o={})=>{if(typeof e=="string"){const[f,b]=await fetchSampleMap$1(e);return samples(f,t||b,o)}const{prebake:u,tag:p}=o;processSampleMap(e,(f,b)=>{registerSampleSource(f,b,{baseUrl:t,prebake:u,tag:p})},t)},cutGroups=[];async function onTriggerSample(e,t,o,u,p){let{s:f,nudge:b=0,cut:M,loop:F,clip:S=void 0,n:k=0,speed:N=1,duration:$}=t;if(N===0)return;const R=getAudioContext();let[U,V,z,K]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);const{bufferSource:ie,sliceDuration:he,offset:se}=await getSampleBufferSource(t,u,p);if(R.currentTime>e){logger$1(`[sampler] still loading sound "${f}:${k}"`,"highlight");return}if(!ie){logger$1(`[sampler] could not load "${f}:${k}"`,"error");return}let ee=getVibratoOscillator(ie.detune,t,e);const pe=e+b;ie.start(pe,se);const _e=R.createGain(),ve=ie.connect(_e);S==null&&F==null&&t.release==null&&($=he);let we=e+$;getParamADSR(ve.gain,U,V,z,K,0,1,e,we,"linear"),getPitchEnvelope(ie.detune,t,e,we);const xe=R.createGain();ve.connect(xe),ie.onended=function(){ie.disconnect(),ee?.stop(),ve.disconnect(),xe.disconnect(),o()};let Oe=we+K+.01;ie.stop(Oe);const Le={node:xe,bufferSource:ie,stop:Xe=>{ie.stop(Xe)}};if(M!==void 0){const Xe=cutGroups[M];Xe&&(Xe.node.gain.setValueAtTime(1,pe),Xe.node.gain.linearRampToValueAtTime(0,pe+.01)),cutGroups[M]=Le}return Le}function registerSample(e,t,o){registerSound(e,(u,p,f)=>onTriggerSample(u,p,f,t),{type:"sample",samples:t,...o})}function registerSampleSource(e,t,o){e.startsWith("wt_")?registerWaveTable(e,t,o):registerSample(e,t,o)}let hasChanged=(e,t)=>e!==void 0&&e!==t;class Orbit{reverbNode;delayNode;output;summingNode;djfNode;audioContext;constructor(t){this.audioContext=t,this.output=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode.connect(this.output)}disconnect(){this.output.disconnect(),this.summingNode.disconnect(),this.delayNode?.disconnect(),this.reverbNode?.disconnect()}getDjf(t,o=0){this.djfNode==null&&(this.djfNode=getWorklet(this.audioContext,"djf-processor",{value:t}),this.summingNode.disconnect(),this.summingNode.connect(this.djfNode),this.djfNode.connect(this.output)),this.djfNode.parameters.get("value").setValueAtTime(t,o)}getDelay(t=0,o=.5,u){return o=clamp(o,0,.98),this.delayNode==null&&(this.delayNode=this.audioContext.createFeedbackDelay(1,t,o),this.delayNode.connect(this.summingNode),this.delayNode.start?.(u)),this.delayNode.delayTime.value!==t&&this.delayNode.delayTime.setValueAtTime(t,u),this.delayNode.feedback.value!==o&&this.delayNode.feedback.setValueAtTime(o,u),this.delayNode}getReverb(t,o,u,p,f,b,M){return this.reverbNode==null&&(this.reverbNode=this.audioContext.createReverb(t,o,u,p,f,b,M),this.reverbNode.connect(this.summingNode)),(hasChanged(t,this.reverbNode.duration)||hasChanged(o,this.reverbNode.fade)||hasChanged(u,this.reverbNode.lp)||hasChanged(p,this.reverbNode.dim)||hasChanged(b,this.reverbNode.irspeed)||hasChanged(M,this.reverbNode.irbegin)||this.reverbNode.ir!==f)&&this.reverbNode.generate(t,o,u,p,f,b,M),this.reverbNode}sendReverb(t,o){return effectSend(t,this.reverbNode,o)}sendDelay(t,o){return effectSend(t,this.delayNode,o)}duck(t,o=0,u=.1,p=1){const f=o,b=Math.max(u,.002),M=this.output.gain;webAudioTimeout(this.audioContext,()=>{const F=this.audioContext.currentTime,S=M.value;M.cancelScheduledValues(F),M.setValueAtTime(S,F);const k=Math.max(t,F),N=clamp(1-Math.sqrt(p),.01,S);M.exponentialRampToValueAtTime(N,k+f),M.exponentialRampToValueAtTime(1,k+f+b)},0,t-.01)}connectToOutput(t){t.connect(this.summingNode)}}class SuperdoughOutput{channelMerger;destinationGain;constructor(t){this.audioContext=t,this.initializeAudio()}initializeAudio(){const t=this.audioContext,o=t.destination.maxChannelCount;this.audioContext.destination.channelCount=o,this.channelMerger=new ChannelMergerNode(t,{numberOfInputs:t.destination.channelCount}),this.destinationGain=new GainNode(t),this.channelMerger.connect(this.destinationGain),this.destinationGain.connect(t.destination)}reset(){this.disconnect(),this.initializeAudio()}disconnect(){this.channelMerger.disconnect(),this.destinationGain.disconnect(),this.destinationGain=null,this.channelMerger=null}connectToDestination=(t,o=[0,1])=>{const u=new StereoPannerNode(this.audioContext);t.connect(u);const p=new ChannelSplitterNode(this.audioContext,{numberOfOutputs:u.channelCount});u.connect(p),o.forEach((f,b)=>{p.connect(this.channelMerger,b%u.channelCount,f%this.audioContext.destination.channelCount)})}}class SuperdoughAudioController{audioContext;output;nodes={};constructor(t){this.audioContext=t,this.output=new SuperdoughOutput(t)}reset(){Array.from(this.nodes).forEach(t=>{t.disconnect()}),this.nodes={},this.output.reset()}duck(t,o,u=0,p=.1,f=1){const b=[t].flat(),M=[u].flat(),F=[p].flat(),S=[f].flat();b.forEach((k,N)=>{const $=this.nodes[k];if($==null){errorLogger(new Error(`duck target orbit ${k} does not exist`),"superdough");return}const R=M[N]??M[0],U=Math.max(F[N]??F[0],.002),V=S[N]??S[0];$.duck(o,R,U,V)})}getOrbit(t,o){return this.nodes[t]==null&&(this.nodes[t]=new Orbit(this.audioContext),this.output.connectToDestination(this.nodes[t].output,o)),this.nodes[t]}}const DEFAULT_MAX_POLYPHONY=128,DEFAULT_AUDIO_DEVICE_NAME="System Standard";let maxPolyphony=DEFAULT_MAX_POLYPHONY;function setMaxPolyphony(e){maxPolyphony=parseInt(e)??DEFAULT_MAX_POLYPHONY}let multiChannelOrbits=!1;function setMultiChannelOrbits(e){multiChannelOrbits=e==!0}const soundMap$1=map();function registerSound(e,t,o={}){e=e.toLowerCase().replace(/\s+/g,"_"),soundMap$1.setKey(e,{onTrigger:t,data:o})}let gainCurveFunc=e=>e;function applyGainCurve(e){return gainCurveFunc(e)}function setGainCurve(e){gainCurveFunc=e}function aliasBankMap(e){for(const o in e)e[o.toLowerCase()]=e[o];const t=soundMap$1.get();for(const o in t){const[u,p]=o.split("_");if(!p)continue;const f=e[u];if(f){if(typeof f=="string")t[`${f}_${p}`.toLowerCase()]=t[o];else if(Array.isArray(f))for(const b of f)t[`${b}_${p}`.toLowerCase()]=t[o]}}soundMap$1.set({...t})}async function aliasBankPath(e){const o=await(await fetch(e)).json();aliasBankMap(o)}async function aliasBank(...e){switch(e.length){case 1:return typeof e[0]=="string"?aliasBankPath(e[0]):aliasBankMap(e[0]);case 2:return aliasBankMap({[e[0]]:e[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+e.length)}}function soundAlias(e,t){if(getSound(e)==null){logger$1("soundAlias: original sound not found");return}soundMap$1.setKey(t,getSound(e))}function getSound(e){return typeof e!="string"?(console.warn(`getSound: expected string got "${e}". fall back to triangle`),soundMap$1.get().triangle):soundMap$1.get()[e.toLowerCase()]}const getAudioDevices=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let e=await navigator.mediaDevices.enumerateDevices();e=e.filter(o=>o.kind==="audiooutput"&&o.deviceId!=="default");const t=new Map;return t.set(DEFAULT_AUDIO_DEVICE_NAME,""),e.forEach(o=>{t.set(o.label,o.deviceId)}),t};let defaultDefaultValues={s:"triangle",gain:.8,postgain:1,density:".03",channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const defaultDefaultDefaultValues=Object.freeze({...defaultDefaultValues});function setDefault(e,t){defaultDefaultValues[e]=t}function resetDefaults(){defaultDefaultValues={...defaultDefaultDefaultValues}}let defaultControls=new Map(Object.entries(defaultDefaultValues));function setDefaultValue(e,t){defaultControls.set(e,t)}function getDefaultValue(e){return defaultControls.get(e)}function setDefaultValues(e){Object.keys(e).forEach(t=>{setDefaultValue(t,e[t])})}function resetDefaultValues(){defaultControls=new Map(Object.entries(defaultDefaultValues))}function setVersionDefaults(e){resetDefaultValues(),e==="1.0"&&setDefaultValue("fanchor",.5)}const resetLoadedSounds=()=>soundMap$1.set({});let externalWorklets=[];function registerWorklet(e){externalWorklets.push(e)}let workletsLoading;function loadWorklets(){if(!workletsLoading){const e=getAudioContext(),t=externalWorklets.concat([workletsUrl]);workletsLoading=Promise.all(t.map(o=>e.audioWorklet.addModule(o)))}return workletsLoading}async function initAudio(e={}){const{disableWorklets:t=!1,maxPolyphony:o,audioDeviceName:u=DEFAULT_AUDIO_DEVICE_NAME,multiChannelOrbits:p=!1}=e;if(setMaxPolyphony(o),setMultiChannelOrbits(p),typeof window>"u")return;const f=getAudioContext();if(u!=null&&u!=DEFAULT_AUDIO_DEVICE_NAME)try{const M=(await getAudioDevices()).get(u),F=(M??"").length>0;f.sinkId!==M&&F&&await f.setSinkId(M),logger$1(`[superdough] Audio Device set to ${u}, it might take a few seconds before audio plays on all output channels`)}catch{logger$1("[superdough] failed to set audio interface","warning")}if(await f.resume(),t){logger$1("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await loadWorklets(),logger$1("[superdough] AudioWorklets loaded")}catch(b){console.warn("could not load AudioWorklet effects",b)}logger$1("[superdough] ready")}let audioReady;async function initAudioOnFirstClick(e){return audioReady||(audioReady=new Promise(t=>{document.addEventListener("mousedown",async function o(){document.removeEventListener("mousedown",o),await initAudio(e),t()})})),audioReady}let controller;function getSuperdoughAudioController(){return controller==null&&(controller=new SuperdoughAudioController(getAudioContext())),controller}function connectToDestination(e,t){getSuperdoughAudioController().output.connectToDestination(e,t)}function getPhaser(e,t,o=1,u=.5,p=1e3,f=2e3){const b=getAudioContext(),M=getLfo(b,e,t,{frequency:o,depth:f*2}),F=2;let S=0;const k=[];for(let N=0;N<F;N++){const $=b.createBiquadFilter();$.type="notch",$.gain.value=1,$.frequency.value=p+S,$.Q.value=2-Math.min(Math.max(u*2,0),1.9),M.connect($.detune),S+=282,N>0&&k[N-1].connect($),k.push($)}return{phaser:k[k.length-1],lfo:M}}function getFilterType(e){e=e??0;const t=["12db","ladder","24db"];return typeof e=="number"?t[Math.floor(_mod$1(e,t.length))]:e}let analysers={},analysersData={};function getAnalyserById(e,t=1024,o=.5){if(!analysers[e]){const u=getAudioContext().createAnalyser();u.fftSize=t,u.smoothingTimeConstant=o,analysers[e]=u,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)}return analysers[e].fftSize!==t&&(analysers[e].fftSize=t,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)),analysers[e]}function getAnalyzerData(e="time",t=1){const o={time:()=>analysers[t]?.getFloatTimeDomainData(analysersData[t]),frequency:()=>analysers[t]?.getFloatFrequencyData(analysersData[t])}[e];if(!o)throw new Error(`getAnalyzerData: ${e} not supported. use one of ${Object.keys(o).join(", ")}`);return o(),analysersData[t]}function resetGlobalEffects(){controller?.reset(),analysers={},analysersData={}}let activeSoundSources=new Map;function mapChannelNumbers(e){return(Array.isArray(e)?e:[e]).map(t=>t-1)}const superdough=async(e,t,o,u=.5,p=.5)=>{const f=getAudioContext(),b=getSuperdoughAudioController();let{stretch:M}=e;if(M!=null&&(t=t-.04),typeof e!="object")throw new Error(`expected hap.value to be an object, but got "${e}". Hint: append .note() or .s() to the end`,"error");if(e.duration=o,t<f.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${t.toFixed(2)}, now: ${f.currentTime.toFixed(2)})`);return}let{tremolo:F,tremolosync:S,tremolodepth:k=1,tremoloskew:N,tremolophase:$=0,tremoloshape:R,s:U=getDefaultValue("s"),bank:V,source:z,gain:K=getDefaultValue("gain"),postgain:ie=getDefaultValue("postgain"),density:he=getDefaultValue("density"),duckorbit:se,duckonset:ee,duckattack:pe,duckdepth:_e,djf:ve,fanchor:we=getDefaultValue("fanchor"),release:xe=0,phaserrate:Oe,phaserdepth:Pe=getDefaultValue("phaserdepth"),phasersweep:Le,phasercenter:Xe,coarse:Ke,crush:me,dry:ye,shape:Se,shapevol:qe=getDefaultValue("shapevol"),distort:st,distortvol:mt=getDefaultValue("distortvol"),distorttype:Ee=getDefaultValue("distorttype"),pan:rt,vowel:St,delay:pt=getDefaultValue("delay"),delayfeedback:bt=getDefaultValue("delayfeedback"),delaysync:yt=getDefaultValue("delaysync"),delaytime:At,orbit:Et=getDefaultValue("orbit"),room:Kt,roomfade:jt,roomlp:Nt,roomdim:_t,roomsize:$t,ir:sn,irspeed:kt,irbegin:Ot,i:Wt=getDefaultValue("i"),velocity:Ae=getDefaultValue("velocity"),analyze:Ce,fft:ge=getDefaultValue("fft"),compressor:Te,compressorRatio:ze,compressorKnee:Ne,compressorAttack:De,compressorRelease:Ie}=e;At=At??cycleToSeconds(yt,u);const Ge=mapChannelNumbers(multiChannelOrbits&&Et>0?[Et*2-1,Et*2]:getDefaultValue("channels")),He=e.channels!=null?mapChannelNumbers(e.channels):Ge,it=b.getOrbit(Et,He);se!=null&&b.duck(se,t,ee,pe,_e),K=applyGainCurve(nanFallback(K,1)),ie=applyGainCurve(ie),qe=applyGainCurve(qe),mt=applyGainCurve(mt),pt=applyGainCurve(pt),Ae=applyGainCurve(Ae),k=applyGainCurve(k),K*=Ae;const Gt=t+o,zt=Gt+xe,Ue=Math.round(Math.random()*1e6);for(let tt=0;tt<=activeSoundSources.size-maxPolyphony;tt++){const Ct=activeSoundSources.entries().next(),Mt=Ct.value[1].deref(),Zt=Ct.value[0],nn=t+.25;Mt?.node?.gain?.linearRampToValueAtTime(0,nn),Mt?.stop?.(nn),activeSoundSources.delete(Zt)}let Dt=[];if(["-","~","_"].includes(U))return;V&&U&&(U=`${V}_${U}`,e.s=U);let It;if(z)It=z(t,e,o,u);else if(getSound(U)){const{onTrigger:tt}=getSound(U),Mt=await tt(t,e,()=>{Dt.forEach(Zt=>Zt?.disconnect()),activeSoundSources.delete(Ue)},u);Mt&&(It=Mt.node,activeSoundSources.set(Ue,new WeakRef(Mt)))}else throw new Error(`sound ${U} not found! Is it loaded?`);if(!It)return;if(f.currentTime>t){logger$1("[webaudio] skip hap: still loading",f.currentTime-t);return}const Qe=[];Qe.push(It),M!==void 0&&Qe.push(getWorklet(f,"phase-vocoder-processor",{pitchFactor:M})),Qe.push(gainNode(K));const Bt=getFilterType(e.ftype);if(e.cutoff!==void 0){const Ct=pickAndRename(e,{frequency:"cutoff",q:"resonance",attack:"lpattack",decay:"lpdecay",sustain:"lpsustain",release:"lprelease",env:"lpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"lprate",sync:"lpsync",depth:"lpdepth",depthfrequency:"lpdepthfrequency",shape:"lpshape",dcoffset:"lpdc",skew:"lpskew"});Ct.type="lowpass";const Mt=()=>createFilter(f,t,Gt,Ct,u,p),{filter:Zt,lfo:nn}=Mt();if(Qe.push(Zt),nn&&Dt.push(nn),Bt==="24db"){const{filter:an,lfo:An}=Mt();Qe.push(an),An&&Dt.push(An)}}if(e.hcutoff!==void 0){const Ct=pickAndRename(e,{frequency:"hcutoff",q:"hresonance",attack:"hpattack",decay:"hpdecay",sustain:"hpsustain",release:"hprelease",env:"hpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"hprate",sync:"hpsync",depth:"hpdepth",depthfrequency:"hpdepthfrequency",shape:"hpshape",dcoffset:"hpdc",skew:"hpskew"});Ct.type="highpass";const Mt=()=>createFilter(f,t,Gt,Ct,u,p),{filter:Zt,lfo:nn}=Mt();if(Qe.push(Zt),nn&&Dt.push(nn),Bt==="24db"){const{filter:an,lfo:An}=Mt();Qe.push(an),An&&Dt.push(An)}}if(e.bandf!==void 0){const Ct=pickAndRename(e,{frequency:"bandf",q:"bandq",attack:"bpattack",decay:"bpdecay",sustain:"bpsustain",release:"bprelease",env:"bpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"bprate",sync:"bpsync",depth:"bpdepth",depthfrequency:"bpdepthfrequency",shape:"bpshape",dcoffset:"bpdc",skew:"bpskew"});Ct.type="bandpass";const Mt=()=>createFilter(f,t,Gt,Ct,u,p),{filter:Zt,lfo:nn}=Mt();if(Qe.push(Zt),nn&&Dt.push(nn),Bt==="24db"){const{filter:an,lfo:An}=Mt();Qe.push(an),An&&Dt.push(An)}}if(St!==void 0){const tt=f.createVowelFilter(St);Qe.push(tt)}if(Ke!==void 0&&Qe.push(getWorklet(f,"coarse-processor",{coarse:Ke})),me!==void 0&&Qe.push(getWorklet(f,"crush-processor",{crush:me})),Se!==void 0&&Qe.push(getWorklet(f,"shape-processor",{shape:Se,postgain:qe})),st!==void 0&&Qe.push(getDistortion(st,mt,Ee)),S!=null&&(F=u*S),e.wtPosSynced!=null&&(e.wtPosRate/=u),e.wtWarpSynced!=null&&(e.wtWarpRate/=u),F!==void 0){const tt=Math.max(1-k,0),Ct=new GainNode(f,{gain:tt}),Mt=p/u,Zt=getLfo(f,t,zt,{skew:N??(R!=null?.5:1),frequency:F,depth:k,time:Mt,dcoffset:0,shape:R,phaseoffset:$,min:0,max:1,curve:1.5});Zt.connect(Ct.gain),Dt.push(Zt),Qe.push(Ct)}if(Te!==void 0&&Qe.push(getCompressor(f,Te,ze,Ne,De,Ie)),rt!==void 0){const tt=f.createStereoPanner();tt.pan.value=2*rt-1,Qe.push(tt)}if(Oe!==void 0&&Pe>0){const{phaser:tt,lfo:Ct}=getPhaser(t,zt,Oe,Pe,Xe,Le);Dt.push(Ct),Qe.push(tt)}const on=new GainNode(f,{gain:ie});if(Qe.push(on),pt>0&&At>0&&bt>0){it.getDelay(At,bt,t);const tt=it.sendDelay(on,pt);Dt.push(tt)}if(Kt>0){let tt;if(sn!==void 0){let Mt,Zt=getSound(sn);Array.isArray(Zt)?Mt=Zt.data.samples[Wt%Zt.data.samples.length]:typeof Zt=="object"&&(Mt=Object.values(Zt.data.samples).flat()[Wt%Object.values(Zt.data.samples).length]),tt=await loadBuffer$1(Mt,f,sn,0)}it.getReverb($t,jt,Nt,_t,tt,kt,Ot);const Ct=it.sendReverb(on,Kt);Dt.push(Ct)}if(ve!=null&&it.getDjf(ve,t),Ce){const tt=getAnalyserById(Ce,2**(ge+5)),Ct=effectSend(on,tt,1);Dt.push(Ct)}if(ye!=null){ye=applyGainCurve(ye);const tt=new GainNode(f,{gain:ye});Qe.push(tt),it.connectToOutput(tt)}else it.connectToOutput(on);Qe.slice(1).reduce((tt,Ct)=>tt.connect(Ct),Qe[0]),Dt=Dt.concat(Qe)},superdoughTrigger=(e,t,o,u)=>{superdough(t,e-o,t.duration/u,u)},waveforms=["triangle","square","sawtooth","sine","user"],waveformAliases=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function makeSaturationCurve(e,t){const o=e,u=new Float32Array(t);for(let p=0;p<t;p++){const f=p*2/t-1;u[p]=Math.tanh(f*o)}return u}function registerSynthSounds(){[...waveforms].forEach(e=>{registerSound(e,(t,o,u)=>{const[p,f,b,M]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]),F=gainNode(.3);let S=getOscillator(e,t,o,()=>{F.disconnect(),u()}),{node:k,stop:N,triggerRelease:$}=S;const{duration:R}=o,U=gainNode(1);let V=k.connect(F).connect(U);const z=t+R;getParamADSR(V.gain,p,f,b,M,0,1,t,z,"linear");const K=z+M+.01;return $?.(K),N(K),{node:V,stop:ie=>{N(ie)}}},{type:"synth",prebake:!0})}),registerSound("sbd",(e,t,o)=>{const{duration:u,decay:p=.5,pdecay:f=.5,penv:b=36,clip:M}=t,F=getAudioContext(),S=.02,k=1.2,N=.025,$=1,R=F.createOscillator();R.type="triangle",R.frequency.value=getFrequencyFromValue(t,29),R.detune.setValueAtTime(b*100,0),R.detune.setValueAtTime(b*100,e),R.detune.exponentialRampToValueAtTime(.001,e+f);const U=gainNode(1);U.gain.setValueAtTime(1,e+S),U.gain.exponentialRampToValueAtTime(.001,e+S+p),R.start(e);const V=getNoiseOscillator("brown",e,2),z=gainNode(1);z.gain.setValueAtTime(k,e),z.gain.exponentialRampToValueAtTime(.001,e+N);const K=new WaveShaperNode(F);K.curve=makeSaturationCurve(2,F.sampleRate);const ie=gainNode($);R.onended=()=>{R.disconnect(),U.disconnect(),K.disconnect(),V.node.disconnect(),z.disconnect(),ie.disconnect(),o()};const he=R.connect(K).connect(U).connect(ie);V.node.connect(z).connect(ie);let ee=e+p+.01;return M!=null&&(ee=Math.min(e+M*u,ee)),ie.gain.setValueAtTime($,ee-.01),ie.gain.linearRampToValueAtTime(0,ee),R.stop(ee),V.stop(ee),{node:he,stop:pe=>{R.stop(pe)}}},{type:"synth",prebake:!0}),registerSound("supersaw",(e,t,o)=>{const u=getAudioContext();let{duration:p,n:f,unison:b=5,spread:M=.6,detune:F}=t;F=F??f??.18;const S=getFrequencyFromValue(t),[k,N,$,R]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),U=e+p,V=U+R+.01,z=clamp(b,1,100);let K=z>1?clamp(M,0,1):0,ie=getWorklet(u,"supersaw-oscillator",{frequency:S,begin:e,end:V,freqspread:F,voices:z,panspread:K},{outputChannelCount:[2]});const he=1/Math.sqrt(z);getPitchEnvelope(ie.parameters.get("detune"),t,e,U);const se=getVibratoOscillator(ie.parameters.get("detune"),t,e),ee=applyFM(ie.parameters.get("frequency"),t,e);let pe=gainNode(1);pe=ie.connect(pe),getParamADSR(pe.gain,k,N,$,R,0,.3*he,e,U,"linear");let _e=webAudioTimeout(u,()=>{destroyAudioWorkletNode(ie),pe.disconnect(),o(),ee?.stop(),se?.stop()},e,V);return{node:pe,stop:ve=>{_e.stop(ve)}}},{prebake:!0,type:"synth"}),registerSound("bytebeat",(e,t,o)=>{const u=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:p=0}=t,f=getFrequencyFromValue(t),{byteBeatExpression:b=u[p%u.length],byteBeatStartTime:M}=t,F=getAudioContext();let{duration:S}=t;const[k,N,$,R]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),U=e+S,V=U+R+.01;let z=getWorklet(F,"byte-beat-processor",{frequency:f,begin:e,end:V},{outputChannelCount:[2]});z.port.postMessage({codeText:b,byteBeatStartTime:M,frequency:f});let K=gainNode(1);K=z.connect(K),getParamADSR(K.gain,k,N,$,R,0,1,e,U,"linear");let ie=webAudioTimeout(F,()=>{destroyAudioWorkletNode(z),K.disconnect(),o()},e,V);return{node:K,stop:he=>{ie.stop(he)}}},{prebake:!0,type:"synth"}),registerSound("pulse",(e,t,o)=>{const u=getAudioContext();let{pwrate:p,pwsweep:f}=t;f==null&&(p!=null?f=.3:f=0),p==null&&f!=null&&(p=1);let{duration:b,pw:M=.5}=t;const F=getFrequencyFromValue(t),[S,k,N,$]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),R=e+b,U=R+$+.01;let V=getWorklet(u,"pulse-oscillator",{frequency:F,begin:e,end:U,pulsewidth:M},{outputChannelCount:[2]});getPitchEnvelope(V.parameters.get("detune"),t,e,R);const z=getVibratoOscillator(V.parameters.get("detune"),t,e),K=applyFM(V.parameters.get("frequency"),t,e);let ie=gainNode(1);ie=V.connect(ie),getParamADSR(ie.gain,S,k,N,$,0,1,e,R,"linear");let he;f!=0&&(he=getLfo(u,e,U,{frequency:p,depth:f}),he.connect(V.parameters.get("pulsewidth")));let se=webAudioTimeout(u,()=>{destroyAudioWorkletNode(V),destroyAudioWorkletNode(he),ie.disconnect(),o(),K?.stop(),z?.stop()},e,U);return{node:ie,stop:ee=>{se.stop(ee)}}},{prebake:!0,type:"synth"}),[...noises].forEach(e=>{registerSound(e,(t,o,u)=>{const[p,f,b,M]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]);let F,{density:S}=o;F=getNoiseOscillator(e,t,S);let{node:k,stop:N,triggerRelease:$}=F;const R=gainNode(.3),{duration:U}=o;k.onended=()=>{k.disconnect(),R.disconnect(),u()};const V=gainNode(1);let z=k.connect(R).connect(V);const K=t+U;getParamADSR(z.gain,p,f,b,M,0,1,t,K,"linear");const ie=K+M+.01;return $?.(ie),N(ie),{node:z,stop:he=>{N(he)}}},{type:"synth",prebake:!0})}),waveformAliases.forEach(([e,t])=>soundMap$1.set({...soundMap$1.get(),[e]:soundMap$1.get()[t]}))}const PI2=2*Math.PI;function waveformN(e,t,o){e=typeof e=="object"?e:new Float32Array(e).fill(1);const p=e.length,f=new Float32Array(p+1),b=new Float32Array(p+1),M=getAudioContext(),F=M.createOscillator(),S={sawtooth:N=>[0,-1/N],square:N=>[0,N%2===0?0:1/N],triangle:N=>[N%2===0?0:1/(N*N),0],user:N=>[0,1]};if(!S[o])throw new Error(`unknown wave type ${o}`);for(let N=0;N<p;N++){const $=e[N],[R,U]=S[o](N+1),V=t?.[N]??0;let z=R*$,K=U*$;if(V!==0){const ie=Math.cos(PI2*V),he=Math.sin(PI2*V);z=ie*z-he*K,K=he*z+ie*K}f[N+1]=z,b[N+1]=K}const k=M.createPeriodicWave(f,b);return F.setPeriodicWave(k),F}function getOscillator(e,t,o,u){const{duration:p,noise:f=0}=o,b=o.partials??o.n;let M;e==="user"&&!b&&(logger$1("[superdough] Synth 'user' was selected, but partials not specified. Defaulting to triangle. Use pat.partials to setup custom waveform"),e="triangle"),e=e==="user"&&!b?"triangle":e,!b||b?.length===0||e==="sine"?(M=getAudioContext().createOscillator(),M.type=e||"triangle"):M=waveformN(b,o.phases,e),M.frequency.value=getFrequencyFromValue(o);let F=getVibratoOscillator(M.detune,o,t);getPitchEnvelope(M.detune,o,t,t+p);const S=applyFM(M.frequency,o,t);let k;return f&&(k=getNoiseMix(M,f,t)),M.onended=()=>{k||M.disconnect(),k?.node.disconnect(),u()},M.start(t),{node:k?.node||M,stop:N=>{S.stop(N),F?.stop(N),k?.stop(N),M.stop(N)},triggerRelease:N=>{}}}function buildSamples(e=1,t=.05,o=220,u=0,p=0,f=.1,b=0,M=1,F=0,S=0,k=0,N=0,$=0,R=0,U=0,V=0,z=0,K=1,ie=0,he=0){let se=Math.PI*2,ee=getAudioContext().sampleRate,pe=qe=>qe>0?1:-1,_e=F*=500*se/ee/ee,ve=o*=(1+t*2*Math.random()-t)*se/ee,we=[],xe=0,Oe=0,Pe=0,Le=1,Xe=0,Ke=0,me=0,ye,Se;for(u=u*ee+9,ie*=ee,p*=ee,f*=ee,z*=ee,S*=500*se/ee**3,U*=se/ee,k*=se/ee,N*=ee,$=$*ee|0,Se=u+ie+p+f+z|0;Pe<Se;we[Pe++]=me)++Ke%(V*100|0)||(me=b?b>1?b>2?b>3?Math.sin((xe%se)**3):Math.max(Math.min(Math.tan(xe),1),-1):1-(2*xe/se%2+2)%2:1-4*Math.abs(Math.round(xe/se)-xe/se):Math.sin(xe),me=($?1-he+he*Math.sin(se*Pe/$):1)*pe(me)*Math.abs(me)**M*e*1*(Pe<u?Pe/u:Pe<u+ie?1-(Pe-u)/ie*(1-K):Pe<u+ie+p?K:Pe<Se-z?(Se-Pe-z)/f*K:0),me=z?me/2+(z>Pe?0:(Pe<Se-z?1:(Se-Pe)/z)*we[Pe-z|0]/2):me),ye=(o+=F+=S)*Math.cos(U*Oe++),xe+=ye-ye*R*(1-(Math.sin(Pe)+1)*1e9%2),Le&&++Le>N&&(o+=k,ve+=k,Le=0),$&&!(++Xe%$)&&(o=ve,F=_e,Le||=1);return we}const getZZFX=(e,t)=>{let{s:o,note:u=36,freq:p,zrand:f=0,attack:b=0,decay:M=0,sustain:F=.8,release:S=.1,curve:k=1,slide:N=0,deltaSlide:$=0,pitchJump:R=0,pitchJumpTime:U=0,lfo:V=0,znoise:z=0,zmod:K=0,zcrush:ie=0,zdelay:he=0,tremolo:se=0,duration:ee=.2,zzfx:pe}=e;const _e=Math.max(ee-b-M,0);typeof u=="string"&&(u=noteToMidi(u)),!p&&typeof u=="number"&&(p=midiToFreq$1(u)),o=o.replace("z_","");const ve=["sine","triangle","sawtooth","tan","noise"].indexOf(o)||0;k=o==="square"?0:k;const xe=buildSamples(...pe||[.25,f,p,b,_e,S,ve,k,N,$,R,U,V,z,K,ie,he,F,M,se]),Oe=getAudioContext(),Pe=Oe.createBuffer(1,xe.length,Oe.sampleRate);Pe.getChannelData(0).set(xe);const Le=getAudioContext().createBufferSource();return Le.buffer=Pe,Le.start(t),{node:Le}};function registerZZFXSounds(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(e=>{registerSound(e,(t,o,u)=>{const{node:p}=getZZFX({s:e,...o},t);return p.onended=()=>{p.disconnect(),u()},{node:p,stop:()=>{}}},{type:"synth",prebake:!0})})}let worklet;async function dspWorklet(e,t){const o=`dsp-worklet-${Date.now()}`,u=`${t}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${o}', MyProcessor);
`,f=`data:text/javascript;base64,${btoa(u)}`;await e.audioWorklet.addModule(f);const b=new AudioWorkletNode(e,o);return{node:b,stop:()=>b.port.postMessage("stop")}}const stop=()=>{worklet&&(worklet?.stop(),worklet?.node?.disconnect())};typeof window<"u"&&window.addEventListener("message",e=>{e.data==="strudel-stop"?stop():e.data?.dough&&worklet?.node.port.postMessage(e.data)});const dough=async e=>{const t=getAudioContext();stop(),worklet=await dspWorklet(t,e),worklet.node.connect(t.destination)};function doughTrigger(e,t,o,u){window.postMessage({time:u,dough:e.value,currentTime:t,duration:e.duration,cps:o})}const Warpmode=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),seenKeys=new Set;async function getPayload(e,t,o=2048){const u=`${e},${o}`;if(!seenKeys.has(u)){const f=(await loadBuffer(e,t)).getChannelData(0),b=f.length,M=Math.max(1,Math.floor(b/o)),F=new Array(M);for(let S=0;S<M;S++){const k=S*o;F[S]=f.subarray(k,k+o)}return seenKeys.add(u),{frames:F,frameLen:o,numFrames:M,key:u}}return{frameLen:o,key:u}}function humanFileSize(e,t){var o=1024;if(e<o)return e+" B";var u=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],p=-1;do e/=o,++p;while(e>=o);return e.toFixed(1)+" "+u[p]}function parseWavSampleRate(e){const t=new DataView(e);let o=12;for(;o+8<=t.byteLength;){const u=String.fromCharCode(t.getUint8(o),t.getUint8(o+1),t.getUint8(o+2),t.getUint8(o+3)),p=t.getUint32(o+4,!0);if(u==="fmt ")return t.getUint32(o+12,!0);o+=8+p+(p&1)}return null}async function decodeAtNativeRate(e){const t=parseWavSampleRate(e)||44100;return await new OfflineAudioContext(1,1,t).decodeAudioData(e)}const loadCache$1={},loadBuffer=(e,t)=>{if(e=e.replace("#","%23"),!loadCache$1[e]){logger$1(`[wavetable] load table ${t}..`,"load-table",{url:e});const o=Date.now();loadCache$1[e]=fetch(e).then(u=>u.arrayBuffer()).then(async u=>{const p=Date.now()-o,f=humanFileSize(u.byteLength);return logger$1(`[wavetable] load table ${t}... done! loaded ${f} in ${p}ms`,"loaded-table",{url:e}),await decodeAtNativeRate(u)})}return loadCache$1[e]};function githubPath$1(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,u]=e.split("github:");return u=u.endsWith("/")?u.slice(0,-1):u,u.split("/").length===2&&(u+="/main"),`https://raw.githubusercontent.com/${u}/${t}`}const _processTables=(e,t,o,u={})=>(t=e._base||t,Object.entries(e).forEach(([p,f])=>{if(p==="_base")return!1;if(typeof f=="string"&&(f=[f]),typeof f!="object")throw new Error("wrong json format for "+p);let b=t;b.startsWith("github:")&&(b=githubPath$1(b,"")),f=f.map(M=>b+M).filter(M=>M.toLowerCase().endsWith(".wav")?!0:(logger$1(`[wavetable] skipping ${M} -- wavetables must be ".wav" format`),!1)),f.length&&registerWaveTable(p,f,{baseUrl:t,frameLen:o})}));function registerWaveTable(e,t,o){registerSound(e,(u,p,f,b)=>onTriggerSynth(u,p,f,t,b,o?.frameLen??2048),{type:"wavetable",tables:t,...o})}const tables=async(e,t,o,u={})=>{if(o!==void 0)return _processTables(o,e,t);e.startsWith("github:")&&(e=githubPath$1(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432");const p=getBaseURL(e);if(typeof fetch=="function"&&!(typeof fetch>"u"))return fetch(e).then(f=>f.json()).then(f=>_processTables(f,p,t,u)).catch(f=>{throw console.error(f),new Error(`error loading "${e}"`)})};async function onTriggerSynth(e,t,o,u,p,f){const{s:b,n:M=0,duration:F,clip:S}=t,k=getAudioContext(),[N,$,R,U]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);let{warpmode:V}=t;typeof V=="string"&&(V=Warpmode[V.toUpperCase()]??Warpmode.NONE);const z=getFrequencyFromValue(t),{url:K,label:ie}=getCommonSampleInfo(t,u),he=await getPayload(K,ie,f);let se=e+F;S!==void 0&&(se=Math.min(e+S*F,se));const ee=se+U,pe=ee+.01,_e=getWorklet(k,"wavetable-oscillator-processor",{begin:e,end:pe,frequency:z,freqspread:t.detune,position:t.wt,warp:t.warp,warpMode:V,voices:Math.max(t.unison??1,1),panspread:t.spread,phaserand:t.wtphaserand??t.unison>1?1:0},{outputChannelCount:[2]});if(_e.port.postMessage({type:"table",payload:he}),k.currentTime>e){logger$1(`[wavetable] still loading sound "${b}:${M}"`,"highlight");return}const ve=[t.wtattack,t.wtdecay,t.wtsustain,t.wtrelease],we=[t.warpattack,t.warpdecay,t.warpsustain,t.warprelease],xe=_e.parameters,Oe=xe.get("position"),Pe=xe.get("warp");let Le=t.wtrate;t.wtsync!=null&&(Le=p*t.wtsync);const Xe=applyParameterModulators(k,Oe,e,ee,{offset:t.wt,amount:t.wtenv,defaultAmount:.5,values:ve,holdEnd:se,defaultValues:[0,.5,0,.1]},{frequency:Le,depth:t.wtdepth,defaultDepth:.5,shape:t.wtshape,skew:t.wtskew,dcoffset:t.wtdc??0});let Ke=t.warprate;t.warpsync!=null&&(Ke=Ke=p*t.warpsync);const me=applyParameterModulators(k,Pe,e,ee,{offset:t.warp,amount:t.warpenv,defaultAmount:.5,values:we,holdEnd:se,defaultValues:[0,.5,0,.1]},{frequency:Ke,depth:t.warpdepth,defaultDepth:.5,shape:t.warpshape,skew:t.warpskew,dcoffset:t.warpdc??0}),ye=getVibratoOscillator(_e.parameters.get("detune"),t,e),Se=applyFM(_e.parameters.get("frequency"),t,e),qe=k.createGain(),st=_e.connect(qe);getParamADSR(st.gain,N,$,R,U,0,.3,e,se,"linear"),getPitchEnvelope(_e.parameters.get("detune"),t,e,se);const mt={node:st,source:_e},Ee=webAudioTimeout(k,()=>{destroyAudioWorkletNode(_e),ye?.stop(),Se?.stop(),st.disconnect(),Xe?.disconnect(),me?.disconnect(),o()},e,pe);return mt.stop=rt=>{Ee.stop(rt)},mt}let doughWorklet;function initDoughWorklet(){const e=getAudioContext();doughWorklet=getWorklet(e,"dough-processor",{},{outputChannelCount:[2]}),connectToDestination(doughWorklet)}const soundMap=new Map,loadedSounds=new Map;Pattern$1.prototype.supradough=function(){return this.onTrigger((e,t,o,u)=>{e.value._begin=u,e.value._duration=e.duration/o,!doughWorklet&&initDoughWorklet();const p=(e.value.bank?e.value.bank+"_":"")+e.value.s,f=e.value.n??0,b=`${p}:${f}`;if(soundMap.has(p)&&(e.value.s=b),soundMap.has(p)&&!loadedSounds.has(b)){const M=soundMap.get(p),F=M[f%M.length];console.log(`load ${b} from ${F}`);const S=fetchSample(F);loadedSounds.set(b,S),S.then(({channels:k,sampleRate:N})=>doughWorklet.port.postMessage({sample:b,channels:k,sampleRate:N}))}doughWorklet.port.postMessage({spawn:e.value})},1)};function githubPath(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,u]=e.split("github:");return u=u.endsWith("/")?u.slice(0,-1):u,u.split("/").length===2&&(u+="/main"),`https://raw.githubusercontent.com/${u}/${t}`}async function fetchSampleMap(e){if(e.startsWith("github:")&&(e=githubPath(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[u,p]=e.split("shabda:");e=`https://shabda.ndre.gr/${p}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[u,p]=e.split("shabda/speech");p=p.startsWith("/")?p.substring(1):p;let[f,b]=p.split(":"),M="f",F="en-GB";f&&([F,M]=f.split("/")),e=`https://shabda.ndre.gr/speech/${b}.json?gender=${M}&language=${F}&strudel=1'`}if(typeof fetch!="function")return;const t=e.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const o=await fetch(e).then(u=>u.json()).catch(u=>{throw console.error(u),new Error(`error loading "${e}"`)});return[o,o._base||t]}async function fetchSample(e){const t=await fetch(e).then(u=>u.arrayBuffer()).then(u=>getAudioContext().decodeAudioData(u));let o=[];for(let u=0;u<t.numberOfChannels;u++)o.push(t.getChannelData(u));return{channels:o,sampleRate:t.sampleRate}}async function doughsamples(e,t){if(typeof e=="string"){const[o,u]=await fetchSampleMap(e);return doughsamples(o,u)}Object.entries(e).map(async([o,u])=>{o!=="_base"&&(u=u.map(p=>t+p),soundMap.set(o,u))})}const _workletUrl="data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IGQ9dHlwZW9mIHNhbXBsZVJhdGU8InUiP3NhbXBsZVJhdGU6NDhlMyxBPU1hdGguUEkvZCxiPTEvZDtsZXQgRT1pPT5NYXRoLnBvdyhpLDIpO2NvbnN0IFY9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtmdW5jdGlvbiBjKGkpe3JldHVybiBFKGkpfWZ1bmN0aW9uIE8oaSxzLHQpe2NvbnN0IGU9TWF0aC5zaW4oKDEtdCkqLjUqTWF0aC5QSSksaD1NYXRoLnNpbih0Ki41Kk1hdGguUEkpO3JldHVybiBpKmUrcypofWNsYXNzIHZ7cGhhc2U9MDt1cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNpbih0aGlzLnBoYXNlKjIqTWF0aC5QSSk7cmV0dXJuIHRoaXMucGhhc2U9KHRoaXMucGhhc2Urcy9kKSUxLHR9fWNsYXNzIHh7cGhhc2U9MDt1cGRhdGUocyl7cmV0dXJuIHRoaXMucGhhc2UrPWIqcyx0aGlzLnBoYXNlJTEqMi0xfX1mdW5jdGlvbiB5KGkscyl7cmV0dXJuIGk8cz8oaS89cyxpK2ktaSppLTEpOmk+MS1zPyhpPShpLTEpL3MsaSppK2kraSsxKTowfWNsYXNzIFJ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy5waGFzZT1zLnBoYXNlPz8wfXVwZGF0ZShzKXtjb25zdCB0PXMvZDtsZXQgZT15KHRoaXMucGhhc2UsdCksaD0yKnRoaXMucGhhc2UtMS1lO3JldHVybiB0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2UtPTEpLGh9fWZ1bmN0aW9uIFQoaSxzLHQpe3JldHVybiBpPDI/MDooKGgsbyxuKT0+biooby1oKStoKSgtcyouNSxzKi41LHQvKGktMSkpfWZ1bmN0aW9uIHooaSxzKXtyZXR1cm4gaSpNYXRoLnBvdygyLHMvMTIpfWNsYXNzIEZ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy52b2ljZXM9cy52b2ljZXM/PzUsdGhpcy5mcmVxc3ByZWFkPXMuZnJlcXNwcmVhZD8/LjIsdGhpcy5wYW5zcHJlYWQ9cy5wYW5zcHJlYWQ/Py40LHRoaXMucGhhc2U9bmV3IEZsb2F0MzJBcnJheSh0aGlzLnZvaWNlcykubWFwKCgpPT5NYXRoLnJhbmRvbSgpKX11cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNxcnQoMS10aGlzLnBhbnNwcmVhZCksZT1NYXRoLnNxcnQodGhpcy5wYW5zcHJlYWQpO2xldCBoPTAsbz0wO2ZvcihsZXQgbj0wO248dGhpcy52b2ljZXM7bisrKXtjb25zdCBhPXoocyxUKHRoaXMudm9pY2VzLHRoaXMuZnJlcXNwcmVhZCxuKSkvZCxwPShuJjEpPT0xO2xldCB1PXQ7cCYmKHU9ZSk7bGV0IHE9eSh0aGlzLnBoYXNlW25dLGEpLEQ9Mip0aGlzLnBoYXNlW25dLTEtcTtoPWgrRCp1LG89bytEKnUsdGhpcy5waGFzZVtuXSs9YSx0aGlzLnBoYXNlW25dPjEmJih0aGlzLnBoYXNlW25dLT0xKX1yZXR1cm4gaCtvfX1jbGFzcyB3e3BoYXNlPTA7dXBkYXRlKHMpe3RoaXMucGhhc2UrPWIqcztsZXQgdD10aGlzLnBoYXNlJTE7cmV0dXJuKHQ8LjU/Mip0OjEtMioodC0uNSkpKjItMX19Y2xhc3MgZ3tzMD0wO3MxPTA7dXBkYXRlKHMsdCxlPTApe2U9TWF0aC5tYXgoZSwwKSx0PU1hdGgubWluKHQsMmU0KTtsZXQgaD0yKk1hdGguc2luKHQqQSk7aD1WKGgsMCwxLjE0KTtjb25zdCBuPTEtTWF0aC5wb3coLjUsKGUrLjEyNSkvLjEyNSkqaDtyZXR1cm4gdGhpcy5zMD1uKnRoaXMuczAtaCp0aGlzLnMxK2gqcyx0aGlzLnMxPW4qdGhpcy5zMStoKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgSXtjb25zdHJ1Y3RvcihzPTApe3RoaXMucGhhc2U9c31zYXcocyx0KXtsZXQgZT0odGhpcy5waGFzZStzKSUxLGg9eShlLHQpO3JldHVybiAyKmUtMS1ofXVwZGF0ZShzLHQ9LjUpe2NvbnN0IGU9cy9kO2xldCBoPXRoaXMuc2F3KDAsZSktdGhpcy5zYXcodCxlKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStlKSUxLGgrdCoyLTF9fWNsYXNzIEx7cGhhc2U9MDt1cGRhdGUocyx0PS41KXtyZXR1cm4gdGhpcy5waGFzZSs9YipzLHRoaXMucGhhc2UlMTx0PzE6LTF9fWNsYXNzIFN7dXBkYXRlPXM9Pk1hdGgucmFuZG9tKCk8cypiP01hdGgucmFuZG9tKCk6MH1jbGFzcyBOe3VwZGF0ZSgpe3JldHVybiBNYXRoLnJhbmRvbSgpKjItMX19Y2xhc3MgQntjb25zdHJ1Y3Rvcigpe3RoaXMub3V0PTB9dXBkYXRlKCl7bGV0IHM9TWF0aC5yYW5kb20oKSoyLTE7cmV0dXJuIHRoaXMub3V0PSh0aGlzLm91dCsuMDIqcykvMS4wMix0aGlzLm91dH19Y2xhc3MgR3tjb25zdHJ1Y3Rvcigpe3RoaXMuYjA9MCx0aGlzLmIxPTAsdGhpcy5iMj0wLHRoaXMuYjM9MCx0aGlzLmI0PTAsdGhpcy5iNT0wLHRoaXMuYjY9MH11cGRhdGUoKXtjb25zdCBzPU1hdGgucmFuZG9tKCkqMi0xO3RoaXMuYjA9Ljk5ODg2KnRoaXMuYjArcyouMDU1NTE3OSx0aGlzLmIxPS45OTMzMip0aGlzLmIxK3MqLjA3NTA3NTksdGhpcy5iMj0uOTY5KnRoaXMuYjIrcyouMTUzODUyLHRoaXMuYjM9Ljg2NjUqdGhpcy5iMytzKi4zMTA0ODU2LHRoaXMuYjQ9LjU1KnRoaXMuYjQrcyouNTMyOTUyMix0aGlzLmI1PS0uNzYxNip0aGlzLmI1LXMqLjAxNjg5ODtjb25zdCB0PXRoaXMuYjArdGhpcy5iMSt0aGlzLmIyK3RoaXMuYjMrdGhpcy5iNCt0aGlzLmI1K3RoaXMuYjYrcyouNTM2MjtyZXR1cm4gdGhpcy5iNj1zKi4xMTU5MjYsdCouMTF9fWNsYXNzIGp7cGhhc2U9MTt1cGRhdGUocyl7dGhpcy5waGFzZSs9YipzO2xldCB0PXRoaXMucGhhc2U+PTE/MTowO3JldHVybiB0aGlzLnBoYXNlPXRoaXMucGhhc2UlMSx0fX1mdW5jdGlvbiBNKGkscyx0LGU9MSl7aWYoaTw9MClyZXR1cm4gcztpZihpPj0xKXJldHVybiB0O2xldCBoO3JldHVybiBlPT09MD9oPWk6ZT4wP2g9TWF0aC5wb3coaSxlKTpoPTEtTWF0aC5wb3coMS1pLC1lKSxzKyh0LXMpKmh9Y2xhc3MgZntjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnN0YXRlPSJvZmYiLHRoaXMuc3RhcnRUaW1lPTAsdGhpcy5zdGFydFZhbD0wLHRoaXMuZGVjYXlDdXJ2ZT1zLmRlY2F5Q3VydmU/PzF9dXBkYXRlKHMsdCxlLGgsbyxuKXtzd2l0Y2godGhpcy5zdGF0ZSl7Y2FzZSJvZmYiOnJldHVybiB0PjAmJih0aGlzLnN0YXRlPSJhdHRhY2siLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD0wKSwwO2Nhc2UiYXR0YWNrIjp7bGV0IGw9cy10aGlzLnN0YXJ0VGltZTtyZXR1cm4gbD5lPyh0aGlzLnN0YXRlPSJkZWNheSIsdGhpcy5zdGFydFRpbWU9cywxKTpNKGwvZSx0aGlzLnN0YXJ0VmFsLDEsMSl9Y2FzZSJkZWNheSI6e2xldCBsPXMtdGhpcy5zdGFydFRpbWUsYT1NKGwvaCwxLG8sLXRoaXMuZGVjYXlDdXJ2ZSk7cmV0dXJuIHQ8PTA/KHRoaXMuc3RhdGU9InJlbGVhc2UiLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD1hLGEpOmw+aD8odGhpcy5zdGF0ZT0ic3VzdGFpbiIsdGhpcy5zdGFydFRpbWU9cyxvKTphfWNhc2Uic3VzdGFpbiI6cmV0dXJuIHQ8PTAmJih0aGlzLnN0YXRlPSJyZWxlYXNlIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9byksbztjYXNlInJlbGVhc2UiOntsZXQgbD1zLXRoaXMuc3RhcnRUaW1lO2lmKGw+bilyZXR1cm4gdGhpcy5zdGF0ZT0ib2ZmIiwwO2xldCBhPU0obC9uLHRoaXMuc3RhcnRWYWwsMCwtdGhpcy5kZWNheUN1cnZlKTtyZXR1cm4gdD4wJiYodGhpcy5zdGF0ZT0iYXR0YWNrIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9YSksYX19dGhyb3ciaW52YWxpZCBlbnZlbG9wZSBzdGF0ZSJ9fWNvbnN0ICQ9MTA7Y2xhc3Mga3t3cml0ZUlkeD0wO3JlYWRJZHg9MDtidWZmZXI9bmV3IEZsb2F0MzJBcnJheSgkKmQpO3dyaXRlKHMsdCl7dGhpcy53cml0ZUlkeD0odGhpcy53cml0ZUlkeCsxKSV0aGlzLmJ1ZmZlci5sZW5ndGgsdGhpcy5idWZmZXJbdGhpcy53cml0ZUlkeF09cztsZXQgZT1NYXRoLm1pbihNYXRoLmZsb29yKGQqdCksdGhpcy5idWZmZXIubGVuZ3RoLTEpO3RoaXMucmVhZElkeD10aGlzLndyaXRlSWR4LWUsdGhpcy5yZWFkSWR4PDAmJih0aGlzLnJlYWRJZHgrPXRoaXMuYnVmZmVyLmxlbmd0aCl9dXBkYXRlKHMsdCl7cmV0dXJuIHRoaXMud3JpdGUocyx0KSx0aGlzLmJ1ZmZlclt0aGlzLnJlYWRJZHhdfX1jbGFzcyBXe2RlbGF5PW5ldyBrO21vZHVsYXRvcj1uZXcgdzt1cGRhdGUocyx0LGUsaCxvKXtjb25zdCBuPXRoaXMubW9kdWxhdG9yLnVwZGF0ZShoKSpvLGw9dGhpcy5kZWxheS51cGRhdGUocyxlKigxK24pKTtyZXR1cm4gTyhzLGwsdCl9fWNsYXNzIFh7aG9sZD0wO3Q9MDt1cGRhdGUocyx0KXtyZXR1cm4gdGhpcy50KysldD09PTAmJih0aGlzLnQ9MCx0aGlzLmhvbGQ9cyksdGhpcy5ob2xkfX1jbGFzcyBVe3VwZGF0ZShzLHQpe3Q9TWF0aC5tYXgoMSx0KTtjb25zdCBlPU1hdGgucG93KDIsdC0xKTtyZXR1cm4gTWF0aC5yb3VuZChzKmUpL2V9fWNsYXNzIFl7dXBkYXRlKHMsdD0wLGU9MSl7ZT1NYXRoLm1heCguMDAxLE1hdGgubWluKDEsZSkpO2NvbnN0IGg9TWF0aC5leHBtMSh0KTtyZXR1cm4oMStoKSpzLygxK2gqTWF0aC5hYnMocykpKmV9fWNsYXNzIF97c3RhdGljIHNhbXBsZXM9bmV3IE1hcDtidWZmZXI7c2FtcGxlUmF0ZTtwb3M9MDtzYW1wbGVGcmVxPVAoKTtjb25zdHJ1Y3RvcihzLHQsZSl7dGhpcy5idWZmZXI9cyx0aGlzLnNhbXBsZVJhdGU9dCx0aGlzLmR1cmF0aW9uPXRoaXMuYnVmZmVyLmxlbmd0aC90aGlzLnNhbXBsZVJhdGUsdGhpcy5zcGVlZD1kL3RoaXMuc2FtcGxlUmF0ZSxlJiYodGhpcy5zcGVlZCo9dGhpcy5kdXJhdGlvbil9dXBkYXRlKHMpe2lmKHRoaXMucG9zPj10aGlzLmJ1ZmZlci5sZW5ndGgpcmV0dXJuIDA7Y29uc3QgdD1zL3RoaXMuc2FtcGxlRnJlcSp0aGlzLnNwZWVkO2xldCBlPXRoaXMuYnVmZmVyW01hdGguZmxvb3IodGhpcy5wb3MpXTtyZXR1cm4gdGhpcy5wb3M9dGhpcy5wb3MrdCxlfX1jb25zdCBtPShpLHM9ImxpbmVhciIsdCk9Pntjb25zdFtuLGwsYSxwXT1pO2lmKG49PW51bGwmJmw9PW51bGwmJmE9PW51bGwmJnA9PW51bGwpcmV0dXJuIHQ/P1suMDAxLC4wMDEsMSwuMDFdO2NvbnN0IHU9YT8/KG4hPW51bGwmJmw9PW51bGx8fG49PW51bGwmJmw9PW51bGw/MTouMDAxKTtyZXR1cm5bTWF0aC5tYXgobj8/MCwuMDAxKSxNYXRoLm1heChsPz8wLC4wMDEpLE1hdGgubWluKHUsMSksTWF0aC5tYXgocD8/MCwuMDEpXX07bGV0IEM9e3NpbmU6dixzYXc6Uix6YXc6eCxzYXd0b290aDpSLHphd3Rvb3RoOngsc3VwZXJzYXc6Rix0cmk6dyx0cmlhbmdsZTp3LHB1bHNlOkksc3F1YXJlOkkscHVsemU6TCxkdXN0OlMsY3JhY2tsZTpTLGltcHVsc2U6aix3aGl0ZTpOLGJyb3duOkIscGluazpHfTtjb25zdCBaPXtjaG9ydXM6MCxub3RlOjQ4LHM6InRyaWFuZ2xlIixiYW5rOiIiLGdhaW46MSxwb3N0Z2FpbjoxLHZlbG9jaXR5OjEsZGVuc2l0eToiLjAzIixmdHlwZToiMTJkYiIsZmFuY2hvcjowLHJlc29uYW5jZTowLGhyZXNvbmFuY2U6MCxiYW5kcTowLGNoYW5uZWxzOlsxLDJdLHBoYXNlcmRlcHRoOi43NSxzaGFwZXZvbDoxLGRpc3RvcnR2b2w6MSxkZWxheTowLGJ5dGVCZWF0RXhwcmVzc2lvbjoiMCIsZGVsYXlmZWVkYmFjazouNSxkZWxheXNwZWVkOjEsZGVsYXl0aW1lOi4yNSxvcmJpdDoxLGk6MSxmZnQ6OCx6OiJ0cmlhbmdsZSIscGFuOi41LGZtaDoxLGZtZW52OjAsc3BlZWQ6MSxwdzouNX07bGV0IHI9aT0+WltpXTtjb25zdCBIPXtjOjAsZDoyLGU6NCxmOjUsZzo3LGE6OSxiOjExfSxKPXsiIyI6MSxiOi0xLHM6MSxmOi0xfSxLPShpLHM9Myk9PntsZXRbdCxlPSIiLGg9IiJdPVN0cmluZyhpKS5tYXRjaCgvXihbYS1nQS1HXSkoWyNic2ZdKikoWzAtOV0qKSQvKT8uc2xpY2UoMSl8fFtdO2lmKCF0KXRocm93IG5ldyBFcnJvcignbm90IGEgbm90ZTogIicraSsnIicpO2NvbnN0IG89SFt0LnRvTG93ZXJDYXNlKCldLG49ZT8uc3BsaXQoIiIpLnJlZHVjZSgoYSxwKT0+YStKW3BdLDApfHwwO3JldHVybihOdW1iZXIoaHx8cykrMSkqMTIrbytufSxRPWk9Pk1hdGgucG93KDIsKGktNjkpLzEyKSo0NDAsUD1pPT4oaT1pfHxyKCJub3RlIiksdHlwZW9mIGk9PSJzdHJpbmciJiYoaT1LKGksMykpLFEoaSkpO2NsYXNzIHR0e2lkPTA7b3V0PVswLDBdO2F0dGFjaztkZWNheTtzdXN0YWluO3JlbGVhc2U7X2JlZ2luO19kdXJhdGlvbjtfc291bmQ7X2NoYW5uZWxzPTE7X2J1ZmZlcnM7dW5pdDtfcGVudjtwZW52O3BhdHRhY2s7cGRlY2F5O3BzdXN0YWluO3ByZWxlYXNlO3ZpYjtfdmliO3ZpYm1vZDtfZm07Zm1oO2ZtaTtfZm1lbnY7Zm1hdHRhY2s7Zm1kZWNheTtmbXN1c3RhaW47Zm1yZWxlYXNlO19scGVudjtscGVudjtscGF0dGFjaztscGRlY2F5O2xwc3VzdGFpbjtscHJlbGVhc2U7X2hwZW52O2hwZW52O2hwYXR0YWNrO2hwZGVjYXk7aHBzdXN0YWluO2hwcmVsZWFzZTtfYnBlbnY7YnBlbnY7YnBhdHRhY2s7YnBkZWNheTticHN1c3RhaW47YnByZWxlYXNlO2N1dG9mZjtoY3V0b2ZmO2JhbmRmO2NvYXJzZTtjcnVzaDtkaXN0b3J0O2ZyZXE7bm90ZTtfbHBmO19ocGY7X2JwZjtfY2hvcnVzO19jb2Fyc2U7X2NydXNoO19kaXN0b3J0O2NvbnN0cnVjdG9yKHMpe3RoaXMuZnJlcT8/PVAocy5ub3RlKSx0aGlzLl9iZWdpbj1zLl9iZWdpbix0aGlzLl9kdXJhdGlvbj1zLl9kdXJhdGlvbix0aGlzLnJlbGVhc2U9cy5yZWxlYXNlPz8wO2xldCB0PXRoaXM7aWYoT2JqZWN0LmFzc2lnbih0LHMpLHQucz10LnM/P3IoInMiKSx0LmdhaW49Yyh0LmdhaW4/P3IoImdhaW4iKSksdC52ZWxvY2l0eT1jKHQudmVsb2NpdHk/P3IoInZlbG9jaXR5IikpLHQucG9zdGdhaW49Yyh0LnBvc3RnYWluPz9yKCJwb3N0Z2FpbiIpKSx0LmRlbnNpdHk9dC5kZW5zaXR5Pz9yKCJkZW5zaXR5IiksdC5mYW5jaG9yPXQuZmFuY2hvcj8/cigiZmFuY2hvciIpLHQuZHJpdmU9dC5kcml2ZT8/LjY5LHQucGhhc2VyZGVwdGg9dC5waGFzZXJkZXB0aD8/cigicGhhc2VyZGVwdGgiKSx0LnNoYXBldm9sPWModC5zaGFwZXZvbD8/cigic2hhcGV2b2wiKSksdC5kaXN0b3J0dm9sPWModC5kaXN0b3J0dm9sPz9yKCJkaXN0b3J0dm9sIikpLHQuaT10Lmk/P3IoImkiKSx0LmNob3J1cz10LmNob3J1cz8/cigiY2hvcnVzIiksdC5mZnQ9dC5mZnQ/P3IoImZmdCIpLHQucGFuPXQucGFuPz9yKCJwYW4iKSx0Lm9yYml0PXQub3JiaXQ/P3IoIm9yYml0IiksdC5mbWVudj10LmZtZW52Pz9yKCJmbWVudiIpLHQucmVzb25hbmNlPXQucmVzb25hbmNlPz9yKCJyZXNvbmFuY2UiKSx0LmhyZXNvbmFuY2U9dC5ocmVzb25hbmNlPz9yKCJocmVzb25hbmNlIiksdC5iYW5kcT10LmJhbmRxPz9yKCJiYW5kcSIpLHQuc3BlZWQ9dC5zcGVlZD8/cigic3BlZWQiKSx0LnB3PXQucHc/P3IoInB3IiksW3QuYXR0YWNrLHQuZGVjYXksdC5zdXN0YWluLHQucmVsZWFzZV09bShbdC5hdHRhY2ssdC5kZWNheSx0LnN1c3RhaW4sdC5yZWxlYXNlXSksdC5faG9sZEVuZD10Ll9iZWdpbit0Ll9kdXJhdGlvbix0Ll9lbmQ9dC5faG9sZEVuZCt0LnJlbGVhc2UrLjAxLHQuZm1pJiYodC5zPT09InNhdyJ8fHQucz09PSJzYXd0b290aCIpJiYodC5zPSJ6YXciKSxDW3Quc10pe2NvbnN0IGU9Q1t0LnNdO3QuX3NvdW5kPW5ldyBlLHQuX2NoYW5uZWxzPTF9ZWxzZSBpZihfLnNhbXBsZXMuaGFzKHQucykpe2NvbnN0IGU9Xy5zYW1wbGVzLmdldCh0LnMpO3QuX2J1ZmZlcnM9W10sdC5fY2hhbm5lbHM9ZS5jaGFubmVscy5sZW5ndGg7Zm9yKGxldCBoPTA7aDx0Ll9jaGFubmVscztoKyspdC5fYnVmZmVycy5wdXNoKG5ldyBfKGUuY2hhbm5lbHNbaF0sZS5zYW1wbGVSYXRlLHQudW5pdD09PSJjIikpfWVsc2UgY29uc29sZS53YXJuKCJzb3VuZCBub3QgbG9hZGVkIix0LnMpO3QucGVudiYmKHQuX3BlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXT1tKFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXSkpLHQudmliJiYodC5fdmliPW5ldyB2LHQudmlibW9kPXQudmlibW9kPz9yKCJ2aWJtb2QiKSksdC5mbWkmJih0Ll9mbT1uZXcgdix0LmZtaD10LmZtaD8/cigiZm1oIiksdC5mbWVudiYmKHQuX2ZtZW52PW5ldyBmKHtkZWNheUN1cnZlOjJ9KSxbdC5mbWF0dGFjayx0LmZtZGVjYXksdC5mbXN1c3RhaW4sdC5mbXJlbGVhc2VdPW0oW3QuZm1hdHRhY2ssdC5mbWRlY2F5LHQuZm1zdXN0YWluLHQuZm1yZWxlYXNlXSkpKSx0Ll9hZHNyPW5ldyBmKHtkZWNheUN1cnZlOjJ9KSx0LmRlbGF5PWModC5kZWxheT8/cigiZGVsYXkiKSksdC5kZWxheWZlZWRiYWNrPXQuZGVsYXlmZWVkYmFjaz8/cigiZGVsYXlmZWVkYmFjayIpLHQuZGVsYXlzcGVlZD10LmRlbGF5c3BlZWQ/P3IoImRlbGF5c3BlZWQiKSx0LmRlbGF5dGltZT10LmRlbGF5dGltZT8/cigiZGVsYXl0aW1lIiksdC5scGVudiYmKHQuX2xwZW52PW5ldyBmKHtkZWNheUN1cnZlOjR9KSxbdC5scGF0dGFjayx0LmxwZGVjYXksdC5scHN1c3RhaW4sdC5scHJlbGVhc2VdPW0oW3QubHBhdHRhY2ssdC5scGRlY2F5LHQubHBzdXN0YWluLHQubHByZWxlYXNlXSkpLHQuaHBlbnYmJih0Ll9ocGVudj1uZXcgZih7ZGVjYXlDdXJ2ZTo0fSksW3QuaHBhdHRhY2ssdC5ocGRlY2F5LHQuaHBzdXN0YWluLHQuaHByZWxlYXNlXT1tKFt0LmhwYXR0YWNrLHQuaHBkZWNheSx0Lmhwc3VzdGFpbix0LmhwcmVsZWFzZV0pKSx0LmJwZW52JiYodC5fYnBlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LmJwYXR0YWNrLHQuYnBkZWNheSx0LmJwc3VzdGFpbix0LmJwcmVsZWFzZV09bShbdC5icGF0dGFjayx0LmJwZGVjYXksdC5icHN1c3RhaW4sdC5icHJlbGVhc2VdKSksdC5fY2hvcnVzPXQuY2hvcnVzP1tdOm51bGwsdC5fbHBmPXQuY3V0b2ZmP1tdOm51bGwsdC5faHBmPXQuaGN1dG9mZj9bXTpudWxsLHQuX2JwZj10LmJhbmRmP1tdOm51bGwsdC5fY29hcnNlPXQuY29hcnNlP1tdOm51bGwsdC5fY3J1c2g9dC5jcnVzaD9bXTpudWxsLHQuX2Rpc3RvcnQ9dC5kaXN0b3J0P1tdOm51bGw7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jaGFubmVscztlKyspdC5fbHBmPy5wdXNoKG5ldyBnKSx0Ll9ocGY/LnB1c2gobmV3IGcpLHQuX2JwZj8ucHVzaChuZXcgZyksdC5fY2hvcnVzPy5wdXNoKG5ldyBXKSx0Ll9jb2Fyc2U/LnB1c2gobmV3IFgpLHQuX2NydXNoPy5wdXNoKG5ldyBVKSx0Ll9kaXN0b3J0Py5wdXNoKG5ldyBZKX11cGRhdGUocyl7aWYoIXRoaXMuX3NvdW5kJiYhdGhpcy5fYnVmZmVycylyZXR1cm4gMDtsZXQgdD0rKHM+PXRoaXMuX2JlZ2luJiZzPD10aGlzLl9ob2xkRW5kKSxlPXRoaXMuZnJlcSp0aGlzLnNwZWVkO2lmKHRoaXMuX2ZtJiZ0aGlzLmZtaCE9PXZvaWQgMCYmdGhpcy5mbWkhPT12b2lkIDApe2xldCBhPXRoaXMuZm1pO2lmKHRoaXMuX2ZtZW52KXtjb25zdCBxPXRoaXMuX2ZtZW52LnVwZGF0ZShzLHQsdGhpcy5mbWF0dGFjayx0aGlzLmZtZGVjYXksdGhpcy5mbXN1c3RhaW4sdGhpcy5mbXJlbGVhc2UpO2E9dGhpcy5mbWVudipxKmF9Y29uc3QgcD1lKnRoaXMuZm1oLHU9cCphO2U9ZSt0aGlzLl9mbS51cGRhdGUocCkqdX1pZih0aGlzLl92aWImJnRoaXMudmlibW9kIT09dm9pZCAwJiYoZT1lKjIqKih0aGlzLl92aWIudXBkYXRlKHRoaXMudmliKSp0aGlzLnZpYm1vZC8xMikpLHRoaXMuX3BlbnYmJnRoaXMucGVudiE9PXZvaWQgMCl7Y29uc3QgYT10aGlzLl9wZW52LnVwZGF0ZShzLHQsdGhpcy5wYXR0YWNrLHRoaXMucGRlY2F5LHRoaXMucHN1c3RhaW4sdGhpcy5wcmVsZWFzZSk7ZT1lK2EqdGhpcy5wZW52fWxldCBoPXRoaXMuY3V0b2ZmO2lmKGghPT12b2lkIDAmJnRoaXMuX2xwZW52KXtjb25zdCBhPXRoaXMuX2xwZW52LnVwZGF0ZShzLHQsdGhpcy5scGF0dGFjayx0aGlzLmxwZGVjYXksdGhpcy5scHN1c3RhaW4sdGhpcy5scHJlbGVhc2UpO2g9dGhpcy5scGVudiphKmgraH1sZXQgbz10aGlzLmhjdXRvZmY7aWYobyE9PXZvaWQgMCYmdGhpcy5faHBlbnYmJnRoaXMuaHBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5faHBlbnYudXBkYXRlKHMsdCx0aGlzLmhwYXR0YWNrLHRoaXMuaHBkZWNheSx0aGlzLmhwc3VzdGFpbix0aGlzLmhwcmVsZWFzZSk7bz0yKip0aGlzLmhwZW52KmEqbytvfWxldCBuPXRoaXMuYmFuZGY7aWYobiE9PXZvaWQgMCYmdGhpcy5fYnBlbnYmJnRoaXMuYnBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5fYnBlbnYudXBkYXRlKHMsdCx0aGlzLmJwYXR0YWNrLHRoaXMuYnBkZWNheSx0aGlzLmJwc3VzdGFpbix0aGlzLmJwcmVsZWFzZSk7bj0yKip0aGlzLmJwZW52KmEqbitufWNvbnN0IGw9dGhpcy5fYWRzci51cGRhdGUocyx0LHRoaXMuYXR0YWNrLHRoaXMuZGVjYXksdGhpcy5zdXN0YWluLHRoaXMucmVsZWFzZSk7Zm9yKGxldCBhPTA7YTx0aGlzLl9jaGFubmVsczthKyspe2lmKHRoaXMuX3NvdW5kJiZ0aGlzLnM9PT0icHVsc2UiP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlLHRoaXMucHcpOnRoaXMuX3NvdW5kP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlKTp0aGlzLl9idWZmZXJzJiYodGhpcy5vdXRbYV09dGhpcy5fYnVmZmVyc1thXS51cGRhdGUoZSkpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdKnRoaXMuZ2Fpbip0aGlzLnZlbG9jaXR5LHRoaXMuX2Nob3J1cyl7Y29uc3QgcD10aGlzLl9jaG9ydXNbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY2hvcnVzLC4wMysuMDUqYSwxLC4xMSk7dGhpcy5vdXRbYV09cCt0aGlzLm91dFthXX10aGlzLl9scGYmJih0aGlzLl9scGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLGgsdGhpcy5yZXNvbmFuY2UpLHRoaXMub3V0W2FdPXRoaXMuX2xwZlthXS5zMSksdGhpcy5faHBmJiYodGhpcy5faHBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxvLHRoaXMuaHJlc29uYW5jZSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0tdGhpcy5faHBmW2FdLnMxKSx0aGlzLl9icGYmJih0aGlzLl9icGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLG4sdGhpcy5iYW5kcSksdGhpcy5vdXRbYV09dGhpcy5fYnBmW2FdLnMwKSx0aGlzLl9jb2Fyc2UmJih0aGlzLm91dFthXT10aGlzLl9jb2Fyc2VbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY29hcnNlKSksdGhpcy5fY3J1c2gmJih0aGlzLm91dFthXT10aGlzLl9jcnVzaFthXS51cGRhdGUodGhpcy5vdXRbYV0sdGhpcy5jcnVzaCkpLHRoaXMuX2Rpc3RvcnQmJih0aGlzLm91dFthXT10aGlzLl9kaXN0b3J0W2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmRpc3RvcnQsdGhpcy5kaXN0b3J0dm9sKSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qbCx0aGlzLm91dFthXT10aGlzLm91dFthXSp0aGlzLnBvc3RnYWluLHRoaXMuX2J1ZmZlcnN8fCh0aGlzLm91dFthXT10aGlzLm91dFthXSouMil9aWYodGhpcy5fY2hhbm5lbHM9PT0xJiYodGhpcy5vdXRbMV09dGhpcy5vdXRbMF0pLHRoaXMucGFuIT09LjUpe2NvbnN0IGE9dGhpcy5wYW4qTWF0aC5QSS8yO3RoaXMub3V0WzBdPXRoaXMub3V0WzBdKk1hdGguY29zKGEpLHRoaXMub3V0WzFdPXRoaXMub3V0WzFdKk1hdGguc2luKGEpfX19Y2xhc3Mgc3R7dm9pY2VzPVtdO3ZpZD0wO3E9W107b3V0PVswLDBdO2RlbGF5c2VuZD1bMCwwXTtkZWxheXRpbWU9cigiZGVsYXl0aW1lIik7ZGVsYXlmZWVkYmFjaz1yKCJkZWxheWZlZWRiYWNrIik7ZGVsYXlzcGVlZD1yKCJkZWxheXNwZWVkIik7dD0wO2NvbnN0cnVjdG9yKHM9NDhlMyx0PTApe3RoaXMuc2FtcGxlUmF0ZT1zLHRoaXMudD1NYXRoLmZsb29yKHQqcyksdGhpcy5fZGVsYXlMPW5ldyBrLHRoaXMuX2RlbGF5Uj1uZXcga31sb2FkU2FtcGxlKHMsdCxlKXtfLnNhbXBsZXMuc2V0KHMse2NoYW5uZWxzOnQsc2FtcGxlUmF0ZTplfSl9c2NoZWR1bGVTcGF3bihzKXtpZihzLl9iZWdpbj09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoIltkb3VnaF06IHNjaGVkdWxlU3Bhd24gZXhwZWN0ZWQgX2JlZ2luIHRvIGJlIHNldCIpO2lmKHMuX2R1cmF0aW9uPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcigiW2RvdWdoXTogc2NoZWR1bGVTcGF3biBleHBlY3RlZCBfZHVyYXRpb24gdG8gYmUgc2V0Iik7cy5zYW1wbGVSYXRlPXRoaXMuc2FtcGxlUmF0ZTtjb25zdCB0PU1hdGguZmxvb3Iocy5fYmVnaW4qdGhpcy5zYW1wbGVSYXRlKTt0aGlzLnNjaGVkdWxlKHt0aW1lOnQsdHlwZToic3Bhd24iLGFyZzpzfSl9c3Bhd24ocyl7cy5pZD10aGlzLnZpZCsrO2NvbnN0IHQ9bmV3IHR0KHMpO3RoaXMudm9pY2VzLnB1c2godCk7Y29uc3QgZT1NYXRoLmNlaWwodC5fZW5kKnRoaXMuc2FtcGxlUmF0ZSk7dGhpcy5zY2hlZHVsZSh7dGltZTplLHR5cGU6ImRlc3Bhd24iLGFyZzp0LmlkfSl9ZGVzcGF3bihzKXt0aGlzLnZvaWNlcz10aGlzLnZvaWNlcy5maWx0ZXIodD0+dC5pZCE9PXMpfXNjaGVkdWxlKHMpe2lmKCF0aGlzLnEubGVuZ3RoKXt0aGlzLnEucHVzaChzKTtyZXR1cm59bGV0IHQ9MDtmb3IoO3Q8dGhpcy5xLmxlbmd0aCYmdGhpcy5xW3RdLnRpbWU8cy50aW1lOyl0Kys7dGhpcy5xLnNwbGljZSh0LDAscyl9dXBkYXRlKCl7Zm9yKDt0aGlzLnEubGVuZ3RoPjAmJnRoaXMucVswXS50aW1lPD10aGlzLnQ7KXRoaXNbdGhpcy5xWzBdLnR5cGVdKHRoaXMucVswXS5hcmcpLHRoaXMucS5zaGlmdCgpO3RoaXMub3V0WzBdPTAsdGhpcy5vdXRbMV09MDtmb3IobGV0IGU9MDtlPHRoaXMudm9pY2VzLmxlbmd0aDtlKyspdGhpcy52b2ljZXNbZV0udXBkYXRlKHRoaXMudC90aGlzLnNhbXBsZVJhdGUpLHRoaXMub3V0WzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0sdGhpcy5vdXRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSx0aGlzLnZvaWNlc1tlXS5kZWxheSYmKHRoaXMuZGVsYXlzZW5kWzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0qdGhpcy52b2ljZXNbZV0uZGVsYXksdGhpcy5kZWxheXNlbmRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSp0aGlzLnZvaWNlc1tlXS5kZWxheSx0aGlzLmRlbGF5dGltZT10aGlzLnZvaWNlc1tlXS5kZWxheXRpbWUsdGhpcy5kZWxheXNwZWVkPXRoaXMudm9pY2VzW2VdLmRlbGF5c3BlZWQsdGhpcy5kZWxheWZlZWRiYWNrPXRoaXMudm9pY2VzW2VdLmRlbGF5ZmVlZGJhY2spO2NvbnN0IHM9dGhpcy5fZGVsYXlMLnVwZGF0ZSh0aGlzLmRlbGF5c2VuZFswXSx0aGlzLmRlbGF5dGltZSksdD10aGlzLl9kZWxheVIudXBkYXRlKHRoaXMuZGVsYXlzZW5kWzFdLHRoaXMuZGVsYXl0aW1lKTt0aGlzLmRlbGF5c2VuZFswXT1zKnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLmRlbGF5c2VuZFsxXT10KnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLm91dFswXSs9cyx0aGlzLm91dFsxXSs9dCx0aGlzLnQrK319Y29uc3QgZXQ9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtjbGFzcyBpdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5kb3VnaD1uZXcgc3Qoc2FtcGxlUmF0ZSxjdXJyZW50VGltZSksdGhpcy5wb3J0Lm9ubWVzc2FnZT1zPT57cy5kYXRhLnNwYXduP3RoaXMuZG91Z2guc2NoZWR1bGVTcGF3bihzLmRhdGEuc3Bhd24pOnMuZGF0YS5zYW1wbGU/dGhpcy5kb3VnaC5sb2FkU2FtcGxlKHMuZGF0YS5zYW1wbGUscy5kYXRhLmNoYW5uZWxzLHMuZGF0YS5zYW1wbGVSYXRlKTpzLmRhdGEuc2FtcGxlcz9zLmRhdGEuc2FtcGxlcy5mb3JFYWNoKChbdCxlLGhdKT0+e3RoaXMuZG91Z2gubG9hZFNhbXBsZSh0LGUsaCl9KTpjb25zb2xlLmxvZygidW5yZWNvZ25pemVkIGV2ZW50IHR5cGUiLHMuZGF0YSl9fXByb2Nlc3Mocyx0LGUpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2NvbnN0IGg9dFswXTtmb3IobGV0IG89MDtvPGhbMF0ubGVuZ3RoO28rKyl7dGhpcy5kb3VnaC51cGRhdGUoKTtmb3IobGV0IG49MDtuPGgubGVuZ3RoO24rKyloW25dW29dPWV0KHRoaXMuZG91Z2gub3V0W25dLC0xLDEpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZG91Z2gtcHJvY2Vzc29yIixpdCl9KSgpOwo=";typeof sampleRate<"u"&&sampleRate;const workletUrl=_workletUrl;registerWorklet(workletUrl);const{Pattern,logger,repl}=strudelCore;setLogger(logger);const hap2value=e=>(e.ensureObjectValue(),e.value),webaudioOutput=(e,t,o,u,p)=>superdough(hap2value(e),p,o,u,e.whole?.begin.valueOf());function webaudioRepl(e={}){return e={getTime:()=>getAudioContext().currentTime,defaultOutput:webaudioOutput,...e},repl(e)}Pattern.prototype.dough=function(){return this.onTrigger(doughTrigger,1)};const getDrawContext=(e="test-canvas",t)=>{let{contextType:o="2d",pixelated:u=!1,pixelRatio:p=window.devicePixelRatio}=t||{},f=document.querySelector("#"+e);if(!f){f=document.createElement("canvas"),f.id=e,f.width=window.innerWidth*p,f.height=window.innerHeight*p,f.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",u&&(f.style.imageRendering="pixelated"),document.body.prepend(f);let b;window.addEventListener("resize",()=>{b&&clearTimeout(b),b=setTimeout(()=>{f.width=window.innerWidth*p,f.height=window.innerHeight*p},200)})}return f.getContext(o,{willReadFrequently:!0})};let animationFrames={};function stopAnimationFrame(e){animationFrames[e]!==void 0&&(cancelAnimationFrame(animationFrames[e]),delete animationFrames[e])}function stopAllAnimations(e){Object.keys(animationFrames).forEach(t=>stopAnimationFrame(t))}let memory={};Pattern$1.prototype.draw=function(e,t){if(typeof window>"u")return this;let{id:o=1,lookbehind:u=0,lookahead:p=0}=t,f=Math.max(getTime(),0);stopAnimationFrame(o),u=Math.abs(u),memory[o]=(memory[o]||[]).filter(S=>!S.isInFuture(f));let b=this.queryArc(f,f+p).filter(S=>S.hasOnset());memory[o]=memory[o].concat(b);let M;const F=()=>{const S=getTime(),k=S+p;memory[o]=memory[o].filter(R=>R.isInNearPast(u,S));let N=Math.max(M||k,k-1/10);const $=this.queryArc(N,k).filter(R=>R.hasOnset());memory[o]=memory[o].concat($),M=k,e(memory[o],S,k,this),animationFrames[o]=requestAnimationFrame(F)};return animationFrames[o]=requestAnimationFrame(F),this};const cleanupDraw=(e=!0,t)=>{const o=getDrawContext();e&&o.clearRect(0,0,o.canvas.width,o.canvas.height),stopAllAnimations()};Pattern$1.prototype.onPaint=function(e){return this.withState(t=>(t.controls.painters||(t.controls.painters=[]),t.controls.painters.push(e),t))},Pattern$1.prototype.getPainters=function(){let e=[];return this.queryArc(0,0,{painters:e}),e};let theme={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function getTheme(){return theme}let clearColor="#22222210";Pattern$1.prototype.animate=function({callback:e,sync:t=!1,smear:o=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const u=getDrawContext();let{clientWidth:p,clientHeight:f}=u.canvas;p*=window.devicePixelRatio,f*=window.devicePixelRatio;let b=o===0?"99":Number((1-o)*100).toFixed(0);b=b.length===1?`0${b}`:b,clearColor=`#200010${b}`;const M=F=>{let S;F=Math.round(F),S=this.slow(1e3).queryArc(F,F),u.fillStyle=clearColor,u.fillRect(0,0,p,f),S.forEach(k=>{let{x:N,y:$,w:R,h:U,s:V,r:z,angle:K=0,fill:ie="darkseagreen"}=k.value;if(R*=p,U*=f,z!==void 0&&K!==void 0){const se=K*2*Math.PI,[ee,pe]=[(p-R)/2,(f-U)/2];N=ee+Math.cos(se)*z*ee,$=pe+Math.sin(se)*z*pe}else N*=p-R,$*=f-U;const he={...k.value,x:N,y:$,w:R,h:U};u.fillStyle=ie,V==="rect"?u.fillRect(N,$,R,U):V==="ellipse"&&(u.beginPath(),u.ellipse(N+R/2,$+U/2,R/2,U/2,0,0,2*Math.PI),u.fill()),e&&e(u,he,k)}),window.frame=requestAnimationFrame(M)};return window.frame=requestAnimationFrame(M),silence};const{x:x$1,y,w,h,angle,r,fill,smear}=createParams("x","y","w","h","angle","r","fill","smear");register("rescale",function(e,t){return t.mul(x$1(e).w(e).y(e).h(e))}),register("moveXY",function(e,t,o){return o.add(x$1(e).y(t))}),register("zoomIn",function(e,t){const o=pure(1).sub(e).div(2);return t.rescale(e).move(o,o)});const scale$2=(e,t,o)=>e*(o-t)+t,getValue=e=>{let{value:t}=e;typeof e.value!="object"&&(t={value:t});let{note:o,n:u,freq:p,s:f}=t;if(p)return freqToMidi$2(p);if(o=o??u,typeof o=="string")try{return noteToMidi$1(o)}catch{return 0}return typeof o=="number"?o:f?"_"+f:t};Pattern$1.prototype.pianoroll=function(e={}){let{cycles:t=4,playhead:o=.5,overscan:u=0,hideNegative:p=!1,ctx:f=getDrawContext(),id:b=1}=e,M=-t*o,F=t*(1-o);const S=(k,N)=>(!p||k.whole.begin>=0)&&k.isWithinTime(N+M,N+F);return this.draw((k,N)=>{__pianoroll({...e,time:N,ctx:f,haps:k.filter($=>S($,N))})},{lookbehind:M-u,lookahead:F+u,id:b}),this};function __pianoroll({time:e,haps:t,cycles:o=4,playhead:u=.5,flipTime:p=0,flipValues:f=0,hideNegative:b=!1,inactive:M=getTheme().foreground,active:F=getTheme().foreground,background:S="transparent",smear:k=0,playheadColor:N=getTheme().foreground,minMidi:$=10,maxMidi:R=90,autorange:U=0,timeframe:V,fold:z=1,vertical:K=0,labels:ie=!1,fill:he=1,fillActive:se=!1,strokeActive:ee=!0,stroke:pe,hideInactive:_e=0,colorizeInactive:ve=1,fontFamily:we,ctx:xe,id:Oe}={}){const Pe=xe.canvas.width,Le=xe.canvas.height;let Xe=-o*u,Ke=o*(1-u);Oe&&(t=t.filter(At=>At.hasTag(Oe))),V&&(console.warn("timeframe is deprecated! use from/to instead"),Xe=0,Ke=V);const me=K?Le:Pe,ye=K?Pe:Le;let Se=K?[me,0]:[0,me];const qe=Ke-Xe,st=K?[0,ye]:[ye,0];let mt=R-$+1,Ee=ye/mt,rt=[];p&&Se.reverse(),f&&st.reverse();const{min:St,max:pt,values:bt}=t.reduce(({min:At,max:Et,values:Kt},jt)=>{const Nt=getValue(jt);return{min:Nt<At?Nt:At,max:Nt>Et?Nt:Et,values:Kt.includes(Nt)?Kt:[...Kt,Nt]}},{min:1/0,max:-1/0,values:[]});U&&($=St,R=pt,mt=R-$+1),rt=bt.sort((At,Et)=>typeof At=="number"&&typeof Et=="number"?At-Et:typeof At=="number"?1:String(At).localeCompare(String(Et))),Ee=z?ye/rt.length:ye/mt,xe.fillStyle=S,xe.globalAlpha=1,k||(xe.clearRect(0,0,Pe,Le),xe.fillRect(0,0,Pe,Le)),t.forEach(At=>{const Et=At.whole.begin<=e&&At.endClipped>e;let Kt=pe??(ee&&Et),jt=!Et&&he||Et&&se;if(_e&&!Et)return;let Nt=At.value?.color;F=Nt||F,M=ve&&Nt||M,Nt=Et?F:M,xe.fillStyle=jt?Nt:"transparent",xe.strokeStyle=Nt;const{velocity:_t=1,gain:$t=1}=At.value||{};xe.globalAlpha=_t*$t;const sn=(At.whole.begin-(p?Ke:Xe))/qe,kt=scale$2(sn,...Se);let Ot=scale$2(At.duration/qe,0,me);const Wt=getValue(At),Ae=z?rt.indexOf(Wt)/rt.length:(Number(Wt)-$)/mt,Ce=scale$2(Ae,...st);let ge=0;const Te=scale$2(e/qe,...Se);let ze;if(K?ze=[Ce+1-(f?Ee:0),me-Te+kt+ge+1-(p?0:Ot),Ee-2,Ot-2]:ze=[kt-Te+ge+1-(p?Ot:0),Ce+1-(f?0:Ee),Ot-2,Ee-2],Kt&&xe.strokeRect(...ze),jt&&xe.fillRect(...ze),ie){const Ne=At.value.note??At.value.s+(At.value.n?`:${At.value.n}`:""),{label:De,activeLabel:Ie}=At.value,He=(Et&&Ie||De)??Ne;let it=K?Ot:Ee*.75;xe.font=`${it}px ${we||"monospace"}`,xe.fillStyle=jt?"black":Nt,xe.textBaseline="top",xe.fillText(He,...ze)}}),xe.globalAlpha=1;const yt=scale$2(-Xe/qe,...Se);return xe.strokeStyle=N,xe.beginPath(),K?(xe.moveTo(0,yt),xe.lineTo(ye,yt)):(xe.moveTo(yt,0),xe.lineTo(yt,ye)),xe.stroke(),this}function getDrawOptions(e,t={}){let[o,u]=e;o=Math.abs(o);const p=u+o,f=p!==0?o/p:0;return{fold:1,...t,cycles:p,playhead:f}}const getPunchcardPainter=(e={})=>(t,o,u,p)=>__pianoroll({ctx:t,time:o,haps:u,...getDrawOptions(p,e)});Pattern$1.prototype.punchcard=function(e){return this.onPaint(getPunchcardPainter(e))},Pattern$1.prototype.wordfall=function(e){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...e})};function fromPolar(e,t,o,u){const p=(e-90)*Math.PI/180;return[o+Math.cos(p)*t,u+Math.sin(p)*t]}const xyOnSpiral=(e,t,o,u,p=0)=>fromPolar((e+p)*360,t*e,o,u);function spiralSegment(e){let{ctx:t,from:o=0,to:u=3,margin:p=50,cx:f=100,cy:b=100,rotate:M=0,thickness:F=p/2,color:S=getTheme().foreground,cap:k="round",stretch:N=1,fromOpacity:$=1,toOpacity:R=1}=e;o*=N,u*=N,M*=N,t.lineWidth=F,t.lineCap=k,t.strokeStyle=S,t.globalAlpha=$,t.beginPath();let[U,V]=xyOnSpiral(o,p,f,b,M);t.moveTo(U,V);const z=1/60;let K=o;for(;K<=u;){const[ie,he]=xyOnSpiral(K,p,f,b,M);t.globalAlpha=(K-o)/(u-o)*R,t.lineTo(ie,he),K+=z}t.stroke()}function drawSpiral(e){let{stretch:t=1,size:o=80,thickness:u=o/2,cap:p="butt",inset:f=3,playheadColor:b="#ffffff",playheadLength:M=.02,playheadThickness:F=u,padding:S=0,steady:k=1,activeColor:N=getTheme().foreground,inactiveColor:$=getTheme().gutterForeground,colorizeInactive:R=0,fade:U=!0,ctx:V,time:z,haps:K,drawTime:ie,id:he}=e;he&&(K=K.filter(Pe=>Pe.hasTag(he)));const[se,ee]=[V.canvas.width,V.canvas.height];V.clearRect(0,0,se*2,ee*2);const[pe,_e]=[se/2,ee/2],ve={margin:o/t,cx:pe,cy:_e,stretch:t,cap:p,thickness:u},we={...ve,thickness:F,from:f-M,to:f,color:b},[xe]=ie,Oe=k*z;K.forEach(Pe=>{const Le=Pe.whole.begin<=z&&Pe.endClipped>z,Xe=Pe.whole.begin-z+f,Ke=Pe.endClipped-z+f-S,me=Pe.value?.color||N,ye=R||Le?me:$,Se=U?1-Math.abs((Pe.whole.begin-z)/xe):1;spiralSegment({ctx:V,...ve,from:Xe,to:Ke,rotate:Oe,color:ye,fromOpacity:Se,toOpacity:Se})}),spiralSegment({ctx:V,...we,rotate:Oe})}Pattern$1.prototype.spiral=function(e={}){return this.onPaint((t,o,u,p)=>drawSpiral({ctx:t,time:o,haps:u,drawTime:p,...e}))};const c=midiToFreq$2(36),circlePos=(e,t,o,u)=>{u=u*Math.PI*2;const p=Math.sin(u)*o+e,f=Math.cos(u)*o+t;return[p,f]},freq2angle=(e,t)=>.5-Math.log2(e/t)%1;function pitchwheel({haps:e,ctx:t,id:o,hapcircles:u=1,circle:p=0,edo:f=12,root:b=c,thickness:M=3,hapRadius:F=6,mode:S="flake",margin:k=10}={}){const N=S==="polygon",$=S==="flake",R=t.canvas.width,U=t.canvas.height;t.clearRect(0,0,R,U);const V=getTheme().foreground,K=Math.min(R,U)/2-M/2-F-k,ie=R/2,he=U/2;o&&(e=e.filter(ee=>ee.hasTag(o))),t.strokeStyle=V,t.fillStyle=V,t.globalAlpha=1,t.lineWidth=M,p&&(t.beginPath(),t.arc(ie,he,K,0,2*Math.PI),t.stroke()),f&&(Array.from({length:f},(ee,pe)=>{const _e=freq2angle(b*Math.pow(2,pe/f),b),[ve,we]=circlePos(ie,he,K,_e);t.beginPath(),t.arc(ve,we,F,0,2*Math.PI),t.fill()}),t.stroke());let se=[];t.lineWidth=F,e.forEach(ee=>{let pe;try{pe=getFrequency(ee)}catch{return}const _e=freq2angle(pe,b),[ve,we]=circlePos(ie,he,K,_e),xe=ee.value.color||V;t.strokeStyle=xe,t.fillStyle=xe;const{velocity:Oe=1,gain:Pe=1}=ee.value||{},Le=Oe*Pe;t.globalAlpha=Le,se.push([ve,we,_e,xe,Le]),t.beginPath(),u&&(t.moveTo(ve+F,we),t.arc(ve,we,F,0,2*Math.PI),t.fill()),$&&(t.moveTo(ie,he),t.lineTo(ve,we)),t.stroke()}),t.strokeStyle=V,t.globalAlpha=1,N&&se.length&&(se=se.sort((ee,pe)=>ee[2]-pe[2]),t.beginPath(),t.moveTo(se[0][0],se[0][1]),se.forEach(([ee,pe,_e,ve,we])=>{t.strokeStyle=ve,t.globalAlpha=we,t.lineTo(ee,pe)}),t.lineTo(se[0][0],se[0][1]),t.stroke())}Pattern$1.prototype.pitchwheel=function(e={}){let{ctx:t=getDrawContext(),id:o=1}=e;return this.tag(o).onPaint((u,p,f)=>pitchwheel({...e,ctx:t,haps:f.filter(b=>b.isActive(p)),id:o}))};function drawTimeScope(e,{align:t=!0,color:o="white",thickness:u=3,scale:p=.25,pos:f=.75,trigger:b=0,ctx:M=getDrawContext(),id:F=1}={}){M.lineWidth=u,M.strokeStyle=o;let S=M.canvas;if(!e){M.beginPath();let V=f*S.height;M.moveTo(0,V),M.lineTo(S.width,V),M.stroke();return}const k=getAnalyzerData("time",F);M.beginPath();const N=e.frequencyBinCount;let $=t?Array.from(k).findIndex((V,z,K)=>z&&K[z-1]>-b&&V<=-b):0;$=Math.max($,0);const R=S.width*1/N;let U=0;for(let V=$;V<N;V++){const z=k[V]+1,K=(f-p*(z-1))*S.height;V===0?M.moveTo(U,K):M.lineTo(U,K),U+=R}M.stroke()}function drawFrequencyScope(e,{color:t="white",scale:o=.25,pos:u=.75,lean:p=.5,min:f=-150,max:b=0,ctx:M=getDrawContext(),id:F=1}={}){if(!e){M.beginPath();let U=u*k.height;M.moveTo(0,U),M.lineTo(k.width,U),M.stroke();return}const S=getAnalyzerData("frequency",F),k=M.canvas;M.fillStyle=t;const N=e.frequencyBinCount,$=k.width*1/N;let R=0;for(let U=0;U<N;U++){const z=clamp$1((S[U]-f)/(b-f),0,1)*o,K=z*k.height,ie=(u-z*p)*k.height;M.fillRect(R,ie,Math.max($,1),K),R+=$}}function clearScreen(e=0,t="0,0,0",o=getDrawContext()){e?(o.fillStyle=`rgba(${t},${1-e})`,o.fillRect(0,0,o.canvas.width,o.canvas.height)):o.clearRect(0,0,o.canvas.width,o.canvas.height)}Pattern$1.prototype.fscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(()=>{clearScreen(e.smear,"0,0,0",e.ctx),analysers[t]&&drawFrequencyScope(analysers[t],e)},{id:t})},Pattern$1.prototype.tscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||getTheme().foreground,e.color,clearScreen(e.smear,"0,0,0",e.ctx),drawTimeScope(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;let latestColor={};Pattern$1.prototype.spectrum=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||latestColor[t]||getTheme().foreground,latestColor[t]=e.color,drawSpectrum(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;const lastFrames=new Map;function drawSpectrum(e,{thickness:t=3,speed:o=1,min:u=-80,max:p=0,ctx:f=getDrawContext(),id:b=1,color:M}={}){if(f.lineWidth=t,f.strokeStyle=M,!e)return;const F=o,S=getAnalyzerData("frequency",b),k=f.canvas;f.fillStyle=M;const N=e.frequencyBinCount;let $=lastFrames.get(b)||f.getImageData(0,0,k.width,k.height);lastFrames.set(b,$),f.clearRect(0,0,f.canvas.width,f.canvas.height),f.putImageData($,-F,0);let R=k.width-o;for(let U=0;U<N;U++){const V=clamp$1((S[U]-u)/(p-u),0,1);f.globalAlpha=V;const z=Math.log(U+1)/Math.log(N)*k.height;f.fillRect(R,k.height-z,F,2)}lastFrames.set(b,f.getImageData(0,0,k.width,k.height))}const strudelWebAudio=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY,Warpmode,aliasBank,get analysers(){return analysers},get analysersData(){return analysersData},applyFM,applyGainCurve,applyParameterModulators,connectToDestination,createFilter,destroyAudioWorkletNode,distortionAlgorithms,dough,doughTrigger,doughsamples,drawFrequencyScope,drawTimeScope,drywet,dspWorklet,effectSend,errorLogger,gainNode,getADSRValues,getAnalyserById,getAnalyzerData,getAudioContext,getAudioContextCurrentTime,getAudioDevices,getCachedBuffer,getCompressor,getDefaultValue,getDistortion,getDistortionAlgorithm,getFrequencyFromValue,getLfo,getLoadedBuffer,getOscillator,getParamADSR,getParamLfo,getPitchEnvelope,getSampleBuffer,getSampleBufferSource,getSampleInfo,getSound,getSuperdoughAudioController,getVibratoOscillator,getWorklet,getZZFX,initAudio,initAudioOnFirstClick,loadBuffer:loadBuffer$1,logger:logger$1,noises,onTriggerSample,onTriggerSynth,processSampleMap,registerSampleSource,registerSamplesPrefix,registerSound,registerSynthSounds,registerWaveTable,registerWorklet,registerZZFXSounds,resetDefaultValues,resetDefaults,resetGlobalEffects,resetLoadedSounds,reverseBuffer,samples,scheduleAtTime,setDefault,setDefaultAudioContext,setDefaultValue,setDefaultValues,setGainCurve,setLogger,setMaxPolyphony,setMultiChannelOrbits,setVersionDefaults,soundAlias,soundMap:soundMap$1,superdough,superdoughTrigger,tables,waveformN,webAudioTimeout,webaudioOutput,webaudioRepl},Symbol.toStringTag,{value:"Module"}));var astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],nonASCIIidentifierChars="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",reservedWords={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ecma5AndLessKeywords="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",keywords$1={5:ecma5AndLessKeywords,"5module":ecma5AndLessKeywords+" export import",6:ecma5AndLessKeywords+" const class extends export import super"},keywordRelationalOperator=/^in(stanceof)?$/,nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]"),nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");function isInAstralSet(e,t){for(var o=65536,u=0;u<t.length;u+=2){if(o+=t[u],o>e)return!1;if(o+=t[u+1],o>=e)return!0}return!1}function isIdentifierStart(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifierStart.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)}function isIdentifierChar(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifier.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)||isInAstralSet(e,astralIdentifierCodes)}var TokenType=function(t,o){o===void 0&&(o={}),this.label=t,this.keyword=o.keyword,this.beforeExpr=!!o.beforeExpr,this.startsExpr=!!o.startsExpr,this.isLoop=!!o.isLoop,this.isAssign=!!o.isAssign,this.prefix=!!o.prefix,this.postfix=!!o.postfix,this.binop=o.binop||null,this.updateContext=null};function binop(e,t){return new TokenType(e,{beforeExpr:!0,binop:t})}var beforeExpr={beforeExpr:!0},startsExpr={startsExpr:!0},keywords={};function kw(e,t){return t===void 0&&(t={}),t.keyword=e,keywords[e]=new TokenType(e,t)}var types$1={num:new TokenType("num",startsExpr),regexp:new TokenType("regexp",startsExpr),string:new TokenType("string",startsExpr),name:new TokenType("name",startsExpr),privateId:new TokenType("privateId",startsExpr),eof:new TokenType("eof"),bracketL:new TokenType("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new TokenType("]"),braceL:new TokenType("{",{beforeExpr:!0,startsExpr:!0}),braceR:new TokenType("}"),parenL:new TokenType("(",{beforeExpr:!0,startsExpr:!0}),parenR:new TokenType(")"),comma:new TokenType(",",beforeExpr),semi:new TokenType(";",beforeExpr),colon:new TokenType(":",beforeExpr),dot:new TokenType("."),question:new TokenType("?",beforeExpr),questionDot:new TokenType("?."),arrow:new TokenType("=>",beforeExpr),template:new TokenType("template"),invalidTemplate:new TokenType("invalidTemplate"),ellipsis:new TokenType("...",beforeExpr),backQuote:new TokenType("`",startsExpr),dollarBraceL:new TokenType("${",{beforeExpr:!0,startsExpr:!0}),eq:new TokenType("=",{beforeExpr:!0,isAssign:!0}),assign:new TokenType("_=",{beforeExpr:!0,isAssign:!0}),incDec:new TokenType("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new TokenType("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:binop("||",1),logicalAND:binop("&&",2),bitwiseOR:binop("|",3),bitwiseXOR:binop("^",4),bitwiseAND:binop("&",5),equality:binop("==/!=/===/!==",6),relational:binop("</>/<=/>=",7),bitShift:binop("<</>>/>>>",8),plusMin:new TokenType("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:binop("%",10),star:binop("*",10),slash:binop("/",10),starstar:new TokenType("**",{beforeExpr:!0}),coalesce:binop("??",1),_break:kw("break"),_case:kw("case",beforeExpr),_catch:kw("catch"),_continue:kw("continue"),_debugger:kw("debugger"),_default:kw("default",beforeExpr),_do:kw("do",{isLoop:!0,beforeExpr:!0}),_else:kw("else",beforeExpr),_finally:kw("finally"),_for:kw("for",{isLoop:!0}),_function:kw("function",startsExpr),_if:kw("if"),_return:kw("return",beforeExpr),_switch:kw("switch"),_throw:kw("throw",beforeExpr),_try:kw("try"),_var:kw("var"),_const:kw("const"),_while:kw("while",{isLoop:!0}),_with:kw("with"),_new:kw("new",{beforeExpr:!0,startsExpr:!0}),_this:kw("this",startsExpr),_super:kw("super",startsExpr),_class:kw("class",startsExpr),_extends:kw("extends",beforeExpr),_export:kw("export"),_import:kw("import",startsExpr),_null:kw("null",startsExpr),_true:kw("true",startsExpr),_false:kw("false",startsExpr),_in:kw("in",{beforeExpr:!0,binop:7}),_instanceof:kw("instanceof",{beforeExpr:!0,binop:7}),_typeof:kw("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:kw("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:kw("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lineBreak=/\r\n?|\n|\u2028|\u2029/,lineBreakG=new RegExp(lineBreak.source,"g");function isNewLine(e){return e===10||e===13||e===8232||e===8233}function nextLineBreak(e,t,o){o===void 0&&(o=e.length);for(var u=t;u<o;u++){var p=e.charCodeAt(u);if(isNewLine(p))return u<o-1&&p===13&&e.charCodeAt(u+1)===10?u+2:u+1}return-1}var nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,skipWhiteSpace=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ref=Object.prototype,hasOwnProperty=ref.hasOwnProperty,toString=ref.toString,hasOwn=Object.hasOwn||(function(e,t){return hasOwnProperty.call(e,t)}),isArray=Array.isArray||(function(e){return toString.call(e)==="[object Array]"}),regexpCache=Object.create(null);function wordsRegexp(e){return regexpCache[e]||(regexpCache[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var loneSurrogate=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Position=function(t,o){this.line=t,this.column=o};Position.prototype.offset=function(t){return new Position(this.line,this.column+t)};var SourceLocation=function(t,o,u){this.start=o,this.end=u,t.sourceFile!==null&&(this.source=t.sourceFile)};function getLineInfo(e,t){for(var o=1,u=0;;){var p=nextLineBreak(e,u,t);if(p<0)return new Position(o,t-u);++o,u=p}}var defaultOptions={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},warnedAboutEcmaVersion=!1;function getOptions(e){var t={};for(var o in defaultOptions)t[o]=e&&hasOwn(e,o)?e[o]:defaultOptions[o];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!warnedAboutEcmaVersion&&typeof console=="object"&&console.warn&&(warnedAboutEcmaVersion=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),isArray(t.onToken)){var u=t.onToken;t.onToken=function(p){return u.push(p)}}return isArray(t.onComment)&&(t.onComment=pushComment(t,t.onComment)),t}function pushComment(e,t){return function(o,u,p,f,b,M){var F={type:o?"Block":"Line",value:u,start:p,end:f};e.locations&&(F.loc=new SourceLocation(this,b,M)),e.ranges&&(F.range=[p,f]),t.push(F)}}var SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_CLASS_FIELD_INIT=512,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(e,t){return SCOPE_FUNCTION|(e?SCOPE_ASYNC:0)|(t?SCOPE_GENERATOR:0)}var BIND_NONE=0,BIND_VAR=1,BIND_LEXICAL=2,BIND_FUNCTION=3,BIND_SIMPLE_CATCH=4,BIND_OUTSIDE=5,Parser=function(t,o,u){this.options=t=getOptions(t),this.sourceFile=t.sourceFile,this.keywords=wordsRegexp(keywords$1[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var p="";t.allowReserved!==!0&&(p=reservedWords[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(p+=" await")),this.reservedWords=wordsRegexp(p);var f=(p?p+" ":"")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(f),this.reservedWordsStrictBind=wordsRegexp(f+" "+reservedWords.strictBind),this.input=String(o),this.containsEsc=!1,u?(this.pos=u,this.lineStart=this.input.lastIndexOf(`
`,u-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=types$1.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(SCOPE_TOP),this.regexpState=null,this.privateNameStack=[]},prototypeAccessors={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Parser.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0},prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0},prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0},prototypeAccessors.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT))return!1;if(o&SCOPE_FUNCTION)return(o&SCOPE_ASYNC)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},prototypeAccessors.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags;return(t&SCOPE_SUPER)>0||this.options.allowSuperOutsideMethod},prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0},prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},prototypeAccessors.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT)||o&SCOPE_FUNCTION&&!(o&SCOPE_ARROW))return!0}return!1},prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0},Parser.extend=function(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];for(var u=this,p=0;p<t.length;p++)u=t[p](u);return u},Parser.parse=function(t,o){return new this(o,t).parse()},Parser.parseExpressionAt=function(t,o,u){var p=new this(u,t,o);return p.nextToken(),p.parseExpression()},Parser.tokenizer=function(t,o){return new this(o,t)},Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype,literal=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;pp$9.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length;var t=literal.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){skipWhiteSpace.lastIndex=e+t[0].length;var o=skipWhiteSpace.exec(this.input),u=o.index+o[0].length,p=this.input.charAt(u);return p===";"||p==="}"||lineBreak.test(o[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(p)||p==="!"&&this.input.charAt(u+1)==="=")}e+=t[0].length,skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length,this.input[e]===";"&&e++}},pp$9.eat=function(e){return this.type===e?(this.next(),!0):!1},pp$9.isContextual=function(e){return this.type===types$1.name&&this.value===e&&!this.containsEsc},pp$9.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1},pp$9.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},pp$9.canInsertSemicolon=function(){return this.type===types$1.eof||this.type===types$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$9.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},pp$9.semicolon=function(){!this.eat(types$1.semi)&&!this.insertSemicolon()&&this.unexpected()},pp$9.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},pp$9.expect=function(e){this.eat(e)||this.unexpected()},pp$9.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var DestructuringErrors=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pp$9.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var o=t?e.parenthesizedAssign:e.parenthesizedBind;o>-1&&this.raiseRecoverable(o,t?"Assigning to rvalue":"Parenthesized pattern")}},pp$9.checkExpressionErrors=function(e,t){if(!e)return!1;var o=e.shorthandAssign,u=e.doubleProto;if(!t)return o>=0||u>=0;o>=0&&this.raise(o,"Shorthand property assignments are valid only in destructuring patterns"),u>=0&&this.raiseRecoverable(u,"Redefinition of __proto__ property")},pp$9.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},pp$9.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var pp$8=Parser.prototype;pp$8.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==types$1.eof;){var o=this.parseStatement(null,!0,t);e.body.push(o)}if(this.inModule)for(var u=0,p=Object.keys(this.undefinedExports);u<p.length;u+=1){var f=p[u];this.raiseRecoverable(this.undefinedExports[f].start,"Export '"+f+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var loopLabel={kind:"loop"},switchLabel={kind:"switch"};pp$8.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;skipWhiteSpace.lastIndex=this.pos;var t=skipWhiteSpace.exec(this.input),o=this.pos+t[0].length,u=this.input.charCodeAt(o);if(u===91||u===92)return!0;if(e)return!1;if(u===123||u>55295&&u<56320)return!0;if(isIdentifierStart(u,!0)){for(var p=o+1;isIdentifierChar(u=this.input.charCodeAt(p),!0);)++p;if(u===92||u>55295&&u<56320)return!0;var f=this.input.slice(o,p);if(!keywordRelationalOperator.test(f))return!0}return!1},pp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;skipWhiteSpace.lastIndex=this.pos;var e=skipWhiteSpace.exec(this.input),t=this.pos+e[0].length,o;return!lineBreak.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(isIdentifierChar(o=this.input.charCodeAt(t+8))||o>55295&&o<56320))},pp$8.isUsingKeyword=function(e,t){if(this.options.ecmaVersion<17||!this.isContextual(e?"await":"using"))return!1;skipWhiteSpace.lastIndex=this.pos;var o=skipWhiteSpace.exec(this.input),u=this.pos+o[0].length;if(lineBreak.test(this.input.slice(this.pos,u)))return!1;if(e){var p=u+5,f;if(this.input.slice(u,p)!=="using"||p===this.input.length||isIdentifierChar(f=this.input.charCodeAt(p))||f>55295&&f<56320)return!1;skipWhiteSpace.lastIndex=p;var b=skipWhiteSpace.exec(this.input);if(b&&lineBreak.test(this.input.slice(p,p+b[0].length)))return!1}if(t){var M=u+2,F;if(this.input.slice(u,M)==="of"&&(M===this.input.length||!isIdentifierChar(F=this.input.charCodeAt(M))&&!(F>55295&&F<56320)))return!1}var S=this.input.charCodeAt(u);return isIdentifierStart(S,!0)||S===92},pp$8.isAwaitUsing=function(e){return this.isUsingKeyword(!0,e)},pp$8.isUsing=function(e){return this.isUsingKeyword(!1,e)},pp$8.parseStatement=function(e,t,o){var u=this.type,p=this.startNode(),f;switch(this.isLet(e)&&(u=types$1._var,f="let"),u){case types$1._break:case types$1._continue:return this.parseBreakContinueStatement(p,u.keyword);case types$1._debugger:return this.parseDebuggerStatement(p);case types$1._do:return this.parseDoStatement(p);case types$1._for:return this.parseForStatement(p);case types$1._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(p,!1,!e);case types$1._class:return e&&this.unexpected(),this.parseClass(p,!0);case types$1._if:return this.parseIfStatement(p);case types$1._return:return this.parseReturnStatement(p);case types$1._switch:return this.parseSwitchStatement(p);case types$1._throw:return this.parseThrowStatement(p);case types$1._try:return this.parseTryStatement(p);case types$1._const:case types$1._var:return f=f||this.value,e&&f!=="var"&&this.unexpected(),this.parseVarStatement(p,f);case types$1._while:return this.parseWhileStatement(p);case types$1._with:return this.parseWithStatement(p);case types$1.braceL:return this.parseBlock(!0,p);case types$1.semi:return this.parseEmptyStatement(p);case types$1._export:case types$1._import:if(this.options.ecmaVersion>10&&u===types$1._import){skipWhiteSpace.lastIndex=this.pos;var b=skipWhiteSpace.exec(this.input),M=this.pos+b[0].length,F=this.input.charCodeAt(M);if(F===40||F===46)return this.parseExpressionStatement(p,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),u===types$1._import?this.parseImport(p):this.parseExport(p,o);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(p,!0,!e);var S=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(S)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),S==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(p,!1,S),this.semicolon(),this.finishNode(p,"VariableDeclaration");var k=this.value,N=this.parseExpression();return u===types$1.name&&N.type==="Identifier"&&this.eat(types$1.colon)?this.parseLabeledStatement(p,k,N,e):this.parseExpressionStatement(p,N)}},pp$8.parseBreakContinueStatement=function(e,t){var o=t==="break";this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.label=null:this.type!==types$1.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var u=0;u<this.labels.length;++u){var p=this.labels[u];if((e.label==null||p.name===e.label.name)&&(p.kind!=null&&(o||p.kind==="loop")||e.label&&o))break}return u===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,o?"BreakStatement":"ContinueStatement")},pp$8.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},pp$8.parseDoStatement=function(e){return this.next(),this.labels.push(loopLabel),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(types$1._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(types$1.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},pp$8.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(loopLabel),this.enterScope(0),this.expect(types$1.parenL),this.type===types$1.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var o=this.isLet();if(this.type===types$1._var||this.type===types$1._const||o){var u=this.startNode(),p=o?"let":this.value;return this.next(),this.parseVar(u,!0,p),this.finishNode(u,"VariableDeclaration"),this.parseForAfterInit(e,u,t)}var f=this.isContextual("let"),b=!1,M=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(M){var F=this.startNode();return this.next(),M==="await using"&&this.next(),this.parseVar(F,!0,M),this.finishNode(F,"VariableDeclaration"),this.parseForAfterInit(e,F,t)}var S=this.containsEsc,k=new DestructuringErrors,N=this.start,$=t>-1?this.parseExprSubscripts(k,"await"):this.parseExpression(!0,k);return this.type===types$1._in||(b=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===types$1._in&&this.unexpected(t),e.await=!0):b&&this.options.ecmaVersion>=8&&($.start===N&&!S&&$.type==="Identifier"&&$.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),f&&b&&this.raise($.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable($,!1,k),this.checkLValPattern($),this.parseForIn(e,$)):(this.checkExpressionErrors(k,!0),t>-1&&this.unexpected(t),this.parseFor(e,$))},pp$8.parseForAfterInit=function(e,t,o){return(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===types$1._in?o>-1&&this.unexpected(o):e.await=o>-1),this.parseForIn(e,t)):(o>-1&&this.unexpected(o),this.parseFor(e,t))},pp$8.parseFunctionStatement=function(e,t,o){return this.next(),this.parseFunction(e,FUNC_STATEMENT|(o?0:FUNC_HANGING_STATEMENT),!1,t)},pp$8.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(types$1._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},pp$8.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},pp$8.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(types$1.braceL),this.labels.push(switchLabel),this.enterScope(0);for(var t,o=!1;this.type!==types$1.braceR;)if(this.type===types$1._case||this.type===types$1._default){var u=this.type===types$1._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),u?t.test=this.parseExpression():(o&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),o=!0,t.test=null),this.expect(types$1.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},pp$8.parseThrowStatement=function(e){return this.next(),lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var empty$1=[];pp$8.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?SCOPE_SIMPLE_CATCH:0),this.checkLValPattern(e,t?BIND_SIMPLE_CATCH:BIND_LEXICAL),this.expect(types$1.parenR),e},pp$8.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===types$1._catch){var t=this.startNode();this.next(),this.eat(types$1.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(types$1._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},pp$8.parseVarStatement=function(e,t,o){return this.next(),this.parseVar(e,!1,t,o),this.semicolon(),this.finishNode(e,"VariableDeclaration")},pp$8.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(loopLabel),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},pp$8.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},pp$8.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},pp$8.parseLabeledStatement=function(e,t,o,u){for(var p=0,f=this.labels;p<f.length;p+=1){var b=f[p];b.name===t&&this.raise(o.start,"Label '"+t+"' is already declared")}for(var M=this.type.isLoop?"loop":this.type===types$1._switch?"switch":null,F=this.labels.length-1;F>=0;F--){var S=this.labels[F];if(S.statementStart===e.start)S.statementStart=this.start,S.kind=M;else break}return this.labels.push({name:t,kind:M,statementStart:this.start}),e.body=this.parseStatement(u?u.indexOf("label")===-1?u+"label":u:"label"),this.labels.pop(),e.label=o,this.finishNode(e,"LabeledStatement")},pp$8.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},pp$8.parseBlock=function(e,t,o){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(types$1.braceL),e&&this.enterScope(0);this.type!==types$1.braceR;){var u=this.parseStatement(null);t.body.push(u)}return o&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},pp$8.parseFor=function(e,t){return e.init=t,this.expect(types$1.semi),e.test=this.type===types$1.semi?null:this.parseExpression(),this.expect(types$1.semi),e.update=this.type===types$1.parenR?null:this.parseExpression(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},pp$8.parseForIn=function(e,t){var o=this.type===types$1._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!o||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(o?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=o?this.parseExpression():this.parseMaybeAssign(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,o?"ForInStatement":"ForOfStatement")},pp$8.parseVar=function(e,t,o,u){for(e.declarations=[],e.kind=o;;){var p=this.startNode();if(this.parseVarId(p,o),this.eat(types$1.eq)?p.init=this.parseMaybeAssign(t):!u&&o==="const"&&!(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!u&&(o==="using"||o==="await using")&&this.options.ecmaVersion>=17&&this.type!==types$1._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+o+" declaration"):!u&&p.id.type!=="Identifier"&&!(t&&(this.type===types$1._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):p.init=null,e.declarations.push(this.finishNode(p,"VariableDeclarator")),!this.eat(types$1.comma))break}return e},pp$8.parseVarId=function(e,t){e.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?BIND_VAR:BIND_LEXICAL,!1)};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;pp$8.parseFunction=function(e,t,o,u,p){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!u)&&(this.type===types$1.star&&t&FUNC_HANGING_STATEMENT&&this.unexpected(),e.generator=this.eat(types$1.star)),this.options.ecmaVersion>=8&&(e.async=!!u),t&FUNC_STATEMENT&&(e.id=t&FUNC_NULLABLE_ID&&this.type!==types$1.name?null:this.parseIdent(),e.id&&!(t&FUNC_HANGING_STATEMENT)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION));var f=this.yieldPos,b=this.awaitPos,M=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(e.async,e.generator)),t&FUNC_STATEMENT||(e.id=this.type===types$1.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,o,!1,p),this.yieldPos=f,this.awaitPos=b,this.awaitIdentPos=M,this.finishNode(e,t&FUNC_STATEMENT?"FunctionDeclaration":"FunctionExpression")},pp$8.parseFunctionParams=function(e){this.expect(types$1.parenL),e.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},pp$8.parseClass=function(e,t){this.next();var o=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var u=this.enterClassBody(),p=this.startNode(),f=!1;for(p.body=[],this.expect(types$1.braceL);this.type!==types$1.braceR;){var b=this.parseClassElement(e.superClass!==null);b&&(p.body.push(b),b.type==="MethodDefinition"&&b.kind==="constructor"?(f&&this.raiseRecoverable(b.start,"Duplicate constructor in the same class"),f=!0):b.key&&b.key.type==="PrivateIdentifier"&&isPrivateNameConflicted(u,b)&&this.raiseRecoverable(b.key.start,"Identifier '#"+b.key.name+"' has already been declared"))}return this.strict=o,this.next(),e.body=this.finishNode(p,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},pp$8.parseClassElement=function(e){if(this.eat(types$1.semi))return null;var t=this.options.ecmaVersion,o=this.startNode(),u="",p=!1,f=!1,b="method",M=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(types$1.braceL))return this.parseClassStaticBlock(o),o;this.isClassElementNameStart()||this.type===types$1.star?M=!0:u="static"}if(o.static=M,!u&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===types$1.star)&&!this.canInsertSemicolon()?f=!0:u="async"),!u&&(t>=9||!f)&&this.eat(types$1.star)&&(p=!0),!u&&!f&&!p){var F=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?b=F:u=F)}if(u?(o.computed=!1,o.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),o.key.name=u,this.finishNode(o.key,"Identifier")):this.parseClassElementName(o),t<13||this.type===types$1.parenL||b!=="method"||p||f){var S=!o.static&&checkKeyName(o,"constructor"),k=S&&e;S&&b!=="method"&&this.raise(o.key.start,"Constructor can't have get/set modifier"),o.kind=S?"constructor":b,this.parseClassMethod(o,p,f,k)}else this.parseClassField(o);return o},pp$8.isClassElementNameStart=function(){return this.type===types$1.name||this.type===types$1.privateId||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword},pp$8.parseClassElementName=function(e){this.type===types$1.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},pp$8.parseClassMethod=function(e,t,o,u){var p=e.key;e.kind==="constructor"?(t&&this.raise(p.start,"Constructor can't be a generator"),o&&this.raise(p.start,"Constructor can't be an async method")):e.static&&checkKeyName(e,"prototype")&&this.raise(p.start,"Classes may not have a static property named prototype");var f=e.value=this.parseMethod(t,o,u);return e.kind==="get"&&f.params.length!==0&&this.raiseRecoverable(f.start,"getter should have no params"),e.kind==="set"&&f.params.length!==1&&this.raiseRecoverable(f.start,"setter should have exactly one param"),e.kind==="set"&&f.params[0].type==="RestElement"&&this.raiseRecoverable(f.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")},pp$8.parseClassField=function(e){return checkKeyName(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&checkKeyName(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(types$1.eq)?(this.enterScope(SCOPE_CLASS_FIELD_INIT|SCOPE_SUPER),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")},pp$8.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);this.type!==types$1.braceR;){var o=this.parseStatement(null);e.body.push(o)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")},pp$8.parseClassId=function(e,t){this.type===types$1.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,BIND_LEXICAL,!1)):(t===!0&&this.unexpected(),e.id=null)},pp$8.parseClassSuper=function(e){e.superClass=this.eat(types$1._extends)?this.parseExprSubscripts(null,!1):null},pp$8.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared},pp$8.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,o=e.used;if(this.options.checkPrivateFields)for(var u=this.privateNameStack.length,p=u===0?null:this.privateNameStack[u-1],f=0;f<o.length;++f){var b=o[f];hasOwn(t,b.name)||(p?p.used.push(b):this.raiseRecoverable(b.start,"Private field '#"+b.name+"' must be declared in an enclosing class"))}};function isPrivateNameConflicted(e,t){var o=t.key.name,u=e[o],p="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(p=(t.static?"s":"i")+t.kind),u==="iget"&&p==="iset"||u==="iset"&&p==="iget"||u==="sget"&&p==="sset"||u==="sset"&&p==="sget"?(e[o]="true",!1):u?!0:(e[o]=p,!1)}function checkKeyName(e,t){var o=e.computed,u=e.key;return!o&&(u.type==="Identifier"&&u.name===t||u.type==="Literal"&&u.value===t)}pp$8.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")},pp$8.parseExport=function(e,t){if(this.next(),this.eat(types$1.star))return this.parseExportAllDeclaration(e,t);if(this.eat(types$1._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var o=0,u=e.specifiers;o<u.length;o+=1){var p=u[o];this.checkUnreserved(p.local),this.checkLocalExport(p.local),p.local.type==="Literal"&&this.raise(p.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},pp$8.parseExportDeclaration=function(e){return this.parseStatement(null)},pp$8.parseExportDefaultDeclaration=function(){var e;if(this.type===types$1._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,FUNC_STATEMENT|FUNC_NULLABLE_ID,!1,e)}else if(this.type===types$1._class){var o=this.startNode();return this.parseClass(o,"nullableID")}else{var u=this.parseMaybeAssign();return this.semicolon(),u}},pp$8.checkExport=function(e,t,o){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),hasOwn(e,t)&&this.raiseRecoverable(o,"Duplicate export '"+t+"'"),e[t]=!0)},pp$8.checkPatternExport=function(e,t){var o=t.type;if(o==="Identifier")this.checkExport(e,t,t.start);else if(o==="ObjectPattern")for(var u=0,p=t.properties;u<p.length;u+=1){var f=p[u];this.checkPatternExport(e,f)}else if(o==="ArrayPattern")for(var b=0,M=t.elements;b<M.length;b+=1){var F=M[b];F&&this.checkPatternExport(e,F)}else o==="Property"?this.checkPatternExport(e,t.value):o==="AssignmentPattern"?this.checkPatternExport(e,t.left):o==="RestElement"&&this.checkPatternExport(e,t.argument)},pp$8.checkVariableExport=function(e,t){if(e)for(var o=0,u=t;o<u.length;o+=1){var p=u[o];this.checkPatternExport(e,p.id)}},pp$8.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},pp$8.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")},pp$8.parseExportSpecifiers=function(e){var t=[],o=!0;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;t.push(this.parseExportSpecifier(e))}return t},pp$8.parseImport=function(e){return this.next(),this.type===types$1.string?(e.specifiers=empty$1,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===types$1.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},pp$8.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportSpecifier")},pp$8.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportDefaultSpecifier")},pp$8.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportNamespaceSpecifier")},pp$8.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===types$1.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(types$1.comma)))return e;if(this.type===types$1.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(t)t=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;e.push(this.parseImportSpecifier())}return e},pp$8.parseWithClause=function(){var e=[];if(!this.eat(types$1._with))return e;this.expect(types$1.braceL);for(var t={},o=!0;!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;var u=this.parseImportAttribute(),p=u.key.type==="Identifier"?u.key.name:u.key.value;hasOwn(t,p)&&this.raiseRecoverable(u.key.start,"Duplicate attribute key '"+p+"'"),t[p]=!0,e.push(u)}return e},pp$8.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(types$1.colon),this.type!==types$1.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")},pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1.string){var e=this.parseLiteral(this.value);return loneSurrogate.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)},pp$8.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},pp$8.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var pp$7=Parser.prototype;pp$7.toAssignable=function(e,t,o){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",o&&this.checkPatternErrors(o,!0);for(var u=0,p=e.properties;u<p.length;u+=1){var f=p[u];this.toAssignable(f,t),f.type==="RestElement"&&(f.argument.type==="ArrayPattern"||f.argument.type==="ObjectPattern")&&this.raise(f.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",o&&this.checkPatternErrors(o,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,o);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else o&&this.checkPatternErrors(o,!0);return e},pp$7.toAssignableList=function(e,t){for(var o=e.length,u=0;u<o;u++){var p=e[u];p&&this.toAssignable(p,t)}if(o){var f=e[o-1];this.options.ecmaVersion===6&&t&&f&&f.type==="RestElement"&&f.argument.type!=="Identifier"&&this.unexpected(f.argument.start)}return e},pp$7.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},pp$7.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==types$1.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},pp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case types$1.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(types$1.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case types$1.braceL:return this.parseObj(!0)}return this.parseIdent()},pp$7.parseBindingList=function(e,t,o,u){for(var p=[],f=!0;!this.eat(e);)if(f?f=!1:this.expect(types$1.comma),t&&this.type===types$1.comma)p.push(null);else{if(o&&this.afterTrailingComma(e))break;if(this.type===types$1.ellipsis){var b=this.parseRestBinding();this.parseBindingListItem(b),p.push(b),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else p.push(this.parseAssignableListItem(u))}return p},pp$7.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t},pp$7.parseBindingListItem=function(e){return e},pp$7.parseMaybeDefault=function(e,t,o){if(o=o||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(types$1.eq))return o;var u=this.startNodeAt(e,t);return u.left=o,u.right=this.parseMaybeAssign(),this.finishNode(u,"AssignmentPattern")},pp$7.checkLValSimple=function(e,t,o){t===void 0&&(t=BIND_NONE);var u=t!==BIND_NONE;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(u?"Binding ":"Assigning to ")+e.name+" in strict mode"),u&&(t===BIND_LEXICAL&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),o&&(hasOwn(o,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),o[e.name]=!0),t!==BIND_OUTSIDE&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":u&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return u&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,o);default:this.raise(e.start,(u?"Binding":"Assigning to")+" rvalue")}},pp$7.checkLValPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"ObjectPattern":for(var u=0,p=e.properties;u<p.length;u+=1){var f=p[u];this.checkLValInnerPattern(f,t,o)}break;case"ArrayPattern":for(var b=0,M=e.elements;b<M.length;b+=1){var F=M[b];F&&this.checkLValInnerPattern(F,t,o)}break;default:this.checkLValSimple(e,t,o)}},pp$7.checkLValInnerPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"Property":this.checkLValInnerPattern(e.value,t,o);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,o);break;case"RestElement":this.checkLValPattern(e.argument,t,o);break;default:this.checkLValPattern(e,t,o)}};var TokContext=function(t,o,u,p,f){this.token=t,this.isExpr=!!o,this.preserveSpace=!!u,this.override=p,this.generator=!!f},types={b_stat:new TokContext("{",!1),b_expr:new TokContext("{",!0),b_tmpl:new TokContext("${",!1),p_stat:new TokContext("(",!1),p_expr:new TokContext("(",!0),q_tmpl:new TokContext("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new TokContext("function",!1),f_expr:new TokContext("function",!0),f_expr_gen:new TokContext("function",!0,!1,null,!0),f_gen:new TokContext("function",!1,!1,null,!0)},pp$6=Parser.prototype;pp$6.initialContext=function(){return[types.b_stat]},pp$6.curContext=function(){return this.context[this.context.length-1]},pp$6.braceIsBlock=function(e){var t=this.curContext();return t===types.f_expr||t===types.f_stat?!0:e===types$1.colon&&(t===types.b_stat||t===types.b_expr)?!t.isExpr:e===types$1._return||e===types$1.name&&this.exprAllowed?lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):e===types$1._else||e===types$1.semi||e===types$1.eof||e===types$1.parenR||e===types$1.arrow?!0:e===types$1.braceL?t===types.b_stat:e===types$1._var||e===types$1._const||e===types$1.name?!1:!this.exprAllowed},pp$6.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1},pp$6.updateContext=function(e){var t,o=this.type;o.keyword&&e===types$1.dot?this.exprAllowed=!1:(t=o.updateContext)?t.call(this,e):this.exprAllowed=o.beforeExpr},pp$6.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)},types$1.parenR.updateContext=types$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===types.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr},types$1.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?types.b_stat:types.b_expr),this.exprAllowed=!0},types$1.dollarBraceL.updateContext=function(){this.context.push(types.b_tmpl),this.exprAllowed=!0},types$1.parenL.updateContext=function(e){var t=e===types$1._if||e===types$1._for||e===types$1._with||e===types$1._while;this.context.push(t?types.p_stat:types.p_expr),this.exprAllowed=!0},types$1.incDec.updateContext=function(){},types$1._function.updateContext=types$1._class.updateContext=function(e){e.beforeExpr&&e!==types$1._else&&!(e===types$1.semi&&this.curContext()!==types.p_stat)&&!(e===types$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===types$1.colon||e===types$1.braceL)&&this.curContext()===types.b_stat)?this.context.push(types.f_expr):this.context.push(types.f_stat),this.exprAllowed=!1},types$1.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},types$1.backQuote.updateContext=function(){this.curContext()===types.q_tmpl?this.context.pop():this.context.push(types.q_tmpl),this.exprAllowed=!1},types$1.star.updateContext=function(e){if(e===types$1._function){var t=this.context.length-1;this.context[t]===types.f_expr?this.context[t]=types.f_expr_gen:this.context[t]=types.f_gen}this.exprAllowed=!0},types$1.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==types$1.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var pp$5=Parser.prototype;pp$5.checkPropClash=function(e,t,o){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var u=e.key,p;switch(u.type){case"Identifier":p=u.name;break;case"Literal":p=String(u.value);break;default:return}var f=e.kind;if(this.options.ecmaVersion>=6){p==="__proto__"&&f==="init"&&(t.proto&&(o?o.doubleProto<0&&(o.doubleProto=u.start):this.raiseRecoverable(u.start,"Redefinition of __proto__ property")),t.proto=!0);return}p="$"+p;var b=t[p];if(b){var M;f==="init"?M=this.strict&&b.init||b.get||b.set:M=b.init||b[f],M&&this.raiseRecoverable(u.start,"Redefinition of property")}else b=t[p]={init:!1,get:!1,set:!1};b[f]=!0}},pp$5.parseExpression=function(e,t){var o=this.start,u=this.startLoc,p=this.parseMaybeAssign(e,t);if(this.type===types$1.comma){var f=this.startNodeAt(o,u);for(f.expressions=[p];this.eat(types$1.comma);)f.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(f,"SequenceExpression")}return p},pp$5.parseMaybeAssign=function(e,t,o){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var u=!1,p=-1,f=-1,b=-1;t?(p=t.parenthesizedAssign,f=t.trailingComma,b=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new DestructuringErrors,u=!0);var M=this.start,F=this.startLoc;(this.type===types$1.parenL||this.type===types$1.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var S=this.parseMaybeConditional(e,t);if(o&&(S=o.call(this,S,M,F)),this.type.isAssign){var k=this.startNodeAt(M,F);return k.operator=this.value,this.type===types$1.eq&&(S=this.toAssignable(S,!1,t)),u||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=S.start&&(t.shorthandAssign=-1),this.type===types$1.eq?this.checkLValPattern(S):this.checkLValSimple(S),k.left=S,this.next(),k.right=this.parseMaybeAssign(e),b>-1&&(t.doubleProto=b),this.finishNode(k,"AssignmentExpression")}else u&&this.checkExpressionErrors(t,!0);return p>-1&&(t.parenthesizedAssign=p),f>-1&&(t.trailingComma=f),S},pp$5.parseMaybeConditional=function(e,t){var o=this.start,u=this.startLoc,p=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return p;if(this.eat(types$1.question)){var f=this.startNodeAt(o,u);return f.test=p,f.consequent=this.parseMaybeAssign(),this.expect(types$1.colon),f.alternate=this.parseMaybeAssign(e),this.finishNode(f,"ConditionalExpression")}return p},pp$5.parseExprOps=function(e,t){var o=this.start,u=this.startLoc,p=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||p.start===o&&p.type==="ArrowFunctionExpression"?p:this.parseExprOp(p,o,u,-1,e)},pp$5.parseExprOp=function(e,t,o,u,p){var f=this.type.binop;if(f!=null&&(!p||this.type!==types$1._in)&&f>u){var b=this.type===types$1.logicalOR||this.type===types$1.logicalAND,M=this.type===types$1.coalesce;M&&(f=types$1.logicalAND.binop);var F=this.value;this.next();var S=this.start,k=this.startLoc,N=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,p),S,k,f,p),$=this.buildBinary(t,o,e,N,F,b||M);return(b&&this.type===types$1.coalesce||M&&(this.type===types$1.logicalOR||this.type===types$1.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp($,t,o,u,p)}return e},pp$5.buildBinary=function(e,t,o,u,p,f){u.type==="PrivateIdentifier"&&this.raise(u.start,"Private identifier can only be left side of binary expression");var b=this.startNodeAt(e,t);return b.left=o,b.operator=p,b.right=u,this.finishNode(b,f?"LogicalExpression":"BinaryExpression")},pp$5.parseMaybeUnary=function(e,t,o,u){var p=this.start,f=this.startLoc,b;if(this.isContextual("await")&&this.canAwait)b=this.parseAwait(u),t=!0;else if(this.type.prefix){var M=this.startNode(),F=this.type===types$1.incDec;M.operator=this.value,M.prefix=!0,this.next(),M.argument=this.parseMaybeUnary(null,!0,F,u),this.checkExpressionErrors(e,!0),F?this.checkLValSimple(M.argument):this.strict&&M.operator==="delete"&&isLocalVariableAccess(M.argument)?this.raiseRecoverable(M.start,"Deleting local variable in strict mode"):M.operator==="delete"&&isPrivateFieldAccess(M.argument)?this.raiseRecoverable(M.start,"Private fields can not be deleted"):t=!0,b=this.finishNode(M,F?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===types$1.privateId)(u||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),b=this.parsePrivateIdent(),this.type!==types$1._in&&this.unexpected();else{if(b=this.parseExprSubscripts(e,u),this.checkExpressionErrors(e))return b;for(;this.type.postfix&&!this.canInsertSemicolon();){var S=this.startNodeAt(p,f);S.operator=this.value,S.prefix=!1,S.argument=b,this.checkLValSimple(b),this.next(),b=this.finishNode(S,"UpdateExpression")}}if(!o&&this.eat(types$1.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(p,f,b,this.parseMaybeUnary(null,!1,!1,u),"**",!1);else return b};function isLocalVariableAccess(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&isLocalVariableAccess(e.expression)}function isPrivateFieldAccess(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&isPrivateFieldAccess(e.expression)||e.type==="ParenthesizedExpression"&&isPrivateFieldAccess(e.expression)}pp$5.parseExprSubscripts=function(e,t){var o=this.start,u=this.startLoc,p=this.parseExprAtom(e,t);if(p.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return p;var f=this.parseSubscripts(p,o,u,!1,t);return e&&f.type==="MemberExpression"&&(e.parenthesizedAssign>=f.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=f.start&&(e.parenthesizedBind=-1),e.trailingComma>=f.start&&(e.trailingComma=-1)),f},pp$5.parseSubscripts=function(e,t,o,u,p){for(var f=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,b=!1;;){var M=this.parseSubscript(e,t,o,u,f,b,p);if(M.optional&&(b=!0),M===e||M.type==="ArrowFunctionExpression"){if(b){var F=this.startNodeAt(t,o);F.expression=M,M=this.finishNode(F,"ChainExpression")}return M}e=M}},pp$5.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(types$1.arrow)},pp$5.parseSubscriptAsyncArrow=function(e,t,o,u){return this.parseArrowExpression(this.startNodeAt(e,t),o,!0,u)},pp$5.parseSubscript=function(e,t,o,u,p,f,b){var M=this.options.ecmaVersion>=11,F=M&&this.eat(types$1.questionDot);u&&F&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var S=this.eat(types$1.bracketL);if(S||F&&this.type!==types$1.parenL&&this.type!==types$1.backQuote||this.eat(types$1.dot)){var k=this.startNodeAt(t,o);k.object=e,S?(k.property=this.parseExpression(),this.expect(types$1.bracketR)):this.type===types$1.privateId&&e.type!=="Super"?k.property=this.parsePrivateIdent():k.property=this.parseIdent(this.options.allowReserved!=="never"),k.computed=!!S,M&&(k.optional=F),e=this.finishNode(k,"MemberExpression")}else if(!u&&this.eat(types$1.parenL)){var N=new DestructuringErrors,$=this.yieldPos,R=this.awaitPos,U=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var V=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1,N);if(p&&!F&&this.shouldParseAsyncArrow())return this.checkPatternErrors(N,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=$,this.awaitPos=R,this.awaitIdentPos=U,this.parseSubscriptAsyncArrow(t,o,V,b);this.checkExpressionErrors(N,!0),this.yieldPos=$||this.yieldPos,this.awaitPos=R||this.awaitPos,this.awaitIdentPos=U||this.awaitIdentPos;var z=this.startNodeAt(t,o);z.callee=e,z.arguments=V,M&&(z.optional=F),e=this.finishNode(z,"CallExpression")}else if(this.type===types$1.backQuote){(F||f)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var K=this.startNodeAt(t,o);K.tag=e,K.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(K,"TaggedTemplateExpression")}return e},pp$5.parseExprAtom=function(e,t,o){this.type===types$1.slash&&this.readRegexp();var u,p=this.potentialArrowAt===this.start;switch(this.type){case types$1._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),u=this.startNode(),this.next(),this.type===types$1.parenL&&!this.allowDirectSuper&&this.raise(u.start,"super() call outside constructor of a subclass"),this.type!==types$1.dot&&this.type!==types$1.bracketL&&this.type!==types$1.parenL&&this.unexpected(),this.finishNode(u,"Super");case types$1._this:return u=this.startNode(),this.next(),this.finishNode(u,"ThisExpression");case types$1.name:var f=this.start,b=this.startLoc,M=this.containsEsc,F=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!M&&F.name==="async"&&!this.canInsertSemicolon()&&this.eat(types$1._function))return this.overrideContext(types.f_expr),this.parseFunction(this.startNodeAt(f,b),0,!1,!0,t);if(p&&!this.canInsertSemicolon()){if(this.eat(types$1.arrow))return this.parseArrowExpression(this.startNodeAt(f,b),[F],!1,t);if(this.options.ecmaVersion>=8&&F.name==="async"&&this.type===types$1.name&&!M&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return F=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(types$1.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(f,b),[F],!0,t)}return F;case types$1.regexp:var S=this.value;return u=this.parseLiteral(S.value),u.regex={pattern:S.pattern,flags:S.flags},u;case types$1.num:case types$1.string:return this.parseLiteral(this.value);case types$1._null:case types$1._true:case types$1._false:return u=this.startNode(),u.value=this.type===types$1._null?null:this.type===types$1._true,u.raw=this.type.keyword,this.next(),this.finishNode(u,"Literal");case types$1.parenL:var k=this.start,N=this.parseParenAndDistinguishExpression(p,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(N)&&(e.parenthesizedAssign=k),e.parenthesizedBind<0&&(e.parenthesizedBind=k)),N;case types$1.bracketL:return u=this.startNode(),this.next(),u.elements=this.parseExprList(types$1.bracketR,!0,!0,e),this.finishNode(u,"ArrayExpression");case types$1.braceL:return this.overrideContext(types.b_expr),this.parseObj(!1,e);case types$1._function:return u=this.startNode(),this.next(),this.parseFunction(u,0);case types$1._class:return this.parseClass(this.startNode(),!1);case types$1._new:return this.parseNew();case types$1.backQuote:return this.parseTemplate();case types$1._import:return this.options.ecmaVersion>=11?this.parseExprImport(o):this.unexpected();default:return this.parseExprAtomDefault()}},pp$5.parseExprAtomDefault=function(){this.unexpected()},pp$5.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===types$1.parenL&&!e)return this.parseDynamicImport(t);if(this.type===types$1.dot){var o=this.startNodeAt(t.start,t.loc&&t.loc.start);return o.name="import",t.meta=this.finishNode(o,"Identifier"),this.parseImportMeta(t)}else this.unexpected()},pp$5.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(types$1.parenR)?e.options=null:(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(types$1.parenR)||(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)||this.unexpected())));else if(!this.eat(types$1.parenR)){var t=this.start;this.eat(types$1.comma)&&this.eat(types$1.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},pp$5.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},pp$5.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},pp$5.parseParenExpression=function(){this.expect(types$1.parenL);var e=this.parseExpression();return this.expect(types$1.parenR),e},pp$5.shouldParseArrow=function(e){return!this.canInsertSemicolon()},pp$5.parseParenAndDistinguishExpression=function(e,t){var o=this.start,u=this.startLoc,p,f=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var b=this.start,M=this.startLoc,F=[],S=!0,k=!1,N=new DestructuringErrors,$=this.yieldPos,R=this.awaitPos,U;for(this.yieldPos=0,this.awaitPos=0;this.type!==types$1.parenR;)if(S?S=!1:this.expect(types$1.comma),f&&this.afterTrailingComma(types$1.parenR,!0)){k=!0;break}else if(this.type===types$1.ellipsis){U=this.start,F.push(this.parseParenItem(this.parseRestBinding())),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else F.push(this.parseMaybeAssign(!1,N,this.parseParenItem));var V=this.lastTokEnd,z=this.lastTokEndLoc;if(this.expect(types$1.parenR),e&&this.shouldParseArrow(F)&&this.eat(types$1.arrow))return this.checkPatternErrors(N,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=$,this.awaitPos=R,this.parseParenArrowList(o,u,F,t);(!F.length||k)&&this.unexpected(this.lastTokStart),U&&this.unexpected(U),this.checkExpressionErrors(N,!0),this.yieldPos=$||this.yieldPos,this.awaitPos=R||this.awaitPos,F.length>1?(p=this.startNodeAt(b,M),p.expressions=F,this.finishNodeAt(p,"SequenceExpression",V,z)):p=F[0]}else p=this.parseParenExpression();if(this.options.preserveParens){var K=this.startNodeAt(o,u);return K.expression=p,this.finishNode(K,"ParenthesizedExpression")}else return p},pp$5.parseParenItem=function(e){return e},pp$5.parseParenArrowList=function(e,t,o,u){return this.parseArrowExpression(this.startNodeAt(e,t),o,!1,u)};var empty=[];pp$5.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===types$1.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var o=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),o&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var u=this.start,p=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),u,p,!0,!1),this.eat(types$1.parenL)?e.arguments=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1):e.arguments=empty,this.finishNode(e,"NewExpression")},pp$5.parseTemplateElement=function(e){var t=e.isTagged,o=this.startNode();return this.type===types$1.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),o.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):o.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),o.tail=this.type===types$1.backQuote,this.finishNode(o,"TemplateElement")},pp$5.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var o=this.startNode();this.next(),o.expressions=[];var u=this.parseTemplateElement({isTagged:t});for(o.quasis=[u];!u.tail;)this.type===types$1.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(types$1.dollarBraceL),o.expressions.push(this.parseExpression()),this.expect(types$1.braceR),o.quasis.push(u=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(o,"TemplateLiteral")},pp$5.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===types$1.name||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$5.parseObj=function(e,t){var o=this.startNode(),u=!0,p={};for(o.properties=[],this.next();!this.eat(types$1.braceR);){if(u)u=!1;else if(this.expect(types$1.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1.braceR))break;var f=this.parseProperty(e,t);e||this.checkPropClash(f,p,t),o.properties.push(f)}return this.finishNode(o,e?"ObjectPattern":"ObjectExpression")},pp$5.parseProperty=function(e,t){var o=this.startNode(),u,p,f,b;if(this.options.ecmaVersion>=9&&this.eat(types$1.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(o.argument=this.parseMaybeAssign(!1,t),this.type===types$1.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(f=this.start,b=this.startLoc),e||(u=this.eat(types$1.star)));var M=this.containsEsc;return this.parsePropertyName(o),!e&&!M&&this.options.ecmaVersion>=8&&!u&&this.isAsyncProp(o)?(p=!0,u=this.options.ecmaVersion>=9&&this.eat(types$1.star),this.parsePropertyName(o)):p=!1,this.parsePropertyValue(o,e,u,p,f,b,t,M),this.finishNode(o,"Property")},pp$5.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var o=e.kind==="get"?0:1;if(e.value.params.length!==o){var u=e.value.start;e.kind==="get"?this.raiseRecoverable(u,"getter should have no params"):this.raiseRecoverable(u,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")},pp$5.parsePropertyValue=function(e,t,o,u,p,f,b,M){(o||u)&&this.type===types$1.colon&&this.unexpected(),this.eat(types$1.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,b),e.kind="init"):this.options.ecmaVersion>=6&&this.type===types$1.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(o,u),e.kind="init"):!t&&!M&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==types$1.comma&&this.type!==types$1.braceR&&this.type!==types$1.eq?((o||u)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((o||u)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=p),t?e.value=this.parseMaybeDefault(p,f,this.copyNode(e.key)):this.type===types$1.eq&&b?(b.shorthandAssign<0&&(b.shorthandAssign=this.start),e.value=this.parseMaybeDefault(p,f,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected()},pp$5.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(types$1.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(types$1.bracketR),e.key;e.computed=!1}return e.key=this.type===types$1.num||this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},pp$5.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},pp$5.parseMethod=function(e,t,o){var u=this.startNode(),p=this.yieldPos,f=this.awaitPos,b=this.awaitIdentPos;return this.initFunction(u),this.options.ecmaVersion>=6&&(u.generator=e),this.options.ecmaVersion>=8&&(u.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(t,u.generator)|SCOPE_SUPER|(o?SCOPE_DIRECT_SUPER:0)),this.expect(types$1.parenL),u.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(u,!1,!0,!1),this.yieldPos=p,this.awaitPos=f,this.awaitIdentPos=b,this.finishNode(u,"FunctionExpression")},pp$5.parseArrowExpression=function(e,t,o,u){var p=this.yieldPos,f=this.awaitPos,b=this.awaitIdentPos;return this.enterScope(functionFlags(o,!1)|SCOPE_ARROW),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!o),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,u),this.yieldPos=p,this.awaitPos=f,this.awaitIdentPos=b,this.finishNode(e,"ArrowFunctionExpression")},pp$5.parseFunctionBody=function(e,t,o,u){var p=t&&this.type!==types$1.braceL,f=this.strict,b=!1;if(p)e.body=this.parseMaybeAssign(u),e.expression=!0,this.checkParams(e,!1);else{var M=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!f||M)&&(b=this.strictDirective(this.end),b&&M&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var F=this.labels;this.labels=[],b&&(this.strict=!0),this.checkParams(e,!f&&!b&&!t&&!o&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,BIND_OUTSIDE),e.body=this.parseBlock(!1,void 0,b&&!f),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=F}this.exitScope()},pp$5.isSimpleParamList=function(e){for(var t=0,o=e;t<o.length;t+=1){var u=o[t];if(u.type!=="Identifier")return!1}return!0},pp$5.checkParams=function(e,t){for(var o=Object.create(null),u=0,p=e.params;u<p.length;u+=1){var f=p[u];this.checkLValInnerPattern(f,BIND_VAR,t?null:o)}},pp$5.parseExprList=function(e,t,o,u){for(var p=[],f=!0;!this.eat(e);){if(f)f=!1;else if(this.expect(types$1.comma),t&&this.afterTrailingComma(e))break;var b=void 0;o&&this.type===types$1.comma?b=null:this.type===types$1.ellipsis?(b=this.parseSpread(u),u&&this.type===types$1.comma&&u.trailingComma<0&&(u.trailingComma=this.start)):b=this.parseMaybeAssign(!1,u),p.push(b)}return p},pp$5.checkUnreserved=function(e){var t=e.start,o=e.end,u=e.name;if(this.inGenerator&&u==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&u==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&SCOPE_VAR)&&u==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(u==="arguments"||u==="await")&&this.raise(t,"Cannot use "+u+" in class static initialization block"),this.keywords.test(u)&&this.raise(t,"Unexpected keyword '"+u+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,o).indexOf("\\")!==-1)){var p=this.strict?this.reservedWordsStrict:this.reservedWords;p.test(u)&&(!this.inAsync&&u==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+u+"' is reserved"))}},pp$5.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t},pp$5.parseIdentNode=function(){var e=this.startNode();return this.type===types$1.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=types$1.name):this.unexpected(),e},pp$5.parsePrivateIdent=function(){var e=this.startNode();return this.type===types$1.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e},pp$5.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===types$1.semi||this.canInsertSemicolon()||this.type!==types$1.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(types$1.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},pp$5.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var pp$4=Parser.prototype;pp$4.raise=function(e,t){var o=getLineInfo(this.input,e);t+=" ("+o.line+":"+o.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var u=new SyntaxError(t);throw u.pos=e,u.loc=o,u.raisedAt=this.pos,u},pp$4.raiseRecoverable=pp$4.raise,pp$4.curPosition=function(){if(this.options.locations)return new Position(this.curLine,this.pos-this.lineStart)};var pp$3=Parser.prototype,Scope=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};pp$3.enterScope=function(e){this.scopeStack.push(new Scope(e))},pp$3.exitScope=function(){this.scopeStack.pop()},pp$3.treatFunctionsAsVarInScope=function(e){return e.flags&SCOPE_FUNCTION||!this.inModule&&e.flags&SCOPE_TOP},pp$3.declareName=function(e,t,o){var u=!1;if(t===BIND_LEXICAL){var p=this.currentScope();u=p.lexical.indexOf(e)>-1||p.functions.indexOf(e)>-1||p.var.indexOf(e)>-1,p.lexical.push(e),this.inModule&&p.flags&SCOPE_TOP&&delete this.undefinedExports[e]}else if(t===BIND_SIMPLE_CATCH){var f=this.currentScope();f.lexical.push(e)}else if(t===BIND_FUNCTION){var b=this.currentScope();this.treatFunctionsAsVar?u=b.lexical.indexOf(e)>-1:u=b.lexical.indexOf(e)>-1||b.var.indexOf(e)>-1,b.functions.push(e)}else for(var M=this.scopeStack.length-1;M>=0;--M){var F=this.scopeStack[M];if(F.lexical.indexOf(e)>-1&&!(F.flags&SCOPE_SIMPLE_CATCH&&F.lexical[0]===e)||!this.treatFunctionsAsVarInScope(F)&&F.functions.indexOf(e)>-1){u=!0;break}if(F.var.push(e),this.inModule&&F.flags&SCOPE_TOP&&delete this.undefinedExports[e],F.flags&SCOPE_VAR)break}u&&this.raiseRecoverable(o,"Identifier '"+e+"' has already been declared")},pp$3.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)},pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},pp$3.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK))return t}},pp$3.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK)&&!(t.flags&SCOPE_ARROW))return t}};var Node=function(t,o,u){this.type="",this.start=o,this.end=0,t.options.locations&&(this.loc=new SourceLocation(t,u)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[o,0])},pp$2=Parser.prototype;pp$2.startNode=function(){return new Node(this,this.start,this.startLoc)},pp$2.startNodeAt=function(e,t){return new Node(this,e,t)};function finishNodeAt(e,t,o,u){return e.type=t,e.end=o,this.options.locations&&(e.loc.end=u),this.options.ranges&&(e.range[1]=o),e}pp$2.finishNode=function(e,t){return finishNodeAt.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},pp$2.finishNodeAt=function(e,t,o,u){return finishNodeAt.call(this,e,t,o,u)},pp$2.copyNode=function(e){var t=new Node(this,e.start,this.startLoc);for(var o in e)t[o]=e[o];return t};var scriptValuesAddedInUnicode="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",ecma9BinaryProperties="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ecma10BinaryProperties=ecma9BinaryProperties+" Extended_Pictographic",ecma11BinaryProperties=ecma10BinaryProperties,ecma12BinaryProperties=ecma11BinaryProperties+" EBase EComp EMod EPres ExtPict",ecma13BinaryProperties=ecma12BinaryProperties,ecma14BinaryProperties=ecma13BinaryProperties,unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties,14:ecma14BinaryProperties},ecma14BinaryPropertiesOfStrings="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",unicodeBinaryPropertiesOfStrings={9:"",10:"",11:"",12:"",13:"",14:ecma14BinaryPropertiesOfStrings},unicodeGeneralCategoryValues="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ecma9ScriptValues="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ecma10ScriptValues=ecma9ScriptValues+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ecma11ScriptValues=ecma10ScriptValues+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ecma12ScriptValues=ecma11ScriptValues+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ecma13ScriptValues=ecma12ScriptValues+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ecma14ScriptValues=ecma13ScriptValues+" "+scriptValuesAddedInUnicode,unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues,14:ecma14ScriptValues},data={};function buildUnicodeData(e){var t=data[e]={binary:wordsRegexp(unicodeBinaryProperties[e]+" "+unicodeGeneralCategoryValues),binaryOfStrings:wordsRegexp(unicodeBinaryPropertiesOfStrings[e]),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var i=0,list=[9,10,11,12,13,14];i<list.length;i+=1){var ecmaVersion=list[i];buildUnicodeData(ecmaVersion)}var pp$1=Parser.prototype,BranchID=function(t,o){this.parent=t,this.base=o||this};BranchID.prototype.separatedFrom=function(t){for(var o=this;o;o=o.parent)for(var u=t;u;u=u.parent)if(o.base===u.base&&o!==u)return!0;return!1},BranchID.prototype.sibling=function(){return new BranchID(this.parent,this.base)};var RegExpValidationState=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=data[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};RegExpValidationState.prototype.reset=function(t,o,u){var p=u.indexOf("v")!==-1,f=u.indexOf("u")!==-1;this.start=t|0,this.source=o+"",this.flags=u,p&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=f&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=f&&this.parser.options.ecmaVersion>=9)},RegExpValidationState.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},RegExpValidationState.prototype.at=function(t,o){o===void 0&&(o=!1);var u=this.source,p=u.length;if(t>=p)return-1;var f=u.charCodeAt(t);if(!(o||this.switchU)||f<=55295||f>=57344||t+1>=p)return f;var b=u.charCodeAt(t+1);return b>=56320&&b<=57343?(f<<10)+b-56613888:f},RegExpValidationState.prototype.nextIndex=function(t,o){o===void 0&&(o=!1);var u=this.source,p=u.length;if(t>=p)return p;var f=u.charCodeAt(t),b;return!(o||this.switchU)||f<=55295||f>=57344||t+1>=p||(b=u.charCodeAt(t+1))<56320||b>57343?t+1:t+2},RegExpValidationState.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)},RegExpValidationState.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},RegExpValidationState.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)},RegExpValidationState.prototype.eat=function(t,o){return o===void 0&&(o=!1),this.current(o)===t?(this.advance(o),!0):!1},RegExpValidationState.prototype.eatChars=function(t,o){o===void 0&&(o=!1);for(var u=this.pos,p=0,f=t;p<f.length;p+=1){var b=f[p],M=this.at(u,o);if(M===-1||M!==b)return!1;u=this.nextIndex(u,o)}return this.pos=u,!0},pp$1.validateRegExpFlags=function(e){for(var t=e.validFlags,o=e.flags,u=!1,p=!1,f=0;f<o.length;f++){var b=o.charAt(f);t.indexOf(b)===-1&&this.raise(e.start,"Invalid regular expression flag"),o.indexOf(b,f+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),b==="u"&&(u=!0),b==="v"&&(p=!0)}this.options.ecmaVersion>=15&&u&&p&&this.raise(e.start,"Invalid regular expression flag")};function hasProp(e){for(var t in e)return!0;return!1}pp$1.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&hasProp(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))},pp$1.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,o=e.backReferenceNames;t<o.length;t+=1){var u=o[t];e.groupNames[u]||e.raise("Invalid named capture referenced")}},pp$1.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new BranchID(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},pp$1.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},pp$1.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1},pp$1.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var o=!1;if(this.options.ecmaVersion>=9&&(o=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!o,!0}return e.pos=t,!1},pp$1.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1},pp$1.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},pp$1.regexp_eatBracedQuantifier=function(e,t){var o=e.pos;if(e.eat(123)){var u=0,p=-1;if(this.regexp_eatDecimalDigits(e)&&(u=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(p=e.lastIntValue),e.eat(125)))return p!==-1&&p<u&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=o}return!1},pp$1.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},pp$1.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},pp$1.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var o=this.regexp_eatModifiers(e),u=e.eat(45);if(o||u){for(var p=0;p<o.length;p++){var f=o.charAt(p);o.indexOf(f,p+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(u){var b=this.regexp_eatModifiers(e);!o&&!b&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var M=0;M<b.length;M++){var F=b.charAt(M);(b.indexOf(F,M+1)>-1||o.indexOf(F)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1},pp$1.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},pp$1.regexp_eatModifiers=function(e){for(var t="",o=0;(o=e.current())!==-1&&isRegularExpressionModifier(o);)t+=codePointToString(o),e.advance();return t};function isRegularExpressionModifier(e){return e===105||e===109||e===115}pp$1.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},pp$1.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},pp$1.regexp_eatSyntaxCharacter=function(e){var t=e.current();return isSyntaxCharacter(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isSyntaxCharacter(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}pp$1.regexp_eatPatternCharacters=function(e){for(var t=e.pos,o=0;(o=e.current())!==-1&&!isSyntaxCharacter(o);)e.advance();return e.pos!==t},pp$1.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1},pp$1.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,o=e.groupNames[e.lastStringValue];if(o)if(t)for(var u=0,p=o;u<p.length;u+=1){var f=p[u];f.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(o||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}},pp$1.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},pp$1.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=codePointToString(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=codePointToString(e.lastIntValue);return!0}return!1},pp$1.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,u=e.current(o);return e.advance(o),u===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(u=e.lastIntValue),isRegExpIdentifierStart(u)?(e.lastIntValue=u,!0):(e.pos=t,!1)};function isRegExpIdentifierStart(e){return isIdentifierStart(e,!0)||e===36||e===95}pp$1.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,u=e.current(o);return e.advance(o),u===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(u=e.lastIntValue),isRegExpIdentifierPart(u)?(e.lastIntValue=u,!0):(e.pos=t,!1)};function isRegExpIdentifierPart(e){return isIdentifierChar(e,!0)||e===36||e===95||e===8204||e===8205}pp$1.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},pp$1.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var o=e.lastIntValue;if(e.switchU)return o>e.maxBackReference&&(e.maxBackReference=o),!0;if(o<=e.numCapturingParens)return!0;e.pos=t}return!1},pp$1.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},pp$1.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},pp$1.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},pp$1.regexp_eatZero=function(e){return e.current()===48&&!isDecimalDigit(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1},pp$1.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1},pp$1.regexp_eatControlLetter=function(e){var t=e.current();return isControlLetter(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function isControlLetter(e){return e>=65&&e<=90||e>=97&&e<=122}pp$1.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var o=e.pos,u=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var p=e.lastIntValue;if(u&&p>=55296&&p<=56319){var f=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var b=e.lastIntValue;if(b>=56320&&b<=57343)return e.lastIntValue=(p-55296)*1024+(b-56320)+65536,!0}e.pos=f,e.lastIntValue=p}return!0}if(u&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&isValidUnicode(e.lastIntValue))return!0;u&&e.raise("Invalid unicode escape"),e.pos=o}return!1};function isValidUnicode(e){return e>=0&&e<=1114111}pp$1.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1},pp$1.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var CharSetNone=0,CharSetOk=1,CharSetString=2;pp$1.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(isCharacterClassEscape(t))return e.lastIntValue=-1,e.advance(),CharSetOk;var o=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((o=t===80)||t===112)){e.lastIntValue=-1,e.advance();var u;if(e.eat(123)&&(u=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return o&&u===CharSetString&&e.raise("Invalid property name"),u;e.raise("Invalid property name")}return CharSetNone};function isCharacterClassEscape(e){return e===100||e===68||e===115||e===83||e===119||e===87}pp$1.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var o=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var u=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,o,u),CharSetOk}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var p=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,p)}return CharSetNone},pp$1.regexp_validateUnicodePropertyNameAndValue=function(e,t,o){hasOwn(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(o)||e.raise("Invalid property value")},pp$1.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return CharSetOk;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return CharSetString;e.raise("Invalid property name")},pp$1.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyNameCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyNameCharacter(e){return isControlLetter(e)||e===95}pp$1.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyValueCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyValueCharacter(e){return isUnicodePropertyNameCharacter(e)||isDecimalDigit(e)}pp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},pp$1.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),o=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&o===CharSetString&&e.raise("Negated character class may contain strings"),!0}return!1},pp$1.regexp_classContents=function(e){return e.current()===93?CharSetOk:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),CharSetOk)},pp$1.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var o=e.lastIntValue;e.switchU&&(t===-1||o===-1)&&e.raise("Invalid character class"),t!==-1&&o!==-1&&t>o&&e.raise("Range out of order in character class")}}},pp$1.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var o=e.current();(o===99||isOctalDigit(o))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var u=e.current();return u!==93?(e.lastIntValue=u,e.advance(),!0):!1},pp$1.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},pp$1.regexp_classSetExpression=function(e){var t=CharSetOk,o;if(!this.regexp_eatClassSetRange(e))if(o=this.regexp_eatClassSetOperand(e)){o===CharSetString&&(t=CharSetString);for(var u=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(o=this.regexp_eatClassSetOperand(e))){o!==CharSetString&&(t=CharSetOk);continue}e.raise("Invalid character in character class")}if(u!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(u!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(o=this.regexp_eatClassSetOperand(e),!o)return t;o===CharSetString&&(t=CharSetString)}},pp$1.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var o=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var u=e.lastIntValue;return o!==-1&&u!==-1&&o>u&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1},pp$1.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?CharSetOk:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)},pp$1.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var o=e.eat(94),u=this.regexp_classContents(e);if(e.eat(93))return o&&u===CharSetString&&e.raise("Negated character class may contain strings"),u;e.pos=t}if(e.eat(92)){var p=this.regexp_eatCharacterClassEscape(e);if(p)return p;e.pos=t}return null},pp$1.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var o=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return o}else e.raise("Invalid escape");e.pos=t}return null},pp$1.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===CharSetString&&(t=CharSetString);return t},pp$1.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?CharSetOk:CharSetString},pp$1.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var o=e.current();return o<0||o===e.lookahead()&&isClassSetReservedDoublePunctuatorCharacter(o)||isClassSetSyntaxCharacter(o)?!1:(e.advance(),e.lastIntValue=o,!0)};function isClassSetReservedDoublePunctuatorCharacter(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function isClassSetSyntaxCharacter(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}pp$1.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return isClassSetReservedPunctuator(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isClassSetReservedPunctuator(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}pp$1.regexp_eatClassControlLetter=function(e){var t=e.current();return isDecimalDigit(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1},pp$1.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},pp$1.regexp_eatDecimalDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isDecimalDigit(o=e.current());)e.lastIntValue=10*e.lastIntValue+(o-48),e.advance();return e.pos!==t};function isDecimalDigit(e){return e>=48&&e<=57}pp$1.regexp_eatHexDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isHexDigit(o=e.current());)e.lastIntValue=16*e.lastIntValue+hexToInt(o),e.advance();return e.pos!==t};function isHexDigit(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function hexToInt(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}pp$1.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var o=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+o*8+e.lastIntValue:e.lastIntValue=t*8+o}else e.lastIntValue=t;return!0}return!1},pp$1.regexp_eatOctalDigit=function(e){var t=e.current();return isOctalDigit(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function isOctalDigit(e){return e>=48&&e<=55}pp$1.regexp_eatFixedHexDigits=function(e,t){var o=e.pos;e.lastIntValue=0;for(var u=0;u<t;++u){var p=e.current();if(!isHexDigit(p))return e.pos=o,!1;e.lastIntValue=16*e.lastIntValue+hexToInt(p),e.advance()}return!0};var Token=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new SourceLocation(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},pp=Parser.prototype;pp.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Token(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},pp.getToken=function(){return this.next(),new Token(this)},typeof Symbol<"u"&&(pp[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===types$1.eof,value:t}}}}),pp.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(types$1.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())},pp.readToken=function(e){return isIdentifierStart(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)},pp.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888},pp.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,o=this.input.indexOf("*/",this.pos+=2);if(o===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=o+2,this.options.locations)for(var u=void 0,p=t;(u=nextLineBreak(this.input,p,this.pos))>-1;)++this.curLine,p=this.lineStart=u;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,o),t,this.pos,e,this.curPosition())},pp.skipLineComment=function(e){for(var t=this.pos,o=this.options.onComment&&this.curPosition(),u=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!isNewLine(u);)u=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,o,this.curPosition())},pp.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&nonASCIIwhitespace.test(String.fromCharCode(e)))++this.pos;else break e}}},pp.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var o=this.type;this.type=e,this.value=t,this.updateContext(o)},pp.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(types$1.ellipsis)):(++this.pos,this.finishToken(types$1.dot))},pp.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.slash,1)},pp.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),o=1,u=e===42?types$1.star:types$1.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++o,u=types$1.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(types$1.assign,o+1):this.finishOp(u,o)},pp.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var o=this.input.charCodeAt(this.pos+2);if(o===61)return this.finishOp(types$1.assign,3)}return this.finishOp(e===124?types$1.logicalOR:types$1.logicalAND,2)}return t===61?this.finishOp(types$1.assign,2):this.finishOp(e===124?types$1.bitwiseOR:types$1.bitwiseAND,1)},pp.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.bitwiseXOR,1)},pp.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(types$1.incDec,2):t===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.plusMin,1)},pp.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),o=1;return t===e?(o=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+o)===61?this.finishOp(types$1.assign,o+1):this.finishOp(types$1.bitShift,o)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(o=2),this.finishOp(types$1.relational,o))},pp.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(types$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(types$1.arrow)):this.finishOp(e===61?types$1.eq:types$1.prefix,1)},pp.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var o=this.input.charCodeAt(this.pos+2);if(o<48||o>57)return this.finishOp(types$1.questionDot,2)}if(t===63){if(e>=12){var u=this.input.charCodeAt(this.pos+2);if(u===61)return this.finishOp(types$1.assign,3)}return this.finishOp(types$1.coalesce,2)}}return this.finishOp(types$1.question,1)},pp.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),isIdentifierStart(t,!0)||t===92))return this.finishToken(types$1.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+codePointToString(t)+"'")},pp.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(types$1.parenL);case 41:return++this.pos,this.finishToken(types$1.parenR);case 59:return++this.pos,this.finishToken(types$1.semi);case 44:return++this.pos,this.finishToken(types$1.comma);case 91:return++this.pos,this.finishToken(types$1.bracketL);case 93:return++this.pos,this.finishToken(types$1.bracketR);case 123:return++this.pos,this.finishToken(types$1.braceL);case 125:return++this.pos,this.finishToken(types$1.braceR);case 58:return++this.pos,this.finishToken(types$1.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(types$1.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(types$1.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+codePointToString(e)+"'")},pp.finishOp=function(e,t){var o=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,o)},pp.readRegexp=function(){for(var e,t,o=this.pos;;){this.pos>=this.input.length&&this.raise(o,"Unterminated regular expression");var u=this.input.charAt(this.pos);if(lineBreak.test(u)&&this.raise(o,"Unterminated regular expression"),e)e=!1;else{if(u==="[")t=!0;else if(u==="]"&&t)t=!1;else if(u==="/"&&!t)break;e=u==="\\"}++this.pos}var p=this.input.slice(o,this.pos);++this.pos;var f=this.pos,b=this.readWord1();this.containsEsc&&this.unexpected(f);var M=this.regexpState||(this.regexpState=new RegExpValidationState(this));M.reset(o,p,b),this.validateRegExpFlags(M),this.validateRegExpPattern(M);var F=null;try{F=new RegExp(p,b)}catch{}return this.finishToken(types$1.regexp,{pattern:p,flags:b,value:F})},pp.readInt=function(e,t,o){for(var u=this.options.ecmaVersion>=12&&t===void 0,p=o&&this.input.charCodeAt(this.pos)===48,f=this.pos,b=0,M=0,F=0,S=t??1/0;F<S;++F,++this.pos){var k=this.input.charCodeAt(this.pos),N=void 0;if(u&&k===95){p&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),M===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),F===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),M=k;continue}if(k>=97?N=k-97+10:k>=65?N=k-65+10:k>=48&&k<=57?N=k-48:N=1/0,N>=e)break;M=k,b=b*e+N}return u&&M===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===f||t!=null&&this.pos-f!==t?null:b};function stringToNumber(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function stringToBigInt(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}pp.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var o=this.readInt(e);return o==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(o=stringToBigInt(this.input.slice(t,this.pos)),++this.pos):isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,o)},pp.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var o=this.pos-t>=2&&this.input.charCodeAt(t)===48;o&&this.strict&&this.raise(t,"Invalid number");var u=this.input.charCodeAt(this.pos);if(!o&&!e&&this.options.ecmaVersion>=11&&u===110){var p=stringToBigInt(this.input.slice(t,this.pos));return++this.pos,isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,p)}o&&/[89]/.test(this.input.slice(t,this.pos))&&(o=!1),u===46&&!o&&(++this.pos,this.readInt(10),u=this.input.charCodeAt(this.pos)),(u===69||u===101)&&!o&&(u=this.input.charCodeAt(++this.pos),(u===43||u===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var f=stringToNumber(this.input.slice(t,this.pos),o);return this.finishToken(types$1.num,f)},pp.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var o=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(o,"Code point out of bounds")}else t=this.readHexChar(4);return t},pp.readString=function(e){for(var t="",o=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var u=this.input.charCodeAt(this.pos);if(u===e)break;u===92?(t+=this.input.slice(o,this.pos),t+=this.readEscapedChar(!1),o=this.pos):u===8232||u===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(isNewLine(u)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(o,this.pos++),this.finishToken(types$1.string,t)};var INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===INVALID_TEMPLATE_ESCAPE_ERROR)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1},pp.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw INVALID_TEMPLATE_ESCAPE_ERROR;this.raise(e,t)},pp.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var o=this.input.charCodeAt(this.pos);if(o===96||o===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===types$1.template||this.type===types$1.invalidTemplate)?o===36?(this.pos+=2,this.finishToken(types$1.dollarBraceL)):(++this.pos,this.finishToken(types$1.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(types$1.template,e));if(o===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(isNewLine(o)){switch(e+=this.input.slice(t,this.pos),++this.pos,o){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(o);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},pp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(types$1.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},pp.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return codePointToString(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var o=this.pos-1;this.invalidStringToken(o,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var u=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],p=parseInt(u,8);return p>255&&(u=u.slice(0,-1),p=parseInt(u,8)),this.pos+=u.length-1,t=this.input.charCodeAt(this.pos),(u!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-u.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(p)}return isNewLine(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}},pp.readHexChar=function(e){var t=this.pos,o=this.readInt(16,e);return o===null&&this.invalidStringToken(t,"Bad character escape sequence"),o},pp.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,o=this.pos,u=this.options.ecmaVersion>=6;this.pos<this.input.length;){var p=this.fullCharCodeAtPos();if(isIdentifierChar(p,u))this.pos+=p<=65535?1:2;else if(p===92){this.containsEsc=!0,e+=this.input.slice(o,this.pos);var f=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var b=this.readCodePoint();(t?isIdentifierStart:isIdentifierChar)(b,u)||this.invalidStringToken(f,"Invalid Unicode escape"),e+=codePointToString(b),o=this.pos}else break;t=!1}return e+this.input.slice(o,this.pos)},pp.readWord=function(){var e=this.readWord1(),t=types$1.name;return this.keywords.test(e)&&(t=keywords[e]),this.finishToken(t,e)};var version$1="8.15.0";Parser.acorn={Parser,version:version$1,defaultOptions,Position,SourceLocation,getLineInfo,Node,TokenType,tokTypes:types$1,keywordTypes:keywords,TokContext,tokContexts:types,isIdentifierChar,isIdentifierStart,Token,isNewLine,lineBreak,lineBreakG,nonASCIIwhitespace};function parse$a(e,t){return Parser.parse(e,t)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var o=function u(){var p=!1;try{p=this instanceof u}catch{}return p?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var p=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(o,u,p.get?p:{enumerable:!0,get:function(){return e[u]}})}),o}var escodegen$1={},estraverse={},hasRequiredEstraverse;function requireEstraverse(){return hasRequiredEstraverse||(hasRequiredEstraverse=1,(function(e){(function t(o){var u,p,f,b,M,F;function S(ee){var pe={},_e,ve;for(_e in ee)ee.hasOwnProperty(_e)&&(ve=ee[_e],typeof ve=="object"&&ve!==null?pe[_e]=S(ve):pe[_e]=ve);return pe}function k(ee,pe){var _e,ve,we,xe;for(ve=ee.length,we=0;ve;)_e=ve>>>1,xe=we+_e,pe(ee[xe])?ve=_e:(we=xe+1,ve-=_e+1);return we}u={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},f={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},b={},M={},F={},p={Break:b,Skip:M,Remove:F};function N(ee,pe){this.parent=ee,this.key=pe}N.prototype.replace=function(pe){this.parent[this.key]=pe},N.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function $(ee,pe,_e,ve){this.node=ee,this.path=pe,this.wrap=_e,this.ref=ve}function R(){}R.prototype.path=function(){var pe,_e,ve,we,xe,Oe;function Pe(Le,Xe){if(Array.isArray(Xe))for(ve=0,we=Xe.length;ve<we;++ve)Le.push(Xe[ve]);else Le.push(Xe)}if(!this.__current.path)return null;for(xe=[],pe=2,_e=this.__leavelist.length;pe<_e;++pe)Oe=this.__leavelist[pe],Pe(xe,Oe.path);return Pe(xe,this.__current.path),xe},R.prototype.type=function(){var ee=this.current();return ee.type||this.__current.wrap},R.prototype.parents=function(){var pe,_e,ve;for(ve=[],pe=1,_e=this.__leavelist.length;pe<_e;++pe)ve.push(this.__leavelist[pe].node);return ve},R.prototype.current=function(){return this.__current.node},R.prototype.__execute=function(pe,_e){var ve,we;return we=void 0,ve=this.__current,this.__current=_e,this.__state=null,pe&&(we=pe.call(this,_e.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=ve,we},R.prototype.notify=function(pe){this.__state=pe},R.prototype.skip=function(){this.notify(M)},R.prototype.break=function(){this.notify(b)},R.prototype.remove=function(){this.notify(F)},R.prototype.__initialize=function(ee,pe){this.visitor=pe,this.root=ee,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,pe.fallback==="iteration"?this.__fallback=Object.keys:typeof pe.fallback=="function"&&(this.__fallback=pe.fallback),this.__keys=f,pe.keys&&(this.__keys=Object.assign(Object.create(this.__keys),pe.keys))};function U(ee){return ee==null?!1:typeof ee=="object"&&typeof ee.type=="string"}function V(ee,pe){return(ee===u.ObjectExpression||ee===u.ObjectPattern)&&pe==="properties"}function z(ee,pe){for(var _e=ee.length-1;_e>=0;--_e)if(ee[_e].node===pe)return!0;return!1}R.prototype.traverse=function(pe,_e){var ve,we,xe,Oe,Pe,Le,Xe,Ke,me,ye,Se,qe;for(this.__initialize(pe,_e),qe={},ve=this.__worklist,we=this.__leavelist,ve.push(new $(pe,null,null,null)),we.push(new $(null,null,null,null));ve.length;){if(xe=ve.pop(),xe===qe){if(xe=we.pop(),Le=this.__execute(_e.leave,xe),this.__state===b||Le===b)return;continue}if(xe.node){if(Le=this.__execute(_e.enter,xe),this.__state===b||Le===b)return;if(ve.push(qe),we.push(xe),this.__state===M||Le===M)continue;if(Oe=xe.node,Pe=Oe.type||xe.wrap,ye=this.__keys[Pe],!ye)if(this.__fallback)ye=this.__fallback(Oe);else throw new Error("Unknown node type "+Pe+".");for(Ke=ye.length;(Ke-=1)>=0;)if(Xe=ye[Ke],Se=Oe[Xe],!!Se){if(Array.isArray(Se)){for(me=Se.length;(me-=1)>=0;)if(Se[me]&&!z(we,Se[me])){if(V(Pe,ye[Ke]))xe=new $(Se[me],[Xe,me],"Property",null);else if(U(Se[me]))xe=new $(Se[me],[Xe,me],null,null);else continue;ve.push(xe)}}else if(U(Se)){if(z(we,Se))continue;ve.push(new $(Se,Xe,null,null))}}}}},R.prototype.replace=function(pe,_e){var ve,we,xe,Oe,Pe,Le,Xe,Ke,me,ye,Se,qe,st;function mt(Ee){var rt,St,pt,bt;if(Ee.ref.remove()){for(St=Ee.ref.key,bt=Ee.ref.parent,rt=ve.length;rt--;)if(pt=ve[rt],pt.ref&&pt.ref.parent===bt){if(pt.ref.key<St)break;--pt.ref.key}}}for(this.__initialize(pe,_e),Se={},ve=this.__worklist,we=this.__leavelist,qe={root:pe},Le=new $(pe,null,null,new N(qe,"root")),ve.push(Le),we.push(Le);ve.length;){if(Le=ve.pop(),Le===Se){if(Le=we.pop(),Pe=this.__execute(_e.leave,Le),Pe!==void 0&&Pe!==b&&Pe!==M&&Pe!==F&&Le.ref.replace(Pe),(this.__state===F||Pe===F)&&mt(Le),this.__state===b||Pe===b)return qe.root;continue}if(Pe=this.__execute(_e.enter,Le),Pe!==void 0&&Pe!==b&&Pe!==M&&Pe!==F&&(Le.ref.replace(Pe),Le.node=Pe),(this.__state===F||Pe===F)&&(mt(Le),Le.node=null),this.__state===b||Pe===b)return qe.root;if(xe=Le.node,!!xe&&(ve.push(Se),we.push(Le),!(this.__state===M||Pe===M))){if(Oe=xe.type||Le.wrap,me=this.__keys[Oe],!me)if(this.__fallback)me=this.__fallback(xe);else throw new Error("Unknown node type "+Oe+".");for(Xe=me.length;(Xe-=1)>=0;)if(st=me[Xe],ye=xe[st],!!ye)if(Array.isArray(ye)){for(Ke=ye.length;(Ke-=1)>=0;)if(ye[Ke]){if(V(Oe,me[Xe]))Le=new $(ye[Ke],[st,Ke],"Property",new N(ye,Ke));else if(U(ye[Ke]))Le=new $(ye[Ke],[st,Ke],null,new N(ye,Ke));else continue;ve.push(Le)}}else U(ye)&&ve.push(new $(ye,st,null,new N(xe,st)))}}return qe.root};function K(ee,pe){var _e=new R;return _e.traverse(ee,pe)}function ie(ee,pe){var _e=new R;return _e.replace(ee,pe)}function he(ee,pe){var _e;return _e=k(pe,function(we){return we.range[0]>ee.range[0]}),ee.extendedRange=[ee.range[0],ee.range[1]],_e!==pe.length&&(ee.extendedRange[1]=pe[_e].range[0]),_e-=1,_e>=0&&(ee.extendedRange[0]=pe[_e].range[1]),ee}function se(ee,pe,_e){var ve=[],we,xe,Oe,Pe;if(!ee.range)throw new Error("attachComments needs range information");if(!_e.length){if(pe.length){for(Oe=0,xe=pe.length;Oe<xe;Oe+=1)we=S(pe[Oe]),we.extendedRange=[0,ee.range[0]],ve.push(we);ee.leadingComments=ve}return ee}for(Oe=0,xe=pe.length;Oe<xe;Oe+=1)ve.push(he(S(pe[Oe]),_e));return Pe=0,K(ee,{enter:function(Le){for(var Xe;Pe<ve.length&&(Xe=ve[Pe],!(Xe.extendedRange[1]>Le.range[0]));)Xe.extendedRange[1]===Le.range[0]?(Le.leadingComments||(Le.leadingComments=[]),Le.leadingComments.push(Xe),ve.splice(Pe,1)):Pe+=1;if(Pe===ve.length)return p.Break;if(ve[Pe].extendedRange[0]>Le.range[1])return p.Skip}}),Pe=0,K(ee,{leave:function(Le){for(var Xe;Pe<ve.length&&(Xe=ve[Pe],!(Le.range[1]<Xe.extendedRange[0]));)Le.range[1]===Xe.extendedRange[0]?(Le.trailingComments||(Le.trailingComments=[]),Le.trailingComments.push(Xe),ve.splice(Pe,1)):Pe+=1;if(Pe===ve.length)return p.Break;if(ve[Pe].extendedRange[0]>Le.range[1])return p.Skip}}),ee}return o.Syntax=u,o.traverse=K,o.replace=ie,o.attachComments=se,o.VisitorKeys=f,o.VisitorOption=p,o.Controller=R,o.cloneEnvironment=function(){return t({})},o})(e)})(estraverse)),estraverse}var utils={},ast={exports:{}},hasRequiredAst;function requireAst(){return hasRequiredAst||(hasRequiredAst=1,(function(){function e(b){if(b==null)return!1;switch(b.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(b){if(b==null)return!1;switch(b.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function o(b){if(b==null)return!1;switch(b.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function u(b){return o(b)||b!=null&&b.type==="FunctionDeclaration"}function p(b){switch(b.type){case"IfStatement":return b.alternate!=null?b.alternate:b.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return b.body}return null}function f(b){var M;if(b.type!=="IfStatement"||b.alternate==null)return!1;M=b.consequent;do{if(M.type==="IfStatement"&&M.alternate==null)return!0;M=p(M)}while(M);return!1}ast.exports={isExpression:e,isStatement:o,isIterationStatement:t,isSourceElement:u,isProblematicIfStatement:f,trailingStatement:p}})()),ast.exports}var code={exports:{}},hasRequiredCode;function requireCode(){return hasRequiredCode||(hasRequiredCode=1,(function(){var e,t,o,u,p,f;t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function b(z){return 48<=z&&z<=57}function M(z){return 48<=z&&z<=57||97<=z&&z<=102||65<=z&&z<=70}function F(z){return z>=48&&z<=55}o=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function S(z){return z===32||z===9||z===11||z===12||z===160||z>=5760&&o.indexOf(z)>=0}function k(z){return z===10||z===13||z===8232||z===8233}function N(z){if(z<=65535)return String.fromCharCode(z);var K=String.fromCharCode(Math.floor((z-65536)/1024)+55296),ie=String.fromCharCode((z-65536)%1024+56320);return K+ie}for(u=new Array(128),f=0;f<128;++f)u[f]=f>=97&&f<=122||f>=65&&f<=90||f===36||f===95;for(p=new Array(128),f=0;f<128;++f)p[f]=f>=97&&f<=122||f>=65&&f<=90||f>=48&&f<=57||f===36||f===95;function $(z){return z<128?u[z]:t.NonAsciiIdentifierStart.test(N(z))}function R(z){return z<128?p[z]:t.NonAsciiIdentifierPart.test(N(z))}function U(z){return z<128?u[z]:e.NonAsciiIdentifierStart.test(N(z))}function V(z){return z<128?p[z]:e.NonAsciiIdentifierPart.test(N(z))}code.exports={isDecimalDigit:b,isHexDigit:M,isOctalDigit:F,isWhiteSpace:S,isLineTerminator:k,isIdentifierStartES5:$,isIdentifierPartES5:R,isIdentifierStartES6:U,isIdentifierPartES6:V}})()),code.exports}var keyword={exports:{}},hasRequiredKeyword;function requireKeyword(){return hasRequiredKeyword||(hasRequiredKeyword=1,(function(){var e=requireCode();function t($){switch($){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function o($,R){return!R&&$==="yield"?!1:u($,R)}function u($,R){if(R&&t($))return!0;switch($.length){case 2:return $==="if"||$==="in"||$==="do";case 3:return $==="var"||$==="for"||$==="new"||$==="try";case 4:return $==="this"||$==="else"||$==="case"||$==="void"||$==="with"||$==="enum";case 5:return $==="while"||$==="break"||$==="catch"||$==="throw"||$==="const"||$==="yield"||$==="class"||$==="super";case 6:return $==="return"||$==="typeof"||$==="delete"||$==="switch"||$==="export"||$==="import";case 7:return $==="default"||$==="finally"||$==="extends";case 8:return $==="function"||$==="continue"||$==="debugger";case 10:return $==="instanceof";default:return!1}}function p($,R){return $==="null"||$==="true"||$==="false"||o($,R)}function f($,R){return $==="null"||$==="true"||$==="false"||u($,R)}function b($){return $==="eval"||$==="arguments"}function M($){var R,U,V;if($.length===0||(V=$.charCodeAt(0),!e.isIdentifierStartES5(V)))return!1;for(R=1,U=$.length;R<U;++R)if(V=$.charCodeAt(R),!e.isIdentifierPartES5(V))return!1;return!0}function F($,R){return($-55296)*1024+(R-56320)+65536}function S($){var R,U,V,z,K;if($.length===0)return!1;for(K=e.isIdentifierStartES6,R=0,U=$.length;R<U;++R){if(V=$.charCodeAt(R),55296<=V&&V<=56319){if(++R,R>=U||(z=$.charCodeAt(R),!(56320<=z&&z<=57343)))return!1;V=F(V,z)}if(!K(V))return!1;K=e.isIdentifierPartES6}return!0}function k($,R){return M($)&&!p($,R)}function N($,R){return S($)&&!f($,R)}keyword.exports={isKeywordES5:o,isKeywordES6:u,isReservedWordES5:p,isReservedWordES6:f,isRestrictedWord:b,isIdentifierNameES5:M,isIdentifierNameES6:S,isIdentifierES5:k,isIdentifierES6:N}})()),keyword.exports}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(){utils.ast=requireAst(),utils.code=requireCode(),utils.keyword=requireKeyword()})()),utils}var sourceMap={},sourceMapGenerator={},base64Vlq={},base64={},hasRequiredBase64;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},base64.decode=function(t){var o=65,u=90,p=97,f=122,b=48,M=57,F=43,S=47,k=26,N=52;return o<=t&&t<=u?t-o:p<=t&&t<=f?t-p+k:b<=t&&t<=M?t-b+N:t==F?62:t==S?63:-1},base64}var hasRequiredBase64Vlq;function requireBase64Vlq(){if(hasRequiredBase64Vlq)return base64Vlq;hasRequiredBase64Vlq=1;var e=requireBase64(),t=5,o=1<<t,u=o-1,p=o;function f(M){return M<0?(-M<<1)+1:(M<<1)+0}function b(M){var F=(M&1)===1,S=M>>1;return F?-S:S}return base64Vlq.encode=function(F){var S="",k,N=f(F);do k=N&u,N>>>=t,N>0&&(k|=p),S+=e.encode(k);while(N>0);return S},base64Vlq.decode=function(F,S,k){var N=F.length,$=0,R=0,U,V;do{if(S>=N)throw new Error("Expected more digits in base 64 VLQ value.");if(V=e.decode(F.charCodeAt(S++)),V===-1)throw new Error("Invalid base64 digit: "+F.charAt(S-1));U=!!(V&p),V&=u,$=$+(V<<R),R+=t}while(U);k.value=b($),k.rest=S},base64Vlq}var util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(e){function t(se,ee,pe){if(ee in se)return se[ee];if(arguments.length===3)return pe;throw new Error('"'+ee+'" is a required argument.')}e.getArg=t;var o=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,u=/^data:.+\,.+$/;function p(se){var ee=se.match(o);return ee?{scheme:ee[1],auth:ee[2],host:ee[3],port:ee[4],path:ee[5]}:null}e.urlParse=p;function f(se){var ee="";return se.scheme&&(ee+=se.scheme+":"),ee+="//",se.auth&&(ee+=se.auth+"@"),se.host&&(ee+=se.host),se.port&&(ee+=":"+se.port),se.path&&(ee+=se.path),ee}e.urlGenerate=f;function b(se){var ee=se,pe=p(se);if(pe){if(!pe.path)return se;ee=pe.path}for(var _e=e.isAbsolute(ee),ve=ee.split(/\/+/),we,xe=0,Oe=ve.length-1;Oe>=0;Oe--)we=ve[Oe],we==="."?ve.splice(Oe,1):we===".."?xe++:xe>0&&(we===""?(ve.splice(Oe+1,xe),xe=0):(ve.splice(Oe,2),xe--));return ee=ve.join("/"),ee===""&&(ee=_e?"/":"."),pe?(pe.path=ee,f(pe)):ee}e.normalize=b;function M(se,ee){se===""&&(se="."),ee===""&&(ee=".");var pe=p(ee),_e=p(se);if(_e&&(se=_e.path||"/"),pe&&!pe.scheme)return _e&&(pe.scheme=_e.scheme),f(pe);if(pe||ee.match(u))return ee;if(_e&&!_e.host&&!_e.path)return _e.host=ee,f(_e);var ve=ee.charAt(0)==="/"?ee:b(se.replace(/\/+$/,"")+"/"+ee);return _e?(_e.path=ve,f(_e)):ve}e.join=M,e.isAbsolute=function(se){return se.charAt(0)==="/"||o.test(se)};function F(se,ee){se===""&&(se="."),se=se.replace(/\/$/,"");for(var pe=0;ee.indexOf(se+"/")!==0;){var _e=se.lastIndexOf("/");if(_e<0||(se=se.slice(0,_e),se.match(/^([^\/]+:\/)?\/*$/)))return ee;++pe}return Array(pe+1).join("../")+ee.substr(se.length+1)}e.relative=F;var S=(function(){var se=Object.create(null);return!("__proto__"in se)})();function k(se){return se}function N(se){return R(se)?"$"+se:se}e.toSetString=S?k:N;function $(se){return R(se)?se.slice(1):se}e.fromSetString=S?k:$;function R(se){if(!se)return!1;var ee=se.length;if(ee<9||se.charCodeAt(ee-1)!==95||se.charCodeAt(ee-2)!==95||se.charCodeAt(ee-3)!==111||se.charCodeAt(ee-4)!==116||se.charCodeAt(ee-5)!==111||se.charCodeAt(ee-6)!==114||se.charCodeAt(ee-7)!==112||se.charCodeAt(ee-8)!==95||se.charCodeAt(ee-9)!==95)return!1;for(var pe=ee-10;pe>=0;pe--)if(se.charCodeAt(pe)!==36)return!1;return!0}function U(se,ee,pe){var _e=z(se.source,ee.source);return _e!==0||(_e=se.originalLine-ee.originalLine,_e!==0)||(_e=se.originalColumn-ee.originalColumn,_e!==0||pe)||(_e=se.generatedColumn-ee.generatedColumn,_e!==0)||(_e=se.generatedLine-ee.generatedLine,_e!==0)?_e:z(se.name,ee.name)}e.compareByOriginalPositions=U;function V(se,ee,pe){var _e=se.generatedLine-ee.generatedLine;return _e!==0||(_e=se.generatedColumn-ee.generatedColumn,_e!==0||pe)||(_e=z(se.source,ee.source),_e!==0)||(_e=se.originalLine-ee.originalLine,_e!==0)||(_e=se.originalColumn-ee.originalColumn,_e!==0)?_e:z(se.name,ee.name)}e.compareByGeneratedPositionsDeflated=V;function z(se,ee){return se===ee?0:se===null?1:ee===null?-1:se>ee?1:-1}function K(se,ee){var pe=se.generatedLine-ee.generatedLine;return pe!==0||(pe=se.generatedColumn-ee.generatedColumn,pe!==0)||(pe=z(se.source,ee.source),pe!==0)||(pe=se.originalLine-ee.originalLine,pe!==0)||(pe=se.originalColumn-ee.originalColumn,pe!==0)?pe:z(se.name,ee.name)}e.compareByGeneratedPositionsInflated=K;function ie(se){return JSON.parse(se.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=ie;function he(se,ee,pe){if(ee=ee||"",se&&(se[se.length-1]!=="/"&&ee[0]!=="/"&&(se+="/"),ee=se+ee),pe){var _e=p(pe);if(!_e)throw new Error("sourceMapURL could not be parsed");if(_e.path){var ve=_e.path.lastIndexOf("/");ve>=0&&(_e.path=_e.path.substring(0,ve+1))}ee=M(f(_e),ee)}return b(ee)}e.computeSourceURL=he})(util)),util}var arraySet={},hasRequiredArraySet;function requireArraySet(){if(hasRequiredArraySet)return arraySet;hasRequiredArraySet=1;var e=requireUtil(),t=Object.prototype.hasOwnProperty,o=typeof Map<"u";function u(){this._array=[],this._set=o?new Map:Object.create(null)}return u.fromArray=function(f,b){for(var M=new u,F=0,S=f.length;F<S;F++)M.add(f[F],b);return M},u.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},u.prototype.add=function(f,b){var M=o?f:e.toSetString(f),F=o?this.has(f):t.call(this._set,M),S=this._array.length;(!F||b)&&this._array.push(f),F||(o?this._set.set(f,S):this._set[M]=S)},u.prototype.has=function(f){if(o)return this._set.has(f);var b=e.toSetString(f);return t.call(this._set,b)},u.prototype.indexOf=function(f){if(o){var b=this._set.get(f);if(b>=0)return b}else{var M=e.toSetString(f);if(t.call(this._set,M))return this._set[M]}throw new Error('"'+f+'" is not in the set.')},u.prototype.at=function(f){if(f>=0&&f<this._array.length)return this._array[f];throw new Error("No element indexed by "+f)},u.prototype.toArray=function(){return this._array.slice()},arraySet.ArraySet=u,arraySet}var mappingList={},hasRequiredMappingList;function requireMappingList(){if(hasRequiredMappingList)return mappingList;hasRequiredMappingList=1;var e=requireUtil();function t(u,p){var f=u.generatedLine,b=p.generatedLine,M=u.generatedColumn,F=p.generatedColumn;return b>f||b==f&&F>=M||e.compareByGeneratedPositionsInflated(u,p)<=0}function o(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return o.prototype.unsortedForEach=function(p,f){this._array.forEach(p,f)},o.prototype.add=function(p){t(this._last,p)?(this._last=p,this._array.push(p)):(this._sorted=!1,this._array.push(p))},o.prototype.toArray=function(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},mappingList.MappingList=o,mappingList}var hasRequiredSourceMapGenerator;function requireSourceMapGenerator(){if(hasRequiredSourceMapGenerator)return sourceMapGenerator;hasRequiredSourceMapGenerator=1;var e=requireBase64Vlq(),t=requireUtil(),o=requireArraySet().ArraySet,u=requireMappingList().MappingList;function p(f){f||(f={}),this._file=t.getArg(f,"file",null),this._sourceRoot=t.getArg(f,"sourceRoot",null),this._skipValidation=t.getArg(f,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new u,this._sourcesContents=null}return p.prototype._version=3,p.fromSourceMap=function(b){var M=b.sourceRoot,F=new p({file:b.file,sourceRoot:M});return b.eachMapping(function(S){var k={generated:{line:S.generatedLine,column:S.generatedColumn}};S.source!=null&&(k.source=S.source,M!=null&&(k.source=t.relative(M,k.source)),k.original={line:S.originalLine,column:S.originalColumn},S.name!=null&&(k.name=S.name)),F.addMapping(k)}),b.sources.forEach(function(S){var k=S;M!==null&&(k=t.relative(M,S)),F._sources.has(k)||F._sources.add(k);var N=b.sourceContentFor(S);N!=null&&F.setSourceContent(S,N)}),F},p.prototype.addMapping=function(b){var M=t.getArg(b,"generated"),F=t.getArg(b,"original",null),S=t.getArg(b,"source",null),k=t.getArg(b,"name",null);this._skipValidation||this._validateMapping(M,F,S,k),S!=null&&(S=String(S),this._sources.has(S)||this._sources.add(S)),k!=null&&(k=String(k),this._names.has(k)||this._names.add(k)),this._mappings.add({generatedLine:M.line,generatedColumn:M.column,originalLine:F!=null&&F.line,originalColumn:F!=null&&F.column,source:S,name:k})},p.prototype.setSourceContent=function(b,M){var F=b;this._sourceRoot!=null&&(F=t.relative(this._sourceRoot,F)),M!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(F)]=M):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(F)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},p.prototype.applySourceMap=function(b,M,F){var S=M;if(M==null){if(b.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);S=b.file}var k=this._sourceRoot;k!=null&&(S=t.relative(k,S));var N=new o,$=new o;this._mappings.unsortedForEach(function(R){if(R.source===S&&R.originalLine!=null){var U=b.originalPositionFor({line:R.originalLine,column:R.originalColumn});U.source!=null&&(R.source=U.source,F!=null&&(R.source=t.join(F,R.source)),k!=null&&(R.source=t.relative(k,R.source)),R.originalLine=U.line,R.originalColumn=U.column,U.name!=null&&(R.name=U.name))}var V=R.source;V!=null&&!N.has(V)&&N.add(V);var z=R.name;z!=null&&!$.has(z)&&$.add(z)},this),this._sources=N,this._names=$,b.sources.forEach(function(R){var U=b.sourceContentFor(R);U!=null&&(F!=null&&(R=t.join(F,R)),k!=null&&(R=t.relative(k,R)),this.setSourceContent(R,U))},this)},p.prototype._validateMapping=function(b,M,F,S){if(M&&typeof M.line!="number"&&typeof M.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(b&&"line"in b&&"column"in b&&b.line>0&&b.column>=0&&!M&&!F&&!S)){if(b&&"line"in b&&"column"in b&&M&&"line"in M&&"column"in M&&b.line>0&&b.column>=0&&M.line>0&&M.column>=0&&F)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:b,source:F,original:M,name:S}))}},p.prototype._serializeMappings=function(){for(var b=0,M=1,F=0,S=0,k=0,N=0,$="",R,U,V,z,K=this._mappings.toArray(),ie=0,he=K.length;ie<he;ie++){if(U=K[ie],R="",U.generatedLine!==M)for(b=0;U.generatedLine!==M;)R+=";",M++;else if(ie>0){if(!t.compareByGeneratedPositionsInflated(U,K[ie-1]))continue;R+=","}R+=e.encode(U.generatedColumn-b),b=U.generatedColumn,U.source!=null&&(z=this._sources.indexOf(U.source),R+=e.encode(z-N),N=z,R+=e.encode(U.originalLine-1-S),S=U.originalLine-1,R+=e.encode(U.originalColumn-F),F=U.originalColumn,U.name!=null&&(V=this._names.indexOf(U.name),R+=e.encode(V-k),k=V)),$+=R}return $},p.prototype._generateSourcesContent=function(b,M){return b.map(function(F){if(!this._sourcesContents)return null;M!=null&&(F=t.relative(M,F));var S=t.toSetString(F);return Object.prototype.hasOwnProperty.call(this._sourcesContents,S)?this._sourcesContents[S]:null},this)},p.prototype.toJSON=function(){var b={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(b.file=this._file),this._sourceRoot!=null&&(b.sourceRoot=this._sourceRoot),this._sourcesContents&&(b.sourcesContent=this._generateSourcesContent(b.sources,b.sourceRoot)),b},p.prototype.toString=function(){return JSON.stringify(this.toJSON())},sourceMapGenerator.SourceMapGenerator=p,sourceMapGenerator}var sourceMapConsumer={},binarySearch={},hasRequiredBinarySearch;function requireBinarySearch(){return hasRequiredBinarySearch||(hasRequiredBinarySearch=1,(function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(o,u,p,f,b,M){var F=Math.floor((u-o)/2)+o,S=b(p,f[F],!0);return S===0?F:S>0?u-F>1?t(F,u,p,f,b,M):M==e.LEAST_UPPER_BOUND?u<f.length?u:-1:F:F-o>1?t(o,F,p,f,b,M):M==e.LEAST_UPPER_BOUND?F:o<0?-1:o}e.search=function(u,p,f,b){if(p.length===0)return-1;var M=t(-1,p.length,u,p,f,b||e.GREATEST_LOWER_BOUND);if(M<0)return-1;for(;M-1>=0&&f(p[M],p[M-1],!0)===0;)--M;return M}})(binarySearch)),binarySearch}var quickSort={},hasRequiredQuickSort;function requireQuickSort(){if(hasRequiredQuickSort)return quickSort;hasRequiredQuickSort=1;function e(u,p,f){var b=u[p];u[p]=u[f],u[f]=b}function t(u,p){return Math.round(u+Math.random()*(p-u))}function o(u,p,f,b){if(f<b){var M=t(f,b),F=f-1;e(u,M,b);for(var S=u[b],k=f;k<b;k++)p(u[k],S)<=0&&(F+=1,e(u,F,k));e(u,F+1,k);var N=F+1;o(u,p,f,N-1),o(u,p,N+1,b)}}return quickSort.quickSort=function(u,p){o(u,p,0,u.length-1)},quickSort}var hasRequiredSourceMapConsumer;function requireSourceMapConsumer(){if(hasRequiredSourceMapConsumer)return sourceMapConsumer;hasRequiredSourceMapConsumer=1;var e=requireUtil(),t=requireBinarySearch(),o=requireArraySet().ArraySet,u=requireBase64Vlq(),p=requireQuickSort().quickSort;function f(S,k){var N=S;return typeof S=="string"&&(N=e.parseSourceMapInput(S)),N.sections!=null?new F(N,k):new b(N,k)}f.fromSourceMap=function(S,k){return b.fromSourceMap(S,k)},f.prototype._version=3,f.prototype.__generatedMappings=null,Object.defineProperty(f.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),f.prototype.__originalMappings=null,Object.defineProperty(f.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),f.prototype._charIsMappingSeparator=function(k,N){var $=k.charAt(N);return $===";"||$===","},f.prototype._parseMappings=function(k,N){throw new Error("Subclasses must implement _parseMappings")},f.GENERATED_ORDER=1,f.ORIGINAL_ORDER=2,f.GREATEST_LOWER_BOUND=1,f.LEAST_UPPER_BOUND=2,f.prototype.eachMapping=function(k,N,$){var R=N||null,U=$||f.GENERATED_ORDER,V;switch(U){case f.GENERATED_ORDER:V=this._generatedMappings;break;case f.ORIGINAL_ORDER:V=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var z=this.sourceRoot;V.map(function(K){var ie=K.source===null?null:this._sources.at(K.source);return ie=e.computeSourceURL(z,ie,this._sourceMapURL),{source:ie,generatedLine:K.generatedLine,generatedColumn:K.generatedColumn,originalLine:K.originalLine,originalColumn:K.originalColumn,name:K.name===null?null:this._names.at(K.name)}},this).forEach(k,R)},f.prototype.allGeneratedPositionsFor=function(k){var N=e.getArg(k,"line"),$={source:e.getArg(k,"source"),originalLine:N,originalColumn:e.getArg(k,"column",0)};if($.source=this._findSourceIndex($.source),$.source<0)return[];var R=[],U=this._findMapping($,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(U>=0){var V=this._originalMappings[U];if(k.column===void 0)for(var z=V.originalLine;V&&V.originalLine===z;)R.push({line:e.getArg(V,"generatedLine",null),column:e.getArg(V,"generatedColumn",null),lastColumn:e.getArg(V,"lastGeneratedColumn",null)}),V=this._originalMappings[++U];else for(var K=V.originalColumn;V&&V.originalLine===N&&V.originalColumn==K;)R.push({line:e.getArg(V,"generatedLine",null),column:e.getArg(V,"generatedColumn",null),lastColumn:e.getArg(V,"lastGeneratedColumn",null)}),V=this._originalMappings[++U]}return R},sourceMapConsumer.SourceMapConsumer=f;function b(S,k){var N=S;typeof S=="string"&&(N=e.parseSourceMapInput(S));var $=e.getArg(N,"version"),R=e.getArg(N,"sources"),U=e.getArg(N,"names",[]),V=e.getArg(N,"sourceRoot",null),z=e.getArg(N,"sourcesContent",null),K=e.getArg(N,"mappings"),ie=e.getArg(N,"file",null);if($!=this._version)throw new Error("Unsupported version: "+$);V&&(V=e.normalize(V)),R=R.map(String).map(e.normalize).map(function(he){return V&&e.isAbsolute(V)&&e.isAbsolute(he)?e.relative(V,he):he}),this._names=o.fromArray(U.map(String),!0),this._sources=o.fromArray(R,!0),this._absoluteSources=this._sources.toArray().map(function(he){return e.computeSourceURL(V,he,k)}),this.sourceRoot=V,this.sourcesContent=z,this._mappings=K,this._sourceMapURL=k,this.file=ie}b.prototype=Object.create(f.prototype),b.prototype.consumer=f,b.prototype._findSourceIndex=function(S){var k=S;if(this.sourceRoot!=null&&(k=e.relative(this.sourceRoot,k)),this._sources.has(k))return this._sources.indexOf(k);var N;for(N=0;N<this._absoluteSources.length;++N)if(this._absoluteSources[N]==S)return N;return-1},b.fromSourceMap=function(k,N){var $=Object.create(b.prototype),R=$._names=o.fromArray(k._names.toArray(),!0),U=$._sources=o.fromArray(k._sources.toArray(),!0);$.sourceRoot=k._sourceRoot,$.sourcesContent=k._generateSourcesContent($._sources.toArray(),$.sourceRoot),$.file=k._file,$._sourceMapURL=N,$._absoluteSources=$._sources.toArray().map(function(pe){return e.computeSourceURL($.sourceRoot,pe,N)});for(var V=k._mappings.toArray().slice(),z=$.__generatedMappings=[],K=$.__originalMappings=[],ie=0,he=V.length;ie<he;ie++){var se=V[ie],ee=new M;ee.generatedLine=se.generatedLine,ee.generatedColumn=se.generatedColumn,se.source&&(ee.source=U.indexOf(se.source),ee.originalLine=se.originalLine,ee.originalColumn=se.originalColumn,se.name&&(ee.name=R.indexOf(se.name)),K.push(ee)),z.push(ee)}return p($.__originalMappings,e.compareByOriginalPositions),$},b.prototype._version=3,Object.defineProperty(b.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function M(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}b.prototype._parseMappings=function(k,N){for(var $=1,R=0,U=0,V=0,z=0,K=0,ie=k.length,he=0,se={},ee={},pe=[],_e=[],ve,we,xe,Oe,Pe;he<ie;)if(k.charAt(he)===";")$++,he++,R=0;else if(k.charAt(he)===",")he++;else{for(ve=new M,ve.generatedLine=$,Oe=he;Oe<ie&&!this._charIsMappingSeparator(k,Oe);Oe++);if(we=k.slice(he,Oe),xe=se[we],xe)he+=we.length;else{for(xe=[];he<Oe;)u.decode(k,he,ee),Pe=ee.value,he=ee.rest,xe.push(Pe);if(xe.length===2)throw new Error("Found a source, but no line and column");if(xe.length===3)throw new Error("Found a source and line, but no column");se[we]=xe}ve.generatedColumn=R+xe[0],R=ve.generatedColumn,xe.length>1&&(ve.source=z+xe[1],z+=xe[1],ve.originalLine=U+xe[2],U=ve.originalLine,ve.originalLine+=1,ve.originalColumn=V+xe[3],V=ve.originalColumn,xe.length>4&&(ve.name=K+xe[4],K+=xe[4])),_e.push(ve),typeof ve.originalLine=="number"&&pe.push(ve)}p(_e,e.compareByGeneratedPositionsDeflated),this.__generatedMappings=_e,p(pe,e.compareByOriginalPositions),this.__originalMappings=pe},b.prototype._findMapping=function(k,N,$,R,U,V){if(k[$]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+k[$]);if(k[R]<0)throw new TypeError("Column must be greater than or equal to 0, got "+k[R]);return t.search(k,N,U,V)},b.prototype.computeColumnSpans=function(){for(var k=0;k<this._generatedMappings.length;++k){var N=this._generatedMappings[k];if(k+1<this._generatedMappings.length){var $=this._generatedMappings[k+1];if(N.generatedLine===$.generatedLine){N.lastGeneratedColumn=$.generatedColumn-1;continue}}N.lastGeneratedColumn=1/0}},b.prototype.originalPositionFor=function(k){var N={generatedLine:e.getArg(k,"line"),generatedColumn:e.getArg(k,"column")},$=this._findMapping(N,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositionsDeflated,e.getArg(k,"bias",f.GREATEST_LOWER_BOUND));if($>=0){var R=this._generatedMappings[$];if(R.generatedLine===N.generatedLine){var U=e.getArg(R,"source",null);U!==null&&(U=this._sources.at(U),U=e.computeSourceURL(this.sourceRoot,U,this._sourceMapURL));var V=e.getArg(R,"name",null);return V!==null&&(V=this._names.at(V)),{source:U,line:e.getArg(R,"originalLine",null),column:e.getArg(R,"originalColumn",null),name:V}}}return{source:null,line:null,column:null,name:null}},b.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(k){return k==null}):!1},b.prototype.sourceContentFor=function(k,N){if(!this.sourcesContent)return null;var $=this._findSourceIndex(k);if($>=0)return this.sourcesContent[$];var R=k;this.sourceRoot!=null&&(R=e.relative(this.sourceRoot,R));var U;if(this.sourceRoot!=null&&(U=e.urlParse(this.sourceRoot))){var V=R.replace(/^file:\/\//,"");if(U.scheme=="file"&&this._sources.has(V))return this.sourcesContent[this._sources.indexOf(V)];if((!U.path||U.path=="/")&&this._sources.has("/"+R))return this.sourcesContent[this._sources.indexOf("/"+R)]}if(N)return null;throw new Error('"'+R+'" is not in the SourceMap.')},b.prototype.generatedPositionFor=function(k){var N=e.getArg(k,"source");if(N=this._findSourceIndex(N),N<0)return{line:null,column:null,lastColumn:null};var $={source:N,originalLine:e.getArg(k,"line"),originalColumn:e.getArg(k,"column")},R=this._findMapping($,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,e.getArg(k,"bias",f.GREATEST_LOWER_BOUND));if(R>=0){var U=this._originalMappings[R];if(U.source===$.source)return{line:e.getArg(U,"generatedLine",null),column:e.getArg(U,"generatedColumn",null),lastColumn:e.getArg(U,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},sourceMapConsumer.BasicSourceMapConsumer=b;function F(S,k){var N=S;typeof S=="string"&&(N=e.parseSourceMapInput(S));var $=e.getArg(N,"version"),R=e.getArg(N,"sections");if($!=this._version)throw new Error("Unsupported version: "+$);this._sources=new o,this._names=new o;var U={line:-1,column:0};this._sections=R.map(function(V){if(V.url)throw new Error("Support for url field in sections not implemented.");var z=e.getArg(V,"offset"),K=e.getArg(z,"line"),ie=e.getArg(z,"column");if(K<U.line||K===U.line&&ie<U.column)throw new Error("Section offsets must be ordered and non-overlapping.");return U=z,{generatedOffset:{generatedLine:K+1,generatedColumn:ie+1},consumer:new f(e.getArg(V,"map"),k)}})}return F.prototype=Object.create(f.prototype),F.prototype.constructor=f,F.prototype._version=3,Object.defineProperty(F.prototype,"sources",{get:function(){for(var S=[],k=0;k<this._sections.length;k++)for(var N=0;N<this._sections[k].consumer.sources.length;N++)S.push(this._sections[k].consumer.sources[N]);return S}}),F.prototype.originalPositionFor=function(k){var N={generatedLine:e.getArg(k,"line"),generatedColumn:e.getArg(k,"column")},$=t.search(N,this._sections,function(U,V){var z=U.generatedLine-V.generatedOffset.generatedLine;return z||U.generatedColumn-V.generatedOffset.generatedColumn}),R=this._sections[$];return R?R.consumer.originalPositionFor({line:N.generatedLine-(R.generatedOffset.generatedLine-1),column:N.generatedColumn-(R.generatedOffset.generatedLine===N.generatedLine?R.generatedOffset.generatedColumn-1:0),bias:k.bias}):{source:null,line:null,column:null,name:null}},F.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(k){return k.consumer.hasContentsOfAllSources()})},F.prototype.sourceContentFor=function(k,N){for(var $=0;$<this._sections.length;$++){var R=this._sections[$],U=R.consumer.sourceContentFor(k,!0);if(U)return U}if(N)return null;throw new Error('"'+k+'" is not in the SourceMap.')},F.prototype.generatedPositionFor=function(k){for(var N=0;N<this._sections.length;N++){var $=this._sections[N];if($.consumer._findSourceIndex(e.getArg(k,"source"))!==-1){var R=$.consumer.generatedPositionFor(k);if(R){var U={line:R.line+($.generatedOffset.generatedLine-1),column:R.column+($.generatedOffset.generatedLine===R.line?$.generatedOffset.generatedColumn-1:0)};return U}}}return{line:null,column:null}},F.prototype._parseMappings=function(k,N){this.__generatedMappings=[],this.__originalMappings=[];for(var $=0;$<this._sections.length;$++)for(var R=this._sections[$],U=R.consumer._generatedMappings,V=0;V<U.length;V++){var z=U[V],K=R.consumer._sources.at(z.source);K=e.computeSourceURL(R.consumer.sourceRoot,K,this._sourceMapURL),this._sources.add(K),K=this._sources.indexOf(K);var ie=null;z.name&&(ie=R.consumer._names.at(z.name),this._names.add(ie),ie=this._names.indexOf(ie));var he={source:K,generatedLine:z.generatedLine+(R.generatedOffset.generatedLine-1),generatedColumn:z.generatedColumn+(R.generatedOffset.generatedLine===z.generatedLine?R.generatedOffset.generatedColumn-1:0),originalLine:z.originalLine,originalColumn:z.originalColumn,name:ie};this.__generatedMappings.push(he),typeof he.originalLine=="number"&&this.__originalMappings.push(he)}p(this.__generatedMappings,e.compareByGeneratedPositionsDeflated),p(this.__originalMappings,e.compareByOriginalPositions)},sourceMapConsumer.IndexedSourceMapConsumer=F,sourceMapConsumer}var sourceNode={},hasRequiredSourceNode;function requireSourceNode(){if(hasRequiredSourceNode)return sourceNode;hasRequiredSourceNode=1;var e=requireSourceMapGenerator().SourceMapGenerator,t=requireUtil(),o=/(\r?\n)/,u=10,p="$$$isSourceNode$$$";function f(b,M,F,S,k){this.children=[],this.sourceContents={},this.line=b??null,this.column=M??null,this.source=F??null,this.name=k??null,this[p]=!0,S!=null&&this.add(S)}return f.fromStringWithSourceMap=function(M,F,S){var k=new f,N=M.split(o),$=0,R=function(){var ie=se(),he=se()||"";return ie+he;function se(){return $<N.length?N[$++]:void 0}},U=1,V=0,z=null;return F.eachMapping(function(ie){if(z!==null)if(U<ie.generatedLine)K(z,R()),U++,V=0;else{var he=N[$]||"",se=he.substr(0,ie.generatedColumn-V);N[$]=he.substr(ie.generatedColumn-V),V=ie.generatedColumn,K(z,se),z=ie;return}for(;U<ie.generatedLine;)k.add(R()),U++;if(V<ie.generatedColumn){var he=N[$]||"";k.add(he.substr(0,ie.generatedColumn)),N[$]=he.substr(ie.generatedColumn),V=ie.generatedColumn}z=ie},this),$<N.length&&(z&&K(z,R()),k.add(N.splice($).join(""))),F.sources.forEach(function(ie){var he=F.sourceContentFor(ie);he!=null&&(S!=null&&(ie=t.join(S,ie)),k.setSourceContent(ie,he))}),k;function K(ie,he){if(ie===null||ie.source===void 0)k.add(he);else{var se=S?t.join(S,ie.source):ie.source;k.add(new f(ie.originalLine,ie.originalColumn,se,he,ie.name))}}},f.prototype.add=function(M){if(Array.isArray(M))M.forEach(function(F){this.add(F)},this);else if(M[p]||typeof M=="string")M&&this.children.push(M);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+M);return this},f.prototype.prepend=function(M){if(Array.isArray(M))for(var F=M.length-1;F>=0;F--)this.prepend(M[F]);else if(M[p]||typeof M=="string")this.children.unshift(M);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+M);return this},f.prototype.walk=function(M){for(var F,S=0,k=this.children.length;S<k;S++)F=this.children[S],F[p]?F.walk(M):F!==""&&M(F,{source:this.source,line:this.line,column:this.column,name:this.name})},f.prototype.join=function(M){var F,S,k=this.children.length;if(k>0){for(F=[],S=0;S<k-1;S++)F.push(this.children[S]),F.push(M);F.push(this.children[S]),this.children=F}return this},f.prototype.replaceRight=function(M,F){var S=this.children[this.children.length-1];return S[p]?S.replaceRight(M,F):typeof S=="string"?this.children[this.children.length-1]=S.replace(M,F):this.children.push("".replace(M,F)),this},f.prototype.setSourceContent=function(M,F){this.sourceContents[t.toSetString(M)]=F},f.prototype.walkSourceContents=function(M){for(var F=0,S=this.children.length;F<S;F++)this.children[F][p]&&this.children[F].walkSourceContents(M);for(var k=Object.keys(this.sourceContents),F=0,S=k.length;F<S;F++)M(t.fromSetString(k[F]),this.sourceContents[k[F]])},f.prototype.toString=function(){var M="";return this.walk(function(F){M+=F}),M},f.prototype.toStringWithSourceMap=function(M){var F={code:"",line:1,column:0},S=new e(M),k=!1,N=null,$=null,R=null,U=null;return this.walk(function(V,z){F.code+=V,z.source!==null&&z.line!==null&&z.column!==null?((N!==z.source||$!==z.line||R!==z.column||U!==z.name)&&S.addMapping({source:z.source,original:{line:z.line,column:z.column},generated:{line:F.line,column:F.column},name:z.name}),N=z.source,$=z.line,R=z.column,U=z.name,k=!0):k&&(S.addMapping({generated:{line:F.line,column:F.column}}),N=null,k=!1);for(var K=0,ie=V.length;K<ie;K++)V.charCodeAt(K)===u?(F.line++,F.column=0,K+1===ie?(N=null,k=!1):k&&S.addMapping({source:z.source,original:{line:z.line,column:z.column},generated:{line:F.line,column:F.column},name:z.name})):F.column++}),this.walkSourceContents(function(V,z){S.setSourceContent(V,z)}),{code:F.code,map:S}},sourceNode.SourceNode=f,sourceNode}var hasRequiredSourceMap;function requireSourceMap(){return hasRequiredSourceMap||(hasRequiredSourceMap=1,sourceMap.SourceMapGenerator=requireSourceMapGenerator().SourceMapGenerator,sourceMap.SourceMapConsumer=requireSourceMapConsumer().SourceMapConsumer,sourceMap.SourceNode=requireSourceNode().SourceNode),sourceMap}const version="2.1.0",require$$3={version};var hasRequiredEscodegen;function requireEscodegen(){return hasRequiredEscodegen||(hasRequiredEscodegen=1,(function(e){(function(){var t,o,u,p,f,b,M,F,S,k,N,$,R,U,V,z,K,ie,he,se,ee,pe,_e,ve,we,xe;f=requireEstraverse(),b=requireUtils(),t=f.Syntax;function Oe(B){return tt.Expression.hasOwnProperty(B.type)}function Pe(B){return tt.Statement.hasOwnProperty(B.type)}o={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},u={"??":o.Coalesce,"||":o.LogicalOR,"&&":o.LogicalAND,"|":o.BitwiseOR,"^":o.BitwiseXOR,"&":o.BitwiseAND,"==":o.Equality,"!=":o.Equality,"===":o.Equality,"!==":o.Equality,is:o.Equality,isnt:o.Equality,"<":o.Relational,">":o.Relational,"<=":o.Relational,">=":o.Relational,in:o.Relational,instanceof:o.Relational,"<<":o.BitwiseSHIFT,">>":o.BitwiseSHIFT,">>>":o.BitwiseSHIFT,"+":o.Additive,"-":o.Additive,"*":o.Multiplicative,"%":o.Multiplicative,"/":o.Multiplicative,"**":o.Exponentiation};var Le=1,Xe=2,Ke=4,me=8,ye=16,Se=32,qe=64,st=Xe|Ke,mt=Le|Xe,Ee=Le|Xe|Ke,rt=Le,St=Ke,pt=Le|Ke,bt=Le,yt=Le|Se,At=0,Et=Le|ye,Kt=Le|me;function jt(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Nt(B,te){var q="";for(te|=0;te>0;te>>>=1,B+=B)te&1&&(q+=B);return q}function _t(B){return/[\r\n]/g.test(B)}function $t(B){var te=B.length;return te&&b.code.isLineTerminator(B.charCodeAt(te-1))}function sn(B,te){var q;for(q in te)te.hasOwnProperty(q)&&(B[q]=te[q]);return B}function kt(B,te){var q,re;function ue(ke){return typeof ke=="object"&&ke instanceof Object&&!(ke instanceof RegExp)}for(q in te)te.hasOwnProperty(q)&&(re=te[q],ue(re)?ue(B[q])?kt(B[q],re):B[q]=kt({},re):B[q]=re);return B}function Ot(B){var te,q,re,ue,ke;if(B!==B)throw new Error("Numeric literal whose value is NaN");if(B<0||B===0&&1/B<0)throw new Error("Numeric literal whose value is negative");if(B===1/0)return S?"null":k?"1e400":"1e+400";if(te=""+B,!k||te.length<3)return te;for(q=te.indexOf("."),!S&&te.charCodeAt(0)===48&&q===1&&(q=0,te=te.slice(1)),re=te,te=te.replace("e+","e"),ue=0,(ke=re.indexOf("e"))>0&&(ue=+re.slice(ke+1),re=re.slice(0,ke)),q>=0&&(ue-=re.length-q-1,re=+(re.slice(0,q)+re.slice(q+1))+""),ke=0;re.charCodeAt(re.length+ke-1)===48;)--ke;return ke!==0&&(ue-=ke,re=re.slice(0,ke)),ue!==0&&(re+="e"+ue),(re.length<te.length||N&&B>1e12&&Math.floor(B)===B&&(re="0x"+B.toString(16)).length<te.length)&&+re===B&&(te=re),te}function Wt(B,te){return(B&-2)===8232?(te?"u":"\\u")+(B===8232?"2028":"2029"):B===10||B===13?(te?"":"\\")+(B===10?"n":"r"):String.fromCharCode(B)}function Ae(B){var te,q,re,ue,ke,Be,Ve,nt;if(q=B.toString(),B.source){if(te=q.match(/\/([^/]*)$/),!te)return q;for(re=te[1],q="",Ve=!1,nt=!1,ue=0,ke=B.source.length;ue<ke;++ue)Be=B.source.charCodeAt(ue),nt?(q+=Wt(Be,nt),nt=!1):(Ve?Be===93&&(Ve=!1):Be===47?q+="\\":Be===91&&(Ve=!0),q+=Wt(Be,nt),nt=Be===92);return"/"+q+"/"+re}return q}function Ce(B,te){var q;return B===8?"\\b":B===12?"\\f":B===9?"\\t":(q=B.toString(16).toUpperCase(),S||B>255?"\\u"+"0000".slice(q.length)+q:B===0&&!b.code.isDecimalDigit(te)?"\\0":B===11?"\\x0B":"\\x"+"00".slice(q.length)+q)}function ge(B){if(B===92)return"\\\\";if(B===10)return"\\n";if(B===13)return"\\r";if(B===8232)return"\\u2028";if(B===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Te(B){var te,q,re,ue;for(ue=$==="double"?'"':"'",te=0,q=B.length;te<q;++te)if(re=B.charCodeAt(te),re===39){ue='"';break}else if(re===34){ue="'";break}else re===92&&++te;return ue+B+ue}function ze(B){var te="",q,re,ue,ke=0,Be=0,Ve,nt;for(q=0,re=B.length;q<re;++q){if(ue=B.charCodeAt(q),ue===39)++ke;else if(ue===34)++Be;else if(ue===47&&S)te+="\\";else if(b.code.isLineTerminator(ue)||ue===92){te+=ge(ue);continue}else if(!b.code.isIdentifierPartES5(ue)&&(S&&ue<32||!S&&!R&&(ue<32||ue>126))){te+=Ce(ue,B.charCodeAt(q+1));continue}te+=String.fromCharCode(ue)}if(Ve=!($==="double"||$==="auto"&&Be<ke),nt=Ve?"'":'"',!(Ve?ke:Be))return nt+te+nt;for(B=te,te=nt,q=0,re=B.length;q<re;++q)ue=B.charCodeAt(q),(ue===39&&Ve||ue===34&&!Ve)&&(te+="\\"),te+=String.fromCharCode(ue);return te+nt}function Ne(B){var te,q,re,ue="";for(te=0,q=B.length;te<q;++te)re=B[te],ue+=Array.isArray(re)?Ne(re):re;return ue}function De(B,te){if(!pe)return Array.isArray(B)?Ne(B):B;if(te==null){if(B instanceof p)return B;te={}}return te.loc==null?new p(null,null,pe,B,te.name||null):new p(te.loc.start.line,te.loc.start.column,pe===!0?te.loc.source||null:pe,B,te.name||null)}function Ie(){return V||" "}function Ge(B,te){var q,re,ue,ke;return q=De(B).toString(),q.length===0?[te]:(re=De(te).toString(),re.length===0?[B]:(ue=q.charCodeAt(q.length-1),ke=re.charCodeAt(0),(ue===43||ue===45)&&ue===ke||b.code.isIdentifierPartES5(ue)&&b.code.isIdentifierPartES5(ke)||ue===47&&ke===105?[B,Ie(),te]:b.code.isWhiteSpace(ue)||b.code.isLineTerminator(ue)||b.code.isWhiteSpace(ke)||b.code.isLineTerminator(ke)?[B,te]:[B,V,te]))}function He(B){return[M,B]}function it(B){var te;te=M,M+=F,B(M),M=te}function Gt(B){var te;for(te=B.length-1;te>=0&&!b.code.isLineTerminator(B.charCodeAt(te));--te);return B.length-1-te}function zt(B,te){var q,re,ue,ke,Be,Ve,nt,Lt;for(q=B.split(/\r\n|[\r\n]/),Ve=Number.MAX_VALUE,re=1,ue=q.length;re<ue;++re){for(ke=q[re],Be=0;Be<ke.length&&b.code.isWhiteSpace(ke.charCodeAt(Be));)++Be;Ve>Be&&(Ve=Be)}for(typeof te<"u"?(nt=M,q[1][Ve]==="*"&&(te+=" "),M=te):(Ve&1&&--Ve,nt=M),re=1,ue=q.length;re<ue;++re)Lt=De(He(q[re].slice(Ve))),q[re]=pe?Lt.join(""):Lt;return M=nt,q.join(`
`)}function Ue(B,te){if(B.type==="Line"){if($t(B.value))return"//"+B.value;var q="//"+B.value;return ve||(q+=`
`),q}return se.format.indent.adjustMultilineComment&&/[\n\r]/.test(B.value)?zt("/*"+B.value+"*/",te):"/*"+B.value+"*/"}function Dt(B,te){var q,re,ue,ke,Be,Ve,nt,Lt,Jt,Rn,Sn,zr,Hr,yn;if(B.leadingComments&&B.leadingComments.length>0){if(ke=te,ve){for(ue=B.leadingComments[0],te=[],Lt=ue.extendedRange,Jt=ue.range,Sn=_e.substring(Lt[0],Jt[0]),yn=(Sn.match(/\n/g)||[]).length,yn>0?(te.push(Nt(`
`,yn)),te.push(He(Ue(ue)))):(te.push(Sn),te.push(Ue(ue))),Rn=Jt,q=1,re=B.leadingComments.length;q<re;q++)ue=B.leadingComments[q],Jt=ue.range,zr=_e.substring(Rn[1],Jt[0]),yn=(zr.match(/\n/g)||[]).length,te.push(Nt(`
`,yn)),te.push(He(Ue(ue))),Rn=Jt;Hr=_e.substring(Jt[1],Lt[1]),yn=(Hr.match(/\n/g)||[]).length,te.push(Nt(`
`,yn))}else for(ue=B.leadingComments[0],te=[],ie&&B.type===t.Program&&B.body.length===0&&te.push(`
`),te.push(Ue(ue)),$t(De(te).toString())||te.push(`
`),q=1,re=B.leadingComments.length;q<re;++q)ue=B.leadingComments[q],nt=[Ue(ue)],$t(De(nt).toString())||nt.push(`
`),te.push(He(nt));te.push(He(ke))}if(B.trailingComments)if(ve)ue=B.trailingComments[0],Lt=ue.extendedRange,Jt=ue.range,Sn=_e.substring(Lt[0],Jt[0]),yn=(Sn.match(/\n/g)||[]).length,yn>0?(te.push(Nt(`
`,yn)),te.push(He(Ue(ue)))):(te.push(Sn),te.push(Ue(ue)));else for(Be=!$t(De(te).toString()),Ve=Nt(" ",Gt(De([M,te,F]).toString())),q=0,re=B.trailingComments.length;q<re;++q)ue=B.trailingComments[q],Be?(q===0?te=[te,F]:te=[te,Ve],te.push(Ue(ue,Ve))):te=[te,He(Ue(ue))],q!==re-1&&!$t(De(te).toString())&&(te=[te,`
`]);return te}function It(B,te,q){var re,ue=0;for(re=B;re<te;re++)_e[re]===`
`&&ue++;for(re=1;re<ue;re++)q.push(U)}function Qe(B,te,q){return te<q?["(",B,")"]:B}function Bt(B){var te,q,re;for(re=B.split(/\r\n|\n/),te=1,q=re.length;te<q;te++)re[te]=U+M+re[te];return re}function on(B,te){var q,re,ue;return q=B[se.verbatim],typeof q=="string"?re=Qe(Bt(q),o.Sequence,te):(re=Bt(q.content),ue=q.precedence!=null?q.precedence:o.Sequence,re=Qe(re,ue,te)),De(re,B)}function tt(){}tt.prototype.maybeBlock=function(B,te){var q,re,ue=this;return re=!se.comment||!B.leadingComments,B.type===t.BlockStatement&&re?[V,this.generateStatement(B,te)]:B.type===t.EmptyStatement&&re?";":(it(function(){q=[U,He(ue.generateStatement(B,te))]}),q)},tt.prototype.maybeBlockSuffix=function(B,te){var q=$t(De(te).toString());return B.type===t.BlockStatement&&(!se.comment||!B.leadingComments)&&!q?[te,V]:q?[te,M]:[te,U,M]};function Ct(B){return De(B.name,B)}function Mt(B,te){return B.async?"async"+(te?Ie():V):""}function Zt(B){var te=B.generator&&!se.moz.starlessGenerator;return te?"*"+V:""}function nn(B){var te=B.value,q="";return te.async&&(q+=Mt(te,!B.computed)),te.generator&&(q+=Zt(te)?"*":""),q}tt.prototype.generatePattern=function(B,te,q){return B.type===t.Identifier?Ct(B):this.generateExpression(B,te,q)},tt.prototype.generateFunctionParams=function(B){var te,q,re,ue;if(ue=!1,B.type===t.ArrowFunctionExpression&&!B.rest&&(!B.defaults||B.defaults.length===0)&&B.params.length===1&&B.params[0].type===t.Identifier)re=[Mt(B,!0),Ct(B.params[0])];else{for(re=B.type===t.ArrowFunctionExpression?[Mt(B,!1)]:[],re.push("("),B.defaults&&(ue=!0),te=0,q=B.params.length;te<q;++te)ue&&B.defaults[te]?re.push(this.generateAssignment(B.params[te],B.defaults[te],"=",o.Assignment,Ee)):re.push(this.generatePattern(B.params[te],o.Assignment,Ee)),te+1<q&&re.push(","+V);B.rest&&(B.params.length&&re.push(","+V),re.push("..."),re.push(Ct(B.rest))),re.push(")")}return re},tt.prototype.generateFunctionBody=function(B){var te,q;return te=this.generateFunctionParams(B),B.type===t.ArrowFunctionExpression&&(te.push(V),te.push("=>")),B.expression?(te.push(V),q=this.generateExpression(B.body,o.Assignment,Ee),q.toString().charAt(0)==="{"&&(q=["(",q,")"]),te.push(q)):te.push(this.maybeBlock(B.body,Kt)),te},tt.prototype.generateIterationForStatement=function(B,te,q){var re=["for"+(te.await?Ie()+"await":"")+V+"("],ue=this;return it(function(){te.left.type===t.VariableDeclaration?it(function(){re.push(te.left.kind+Ie()),re.push(ue.generateStatement(te.left.declarations[0],At))}):re.push(ue.generateExpression(te.left,o.Call,Ee)),re=Ge(re,B),re=[Ge(re,ue.generateExpression(te.right,o.Assignment,Ee)),")"]}),re.push(this.maybeBlock(te.body,q)),re},tt.prototype.generatePropertyKey=function(B,te){var q=[];return te&&q.push("["),q.push(this.generateExpression(B,o.Assignment,Ee)),te&&q.push("]"),q},tt.prototype.generateAssignment=function(B,te,q,re,ue){return o.Assignment<re&&(ue|=Le),Qe([this.generateExpression(B,o.Call,ue),V+q+V,this.generateExpression(te,o.Assignment,ue)],o.Assignment,re)},tt.prototype.semicolon=function(B){return!K&&B&Se?"":";"},tt.Statement={BlockStatement:function(B,te){var q,re,ue=["{",U],ke=this;return it(function(){B.body.length===0&&ve&&(q=B.range,q[1]-q[0]>2&&(re=_e.substring(q[0]+1,q[1]-1),re[0]===`
`&&(ue=["{"]),ue.push(re)));var Be,Ve,nt,Lt;for(Lt=bt,te&me&&(Lt|=ye),Be=0,Ve=B.body.length;Be<Ve;++Be)ve&&(Be===0&&(B.body[0].leadingComments&&(q=B.body[0].leadingComments[0].extendedRange,re=_e.substring(q[0],q[1]),re[0]===`
`&&(ue=["{"])),B.body[0].leadingComments||It(B.range[0],B.body[0].range[0],ue)),Be>0&&!B.body[Be-1].trailingComments&&!B.body[Be].leadingComments&&It(B.body[Be-1].range[1],B.body[Be].range[0],ue)),Be===Ve-1&&(Lt|=Se),B.body[Be].leadingComments&&ve?nt=ke.generateStatement(B.body[Be],Lt):nt=He(ke.generateStatement(B.body[Be],Lt)),ue.push(nt),$t(De(nt).toString())||ve&&Be<Ve-1&&B.body[Be+1].leadingComments||ue.push(U),ve&&Be===Ve-1&&(B.body[Be].trailingComments||It(B.body[Be].range[1],B.range[1],ue))}),ue.push(He("}")),ue},BreakStatement:function(B,te){return B.label?"break "+B.label.name+this.semicolon(te):"break"+this.semicolon(te)},ContinueStatement:function(B,te){return B.label?"continue "+B.label.name+this.semicolon(te):"continue"+this.semicolon(te)},ClassBody:function(B,te){var q=["{",U],re=this;return it(function(ue){var ke,Be;for(ke=0,Be=B.body.length;ke<Be;++ke)q.push(ue),q.push(re.generateExpression(B.body[ke],o.Sequence,Ee)),ke+1<Be&&q.push(U)}),$t(De(q).toString())||q.push(U),q.push(M),q.push("}"),q},ClassDeclaration:function(B,te){var q,re;return q=["class"],B.id&&(q=Ge(q,this.generateExpression(B.id,o.Sequence,Ee))),B.superClass&&(re=Ge("extends",this.generateExpression(B.superClass,o.Unary,Ee)),q=Ge(q,re)),q.push(V),q.push(this.generateStatement(B.body,yt)),q},DirectiveStatement:function(B,te){return se.raw&&B.raw?B.raw+this.semicolon(te):Te(B.directive)+this.semicolon(te)},DoWhileStatement:function(B,te){var q=Ge("do",this.maybeBlock(B.body,bt));return q=this.maybeBlockSuffix(B.body,q),Ge(q,["while"+V+"(",this.generateExpression(B.test,o.Sequence,Ee),")"+this.semicolon(te)])},CatchClause:function(B,te){var q,re=this;return it(function(){var ue;B.param?(q=["catch"+V+"(",re.generateExpression(B.param,o.Sequence,Ee),")"],B.guard&&(ue=re.generateExpression(B.guard,o.Sequence,Ee),q.splice(2,0," if ",ue))):q=["catch"]}),q.push(this.maybeBlock(B.body,bt)),q},DebuggerStatement:function(B,te){return"debugger"+this.semicolon(te)},EmptyStatement:function(B,te){return";"},ExportDefaultDeclaration:function(B,te){var q=["export"],re;return re=te&Se?yt:bt,q=Ge(q,"default"),Pe(B.declaration)?q=Ge(q,this.generateStatement(B.declaration,re)):q=Ge(q,this.generateExpression(B.declaration,o.Assignment,Ee)+this.semicolon(te)),q},ExportNamedDeclaration:function(B,te){var q=["export"],re,ue=this;return re=te&Se?yt:bt,B.declaration?Ge(q,this.generateStatement(B.declaration,re)):(B.specifiers&&(B.specifiers.length===0?q=Ge(q,"{"+V+"}"):B.specifiers[0].type===t.ExportBatchSpecifier?q=Ge(q,this.generateExpression(B.specifiers[0],o.Sequence,Ee)):(q=Ge(q,"{"),it(function(ke){var Be,Ve;for(q.push(U),Be=0,Ve=B.specifiers.length;Be<Ve;++Be)q.push(ke),q.push(ue.generateExpression(B.specifiers[Be],o.Sequence,Ee)),Be+1<Ve&&q.push(","+U)}),$t(De(q).toString())||q.push(U),q.push(M+"}")),B.source?q=Ge(q,["from"+V,this.generateExpression(B.source,o.Sequence,Ee),this.semicolon(te)]):q.push(this.semicolon(te))),q)},ExportAllDeclaration:function(B,te){return["export"+V,"*"+V,"from"+V,this.generateExpression(B.source,o.Sequence,Ee),this.semicolon(te)]},ExpressionStatement:function(B,te){var q,re;function ue(Ve){var nt;return Ve.slice(0,5)!=="class"?!1:(nt=Ve.charCodeAt(5),nt===123||b.code.isWhiteSpace(nt)||b.code.isLineTerminator(nt))}function ke(Ve){var nt;return Ve.slice(0,8)!=="function"?!1:(nt=Ve.charCodeAt(8),nt===40||b.code.isWhiteSpace(nt)||nt===42||b.code.isLineTerminator(nt))}function Be(Ve){var nt,Lt,Jt;if(Ve.slice(0,5)!=="async"||!b.code.isWhiteSpace(Ve.charCodeAt(5)))return!1;for(Lt=6,Jt=Ve.length;Lt<Jt&&b.code.isWhiteSpace(Ve.charCodeAt(Lt));++Lt);return Lt===Jt||Ve.slice(Lt,Lt+8)!=="function"?!1:(nt=Ve.charCodeAt(Lt+8),nt===40||b.code.isWhiteSpace(nt)||nt===42||b.code.isLineTerminator(nt))}return q=[this.generateExpression(B.expression,o.Sequence,Ee)],re=De(q).toString(),re.charCodeAt(0)===123||ue(re)||ke(re)||Be(re)||he&&te&ye&&B.expression.type===t.Literal&&typeof B.expression.value=="string"?q=["(",q,")"+this.semicolon(te)]:q.push(this.semicolon(te)),q},ImportDeclaration:function(B,te){var q,re,ue=this;return B.specifiers.length===0?["import",V,this.generateExpression(B.source,o.Sequence,Ee),this.semicolon(te)]:(q=["import"],re=0,B.specifiers[re].type===t.ImportDefaultSpecifier&&(q=Ge(q,[this.generateExpression(B.specifiers[re],o.Sequence,Ee)]),++re),B.specifiers[re]&&(re!==0&&q.push(","),B.specifiers[re].type===t.ImportNamespaceSpecifier?q=Ge(q,[V,this.generateExpression(B.specifiers[re],o.Sequence,Ee)]):(q.push(V+"{"),B.specifiers.length-re===1?(q.push(V),q.push(this.generateExpression(B.specifiers[re],o.Sequence,Ee)),q.push(V+"}"+V)):(it(function(ke){var Be,Ve;for(q.push(U),Be=re,Ve=B.specifiers.length;Be<Ve;++Be)q.push(ke),q.push(ue.generateExpression(B.specifiers[Be],o.Sequence,Ee)),Be+1<Ve&&q.push(","+U)}),$t(De(q).toString())||q.push(U),q.push(M+"}"+V)))),q=Ge(q,["from"+V,this.generateExpression(B.source,o.Sequence,Ee),this.semicolon(te)]),q)},VariableDeclarator:function(B,te){var q=te&Le?Ee:st;return B.init?[this.generateExpression(B.id,o.Assignment,q),V,"=",V,this.generateExpression(B.init,o.Assignment,q)]:this.generatePattern(B.id,o.Assignment,q)},VariableDeclaration:function(B,te){var q,re,ue,ke,Be,Ve=this;q=[B.kind],Be=te&Le?bt:At;function nt(){for(ke=B.declarations[0],se.comment&&ke.leadingComments?(q.push(`
`),q.push(He(Ve.generateStatement(ke,Be)))):(q.push(Ie()),q.push(Ve.generateStatement(ke,Be))),re=1,ue=B.declarations.length;re<ue;++re)ke=B.declarations[re],se.comment&&ke.leadingComments?(q.push(","+U),q.push(He(Ve.generateStatement(ke,Be)))):(q.push(","+V),q.push(Ve.generateStatement(ke,Be)))}return B.declarations.length>1?it(nt):nt(),q.push(this.semicolon(te)),q},ThrowStatement:function(B,te){return[Ge("throw",this.generateExpression(B.argument,o.Sequence,Ee)),this.semicolon(te)]},TryStatement:function(B,te){var q,re,ue,ke;if(q=["try",this.maybeBlock(B.block,bt)],q=this.maybeBlockSuffix(B.block,q),B.handlers)for(re=0,ue=B.handlers.length;re<ue;++re)q=Ge(q,this.generateStatement(B.handlers[re],bt)),(B.finalizer||re+1!==ue)&&(q=this.maybeBlockSuffix(B.handlers[re].body,q));else{for(ke=B.guardedHandlers||[],re=0,ue=ke.length;re<ue;++re)q=Ge(q,this.generateStatement(ke[re],bt)),(B.finalizer||re+1!==ue)&&(q=this.maybeBlockSuffix(ke[re].body,q));if(B.handler)if(Array.isArray(B.handler))for(re=0,ue=B.handler.length;re<ue;++re)q=Ge(q,this.generateStatement(B.handler[re],bt)),(B.finalizer||re+1!==ue)&&(q=this.maybeBlockSuffix(B.handler[re].body,q));else q=Ge(q,this.generateStatement(B.handler,bt)),B.finalizer&&(q=this.maybeBlockSuffix(B.handler.body,q))}return B.finalizer&&(q=Ge(q,["finally",this.maybeBlock(B.finalizer,bt)])),q},SwitchStatement:function(B,te){var q,re,ue,ke,Be,Ve=this;if(it(function(){q=["switch"+V+"(",Ve.generateExpression(B.discriminant,o.Sequence,Ee),")"+V+"{"+U]}),B.cases)for(Be=bt,ue=0,ke=B.cases.length;ue<ke;++ue)ue===ke-1&&(Be|=Se),re=He(this.generateStatement(B.cases[ue],Be)),q.push(re),$t(De(re).toString())||q.push(U);return q.push(He("}")),q},SwitchCase:function(B,te){var q,re,ue,ke,Be,Ve=this;return it(function(){for(B.test?q=[Ge("case",Ve.generateExpression(B.test,o.Sequence,Ee)),":"]:q=["default:"],ue=0,ke=B.consequent.length,ke&&B.consequent[0].type===t.BlockStatement&&(re=Ve.maybeBlock(B.consequent[0],bt),q.push(re),ue=1),ue!==ke&&!$t(De(q).toString())&&q.push(U),Be=bt;ue<ke;++ue)ue===ke-1&&te&Se&&(Be|=Se),re=He(Ve.generateStatement(B.consequent[ue],Be)),q.push(re),ue+1!==ke&&!$t(De(re).toString())&&q.push(U)}),q},IfStatement:function(B,te){var q,re,ue,ke=this;return it(function(){q=["if"+V+"(",ke.generateExpression(B.test,o.Sequence,Ee),")"]}),ue=te&Se,re=bt,ue&&(re|=Se),B.alternate?(q.push(this.maybeBlock(B.consequent,bt)),q=this.maybeBlockSuffix(B.consequent,q),B.alternate.type===t.IfStatement?q=Ge(q,["else ",this.generateStatement(B.alternate,re)]):q=Ge(q,Ge("else",this.maybeBlock(B.alternate,re)))):q.push(this.maybeBlock(B.consequent,re)),q},ForStatement:function(B,te){var q,re=this;return it(function(){q=["for"+V+"("],B.init?B.init.type===t.VariableDeclaration?q.push(re.generateStatement(B.init,At)):(q.push(re.generateExpression(B.init,o.Sequence,st)),q.push(";")):q.push(";"),B.test&&(q.push(V),q.push(re.generateExpression(B.test,o.Sequence,Ee))),q.push(";"),B.update&&(q.push(V),q.push(re.generateExpression(B.update,o.Sequence,Ee))),q.push(")")}),q.push(this.maybeBlock(B.body,te&Se?yt:bt)),q},ForInStatement:function(B,te){return this.generateIterationForStatement("in",B,te&Se?yt:bt)},ForOfStatement:function(B,te){return this.generateIterationForStatement("of",B,te&Se?yt:bt)},LabeledStatement:function(B,te){return[B.label.name+":",this.maybeBlock(B.body,te&Se?yt:bt)]},Program:function(B,te){var q,re,ue,ke,Be;for(ke=B.body.length,q=[ie&&ke>0?`
`:""],Be=Et,ue=0;ue<ke;++ue)!ie&&ue===ke-1&&(Be|=Se),ve&&(ue===0&&(B.body[0].leadingComments||It(B.range[0],B.body[ue].range[0],q)),ue>0&&!B.body[ue-1].trailingComments&&!B.body[ue].leadingComments&&It(B.body[ue-1].range[1],B.body[ue].range[0],q)),re=He(this.generateStatement(B.body[ue],Be)),q.push(re),ue+1<ke&&!$t(De(re).toString())&&(ve&&B.body[ue+1].leadingComments||q.push(U)),ve&&ue===ke-1&&(B.body[ue].trailingComments||It(B.body[ue].range[1],B.range[1],q));return q},FunctionDeclaration:function(B,te){return[Mt(B,!0),"function",Zt(B)||Ie(),B.id?Ct(B.id):"",this.generateFunctionBody(B)]},ReturnStatement:function(B,te){return B.argument?[Ge("return",this.generateExpression(B.argument,o.Sequence,Ee)),this.semicolon(te)]:["return"+this.semicolon(te)]},WhileStatement:function(B,te){var q,re=this;return it(function(){q=["while"+V+"(",re.generateExpression(B.test,o.Sequence,Ee),")"]}),q.push(this.maybeBlock(B.body,te&Se?yt:bt)),q},WithStatement:function(B,te){var q,re=this;return it(function(){q=["with"+V+"(",re.generateExpression(B.object,o.Sequence,Ee),")"]}),q.push(this.maybeBlock(B.body,te&Se?yt:bt)),q}},sn(tt.prototype,tt.Statement),tt.Expression={SequenceExpression:function(B,te,q){var re,ue,ke;for(o.Sequence<te&&(q|=Le),re=[],ue=0,ke=B.expressions.length;ue<ke;++ue)re.push(this.generateExpression(B.expressions[ue],o.Assignment,q)),ue+1<ke&&re.push(","+V);return Qe(re,o.Sequence,te)},AssignmentExpression:function(B,te,q){return this.generateAssignment(B.left,B.right,B.operator,te,q)},ArrowFunctionExpression:function(B,te,q){return Qe(this.generateFunctionBody(B),o.ArrowFunction,te)},ConditionalExpression:function(B,te,q){return o.Conditional<te&&(q|=Le),Qe([this.generateExpression(B.test,o.Coalesce,q),V+"?"+V,this.generateExpression(B.consequent,o.Assignment,q),V+":"+V,this.generateExpression(B.alternate,o.Assignment,q)],o.Conditional,te)},LogicalExpression:function(B,te,q){return B.operator==="??"&&(q|=qe),this.BinaryExpression(B,te,q)},BinaryExpression:function(B,te,q){var re,ue,ke,Be,Ve,nt;return Be=u[B.operator],ue=B.operator==="**"?o.Postfix:Be,ke=B.operator==="**"?Be:Be+1,Be<te&&(q|=Le),Ve=this.generateExpression(B.left,ue,q),nt=Ve.toString(),nt.charCodeAt(nt.length-1)===47&&b.code.isIdentifierPartES5(B.operator.charCodeAt(0))?re=[Ve,Ie(),B.operator]:re=Ge(Ve,B.operator),Ve=this.generateExpression(B.right,ke,q),B.operator==="/"&&Ve.toString().charAt(0)==="/"||B.operator.slice(-1)==="<"&&Ve.toString().slice(0,3)==="!--"?(re.push(Ie()),re.push(Ve)):re=Ge(re,Ve),B.operator==="in"&&!(q&Le)?["(",re,")"]:(B.operator==="||"||B.operator==="&&")&&q&qe?["(",re,")"]:Qe(re,Be,te)},CallExpression:function(B,te,q){var re,ue,ke;for(re=[this.generateExpression(B.callee,o.Call,mt)],B.optional&&re.push("?."),re.push("("),ue=0,ke=B.arguments.length;ue<ke;++ue)re.push(this.generateExpression(B.arguments[ue],o.Assignment,Ee)),ue+1<ke&&re.push(","+V);return re.push(")"),q&Xe?Qe(re,o.Call,te):["(",re,")"]},ChainExpression:function(B,te,q){o.OptionalChaining<te&&(q|=Xe);var re=this.generateExpression(B.expression,o.OptionalChaining,q);return Qe(re,o.OptionalChaining,te)},NewExpression:function(B,te,q){var re,ue,ke,Be,Ve;if(ue=B.arguments.length,Ve=q&Ke&&!z&&ue===0?pt:rt,re=Ge("new",this.generateExpression(B.callee,o.New,Ve)),!(q&Ke)||z||ue>0){for(re.push("("),ke=0,Be=ue;ke<Be;++ke)re.push(this.generateExpression(B.arguments[ke],o.Assignment,Ee)),ke+1<Be&&re.push(","+V);re.push(")")}return Qe(re,o.New,te)},MemberExpression:function(B,te,q){var re,ue;return re=[this.generateExpression(B.object,o.Call,q&Xe?mt:rt)],B.computed?(B.optional&&re.push("?."),re.push("["),re.push(this.generateExpression(B.property,o.Sequence,q&Xe?Ee:pt)),re.push("]")):(!B.optional&&B.object.type===t.Literal&&typeof B.object.value=="number"&&(ue=De(re).toString(),ue.indexOf(".")<0&&!/[eExX]/.test(ue)&&b.code.isDecimalDigit(ue.charCodeAt(ue.length-1))&&!(ue.length>=2&&ue.charCodeAt(0)===48)&&re.push(" ")),re.push(B.optional?"?.":"."),re.push(Ct(B.property))),Qe(re,o.Member,te)},MetaProperty:function(B,te,q){var re;return re=[],re.push(typeof B.meta=="string"?B.meta:Ct(B.meta)),re.push("."),re.push(typeof B.property=="string"?B.property:Ct(B.property)),Qe(re,o.Member,te)},UnaryExpression:function(B,te,q){var re,ue,ke,Be,Ve;return ue=this.generateExpression(B.argument,o.Unary,Ee),V===""?re=Ge(B.operator,ue):(re=[B.operator],B.operator.length>2?re=Ge(re,ue):(Be=De(re).toString(),Ve=Be.charCodeAt(Be.length-1),ke=ue.toString().charCodeAt(0),((Ve===43||Ve===45)&&Ve===ke||b.code.isIdentifierPartES5(Ve)&&b.code.isIdentifierPartES5(ke))&&re.push(Ie()),re.push(ue))),Qe(re,o.Unary,te)},YieldExpression:function(B,te,q){var re;return B.delegate?re="yield*":re="yield",B.argument&&(re=Ge(re,this.generateExpression(B.argument,o.Yield,Ee))),Qe(re,o.Yield,te)},AwaitExpression:function(B,te,q){var re=Ge(B.all?"await*":"await",this.generateExpression(B.argument,o.Await,Ee));return Qe(re,o.Await,te)},UpdateExpression:function(B,te,q){return B.prefix?Qe([B.operator,this.generateExpression(B.argument,o.Unary,Ee)],o.Unary,te):Qe([this.generateExpression(B.argument,o.Postfix,Ee),B.operator],o.Postfix,te)},FunctionExpression:function(B,te,q){var re=[Mt(B,!0),"function"];return B.id?(re.push(Zt(B)||Ie()),re.push(Ct(B.id))):re.push(Zt(B)||V),re.push(this.generateFunctionBody(B)),re},ArrayPattern:function(B,te,q){return this.ArrayExpression(B,te,q,!0)},ArrayExpression:function(B,te,q,re){var ue,ke,Be=this;return B.elements.length?(ke=re?!1:B.elements.length>1,ue=["[",ke?U:""],it(function(Ve){var nt,Lt;for(nt=0,Lt=B.elements.length;nt<Lt;++nt)B.elements[nt]?(ue.push(ke?Ve:""),ue.push(Be.generateExpression(B.elements[nt],o.Assignment,Ee))):(ke&&ue.push(Ve),nt+1===Lt&&ue.push(",")),nt+1<Lt&&ue.push(","+(ke?U:V))}),ke&&!$t(De(ue).toString())&&ue.push(U),ue.push(ke?M:""),ue.push("]"),ue):"[]"},RestElement:function(B,te,q){return"..."+this.generatePattern(B.argument)},ClassExpression:function(B,te,q){var re,ue;return re=["class"],B.id&&(re=Ge(re,this.generateExpression(B.id,o.Sequence,Ee))),B.superClass&&(ue=Ge("extends",this.generateExpression(B.superClass,o.Unary,Ee)),re=Ge(re,ue)),re.push(V),re.push(this.generateStatement(B.body,yt)),re},MethodDefinition:function(B,te,q){var re,ue;return B.static?re=["static"+V]:re=[],B.kind==="get"||B.kind==="set"?ue=[Ge(B.kind,this.generatePropertyKey(B.key,B.computed)),this.generateFunctionBody(B.value)]:ue=[nn(B),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)],Ge(re,ue)},Property:function(B,te,q){return B.kind==="get"||B.kind==="set"?[B.kind,Ie(),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)]:B.shorthand?B.value.type==="AssignmentPattern"?this.AssignmentPattern(B.value,o.Sequence,Ee):this.generatePropertyKey(B.key,B.computed):B.method?[nn(B),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)]:[this.generatePropertyKey(B.key,B.computed),":"+V,this.generateExpression(B.value,o.Assignment,Ee)]},ObjectExpression:function(B,te,q){var re,ue,ke,Be=this;return B.properties.length?(re=B.properties.length>1,it(function(){ke=Be.generateExpression(B.properties[0],o.Sequence,Ee)}),!re&&!_t(De(ke).toString())?["{",V,ke,V,"}"]:(it(function(Ve){var nt,Lt;if(ue=["{",U,Ve,ke],re)for(ue.push(","+U),nt=1,Lt=B.properties.length;nt<Lt;++nt)ue.push(Ve),ue.push(Be.generateExpression(B.properties[nt],o.Sequence,Ee)),nt+1<Lt&&ue.push(","+U)}),$t(De(ue).toString())||ue.push(U),ue.push(M),ue.push("}"),ue)):"{}"},AssignmentPattern:function(B,te,q){return this.generateAssignment(B.left,B.right,"=",te,q)},ObjectPattern:function(B,te,q){var re,ue,ke,Be,Ve,nt=this;if(!B.properties.length)return"{}";if(Be=!1,B.properties.length===1)Ve=B.properties[0],Ve.type===t.Property&&Ve.value.type!==t.Identifier&&(Be=!0);else for(ue=0,ke=B.properties.length;ue<ke;++ue)if(Ve=B.properties[ue],Ve.type===t.Property&&!Ve.shorthand){Be=!0;break}return re=["{",Be?U:""],it(function(Lt){var Jt,Rn;for(Jt=0,Rn=B.properties.length;Jt<Rn;++Jt)re.push(Be?Lt:""),re.push(nt.generateExpression(B.properties[Jt],o.Sequence,Ee)),Jt+1<Rn&&re.push(","+(Be?U:V))}),Be&&!$t(De(re).toString())&&re.push(U),re.push(Be?M:""),re.push("}"),re},ThisExpression:function(B,te,q){return"this"},Super:function(B,te,q){return"super"},Identifier:function(B,te,q){return Ct(B)},ImportDefaultSpecifier:function(B,te,q){return Ct(B.id||B.local)},ImportNamespaceSpecifier:function(B,te,q){var re=["*"],ue=B.id||B.local;return ue&&re.push(V+"as"+Ie()+Ct(ue)),re},ImportSpecifier:function(B,te,q){var re=B.imported,ue=[re.name],ke=B.local;return ke&&ke.name!==re.name&&ue.push(Ie()+"as"+Ie()+Ct(ke)),ue},ExportSpecifier:function(B,te,q){var re=B.local,ue=[re.name],ke=B.exported;return ke&&ke.name!==re.name&&ue.push(Ie()+"as"+Ie()+Ct(ke)),ue},Literal:function(B,te,q){var re;if(B.hasOwnProperty("raw")&&ee&&se.raw)try{if(re=ee(B.raw).body[0].expression,re.type===t.Literal&&re.value===B.value)return B.raw}catch{}return B.regex?"/"+B.regex.pattern+"/"+B.regex.flags:typeof B.value=="bigint"?B.value.toString()+"n":B.bigint?B.bigint+"n":B.value===null?"null":typeof B.value=="string"?ze(B.value):typeof B.value=="number"?Ot(B.value):typeof B.value=="boolean"?B.value?"true":"false":Ae(B.value)},GeneratorExpression:function(B,te,q){return this.ComprehensionExpression(B,te,q)},ComprehensionExpression:function(B,te,q){var re,ue,ke,Be,Ve=this;return re=B.type===t.GeneratorExpression?["("]:["["],se.moz.comprehensionExpressionStartsWithAssignment&&(Be=this.generateExpression(B.body,o.Assignment,Ee),re.push(Be)),B.blocks&&it(function(){for(ue=0,ke=B.blocks.length;ue<ke;++ue)Be=Ve.generateExpression(B.blocks[ue],o.Sequence,Ee),ue>0||se.moz.comprehensionExpressionStartsWithAssignment?re=Ge(re,Be):re.push(Be)}),B.filter&&(re=Ge(re,"if"+V),Be=this.generateExpression(B.filter,o.Sequence,Ee),re=Ge(re,["(",Be,")"])),se.moz.comprehensionExpressionStartsWithAssignment||(Be=this.generateExpression(B.body,o.Assignment,Ee),re=Ge(re,Be)),re.push(B.type===t.GeneratorExpression?")":"]"),re},ComprehensionBlock:function(B,te,q){var re;return B.left.type===t.VariableDeclaration?re=[B.left.kind,Ie(),this.generateStatement(B.left.declarations[0],At)]:re=this.generateExpression(B.left,o.Call,Ee),re=Ge(re,B.of?"of":"in"),re=Ge(re,this.generateExpression(B.right,o.Sequence,Ee)),["for"+V+"(",re,")"]},SpreadElement:function(B,te,q){return["...",this.generateExpression(B.argument,o.Assignment,Ee)]},TaggedTemplateExpression:function(B,te,q){var re=mt;q&Xe||(re=rt);var ue=[this.generateExpression(B.tag,o.Call,re),this.generateExpression(B.quasi,o.Primary,St)];return Qe(ue,o.TaggedTemplate,te)},TemplateElement:function(B,te,q){return B.value.raw},TemplateLiteral:function(B,te,q){var re,ue,ke;for(re=["`"],ue=0,ke=B.quasis.length;ue<ke;++ue)re.push(this.generateExpression(B.quasis[ue],o.Primary,Ee)),ue+1<ke&&(re.push("${"+V),re.push(this.generateExpression(B.expressions[ue],o.Sequence,Ee)),re.push(V+"}"));return re.push("`"),re},ModuleSpecifier:function(B,te,q){return this.Literal(B,te,q)},ImportExpression:function(B,te,q){return Qe(["import(",this.generateExpression(B.source,o.Assignment,Ee),")"],o.Call,te)}},sn(tt.prototype,tt.Expression),tt.prototype.generateExpression=function(B,te,q){var re,ue;return ue=B.type||t.Property,se.verbatim&&B.hasOwnProperty(se.verbatim)?on(B,te):(re=this[ue](B,te,q),se.comment&&(re=Dt(B,re)),De(re,B))},tt.prototype.generateStatement=function(B,te){var q,re;return q=this[B.type](B,te),se.comment&&(q=Dt(B,q)),re=De(q).toString(),B.type===t.Program&&!ie&&U===""&&re.charAt(re.length-1)===`
`&&(q=pe?De(q).replaceRight(/\s+$/,""):re.replace(/\s+$/,"")),De(q,B)};function an(B){var te;if(te=new tt,Pe(B))return te.generateStatement(B,bt);if(Oe(B))return te.generateExpression(B,o.Sequence,Ee);throw new Error("Unknown node type: "+B.type)}function An(B,te){var q=jt(),re,ue;return te!=null?(typeof te.indent=="string"&&(q.format.indent.style=te.indent),typeof te.base=="number"&&(q.format.indent.base=te.base),te=kt(q,te),F=te.format.indent.style,typeof te.base=="string"?M=te.base:M=Nt(F,te.format.indent.base)):(te=q,F=te.format.indent.style,M=Nt(F,te.format.indent.base)),S=te.format.json,k=te.format.renumber,N=S?!1:te.format.hexadecimal,$=S?"double":te.format.quotes,R=te.format.escapeless,U=te.format.newline,V=te.format.space,te.format.compact&&(U=V=F=M=""),z=te.format.parentheses,K=te.format.semicolons,ie=te.format.safeConcatenation,he=te.directive,ee=S?null:te.parse,pe=te.sourceMap,_e=te.sourceCode,ve=te.format.preserveBlankLines&&_e!==null,se=te,pe&&(e.browser?p=commonjsGlobal.sourceMap.SourceNode:p=requireSourceMap().SourceNode),re=an(B),pe?(ue=re.toStringWithSourceMap({file:te.file,sourceRoot:te.sourceMapRoot}),te.sourceContent&&ue.map.setSourceContent(te.sourceMap,te.sourceContent),te.sourceMapWithCode?ue:ue.map.toString()):(ue={code:re.toString(),map:null},te.sourceMapWithCode?ue:ue.code)}we={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},xe=jt().format,e.version=require$$3.version,e.generate=An,e.attachComments=f.attachComments,e.Precedence=kt({},o),e.browser=!1,e.FORMAT_MINIFY=we,e.FORMAT_DEFAULTS=xe})()})(escodegen$1)),escodegen$1}var escodegenExports=requireEscodegen();const escodegen=getDefaultExportFromCjs(escodegenExports);class WalkerBase{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:t=>this.replacement=t}}replace(t,o,u,p){t&&o&&(u!=null?t[o][u]=p:t[o]=p)}remove(t,o,u){t&&o&&(u!=null?t[o].splice(u,1):delete t[o])}}class SyncWalker extends WalkerBase{constructor(t,o){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:u=>this.replacement=u},this.enter=t,this.leave=o}visit(t,o,u,p){if(t){if(this.enter){const b=this.should_skip,M=this.should_remove,F=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,t,o,u,p),this.replacement&&(t=this.replacement,this.replace(o,u,p,t)),this.should_remove&&this.remove(o,u,p);const S=this.should_skip,k=this.should_remove;if(this.should_skip=b,this.should_remove=M,this.replacement=F,S)return t;if(k)return null}let f;for(f in t){const b=t[f];if(b&&typeof b=="object")if(Array.isArray(b)){const M=b;for(let F=0;F<M.length;F+=1){const S=M[F];isNode(S)&&(this.visit(S,t,f,F)||F--)}}else isNode(b)&&this.visit(b,t,f,null)}if(this.leave){const b=this.replacement,M=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,t,o,u,p),this.replacement&&(t=this.replacement,this.replace(o,u,p,t)),this.should_remove&&this.remove(o,u,p);const F=this.should_remove;if(this.replacement=b,this.should_remove=M,F)return null}}return t}}function isNode(e){return e!==null&&typeof e=="object"&&"type"in e&&typeof e.type=="string"}function walk(e,{enter:t,leave:o}){return new SyncWalker(t,o).visit(e,null)}let widgetMethods=[],languages=new Map;function transpiler(e,t={}){const{wrapAsync:o=!1,addReturn:u=!0,emitMiniLocations:p=!0,emitWidgets:f=!0}=t;let b=parse$a(e,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),M=[];const F=($,R)=>{const U=languages.get("minilang");if(U){const V=`[${$}]`,z=U.getLocations(V,R.start);M=M.concat(z)}else{const V=getLeafLocations(`"${$}"`,R.start,e);M=M.concat(V)}};let S=[];walk(b,{enter($,R){if(isLanguageLiteral($)){const{name:U}=$.tag,V=languages.get(U),z=$.quasi.quasis[0].value.raw,K=$.quasi.start+1;if(p){const ie=V.getLocations(z,K);M=M.concat(ie)}return this.skip(),this.replace(languageWithLocation(U,z,K))}if(isTemplateLiteral($,"tidal")){const U=$.quasi.quasis[0].value.raw,V=$.quasi.start+1;if(p){const z=collectHaskellMiniLocations(U,V);M=M.concat(z)}return this.skip(),this.replace(tidalWithLocation(U,V))}if(isBackTickString($,R)){const{quasis:U}=$,{raw:V}=U[0].value;return this.skip(),p&&F(V,$),this.replace(miniWithLocation(V,$))}if(isStringWithDoubleQuotes($)){const{value:U}=$;return this.skip(),p&&F(U,$),this.replace(miniWithLocation(U,$))}if(isSliderFunction($))return f&&S.push({from:$.arguments[0].start,to:$.arguments[0].end,value:$.arguments[0].raw,min:$.arguments[1]?.value??0,max:$.arguments[2]?.value??1,step:$.arguments[3]?.value,type:"slider"}),this.replace(sliderWithLocation($));if(isWidgetMethod($)){const U=$.callee.property.name,V=S.filter(K=>K.type===U).length,z={to:$.end,index:V,type:U,id:t.id};return f&&S.push(z),this.replace(widgetWithLocation($,z))}if(isBareSamplesCall($,R))return this.replace(withAwait($));if(isLabelStatement($))return this.replace(labelToP($))},leave($,R,U,V){}});let{body:k}=b;if(!k.length)console.warn("empty body -> fallback to silence"),k.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!k?.[k.length-1]?.expression)throw new Error("unexpected ast format without body expression");if(u){const{expression:$}=k[k.length-1];k[k.length-1]={type:"ReturnStatement",argument:$}}let N=escodegen.generate(b);return o&&(N=`(async ()=>{${N}})()`),p?{output:N,miniLocations:M,widgets:S}:{output:N}}function isStringWithDoubleQuotes(e,t,o){return e.type!=="Literal"?!1:e.raw[0]==='"'}function isBackTickString(e,t){return e.type==="TemplateLiteral"&&t.type!=="TaggedTemplateExpression"}function miniWithLocation(e,t){const{start:o}=t,u=languages.get("minilang");let p="m";return u&&u.name&&(p=u.name),{type:"CallExpression",callee:{type:"Identifier",name:p},arguments:[{type:"Literal",value:e},{type:"Literal",value:o}],optional:!1}}function isSliderFunction(e){return e.type==="CallExpression"&&e.callee.name==="slider"}function isWidgetMethod(e){return e.type==="CallExpression"&&widgetMethods.includes(e.callee.property?.name)}function sliderWithLocation(e){const t="slider_"+e.arguments[0].start;return e.arguments.unshift({type:"Literal",value:t,raw:t}),e.callee.name="sliderWithID",e}function getWidgetID(e){return`${e.id||""}_widget_${e.type}_${e.index}`}function widgetWithLocation(e,t){const o=getWidgetID(t);return e.arguments.unshift({type:"Literal",value:o,raw:o}),e}function isBareSamplesCall(e,t){return e.type==="CallExpression"&&e.callee.name==="samples"&&t.type!=="AwaitExpression"}function withAwait(e){return{type:"AwaitExpression",argument:e}}function isLabelStatement(e){return e.type==="LabeledStatement"}function labelToP(e){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:e.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:e.label.name,raw:`'${e.label.name}'`}]}}}function isLanguageLiteral(e){return e.type==="TaggedTemplateExpression"&&languages.has(e.tag.name)}function isTemplateLiteral(e,t){return e.type==="TaggedTemplateExpression"&&e.tag.name===t}function collectHaskellMiniLocations(e,t){return e.split("").reduce((o,u,p)=>(u!=='"'||(!o.length||o[o.length-1].length>1?o.push([p+1]):o[o.length-1].push(p)),o),[]).map(([o,u])=>{const p=e.slice(o,u);return getLeafLocations(`"${p}"`,t+o-1)}).flat()}function tidalWithLocation(e,t){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}function languageWithLocation(e,t,o){return{type:"CallExpression",callee:{type:"Identifier",name:e},arguments:[{type:"Literal",value:t},{type:"Literal",value:o}],optional:!1}}const gm={gm_piano:["0000_JCLive_sf2_file","0000_FluidR3_GM_sf2_file","0000_Aspirin_sf2_file","0000_Chaos_sf2_file","0000_GeneralUserGS_sf2_file","0001_FluidR3_GM_sf2_file","0001_GeneralUserGS_sf2_file","0010_Aspirin_sf2_file","0010_Chaos_sf2_file","0010_FluidR3_GM_sf2_file","0010_GeneralUserGS_sf2_file","0010_JCLive_sf2_file","0011_Aspirin_sf2_file","0011_FluidR3_GM_sf2_file","0011_GeneralUserGS_sf2_file","0012_GeneralUserGS_sf2_file","0020_Aspirin_sf2_file","0020_Chaos_sf2_file","0020_FluidR3_GM_sf2_file","0020_GeneralUserGS_sf2_file","0020_JCLive_sf2_file","0021_Aspirin_sf2_file","0021_GeneralUserGS_sf2_file","0022_Aspirin_sf2_file","0030_Aspirin_sf2_file","0030_Chaos_sf2_file","0030_FluidR3_GM_sf2_file","0030_GeneralUserGS_sf2_file","0030_JCLive_sf2_file","0031_Aspirin_sf2_file","0031_FluidR3_GM_sf2_file","0031_GeneralUserGS_sf2_file"],gm_epiano1:["0040_JCLive_sf2_file","0040_FluidR3_GM_sf2_file","0040_Aspirin_sf2_file","0040_Chaos_sf2_file","0040_GeneralUserGS_sf2_file","0041_FluidR3_GM_sf2_file","0041_GeneralUserGS_sf2_file","0042_GeneralUserGS_sf2_file","0043_GeneralUserGS_sf2_file","0044_GeneralUserGS_sf2_file","0046_GeneralUserGS_sf2_file"],gm_epiano2:["0050_JCLive_sf2_file","0050_FluidR3_GM_sf2_file","0050_Aspirin_sf2_file","0050_Chaos_sf2_file","0050_GeneralUserGS_sf2_file","0051_FluidR3_GM_sf2_file","0051_GeneralUserGS_sf2_file","0053_GeneralUserGS_sf2_file","0054_GeneralUserGS_sf2_file"],gm_harpsichord:["0060_JCLive_sf2_file","0060_FluidR3_GM_sf2_file","0060_Aspirin_sf2_file","0060_Chaos_sf2_file","0060_GeneralUserGS_sf2_file","0061_Aspirin_sf2_file","0061_GeneralUserGS_sf2_file","0062_GeneralUserGS_sf2_file"],gm_clavinet:["0070_JCLive_sf2_file","0070_FluidR3_GM_sf2_file","0070_Aspirin_sf2_file","0070_Chaos_sf2_file"],gm_celesta:["0080_JCLive_sf2_file","0080_Aspirin_sf2_file","0080_Chaos_sf2_file","0080_FluidR3_GM_sf2_file","0080_GeneralUserGS_sf2_file","0081_FluidR3_GM_sf2_file"],gm_glockenspiel:["0090_JCLive_sf2_file","0090_Aspirin_sf2_file","0090_Chaos_sf2_file","0090_FluidR3_GM_sf2_file","0090_GeneralUserGS_sf2_file"],gm_music_box:["0100_JCLive_sf2_file","0100_Aspirin_sf2_file","0100_Chaos_sf2_file","0100_FluidR3_GM_sf2_file","0100_GeneralUserGS_sf2_file"],gm_vibraphone:["0110_JCLive_sf2_file","0110_Aspirin_sf2_file","0110_Chaos_sf2_file","0110_FluidR3_GM_sf2_file","0110_GeneralUserGS_sf2_file","0111_FluidR3_GM_sf2_file"],gm_marimba:["0120_JCLive_sf2_file","0120_Aspirin_sf2_file","0120_Chaos_sf2_file","0120_FluidR3_GM_sf2_file","0120_GeneralUserGS_sf2_file","0121_FluidR3_GM_sf2_file","0121_GeneralUserGS_sf2_file"],gm_xylophone:["0130_JCLive_sf2_file","0130_Aspirin_sf2_file","0130_Chaos_sf2_file","0130_FluidR3_GM_sf2_file","0130_GeneralUserGS_sf2_file","0131_FluidR3_GM_sf2_file"],gm_tubular_bells:["0140_JCLive_sf2_file","0140_Aspirin_sf2_file","0140_FluidR3_GM_sf2_file","0140_GeneralUserGS_sf2_file","0141_FluidR3_GM_sf2_file","0142_GeneralUserGS_sf2_file"],gm_dulcimer:["0150_Aspirin_sf2_file","0150_Chaos_sf2_file","0150_FluidR3_GM_sf2_file","0150_GeneralUserGS_sf2_file","0151_FluidR3_GM_sf2_file"],gm_drawbar_organ:["0160_JCLive_sf2_file","0160_Aspirin_sf2_file","0160_Chaos_sf2_file","0160_FluidR3_GM_sf2_file","0160_GeneralUserGS_sf2_file","0161_Aspirin_sf2_file","0161_FluidR3_GM_sf2_file"],gm_percussive_organ:["0170_JCLive_sf2_file","0170_Aspirin_sf2_file","0170_Chaos_sf2_file","0170_FluidR3_GM_sf2_file","0171_FluidR3_GM_sf2_file","0172_FluidR3_GM_sf2_file"],gm_rock_organ:["0180_JCLive_sf2_file","0180_Aspirin_sf2_file","0180_Chaos_sf2_file","0180_FluidR3_GM_sf2_file","0180_GeneralUserGS_sf2_file"],gm_church_organ:["0190_JCLive_sf2_file","0190_Aspirin_sf2_file","0190_Chaos_sf2_file","0190_FluidR3_GM_sf2_file","0190_GeneralUserGS_sf2_file"],gm_reed_organ:["0200_JCLive_sf2_file","0200_Aspirin_sf2_file","0200_Chaos_sf2_file","0200_FluidR3_GM_sf2_file","0200_GeneralUserGS_sf2_file","0201_Aspirin_sf2_file","0201_FluidR3_GM_sf2_file","0201_GeneralUserGS_sf2_file"],gm_accordion:["0210_JCLive_sf2_file","0210_FluidR3_GM_sf2_file","0210_GeneralUserGS_sf2_file","0211_Aspirin_sf2_file","0211_FluidR3_GM_sf2_file","0211_GeneralUserGS_sf2_file","0212_GeneralUserGS_sf2_file"],gm_harmonica:["0220_FluidR3_GM_sf2_file","0220_JCLive_sf2_file","0220_Aspirin_sf2_file","0220_Chaos_sf2_file","0220_GeneralUserGS_sf2_file","0221_FluidR3_GM_sf2_file"],gm_bandoneon:["0230_Aspirin_sf2_file","0230_JCLive_sf2_file","0230_Chaos_sf2_file","0230_FluidR3_GM_sf2_file","0230_GeneralUserGS_sf2_file","0231_FluidR3_GM_sf2_file","0231_GeneralUserGS_sf2_file","0231_JCLive_sf2_file","0232_FluidR3_GM_sf2_file","0233_FluidR3_GM_sf2_file"],gm_acoustic_guitar_nylon:["0240_JCLive_sf2_file","0240_Aspirin_sf2_file","0240_Chaos_sf2_file","0240_FluidR3_GM_sf2_file","0240_GeneralUserGS_sf2_file","0240_LK_Godin_Nylon_SF2_file","0241_JCLive_sf2_file","0242_JCLive_sf2_file","0243_JCLive_sf2_file"],gm_acoustic_guitar_steel:["0253_Acoustic_Guitar_sf2_file","0250_Aspirin_sf2_file","0250_Chaos_sf2_file","0250_FluidR3_GM_sf2_file","0250_GeneralUserGS_sf2_file","0250_LK_AcousticSteel_SF2_file","0253_Acoustic_Guitar_sf2_file","0253_GeneralUserGS_sf2_file","0254_Acoustic_Guitar_sf2_file","0254_GeneralUserGS_sf2_file"],gm_electric_guitar_jazz:["0260_JCLive_sf2_file","0260_Aspirin_sf2_file","0260_Chaos_sf2_file","0260_FluidR3_GM_sf2_file","0260_GeneralUserGS_sf2_file","0260_Stratocaster_sf2_file","0261_GeneralUserGS_sf2_file","0261_Stratocaster_sf2_file","0262_Stratocaster_sf2_file"],gm_electric_guitar_clean:["0270_Aspirin_sf2_file","0270_Chaos_sf2_file","0270_FluidR3_GM_sf2_file","0270_GeneralUserGS_sf2_file","0270_SBAWE32_sf2_file","0270_Stratocaster_sf2_file","0271_GeneralUserGS_sf2_file","0271_Stratocaster_sf2_file","0272_Stratocaster_sf2_file"],gm_electric_guitar_muted:["0280_Aspirin_sf2_file","0280_Chaos_sf2_file","0280_GeneralUserGS_sf2_file","0280_JCLive_sf2_file","0280_LesPaul_sf2_file","0280_SBAWE32_sf2_file","0281_Aspirin_sf2_file","0281_FluidR3_GM_sf2_file","0281_GeneralUserGS_sf2_file","0282_FluidR3_GM_sf2_file"],gm_overdriven_guitar:["0290_FluidR3_GM_sf2_file","0290_Aspirin_sf2_file","0290_Chaos_sf2_file","0290_GeneralUserGS_sf2_file","0290_LesPaul_sf2_file","0290_SBAWE32_sf2_file","0291_LesPaul_sf2_file","0291_SBAWE32_sf2_file","0292_Aspirin_sf2_file","0292_LesPaul_sf2_file"],gm_distortion_guitar:["0300_FluidR3_GM_sf2_file","0300_Aspirin_sf2_file","0300_Chaos_sf2_file","0300_GeneralUserGS_sf2_file","0300_LesPaul_sf2_file","0302_Aspirin_sf2_file","0304_Aspirin_sf2_file"],gm_guitar_harmonics:["0310_Aspirin_sf2_file","0310_FluidR3_GM_sf2_file","0310_Chaos_sf2_file"],gm_acoustic_bass:["0320_JCLive_sf2_file","0320_FluidR3_GM_sf2_file","0320_Aspirin_sf2_file","0320_Chaos_sf2_file"],gm_electric_bass_finger:["0330_JCLive_sf2_file","0330_FluidR3_GM_sf2_fible","0330_Aspirin_sf2_file","0330_GeneralUserGS_sf2_file"],gm_electric_bass_pick:["0340_JCLive_sf2_file","0340_FluidR3_GM_sf2_file","0340_Aspirin_sf2_file","0340_GeneralUserGS_sf2_file","0341_Aspirin_sf2_file"],gm_fretless_bass:["0350_Aspirin_sf2_file","0350_JCLive_sf2_file"],gm_slap_bass_1:["0360_Aspirin_sf2_file","0360_JCLive_sf2_file","0360_FluidR3_GM_sf2_file","0360_Chaos_sf2_file"],gm_slap_bass_2:["0370_Aspirin_sf2_file","0370_FluidR3_GM_sf2_file","0370_GeneralUserGS_sf2_fil e","0370_JCLive_sf2_file"],gm_synth_bass_1:["0380_Chaos_sf2_file","0380_FluidR3_GM_sf2_file","0380_JCLive_sf2_file","0381_FluidR3_GM_sf2_file","0381_GeneralUserGS_sf2_file","0382_GeneralUserGS_sf2_file","0383_GeneralUserGS_sf2_file","0384_GeneralUserGS_sf2_file","0387_GeneralUserGS_sf2_file"],gm_synth_bass_2:["0390_Aspirin_sf2_file","0390_FluidR3_GM_sf2_file","0390_GeneralUserGS_sf2_file","0390_JCLive_sf2_file","0391_FluidR3_GM_sf2_file","0392_FluidR3_GM_sf2_file","0393_GeneralUserGS_sf2_file"],gm_violin:["0400_Aspirin_sf2_file","0400_Chaos_sf2_file","0400_JCLive_sf2_file","0400_FluidR3_GM_sf2_file","0400_GeneralUserGS_sf2_file","0401_Aspirin_sf2_file","0401_FluidR3_GM_sf2_file","0401_GeneralUserGS_sf2_file","0402_GeneralUserGS_sf2_file"],gm_viola:["0410_Aspirin_sf2_file","0410_FluidR3_GM_sf2_file","0410_GeneralUserGS_sf2_file","0410_JCLive_sf2_file","0411_FluidR3_GM_sf2_file"],gm_cello:["0420_Aspirin_sf2_file","0420_FluidR3_GM_sf2_file","0420_GeneralUserGS_sf2_file","0420_JCLive_sf2_file","0421_FluidR3_GM_sf2_file","0421_GeneralUserGS_sf2_file"],gm_contrabass:["0430_Aspirin_sf2_file","0430_Chaos_sf2_file","0430_GeneralUserGS_sf2_file"],gm_tremolo_strings:["0440_Aspirin_sf2_file","0440_Chaos_sf2_file","0440_GeneralUserGS_sf2_file","0440_JCLive_sf2_file","0441_GeneralUserGS_sf2_file","0442_GeneralUserGS_sf2_file"],gm_pizzicato_strings:["0450_Aspirin_sf2_file","0450_Chaos_sf2_file","0450_FluidR3_GM_sf2_file","0450_GeneralUserGS_sf2_file","0450_JCLive_sf2_file","0451_FluidR3_GM_sf2_file"],gm_orchestral_harp:["0460_Aspirin_sf2_file","0460_FluidR3_GM_sf2_file","0460_GeneralUserGS_sf2_file","0460_JCLive_sf2_file","0461_FluidR3_GM_sf2_file"],gm_timpani:["0470_Aspirin_sf2_file","0470_Chaos_sf2_file","0470_FluidR3_GM_sf2_file","0470_GeneralUserGS_sf2_file","0471_FluidR3_GM_sf2_file","0471_GeneralUserGS_sf2_file"],gm_string_ensemble_1:["0480_Aspirin_sf2_file","0480_Chaos_sf2_file","0480_FluidR3_GM_sf2_file","0480_GeneralUserGS_sf2_file","0480_JCLive_sf2_file","0481_Aspirin_sf2_file","0481_FluidR3_GM_sf2_file","0481_GeneralUserGS_sf2_file","0482_Aspirin_sf2_file","0482_GeneralUserGS_sf2_file","0483_GeneralUserGS_sf2_file"],gm_string_ensemble_2:["0490_Aspirin_sf2_file","0490_Chaos_sf2_file","0490_FluidR3_GM_sf2_file","0490_GeneralUserGS_sf2_file","0490_JCLive_sf2_file","0491_GeneralUserGS_sf2_file","0492_GeneralUserGS_sf2_file"],gm_synth_strings_1:["0500_Aspirin_sf2_file","0500_GeneralUserGS_sf2_file","0500_JCLive_sf2_file","0501_FluidR3_GM_sf2_file","0502_GeneralUserGS_sf2_file","0503_FluidR3_GM_sf2_file","0505_FluidR3_GM_sf2_file"],gm_synth_strings_2:["0510_Aspirin_sf2_file","0510_Chaos_sf2_file","0510_GeneralUserGS_sf2_file","0511_GeneralUserGS_sf2_file"],gm_choir_aahs:["0520_Aspirin_sf2_file","0520_Chaos_sf2_file","0520_FluidR3_GM_sf2_file","0520_GeneralUserGS_sf2_file","0520_JCLive_sf2_file","0520_Soul_Ahhs_sf2_file","0521_FluidR3_GM_sf2_file","0521_Soul_Ahhs_sf2_file","0522_Soul_Ahhs_sf2_file"],gm_voice_oohs:["0530_Aspirin_sf2_file","0530_Chaos_sf2_file","0530_FluidR3_GM_sf2_file","0530_GeneralUserGS_sf2_file","0531_FluidR3_GM_sf2_file","0531_JCLive_sf2_file"],gm_synth_choir:["0540_Aspirin_sf2_file","0540_Chaos_sf2_file","0540_FluidR3_GM_sf2_file","0540_GeneralUserGS_sf2_file","0541_FluidR3_GM_sf2_file"],gm_orchestra_hit:["0550_Aspirin_sf2_file","0550_Chaos_sf2_file","0550_FluidR3_GM_sf2_file","0550_GeneralUserGS_sf2_file","0551_FluidR3_GM_sf2_file"],gm_trumpet:["0560_FluidR3_GM_sf2_file","0560_JCLive_sf2_file","0560_Aspirin_sf2_file","0560_Chaos_sf2_file"],gm_trombone:["0570_Aspirin_sf2_file","0570_Chaos_sf2_file","0570_FluidR3_GM_sf2_file","0570_GeneralUserGS_sf2_file","0571_GeneralUserGS_sf2_file"],gm_tuba:["0580_FluidR3_GM_sf2_file","0580_Aspirin_sf2_file","0580_Chaos_sf2_file","0580_GeneralUserGS_sf2_file"],gm_muted_trumpet:["0590_JCLive_sf2_file","0590_Aspirin_sf2_file","0590_Chaos_sf2_file","0590_FluidR3_GM_sf2_file","0590_GeneralUserGS_sf2_file"],gm_french_horn:["0600_Aspirin_sf2_file","0600_FluidR3_GM_sf2_file","0600_GeneralUserGS_sf2_file","0600_JCLive_sf2_file","0601_FluidR3_GM_sf2_file"],gm_brass_section:["0610_JCLive_sf2_file","0610_Aspirin_sf2_file","0610_Chaos_sf2_file","0610_FluidR3_GM_sf2_file","0610_GeneralUserGS_sf2_file"],gm_synth_brass_1:["0620_Aspirin_sf2_file","0620_FluidR3_GM_sf2_file","0621_Aspirin_sf2_file","0621_FluidR3_GM_sf2_file"],gm_synth_brass_2:["0630_Aspirin_sf2_file","0630_Chaos_sf2_file","0630_FluidR3_GM_sf2_file","0630_JCLive_sf2_file","0631_FluidR3_GM_sf2_file","0632_FluidR3_GM_sf2_file","0633_FluidR3_GM_sf2_file"],gm_soprano_sax:["0640_JCLive_sf2_file","0640_Aspirin_sf2_file","0640_Chaos_sf2_file","0640_FluidR3_GM_sf2_file","0641_FluidR3_GM_sf2_file"],gm_alto_sax:["0650_JCLive_sf2_file","0650_Chaos_sf2_file","0650_FluidR3_GM_sf2_file","0650_GeneralUserGS_sf2_file","0651_Aspirin_sf2_file","0651_FluidR3_GM_sf2_file"],gm_tenor_sax:["0660_JCLive_sf2_file","0660_Aspirin_sf2_file","0660_Chaos_sf2_file","0660_GeneralUserGS_sf2_file"],gm_baritone_sax:["0670_JCLive_sf2_file","0670_Aspirin_sf2_file","0670_Chaos_sf2_file","0670_FluidR3_GM_sf2_file","0670_GeneralUserGS_sf2_file","0671_FluidR3_GM_sf2_file"],gm_oboe:["0680_JCLive_sf2_file","0680_Chaos_sf2_file","0680_FluidR3_GM_sf2_file","0680_GeneralUserGS_sf2_file","0681_FluidR3_GM_sf2_file"],gm_english_horn:["0690_JCLive_sf2_file","0690_Aspirin_sf2_file","0690_FluidR3_GM_sf2_file","0691_FluidR3_GM_sf2_file"],gm_bassoon:["0700_JCLive_sf2_file","0700_FluidR3_GM_sf2_file","0700_GeneralUserGS_sf2_file","0701_FluidR3_GM_sf2_file"],gm_clarinet:["0710_JCLive_sf2_file","0710_Aspirin_sf2_file","0710_Chaos_sf2_file","0710_FluidR3_GM_sf2_file","0710_GeneralUserGS_sf2_file","0711_FluidR3_GM_sf2_file"],gm_piccolo:["0720_JCLive_sf2_file","0720_Aspirin_sf2_file","0720_FluidR3_GM_sf2_file","0720_GeneralUserGS_sf2_file","0721_FluidR3_GM_sf2_file"],gm_flute:["0730_JCLive_sf2_file","0730_Aspirin_sf2_file","0730_FluidR3_GM_sf2_file","0730_GeneralUserGS_sf2_file","0731_FluidR3_GM_sf2_file"],gm_recorder:["0740_JCLive_sf2_file","0740_Aspirin_sf2_file","0740_Chaos_sf2_file","0740_FluidR3_GM_sf2_file","0740_GeneralUserGS_sf2_file"],gm_pan_flute:["0750_JCLive_sf2_file","0750_FluidR3_GM_sf2_file","0750_Aspirin_sf2_file","0750_Chaos_sf2_file","0750_GeneralUserGS_sf2_file","0751_Aspirin_sf2_file","0751_FluidR3_GM_sf2_file","0751_GeneralUserGS_sf2_file"],gm_blown_bottle:["0760_FluidR3_GM_sf2_file","0760_JCLive_sf2_file","0760_Chaos_sf2_file","0760_GeneralUserGS_sf2_file","0761_FluidR3_GM_sf2_file"],gm_shakuhachi:["0770_JCLive_sf2_file","0771_FluidR3_GM_sf2_file","0770_Aspirin_sf2_file","0770_FluidR3_GM_sf2_file","0770_GeneralUserGS_sf2_file"],gm_whistle:["0780_FluidR3_GM_sf2_file","0780_JCLive_sf2_file","0780_Aspirin_sf2_file","0780_Chaos_sf2_file"],gm_ocarina:["0790_FluidR3_GM_sf2_file","0790_JCLive_sf2_file","0790_Aspirin_sf2_file","0790_GeneralUserGS_sf2_file"],gm_lead_1_square:["0800_Aspirin_sf2_file","0800_Chaos_sf2_file","0800_FluidR3_GM_sf2_file"],gm_lead_2_sawtooth:["0810_JCLive_sf2_file","0810_Aspirin_sf2_file","0810_Chaos_sf2_file","0810_FluidR3_GM_sf2_file","0810_GeneralUserGS_sf2_file","0811_Aspirin_sf2_file","0811_GeneralUserGS_sf2_file"],gm_lead_3_calliope:["0820_JCLive_sf2_file","0820_Aspirin_sf2_file","0820_Chaos_sf2_file","0820_FluidR3_GM_sf2_file","0820_GeneralUserGS_sf2_file","0821_FluidR3_GM_sf2_file","0821_GeneralUserGS_sf2_file"],gm_lead_4_chiff:["0830_JCLive_sf2_file","0830_Aspirin_sf2_file","0830_FluidR3_GM_sf2_file","0830_GeneralUserGS_sf2_file","0831_FluidR3_GM_sf2_file","0831_GeneralUserGS_sf2_file"],gm_lead_5_charang:["0840_JCLive_sf2_file","0840_FluidR3_GM_sf2_file","0840_Aspirin_sf2_file","0840_Chaos_sf2_file","0840_GeneralUserGS_sf2_file","0841_Aspirin_sf2_file","0841_Chaos_sf2_file","0841_FluidR3_GM_sf2_file","0841_GeneralUserGS_sf2_file","0842_FluidR3_GM_sf2_file"],gm_lead_6_voice:["0850_JCLive_sf2_file","0850_Aspirin_sf2_file","0850_FluidR3_GM_sf2_file","0851_FluidR3_GM_sf2_file","0851_GeneralUserGS_sf2_file","0851_JCLive_sf2_file"],gm_lead_7_fifths:["0860_JCLive_sf2_file","0860_Aspirin_sf2_file","0860_Chaos_sf2_file","0860_GeneralUserGS_sf2_file","0861_Aspirin_sf2_file"],gm_lead_8_bass_lead:["0870_JCLive_sf2_file","0870_Aspirin_sf2_file","0870_Chaos_sf2_file","0870_FluidR3_GM_sf2_file","0870_GeneralUserGS_sf2_file"],gm_pad_new_age:["0880_JCLive_sf2_file","0880_Aspirin_sf2_file","0880_Chaos_sf2_file","0880_FluidR3_GM_sf2_file","0880_GeneralUserGS_sf2_file","0881_Aspirin_sf2_file","0881_FluidR3_GM_sf2_file","0881_GeneralUserGS_sf2_file","0882_Aspirin_sf2_file","0882_GeneralUserGS_sf2_file","0885_GeneralUserGS_sf2_file","0887_GeneralUserGS_sf2_file"],gm_pad_warm:["0890_JCLive_sf2_file","0890_Aspirin_sf2_file","0890_Chaos_sf2_file","0890_FluidR3_GM_sf2_file","0890_GeneralUserGS_sf2_file","0891_Aspirin_sf2_file","0891_FluidR3_GM_sf2_file"],gm_pad_poly:["0900_JCLive_sf2_file","0900_Chaos_sf2_file","0900_FluidR3_GM_sf2_file","0900_GeneralUserGS_sf2_file","0901_Aspirin_sf2_file","0901_FluidR3_GM_sf2_file","0901_GeneralUserGS_sf2_file"],gm_pad_choir:["0910_FluidR3_GM_sf2_file","0910_JCLive_sf2_file","0910_Aspirin_sf2_file","0910_GeneralUserGS_sf2_file","0911_GeneralUserGS_sf2_file","0911_JCLive_sf2_file"],gm_pad_bowed:["0920_JCLive_sf2_file","0920_Aspirin_sf2_file","0920_GeneralUserGS_sf2_file","0921_Aspirin_sf2_file","0921_GeneralUserGS_sf2_file"],gm_pad_metallic:["0930_Aspirin_sf2_file","0930_Chaos_sf2_file","0930_FluidR3_GM_sf2_file","0930_GeneralUserGS_sf2_file","0931_Aspirin_sf2_file","0931_FluidR3_GM_sf2_file","0931_GeneralUserGS_sf2_file"],gm_pad_halo:["0940_Chaos_sf2_file","0940_FluidR3_GM_sf2_file","0940_GeneralUserGS_sf2_file","0940_JCLive_sf2_file","0941_Aspirin_sf2_file","0941_FluidR3_GM_sf2_file","0941_GeneralUserGS_sf2_file","0941_JCLive_sf2_file"],gm_pad_sweep:["0950_Aspirin_sf2_file","0950_Chaos_sf2_file","0950_FluidR3_GM_sf2_file","0950_GeneralUserGS_sf2_file","0950_JCLive_sf2_file","0951_FluidR3_GM_sf2_file","0951_GeneralUserGS_sf2_file"],gm_fx_rain:["0960_FluidR3_GM_sf2_file","0960_Chaos_sf2_file","0960_GeneralUserGS_sf2_file","0961_Aspirin_sf2_file","0961_FluidR3_GM_sf2_file","0962_GeneralUserGS_sf2_file"],gm_fx_soundtrack:["0970_FluidR3_GM_sf2_file","0970_Aspirin_sf2_file","0970_GeneralUserGS_sf2_file","0971_FluidR3_GM_sf2_file","0971_GeneralUserGS_sf2_file"],gm_fx_crystal:["0980_Aspirin_sf2_file","0980_JCLive_sf2_file","0980_Chaos_sf2_file","0980_GeneralUserGS_sf2_file","0981_FluidR3_GM_sf2_file","0981_Aspirin_sf2_file","0981_GeneralUserGS_sf2_file","0982_GeneralUserGS_sf2_file","0983_GeneralUserGS_sf2_file","0984_GeneralUserGS_sf2_file"],gm_fx_atmosphere:["0990_JCLive_sf2_file","0990_Aspirin_sf2_file","0990_Chaos_sf2_file","0990_FluidR3_GM_sf2_file","0990_GeneralUserGS_sf2_file","0991_Aspirin_sf2_file","0991_FluidR3_GM_sf2_file","0991_GeneralUserGS_sf2_file","0991_JCLive_sf2_file","0992_FluidR3_GM_sf2_file","0992_JCLive_sf2_file","0993_JCLive_sf2_file","0994_JCLive_sf2_file"],gm_fx_brightness:["1000_JCLive_sf2_file","1000_Aspirin_sf2_file","1000_Chaos_sf2_file","1000_FluidR3_GM_sf2_file","1000_GeneralUserGS_sf2_file","1001_Aspirin_sf2_file","1001_FluidR3_GM_sf2_file","1001_GeneralUserGS_sf2_file","1001_JCLive_sf2_file","1002_Aspirin_sf2_file","1002_FluidR3_GM_sf2_file","1002_GeneralUserGS_sf2_file"],gm_fx_goblins:["1010_FluidR3_GM_sf2_file","1010_JCLive_sf2_file","1010_Aspirin_sf2_file","1010_Chaos_sf2_file","1010_GeneralUserGS_sf2_file","1011_Aspirin_sf2_file","1011_FluidR3_GM_sf2_file","1011_JCLive_sf2_file","1012_Aspirin_sf2_file"],gm_fx_echoes:["1020_FluidR3_GM_sf2_file","1020_JCLive_sf2_file","1020_Aspirin_sf2_file","1020_Chaos_sf2_file","1020_GeneralUserGS_sf2_file","1021_Aspirin_sf2_file","1021_FluidR3_GM_sf2_file","1021_GeneralUserGS_sf2_file","1021_JCLive_sf2_file","1022_GeneralUserGS_sf2_file"],gm_fx_sci_fi:["1030_FluidR3_GM_sf2_file","1030_Aspirin_sf2_file","1030_Chaos_sf2_file","1030_GeneralUserGS_sf2_file","1030_JCLive_sf2_file","1031_Aspirin_sf2_file","1031_FluidR3_GM_sf2_file","1031_GeneralUserGS_sf2_file","1032_FluidR3_GM_sf2_file"],gm_sitar:["1040_Aspirin_sf2_file","1040_FluidR3_GM_sf2_file","1040_JCLive_sf2_file","1040_Chaos_sf2_file","1040_GeneralUserGS_sf2_file","1041_FluidR3_GM_sf2_file","1041_GeneralUserGS_sf2_file"],gm_banjo:["1050_FluidR3_GM_sf2_file","1050_JCLive_sf2_file","1050_Aspirin_sf2_file","1050_Chaos_sf2_file","1050_GeneralUserGS_sf2_file","1051_GeneralUserGS_sf2_file"],gm_shamisen:["1060_JCLive_sf2_file","1060_FluidR3_GM_sf2_file","1060_Aspirin_sf2_file","1060_Chaos_sf2_file","1060_GeneralUserGS_sf2_file","1061_FluidR3_GM_sf2_file","1061_GeneralUserGS_sf2_file"],gm_koto:["1070_FluidR3_GM_sf2_file","1070_JCLive_sf2_file","1070_Aspirin_sf2_file","1070_Chaos_sf2_file","1070_GeneralUserGS_sf2_file","1071_FluidR3_GM_sf2_file","1071_GeneralUserGS_sf2_file","1072_GeneralUserGS_sf2_file","1073_GeneralUserGS_sf2_file"],gm_kalimba:["1080_JCLive_sf2_file","1080_FluidR3_GM_sf2_file","1080_Aspirin_sf2_file","1080_Chaos_sf2_file","1080_GeneralUserGS_sf2_file"],gm_bagpipe:["1090_Aspirin_sf2_file"],gm_fiddle:["1100_JCLive_sf2_file","1100_Aspirin_sf2_file","1100_Chaos_sf2_file","1100_FluidR3_GM_sf2_file","1100_GeneralUserGS_sf2_file","1101_Aspirin_sf2_file","1101_FluidR3_GM_sf2_file","1101_GeneralUserGS_sf2_file","1102_GeneralUserGS_sf2_file"],gm_shanai:["1110_Aspirin_sf2_file","1110_FluidR3_GM_sf2_file","1110_JCLive_sf2_file","1110_Chaos_sf2_file","1110_GeneralUserGS_sf2_file"],gm_tinkle_bell:["1120_Aspirin_sf2_file"],gm_agogo:["1130_JCLive_sf2_file","1130_Aspirin_sf2_file","1130_Chaos_sf2_file","1130_FluidR3_GM_sf2_file","1130_GeneralUserGS_sf2_file","1131_FluidR3_GM_sf2_file"],gm_steel_drums:["1140_FluidR3_GM_sf2_file","1140_Aspirin_sf2_file","1140_JCLive_sf2_file","1140_Chaos_sf2_file","1140_GeneralUserGS_sf2_file","1141_FluidR3_GM_sf2_file"],gm_woodblock:["1150_JCLive_sf2_file","1150_Aspirin_sf2_file","1150_Chaos_sf2_file","1150_FluidR3_GM_sf2_file","1150_GeneralUserGS_sf2_file","1151_FluidR3_GM_sf2_file","1151_GeneralUserGS_sf2_file","1152_FluidR3_GM_sf2_file","1152_GeneralUserGS_sf2_file"],gm_taiko_drum:["1160_JCLive_sf2_file","1160_FluidR3_GM_sf2_file","1160_Aspirin_sf2_file","1160_Chaos_sf2_file","1160_GeneralUserGS_sf2_file","1161_FluidR3_GM_sf2_file","1161_GeneralUserGS_sf2_file","1162_FluidR3_GM_sf2_file","1162_GeneralUserGS_sf2_file","1163_FluidR3_GM_sf2_file"],gm_melodic_tom:["1170_JCLive_sf2_file","1170_Aspirin_sf2_file","1170_Chaos_sf2_file","1170_FluidR3_GM_sf2_file","1170_GeneralUserGS_sf2_file","1171_FluidR3_GM_sf2_file","1171_GeneralUserGS_sf2_file","1172_FluidR3_GM_sf2_file","1173_FluidR3_GM_sf2_file"],gm_synth_drum:["1180_JCLive_sf2_file","1180_Aspirin_sf2_file","1180_Chaos_sf2_file","1180_FluidR3_GM_sf2_file","1180_GeneralUserGS_sf2_file","1181_FluidR3_GM_sf2_file","1181_GeneralUserGS_sf2_file"],gm_reverse_cymbal:["1190_JCLive_sf2_file","1190_Aspirin_sf2_file","1190_Chaos_sf2_file","1190_FluidR3_GM_sf2_file","1190_GeneralUserGS_sf2_file","1191_GeneralUserGS_sf2_file","1192_GeneralUserGS_sf2_file","1193_GeneralUserGS_sf2_file","1194_GeneralUserGS_sf2_file"],gm_guitar_fret_noise:["1200_JCLive_sf2_file","1200_Aspirin_sf2_file","1200_Chaos_sf2_file","1200_FluidR3_GM_sf2_file","1200_GeneralUserGS_sf2_file","1201_Aspirin_sf2_file","1201_GeneralUserGS_sf2_file","1202_GeneralUserGS_sf2_file"],gm_breath_noise:["1210_FluidR3_GM_sf2_file","1210_JCLive_sf2_file","1210_Aspirin_sf2_file","1210_Chaos_sf2_file","1210_GeneralUserGS_sf2_file","1211_Aspirin_sf2_file","1211_GeneralUserGS_sf2_file","1212_GeneralUserGS_sf2_file"],gm_seashore:["1220_JCLive_sf2_file","1220_Aspirin_sf2_file","1220_Chaos_sf2_file","1220_FluidR3_GM_sf2_file","1220_GeneralUserGS_sf2_file","1221_Aspirin_sf2_file","1221_GeneralUserGS_sf2_file","1221_JCLive_sf2_file","1222_Aspirin_sf2_file","1222_GeneralUserGS_sf2_file","1223_Aspirin_sf2_file","1223_GeneralUserGS_sf2_file","1224_Aspirin_sf2_file","1224_GeneralUserGS_sf2_file","1225_GeneralUserGS_sf2_file","1226_GeneralUserGS_sf2_file"],gm_bird_tweet:["1230_FluidR3_GM_sf2_file","1230_JCLive_sf2_file","1230_Aspirin_sf2_file","1230_GeneralUserGS_sf2_file","1231_GeneralUserGS_sf2_file","1232_GeneralUserGS_sf2_file","1234_GeneralUserGS_sf2_file"],gm_telephone:["1240_JCLive_sf2_file","1240_Aspirin_sf2_file","1240_Chaos_sf2_file","1240_FluidR3_GM_sf2_file","1241_Aspirin_sf2_file","1242_GeneralUserGS_sf2_file","1243_Aspirin_sf2_file","1243_GeneralUserGS_sf2_file","1244_Aspirin_sf2_file","1244_GeneralUserGS_sf2_file"],gm_helicopter:["1250_JCLive_sf2_file","1250_Aspirin_sf2_file","1250_FluidR3_GM_sf2_file","1250_GeneralUserGS_sf2_file","1251_FluidR3_GM_sf2_file","1251_GeneralUserGS_sf2_file","1252_Aspirin_sf2_file","1252_FluidR3_GM_sf2_file","1252_GeneralUserGS_sf2_file","1253_GeneralUserGS_sf2_file","1254_GeneralUserGS_sf2_file","1255_GeneralUserGS_sf2_file","1256_GeneralUserGS_sf2_file","1257_GeneralUserGS_sf2_file","1258_GeneralUserGS_sf2_file","1259_GeneralUserGS_sf2_file"],gm_applause:["1260_JCLive_sf2_file","1260_Aspirin_sf2_file","1260_Chaos_sf2_file","1260_FluidR3_GM_sf2_file","1260_GeneralUserGS_sf2_file","1261_Aspirin_sf2_file","1261_GeneralUserGS_sf2_file","1262_Aspirin_sf2_file","1262_GeneralUserGS_sf2_file","1263_Aspirin_sf2_file","1263_GeneralUserGS_sf2_file","1264_Aspirin_sf2_file","1264_GeneralUserGS_sf2_file","1265_Aspirin_sf2_file","1265_GeneralUserGS_sf2_file"],gm_gunshot:["1270_JCLive_sf2_file","1270_Aspirin_sf2_file","1270_Chaos_sf2_file","1270_FluidR3_GM_sf2_file","1270_GeneralUserGS_sf2_file","1271_Aspirin_sf2_file","1271_GeneralUserGS_sf2_file","1272_Aspirin_sf2_file","1272_GeneralUserGS_sf2_file","1273_GeneralUserGS_sf2_file","1274_GeneralUserGS_sf2_file",""]};let defaultSoundfontUrl="https://felixroos.github.io/webaudiofontdata/sound",soundfontUrl=defaultSoundfontUrl,loadCache={};async function loadFont(name){if(loadCache[name])return loadCache[name];const load=async()=>{const url=`${soundfontUrl}/${name}.js`,preset=await fetch(url).then(e=>e.text());let[_,data]=preset.split("={");return eval("{"+data)};return loadCache[name]=load(),loadCache[name]}async function getFontBufferSource(e,t,o){let{note:u="c3",freq:p}=t,f;if(p)f=freqToMidi$2(p);else if(typeof u=="string")f=noteToMidi$1(u);else if(typeof u=="number")f=u;else throw new Error(`unexpected "note" type "${typeof u}"`);const{buffer:b,zone:M}=await getFontPitch(e,f,o),F=o.createBufferSource();F.buffer=b;const S=M.originalPitch-100*M.coarseTune-M.fineTune,k=1*Math.pow(2,(100*f-S)/1200);return F.playbackRate.value=k,M.loopStart>1&&M.loopStart<M.loopEnd&&(F.loop=!0,F.loopStart=M.loopStart/M.sampleRate,F.loopEnd=M.loopEnd/M.sampleRate),F}let bufferCache={};async function getFontPitch(e,t,o){const u=`${e}:::${t}`;if(bufferCache[u])return bufferCache[u];const p=async()=>{const f=await loadFont(e);if(!f)throw new Error(`Could not load soundfont ${e}`);const b=findZone(f,t);if(!b)throw new Error("no soundfont zone found for preset ",e,"pitch",t);const M=await getBuffer(b,o);if(!M)throw new Error(`no soundfont buffer found for preset ${e}, pitch: ${t}`);return{buffer:M,zone:b}};return bufferCache[u]=p(),bufferCache[u]}function findZone(e,t){return e.find(o=>o.keyRangeLow<=t&&o.keyRangeHigh+1>=t)}async function getBuffer(e,t){if(e.sample){console.warn("zone.sample untested!");const u=atob(e.sample);e.buffer=t.createBuffer(1,u.length/2,e.sampleRate);const p=e.buffer.getChannelData(0);let f,b,M;for(var o=0;o<u.length/2;o++)f=u.charCodeAt(o*2),b=u.charCodeAt(o*2+1),f<0&&(f=256+f),b<0&&(b=256+b),M=b*256+f,M>=65536/2&&(M=M-65536),p[o]=M/65536}else if(e.file){const u=e.file.length,p=new ArrayBuffer(u),f=new Uint8Array(p),b=atob(e.file);let M;for(let F=0;F<b.length;F++)M=b.charCodeAt(F),f[F]=M;return new Promise(F=>t.decodeAudioData(p,F))}}function registerSoundfonts(){Object.entries(gm).forEach(([e,t])=>{registerSound(e,async(o,u,p)=>{const[f,b,M,F]=getADSRValues([u.attack,u.decay,u.sustain,u.release]),{duration:S}=u,k=getSoundIndex$1(u.n,t.length),N=t[k],$=getAudioContext(),R=await getFontBufferSource(N,u,$);R.start(o);const U=$.createGain(),V=R.connect(U),z=o+S;getParamADSR(V.gain,f,b,M,F,0,.3,o,z,"linear");let K=z+F+.01,ie=getVibratoOscillator(R.detune,u,o);getPitchEnvelope(R.detune,u,o,z),R.stop(K);const he=se=>{};return R.onended=()=>{R.disconnect(),ie?.stop(),V.disconnect(),p()},{node:V,stop:he}},{type:"soundfont",prebake:!0,fonts:t})})}var SoundFont2={exports:{}},hasRequiredSoundFont2;function requireSoundFont2(){return hasRequiredSoundFont2||(hasRequiredSoundFont2=1,(function(e,t){(function(o,u){e.exports=u()})(window,function(){return(function(o){var u={};function p(f){if(u[f])return u[f].exports;var b=u[f]={i:f,l:!1,exports:{}};return o[f].call(b.exports,b,b.exports,p),b.l=!0,b.exports}return p.m=o,p.c=u,p.d=function(f,b,M){p.o(f,b)||Object.defineProperty(f,b,{enumerable:!0,get:M})},p.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},p.t=function(f,b){if(1&b&&(f=p(f)),8&b||4&b&&typeof f=="object"&&f&&f.__esModule)return f;var M=Object.create(null);if(p.r(M),Object.defineProperty(M,"default",{enumerable:!0,value:f}),2&b&&typeof f!="string")for(var F in f)p.d(M,F,function(S){return f[S]}.bind(null,F));return M},p.n=function(f){var b=f&&f.__esModule?function(){return f.default}:function(){return f};return p.d(b,"a",b),b},p.o=function(f,b){return Object.prototype.hasOwnProperty.call(f,b)},p.p="",p(p.s="./src/index.ts")})({"./src/chunk.ts":function(o,u,p){p.r(u),p.d(u,"SF2Chunk",function(){return R});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=p("./src/chunks/index.ts");function F(U){return(F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V})(U)}function S(U,V){for(var z=0;z<V.length;z++){var K=V[z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(U,K.key,K)}}function k(U){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(V){return V.__proto__||Object.getPrototypeOf(V)})(U)}function N(U,V){return(N=Object.setPrototypeOf||function(z,K){return z.__proto__=K,z})(U,V)}function $(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}var R=(function(U){function V(ie){var he,se,ee,pe,_e,ve;return(function(we,xe){if(!(we instanceof xe))throw new TypeError("Cannot call a class as a function")})(this,V),se=this,he=!(ee=k(V).call(this,ie.id,ie.length,ie.buffer,ie.subChunks))||F(ee)!=="object"&&typeof ee!="function"?$(se):ee,pe=$($(he)),ve=void 0,(_e="subChunks")in pe?Object.defineProperty(pe,_e,{value:ve,enumerable:!0,configurable:!0,writable:!0}):pe[_e]=ve,he.subChunks=ie.subChunks.map(function(we){return new V(we)}),he}var z,K;return(function(ie,he){if(typeof he!="function"&&he!==null)throw new TypeError("Super expression must either be null or a function");ie.prototype=Object.create(he&&he.prototype,{constructor:{value:ie,writable:!0,configurable:!0}}),he&&N(ie,he)})(V,f.RIFFChunk),z=V,(K=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new f.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var ie=this.subChunks.reduce(function(he,se){if(se.id==="ifil"||se.id==="iver"){if(se.length!==b.SF_VERSION_LENGTH)throw new f.ParseError("Invalid size for the '".concat(se.id,"' sub-chunk"));he[se.id]="".concat(se.getInt16(),".").concat(se.getInt16(2))}else he[se.id]=se.getString();return he},{});if(!ie.ifil)throw new f.ParseError("Missing required 'ifil' sub-chunk");if(!ie.INAM)throw new f.ParseError("Missing required 'INAM' sub-chunk");return{version:ie.ifil,soundEngine:ie.isng||"EMU8000",name:ie.INAM,rom:ie.irom,romVersion:ie.iver,creationDate:ie.ICRD,author:ie.IENG,product:ie.IPRD,copyright:ie.ICOP,comments:ie.ICMT,createdBy:ie.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new f.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var ie=this.subChunks[0];if(ie.id!=="smpl")throw new f.ParseError("Invalid chunk signature","'smpl'","'".concat(ie.id,"'"));return ie.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new f.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(M.getPresetHeaders)(this.subChunks[0]),presetZones:Object(M.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(M.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(M.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(M.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(M.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(M.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(M.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(M.getSampleHeaders)(this.subChunks[8])}}}])&&S(z.prototype,K),V})()},"./src/chunks/generators.ts":function(o,u,p){p.r(u),p.d(u,"getGenerators",function(){return N});var f=p("./src/riff/index.ts"),b=p("./src/types/index.ts"),M=p("./src/constants.ts"),F=[b.GeneratorType.StartAddrsOffset,b.GeneratorType.EndAddrsOffset,b.GeneratorType.StartLoopAddrsOffset,b.GeneratorType.EndLoopAddrsOffset,b.GeneratorType.StartAddrsCoarseOffset,b.GeneratorType.EndAddrsCoarseOffset,b.GeneratorType.StartLoopAddrsCoarseOffset,b.GeneratorType.KeyNum,b.GeneratorType.Velocity,b.GeneratorType.EndLoopAddrsCoarseOffset,b.GeneratorType.SampleModes,b.GeneratorType.ExclusiveClass,b.GeneratorType.OverridingRootKey],S=[b.GeneratorType.Unused1,b.GeneratorType.Unused2,b.GeneratorType.Unused3,b.GeneratorType.Unused4,b.GeneratorType.Reserved1,b.GeneratorType.Reserved2,b.GeneratorType.Reserved3],k=[b.GeneratorType.KeyRange,b.GeneratorType.VelRange],N=function($,R){if($.id!==R)throw new f.ParseError("Unexpected chunk ID","'".concat(R,"'"),"'".concat($.id,"'"));if($.length%M.SF_GENERATOR_SIZE)throw new f.ParseError("Invalid size for the '".concat(R,"' sub-chunk"));return $.iterate(function(U){var V=U.getInt16();return b.GeneratorType[V]?R==="pgen"&&F.includes(V)||R==="igen"&&S.includes(V)?null:k.includes(V)?{id:V,range:{lo:U.getByte(),hi:U.getByte()}}:{id:V,value:U.getInt16BE()}:null})}},"./src/chunks/index.ts":function(o,u,p){p.r(u);var f=p("./src/chunks/instruments/index.ts");p.d(u,"getInstrumentHeaders",function(){return f.getInstrumentHeaders});var b=p("./src/chunks/presets/index.ts");p.d(u,"getPresetHeaders",function(){return b.getPresetHeaders});var M=p("./src/chunks/samples/index.ts");p.d(u,"getSampleHeaders",function(){return M.getSampleHeaders});var F=p("./src/chunks/generators.ts");p.d(u,"getGenerators",function(){return F.getGenerators});var S=p("./src/chunks/modulators.ts");p.d(u,"getModulators",function(){return S.getModulators});var k=p("./src/chunks/zones.ts");p.d(u,"getZones",function(){return k.getZones}),p.d(u,"getItemsInZone",function(){return k.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(o,u,p){p.r(u),p.d(u,"getInstrumentHeaders",function(){return M});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=function(F){if(F.id!=="inst")throw new f.ParseError("Unexpected chunk ID","'inst'","'".concat(F.id,"'"));if(F.length%b.SF_INSTRUMENT_HEADER_SIZE)throw new f.ParseError("Invalid size for the 'inst' sub-chunk");return F.iterate(function(S){return{name:S.getString(),bagIndex:S.getInt16()}})}},"./src/chunks/instruments/index.ts":function(o,u,p){p.r(u);var f=p("./src/chunks/instruments/headers.ts");p.d(u,"getInstrumentHeaders",function(){return f.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(o,u,p){p.r(u),p.d(u,"getModulators",function(){return F});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=function(S){return{type:S>>10&63,polarity:S>>9&1,direction:S>>8&1,palette:S>>7&1,index:127&S}},F=function(S,k){if(S.id!==k)throw new f.ParseError("Unexpected chunk ID","'".concat(k,"'"),"'".concat(S.id,"'"));if(S.length%b.SF_MODULATOR_SIZE)throw new f.ParseError("Invalid size for the '".concat(k,"' sub-chunk"));return S.iterate(function(N){return{source:M(N.getInt16BE()),id:N.getInt16BE(),value:N.getInt16BE(),valueSource:M(N.getInt16BE()),transform:N.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(o,u,p){p.r(u),p.d(u,"getPresetHeaders",function(){return M});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=function(F){if(F.id!=="phdr")throw new f.ParseError("Invalid chunk ID","'phdr'","'".concat(F.id,"'"));if(F.length%b.SF_PRESET_HEADER_SIZE)throw new f.ParseError("Invalid size for the 'phdr' sub-chunk");return F.iterate(function(S){return{name:S.getString(),preset:S.getInt16(),bank:S.getInt16(),bagIndex:S.getInt16(),library:S.getUInt32(),genre:S.getUInt32(),morphology:S.getUInt32()}})}},"./src/chunks/presets/index.ts":function(o,u,p){p.r(u);var f=p("./src/chunks/presets/headers.ts");p.d(u,"getPresetHeaders",function(){return f.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(o,u,p){p.r(u),p.d(u,"getSampleHeaders",function(){return M});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=function(F){if(F.id!=="shdr")throw new f.ParseError("Unexpected chunk ID","'shdr'","'".concat(F.id,"'"));if(F.length%b.SF_SAMPLE_HEADER_SIZE)throw new f.ParseError("Invalid size for the 'shdr' sub-chunk");return F.iterate(function(S){return{name:S.getString(),start:S.getUInt32(),end:S.getUInt32(),startLoop:S.getUInt32(),endLoop:S.getUInt32(),sampleRate:S.getUInt32(),originalPitch:S.getByte(),pitchCorrection:S.getChar(),link:S.getInt16(),type:S.getInt16()}})}},"./src/chunks/samples/index.ts":function(o,u,p){p.r(u);var f=p("./src/chunks/samples/headers.ts");p.d(u,"getSampleHeaders",function(){return f.getSampleHeaders})},"./src/chunks/zones.ts":function(o,u,p){p.r(u),p.d(u,"getZones",function(){return F}),p.d(u,"getItemsInZone",function(){return S});var f=p("./src/riff/index.ts"),b=p("./src/constants.ts"),M=p("./src/types/index.ts"),F=function(R,U){if(R.id!==U)throw new f.ParseError("Unexpected chunk ID","'".concat(U,"'"),"'".concat(R.id,"'"));if(R.length%b.SF_BAG_SIZE)throw new f.ParseError("Invalid size for the '".concat(U,"' sub-chunk"));return R.iterate(function(V){return{generatorIndex:V.getInt16(),modulatorIndex:V.getInt16()}})},S=function(R,U,V,z,K,ie){for(var he=[],se=0;se<R.length;se++){for(var ee=R[se],pe=R[se+1],_e=ee.bagIndex,ve=pe?pe.bagIndex:U.length,we=[],xe=void 0,Oe=_e;Oe<ve;Oe++){var Pe=k(Oe,U,V),Le=N(Oe,U,z),Xe=Le[M.GeneratorType.KeyRange]&&Le[M.GeneratorType.KeyRange].range,Ke=Le[ie];if(Ke){var me=K[Ke.value];me&&we.push({keyRange:Xe,modulators:Pe,generators:Le,reference:me})}else Oe-_e==0&&(xe={keyRange:Xe,modulators:Pe,generators:Le})}he.push({header:ee,globalZone:xe,zones:we})}return he},k=function(R,U,V){var z=U[R],K=U[R+1],ie=z.modulatorIndex,he=K?K.modulatorIndex:U.length;return $(ie,he,V)},N=function(R,U,V){var z=U[R],K=U[R+1],ie=z.generatorIndex,he=K?K.generatorIndex:U.length;return $(ie,he,V)},$=function(R,U,V){for(var z={},K=R;K<U;K++){var ie=V[K];ie&&(z[ie.id]=ie)}return z}},"./src/constants.ts":function(o,u,p){p.r(u),p.d(u,"SF_VERSION_LENGTH",function(){return f}),p.d(u,"SF_PRESET_HEADER_SIZE",function(){return b}),p.d(u,"SF_BAG_SIZE",function(){return M}),p.d(u,"SF_MODULATOR_SIZE",function(){return F}),p.d(u,"SF_GENERATOR_SIZE",function(){return S}),p.d(u,"SF_INSTRUMENT_HEADER_SIZE",function(){return k}),p.d(u,"SF_SAMPLE_HEADER_SIZE",function(){return N}),p.d(u,"DEFAULT_SAMPLE_RATE",function(){return $});var f=4,b=38,M=4,F=10,S=4,k=22,N=46,$=22050},"./src/index.ts":function(o,u,p){p.r(u);var f=p("./src/types/index.ts");for(var b in f)b!=="default"&&(function(k){p.d(u,k,function(){return f[k]})})(b);var M=p("./src/chunk.ts");p.d(u,"SF2Chunk",function(){return M.SF2Chunk});var F=p("./src/constants.ts");p.d(u,"SF_VERSION_LENGTH",function(){return F.SF_VERSION_LENGTH}),p.d(u,"SF_PRESET_HEADER_SIZE",function(){return F.SF_PRESET_HEADER_SIZE}),p.d(u,"SF_BAG_SIZE",function(){return F.SF_BAG_SIZE}),p.d(u,"SF_MODULATOR_SIZE",function(){return F.SF_MODULATOR_SIZE}),p.d(u,"SF_GENERATOR_SIZE",function(){return F.SF_GENERATOR_SIZE}),p.d(u,"SF_INSTRUMENT_HEADER_SIZE",function(){return F.SF_INSTRUMENT_HEADER_SIZE}),p.d(u,"SF_SAMPLE_HEADER_SIZE",function(){return F.SF_SAMPLE_HEADER_SIZE}),p.d(u,"DEFAULT_SAMPLE_RATE",function(){return F.DEFAULT_SAMPLE_RATE});var S=p("./src/soundFont2.ts");p.d(u,"SoundFont2",function(){return S.SoundFont2})},"./src/riff/chunkIterator.ts":function(o,u,p){p.r(u),p.d(u,"ChunkIterator",function(){return F});var f=p("./src/utils/index.ts");function b(S,k){for(var N=0;N<k.length;N++){var $=k[N];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(S,$.key,$)}}function M(S,k,N){return k in S?Object.defineProperty(S,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):S[k]=N,S}var F=(function(){function S($){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(function(U,V){if(!(U instanceof V))throw new TypeError("Cannot call a class as a function")})(this,S),M(this,"target",[]),M(this,"chunk",void 0),M(this,"position",0),this.chunk=$,this.position=R}var k,N;return k=S,(N=[{key:"iterate",value:function($){for(;this.position<this.chunk.length;){var R=$(this);R&&this.target.push(R)}}},{key:"getString",value:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,R=Object(f.getStringFromBuffer)(this.getBuffer(this.position,$));return this.position+=$,R}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function($){this.position+=$}},{key:"getBuffer",value:function($,R){return this.chunk.buffer.subarray($,$+R)}},{key:"currentPosition",get:function(){return this.position}}])&&b(k.prototype,N),S})()},"./src/riff/index.ts":function(o,u,p){p.r(u);var f=p("./src/riff/chunkIterator.ts");p.d(u,"ChunkIterator",function(){return f.ChunkIterator});var b=p("./src/riff/parseError.ts");p.d(u,"ParseError",function(){return b.ParseError});var M=p("./src/riff/parser.ts");p.d(u,"parseBuffer",function(){return M.parseBuffer}),p.d(u,"getChunk",function(){return M.getChunk}),p.d(u,"getChunkLength",function(){return M.getChunkLength}),p.d(u,"getSubChunks",function(){return M.getSubChunks}),p.d(u,"getChunkId",function(){return M.getChunkId});var F=p("./src/riff/riffChunk.ts");p.d(u,"RIFFChunk",function(){return F.RIFFChunk})},"./src/riff/parseError.ts":function(o,u,p){function f($){return(f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})($)}function b($,R){return!R||f(R)!=="object"&&typeof R!="function"?(function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U})($):R}function M($){var R=typeof Map=="function"?new Map:void 0;return(M=function(U){if(U===null||(V=U,Function.toString.call(V).indexOf("[native code]")===-1))return U;var V;if(typeof U!="function")throw new TypeError("Super expression must either be null or a function");if(R!==void 0){if(R.has(U))return R.get(U);R.set(U,z)}function z(){return F(U,arguments,k(this).constructor)}return z.prototype=Object.create(U.prototype,{constructor:{value:z,enumerable:!1,writable:!0,configurable:!0}}),S(z,U)})($)}function F($,R,U){return(F=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}})()?Reflect.construct:function(V,z,K){var ie=[null];ie.push.apply(ie,z);var he=new(Function.bind.apply(V,ie));return K&&S(he,K.prototype),he}).apply(null,arguments)}function S($,R){return(S=Object.setPrototypeOf||function(U,V){return U.__proto__=V,U})($,R)}function k($){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})($)}p.r(u),p.d(u,"ParseError",function(){return N});var N=(function($){function R(U,V,z){return(function(K,ie){if(!(K instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,R),b(this,k(R).call(this,"".concat(U).concat(V&&z?", expected ".concat(V,", received ").concat(z):"")))}return(function(U,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(V&&V.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),V&&S(U,V)})(R,M(Error)),R})()},"./src/riff/parser.ts":function(o,u,p){p.r(u),p.d(u,"parseBuffer",function(){return F}),p.d(u,"getChunk",function(){return S}),p.d(u,"getChunkLength",function(){return k}),p.d(u,"getSubChunks",function(){return N}),p.d(u,"getChunkId",function(){return $});var f=p("./src/riff/parseError.ts"),b=p("./src/utils/buffer.ts"),M=p("./src/riff/riffChunk.ts"),F=function(R){var U=$(R);if(U!=="RIFF")throw new f.ParseError("Invalid file format","RIFF",U);var V=$(R,8);if(V!=="sfbk")throw new f.ParseError("Invalid signature","sfbk",V);var z=R.subarray(8),K=N(z.subarray(4));return new M.RIFFChunk(U,z.length,z,K)},S=function(R,U){var V=$(R,U),z=k(R,U+4),K=[];return V!=="RIFF"&&V!=="LIST"||(K=N(R.subarray(U+12))),new M.RIFFChunk(V,z,R.subarray(U+8),K)},k=function(R,U){return((R=R.subarray(U,U+4))[0]|R[1]<<8|R[2]<<16|R[3]<<24)>>>0},N=function(R){for(var U=[],V=0;V<=R.length-8;){var z=S(R,V);U.push(z),V=(V+=8+z.length)%2?V+1:V}return U},$=function(R){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(b.getStringFromBuffer)(R.subarray(U,U+4))}},"./src/riff/riffChunk.ts":function(o,u,p){p.r(u),p.d(u,"RIFFChunk",function(){return S});var f=p("./src/riff/chunkIterator.ts"),b=p("./src/utils/index.ts");function M(k,N){for(var $=0;$<N.length;$++){var R=N[$];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(k,R.key,R)}}function F(k,N,$){return N in k?Object.defineProperty(k,N,{value:$,enumerable:!0,configurable:!0,writable:!0}):k[N]=$,k}var S=(function(){function k(R,U,V,z){(function(K,ie){if(!(K instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,k),F(this,"id",void 0),F(this,"length",void 0),F(this,"buffer",void 0),F(this,"subChunks",void 0),this.id=R,this.length=U,this.buffer=V,this.subChunks=z}var N,$;return N=k,($=[{key:"getString",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1?arguments[1]:void 0;return Object(b.getStringFromBuffer)(this.getBuffer(R,U||this.length-R))}},{key:"getInt16",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R++]|this.buffer[R]<<8}},{key:"getUInt32",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[R++]|this.buffer[R++]<<8|this.buffer[R++]<<16|this.buffer[R]<<24)>>>0}},{key:"getByte",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R]}},{key:"getChar",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R]<<24>>24}},{key:"iterator",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new f.ChunkIterator(this,R)}},{key:"iterate",value:function(R){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,V=new f.ChunkIterator(this,U);return V.iterate(R),V.target}},{key:"getBuffer",value:function(R,U){return this.buffer.subarray(R,R+U)}}])&&M(N.prototype,$),k})()},"./src/soundFont2.ts":function(o,u,p){p.r(u),p.d(u,"SoundFont2",function(){return U});var f=p("./src/types/index.ts"),b=p("./src/chunk.ts"),M=p("./src/riff/index.ts"),F=p("./src/chunks/index.ts"),S=p("./src/utils/index.ts");function k(V){for(var z=1;z<arguments.length;z++){var K=arguments[z]!=null?arguments[z]:{},ie=Object.keys(K);typeof Object.getOwnPropertySymbols=="function"&&(ie=ie.concat(Object.getOwnPropertySymbols(K).filter(function(he){return Object.getOwnPropertyDescriptor(K,he).enumerable}))),ie.forEach(function(he){R(V,he,K[he])})}return V}function N(V,z){for(var K=0;K<z.length;K++){var ie=z[K];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(V,ie.key,ie)}}function $(V,z,K){return z&&N(V.prototype,z),K&&N(V,K),V}function R(V,z,K){return z in V?Object.defineProperty(V,z,{value:K,enumerable:!0,configurable:!0,writable:!0}):V[z]=K,V}var U=(function(){function V(z){if((function(ie,he){if(!(ie instanceof he))throw new TypeError("Cannot call a class as a function")})(this,V),R(this,"chunk",void 0),R(this,"metaData",void 0),R(this,"sampleData",void 0),R(this,"samples",void 0),R(this,"presetData",void 0),R(this,"instruments",void 0),R(this,"presets",void 0),R(this,"banks",void 0),!(z instanceof b.SF2Chunk)){var K=Object(M.parseBuffer)(z);z=new b.SF2Chunk(K)}if(z.subChunks.length!==3)throw new M.ParseError("Invalid sfbk structure","3 chunks","".concat(z.subChunks.length," chunks"));this.chunk=z,this.metaData=z.subChunks[0].getMetaData(),this.sampleData=z.subChunks[1].getSampleData(),this.presetData=z.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return $(V,null,[{key:"from",value:function(z){return new V(z)}}]),$(V,[{key:"getKeyData",value:function(z){var K=this,ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,he=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(S.memoize)(function(se,ee,pe){var _e=K.banks[ee];if(_e){var ve=_e.presets[pe];if(ve){var we=ve.zones.find(function(Ke){return K.isKeyInRange(Ke,se)});if(we){var xe=we.instrument,Oe=xe.zones.find(function(Ke){return K.isKeyInRange(Ke,se)});if(Oe){var Pe=Oe.sample,Le=k({},we.generators,Oe.generators),Xe=k({},we.modulators,Oe.modulators);return{keyNumber:se,preset:ve,instrument:xe,sample:Pe,generators:Le,modulators:Xe}}}}}return null})(z,ie,he)}},{key:"isKeyInRange",value:function(z,K){return z.keyRange===void 0||z.keyRange.lo<=K&&z.keyRange.hi>=K}},{key:"getBanks",value:function(){return this.presets.reduce(function(z,K){var ie=K.header.bank;return z[ie]||(z[ie]={presets:[]}),z[ie].presets[K.header.preset]=K,z},[])}},{key:"getPresets",value:function(){var z=this.presetData,K=z.presetHeaders,ie=z.presetZones,he=z.presetGenerators,se=z.presetModulators;return Object(F.getItemsInZone)(K,ie,se,he,this.instruments,f.GeneratorType.Instrument).filter(function(ee){return ee.header.name!=="EOP"}).map(function(ee){return{header:ee.header,globalZone:ee.globalZone,zones:ee.zones.map(function(pe){return{keyRange:pe.keyRange,generators:pe.generators,modulators:pe.modulators,instrument:pe.reference}})}})}},{key:"getInstruments",value:function(){var z=this.presetData,K=z.instrumentHeaders,ie=z.instrumentZones,he=z.instrumentModulators,se=z.instrumentGenerators;return Object(F.getItemsInZone)(K,ie,he,se,this.samples,f.GeneratorType.SampleId).filter(function(ee){return ee.header.name!=="EOI"}).map(function(ee){return{header:ee.header,globalZone:ee.globalZone,zones:ee.zones.map(function(pe){return{keyRange:pe.keyRange,generators:pe.generators,modulators:pe.modulators,sample:pe.reference}})}})}},{key:"getSamples",value:function(){var z=this;return this.presetData.sampleHeaders.filter(function(K){return K.name!=="EOS"}).map(function(K){if(K.name!=="EOS"&&K.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(K.sampleRate," hz in sample '").concat(K.name,"'"));return K.originalPitch>=128&&K.originalPitch<=254&&(K.originalPitch=60),K.startLoop-=K.start,K.endLoop-=K.start,{header:K,data:new Int16Array(new Uint8Array(z.sampleData.subarray(2*K.start,2*K.end)).buffer)}})}}]),V})()},"./src/types/bank.ts":function(o,u){},"./src/types/generator.ts":function(o,u,p){var f,b;function M(S,k,N){return k in S?Object.defineProperty(S,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):S[k]=N,S}p.r(u),p.d(u,"GeneratorType",function(){return b}),p.d(u,"DEFAULT_GENERATOR_VALUES",function(){return F}),(function(S){S[S.StartAddrsOffset=0]="StartAddrsOffset",S[S.EndAddrsOffset=1]="EndAddrsOffset",S[S.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",S[S.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",S[S.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",S[S.ModLFOToPitch=5]="ModLFOToPitch",S[S.VibLFOToPitch=6]="VibLFOToPitch",S[S.ModEnvToPitch=7]="ModEnvToPitch",S[S.InitialFilterFc=8]="InitialFilterFc",S[S.InitialFilterQ=9]="InitialFilterQ",S[S.ModLFOToFilterFc=10]="ModLFOToFilterFc",S[S.ModEnvToFilterFc=11]="ModEnvToFilterFc",S[S.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",S[S.ModLFOToVolume=13]="ModLFOToVolume",S[S.Unused1=14]="Unused1",S[S.ChorusEffectsSend=15]="ChorusEffectsSend",S[S.ReverbEffectsSend=16]="ReverbEffectsSend",S[S.Pan=17]="Pan",S[S.Unused2=18]="Unused2",S[S.Unused3=19]="Unused3",S[S.Unused4=20]="Unused4",S[S.DelayModLFO=21]="DelayModLFO",S[S.FreqModLFO=22]="FreqModLFO",S[S.DelayVibLFO=23]="DelayVibLFO",S[S.FreqVibLFO=24]="FreqVibLFO",S[S.DelayModEnv=25]="DelayModEnv",S[S.AttackModEnv=26]="AttackModEnv",S[S.HoldModEnv=27]="HoldModEnv",S[S.DecayModEnv=28]="DecayModEnv",S[S.SustainModEnv=29]="SustainModEnv",S[S.ReleaseModEnv=30]="ReleaseModEnv",S[S.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",S[S.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",S[S.DelayVolEnv=33]="DelayVolEnv",S[S.AttackVolEnv=34]="AttackVolEnv",S[S.HoldVolEnv=35]="HoldVolEnv",S[S.DecayVolEnv=36]="DecayVolEnv",S[S.SustainVolEnv=37]="SustainVolEnv",S[S.ReleaseVolEnv=38]="ReleaseVolEnv",S[S.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",S[S.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",S[S.Instrument=41]="Instrument",S[S.Reserved1=42]="Reserved1",S[S.KeyRange=43]="KeyRange",S[S.VelRange=44]="VelRange",S[S.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",S[S.KeyNum=46]="KeyNum",S[S.Velocity=47]="Velocity",S[S.InitialAttenuation=48]="InitialAttenuation",S[S.Reserved2=49]="Reserved2",S[S.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",S[S.CoarseTune=51]="CoarseTune",S[S.FineTune=52]="FineTune",S[S.SampleId=53]="SampleId",S[S.SampleModes=54]="SampleModes",S[S.Reserved3=55]="Reserved3",S[S.ScaleTuning=56]="ScaleTuning",S[S.ExclusiveClass=57]="ExclusiveClass",S[S.OverridingRootKey=58]="OverridingRootKey",S[S.Unused5=59]="Unused5",S[S.EndOper=60]="EndOper"})(b||(b={}));var F=(M(f={},b.StartAddrsOffset,0),M(f,b.EndAddrsOffset,0),M(f,b.StartLoopAddrsOffset,0),M(f,b.EndLoopAddrsOffset,0),M(f,b.StartAddrsCoarseOffset,0),M(f,b.ModLFOToPitch,0),M(f,b.VibLFOToPitch,0),M(f,b.ModEnvToPitch,0),M(f,b.InitialFilterFc,13500),M(f,b.InitialFilterQ,0),M(f,b.ModLFOToFilterFc,0),M(f,b.ModEnvToFilterFc,0),M(f,b.EndAddrsCoarseOffset,0),M(f,b.ModLFOToVolume,0),M(f,b.ChorusEffectsSend,0),M(f,b.ReverbEffectsSend,0),M(f,b.Pan,0),M(f,b.DelayModLFO,-12e3),M(f,b.FreqModLFO,0),M(f,b.DelayVibLFO,-12e3),M(f,b.FreqVibLFO,0),M(f,b.DelayModEnv,-12e3),M(f,b.AttackModEnv,-12e3),M(f,b.HoldModEnv,-12e3),M(f,b.DecayModEnv,-12e3),M(f,b.SustainModEnv,0),M(f,b.ReleaseModEnv,-12e3),M(f,b.KeyNumToModEnvHold,0),M(f,b.KeyNumToModEnvDecay,0),M(f,b.DelayVolEnv,-12e3),M(f,b.AttackVolEnv,-12e3),M(f,b.HoldVolEnv,-12e3),M(f,b.DecayVolEnv,-12e3),M(f,b.SustainVolEnv,0),M(f,b.ReleaseVolEnv,-12e3),M(f,b.KeyNumToVolEnvHold,0),M(f,b.KeyNumToVolEnvDecay,0),M(f,b.StartLoopAddrsCoarseOffset,0),M(f,b.KeyNum,-1),M(f,b.Velocity,-1),M(f,b.InitialAttenuation,0),M(f,b.EndLoopAddrsCoarseOffset,0),M(f,b.CoarseTune,0),M(f,b.FineTune,0),M(f,b.SampleModes,0),M(f,b.ScaleTuning,100),M(f,b.ExclusiveClass,0),M(f,b.OverridingRootKey,-1),f)},"./src/types/index.ts":function(o,u,p){p.r(u);var f=p("./src/types/bank.ts");for(var b in f)b!=="default"&&(function(z){p.d(u,z,function(){return f[z]})})(b);var M=p("./src/types/generator.ts");p.d(u,"GeneratorType",function(){return M.GeneratorType}),p.d(u,"DEFAULT_GENERATOR_VALUES",function(){return M.DEFAULT_GENERATOR_VALUES});var F=p("./src/types/instrument.ts");for(var b in F)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return F[K]})})(b);var S=p("./src/types/key.ts");for(var b in S)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return S[K]})})(b);var k=p("./src/types/metaData.ts");for(var b in k)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return k[K]})})(b);var N=p("./src/types/modulator.ts");p.d(u,"ControllerType",function(){return N.ControllerType}),p.d(u,"ControllerPolarity",function(){return N.ControllerPolarity}),p.d(u,"ControllerDirection",function(){return N.ControllerDirection}),p.d(u,"ControllerPalette",function(){return N.ControllerPalette}),p.d(u,"Controller",function(){return N.Controller}),p.d(u,"TransformType",function(){return N.TransformType}),p.d(u,"DEFAULT_INSTRUMENT_MODULATORS",function(){return N.DEFAULT_INSTRUMENT_MODULATORS});var $=p("./src/types/preset.ts");for(var b in $)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return $[K]})})(b);var R=p("./src/types/presetData.ts");for(var b in R)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return R[K]})})(b);var U=p("./src/types/sample.ts");p.d(u,"SampleType",function(){return U.SampleType});var V=p("./src/types/zone.ts");for(var b in V)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType","default"].indexOf(b)<0&&(function(K){p.d(u,K,function(){return V[K]})})(b)},"./src/types/instrument.ts":function(o,u){},"./src/types/key.ts":function(o,u){},"./src/types/metaData.ts":function(o,u){},"./src/types/modulator.ts":function(o,u,p){p.r(u),p.d(u,"ControllerType",function(){return f}),p.d(u,"ControllerPolarity",function(){return b}),p.d(u,"ControllerDirection",function(){return M}),p.d(u,"ControllerPalette",function(){return F}),p.d(u,"Controller",function(){return S}),p.d(u,"TransformType",function(){return k}),p.d(u,"DEFAULT_INSTRUMENT_MODULATORS",function(){return $});var f,b,M,F,S,k,N=p("./src/types/generator.ts");(function(R){R[R.Linear=0]="Linear",R[R.Concave=1]="Concave",R[R.Convex=2]="Convex",R[R.Switch=3]="Switch"})(f||(f={})),(function(R){R[R.Unipolar=0]="Unipolar",R[R.Bipolar=1]="Bipolar"})(b||(b={})),(function(R){R[R.Increasing=0]="Increasing",R[R.Decreasing=1]="Decreasing"})(M||(M={})),(function(R){R[R.GeneralController=0]="GeneralController",R[R.MidiController=1]="MidiController"})(F||(F={})),(function(R){R[R.NoController=0]="NoController",R[R.NoteOnVelocity=2]="NoteOnVelocity",R[R.NoteOnKeyNumber=3]="NoteOnKeyNumber",R[R.PolyPressure=10]="PolyPressure",R[R.ChannelPressure=13]="ChannelPressure",R[R.PitchWheel=14]="PitchWheel",R[R.PitchWheelSensitivity=16]="PitchWheelSensitivity",R[R.Link=127]="Link"})(S||(S={})),(function(R){R[R.Linear=0]="Linear",R[R.Absolute=2]="Absolute"})(k||(k={}));var $=[{id:N.GeneratorType.InitialAttenuation,source:{type:f.Concave,polarity:b.Unipolar,direction:M.Decreasing,palette:F.GeneralController,index:S.NoteOnVelocity},value:960,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialFilterFc,source:{type:f.Linear,polarity:b.Unipolar,direction:M.Decreasing,palette:F.GeneralController,index:S.NoteOnVelocity},value:-2400,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.VibLFOToPitch,source:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.ChannelPressure},value:50,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.VibLFOToPitch,source:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.MidiController,index:1},value:50,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:f.Concave,polarity:b.Unipolar,direction:M.Decreasing,palette:F.MidiController,index:7},value:960,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:f.Linear,polarity:b.Bipolar,direction:M.Increasing,palette:F.MidiController,index:10},value:1e3,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:f.Concave,polarity:b.Unipolar,direction:M.Decreasing,palette:F.MidiController,index:11},value:960,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.ReverbEffectsSend,source:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.MidiController,index:91},value:200,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.ChorusEffectsSend,source:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.MidiController,index:93},value:200,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.CoarseTune,source:{type:f.Linear,polarity:b.Bipolar,direction:M.Increasing,palette:F.GeneralController,index:S.PitchWheel},value:12700,valueSource:{type:f.Linear,polarity:b.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.PitchWheelSensitivity},transform:k.Linear}]},"./src/types/preset.ts":function(o,u){},"./src/types/presetData.ts":function(o,u){},"./src/types/sample.ts":function(o,u,p){var f;p.r(u),p.d(u,"SampleType",function(){return f}),(function(b){b[b.EOS=0]="EOS",b[b.Mono=1]="Mono",b[b.Right=2]="Right",b[b.Left=4]="Left",b[b.Linked=8]="Linked",b[b.RomMono=32769]="RomMono",b[b.RomRight=32770]="RomRight",b[b.RomLeft=32772]="RomLeft",b[b.RomLinked=32776]="RomLinked"})(f||(f={}))},"./src/types/zone.ts":function(o,u){},"./src/utils/buffer.ts":function(o,u,p){p.r(u),p.d(u,"getStringFromBuffer",function(){return f});var f=function(b){return new TextDecoder("utf8").decode(b).split(/\0/)[0].trim()}},"./src/utils/index.ts":function(o,u,p){p.r(u);var f=p("./src/utils/buffer.ts");p.d(u,"getStringFromBuffer",function(){return f.getStringFromBuffer});var b=p("./src/utils/memoize.ts");p.d(u,"memoize",function(){return b.memoize})},"./src/utils/memoize.ts":function(o,u,p){p.r(u),p.d(u,"memoize",function(){return f});var f=function(b){var M={};return function(){for(var F=arguments.length,S=new Array(F),k=0;k<F;k++)S[k]=arguments[k];var N=JSON.stringify(S);if(N in M)return M[N];var $=b.apply(void 0,S);return M[N]=$,$}}}})})})(SoundFont2)),SoundFont2.exports}var SoundFont2Exports=requireSoundFont2();const m=e=>Math.pow(2,e/1200),Q=e=>e/1e3,G=(e,t)=>{const o=Math.pow(10,t);return Math.round(e*o)/o};typeof AudioParam<"u"&&(AudioParam.prototype.dahdsr=function(e,t,o,u,p,f,b,M,F){p=Math.max(G(p,4),.001),b=Math.max(G(b,4),.001),F=G(F,4),t=Math.max(t,.001);let S=e;return this.setValueAtTime(t,S),this.setValueAtTime(t,S+=u),this.exponentialRampToValueAtTime(o,S+=p),this.setValueAtTime(o,S+=f),this.exponentialRampToValueAtTime(Math.max(M*o,.001),S+=b),(k,N)=>{this.cancelAndHoldAtTime(k);const $=Math.max(N??t,.001);this.exponentialRampToValueAtTime($,k+F)}});const T={0:"startAddrOffset",1:"endAddrOffset",2:"startloopAddrsOffset",3:"endloopAddrsOffset",4:"startAddrsCoarseOffset",5:"modLfoToPitch",6:"vibLfoToPitch",7:"modEnvToPitch",8:"initialFilterFc",9:"initialFilterQ",10:"modLfoToFilterFc",11:"modEnvToFilterFc",12:"endAddrsCoarseOffset",13:"modLfoToVolume",14:"unused1",15:"chorusEffectsSend",16:"reverbEffectsSend",17:"pan",18:"unused2",19:"unused3",20:"unused4",21:"delayModLFO",22:"freqModLFO",23:"delayVibLFO",24:"freqVibLFO",25:"delayModEnv",26:"attackModEnv",27:"holdModEnv",28:"decayModEnv",29:"sustainModEnv",30:"releaseModEnv",31:"keyNumToModEnvHold",32:"keyNumToModEnvDecay",33:"delayVolEnv",34:"attackVolEnv",35:"holdVolEnv",36:"decayVolEnv",37:"sustainVolEnv",38:"releaseVolEnv",39:"keyNumToVolEnvHold",40:"keyNumToVolEnvDecay",41:"instrument",42:"reserved1",43:"keyRange",44:"velRange",45:"startloopAddrsCoarseOffset",46:"keyNum",47:"velocity",48:"initialAttenuation",49:"reserved2",50:"endloopAddrsCoarseOffset",51:"coarseTune",52:"fineTune",53:"sampleID",54:"sampleModes",55:"reserved3",56:"scaleTuning",57:"exclusiveClass",58:"overridingRootKey",59:"unused5",60:"endOper"};Object.fromEntries(Object.entries(SoundFont2Exports.DEFAULT_GENERATOR_VALUES).map(([e,t])=>[T[e],t]));const D=(e,t,o,u,p)=>{var f,b,M,F,S,k,N;const $=SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e];if(typeof $!="number")throw new Error(`no default value found for generator with index ${e}`);const R=t.generators[e],U=(b=(f=o.globalZone)==null?void 0:f.generators)==null?void 0:b[e],V=(M=u?.generators)==null?void 0:M[e],z=(S=(F=p.globalZone)==null?void 0:F.generators)==null?void 0:S[e],K=R&&"value"in R?R.value:void 0,ie=U&&"value"in U?U.value:void 0,he=V&&"value"in V?V.value:void 0,se=z&&"value"in z?z.value:void 0,ee=(k=K??ie)!=null?k:$,pe=(N=he??se)!=null?N:0;return ee+pe},J=e=>SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e]!==void 0,W=(e,t,o)=>{var u,p,f,b;return Object.fromEntries(Array.from(new Set([Object.keys((p=(u=o.globalZone)==null?void 0:u.generators)!=null?p:{}),Object.keys(t.generators),Object.keys((b=(f=t.instrument.globalZone)==null?void 0:f.generators)!=null?b:{}),Object.keys(e.generators)].flat())).filter(J).map(M=>[T[M],D(parseInt(M),e,t.instrument,t,o)]))};function X(e,t,o){let{time:u=e.currentTime}=o;const{midi:p,start:f,velocity:b=.3,startLoop:M,endLoop:F,sampleRate:S,originalPitch:k,pitchCorrection:N,type:$,sampleModes:R=0,overridingRootKey:U,fineTune:V=0,startloopAddrsOffset:z=0,startloopAddrsCoarseOffset:K=0,endloopAddrsOffset:ie=0,endloopAddrsCoarseOffset:he=0,delayVolEnv:se=-12e3,attackVolEnv:ee=-12e3,holdVolEnv:pe=-12e3,decayVolEnv:_e=-12e3,sustainVolEnv:ve=0,releaseVolEnv:we=-12e3,pan:xe=0,...Oe}=o,Pe=100*(U!==void 0&&U!==-1?U:k)+N-V,Le=p*100-Pe,Xe=1*Math.pow(2,Le/1200);t.playbackRate.value=Xe;const Ke=M+z+K*32768,me=F+ie+he*32768;me>Ke&&R===1?(t.loopStart=Ke/S,t.loopEnd=me/S,t.loop=!0):R===3&&console.warn("unimplemented sampleMode 3 (play till end on note off)"),Object.keys(Oe).filter(mt=>!["name","instrument","keyRange","sampleID","end"].includes(mt)).length;const ye=e.createGain(),Se=[u,0,b,m(se),m(ee),m(pe),m(_e),ve>=960?0:1-Q(ve),m(we)],qe=ye.gain.dahdsr(...Se),st=e.createStereoPanner();return st.pan.value=xe/1e3,ye.connect(st),t.connect(ye),st.connect(e.destination),t.start(u),(mt=e.currentTime)=>{t.stop(mt+m(we)),qe(mt)}}function Y(e,t,o={}){const{header:u,data:p}=t,f=new Float32Array(p.length);for(let F=0;F<p.length;F++)f[F]=p[F]/32768;const b=e.createBuffer(1,f.length,u.sampleRate);b.getChannelData(0).set(f);const M=e.createBufferSource();return M.buffer=b,o={...u,...o},X(e,M,o)}const C=(e,t)=>!e.keyRange||e.keyRange.lo<=t&&t<=e.keyRange.hi,x=(e,t)=>e.zones.filter(o=>C(o,t)&&o.instrument).map(o=>o.instrument.zones.filter(u=>C(u,t)).map(u=>{const p=W(u,o,e);return{...u,mergedGenerators:p}})).flat(),ce=(e,t,o,u=e.currentTime)=>{const p=x(t,o).map(f=>Y(e,f.sample,{...f.mergedGenerators,midi:o,time:u}));return(f=e.currentTime)=>{p.forEach(b=>b(f))}};Pattern$1.prototype.soundfont=function(e,t=0){return this.onTrigger((o,u,p,f)=>{const b=getAudioContext(),M=getPlayableNoteValue(o),F=e.presets[t%e.presets.length],S=f,k=[b,F,noteToMidi$1(M),S];ce(...k)(S+o.duration)})};let latestOptions,hydra;async function initHydra(e={}){if(latestOptions&&JSON.stringify(latestOptions)!==JSON.stringify(e)&&document.getElementById("hydra-canvas")?.remove(),latestOptions=e,!document.getElementById("hydra-canvas")){const{src:t="https://unpkg.com/hydra-synth",feedStrudel:o=!1,contextType:u="webgl",pixelRatio:p=1,pixelated:f=!0,...b}={detectAudio:!1,...e},{canvas:M}=getDrawContext("hydra-canvas",{contextType:u,pixelRatio:p,pixelated:f});if(b.canvas=M,await import(t),hydra=new Hydra(b),o){const{canvas:F}=getDrawContext();F.style.display="none",hydra.synth.s0.init({src:F})}}return hydra}function clearHydra(){hydra&&hydra.hush(),globalThis.s0?.clear(),document.getElementById("hydra-canvas")?.remove(),globalThis.speed=speed,globalThis.shape=shape}const H=e=>()=>reify(e).queryArc(getTime(),getTime())[0].value;App.last_eval_error="",App.handle_eval_error=e=>{App.has_error=!0,App.last_eval_error=e?.message||`${e}`,App.set_status(App.last_eval_error)};const{evaluate,scheduler}=webaudioRepl({transpiler,onEvalError:e=>{App.handle_eval_error(e)}});App.scheduler=scheduler,App.app_name="Slide",App.code_query_key="code",App.song_query_key="song",App.cpm_query_key="cpm",App.beat_query_key="beat",App.current_song="",App.events_started=!1,App.audio_started=!1,App.fetch_in_flight=!1,App.status_watch_cancelled=!1,App.default_cpm=60,App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.color_index=0,App.color_cycle_timer=void 0,App.do_partial_updates=!1,App.fetch_delay_seconds=5,App.code_url_max=1800,App.border_color="#444",App.cycle_colors=["#94dd94","rgb(197, 187, 106)","rgb(222, 143, 143)","rgb(127, 155, 210)"],App.on_load=()=>{App.start_events()},App.get_config=async()=>{let e=await fetch("config/config.json");try{App.config=await e.json()}catch(t){console.error("Failed to parse config.json",t),App.config={}}},App.strudel_init=async()=>{if(App.audio_started){console.info("Audio already initialized");return}console.info("Initializing Audio...");try{console.info("Loading scope..."),await App.ensure_scope(),console.info("Scope loaded"),console.info("Initializing audio context..."),await initAudio(),miniAllStrings();let e="https://raw.githubusercontent.com/felixroos/dough-samples/main";console.info("Loading samples and soundfonts..."),await Promise.all([registerSynthSounds(),registerSoundfonts(),samples("github:tidalcycles/dirt-samples"),samples(`${e}/tidal-drum-machines.json`)]),App.audio_started=!0,App.apply_volume(),console.info("Audio Ready."),App.code_to_play&&(App.play_action(App.code_to_play),App.code_to_play="")}catch(e){throw console.error("Audio Failed:",e),e}},App.clear_draw_context=()=>{try{cleanupDraw(!0)}catch(e){console.warn("Failed to clear draw context",e)}},App.reset_eval_state=()=>{App.has_error=!1},App.report_eval_failure=e=>{let t=e?.message||App.last_eval_error||"Failed to evaluate Strudel code";App.last_eval_error=t,App.set_status(t)},App.run_eval=async e=>{App.reset_eval_state(),e=App.filter_code(e),App.set_input(e);try{await evaluate(e)}catch(t){return{ok:!1,error:t}}return App.has_error?{ok:!1,error:new Error(App.last_eval_error||"Evaluation error")}:{ok:!0}},App.normalize_code=(e="")=>e.replace(/\r\n/g,`
`).trim(),App.strip_set_cpm=e=>e.split(`
`).filter(t=>!t.trim().match(/^setCpm\s*\(/)).join(`
`),App.split_by_newlines=e=>{let t="",o=null,u=0,p=0,f=0,b=[],M=()=>{let F=t.trim();F&&b.push(F),t=""};for(let F=0;F<e.length;F+=1){let S=e[F],k=e[F-1];if(t+=S,o){S===o&&k!=="\\"&&(o=null);continue}if(S==='"'||S==="'"||S==="`"){o=S;continue}if(S==="("?u+=1:S===")"?u=Math.max(0,u-1):S==="["?p+=1:S==="]"?p=Math.max(0,p-1):S==="{"?f+=1:S==="}"&&(f=Math.max(0,f-1)),S!==`
`)continue;let N=e[F+1];u===0&&p===0&&f===0&&!(N===" "||N==="	")&&!(N===`
`)&&M()}return M(),b},App.segment_code=e=>{let t=App.normalize_code(e);if(!t)return[];let o=t.split(/\n{2,}/g).map(p=>p.trim()).filter(Boolean),u=[];for(let p of o){if(!p.includes(`
`)){u.push(p);continue}let f=App.split_by_newlines(p);f.length?u.push(...f):u.push(p)}if(u.length<=1&&t.includes(`
`)){let p=t.split(/\n+/g).map(f=>f.trim()).filter(Boolean);if(p.length>1)return p}return u},App.apply_partial_update=async e=>{let t=App.segment_code(e);if(!t.length)return!1;let o=[],u=0;for(let f of t){let b=await App.run_eval(f);if(b.ok){o.push(f);continue}u+=1,console.warn("Skipping segment due to error",b.error)}if(!o.length)return!1;let p=o.join(`

`);return App.set_input(p),u>0?App.playing(`Skipped ${u} segment(s)`):App.playing(),!0},App.ensure_strudel_ready=async()=>App.strudel_init?(await App.strudel_init(),!0):(App.set_status("Bundle not loaded. Check console for errors"),console.error("strudel.bundle.js is missing or failed to load"),!1),App.restart_code_scroll=()=>{App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.start_events=async()=>{if(App.events_started)return;App.events_started=!0,await App.get_config(),App.load_all_storage(),App.create_modals(),App.start_visual(),DOM.ev("#btn-play","click",()=>{let o=App.get_input_value();App.play_action(o,!0)}),DOM.ev("#btn-auto","click",()=>{App.open_auto_modal()}),DOM.ev("#btn-stop","click",()=>{App.stop_action()}),DOM.ev("#btn-songs","click",()=>{App.open_songs_modal()});let e=DOM.el("#image");e&&DOM.ev(e,"click",()=>{App.open_settings_modal()});let t=DOM.el("#title");t&&DOM.ev(t,"click",()=>{App.open_about_modal()}),App.setup_status(),App.setup_volume(),App.setup_auto(),App.setup_input(),App.setup_scope(),App.init_volume_controls(),App.init_tempo_controls(),App.init_code_input_controls(),App.start_keyboard(),DOM.ev(window,"resize",()=>{App.handle_scope_resize()}),App.make_main_visible(),App.set_cpm_from_query(),App.set_beat_title_from_query(),App.max_input(),await App.load_song_from_query()||App.load_code_from_query()||App.load_last_code()},App.make_main_visible=()=>{DOM.el("#main").classList.remove("invisible")},App.set_title=e=>{if(e){document.title=`${App.app_name} - ${e}`;return}document.title=App.app_name},App.update_url=(e="")=>{let t=new URL(window.location.href),o=App.get_input_value().trim();e||(e=App.get_song_name()),e?t.searchParams.set(App.song_query_key,e):t.searchParams.delete(App.song_query_key),e||o?t.searchParams.set(App.cpm_query_key,`${App.tempo}`):t.searchParams.delete(App.cpm_query_key),o&&!e&&o.length<=App.code_url_max?t.searchParams.set(App.code_query_key,o):t.searchParams.delete(App.code_query_key),!e&&App.beat_title?t.searchParams.set(App.beat_query_key,App.beat_title):t.searchParams.delete(App.beat_query_key),window.history.replaceState({},document.title,`${t.pathname}${t.search}${t.hash}`)},App.get_query_params=()=>new URLSearchParams(window.location.search),App.update_title=()=>{let e=App.app_name,t=App.get_song_name(!0);t?e=`${e} - ${t}`:App.beat_title&&(e=`${e} - ${App.beat_title}`),document.title=e},App.get_top_height=()=>{let e=DOM.el("#top");return App.get_el_height(e)},App.get_scope_height=()=>{if(App.scope_enabled){let e=DOM.el("#scope-container");return App.get_el_height(e)}return 0},App.get_controls_height=()=>{let e=DOM.el("#controls");return App.get_el_height(e)},window.H=H,window.initHydra=initHydra,window.clearHydra=clearHydra,App.filter_code=e=>(e=e.replace(/setcps\s*\([^)]*\)/gi,""),e=e.replace(/setbpm\s*\([^)]*\)/gi,""),e=e.replace(/setcpm\s*\([^)]*\)/gi,""),e=e.replace(/\._?cpm\s*\([^)]*\)/gi,""),e=e.replace(/\n\s*\n\s*\n+/g,`

`),e.trim()),App.code_scroll_frame=void 0,App.code_scroll_last_ts=0,App.code_scroll_direction=1,App.code_scroll_active=!1,App.code_scroll_speed_px_per_second=80,App.code_scroll_pause_until=0,App.code_scroll_wheel_pause_ms=1e3,App.code_scroll_song_pause_ms=1.2*1e3,App.code_scroll_pending_delay_ms=0,App.input_mirror_time=2.8*1e3,App.input_grow_time=2.8*1e3,App.setup_input=()=>{App.start_input_resize_observer(),App.create_editor(),App.setup_editor_autocomplete(),App.max_button=App.get_max_button()},App.create_editor=()=>{let e=DOM.el("#code-input");App.editor=CodeMirror.fromTextArea(e,{lineNumbers:!1,theme:"nord",indentWithTabs:!0,tabSize:4,lineWrapping:!0,indentUnit:4,smartIndent:!1,enterMode:"flat"}),App.editor.getWrapperElement().id="codemirror-wrapper",App.document=App.editor.getDoc(),App.editor.setOption("mode","clike"),App.editor.refresh(),App.editor.focus()},App.get_input=()=>DOM.el("#codemirror-wrapper"),App.get_input_wrapper=()=>DOM.el("#code-input-wrapper"),App.get_input_value=()=>App.document.getValue(),App.defer_code_scroll=e=>{if(!Number.isFinite(e)||e<=0){App.code_scroll_pending_delay_ms=0;return}App.code_scroll_pending_delay_ms=e},App.reset_code_scroll_for_content=(e={})=>{let t=0,o=e.scroll_delay_ms??App.code_scroll_song_pause_ms,u=e.direction??1;if(App.code_scroll_active&&(Number.isFinite(App.code_scroll_pending_delay_ms)&&App.code_scroll_pending_delay_ms>0?t=App.code_scroll_pending_delay_ms:Number.isFinite(o)&&o>0&&(t=o)),App.code_scroll_pending_delay_ms=0,App.code_scroll_direction=u,App.code_scroll_last_ts=0,t<=0||typeof window>"u"){App.code_scroll_pause_until=0;return}window.performance?.now?App.code_scroll_pause_until=window.performance.now()+t:App.code_scroll_pause_until=t},App.set_input=e=>{App.document.setValue(e),App.scroll_input_to_top(),App.reset_code_scroll_for_content()},App.set_code_scroll_button_active=e=>{let t=DOM.el("#code-input-scroll");if(t){if(e){t.classList.add("active");return}t.classList.remove("active")}},App.code_scroll_tick=e=>{if(!App.code_scroll_active){App.code_scroll_frame=void 0;return}if(!App.editor){App.stop_code_scroll();return}if(App.code_scroll_last_ts||(App.code_scroll_last_ts=e),App.code_scroll_pause_until&&e<App.code_scroll_pause_until){App.code_scroll_last_ts=e,App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick);return}App.code_scroll_pause_until=0;let t=e-App.code_scroll_last_ts;App.code_scroll_last_ts=e;let o=App.code_scroll_speed_px_per_second*t/1e3,u=App.get_input_scroll()+o*App.code_scroll_direction,p=Math.max(0,App.get_input_height()-App.get_input_client_height());if(App.set_input_scroll(u),p<=0){App.stop_code_scroll();return}App.code_scroll_direction>0&&Math.ceil(App.get_input_scroll())+1>=p?(App.set_input_scroll(p),App.reset_code_scroll_for_content({direction:-1})):App.code_scroll_direction<0&&App.get_input_scroll()<=0&&(App.scroll_input_to_top(),App.reset_code_scroll_for_content({direction:1})),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick)},App.start_code_scroll=()=>{App.code_scroll_active||Math.max(0,App.get_input_height()-App.get_input_client_height())<=0||(App.code_scroll_active=!0,App.code_scroll_direction=1,App.code_scroll_last_ts=window.performance.now()-16,App.code_scroll_pause_until=0,App.set_code_scroll_button_active(!0),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick))},App.stop_code_scroll=()=>{!App.code_scroll_active&&!App.code_scroll_frame||(App.code_scroll_active=!1,App.code_scroll_direction=1,App.code_scroll_last_ts=0,App.code_scroll_pause_until=0,App.code_scroll_frame&&(window.cancelAnimationFrame(App.code_scroll_frame),App.code_scroll_frame=void 0),App.set_code_scroll_button_active(!1))},App.init_code_input_controls=()=>{let e=App.get_input_wrapper(),t=DOM.el("#code-input-scroll"),o=App.get_max_button(),u=DOM.el("#code-input-top"),p=DOM.el("#code-input-bottom"),f=DOM.el("#code-input-sounds"),b=DOM.el("#code-input-notes"),M=DOM.el("#code-input-banks");u&&DOM.ev(u,"click",S=>{S.preventDefault(),App.scroll_input_to_top(),App.reset_code_scroll_for_content()}),p&&DOM.ev(p,"click",S=>{S.preventDefault(),App.scroll_input_to_bottom(),App.reset_code_scroll_for_content({direction:-1})}),t&&DOM.ev(t,"click",S=>{if(S.preventDefault(),App.code_scroll_active){App.stop_code_scroll();return}App.start_code_scroll()}),o&&DOM.ev(o,"click",S=>{App.max_input()}),f&&DOM.ev(f,"click",S=>{S.preventDefault(),App.show_sounds_context(S)}),b&&DOM.ev(b,"click",S=>{S.preventDefault(),App.show_notes_context(S)}),M&&DOM.ev(M,"click",S=>{S.preventDefault(),App.show_banks_context(S)});let F=App.get_input();if(DOM.ev(F,"pointerdown",S=>{if(!App.code_scroll_active)return;let N=S.target.getBoundingClientRect();S.clientX>N.right-20&&S.clientY>N.bottom-20||App.stop_code_scroll()}),e){let S=DOM.el("#resize-handle");if(S){let k=!1;DOM.ev(S,"mousedown",N=>{N.preventDefault(),k=!0,document.body.style.userSelect="none",document.body.style.cursor="se-resize",App.activate_top_input_controls(),App.activate_bottom_input_controls(),S.style.opacity="1",S.style.pointerEvents="auto",S.classList.add("active");let $=N.clientX,R=N.clientY,U=e.offsetWidth,V=e.offsetHeight,z=ie=>{if(!k)return;let he=U+(ie.clientX-$),se=V+(ie.clientY-R),ee=getComputedStyle(document.documentElement),pe=parseInt(ee.getPropertyValue("--input_min_width")),_e=parseInt(ee.getPropertyValue("--input_min_height"));he=Math.max(pe,he),se=Math.max(_e,se),e.style.width=`${he}px`,e.style.height=`${se}px`},K=()=>{k=!1,document.body.style.userSelect="",document.body.style.cursor="",App.deactivate_top_input_controls(),App.deactivate_bottom_input_controls(),S.style.opacity="",S.style.pointerEvents="",S.classList.remove("active"),document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",z),document.addEventListener("mouseup",K)}),DOM.ev(S,"dblclick",N=>{App.restore_input()})}DOM.ev(e,"mouseover",()=>{App.check_max_button()})}DOM.ev(F,"wheel",S=>{App.code_scroll_active&&(window.performance?.now?App.code_scroll_pause_until=window.performance.now()+App.code_scroll_wheel_pause_ms:App.code_scroll_pause_until=App.code_scroll_wheel_pause_ms,S.deltaY<0?App.code_scroll_direction=-1:S.deltaY>0&&(App.code_scroll_direction=1))},{passive:!0})},App.start_input_resize_observer=()=>{let e=App.get_input_wrapper();if(!e)return;new ResizeObserver(()=>{App.scope_debouncer.call(),App.enable_max_button()}).observe(e)},App.restore_input=()=>{let e=App.get_input_wrapper();if(!e)return;let t=getComputedStyle(document.documentElement),o=parseInt(t.getPropertyValue("--input_height")),u=parseInt(t.getPropertyValue("--input_max_width"));e.style.height=`${o}px`,e.style.width=`${u}%`},App.input_is_maxed=()=>{let e=App.get_input_wrapper(),t=parseInt(e.style.height),o=parseInt(e.style.width),[u,p]=App.max_input(!0);return t===u&&o===p},App.restart_code_scroll=()=>{App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.add_text_to_input=e=>{App.document.replaceSelection(e),App.editor.focus()},App.focus_input=()=>{App.editor.focus()},App.activate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.activate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.deactivate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.deactivate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.mirror_input=()=>{let e=App.get_input();e.classList.add("mirror"),clearTimeout(App.input_mirror_timeout),App.input_mirror_timeout=setTimeout(()=>{e.classList.remove("mirror")},App.input_mirror_time)},App.glow_input=()=>{let e=App.get_input();e.classList.add("glow"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{e.classList.remove("glow")},App.input_grow_time)},App.cursive_input=()=>{let e=App.get_input();e.classList.add("cursive"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{e.classList.remove("cursive")},App.input_grow_time)},App.max_input=(e=!1)=>{let t=App.get_input_wrapper(),o=getComputedStyle(document.documentElement),u=parseInt(o.getPropertyValue("--input_max_width")),p=App.get_input_diff();return e||(t.style.height=`${p}px`,t.style.width=`${u}%`,App.check_max_button()),[p,u]},App.get_input_diff=()=>{let e=App.get_top_height(),t=App.get_scope_height(),o=App.get_controls_height(),u=e+t+o;return App.viewport_height()-u-33},App.check_max_button=()=>{App.input_is_maxed()?App.disable_max_button():App.enable_max_button()},App.get_max_button=()=>DOM.el("#code-input-max"),App.enable_max_button=()=>{App.max_button.classList.remove("disabled")},App.disable_max_button=()=>{App.max_button.classList.add("disabled")},App.set_input_scroll=e=>{App.editor.scrollTo(null,e)},App.scroll_input_to_top=()=>{App.set_input_scroll(0)},App.scroll_input_to_bottom=()=>{let e=App.editor.getScrollInfo();App.editor.scrollTo(null,e.height)},App.get_input_scroll=()=>App.editor.getScrollInfo().top,App.get_input_height=()=>App.editor.getScrollInfo().height,App.get_input_client_height=()=>App.editor.getScrollInfo().clientHeight,App.set_input_border=e=>{let t=App.get_input();t.style.borderColor=e},App.volume=100,App.volume_step=1,App.setup_volume=()=>{App.update_volume(App.volume)},App.get_volume_slider=()=>DOM.el("#volume-slider"),App.get_volume_value=()=>DOM.el("#volume-value"),App.read_volume_value=e=>{if(!e)return App.volume;let t=e.valueAsNumber;if(Number.isFinite(t))return t;let o=parseInt(e.value,10);return Number.isFinite(o)?o:App.volume},App.refresh_volume_ui=()=>{let e=App.get_volume_slider(),t=App.get_volume_value();e&&(e.value=`${App.volume}`),t&&(t.innerText=`${App.volume}%`)},App.apply_volume=()=>{if(App.audio_started)try{let t=getSuperdoughAudioController()?.output?.destinationGain;if(!t){console.warn("Destination gain node missing");return}t.gain.value=App.volume/100}catch(e){console.error("Failed to apply volume",e)}},App.update_volume=e=>{let t=Number(e);Number.isFinite(t)||(t=App.volume),t=Math.min(100,Math.max(0,t)),App.volume=t,App.refresh_volume_ui(),App.stor_save_volume(),App.apply_volume()},App.init_volume_controls=()=>{let e=App.get_volume_slider(),t=DOM.el("#volume-control"),o=DOM.el("#volume-decrement"),u=DOM.el("#volume-increment");if(!e)return;App.refresh_volume_ui(),App.stor_save_volume(),DOM.ev(e,"input",f=>{App.update_volume(App.read_volume_value(f.target))});let p=f=>{App.update_volume(App.volume+f*App.volume_step)};o&&DOM.ev(o,"click",()=>{p(-1)}),u&&DOM.ev(u,"click",()=>{p(1)}),DOM.ev(t,"auxclick",f=>{f.button===1&&App.update_volume(50)}),DOM.ev(t,"wheel",f=>{f.preventDefault();let b=parseInt(e.step,10)||App.volume_step,M=parseInt(e.value,10);f.deltaY<0?e.value=M+b:e.value=M-b,App.update_volume(App.read_volume_value(e))},{passive:!1})},App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.tempo_commit_delay_ms=500,App.min_tempo=20,App.max_tempo=120,App.tempo_step=5,App.tempo_wheel_commit_timer=void 0,App.tempo_wheel_commit_delay_ms=150,App.schedule_tempo_commit=e=>{if(typeof window>"u"){e();return}App.tempo_debounce_timer&&window.clearTimeout(App.tempo_debounce_timer),App.tempo_debounce_timer=window.setTimeout(()=>{App.tempo_debounce_timer=void 0,e()},App.tempo_commit_delay_ms)},App.schedule_tempo_wheel_commit=()=>{if(typeof window>"u"){App.on_tempo_change(!0,App.tempo);return}App.tempo_wheel_commit_timer&&window.clearTimeout(App.tempo_wheel_commit_timer),App.tempo_wheel_commit_timer=window.setTimeout(()=>{App.tempo_wheel_commit_timer=void 0,App.on_tempo_change(!0,App.tempo)},App.tempo_wheel_commit_delay_ms)},App.get_tempo_slider=()=>DOM.el("#tempo-slider"),App.get_tempo_value=()=>DOM.el("#tempo-value"),App.refresh_tempo_ui=()=>{let e=App.get_tempo_slider(),t=App.get_tempo_value();e&&(e.value=`${App.tempo}`),t&&(t.textContent=`${App.tempo} cpm`)},App.persist_tempo=()=>{if(!(typeof window>"u"))try{App.stor_save_tempo()}catch(e){console.warn("Failed to persist tempo",e)}},App.update_tempo=e=>{let t=parseInt(e,10);Number.isFinite(t)||(t=App.tempo),t=Math.round(t/App.tempo_step)*App.tempo_step,t=Math.min(App.max_tempo,Math.max(App.min_tempo,t)),App.tempo=t,App.refresh_tempo_ui()},App.on_tempo_change=(e=!1,t=void 0)=>{let o=t;o===null&&(o=App.get_tempo_slider()?.value),App.update_tempo(o),e&&App.schedule_tempo_commit(()=>{App.persist_tempo(),App.set_tempo(),App.update_url()})},App.init_tempo_controls=()=>{let e=App.get_tempo_slider(),t=DOM.el("#tempo-control"),o=DOM.el("#tempo-decrement"),u=DOM.el("#tempo-increment");if(!e)return;App.refresh_tempo_ui(),App.persist_tempo(),DOM.ev(e,"input",f=>{App.update_tempo(f.target.value)}),DOM.ev(t,"auxclick",f=>{f.button===1&&(e.value=App.default_cpm,App.update_tempo(App.default_cpm),App.set_tempo(),App.update_url())}),DOM.ev(t,"wheel",f=>{if(f.preventDefault(),!e)return;let b=parseInt(e.step,10);(!Number.isFinite(b)||b<=0)&&(b=App.tempo_step);let M=e.valueAsNumber;if(Number.isFinite(M)||(M=App.tempo),f.deltaY<0)M+=b;else if(f.deltaY>0)M-=b;else return;App.on_tempo_change(!1,M),App.schedule_tempo_wheel_commit()},{passive:!1}),DOM.ev(t,"change",()=>{App.on_tempo_change(!0)});let p=f=>{let b=App.tempo+f*App.tempo_step;App.on_tempo_change(!0,b)};o&&DOM.ev(o,"click",()=>{p(-1)}),u&&DOM.ev(u,"click",()=>{p(1)})},App.set_tempo=()=>{try{App.scheduler.setCps(App.tempo/60)}catch(e){console.debug("Tempo will be applied when audio starts",e)}};function isNamedPitch$6(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$6(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$6=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$6=FIFTHS$6.map(e=>Math.floor(e*7/12));function coordinates$6(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$6[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$6[t]-4*o;return[p*f,p*b]}var FIFTHS_TO_STEPS$3=[3,0,4,1,5,2,6];function pitch$3(e){const[t,o,u]=e,p=FIFTHS_TO_STEPS$3[unaltered$3(t)],f=Math.floor((t+1)/7);if(o===void 0)return{step:p,alt:f,dir:u};const b=o+4*f+STEPS_TO_OCTS$6[p];return{step:p,alt:f,oct:b,dir:u}}function unaltered$3(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$9=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$5=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$5="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$5="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$c=new RegExp("^"+INTERVAL_TONAL_REGEX$5+"|"+INTERVAL_SHORTHAND_REGEX$5+"$");function tokenizeInterval$5(e){const t=REGEX$c.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$9={};function interval$5(e){return typeof e=="string"?cache$9[e]||(cache$9[e]=parse$9(e)):isPitch$6(e)?interval$5(pitchName$7(e)):isNamedPitch$6(e)?interval$5(e.name):NoInterval$5}var SIZES$6=[0,2,4,5,7,9,11],TYPES$5="PMMPPMM";function parse$9(e){const t=tokenizeInterval$5(e);if(t[0]==="")return NoInterval$5;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES$5[p];if(f==="M"&&u==="P")return NoInterval$5;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt$5(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$6[p]+k+12*N),R=(F*(SIZES$6[p]+k)%12+12)%12,U=coordinates$6({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval$2(e,t){const[o,u=0]=e,p=o*7+u*12<0,f=t||p?[-o,-u,-1]:[o,u,1];return interval$5(pitch$3(f))}function qToAlt$5(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$7(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES$5[t]==="M"?"majorable":"perfectable";return M+b+altToQ$5(F,o)}function altToQ$5(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$9("A",t):fillStr$9("d",e==="perfectable"?t:t+1)}function isNamedPitch$5(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$5(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$5=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$5=FIFTHS$5.map(e=>Math.floor(e*7/12));function coordinates$5(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$5[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$5[t]-4*o;return[p*f,p*b]}var FIFTHS_TO_STEPS$2=[3,0,4,1,5,2,6];function pitch$2(e){const[t,o,u]=e,p=FIFTHS_TO_STEPS$2[unaltered$2(t)],f=Math.floor((t+1)/7);if(o===void 0)return{step:p,alt:f,dir:u};const b=o+4*f+STEPS_TO_OCTS$5[p];return{step:p,alt:f,oct:b,dir:u}}function unaltered$2(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$8=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote$1=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),cache$8=new Map,stepToLetter$1=e=>"CDEFGAB".charAt(e),altToAcc$1=e=>e<0?fillStr$8("b",-e):fillStr$8("#",e),accToAlt$1=e=>e[0]==="b"?-e.length:e.length;function note$1(e){const t=JSON.stringify(e),o=cache$8.get(t);if(o)return o;const u=typeof e=="string"?parse$8(e):isPitch$5(e)?note$1(pitchName$6(e)):isNamedPitch$5(e)?note$1(e.name):NoNote$1;return cache$8.set(t,u),u}var REGEX$b=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote$1(e){const t=REGEX$b.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote$1(e){return note$1(pitch$2(e))}var mod$1=(e,t)=>(e%t+t)%t,SEMI$1=[0,2,4,5,7,9,11];function parse$8(e){const t=tokenizeNote$1(e);if(t[0]===""||t[3]!=="")return NoNote$1;const o=t[0],u=t[1],p=t[2],f=(o.charCodeAt(0)+3)%7,b=accToAlt$1(u),M=p.length?+p:void 0,F=coordinates$5({step:f,alt:b,oct:M}),S=o+u+p,k=o+u,N=(SEMI$1[f]+b+120)%12,$=M===void 0?mod$1(SEMI$1[f]+b,12)-1188:SEMI$1[f]+b+12*(M+1),R=$>=0&&$<=127?$:null,U=M===void 0?null:Math.pow(2,($-69)/12)*440;return{empty:!1,acc:u,alt:b,chroma:N,coord:F,freq:U,height:$,letter:o,midi:R,name:S,oct:M,pc:k,step:f}}function pitchName$6(e){const{step:t,alt:o,oct:u}=e,p=stepToLetter$1(t);if(!p)return"";const f=p+altToAcc$1(o);return u||u===0?f+u:f}function transpose$5(e,t){const o=note$1(e),u=Array.isArray(t)?t:interval$5(t).coord;if(o.empty||!u||u.length<2)return"";const p=o.coord,f=p.length===1?[p[0]+u[0]]:[p[0]+u[0],p[1]+u[1]];return coordToNote$1(f).name}function tonicIntervalsTransposer$1(e,t){const o=e.length;return u=>{if(!t)return"";const p=u<0?(o- -u%o)%o:u%o,f=Math.floor(u/o),b=transpose$5(t,[0,f]);return transpose$5(b,e[p])}}function distance$5(e,t){const o=note$1(e),u=note$1(t);if(o.empty||u.empty)return"";const p=o.coord,f=u.coord,b=f[0]-p[0],M=p.length===2&&f.length===2?f[1]-p[1]:-Math.floor(b*7/12),F=u.height===o.height&&u.midi!==null&&o.oct===u.oct&&o.step>u.step;return coordToInterval$2([b,M],F).name}var fillStr$7=(e,t)=>Array(t+1).join(e),REGEX$a=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function tokenize$4(e){const t=REGEX$a.exec(e);return t?[t[1],t[2],t[3]]:["","",""]}function abcToScientificNotation(e){const[t,o,u]=tokenize$4(e);if(o==="")return"";let p=4;for(let b=0;b<u.length;b++)p+=u.charAt(b)===","?-1:1;const f=t[0]==="_"?t.replace(/_/g,"b"):t[0]==="^"?t.replace(/\^/g,"#"):"";return o.charCodeAt(0)>96?o.toUpperCase()+f+(p+1):o+f+p}function scientificToAbcNotation(e){const t=note$1(e);if(t.empty||!t.oct&&t.oct!==0)return"";const{letter:o,acc:u,oct:p}=t,f=u[0]==="b"?u.replace(/b/g,"_"):u.replace(/#/g,"^"),b=p>4?o.toLowerCase():o,M=p===5?"":p>4?fillStr$7("'",p-5):fillStr$7(",",4-p);return f+b+M}function transpose$4(e,t){return scientificToAbcNotation(transpose$5(abcToScientificNotation(e),t))}function distance$4(e,t){return distance$5(abcToScientificNotation(e),abcToScientificNotation(t))}var abc_notation_default={abcToScientificNotation,scientificToAbcNotation,tokenize:tokenize$4,transpose:transpose$4,distance:distance$4};function ascR$1(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR$1(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range$1(e,t){return e<t?ascR$1(e,t-e+1):descR$1(e,e-t+1)}function rotate$1(e,t){const o=t.length,u=(e%o+o)%o;return t.slice(u,o).concat(t.slice(0,u))}function compact$1(e){return e.filter(t=>t===0||t)}function sortedNoteNames(e){return e.map(o=>note$1(o)).filter(o=>!o.empty).sort((o,u)=>o.height-u.height).map(o=>o.name)}function sortedUniqNoteNames(e){return sortedNoteNames(e).filter((t,o,u)=>o===0||t!==u[o-1])}function shuffle$1(e,t=Math.random){let o,u,p=e.length;for(;p;)o=Math.floor(t()*p--),u=e[p],e[p]=e[o],e[o]=u;return e}function permutations$1(e){return e.length===0?[[]]:permutations$1(e.slice(1)).reduce((t,o)=>t.concat(e.map((u,p)=>{const f=o.slice();return f.splice(p,0,e[0]),f})),[])}const index$6=Object.freeze(Object.defineProperty({__proto__:null,compact:compact$1,permutations:permutations$1,range:range$1,rotate:rotate$1,shuffle:shuffle$1,sortedNoteNames,sortedUniqNoteNames},Symbol.toStringTag,{value:"Module"}));function ascR(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range(e,t){return e<t?ascR(e,t-e+1):descR(e,e-t+1)}function rotate(e,t){const o=t.length,u=(e%o+o)%o;return t.slice(u,o).concat(t.slice(0,u))}function compact(e){return e.filter(t=>t===0||t)}function shuffle(e,t=Math.random){let o,u,p=e.length;for(;p;)o=Math.floor(t()*p--),u=e[p],e[p]=e[o],e[o]=u;return e}function permutations(e){return e.length===0?[[]]:permutations(e.slice(1)).reduce((t,o)=>t.concat(e.map((u,p)=>{const f=o.slice();return f.splice(p,0,e[0]),f})),[])}var collection_default={compact,permutations,range,rotate,shuffle};function isNamedPitch$4(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$4(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$4=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$4=FIFTHS$4.map(e=>Math.floor(e*7/12));function coordinates$4(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$4[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$4[t]-4*o;return[p*f,p*b]}var fillStr$6=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$4=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$4="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$4="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$9=new RegExp("^"+INTERVAL_TONAL_REGEX$4+"|"+INTERVAL_SHORTHAND_REGEX$4+"$");function tokenizeInterval$4(e){const t=REGEX$9.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$7={};function interval$4(e){return typeof e=="string"?cache$7[e]||(cache$7[e]=parse$7(e)):isPitch$4(e)?interval$4(pitchName$5(e)):isNamedPitch$4(e)?interval$4(e.name):NoInterval$4}var SIZES$5=[0,2,4,5,7,9,11],TYPES$4="PMMPPMM";function parse$7(e){const t=tokenizeInterval$4(e);if(t[0]==="")return NoInterval$4;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES$4[p];if(f==="M"&&u==="P")return NoInterval$4;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt$4(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$5[p]+k+12*N),R=(F*(SIZES$5[p]+k)%12+12)%12,U=coordinates$4({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt$4(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$5(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES$4[t]==="M"?"majorable":"perfectable";return M+b+altToQ$4(F,o)}function altToQ$4(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$6("A",t):fillStr$6("d",e==="perfectable"?t:t+1)}var EmptyPcset={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},setNumToChroma=e=>Number(e).toString(2).padStart(12,"0"),chromaToNumber=e=>parseInt(e,2),REGEX$8=/^[01]{12}$/;function isChroma(e){return REGEX$8.test(e)}var isPcsetNum=e=>typeof e=="number"&&e>=0&&e<=4095,isPcset=e=>e&&isChroma(e.chroma),cache$6={[EmptyPcset.chroma]:EmptyPcset};function get$b(e){const t=isChroma(e)?e:isPcsetNum(e)?setNumToChroma(e):Array.isArray(e)?listToChroma(e):isPcset(e)?e.chroma:EmptyPcset.chroma;return cache$6[t]=cache$6[t]||chromaToPcset(t)}var pcset$1=get$b,chroma$3=e=>get$b(e).chroma,intervals=e=>get$b(e).intervals,num$1=e=>get$b(e).setNum,IVLS=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function chromaToIntervals(e){const t=[];for(let o=0;o<12;o++)e.charAt(o)==="1"&&t.push(IVLS[o]);return t}function notes$1(e){return get$b(e).intervals.map(t=>transpose$5("C",t))}function chromas(){return range(2048,4095).map(setNumToChroma)}function modes$1(e,t=!0){const u=get$b(e).chroma.split("");return compact(u.map((p,f)=>{const b=rotate(f,u);return t&&b[0]==="0"?null:b.join("")}))}function isEqual(e,t){return get$b(e).setNum===get$b(t).setNum}function isSubsetOf(e){const t=get$b(e).setNum;return o=>{const u=get$b(o).setNum;return t&&t!==u&&(u&t)===u}}function isSupersetOf(e){const t=get$b(e).setNum;return o=>{const u=get$b(o).setNum;return t&&t!==u&&(u|t)===u}}function isNoteIncludedIn(e){const t=get$b(e);return o=>{const u=note$1(o);return t&&!u.empty&&t.chroma.charAt(u.chroma)==="1"}}function filter(e){const t=isNoteIncludedIn(e);return o=>o.filter(t)}var pcset_default={get:get$b,chroma:chroma$3,num:num$1,intervals,chromas,isSupersetOf,isSubsetOf,isNoteIncludedIn,isEqual,filter,modes:modes$1,notes:notes$1,pcset:pcset$1};function chromaRotations(e){const t=e.split("");return t.map((o,u)=>rotate(u,t).join(""))}function chromaToPcset(e){const t=chromaToNumber(e),o=chromaRotations(e).map(chromaToNumber).filter(f=>f>=2048).sort()[0],u=setNumToChroma(o),p=chromaToIntervals(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:u,intervals:p}}function listToChroma(e){if(e.length===0)return EmptyPcset.chroma;let t;const o=[0,0,0,0,0,0,0,0,0,0,0,0];for(let u=0;u<e.length;u++)t=note$1(e[u]),t.empty&&(t=interval$4(e[u])),t.empty||(o[t.chroma]=1);return o.join("")}var CHORDS$3=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$5=CHORDS$3;({...EmptyPcset});var dictionary$4=[],index$5={};function all$4(){return dictionary$4.slice()}function add$6(e,t,o){const u=getQuality$3(e),p={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$4.push(p),p.name&&(index$5[p.name]=p),index$5[p.setNum]=p,index$5[p.chroma]=p,p.aliases.forEach(f=>addAlias$4(p,f))}function addAlias$4(e,t){index$5[t]=e}function getQuality$3(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$5.forEach(([e,t,o])=>add$6(e.split(" "),o.split(" "),t)),dictionary$4.sort((e,t)=>e.setNum-t.setNum);var namedSet=e=>{const t=e.reduce((o,u)=>{const p=note$1(u).chroma;return p!==void 0&&(o[p]=o[p]||note$1(u).name),o},{});return o=>t[o]};function detect$1(e,t={}){const o=e.map(p=>note$1(p).pc).filter(p=>p);return note$1.length===0?[]:findMatches(o,1,t).filter(p=>p.weight).sort((p,f)=>f.weight-p.weight).map(p=>p.name)}var BITMASK={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},testChromaNumber=e=>t=>!!(t&e),hasAnyThird=testChromaNumber(BITMASK.anyThirds),hasPerfectFifth=testChromaNumber(BITMASK.perfectFifth),hasAnySeventh=testChromaNumber(BITMASK.anySeventh),hasNonPerfectFifth=testChromaNumber(BITMASK.nonPerfectFifths);function hasAnyThirdAndPerfectFifthAndAnySeventh(e){const t=parseInt(e.chroma,2);return hasAnyThird(t)&&hasPerfectFifth(t)&&hasAnySeventh(t)}function withPerfectFifth(e){const t=parseInt(e,2);return hasNonPerfectFifth(t)?e:(t|16).toString(2)}function findMatches(e,t,o){const u=e[0],p=note$1(u).chroma,f=namedSet(e),b=modes$1(e,!1),M=[];return b.forEach((F,S)=>{const k=o.assumePerfectFifth&&withPerfectFifth(F);all$4().filter($=>o.assumePerfectFifth&&hasAnyThirdAndPerfectFifthAndAnySeventh($)?$.chroma===k:$.chroma===F).forEach($=>{const R=$.aliases[0],U=f(S);S!==p?M.push({weight:.5*t,name:`${U}${R}/${u}`}):M.push({weight:1*t,name:`${U}${R}`})})}),M}function isNamedPitch$3(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}var SIZES$4=[0,2,4,5,7,9,11],chroma$2=({step:e,alt:t})=>(SIZES$4[e]+t+120)%12,height=({step:e,alt:t,oct:o,dir:u=1})=>u*(SIZES$4[e]+t+12*(o===void 0?-100:o)),midi$1=e=>{const t=height(e);return e.oct!==void 0&&t>=-12&&t<=115?t+12:null};function isPitch$3(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var FIFTHS$3=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$3=FIFTHS$3.map(e=>Math.floor(e*7/12));function coordinates$3(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$3[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$3[t]-4*o;return[p*f,p*b]}var FIFTHS_TO_STEPS$1=[3,0,4,1,5,2,6];function pitch$1(e){const[t,o,u]=e,p=FIFTHS_TO_STEPS$1[unaltered$1(t)],f=Math.floor((t+1)/7);if(o===void 0)return{step:p,alt:f,dir:u};const b=o+4*f+STEPS_TO_OCTS$3[p];return{step:p,alt:f,oct:b,dir:u}}function unaltered$1(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$5=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$3={empty:!0,name:"",acc:""},INTERVAL_TONAL_REGEX$3="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$3="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$7=new RegExp("^"+INTERVAL_TONAL_REGEX$3+"|"+INTERVAL_SHORTHAND_REGEX$3+"$");function tokenizeInterval$3(e){const t=REGEX$7.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$5={};function interval$3(e){return typeof e=="string"?cache$5[e]||(cache$5[e]=parse$6(e)):isPitch$3(e)?interval$3(pitchName$4(e)):isNamedPitch$3(e)?interval$3(e.name):NoInterval$3}var SIZES$3=[0,2,4,5,7,9,11],TYPES$3="PMMPPMM";function parse$6(e){const t=tokenizeInterval$3(e);if(t[0]==="")return NoInterval$3;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES$3[p];if(f==="M"&&u==="P")return NoInterval$3;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt$3(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$3[p]+k+12*N),R=(F*(SIZES$3[p]+k)%12+12)%12,U=coordinates$3({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval$1(e,t){const[o,u=0]=e,p=o*7+u*12<0,f=t||p?[-o,-u,-1]:[o,u,1];return interval$3(pitch$1(f))}function qToAlt$3(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$4(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES$3[t]==="M"?"majorable":"perfectable";return M+b+altToQ$3(F,o)}function altToQ$3(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$5("A",t):fillStr$5("d",e==="perfectable"?t:t+1)}var fillStr$4=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote={empty:!0,name:"",pc:"",acc:""},cache$4=new Map,stepToLetter=e=>"CDEFGAB".charAt(e),altToAcc=e=>e<0?fillStr$4("b",-e):fillStr$4("#",e),accToAlt=e=>e[0]==="b"?-e.length:e.length;function note(e){const t=JSON.stringify(e),o=cache$4.get(t);if(o)return o;const u=typeof e=="string"?parse$5(e):isPitch$3(e)?note(pitchName$3(e)):isNamedPitch$3(e)?note(e.name):NoNote;return cache$4.set(t,u),u}var REGEX$6=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote(e){const t=REGEX$6.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote(e){return note(pitch$1(e))}var mod=(e,t)=>(e%t+t)%t,SEMI=[0,2,4,5,7,9,11];function parse$5(e){const t=tokenizeNote(e);if(t[0]===""||t[3]!=="")return NoNote;const o=t[0],u=t[1],p=t[2],f=(o.charCodeAt(0)+3)%7,b=accToAlt(u),M=p.length?+p:void 0,F=coordinates$3({step:f,alt:b,oct:M}),S=o+u+p,k=o+u,N=(SEMI[f]+b+120)%12,$=M===void 0?mod(SEMI[f]+b,12)-1188:SEMI[f]+b+12*(M+1),R=$>=0&&$<=127?$:null,U=M===void 0?null:Math.pow(2,($-69)/12)*440;return{empty:!1,acc:u,alt:b,chroma:N,coord:F,freq:U,height:$,letter:o,midi:R,name:S,oct:M,pc:k,step:f}}function pitchName$3(e){const{step:t,alt:o,oct:u}=e,p=stepToLetter(t);if(!p)return"";const f=p+altToAcc(o);return u||u===0?f+u:f}function transpose$3(e,t){const o=note(e),u=Array.isArray(t)?t:interval$3(t).coord;if(o.empty||!u||u.length<2)return"";const p=o.coord,f=p.length===1?[p[0]+u[0]]:[p[0]+u[0],p[1]+u[1]];return coordToNote(f).name}function tonicIntervalsTransposer(e,t){const o=e.length;return u=>{if(!t)return"";const p=u<0?(o- -u%o)%o:u%o,f=Math.floor(u/o),b=transpose$3(t,[0,f]);return transpose$3(b,e[p])}}function distance$3(e,t){const o=note(e),u=note(t);if(o.empty||u.empty)return"";const p=o.coord,f=u.coord,b=f[0]-p[0],M=p.length===2&&f.length===2?f[1]-p[1]:-Math.floor(b*7/12),F=u.height===o.height&&u.midi!==null&&o.midi!==null&&o.step>u.step;return coordToInterval$1([b,M],F).name}var fillStr$3=(e,t)=>Array(Math.abs(t)+1).join(e);function deprecate(e,t,o){return function(...u){return console.warn(`${e} is deprecated. Use ${t}.`),o.apply(this,u)}}var isNamed=deprecate("isNamed","isNamedPitch",isNamedPitch$3);const Core=Object.freeze(Object.defineProperty({__proto__:null,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"}));var CHORDS$2=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$4=CHORDS$2,NoChordType={...EmptyPcset,name:"",quality:"Unknown",intervals:[],aliases:[]},dictionary$3=[],index$4={};function get$a(e){return index$4[e]||NoChordType}var chordType=deprecate("ChordType.chordType","ChordType.get",get$a);function names$8(){return dictionary$3.map(e=>e.name).filter(e=>e)}function symbols(){return dictionary$3.map(e=>e.aliases[0]).filter(e=>e)}function keys$1(){return Object.keys(index$4)}function all$3(){return dictionary$3.slice()}var entries$2=deprecate("ChordType.entries","ChordType.all",all$3);function removeAll$1(){dictionary$3=[],index$4={}}function add$5(e,t,o){const u=getQuality$2(e),p={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$3.push(p),p.name&&(index$4[p.name]=p),index$4[p.setNum]=p,index$4[p.chroma]=p,p.aliases.forEach(f=>addAlias$3(p,f))}function addAlias$3(e,t){index$4[t]=e}function getQuality$2(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$4.forEach(([e,t,o])=>add$5(e.split(" "),o.split(" "),t)),dictionary$3.sort((e,t)=>e.setNum-t.setNum);var chord_type_default={names:names$8,symbols,get:get$a,all:all$3,add:add$5,removeAll:removeAll$1,keys:keys$1,entries:entries$2,chordType},SCALES=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],data_default$3=SCALES,NoScaleType={...EmptyPcset,intervals:[],aliases:[]},dictionary$2=[],index$3={};function names$7(){return dictionary$2.map(e=>e.name)}function get$9(e){return index$3[e]||NoScaleType}var scaleType=get$9;function all$2(){return dictionary$2.slice()}var entries$1=all$2;function keys(){return Object.keys(index$3)}function removeAll(){dictionary$2=[],index$3={}}function add$4(e,t,o=[]){const u={...get$b(e),name:t,intervals:e,aliases:o};return dictionary$2.push(u),index$3[u.name]=u,index$3[u.setNum]=u,index$3[u.chroma]=u,u.aliases.forEach(p=>addAlias$2(u,p)),u}function addAlias$2(e,t){index$3[t]=e}data_default$3.forEach(([e,t,...o])=>add$4(e.split(" "),t,o));var scale_type_default={names:names$7,get:get$9,all:all$2,add:add$4,removeAll,keys,entries:entries$1,scaleType},NoChord={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize$3(e){const[t,o,u,p]=tokenizeNote(e);return t===""?["",e]:t==="A"&&p==="ug"?["","aug"]:[t+o,u+p]}function get$8(e){if(e==="")return NoChord;if(Array.isArray(e)&&e.length===2)return getChord(e[1],e[0]);{const[t,o]=tokenize$3(e),u=getChord(o,t);return u.empty?getChord(e):u}}function getChord(e,t,o){const u=get$a(e),p=note(t||""),f=note(o||"");if(u.empty||t&&p.empty||o&&f.empty)return NoChord;const b=distance$3(p.pc,f.pc),M=u.intervals.indexOf(b)+1;if(!f.empty&&!M)return NoChord;const F=Array.from(u.intervals);for(let $=1;$<M;$++){const R=F[0][0],U=F[0][1],V=parseInt(R,10)+7;F.push(`${V}${U}`),F.shift()}const S=p.empty?[]:F.map($=>transpose$3(p,$));e=u.aliases.indexOf(e)!==-1?e:u.aliases[0];const k=`${p.empty?"":p.pc}${e}${f.empty||M<=1?"":"/"+f.pc}`,N=`${t?p.pc+" ":""}${u.name}${M>1&&o?" over "+f.pc:""}`;return{...u,name:N,symbol:k,type:u.name,root:f.name,intervals:F,rootDegree:M,tonic:p.name,notes:S}}var chord=deprecate("Chord.chord","Chord.get",get$8);function transpose$2(e,t){const[o,u]=tokenize$3(e);return o?transpose$3(o,t)+u:e}function chordScales(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$2().filter(u=>o(u.chroma)).map(u=>u.name)}function extended$1(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$3().filter(u=>o(u.chroma)).map(u=>t.tonic+u.aliases[0])}function reduced$1(e){const t=get$8(e),o=isSubsetOf(t.chroma);return all$3().filter(u=>o(u.chroma)).map(u=>t.tonic+u.aliases[0])}function degrees$1(e){const{intervals:t,tonic:o}=get$8(e),u=tonicIntervalsTransposer(t,o);return p=>p?u(p>0?p-1:p):""}function steps$1(e){const{intervals:t,tonic:o}=get$8(e);return tonicIntervalsTransposer(t,o)}var chord_default={getChord,get:get$8,detect:detect$1,chordScales,extended:extended$1,reduced:reduced$1,tokenize:tokenize$3,transpose:transpose$2,degrees:degrees$1,steps:steps$1,chord},DATA=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],data_default$2=DATA,VALUES=[];data_default$2.forEach(([e,t,o])=>add$3(e,t,o));var NoDuration={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function names$6(){return VALUES.reduce((e,t)=>(t.names.forEach(o=>e.push(o)),e),[])}function shorthands(){return VALUES.map(e=>e.shorthand)}var REGEX$5=/^([^.]+)(\.*)$/;function get$7(e){const[t,o,u]=REGEX$5.exec(e)||[],p=VALUES.find(M=>M.shorthand===o||M.names.includes(o));if(!p)return NoDuration;const f=calcDots(p.fraction,u.length),b=f[0]/f[1];return{...p,name:e,dots:u,value:b,fraction:f}}var value=e=>get$7(e).value,fraction=e=>get$7(e).fraction,duration_value_default={names:names$6,shorthands,get:get$7,value,fraction};function add$3(e,t,o){VALUES.push({empty:!1,dots:"",name:"",value:1/e,fraction:e<1?[1/e,1]:[1,e],shorthand:t,names:o})}function calcDots(e,t){const o=Math.pow(2,t);let u=e[0]*o,p=e[1]*o;const f=u;for(let b=0;b<t;b++)u+=f/Math.pow(2,b+1);for(;u%2===0&&p%2===0;)u/=2,p/=2;return[u,p]}function names$5(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var get$6=interval$3,name$1=e=>interval$3(e).name,semitones=e=>interval$3(e).semitones,quality=e=>interval$3(e).q,num=e=>interval$3(e).num;function simplify$2(e){const t=interval$3(e);return t.empty?"":t.simple+t.q}function invert(e){const t=interval$3(e);if(t.empty)return"";const o=(7-t.step)%7,u=t.type==="perfectable"?-t.alt:-(t.alt+1);return interval$3({step:o,alt:u,oct:t.oct,dir:t.dir}).name}var IN=[1,2,2,3,3,4,5,5,6,6,7,7],IQ="P m M m M P d P m M m M".split(" ");function fromSemitones(e){const t=e<0?-1:1,o=Math.abs(e),u=o%12,p=Math.floor(o/12);return t*(IN[u]+7*p)+IQ[u]}var distance$2=distance$5,add$2=combinator((e,t)=>[e[0]+t[0],e[1]+t[1]]),addTo=e=>t=>add$2(e,t),substract=combinator((e,t)=>[e[0]-t[0],e[1]-t[1]]);function transposeFifths$2(e,t){const o=get$6(e);if(o.empty)return"";const[u,p,f]=o.coord;return coordToInterval$1([u+t,p,f]).name}var interval_default={names:names$5,get:get$6,name:name$1,num,semitones,quality,fromSemitones,distance:distance$2,invert,simplify:simplify$2,add:add$2,addTo,substract,transposeFifths:transposeFifths$2};function combinator(e){return(t,o)=>{const u=interval$3(t).coord,p=interval$3(o).coord;if(u&&p){const f=e(u,p);return coordToInterval$1(f).name}}}function isMidi(e){return+e>=0&&+e<=127}function toMidi(e){if(isMidi(e))return+e;const t=note$1(e);return t.empty?null:t.midi}function midiToFreq(e,t=440){return Math.pow(2,(e-69)/12)*t}var L2=Math.log(2),L440=Math.log(440);function freqToMidi(e){const t=12*(Math.log(e)-L440)/L2+69;return Math.round(t*100)/100}var SHARPS="C C# D D# E F F# G G# A A# B".split(" "),FLATS="C Db D Eb E F Gb G Ab A Bb B".split(" ");function midiToNoteName(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const u=(t.sharps===!0?SHARPS:FLATS)[e%12];if(t.pitchClass)return u;const p=Math.floor(e/12)-1;return u+p}function chroma$1(e){return e%12}function pcsetFromChroma(e){return e.split("").reduce((t,o,u)=>(u<12&&o==="1"&&t.push(u),t),[])}function pcsetFromMidi(e){return e.map(chroma$1).sort((t,o)=>t-o).filter((t,o,u)=>o===0||t!==u[o-1])}function pcset(e){return Array.isArray(e)?pcsetFromMidi(e):pcsetFromChroma(e)}function pcsetNearest(e){const t=pcset(e);return o=>{const u=chroma$1(o);for(let p=0;p<12;p++){if(t.includes(u+p))return o+p;if(t.includes(u-p))return o-p}}}function pcsetSteps(e,t){const o=pcset(e),u=o.length;return p=>{const f=p<0?(u- -p%u)%u:p%u,b=Math.floor(p/u);return o[f]+b*12+t}}function pcsetDegrees(e,t){const o=pcsetSteps(e,t);return u=>{if(u!==0)return o(u>0?u-1:u)}}var index_default$4={chroma:chroma$1,freqToMidi,isMidi,midiToFreq,midiToNoteName,pcsetNearest,pcset,pcsetDegrees,pcsetSteps,toMidi},NAMES$2=["C","D","E","F","G","A","B"],toName=e=>e.name,onlyNotes=e=>e.map(note$1).filter(t=>!t.empty);function names$4(e){return e===void 0?NAMES$2.slice():Array.isArray(e)?onlyNotes(e).map(toName):[]}var get$5=note$1,name=e=>get$5(e).name,pitchClass=e=>get$5(e).pc,accidentals=e=>get$5(e).acc,octave=e=>get$5(e).oct,midi=e=>get$5(e).midi,freq=e=>get$5(e).freq,chroma=e=>get$5(e).chroma;function fromMidi(e){return midiToNoteName(e)}function fromFreq(e){return midiToNoteName(freqToMidi(e))}function fromFreqSharps(e){return midiToNoteName(freqToMidi(e),{sharps:!0})}function fromMidiSharps(e){return midiToNoteName(e,{sharps:!0})}var distance$1=distance$5,transpose$1=transpose$5,tr=transpose$5,transposeBy=e=>t=>transpose$1(t,e),trBy=transposeBy,transposeFrom=e=>t=>transpose$1(e,t),trFrom=transposeFrom;function transposeFifths$1(e,t){return transpose$1(e,[t,0])}var trFifths=transposeFifths$1;function transposeOctaves(e,t){return transpose$1(e,[0,t])}var ascending=(e,t)=>e.height-t.height,descending=(e,t)=>t.height-e.height;function sortedNames(e,t){return t=t||ascending,onlyNotes(e).sort(t).map(toName)}function sortedUniqNames(e){return sortedNames(e,ascending).filter((t,o,u)=>o===0||t!==u[o-1])}var simplify$1=e=>{const t=get$5(e);return t.empty?"":midiToNoteName(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function enharmonic(e,t){const o=get$5(e);if(o.empty)return"";const u=get$5(t||midiToNoteName(o.midi||o.chroma,{sharps:o.alt<0,pitchClass:!0}));if(u.empty||u.chroma!==o.chroma)return"";if(o.oct===void 0)return u.pc;const p=o.chroma-o.alt,f=u.chroma-u.alt,b=p>11||f<0?-1:p<0||f>11?1:0,M=o.oct+b;return u.pc+M}var index_default$3={names:names$4,get:get$5,name,pitchClass,accidentals,octave,midi,ascending,descending,distance:distance$1,sortedNames,sortedUniqNames,fromMidi,fromMidiSharps,freq,fromFreq,fromFreqSharps,chroma,transpose:transpose$1,tr,transposeBy,trBy,transposeFrom,trFrom,transposeFifths:transposeFifths$1,transposeOctaves,trFifths,simplify:simplify$1,enharmonic};function isNamedPitch$2(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$2(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$2=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$2=FIFTHS$2.map(e=>Math.floor(e*7/12));function coordinates$2(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$2[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$2[t]-4*o;return[p*f,p*b]}var fillStr$2=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$2=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$2="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$2="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$4=new RegExp("^"+INTERVAL_TONAL_REGEX$2+"|"+INTERVAL_SHORTHAND_REGEX$2+"$");function tokenizeInterval$2(e){const t=REGEX$4.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$3={};function interval$2(e){return typeof e=="string"?cache$3[e]||(cache$3[e]=parse$4(e)):isPitch$2(e)?interval$2(pitchName$2(e)):isNamedPitch$2(e)?interval$2(e.name):NoInterval$2}var SIZES$2=[0,2,4,5,7,9,11],TYPES$2="PMMPPMM";function parse$4(e){const t=tokenizeInterval$2(e);if(t[0]==="")return NoInterval$2;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES$2[p];if(f==="M"&&u==="P")return NoInterval$2;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt$2(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$2[p]+k+12*N),R=(F*(SIZES$2[p]+k)%12+12)%12,U=coordinates$2({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt$2(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$2(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES$2[t]==="M"?"majorable":"perfectable";return M+b+altToQ$2(F,o)}function altToQ$2(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$2("A",t):fillStr$2("d",e==="perfectable"?t:t+1)}var NoRomanNumeral={empty:!0,name:"",chordType:""},cache$2={};function get$4(e){return typeof e=="string"?cache$2[e]||(cache$2[e]=parse$3(e)):typeof e=="number"?get$4(NAMES$1[e]||""):isPitch$2(e)?fromPitch(e):isNamedPitch$2(e)?get$4(e.name):NoRomanNumeral}var romanNumeral=get$4;function names$3(e=!0){return(e?NAMES$1:NAMES_MINOR).slice()}function fromPitch(e){return get$4(altToAcc$1(e.alt)+NAMES$1[e.step])}var REGEX$3=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function tokenize$2(e){return REGEX$3.exec(e)||["","","",""]}var ROMANS="I II III IV V VI VII",NAMES$1=ROMANS.split(" "),NAMES_MINOR=ROMANS.toLowerCase().split(" ");function parse$3(e){const[t,o,u,p]=tokenize$2(e);if(!u)return NoRomanNumeral;const f=u.toUpperCase(),b=NAMES$1.indexOf(f),M=accToAlt$1(o),F=1;return{empty:!1,name:t,roman:u,interval:interval$2({step:b,alt:M,dir:F}).name,acc:o,chordType:p,alt:M,step:b,major:u===f,oct:0,dir:F}}var roman_numeral_default={names:names$3,get:get$4,romanNumeral},Empty=Object.freeze([]),NoKey={type:"major",tonic:"",alteration:0,keySignature:""},NoKeyScale={tonic:"",grades:Empty,intervals:Empty,scale:Empty,triads:Empty,chords:Empty,chordsHarmonicFunction:Empty,chordScales:Empty,secondaryDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty,substituteDominants:Empty,substituteDominantSupertonics:Empty,secondaryDominantsMinorRelative:Empty},NoMajorKey={...NoKey,...NoKeyScale,type:"major",minorRelative:"",scale:Empty,substituteDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty},NoMinorKey={...NoKey,type:"minor",relativeMajor:"",natural:NoKeyScale,harmonic:NoKeyScale,melodic:NoKeyScale},mapScaleToType=(e,t,o="")=>t.map((u,p)=>`${e[p]}${o}${u}`);function keyScale(e,t,o,u,p){return f=>{const b=e.map(R=>get$4(R).interval||""),M=b.map(R=>transpose$1(f,R)),F=mapScaleToType(M,o),S=M.map(R=>transpose$1(R,"5P")).map(R=>M.includes(R)&&!F.includes(R+"7")?R+"7":""),k=supertonics(S,t),N=S.map(R=>{if(!R)return"";const U=R.slice(0,-1);return transpose$1(U,"5d")+"7"}),$=supertonics(N,t);return{tonic:f,grades:e,intervals:b,scale:M,triads:mapScaleToType(M,t),chords:F,chordsHarmonicFunction:u.slice(),chordScales:mapScaleToType(M,p," "),secondaryDominants:S,secondaryDominantSupertonics:k,substituteDominants:N,substituteDominantSupertonics:$,secondaryDominantsMinorRelative:k,substituteDominantsMinorRelative:$}}}var supertonics=(e,t)=>e.map((o,u)=>{if(!o)return"";const p=o.slice(0,-1),f=transpose$1(p,"5P");return t[u].endsWith("m")?f+"m7":f+"m7b5"}),distInFifths=(e,t)=>{const o=note$1(e),u=note$1(t);return o.empty||u.empty?0:u.coord[0]-o.coord[0]},MajorScale=keyScale("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),NaturalScale=keyScale("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),HarmonicScale=keyScale("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),MelodicScale=keyScale("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function majorKey(e){const t=note$1(e).pc;if(!t)return NoMajorKey;const o=MajorScale(t),u=distInFifths("C",t);return{...o,type:"major",minorRelative:transpose$1(t,"-3m"),alteration:u,keySignature:altToAcc$1(u)}}function minorKey(e){const t=note$1(e).pc;if(!t)return NoMinorKey;const o=distInFifths("C",t)-3;return{type:"minor",tonic:t,relativeMajor:transpose$1(t,"3m"),alteration:o,keySignature:altToAcc$1(o),natural:NaturalScale(t),harmonic:HarmonicScale(t),melodic:MelodicScale(t)}}function majorTonicFromKeySignature(e){return typeof e=="number"?transposeFifths$1("C",e):typeof e=="string"&&/^b+|#+$/.test(e)?transposeFifths$1("C",accToAlt$1(e)):null}var index_default$2={majorKey,majorTonicFromKeySignature,minorKey};function isNamedPitch$1(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$1(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$1=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$1=FIFTHS$1.map(e=>Math.floor(e*7/12));function coordinates$1(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS$1[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS$1[t]-4*o;return[p*f,p*b]}var FIFTHS_TO_STEPS=[3,0,4,1,5,2,6];function pitch(e){const[t,o,u]=e,p=FIFTHS_TO_STEPS[unaltered(t)],f=Math.floor((t+1)/7);if(o===void 0)return{step:p,alt:f,dir:u};const b=o+4*f+STEPS_TO_OCTS$1[p];return{step:p,alt:f,oct:b,dir:u}}function unaltered(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$1=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$1=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$1="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$1="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$2=new RegExp("^"+INTERVAL_TONAL_REGEX$1+"|"+INTERVAL_SHORTHAND_REGEX$1+"$");function tokenizeInterval$1(e){const t=REGEX$2.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$1={};function interval$1(e){return typeof e=="string"?cache$1[e]||(cache$1[e]=parse$2(e)):isPitch$1(e)?interval$1(pitchName$1(e)):isNamedPitch$1(e)?interval$1(e.name):NoInterval$1}var SIZES$1=[0,2,4,5,7,9,11],TYPES$1="PMMPPMM";function parse$2(e){const t=tokenizeInterval$1(e);if(t[0]==="")return NoInterval$1;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES$1[p];if(f==="M"&&u==="P")return NoInterval$1;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt$1(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$1[p]+k+12*N),R=(F*(SIZES$1[p]+k)%12+12)%12,U=coordinates$1({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval(e,t){const[o,u=0]=e,f=o*7+u*12<0?[-o,-u,-1]:[o,u,1];return interval$1(pitch(f))}function qToAlt$1(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$1(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES$1[t]==="M"?"majorable":"perfectable";return M+b+altToQ$1(F,o)}function altToQ$1(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$1("A",t):fillStr$1("d",e==="perfectable"?t:t+1)}var get$3=interval$1;function simplify(e){const t=interval$1(e);return t.empty?"":t.simple+t.q}function transposeFifths(e,t){const o=get$3(e);if(o.empty)return"";const[u,p,f]=o.coord;return coordToInterval([u+t,p,f]).name}var MODES=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],NoMode={...EmptyPcset,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},modes=MODES.map(toMode),index$2={};modes.forEach(e=>{index$2[e.name]=e,e.aliases.forEach(t=>{index$2[t]=e})});function get$2(e){return typeof e=="string"?index$2[e.toLowerCase()]||NoMode:e&&e.name?get$2(e.name):NoMode}var mode=get$2;function all$1(){return modes.slice()}var entries=all$1;function names$2(){return modes.map(e=>e.name)}function toMode(e){const[t,o,u,p,f,b,M]=e,F=M?[M]:[],S=Number(o).toString(2);return{empty:!1,intervals:get$9(p).intervals,modeNum:t,chroma:S,normalized:S,name:p,setNum:o,alt:u,triad:f,seventh:b,aliases:F}}function notes(e,t){return get$2(e).intervals.map(o=>transpose$5(t,o))}function chords(e){return(t,o)=>{const u=get$2(t);if(u.empty)return[];const p=rotate(u.modeNum,e),f=u.intervals.map(b=>transpose$5(o,b));return p.map((b,M)=>f[M]+b)}}var triads$1=chords(MODES.map(e=>e[4])),seventhChords=chords(MODES.map(e=>e[5]));function distance(e,t){const o=get$2(t),u=get$2(e);return o.empty||u.empty?"":simplify(transposeFifths("1P",u.alt-o.alt))}function relativeTonic(e,t,o){return transpose$5(o,distance(e,t))}var mode_default={get:get$2,names:names$2,all:all$1,distance,relativeTonic,notes,triads:triads$1,seventhChords,entries,mode},CHORDS$1=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$1=CHORDS$1;({...EmptyPcset});var dictionary$1=[],index$1={};function add$1(e,t,o){const u=getQuality$1(e),p={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$1.push(p),p.name&&(index$1[p.name]=p),index$1[p.setNum]=p,index$1[p.chroma]=p,p.aliases.forEach(f=>addAlias$1(p,f))}function addAlias$1(e,t){index$1[t]=e}function getQuality$1(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$1.forEach(([e,t,o])=>add$1(e.split(" "),o.split(" "),t)),dictionary$1.sort((e,t)=>e.setNum-t.setNum);function isNamedPitch(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS=[0,2,4,-1,1,3,5],STEPS_TO_OCTS=FIFTHS.map(e=>Math.floor(e*7/12));function coordinates(e){const{step:t,alt:o,oct:u,dir:p=1}=e,f=FIFTHS[t]+7*o;if(u===void 0)return[p*f];const b=u-STEPS_TO_OCTS[t]-4*o;return[p*f,p*b]}var fillStr=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$1=new RegExp("^"+INTERVAL_TONAL_REGEX+"|"+INTERVAL_SHORTHAND_REGEX+"$");function tokenizeInterval(e){const t=REGEX$1.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache={};function interval(e){return typeof e=="string"?cache[e]||(cache[e]=parse$1(e)):isPitch(e)?interval(pitchName(e)):isNamedPitch(e)?interval(e.name):NoInterval}var SIZES=[0,2,4,5,7,9,11],TYPES="PMMPPMM";function parse$1(e){const t=tokenizeInterval(e);if(t[0]==="")return NoInterval;const o=+t[0],u=t[1],p=(Math.abs(o)-1)%7,f=TYPES[p];if(f==="M"&&u==="P")return NoInterval;const b=f==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(p+1),k=qToAlt(b,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES[p]+k+12*N),R=(F*(SIZES[p]+k)%12+12)%12,U=coordinates({step:p,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:p,alt:k,dir:F,type:b,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName(e){const{step:t,alt:o,oct:u=0,dir:p}=e;if(!p)return"";const f=t+1+7*u,b=f===0?t+1:f,M=p<0?"-":"",F=TYPES[t]==="M"?"majorable":"perfectable";return M+b+altToQ(F,o)}function altToQ(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr("A",t):fillStr("d",e==="perfectable"?t:t+1)}function tokenize$1(e){const[t,o,u,p]=tokenizeNote$1(e);return t===""?tokenizeBass("",e):t==="A"&&p==="ug"?tokenizeBass("","aug"):tokenizeBass(t+o,u+p)}function tokenizeBass(e,t){const o=t.split("/");if(o.length===1)return[e,o[0],""];const[u,p,f,b]=tokenizeNote$1(o[1]);return u!==""&&f===""&&b===""?[e,o[0],u+p]:[e,t,""]}function fromRomanNumerals(e,t){return t.map(get$4).map(u=>transpose$5(e,interval(u))+u.chordType)}function toRomanNumerals(e,t){return t.map(o=>{const[u,p]=tokenize$1(o),f=distance$5(e,u);return get$4(interval(f)).name+p})}var progression_default={fromRomanNumerals,toRomanNumerals};function numeric(e){const t=compact(e.map(o=>typeof o=="number"?o:toMidi(o)));return!e.length||t.length!==e.length?[]:t.reduce((o,u)=>{const p=o[o.length-1];return o.concat(range(p,u).slice(1))},[t[0]])}function chromatic(e,t){return numeric(e).map(o=>midiToNoteName(o,t))}var index_default$1={numeric,chromatic},CHORDS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default=CHORDS;({...EmptyPcset});var dictionary=[],index={};function all(){return dictionary.slice()}function add(e,t,o){const u=getQuality(e),p={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary.push(p),p.name&&(index[p.name]=p),index[p.setNum]=p,index[p.chroma]=p,p.aliases.forEach(f=>addAlias(p,f))}function addAlias(e,t){index[t]=e}function getQuality(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default.forEach(([e,t,o])=>add(e.split(" "),o.split(" "),t)),dictionary.sort((e,t)=>e.setNum-t.setNum);var NoScale={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),o=note$1(e.substring(0,t));if(o.empty){const p=note$1(e);return p.empty?["",e.toLowerCase()]:[p.name,""]}const u=e.substring(o.name.length+1).toLowerCase();return[o.name,u.length?u:""]}var names$1=names$7;function get$1(e){const t=Array.isArray(e)?e:tokenize(e),o=note$1(t[0]).name,u=get$9(t[1]);if(u.empty)return NoScale;const p=u.name,f=o?u.intervals.map(M=>transpose$5(o,M)):[],b=o?o+" "+p:p;return{...u,name:b,type:p,tonic:o,notes:f}}var scale$1=get$1;function detect(e,t={}){const o=chroma$3(e),u=note$1(t.tonic??e[0]??""),p=u.chroma;if(p===void 0)return[];const f=o.split("");f[p]="1";const b=rotate(p,f).join(""),M=all$2().find(S=>S.chroma===b),F=[];return M&&F.push(u.name+" "+M.name),t.match==="exact"||extended(b).forEach(S=>{F.push(u.name+" "+S)}),F}function scaleChords(e){const t=get$1(e),o=isSubsetOf(t.chroma);return all().filter(u=>o(u.chroma)).map(u=>u.aliases[0])}function extended(e){const t=isChroma(e)?e:get$1(e).chroma,o=isSupersetOf(t);return all$2().filter(u=>o(u.chroma)).map(u=>u.name)}function reduced(e){const t=isSubsetOf(get$1(e).chroma);return all$2().filter(o=>t(o.chroma)).map(o=>o.name)}function scaleNotes(e){const t=e.map(p=>note$1(p).pc).filter(p=>p),o=t[0],u=sortedUniqNames(t);return rotate(u.indexOf(o),u)}function modeNames(e){const t=get$1(e);if(t.empty)return[];const o=t.tonic?t.notes:t.intervals;return modes$1(t.chroma).map((u,p)=>{const f=get$1(u).name;return f?[o[p],f]:["",""]}).filter(u=>u[0])}function getNoteNameOf(e){const t=Array.isArray(e)?scaleNotes(e):get$1(e).notes,o=t.map(u=>note$1(u).chroma);return u=>{const p=note$1(typeof u=="number"?fromMidi(u):u),f=p.height;if(f===void 0)return;const b=f%12,M=o.indexOf(b);if(M!==-1)return enharmonic(p.name,t[M])}}function rangeOf(e){const t=getNoteNameOf(e);return(o,u)=>{const p=note$1(o).height,f=note$1(u).height;return p===void 0||f===void 0?[]:range(p,f).map(t).filter(b=>b)}}function degrees(e){const{intervals:t,tonic:o}=get$1(e),u=tonicIntervalsTransposer$1(t,o);return p=>p?u(p>0?p-1:p):""}function steps(e){const{intervals:t,tonic:o}=get$1(e);return tonicIntervalsTransposer$1(t,o)}var index_default={degrees,detect,extended,get:get$1,modeNames,names:names$1,rangeOf,reduced,scaleChords,scaleNotes,steps,tokenize,scale:scale$1},NONE={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},NAMES=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function names(){return NAMES.slice()}var REGEX=/^(\d*\d(?:\+\d)*)\/(\d+)$/,CACHE=new Map;function get(e){const t=JSON.stringify(e),o=CACHE.get(t);if(o)return o;const u=build(parse(e));return CACHE.set(t,u),u}function parse(e){if(typeof e=="string"){const[f,b,M]=REGEX.exec(e)||[];return parse([b,M])}const[t,o]=e,u=+o;if(typeof t=="number")return[t,u];const p=t.split("+").map(f=>+f);return p.length===1?[p[0],u]:[p,u]}var time_signature_default={names,parse,get},isPowerOfTwo=e=>Math.log(e)/Math.log(2)%1===0;function build([e,t]){const o=Array.isArray(e)?e.reduce((M,F)=>M+F,0):e,u=t;if(o===0||u===0)return NONE;const p=Array.isArray(e)?`${e.join("+")}/${t}`:`${e}/${t}`,f=Array.isArray(e)?e:[],b=u===4||u===2?"simple":u===8&&o%3===0?"compound":isPowerOfTwo(u)?"irregular":"irrational";return{empty:!1,name:p,type:b,upper:o,lower:u,additive:f}}var Tonal=Core,PcSet=pcset_default,ChordDictionary=chord_type_default,ScaleDictionary=scale_type_default;const dist$1=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:abc_notation_default,Array:index$6,Chord:chord_default,ChordDictionary,ChordType:chord_type_default,Collection:collection_default,Core,DurationValue:duration_value_default,Interval:interval_default,Key:index_default$2,Midi:index_default$4,Mode:mode_default,Note:index_default$3,PcSet,Pcset:pcset_default,Progression:progression_default,Range:index_default$1,RomanNumeral:roman_numeral_default,Scale:index_default,ScaleDictionary,ScaleType:scale_type_default,TimeSignature:time_signature_default,Tonal,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"})),flats=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],pcs=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],sharps=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],accs={b:-1,"#":1},pc2chroma=e=>{const[t,...o]=e.split("");return pcs.indexOf(t.toLowerCase())+o.reduce((u,p)=>u+accs[p],0)};function tokenizeChord$1(e){const t=(e||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}const midi2chroma=e=>e%12,step2semitones=e=>{let t=Number(e);return isNaN(t)?interval_default.semitones(e):t},x2midi=(e,t)=>{if(typeof e=="number")return e;if(typeof e=="string")return noteToMidi$1(e,t)},midi2note=(e,t=!1)=>{const o=Math.floor(e/12)-1;return(t?sharps:flats)[e%12]+o};function scaleStep$1(e,t,o=1){e=e.map(p=>typeof p=="string"?noteToMidi$1(p):p);const u=Math.floor(t/e.length)*o*12;return t=_mod$2(t,e.length),e[t]+u}function nearestNumberIndex(e,t,o){let u=0,p=1/0;return t.forEach((f,b)=>{const M=Math.abs(f-e);(!o&&M<p||o&&M<=p)&&(u=b,p=M)}),u}let scaleSteps={};function stepInNamedScale(e,t,o,u){const[p,f]=index_default.tokenize(t),b=x2midi(p),M=midi2chroma(b);if(!scaleSteps[f]){const{intervals:$}=index_default.get(`C ${f}`);scaleSteps[f]=$.map(step2semitones)}const F=scaleSteps[f];if(!F)return null;let S=b;if(o){o=x2midi(o,3);const $=midi2chroma(o),R=_mod$2($-M,12),U=nearestNumberIndex(R,F,u);e=e+U,S=o-R}const k=Math.floor(e/F.length)*12;return e=_mod$2(e,F.length),F[e]+S+k}let modeTarget={below:e=>e.slice(-1)[0],duck:e=>e.slice(-1)[0],above:e=>e[0],root:e=>e[0]};function renderVoicing({chord:e,dictionary:t,offset:o=0,n:u,mode:p="below",anchor:f="c5",octaves:b=1}){const[M,F]=tokenizeChord$1(e),S=pc2chroma(M);f=x2midi(f?.note||f,4);const k=midi2chroma(f),N=t[F].map(pe=>(typeof pe=="string"?pe.split(" "):pe).map(step2semitones));let $,R,U=N.map((pe,_e)=>{const ve=modeTarget[p](pe),we=_mod$2(k-ve-S,12);return($===void 0||we<$)&&($=we,R=_e),we});p==="root"&&(R=0);const V=Math.ceil(o/N.length)*12,z=_mod$2(R+o,N.length),K=N[z],ie=modeTarget[p](K),he=f-U[z]+V,se=K.map(pe=>he-ie+pe);let ee=se.map(pe=>midi2note(pe));return p==="duck"&&(ee=ee.filter((pe,_e)=>se[_e]!==f)),u!==void 0?[scaleStep$1(ee,u,b)]:ee}const octavesInterval=e=>(e<=0?-1:1)+e*7+"P";function getScale(e){e=e.replaceAll(":"," ");const t=index_default.get(e),{tonic:o,empty:u}=t;if(u&&isNote(e)||u&&!o)throw new Error(`Scale name ${e} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(u)throw new Error(`Invalid scale name "${e}"`);return t}function scaleStep(e,t){e=Math.ceil(e);let{intervals:o,tonic:u}=getScale(t);u=u||"C";const{pc:p,oct:f=3}=index_default$3.get(u),b=Math.floor(e/o.length),M=_mod$2(e,o.length),F=interval_default.add(o[M],octavesInterval(b));return index_default$3.transpose(p+f,F)}function scaleOffset(e,t,o){let{notes:u}=getScale(e);if(u=u.map(N=>index_default$3.get(N).pc),t=Number(t),isNaN(t))throw new Error(`scale offset "${t}" not a number`);const{pc:p,oct:f=3}=index_default$3.get(o),b=u.indexOf(p);if(b===-1)throw new Error(`note "${o}" is not in scale "${e}"`);let M=b,F=f,S=p;const k=Math.sign(t);for(;Math.abs(M-b)<Math.abs(t);){M+=k;const N=_mod$2(M,u.length);k<0&&S[0]==="C"&&(F+=k),S=u[N],k>0&&S[0]==="C"&&(F+=k)}return S+F}const{transpose,trans}=register(["transpose","trans"],function e(t,o){return o.withHap(u=>{const p=u.value.note??u.value;if(typeof p=="number"){let M;typeof t=="number"?M=t:typeof t=="string"&&(M=interval_default.semitones(t)||0);const F=p+M;return typeof u.value=="object"?u.withValue(()=>({...u.value,note:F})):u.withValue(()=>F)}if(typeof p!="string"||!isNote(p))return logger$2(`[tonal] transpose: not a note "${p}"`,"warning"),u;const f=isNaN(Number(t))?String(t):interval_default.fromSemitones(t),b=index_default$3.transpose(p,f);return typeof u.value=="object"?u.withValue(()=>({...u.value,note:b})):u.withValue(()=>b)})}),{scaleTranspose,scaleTrans,strans}=register(["scaleTranspose","scaleTrans","strans"],function(e,t){return t.withHap(o=>{if(!o.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof o.value=="object")return o.withValue(()=>({...o.value,note:scaleOffset(o.context.scale,Number(e),o.value.note)}));if(typeof o.value!="string")throw new Error("can only use scaleTranspose with notes");return o.withValue(()=>scaleOffset(o.context.scale,Number(e),o.value))})});function _convertStepToNumberAndOffset(e){let t=Number(e),o=0;if(isNaN(t)){e=String(e);const u=/^(-?\d+)([#bsf]*)$/.exec(e);if(!u)throw new Error(`invalid scale step "${e}", expected number or integer with optional # b suffixes`);t=Number(u[1]);const p=u[2]||"";o=getAccidentalsOffset$1(p)}return[t,o]}let scaleToMidisAndNotes={};function _getNearestScaleNote(e,t,o=!0){let u=typeof t=="string"?noteToMidi$1(t):t;if(scaleToMidisAndNotes[e]===void 0){const{intervals:N,tonic:$}=getScale(e),{pc:R}=index_default$3.get($),V=N.concat("8P").map(K=>index_default$3.transpose(R+"0",K)),z=V.map(noteToMidi$1);scaleToMidisAndNotes[e]=[z,V]}const[p,f]=scaleToMidisAndNotes[e],b=p[0],M=Math.floor((u-b)/12),F=p.map(N=>N+12*M),S=nearestNumberIndex(u,F,o),k=f[S];return index_default$3.transpose(k,interval_default.fromSemitones(12*M))}const scale=register("scale",function(e,t){return Array.isArray(e)&&(e=e.flat().join(" ")),t.withHaps(o=>(o=o.map(u=>{let p=u.value;const f=typeof p=="object";p=f?p:{n:p};const{note:b,n:M,value:F,...S}=p,k=b??M??F;if(k===void 0)return logger$2(`[tonal] Invalid value format for 'scale'. Value must contain n, note, or value but received keys [${Object.keys(p).join(", ")}]`,"error"),u;let N;if(isNote(k))N=_getNearestScaleNote(e,k),u.value={...S,note:N};else try{const[$,R]=_convertStepToNumberAndOffset(k);S.anchor?N=stepInNamedScale($,e,S.anchor):N=scaleStep($,e),R!=0&&(N=index_default$3.transpose(N,interval_default.fromSemitones(R)))}catch($){errorLogger$1($,"tonal");return}return u.value=f?{...S,note:N}:N,u.setContext({...u.context,scale:e})}),removeUndefineds(o)))},!0,!0);var dist={},dictionaryVoicing$1={},getBestVoicing={},hasRequiredGetBestVoicing;function requireGetBestVoicing(){if(hasRequiredGetBestVoicing)return getBestVoicing;hasRequiredGetBestVoicing=1,getBestVoicing.__esModule=!0,getBestVoicing.getBestVoicing=void 0;function e(t){var o=t.chord,u=t.range,p=t.finder,f=t.picker,b=t.lastVoicing,M=p(o,u);return M.length?f(M,b):[]}return getBestVoicing.getBestVoicing=e,getBestVoicing}var voicingsInRange={};const require$$0=getAugmentedNamespace(dist$1);var tokenizeChord={},hasRequiredTokenizeChord;function requireTokenizeChord(){if(hasRequiredTokenizeChord)return tokenizeChord;hasRequiredTokenizeChord=1,tokenizeChord.__esModule=!0,tokenizeChord.tokenizeChord=void 0;function e(t){var o=(t||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return o?o.slice(1):[]}return tokenizeChord.tokenizeChord=e,tokenizeChord}var hasRequiredVoicingsInRange;function requireVoicingsInRange(){if(hasRequiredVoicingsInRange)return voicingsInRange;hasRequiredVoicingsInRange=1,voicingsInRange.__esModule=!0,voicingsInRange.voicingsInRange=void 0;var e=require$$0,t=requireDictionaryVoicing(),o=requireTokenizeChord();function u(p,f,b){f===void 0&&(f=t.lefthand),b===void 0&&(b=["D3","A4"]);var M=(0,o.tokenizeChord)(p),F=M[0],S=M[1];if(!f[S])return[];var k=f[S].map(function($){return $.split(" ")}),N=e.Range.chromatic(b);return k.reduce(function($,R){var U=R.map(function(ie){return e.Interval.substract(ie,R[0])}),V=e.Note.transpose(F,R[0]),z=N.filter(function(ie){return e.Note.chroma(ie)===e.Note.chroma(V)}).filter(function(ie){return e.Note.midi(e.Note.transpose(ie,U[U.length-1]))<=e.Note.midi(b[1])}).map(function(ie){return e.Note.enharmonic(ie,V)}),K=z.map(function(ie){return U.map(function(he){return e.Note.transpose(ie,he)})});return $.concat(K)},[])}return voicingsInRange.voicingsInRange=u,voicingsInRange}var hasRequiredDictionaryVoicing;function requireDictionaryVoicing(){return hasRequiredDictionaryVoicing||(hasRequiredDictionaryVoicing=1,(function(e){var t=dictionaryVoicing$1&&dictionaryVoicing$1.__assign||function(){return t=Object.assign||function(M){for(var F,S=1,k=arguments.length;S<k;S++){F=arguments[S];for(var N in F)Object.prototype.hasOwnProperty.call(F,N)&&(M[N]=F[N])}return M},t.apply(this,arguments)},o=dictionaryVoicing$1&&dictionaryVoicing$1.__rest||function(M,F){var S={};for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&F.indexOf(k)<0&&(S[k]=M[k]);if(M!=null&&typeof Object.getOwnPropertySymbols=="function")for(var N=0,k=Object.getOwnPropertySymbols(M);N<k.length;N++)F.indexOf(k[N])<0&&Object.prototype.propertyIsEnumerable.call(M,k[N])&&(S[k[N]]=M[k[N]]);return S};e.__esModule=!0,e.dictionaryVoicing=e.dictionaryVoicingFinder=e.triads=e.guidetones=e.lefthand=void 0;var u=requireGetBestVoicing(),p=requireVoicingsInRange();e.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},e.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},e.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var f=function(M){return function(F,S){return(0,p.voicingsInRange)(F,M,S)}};e.dictionaryVoicingFinder=f;var b=function(M){var F=M.dictionary,S=M.range,k=o(M,["dictionary","range"]);return(0,u.getBestVoicing)(t(t({},k),{range:S,finder:(0,e.dictionaryVoicingFinder)(F)}))};e.dictionaryVoicing=b})(dictionaryVoicing$1)),dictionaryVoicing$1}var minTopNoteDiff$1={},hasRequiredMinTopNoteDiff;function requireMinTopNoteDiff(){if(hasRequiredMinTopNoteDiff)return minTopNoteDiff$1;hasRequiredMinTopNoteDiff=1,minTopNoteDiff$1.__esModule=!0,minTopNoteDiff$1.minTopNoteDiff=void 0;var e=require$$0;function t(o,u){if(!u)return o[0];var p=function(f){return Math.abs(e.Note.midi(u[u.length-1])-e.Note.midi(f[f.length-1]))};return o.reduce(function(f,b){return p(b)<p(f)?b:f},o[0])}return minTopNoteDiff$1.minTopNoteDiff=t,minTopNoteDiff$1}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(e){e.__esModule=!0;var t=requireDictionaryVoicing(),o=requireMinTopNoteDiff(),u=requireGetBestVoicing(),p=requireTokenizeChord();e.default={tokenizeChord:p.tokenizeChord,getBestVoicing:u.getBestVoicing,dictionaryVoicing:t.dictionaryVoicing,dictionaryVoicingFinder:t.dictionaryVoicingFinder,lefthand:t.lefthand,guidetones:t.guidetones,triads:t.triads,minTopNoteDiff:o.minTopNoteDiff}})(dist)),dist}var distExports=requireDist();const _voicings=getDefaultExportFromCjs(distExports),simple={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},complex={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing,minTopNoteDiff}=_voicings.default||_voicings,lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},triads={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},defaultDictionary={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},voicingRegistry={lefthand:{dictionary:lefthand,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:triads,mode:"below",anchor:"a4"},guidetones:{dictionary:guidetones,mode:"above",anchor:"a4"},legacy:{dictionary:defaultDictionary,mode:"below",anchor:"a4"}};let defaultDict="ireal";const setDefaultVoicings=e=>defaultDict=e,setVoicingRange=(e,t)=>addVoicings(e,voicingRegistry[e].dictionary,t),addVoicings=(e,t,o=["F3","A4"])=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,range:o}})},registerVoicings=(e,t,o={})=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,...o}})},getVoicing=(e,t,o)=>{const{dictionary:u,range:p}=voicingRegistry[t];return dictionaryVoicing({chord:e,dictionary:u,range:p,picker:minTopNoteDiff,lastVoicing:o})};let lastVoicing;const voicings=register("voicings",function(e,t){return t.fmap(o=>(lastVoicing=getVoicing(o,e,lastVoicing),stack(...lastVoicing))).outerJoin()}),rootNotes=register("rootNotes",function(e,t){return t.fmap(o=>{const f=(o.chord||o).match(/^([a-gA-G][b#]?).*$/)[1]+e;return o.chord?{note:f}:f})}),voicing=register("voicing",function(e){return e.fmap(t=>{t=typeof t=="string"?{chord:t}:t;let{dictionary:o=defaultDict,chord:u,anchor:p,offset:f,mode:b,n:M,octaves:F,...S}=t;o=typeof o=="string"?voicingRegistry[o]:{dictionary:o,mode:"below",anchor:"c5"};try{let k=renderVoicing({...o,chord:u,anchor:p,offset:f,mode:b,n:M,octaves:F});return stack(...k).note().set(S)}catch{return logger$2(`[voicing]: unknown chord "${u}"`),silence}}).outerJoin()});function voicingAlias(e,t,o){o=Array.isArray(o)?o:[o],o.forEach(u=>{u[t]=u[e]})}voicingAlias("^","",[simple,complex]),Object.keys(simple).forEach(e=>{if(e.includes("-")){let t=e.replace("-","m");voicingAlias(e,t,[complex,simple])}if(e.includes("^")){let t=e.replace("^","M");voicingAlias(e,t,[complex,simple])}if(e.includes("+")){let t=e.replace("+","aug");voicingAlias(e,t,[complex,simple])}}),registerVoicings("ireal",simple),registerVoicings("ireal-ext",complex);function resetVoicings(){lastVoicing=void 0,setDefaultVoicings("ireal")}const packageName="@strudel/tonal",strudelTonal=Object.freeze(Object.defineProperty({__proto__:null,addVoicings,complex,packageName,registerVoicings,resetVoicings,rootNotes,scale,scaleTrans,scaleTranspose,setDefaultVoicings,setVoicingRange,simple,strans,trans,transpose,voicing,voicingAlias,voicingRegistry,voicings},Symbol.toStringTag,{value:"Module"})),{evalScope}=strudelCore;App.scope_container_el=void 0,App.scope_canvas_el=void 0,App.scope_canvas_ctx=void 0,App.scope_analyser=void 0,App.scope_waveform=void 0,App.scope_animation_id=void 0,App.scope_connected=!1,App.scope_pixel_ratio=1,App.scope_enabled=!0,App.scope_max_y=-1,App.scope_min_y=-1,App.scope_background="#111111da",App.scope_color="rgba(204, 198, 239, 1)",App.scope_click_color_1="rgba(162, 171, 234, 0.5)",App.scope_click_color_2="rgba(255, 137, 204, 1)",App.scope_click_color_3="rgba(222, 242, 92, 1)",App.scope_click_color_4="rgba(91, 163, 240, 1)",App.scope_click_color_5="rgba(255, 255, 255, 1)",App.scope_click_level=1,App.scope_sine_time=0,App.scope_clicks=[],App.scope_click_time=3*1e3,App.scope_click_size=18,App.scope_is_drawing=!1,App.scope_click_distance=120,App.scope_mousedown_date=0,App.scope_beep_delay=300,App.scope_slide_delay=800,App.scope_slide_distance=200,App.scope_panning_zone=100,App.scope_padding_amount=.9,App.scope_enable_date=0,App.scope_click_lock=250,App.scope_debouncer_delay=50,App.max_scope_slide_y_dff=45,App.scope_click_level_time=2.8*1e3,App.many_clicks_amount=100,App.scope_gestures_enabled=!1,App.scope_clicks_min=5,App.setup_scope=()=>{App.scope_debouncer=App.create_debouncer(()=>{App.resize_scope_canvas()},App.scope_debouncer_delay),App.stor_load_scope(),App.init_scope_checkbox(),App.setup_scope_canvas(),App.start_scope_visualizer(),App.scope_enabled?App.enable_scope_visualizer():App.disable_scope_visualizer()},App.get_scope_container=()=>(App.scope_container_el||(App.scope_container_el=DOM.el("#scope-container")),App.scope_container_el),App.get_scope_canvas=()=>(App.scope_canvas_el||(App.scope_canvas_el=DOM.el("#scope-canvas")),App.scope_canvas_el),App.get_scope_dimensions=()=>{if(!App.scope_canvas_el)return{width:0,height:0};let e=App.scope_canvas_el.clientWidth,t=App.scope_canvas_el.clientHeight;return e||(e=App.scope_canvas_el.width/App.scope_pixel_ratio),t||(t=App.scope_canvas_el.height/App.scope_pixel_ratio),{width:Math.max(0,e||0),height:Math.max(0,t||0)}},App.setup_scope_canvas=()=>{let e=App.get_scope_canvas();if(e){if(!App.scope_canvas_ctx){let t=e.getContext("2d");if(!t){console.warn("Scope canvas context unavailable");return}App.scope_canvas_ctx=t}return App.resize_scope_canvas(),e}},App.resize_scope_canvas=()=>{if(!App.scope_enabled||!App.scope_canvas_el||!App.scope_canvas_ctx)return;DOM.show("#scope-container",2);let e=1;typeof window<"u"&&(e=window.devicePixelRatio||1),App.scope_pixel_ratio=e;let t=App.get_input_wrapper(),o=App.get_scope_container(),u=320;if(t&&o){let F=t.getBoundingClientRect().width,S=window.getComputedStyle(o),k=parseFloat(S.borderLeftWidth)||0,N=parseFloat(S.borderRightWidth)||0;u=F-k-N}else u=App.scope_canvas_el.clientWidth||App.scope_canvas_el.width/e;let p=App.scope_canvas_el.clientHeight||App.scope_canvas_el.height/e||80;App.scope_canvas_el.style.width=`${u}px`,App.scope_canvas_el.style.height=`${p}px`;let f=Math.round(u*e),b=Math.round(p*e);(App.scope_canvas_el.width!==f||App.scope_canvas_el.height!==b)&&(App.scope_canvas_el.width=f,App.scope_canvas_el.height=b),App.scope_canvas_ctx.setTransform(1,0,0,1,0,0),App.scope_canvas_ctx.scale(e,e),App.clear_scope_canvas()},App.clear_scope_canvas=()=>{if(!App.scope_canvas_ctx)return;let{width:e,height:t}=App.get_scope_dimensions();!e||!t||(App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(0,0,e,t))},App.ensure_scope_waveform=()=>{if(App.scope_analyser)return(!App.scope_waveform||App.scope_waveform.length!==App.scope_analyser.fftSize)&&(App.scope_waveform=new Uint8Array(App.scope_analyser.fftSize)),App.scope_waveform},App.ensure_scope_analyser=()=>{if(App.scope_analyser)return App.scope_analyser;try{let t=getAudioContext().createAnalyser();t.fftSize=2048,t.minDecibels=-90,t.maxDecibels=-10,t.smoothingTimeConstant=.85,App.scope_analyser=t,App.ensure_scope_waveform()}catch(e){console.error("Failed to create scope analyser",e),App.scope_analyser=void 0,App.scope_waveform=void 0}return App.scope_analyser},App.connect_scope_analyser=()=>{if(App.scope_connected)return!0;let e=App.ensure_scope_analyser();if(!e)return!1;try{let o=getSuperdoughAudioController()?.output?.destinationGain;return o?(o.connect(e),App.scope_connected=!0,!0):(console.warn("Scope destination missing"),!1)}catch(t){return console.warn("Failed to connect scope analyser",t),!1}},App.stop_scope_loop=()=>{App.scope_animation_id&&(cancelAnimationFrame(App.scope_animation_id),App.scope_animation_id=void 0)},App.handle_scope_click=e=>{let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),u=e.clientX-o.left,p=e.clientY-o.top;App.scope_clicks.push({x:u,y:p,timestamp:Date.now()})},App.handle_scope_mouse_down=e=>{App.mouse_down_coords=App.get_scope_coords(e),App.scope_mousedown_date=Date.now(),App.scope_is_drawing=!0,App.scope_clicks.length<=App.scope_clicks_min&&(App.scope_gestures_enabled=!0),App.handle_scope_click(e)},App.handle_scope_mouse_move=e=>{if(App.scope_is_drawing){let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),u=e.clientX-o.left,p=e.clientY-o.top;if((App.scope_max_y===-1||p>App.scope_max_y)&&(App.scope_max_y=p),(App.scope_min_y===-1||p<App.scope_min_y)&&(App.scope_min_y=p),App.scope_last_point){let f=App.scope_last_point.x,b=App.scope_last_point.y,M=u-f,F=p-b,S=Math.sqrt(M*M+F*F),k=Math.ceil(S/App.scope_click_distance);for(let N=1;N<=k;N++){let $=f+M*N/k,R=b+F*N/k;App.scope_clicks.push({x:$,y:R,timestamp:Date.now()})}}App.scope_clicks.push({x:u,y:p,timestamp:Date.now()}),App.scope_last_point={x:u,y:p}}},App.handle_scope_mouse_up=e=>{if(App.mouse_up_coords=App.get_scope_coords(e),Date.now()-App.scope_mousedown_date<=App.scope_slide_delay&&App.check_scope_slide()){App.scope_gestures_enabled=!1;return}if(App.scope_gestures_enabled){if(App.triangle_gesture()){App.gesture_function(2,()=>{App.glow_input()});return}else if(App.square_gesture()){App.gesture_function(3,()=>{App.glow_input()});return}else if(App.circle_gesture()){App.gesture_function(4,()=>{App.glow_input()});return}else if(App.scope_clicks.length>=App.many_clicks_amount){App.gesture_function(5,()=>{App.glow_input()});return}}Date.now()-App.scope_mousedown_date<=App.scope_beep_delay&&(App.splash_reverb(2),App.check_scope_panning()||App.beep_sound())},App.increase_scope_click_level=e=>{App.scope_click_level=e,clearTimeout(App.scope_click_level_timeout),App.color_interface(e),App.scope_click_level_timeout=setTimeout(()=>{App.scope_click_level=1,App.restore_interface_colors()},App.scope_click_level_time)},App.draw_star=(e,t,o,u,p,f)=>{let b=Math.PI/2*3,M=Math.PI/p;e.beginPath(),e.moveTo(t,o-f);for(let F=0;F<p;F++){let S=t+Math.cos(b)*f,k=o+Math.sin(b)*f;e.lineTo(S,k),b+=M;let N=t+Math.cos(b)*u,$=o+Math.sin(b)*u;e.lineTo(N,$),b+=M}e.lineTo(t,o-f),e.closePath()},App.draw_scope_frame=()=>{if(!App.scope_enabled){App.stop_scope_loop();return}if(!App.scope_canvas_ctx){App.stop_scope_loop();return}let{width:e,height:t}=App.get_scope_dimensions();if(!e||!t){App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame);return}let o=10;App.scope_canvas_ctx.clearRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.strokeStyle=App.scope_color,App.scope_canvas_ctx.lineWidth=2,App.scope_canvas_ctx.beginPath();let u=App.scope_analyser,p=App.ensure_scope_waveform();if(App.is_playing&&u&&p){u.getByteTimeDomainData(p);let b=e/p.length,M=0;for(let F=0;F<p.length;F+=1){let k=p[F]/128-1,N=t/2+k*(t/2);F===0?App.scope_canvas_ctx.moveTo(M,N):App.scope_canvas_ctx.lineTo(M,N),M+=b}}else{App.scope_sine_time+=.012;let b=p?p.length:2048,M=e/b,F=0;for(let S=0;S<b;S+=1){let k=S/b*(Math.PI*2)*6,$=Math.sin(k+App.scope_sine_time)*.3,R=t/2+$*(t/2);S===0?App.scope_canvas_ctx.moveTo(F,R):App.scope_canvas_ctx.lineTo(F,R),F+=M}}App.scope_canvas_ctx.stroke();let f=Date.now();App.scope_clicks=App.scope_clicks.filter(b=>f-b.timestamp<App.scope_click_time);for(let b of App.scope_clicks)App.scope_canvas_ctx.fillStyle=App[`scope_click_color_${App.scope_click_level}`],App.draw_star(App.scope_canvas_ctx,b.x,b.y,3,5,App.scope_click_size),App.scope_canvas_ctx.fill();App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame)},App.start_scope_loop=()=>{App.scope_animation_id||(App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame))},App.set_scope_visibility=e=>{let t=App.get_scope_container();t&&(e?DOM.show(t):DOM.hide(t))},App.stop_scope_visualizer=()=>{App.stop_scope_loop(),App.set_scope_visibility(!1),App.clear_scope_canvas()},App.start_scope_visualizer=()=>{App.setup_scope_canvas()&&(App.scope_connected||App.connect_scope_analyser())},App.scope_mouse_enabled=()=>Date.now()-App.scope_enable_date>=App.scope_click_lock,App.init_scope_click_handler=()=>{let e=App.get_scope_canvas();e&&(DOM.ev(e,"mousedown",t=>{App.scope_max_y=-1,App.scope_min_y=-1,App.scope_mouse_enabled()&&App.handle_scope_mouse_down(t)}),DOM.ev(e,"mousemove",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_move(t)}),DOM.ev(e,"click",t=>{App.scope_mouse_enabled()&&App.handle_scope_click(t)}),DOM.ev(document,"mouseup",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_up(t),App.scope_is_drawing=!1,App.scope_last_point=null}),DOM.ev(e,"contextmenu",t=>{t.preventDefault()}))},App.toggle_scope=()=>{App.scope_enabled?App.disable_scope_visualizer():App.enable_scope_visualizer()},App.enable_scope_visualizer=()=>{App.scope_enabled=!0,App.set_scope_visibility(!0),App.handle_scope_resize(),App.setup_scope_canvas()&&!App.scope_animation_id&&App.start_scope_loop(),App.scope_enable_date=Date.now(),App.start_scope_visualizer(),App.init_scope_click_handler(),App.stor_save_scope()},App.disable_scope_visualizer=()=>{App.scope_enabled=!1,App.stop_scope_visualizer(),App.stor_save_scope()},App.handle_scope_resize=()=>{App.scope_canvas_el&&(App.scope_debouncer.call(),App.scope_enabled||App.clear_scope_canvas())},App.init_scope_checkbox=()=>{let e=DOM.el("#scope-checkbox");e&&(e.checked=App.scope_enabled,App.scope_enabled?App.enable_scope_visualizer():App.set_scope_visibility(!1),DOM.ev(e,"change",t=>{t.target.checked?App.enable_scope_visualizer():App.disable_scope_visualizer()}))},App.ensure_scope=()=>(App.scope_promise||(App.scope_promise=evalScope(strudelCore,strudelMini,strudelWebAudio,strudelTonal).catch(e=>{throw App.scope_promise=void 0,console.error("Strudel scope failed to load",e),e})),App.scope_promise),App.get_scope_coords=e=>{let t=App.get_scope_canvas();if(t){let o=t.getBoundingClientRect(),u=e.clientX-o.left,p=e.clientY-o.top;return{x:u,y:p}}},App.clear_clicks=()=>{setTimeout(()=>{App.scope_clicks=[]},100)},App.song_cache={},App.fetch_songs_list=async()=>{try{let e=await fetch("/songs/list");if(!e.ok)throw new Error("Failed to fetch songs list");let t=await e.json();return Array.isArray(t)?t:(console.error("Songs list payload was not an array"),[])}catch(e){return console.error("Error fetching songs",e),[]}},App.fetch_song_content=async e=>{try{let t=await fetch(`/songs/${e}.js`);if(!t.ok)throw new Error(`Failed to fetch song ${e}`);let o=await t.text(),u={};return u.name=e,u.clean_name=App.underspace(e),u.raw=o,u.filtered=App.filter_code(o),App.song_cache[e]=u,App.last_code=o,o}catch(t){throw console.error("Error fetching song content",t),t}},App.create_songs_modal=()=>{let e=App.create_list_modal("songs"),t=DOM.el(".modal-title",e);t.textContent="Select Song"},App.open_songs_modal=async()=>{let e=await App.fetch_songs_list(),t=[];for(let o of e)t.push({text:o,title:"Click to load and play this song"});App.show_items_modal("songs",{items:t,action:o=>{App.load_song(o.text)}})},App.load_song=async e=>{App.close_all_modals();try{App.set_status(`Loading ${e}...`);let t=await App.fetch_song_content(e);App.stop_status_watch(),App.stop_color_cycle(),App.clear_draw_context(),App.code_scroll_active&&App.defer_code_scroll(App.code_scroll_song_pause_ms),await App.play_action(t,!0),App.set_song_context(e),App.set_status(`Playing: ${App.underspace(e)}`)}catch(t){App.set_status(`Failed to load song: ${t.message}`),console.error("Failed to load song:",t)}},App.load_song_from_query=async()=>{let t=App.get_query_params().get(App.song_query_key);if(!t)return!1;try{App.set_status(`Loading ${t}...`);let o=await App.fetch_song_content(t);return App.set_input(o),App.set_song_context(t),App.set_status(`Loaded: ${App.underspace(t)}`),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.set_song_context=(e="")=>{App.current_song=e||"",App.set_title(App.underspace(App.current_song)),App.update_url(App.current_song),App.update_title()},App.random_song=async()=>{try{let e=await App.fetch_songs_list();if(!e.length){console.error("No songs available to pick from");return}let t=e.filter(p=>p!==App.current_song);if(!t.length){console.error("No songs available after filtering out the current song");return}let o=App.random_int({min:0,max:t.length-1}),u=t[o];await App.load_song(u)}catch(e){console.error("Error selecting a random song",e)}},App.get_matched_song=()=>{for(let e in App.song_cache){let t=App.song_cache[e];if(t.filtered===App.last_code)return t;if(t.raw===App.last_code)return t}},App.get_song_name=(e=!1)=>{let t=App.get_matched_song(),o="";return t&&(e?o=t.clean_name:o=t.name),o},App.modal_factory=(e,t)=>{let o=DOM.el(`#${t}`),u=DOM.create("div");u.innerHTML=o.innerHTML,DOM.el("#modals").appendChild(u);let p=DOM.el(".modal",u);return p.id=`${e}-modal`,p},App.create_modal=e=>App.modal_factory(e,"template-modal"),App.create_list_modal=e=>{let t=App.modal_factory(e,"template-list-modal"),o=DOM.el(".modal-filter",t);return o.id=`${e}-modal-filter`,t},App.create_modals=()=>{App.create_about_modal(),App.create_songs_modal(),App.create_auto_modal(),App.create_visual_modal(),App.create_settings_modal(),DOM.ev("#main","click",e=>{let t=e.target.closest(".modal-close");if(t){let o=t.closest(".modal");o&&App.do_close_modal(o)}}),DOM.ev("#modal-overlay","click",e=>{App.close_all_modals()})},App.show_items_modal=async(e,t={})=>{let o={loaded:!1,active:-1,capitalize:!0,icons:!0};App.def_args(o,t);let u=t.loaded||!1,p=DOM.el(`#${e}-modal`),f=DOM.el(".modal-body",p),b=DOM.el(".modal-filter",p);if(u&&(f.innerHTML='<div class="loading">Loading items...</div>'),b&&(b.value="",b.disabled=!0,b.oninput=null,b.onkeydown=null),!t.items.length){f.innerHTML='<div class="loading">Nothing found</div>';return}let M=S=>{if(f.innerHTML="",!S.length){f.innerHTML='<div class="loading">No results</div>';return}for(let[k,N]of S.entries()){let $=DOM.create("div"),R=DOM.create("div");$.className="modal-item";let U=N.alt_text||N.text;if(t.icons){let V=DOM.create("canvas","modal-icon");V.width=25,V.height=25,$.appendChild(V),jdenticon.update(V,U)}t.capitalize&&(U=App.capitalize(U)),R.textContent=App.underspace(U),$.title=N.title,DOM.ev($,"click",()=>t.action(N)),t.active===k&&$.classList.add("modal-active-item"),$.appendChild(R),f.appendChild($)}};if(M(t.items),!b)return;let F=()=>{let S=b.value.trim().toLowerCase();if(!S){M(t.items);return}let k=t.items.filter(N=>(N.alt_text||N.text).toLowerCase().includes(S));M(k)};b.disabled=!1,b.focus(),b.oninput=F,b.onkeydown=S=>{if(S.key!=="Enter")return;S.preventDefault();let k=DOM.els(".modal-item",f);for(let N of k){N.click();break}},App.do_open_modal(p),App.focus_modal_filter(e)},App.open_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_open_modal(t)},App.do_open_modal=e=>{let t=DOM.el(".modal-body",e);App.show_overlay(),e.classList.add("active"),t.scrollTop=0},App.close_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_close_modal(t)},App.do_close_modal=e=>{e.classList.remove("active"),DOM.els(".modal.active").length===0&&App.hide_overlay()},App.close_all_modals=()=>{let e=DOM.els(".modal");for(let t of e)App.do_close_modal(t)},App.close_current_modal=()=>{let e=DOM.els(".modal.active");if(e.length>0){let t=e[e.length-1];App.do_close_modal(t)}},App.modal_open=()=>DOM.els(".modal.active").length>0,App.show_overlay=()=>{DOM.show("#modal-overlay")},App.hide_overlay=()=>{DOM.hide("#modal-overlay")},App.focus_modal_filter=e=>{let t=DOM.el(`#${e}-modal-filter`);t&&t.focus()},App.create_about_modal=()=>{let e=App.create_modal("about"),t=DOM.el(".modal-header",e),o=DOM.create("img","","modal-about-image");o.src="/img/slide.png",t.prepend(o);let u=DOM.el(".modal-title",e),p=`v${App.config.version}`;u.textContent=`Slide | ${p} | Merkoba | 2025 | ${App.commit_hash}`,u.id="modal-title-about",u.title="Name | Version | Company | Year | Commit Hash";let f=DOM.el(".modal-body",e);f.id="modal-body-about",f.innerHTML=`
    <div class="about-item">Slide is a music player that uses <a target=_blank class="popup" href="https://strudel.cc">strudel</a> code.</div>
    <div class="about-item">It's meant to allow automatic & seamless code updates.</div>
    <div class="about-item">There's a song picker to play elaborate tunes.</div>
    <div class="about-item">The code can be edited in real time and applied with Play.</div>
    <div class="about-item">The scope visualizer can be clicked in the left/center/right.</div>
    <div class="about-item">Clicking the scope produces a tone and a reverb affect.</div>
    <div class="about-item">Clicking the scope on the left produces left panning.</div>
    <div class="about-item">Clicking the scope on the right produces right panning.</div>
    <div class="about-item">A straight line to the left on the scope sets the next visual.</div>
    <div class="about-item">A straight line to the right on the scope opens a random song.</div>
    <div class="about-item">Ctrl+s = Starts playback / Updates code.</div>
    <div class="about-item">Escape = Closes top modal or stops playback.</div>
    <div class="about-item">Ctrl+1 = Show the sound context.</div>
    <div class="about-item">Ctrl+2 = Show the note context.</div>
    <div class="about-item">Ctrl+3 = Show the bank context.</div>
    <div class="about-item">Try drawing a triangle on the scope.</div>
    <div class="about-item">Try drawing a rectangle on the scope.</div>
    <div class="about-item">Try drawing a circle on the scope.</div>
    <hr>
    <div class="about-item">Credit: Gemini</div>
    <div class="about-item">Credit: ChatGPT</div>
    <div class="about-item">Credit: Claude</div>
  `},App.open_about_modal=()=>{App.open_modal("about")},App.auto_delay=5,App.auto_endpoint="/status",App.setup_auto=()=>{let e=DOM.el("#auto-start");e&&DOM.ev(e,"click",()=>{let p=DOM.el("#auto-input");p&&App.start_auto(p.value)});let t=DOM.el("#auto-default");t&&DOM.ev(t,"click",()=>{App.start_auto("/status")});let o=DOM.el("#auto-input");o&&DOM.ev(o,"keydown",p=>{if(p.key==="Enter"){p.preventDefault();let f=DOM.el("#auto-input");f&&App.start_auto(f.value)}});let u=DOM.el("#auto-delay");u&&DOM.ev(u,"change",p=>{App.auto_delay=parseInt(p.target.value,10),App.stor_save_auto_delay(),App.fetch_timer&&App.strudel_watch_status()})},App.create_auto_modal=()=>{let e=App.create_modal("auto"),t=DOM.el(".modal-title",e);t.textContent="Auto Mode";let o=DOM.el(".modal-body",e);o.id="modal-body-auto";let u=DOM.create("div","","auto-info");u.textContent="Code will be fetched periodically";let p=DOM.create("select","modal-select","auto-delay");p.innerHTML=`
    <option value="1">1 second</option>
    <option value="5" selected>5 seconds</option>
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300">5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="900">15 minutes</option>
    <option value="1200">20 minutes</option>
    <option value="1800">30 minutes</option>
    <option value="3600">1 hour</option>
  `;let f=DOM.create("input","","auto-input");f.classList.add("modal-input"),f.placeholder="Endpoint URL";let b=DOM.create("div","modal-buttons","auto-buttons");b.innerHTML=`
    <button id="auto-default">Default</button>
    <button id="auto-start">Start</button>
  `,o.appendChild(u),o.appendChild(p),o.appendChild(f),o.appendChild(b)},App.open_auto_modal=()=>{App.open_modal("auto"),DOM.el("#auto-delay").value=App.auto_delay,DOM.el("#auto-input").value=App.auto_endpoint},App.start_auto=async e=>{if(App.close_modal("auto"),!e||!e.trim()){App.set_status("Invalid endpoint");return}if(App.auto_endpoint=e.trim(),App.stor_save_auto_endpoint(),!await App.ensure_strudel_ready())return;App.strudel_watch_status();let o=App.truncate_path(App.auto_endpoint);App.set_status(`Auto mode running (${o})`)},App.fetch_status_code=async()=>{const e=await fetch(App.auto_endpoint,{cache:"no-store"});if(!e.ok)throw new Error(`Status endpoint returned ${e.status}`);return e.text()},App.stop_status_watch=()=>{App.clear_status_watch()},App.strudel_watch_status=()=>{if(!App.strudel_watch_status){console.warn("Polling function missing. Did strudel bundle load?");return}if(!App.auto_delay||App.auto_delay<=0){console.error("Provide a fetch interval in seconds greater than zero");return}App.status_watch_cancelled=!1;const e=App.auto_delay*1e3,t=async()=>{if(console.info("Fetching status..."),!App.fetch_in_flight){App.fetch_in_flight=!0;try{const u=(await App.fetch_status_code()).trim();if(!u)return;if(App.status_watch_cancelled){console.info("Status watch was cancelled, skipping play action");return}App.set_song_context(),App.audio_started?await App.play_action(u):App.code_to_play=u}catch(o){console.error("Failed to update Strudel status",o)}finally{App.fetch_in_flight=!1}}};App.clear_status_watch(!1),t(),App.fetch_timer=setInterval(()=>{t()},e),console.info("Interval started.")},App.clear_status_watch=(e=!0)=>{App.fetch_timer&&(console.info("Interval cleared."),clearInterval(App.fetch_timer),App.fetch_timer=void 0,e&&(App.status_watch_cancelled=!0))},App.animation_frames=0,App.visual_items=[{text:"auto",alt_text:"Auto - The code sets it",title:"Let the code decide. If the code contains animation calls they will be visible, else it will be a solid background"},{text:"none",alt_text:"None - Solid background",title:"Use a solid background. Most performant option"},{text:"flux surface",title:"A shimmering, flowing horizon where colors swirl like a sunset blending into dawn, a landscape in constant motion that feels alive and mysterious, like walking through a translucent, rippling lake of light"},{text:"hyper rose",title:"A surreal garden of glowing petals that pulse with vibrant energy, blossoms blooming in impossible hues, evoking a sense of wonder and infinite growth in a dreamlike meadow"},{text:"bio tunnel",title:"A lush, organic corridor woven with twisting vines and luminous flora, evoking the feeling of wandering through an underground rainforest alive with whispers of nature’s secret life"},{text:"liquid aether",title:"A flowing, translucent river of ethereal substance, shimmering with iridescent waves that pulse softly, inviting you to drift through an otherworldly sea of pure energy and serenity"},{text:"aurora borealis",title:"A celestial dance of shimmering lights in the night sky, ribbons of green, pink, and purple swirling gracefully over icy mountains, evoking awe and the mysterious beauty of the polar skies"},{text:"orb balloons",title:"A whimsical cluster of floating orbs, each glowing softly like lanterns drifting lazily in a gentle breeze, creating a playful, dreamlike atmosphere of floating serenity and joyful levity"}],App.start_visual=()=>{App.visual=App.visual||"auto",App.background_canvas=DOM.el("#background-canvas"),App.background_canvas_ctx=App.background_canvas.getContext("2d"),App.visual_animations=[App.anim_neon_waves],window.addEventListener("resize",()=>{App.background_canvas&&(App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight)}),App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight,App.apply_visual(App.visual)},App.create_visual_modal=()=>{let e=App.create_list_modal("visual"),t=DOM.el(".modal-title",e);t.textContent="Select Visual"},App.open_visual_modal=async()=>{let e=App.visual_items;App.show_items_modal("visual",{items:e,action:t=>{let o=t.text.toLowerCase();App.apply_visual(o),App.close_modal("visual")},active:App.get_active_visual_index()})},App.apply_visual=e=>{App.visual=e,App.stor_save_visual(),["auto"].includes(e)?(App.clear_visual(),App.background_canvas.classList.add("under")):["none"].includes(e)?(App.clear_visual(),App.background_canvas.classList.remove("under")):(App.background_canvas.classList.remove("under"),App.render_animation())},App.anim_bio_tunnel=(e,t,o,u)=>{let p=t/2,f=o/2,b=u*.02;for(let M=0;M<40;M++){let F=(M*20+u*5)%1e3,S=1e3/(F+10);if(S>20)continue;e.beginPath(),e.lineWidth=2*S;let k=(b*50+F*.5)%360;e.strokeStyle=`hsla(${k}, 80%, 60%, ${F/1e3})`;for(let N=0;N<=6;N++){let $=N/6*Math.PI*2,U=(200+Math.sin(b*3+$*4)*50)*S,V=b*.5,z=p+Math.cos($+V)*U,K=f+Math.sin($+V)*U;N===0?e.moveTo(z,K):e.lineTo(z,K)}e.closePath(),e.stroke()}},App.anim_flux_surface=(e,t,o,u)=>{let p=30,f=40,b=u*.03,M=b*2,F=65;e.lineWidth=2;let S=[];for(let k=0;k<=t;k+=f)S.push(Math.sin(k*.005+b)*50);for(let k=-F;k<o+F;k+=p){let N=k*.01,$=(k*.2+u*.5)%360;e.strokeStyle=`hsla(${$}, 60%, 60%, 0.8)`,e.beginPath();let R=0;for(let U=0;U<=t;U+=f){let V=S[R],z=Math.sin(U*.02-M+N)*15;e.lineTo(U,k+V+z),R++}e.stroke()}},App.anim_hyper_rose=(e,t,o,u)=>{let p=t/2,f=o/2,b=Math.max(t,o)*.8,M=u*.002,F=Math.PI*2,S=.01;e.lineWidth=2,e.lineJoin="round",e.globalCompositeOperation="lighter";for(let k=0;k<8;k++){let N=k/8,$=b*(1-N),R=(u*.2+k*15)%360;e.strokeStyle=`hsla(${R}, 80%, 50%, 0.6)`,e.beginPath();for(let U=0;U<F;U+=S){let V=Math.sin(U*7+M*5)*Math.cos(U*3-M),z=$*(.5+.5*V),K=U+M*(k+1),ie=p+Math.cos(K)*z,he=f+Math.sin(K)*z;e.lineTo(ie,he)}e.closePath(),e.stroke()}e.globalCompositeOperation="source-over"},App.anim_liquid_aether=(e,t,o,u)=>{let p=80,f=.6,b=4;(!App.flow_particles||App.flow_particles.length!==p)&&(App.flow_particles=Array(p).fill().map(()=>{let S=Math.random()*100;return{x:Math.random()*t,y:Math.random()*o,speed:f,life:S,max_life:S,angle_offset:Math.random()*Math.PI*2,size:Math.random()*4+2}})),(!App.bg_orbs||App.bg_orbs.length!==b)&&(App.bg_orbs=Array(b).fill().map((S,k)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*1,vy:(Math.random()-.5)*1,radius:Math.random()*500+400,hue:k*50}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(15, 10, 30, 0.1)",e.fillRect(0,0,t,o);let M=u*.002;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(S=>{S.x+=S.vx+Math.sin(M)*1,S.y+=S.vy+Math.cos(M)*1,S.x<-S.radius&&(S.x=t+S.radius),S.x>t+S.radius&&(S.x=-S.radius),S.y<-S.radius&&(S.y=o+S.radius),S.y>o+S.radius&&(S.y=-S.radius);let k=e.createRadialGradient(S.x,S.y,0,S.x,S.y,S.radius),N=.4+Math.sin(M*2+S.hue)*.2;k.addColorStop(0,`hsla(${S.hue+u*.1}, 80%, 60%, ${N})`),k.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=k,e.beginPath(),e.arc(S.x,S.y,S.radius,0,Math.PI*2),e.fill()}),e.globalCompositeOperation="source-over";let F=5e-4;App.flow_particles.forEach(S=>{S.life--,S.life<=0&&(S.x=Math.random()*t,S.y=Math.random()*o,S.life=100+Math.random()*100,S.max_life=S.life,S.size=Math.random()*4+2),e.beginPath();let k=(u*.1+S.x*.02+S.y*.02)%360,N=(S.max_life-S.life)/50,$=S.life/50,R=Math.min(N,$,.8);R=Math.max(0,R),e.fillStyle=`hsla(${k}, 90%, 80%, ${R})`,e.arc(S.x,S.y,S.size,0,Math.PI*2),e.fill();let U=Math.cos(S.x*F+M)+Math.sin(S.y*F+M)+S.angle_offset;S.x+=Math.cos(U)*S.speed,S.y+=Math.sin(U)*S.speed,S.x<-10&&(S.x=t+10),S.x>t+10&&(S.x=-10),S.y<-10&&(S.y=o+10),S.y>o+10&&(S.y=-10)})},App.anim_orb_balloons=(e,t,o,u)=>{let p=8;(!App.bg_orbs||App.bg_orbs.length!==p)&&(App.bg_orbs=Array(p).fill().map((b,M)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*3,vy:(Math.random()-.5)*3,base_radius:Math.random()*150+100,hue:Math.random()*360,phase:Math.random()*Math.PI*2}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(15, 5, 25, 0.2)",e.fillRect(0,0,t,o);let f=u*.01;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(b=>{b.x+=b.vx,b.y+=b.vy,b.x<-b.base_radius&&(b.vx*=-1),b.x>t+b.base_radius&&(b.vx*=-1),b.y<-b.base_radius&&(b.vy*=-1),b.y>o+b.base_radius&&(b.vy*=-1);let M=b.base_radius+Math.sin(f+b.phase)*50,F=e.createRadialGradient(b.x,b.y,0,b.x,b.y,M),S=(b.hue+u*.5)%360;F.addColorStop(0,`hsla(${S}, 80%, 60%, 0.6)`),F.addColorStop(1,`hsla(${S}, 80%, 40%, 0)`),e.fillStyle=F,e.beginPath(),e.arc(b.x,b.y,M,0,Math.PI*2),e.fill()}),e.globalCompositeOperation="source-over"},App.anim_aurora_borealis=(e,t,o,u)=>{let p=u*.02;e.lineWidth=2,e.globalCompositeOperation="lighter";for(let f=0;f<5;f++){e.beginPath();let b=o*.8,M=(u*.5+f*50)%360;e.fillStyle=`hsla(${M}, 60%, 50%, 0.3)`,e.moveTo(0,o);for(let F=0;F<=t;F+=20){let S=Math.sin(F*.002+p+f)*100+Math.sin(F*.01-p*2)*50;e.lineTo(F,b+S-f*100)}e.lineTo(t,o),e.closePath(),e.fill()}e.globalCompositeOperation="source-over"},App.render_animation=()=>{if(["auto","none"].includes(App.visual))return;let e=window.innerWidth,t=window.innerHeight,o="rgba(0, 0, 0, 0.12)";if(App.background_canvas_ctx.fillStyle=o,App.background_canvas_ctx.fillRect(0,0,e,t),App.visual==="bio tunnel")App.anim_bio_tunnel(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="flux surface")App.anim_flux_surface(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="hyper rose")App.anim_hyper_rose(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="liquid aether")App.anim_liquid_aether(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="aurora borealis")App.anim_aurora_borealis(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="orb balloons")App.anim_orb_balloons(App.background_canvas_ctx,e,t,App.animation_frames);else{App.apply_visual("auto");return}App.animation_frames++,requestAnimationFrame(App.render_animation)},App.clear_visual=()=>{let e=window.innerWidth,t=window.innerHeight;App.background_canvas_ctx.clearRect(0,0,e,t)},App.get_active_visual_index=()=>App.visual_items.map(e=>e.text).indexOf(App.visual),App.next_visual=()=>{let e=App.get_active_visual_index();e+=1,e>=App.visual_items.length&&(e=0),e<=1&&(e=2);let t=App.visual_items[e];App.apply_visual(t.text)},App.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},App.escape_regex=e=>e.replace(/[\^$*+?.()|[\]{}-]/g,"\\$&"),App.underspace=e=>e.replace(/_+/g," ").trim(),App.clean_canvas=()=>{let e=document.body,t=DOM.els("canvas");for(let o of t)["scope-canvas","background-canvas"].includes(o.id)||Array.from(o.classList).some(p=>["modal-icon"].includes(p))||e.removeChild(o)},App.truncate_path=(e,t=20)=>e.length<=t?e:e.substring(0,t)+"...",App.random_int=(e={})=>{let t={exclude:[]};if(App.def_args(t,e),e.exclude.length>0){let o=[];for(let p=e.min;p<=e.max;p++)e.exclude.includes(p)||o.push(p);if(o.length===0)return;let u;return e.rand?u=Math.floor(e.rand()*o.length):u=Math.floor(Math.random()*o.length),o[u]}return e.rand?Math.floor(e.rand()*(e.max-e.min+1)+e.min):Math.floor(Math.random()*(e.max-e.min+1)+e.min)},App.create_debouncer=(e,t)=>{if(typeof e!="function"){App.error("Invalid debouncer function");return}if(typeof t!="number"||t<1){App.error("Invalid debouncer delay");return}let o,u={};function p(){clearTimeout(o),o=void 0}function f(...b){e(...b)}return u.call=(...b)=>{p(),o=setTimeout(()=>{f(...b)},t)},u.call_2=(...b)=>{o||u.call(b)},u.now=(...b)=>{p(),f(...b)},u.cancel=()=>{p()},u},App.boolstring=e=>e&&e==="true",App.capitalize=e=>e.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),App.get_el_height=e=>{if(!e)return 0;let t=window.getComputedStyle(e),o=e.clientHeight,u=parseFloat(t.paddingTop)||0,p=parseFloat(t.paddingBottom)||0,f=parseFloat(t.marginTop)||0,b=parseFloat(t.marginBottom)||0;return o-u-p+u+p+f+b},App.viewport_height=()=>window.innerHeight||document.documentElement.clientHeight,App.tempo_storage_key="slide.tempo",App.auto_endpoint_storage_key="slide.auto_endpoint",App.auto_delay_storage_key="slide.auto_delay",App.volume_storage_key="slide.volume",App.visual_storage_key="slide.visual",App.scope_storage_key="slide.scope",App.colors_storage_key="slide.colors",App.code_storage_key="slide.code",App.load_storage=(e,t)=>{let o=localStorage.getItem(App[`${e}_storage_key`]);[null,void 0].includes(o)||t(o)},App.save_storage=(e,t)=>{localStorage.setItem(App[`${e}_storage_key`],t)},App.load_all_storage=()=>{App.stor_load_auto_endpoint(),App.stor_load_auto_delay(),App.stor_load_tempo(),App.stor_load_volume(),App.stor_load_visual(),App.stor_load_scope(),App.stor_load_colors(),App.stor_load_code()},App.stor_load_auto_endpoint=()=>{App.load_storage("auto_endpoint",e=>{App.auto_endpoint=e})},App.stor_load_auto_delay=()=>{App.load_storage("auto_delay",e=>{App.auto_delay=parseInt(e)})},App.stor_load_tempo=()=>{App.load_storage("tempo",e=>{App.tempo=parseInt(e)})},App.stor_load_volume=()=>{App.load_storage("volume",e=>{App.volume=parseInt(e)})},App.stor_load_visual=()=>{App.load_storage("visual",e=>{App.visual=e})},App.stor_load_scope=()=>{App.load_storage("scope",e=>{App.scope_enabled=App.boolstring(e)})},App.stor_load_colors=()=>{App.load_storage("colors",e=>{App.colors_enabled=App.boolstring(e)})},App.stor_load_code=()=>{App.load_storage("code",e=>{App.last_code=e})},App.stor_save_auto_delay=()=>{App.save_storage("auto_delay",App.auto_delay)},App.stor_save_auto_endpoint=()=>{App.save_storage("auto_endpoint",App.auto_endpoint)},App.stor_save_tempo=()=>{App.save_storage("tempo",App.tempo)},App.stor_save_volume=()=>{App.save_storage("volume",App.volume)},App.stor_save_visual=()=>{App.save_storage("visual",App.visual)},App.stor_save_scope=()=>{App.save_storage("scope",App.scope_enabled)},App.stor_save_colors=()=>{App.save_storage("colors",App.colors_enabled)},App.stor_save_code=()=>{App.save_storage("code",App.last_code)},App.beep_sound=()=>{try{let e=App.get_audio_context(),t=e.createOscillator(),o=e.createGain();t.type="triangle",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.linearRampToValueAtTime(445,e.currentTime+.1),o.gain.setValueAtTime(.05,e.currentTime),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),t.connect(o),o.connect(e.destination),t.start(),t.stop(e.currentTime+.2)}catch(e){console.error("Failed to play sound",e)}},App.get_audio_context=()=>{if(window.master_fx&&window.master_fx.context)return window.master_fx.context;if(App.audio_context)return App.audio_context;try{return App.audio_context=new(AudioContext||window.webkitAudioContext),App.audio_context}catch{return console.error("Web Audio API is not supported"),null}},App.splash_reverb=e=>{window.master_fx.splash_reverb(e)},App.set_panning=(e,t=0)=>{if(window.master_fx.set_panning(e),t>0){clearInterval(App.panning_interval);let o=e/(t*1e3/50),u=e;App.panning_interval=setInterval(()=>{u-=o,Math.abs(u)<=Math.abs(o)?(window.master_fx.set_panning(0),clearInterval(App.panning_interval)):window.master_fx.set_panning(u)},50)}},App.get_panning=()=>App.panning.pan.value,App.set_gain=e=>{window.master_fx.set_volume(e)},App.set_eq=(e,t,o)=>{window.master_fx.set_eq_freqs(e,t,o)},App.start_auto_pan=(e=2,t=.8)=>{window.master_fx.set_auto_pan(e,t)},App.stop_auto_pan=()=>{window.master_fx.set_auto_pan(0,0)},App.spin_panning=(e=2e3)=>{App.start_auto_pan(4,1),setTimeout(()=>{App.stop_auto_pan()},e)},App.is_playing=!1,App.play_running=!1,App.reset_playing=()=>{App.play_running=!1},App.play_action=async(e="",t=!1)=>{if(console.info("🔮 Play Action"),App.play_running)return;if(App.play_running=!0,App.update_url(),!await App.ensure_strudel_ready()){App.reset_playing();return}if(e||(e=App.get_input_value()),!e){App.reset_playing(),App.stop_action();return}if(!t&&e===App.last_code){App.reset_playing();return}App.stop_status_watch(),App.restart_code_scroll(),App.last_code=e,App.stor_save_code(),App.clear_draw_context(),App.start_color_cycle(),App.clean_canvas(),App.update_title(),App.is_playing=!0;try{await App.strudel_update(e)}catch(u){App.set_status(`Error: ${u.message}`)}App.reset_playing()},App.stop_action=()=>{console.info("🔮 Stop Action"),App.stop_status_watch(),App.stop_strudel(),App.stop_code_scroll(),App.clear_draw_context(),App.set_stop_status(),App.set_song_context(""),App.is_playing=!1},App.stop_strudel=()=>{App.stop_color_cycle(),App.clear_draw_context(),App.scheduler.stop(),App.clean_canvas()},App.strudel_update=async e=>{if(!App.audio_started){console.warn("Audio not started yet. Call strudel_init() first.");return}console.info("Updating 💨"),await App.ensure_scope(),App.set_tempo(),App.update_url();let t=await App.run_eval(e);if(t.ok){App.playing();return}App.do_partial_updates&&await App.apply_partial_update(e)||App.report_eval_failure(t.error)},App.playing=e=>{let t="",o=App.get_song_name(!0);o&&(t=`Playing: ${o}`),t||(App.beat_title?t=`Playing: ${App.beat_title}`:t="Playing 🥁"),e&&(t=`${t} - ${e}`.trim()),App.set_status(t)},App.set_stop_status=()=>{let e=App.get_song_name(!0);e?App.set_status(`Stopped: ${e}`):App.set_status("Stopped")},App.load_last_code=()=>{App.last_code&&App.set_input(App.last_code)},App.load_code_from_query=()=>{let t=new URLSearchParams(window.location.search).get(App.code_query_key);if(!t)return!1;try{return App.last_code=t,App.load_last_code(),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.set_cpm_from_query=()=>{let t=App.get_query_params().get(App.cpm_query_key);if(t){let o=parseInt(t,10);Number.isFinite(o)&&(App.update_tempo(o),App.set_tempo())}},App.set_beat_title_from_query=()=>{let t=App.get_query_params().get(App.beat_query_key);t&&(App.beat_title=t)},App.create_settings_modal=()=>{let e=App.create_modal("settings"),t=DOM.el(".modal-title",e);t.textContent="Settings";let o=DOM.el(".modal-body",e),u=App.register_setting("Select Visual","Change the background animation",()=>{App.open_visual_modal()}),p=App.register_setting("Toggle Scope","Show or hide the scope visualizer",()=>{App.toggle_scope()}),f=App.register_setting("Toggle Colors","Enable or disable the color animation",()=>{App.toggle_colors()});o.appendChild(u),o.appendChild(p),o.appendChild(f)},App.register_setting=(e,t,o)=>{let u=DOM.create("button");return u.textContent=e,u.title=t,DOM.ev(u,"click",()=>{o(),App.close_modal("settings")}),u},App.open_settings_modal=()=>{App.open_modal("settings")},App.beat_title="",App.setup_status=()=>{App.status_debouncer=App.create_debouncer(t=>{App.do_set_status(t)},200);let e=App.get_status();DOM.ev(e,"click",()=>{App.ask_for_title()}),DOM.ev(e,"wheel",t=>{t.deltaY<0?e.scrollLeft-=20:t.deltaY>0&&(e.scrollLeft+=20)})},App.get_status=()=>DOM.el("#status"),App.set_status=e=>{App.status_debouncer&&App.status_debouncer.call(e)},App.do_set_status=e=>{let t=App.get_status();t.scrollTop=0,t.scrollLeft=0,t.innerText=e},App.ask_for_title=()=>{if(App.get_matched_song())return;let t=prompt("Title of this beat");t&&(App.beat_title=t.trim(),App.update_url(),App.update_title(),App.is_playing&&App.playing())},App.start_keyboard=()=>{DOM.ev(document,"keydown",e=>{if(e.key==="s")e.ctrlKey&&(e.preventDefault(),App.play_action());else if(e.key==="Escape"){if(e.preventDefault(),NeedContext.open)return;App.modal_open()?App.close_current_modal():App.stop_action()}else e.key==="1"?e.ctrlKey&&App.show_sounds_context():e.key==="2"?e.ctrlKey&&App.show_notes_context():e.key==="3"&&e.ctrlKey&&App.show_banks_context()})},App.generic_hint=(e,t,o)=>{let u=e.getCursor(),p=e.getTokenAt(u),f=p.string.replace(/['"]/g,""),b=o.filter(M=>M.toLowerCase().startsWith(f.toLowerCase()));b.length===0?console.log("⚠️ No matches found for:",f):console.log(`✅ Found ${b.length} matches`),t({list:b,from:{line:u.line,ch:p.start+1},to:{line:u.line,ch:p.end}})},App.sounds_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_sounds)},App.notes_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_notes)},App.banks_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_banks)},App.sounds_hint.async=!0,App.notes_hint.async=!0,App.banks_hint.async=!0,App.sound_hint_func=e=>{let t=e.getCursor();return{list:App.strudel_sounds,from:t,to:t}},App.setup_editor_autocomplete=()=>{App.editor.on("inputRead",(e,t)=>{if(t.text[0]==='"'||t.text[0]==="'"){let o=e.getCursor(),p=e.getLine(o.line).slice(0,o.ch);p.endsWith('note("')||p.endsWith("note('")?e.showHint({hint:App.notes_hint,completeSingle:!1,container:document.body}):p.endsWith('bank("')||p.endsWith("bank('")?e.showHint({hint:App.banks_hint,completeSingle:!1,container:document.body}):(p.endsWith('sound("')||p.endsWith("sound('"))&&e.showHint({hint:App.sounds_hint,completeSingle:!1,container:document.body})}})},NeedContext.init(),NeedContext.after_hide=()=>{App.focus_input()},App.show_generic_context=(e,t,o)=>{let u=e.map(p=>({text:p,action:()=>{App.add_text_to_input(p)}}));App.show_context(u,o,t)},App.show_sounds_context=e=>{App.show_generic_context(App.strudel_sounds,"Sounds",e)},App.show_notes_context=e=>{App.show_generic_context(App.strudel_notes,"Notes",e)},App.show_banks_context=e=>{App.show_generic_context(App.strudel_banks,"Banks",e)},App.show_context=(e,t,o)=>{let u={items:e,title:o};t&&(u.x=t.x,u.y=t.y),NeedContext.show(u)},App.strudel_banks=["AJKPercusyn","AkaiLinn","AkaiMPC60","AkaiXR10","AlesisHR16","AlesisSR16","BossDR110","BossDR220","BossDR55","BossDR550","CasioRZ1","CasioSK1","CasioVL1","DoepferMS404","EmuDrumulator","EmuSP12","KorgDDM110","KorgKPR77","KorgKR55","KorgKRZ","KorgM1","KorgMinipops","KorgPoly800","KorgT3","Linn9000","LinnLM1","LinnLM2","MoogConcertMateMG1","OberheimDMX","RhodesPolaris","RhythmAce","RolandCompurhythm1000","RolandCompurhythm78","RolandCompurhythm8000","RolandD110","RolandD70","RolandDDR30","RolandJD990","RolandMC202","RolandMC303","RolandMT32","RolandR8","RolandS50","RolandSH09","RolandSystem100","RolandTR505","RolandTR606","RolandTR626","RolandTR707","RolandTR727","RolandTR808","RolandTR909","SakataDPM48","SequentialCircuitsDrumtracks","SequentialCircuitsTom","SimmonsSDS400","SimmonsSDS5","SoundmastersR88","UnivoxMicroRhythmer12","ViscoSpaceDrum","XdrumLM8953","YamahaRM50","YamahaRX21","YamahaRX5","YamahaRY30","YamahaTG33"],App.strudel_sounds=["sawtooth","square","triangle","sine","sax","gtr","moog","white","pink","brown","bd","sd","rim","hh","oh","lt","mt","ht","rd","cr"],App.strudel_notes=["c4","e4","g4","a4","f4","d4","b4","c3","e3","g3","a3","f3","d3","b3","f#4","bb4","c#4","eb4","g#4","f#3","bb3","c#3","eb3","g#3","c5","e5","g5","a5","f5","d5","b5","c2","e2","g2","a2","f2","d2","b2","f#5","bb5","c#5","eb5","g#5","f#2","bb2","c#2","eb2","g#2","c6","e6","g6","a6","f6","d6","b6","c1","e1","g1","a1","f1","d1","b1","f#6","bb6","c#6","eb6","g#6","f#1","bb1","c#1","eb1","g#1","c7","e7","g7","c0","e0","g0"],App.colors_enabled=!0,App.apply_color=e=>{let t=DOM.el("#volume-value"),o=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),p=DOM.el("#tempo-slider"),f=DOM.el("#status"),b=DOM.el("#image");t&&(t.style.color=e),o&&(o.style.accentColor=e),u&&(u.style.color=e),p&&(p.style.accentColor=e),f&&(f.style.color=e),b&&(b.style.filter=`drop-shadow(0 0 0.15rem ${e})`)},App.start_color_cycle=()=>{App.colors_enabled&&(App.color_cycle_timer||(App.color_index=0,App.apply_color(App.cycle_colors[0],0),App.color_cycle_timer=setInterval(()=>{App.color_index=(App.color_index+1)%App.cycle_colors.length,App.apply_color(App.cycle_colors[App.color_index],App.color_index)},3*1e3)))},App.stop_color_cycle=()=>{App.color_cycle_timer&&(clearInterval(App.color_cycle_timer),App.color_cycle_timer=void 0),App.color_index=0;let e=App.cycle_colors[0],t=DOM.el("#volume-value"),o=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),p=DOM.el("#tempo-slider"),f=DOM.el("#status"),b=DOM.el("#image");t&&(t.style.color=e),o&&(o.style.accentColor=e),u&&(u.style.color=e),p&&(p.style.accentColor=e),f&&(f.style.color=e),b&&(b.style.filter="")},App.toggle_colors=()=>{App.colors_enabled=!App.colors_enabled,App.stor_save_colors(),App.is_playing&&(App.colors_enabled?App.start_color_cycle():App.is_playing&&App.stop_color_cycle())},App.color_interface=e=>{let t=App[`scope_click_color_${e}`];App.do_color_interface(t)},App.restore_interface_colors=()=>{App.do_color_interface(App.border_color)},App.do_color_interface=e=>{App.set_input_border(e);let t=App.get_scope_container();t.style.borderColor=e},App.check_scope_slide=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords;if(!(Math.abs(App.scope_max_y-App.scope_min_y)>=App.max_scope_slide_y_dff))return Math.abs(e.x-t.x)>=App.scope_slide_distance?(e.x<t.x?App.random_song():App.next_visual(),App.clear_clicks(),!0):!1},App.check_scope_panning=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords,{width:o,height:u}=App.get_scope_dimensions(),p=App.scope_panning_zone,f=App.scope_padding_amount;return e.x<=p||t.x<=p?(App.set_panning(-f,3),!0):e.x>=o-p||t.x>=o-p?(App.set_panning(f,3),!0):!1},App.circle_gesture=()=>{let e=App.scope_clicks;if(!e||!Array.isArray(e))return!1;let t=e.length;if(t<8)return!1;let o=1/0,u=-1/0,p=1/0,f=-1/0,b=0,M=0;for(let _e=0;_e<t;_e++){let ve=e[_e];ve.x<o&&(o=ve.x),ve.x>u&&(u=ve.x),ve.y<p&&(p=ve.y),ve.y>f&&(f=ve.y),b+=ve.x,M+=ve.y}let F=Math.hypot(u-o,f-p),S=e[0],k=e[t-1];if(Math.hypot(S.x-k.x,S.y-k.y)/F>.35)return!1;let $=u-o,R=f-p,U=$/R;if(U<.4||U>2.5)return!1;let V=b/t,z=M/t,K=0,ie=[];for(let _e=0;_e<t;_e++){let ve=e[_e].x-V,we=e[_e].y-z,xe=Math.hypot(ve,we);ie.push(xe),K+=xe}let he=K/t,se=0;for(let _e=0;_e<t;_e++){let ve=ie[_e]-he;se+=ve*ve}return Math.sqrt(se/t)/he<.35},App.triangle_gesture=()=>{let e=(f,b)=>{let M=f.x-b.x,F=f.y-b.y;return M*M+F*F},t=(f,b,M)=>{let F=e(b,M);if(F===0)return e(f,b);let S=((f.x-b.x)*(M.x-b.x)+(f.y-b.y)*(M.y-b.y))/F;return S=Math.max(0,Math.min(1,S)),e(f,{x:b.x+S*(M.x-b.x),y:b.y+S*(M.y-b.y)})},o=(f,b,M)=>{let F={x:f.x-b.x,y:f.y-b.y},S={x:M.x-b.x,y:M.y-b.y},k=F.x*S.x+F.y*S.y,N=Math.sqrt(F.x*F.x+F.y*F.y),$=Math.sqrt(S.x*S.x+S.y*S.y);if(N*$===0)return 0;let R=k/(N*$);return R=Math.max(-1,Math.min(1,R)),Math.acos(R)*(180/Math.PI)},u=(f,b)=>{if(f.length<=2)return f;let M=0,F=0,S=f.length-1;for(let k=1;k<S;k++){let N=t(f[k],f[0],f[S]);N>M&&(M=N,F=k)}if(M>b*b){let k=u(f.slice(0,F+1),b),N=u(f.slice(F),b);return k.slice(0,k.length-1).concat(N)}return[f[0],f[S]]};return(f=>{let b=f.length;if(b<10)return!1;let M=1/0,F=-1/0,S=1/0,k=-1/0;for(let se=0;se<b;se++)M=Math.min(M,f[se].x),F=Math.max(F,f[se].x),S=Math.min(S,f[se].y),k=Math.max(k,f[se].y);let N=Math.hypot(F-M,k-S),$=f[0],R=f[b-1];if(Math.hypot($.x-R.x,$.y-R.y)/N>.2)return!1;let V=N*.15,z=u(f,V),K=z.length;if(K<3||K>4)return!1;let ie=z.slice(0,3),he=[o(ie[2],ie[0],ie[1]),o(ie[0],ie[1],ie[2]),o(ie[1],ie[2],ie[0])];for(let se=0;se<3;se++)if(he[se]<10||he[se]>170)return!1;return!0})(App.scope_clicks)},App.square_gesture=()=>{let e=App.scope_clicks;if(!e||!Array.isArray(e))return!1;let t=e.length;if(t<10)return!1;let o=(se,ee)=>{let pe=se.x-ee.x,_e=se.y-ee.y;return pe*pe+_e*_e},u=(se,ee,pe)=>{let _e=o(ee,pe);if(_e===0)return o(se,ee);let ve=((se.x-ee.x)*(pe.x-ee.x)+(se.y-ee.y)*(pe.y-ee.y))/_e;return ve=Math.max(0,Math.min(1,ve)),o(se,{x:ee.x+ve*(pe.x-ee.x),y:ee.y+ve*(pe.y-ee.y)})},p=(se,ee)=>{if(se.length<=2)return se;let pe=0,_e=0,ve=se.length-1;for(let we=1;we<ve;we++){let xe=u(se[we],se[0],se[ve]);xe>pe&&(pe=xe,_e=we)}if(pe>ee*ee){let we=p(se.slice(0,_e+1),ee),xe=p(se.slice(_e),ee);return we.slice(0,we.length-1).concat(xe)}return[se[0],se[ve]]},f=1/0,b=-1/0,M=1/0,F=-1/0;for(let se=0;se<t;se++){let ee=e[se];f=Math.min(f,ee.x),b=Math.max(b,ee.x),M=Math.min(M,ee.y),F=Math.max(F,ee.y)}let S=Math.hypot(b-f,F-M),k=e[0],N=e[t-1];if(Math.hypot(k.x-N.x,k.y-N.y)/S>.4)return!1;let R=b-f,U=F-M,V=R/U;if(V<.15||V>6)return!1;let z=S*.06,K=p(e,z),ie=K.length;if(ie<4||ie>6)return!1;let he=0;for(let se=1;se<ie-1;se++){let ee=K[se-1],pe=K[se],_e=K[se+1],ve=pe.x-ee.x,we=pe.y-ee.y,xe=_e.x-pe.x,Oe=_e.y-pe.y,Pe=ve*xe+we*Oe,Le=Math.hypot(ve,we),Xe=Math.hypot(xe,Oe),Ke=Pe/(Le*Xe);Math.abs(Ke)<.5&&he++}return he>=2},App.gesture_function=(e,t)=>{App.scope_gestures_enabled=!1,App.increase_scope_click_level(e),App.spin_panning(),t()},(function(e,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.CodeMirror=t())})(void 0,(function(){var e=navigator.userAgent,t=navigator.platform,o=/gecko\/\d/i.test(e),u=/MSIE \d/.test(e),p=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),f=/Edge\/(\d+)/.exec(e),b=u||p||f,M=b&&(u?document.documentMode||6:+(f||p)[1]),F=!f&&/WebKit\//.test(e),S=F&&/Qt\/\d+\.\d+/.test(e),k=!f&&/Chrome\//.test(e),N=/Opera\//.test(e),$=/Apple Computer/.test(navigator.vendor),R=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),U=/PhantomJS/.test(e),V=$&&(/Mobile\/\w+/.test(e)||navigator.maxTouchPoints>2),z=/Android/.test(e),K=V||z||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),ie=V||/Mac/.test(t),he=/\bCrOS\b/.test(e),se=/win/i.test(t),ee=N&&e.match(/Version\/(\d*\.\d*)/);ee&&(ee=Number(ee[1])),ee&&ee>=15&&(N=!1,F=!0);var pe=ie&&(S||N&&(ee==null||ee<12.11)),_e=o||b&&M>=9;function ve(a){return new RegExp("(^|\\s)"+a+"(?:$|\\s)\\s*")}var we=function(a,l){var g=a.className,d=ve(l).exec(g);if(d){var A=g.slice(d.index+d[0].length);a.className=g.slice(0,d.index)+(A?d[1]+A:"")}};function xe(a){for(var l=a.childNodes.length;l>0;--l)a.removeChild(a.firstChild);return a}function Oe(a,l){return xe(a).appendChild(l)}function Pe(a,l,g,d){var A=document.createElement(a);if(g&&(A.className=g),d&&(A.style.cssText=d),typeof l=="string")A.appendChild(document.createTextNode(l));else if(l)for(var E=0;E<l.length;++E)A.appendChild(l[E]);return A}function Le(a,l,g,d){var A=Pe(a,l,g,d);return A.setAttribute("role","presentation"),A}var Xe;document.createRange?Xe=function(a,l,g,d){var A=document.createRange();return A.setEnd(d||a,g),A.setStart(a,l),A}:Xe=function(a,l,g){var d=document.body.createTextRange();try{d.moveToElementText(a.parentNode)}catch{return d}return d.collapse(!0),d.moveEnd("character",g),d.moveStart("character",l),d};function Ke(a,l){if(l.nodeType==3&&(l=l.parentNode),a.contains)return a.contains(l);do if(l.nodeType==11&&(l=l.host),l==a)return!0;while(l=l.parentNode)}function me(){var a;try{a=document.activeElement}catch{a=document.body||null}for(;a&&a.shadowRoot&&a.shadowRoot.activeElement;)a=a.shadowRoot.activeElement;return a}function ye(a,l){var g=a.className;ve(l).test(g)||(a.className+=(g?" ":"")+l)}function Se(a,l){for(var g=a.split(" "),d=0;d<g.length;d++)g[d]&&!ve(g[d]).test(l)&&(l+=" "+g[d]);return l}var qe=function(a){a.select()};V?qe=function(a){a.selectionStart=0,a.selectionEnd=a.value.length}:b&&(qe=function(a){try{a.select()}catch{}});function st(a){var l=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,l)}}function mt(a,l,g){l||(l={});for(var d in a)a.hasOwnProperty(d)&&(g!==!1||!l.hasOwnProperty(d))&&(l[d]=a[d]);return l}function Ee(a,l,g,d,A){l==null&&(l=a.search(/[^\s\u00a0]/),l==-1&&(l=a.length));for(var E=d||0,L=A||0;;){var O=a.indexOf("	",E);if(O<0||O>=l)return L+(l-E);L+=O-E,L+=g-L%g,E=O+1}}var rt=function(){this.id=null,this.f=null,this.time=0,this.handler=st(this.onTimeout,this)};rt.prototype.onTimeout=function(a){a.id=0,a.time<=+new Date?a.f():setTimeout(a.handler,a.time-+new Date)},rt.prototype.set=function(a,l){this.f=l;var g=+new Date+a;(!this.id||g<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,a),this.time=g)};function St(a,l){for(var g=0;g<a.length;++g)if(a[g]==l)return g;return-1}var pt=50,bt={toString:function(){return"CodeMirror.Pass"}},yt={scroll:!1},At={origin:"*mouse"},Et={origin:"+move"};function Kt(a,l,g){for(var d=0,A=0;;){var E=a.indexOf("	",d);E==-1&&(E=a.length);var L=E-d;if(E==a.length||A+L>=l)return d+Math.min(L,l-A);if(A+=E-d,A+=g-A%g,d=E+1,A>=l)return d}}var jt=[""];function Nt(a){for(;jt.length<=a;)jt.push(_t(jt)+" ");return jt[a]}function _t(a){return a[a.length-1]}function $t(a,l){for(var g=[],d=0;d<a.length;d++)g[d]=l(a[d],d);return g}function sn(a,l,g){for(var d=0,A=g(l);d<a.length&&g(a[d])<=A;)d++;a.splice(d,0,l)}function kt(){}function Ot(a,l){var g;return Object.create?g=Object.create(a):(kt.prototype=a,g=new kt),l&&mt(l,g),g}var Wt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Ae(a){return/\w/.test(a)||a>""&&(a.toUpperCase()!=a.toLowerCase()||Wt.test(a))}function Ce(a,l){return l?l.source.indexOf("\\w")>-1&&Ae(a)?!0:l.test(a):Ae(a)}function ge(a){for(var l in a)if(a.hasOwnProperty(l)&&a[l])return!1;return!0}var Te=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ze(a){return a.charCodeAt(0)>=768&&Te.test(a)}function Ne(a,l,g){for(;(g<0?l>0:l<a.length)&&ze(a.charAt(l));)l+=g;return l}function De(a,l,g){for(var d=l>g?-1:1;;){if(l==g)return l;var A=(l+g)/2,E=d<0?Math.ceil(A):Math.floor(A);if(E==l)return a(E)?l:g;a(E)?g=E:l=E+d}}function Ie(a,l,g,d){if(!a)return d(l,g,"ltr",0);for(var A=!1,E=0;E<a.length;++E){var L=a[E];(L.from<g&&L.to>l||l==g&&L.to==l)&&(d(Math.max(L.from,l),Math.min(L.to,g),L.level==1?"rtl":"ltr",E),A=!0)}A||d(l,g,"ltr")}var Ge=null;function He(a,l,g){var d;Ge=null;for(var A=0;A<a.length;++A){var E=a[A];if(E.from<l&&E.to>l)return A;E.to==l&&(E.from!=E.to&&g=="before"?d=A:Ge=A),E.from==l&&(E.from!=E.to&&g!="before"?d=A:Ge=A)}return d??Ge}var it=(function(){var a="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",l="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function g(j){return j<=247?a.charAt(j):1424<=j&&j<=1524?"R":1536<=j&&j<=1785?l.charAt(j-1536):1774<=j&&j<=2220?"r":8192<=j&&j<=8203?"w":j==8204?"b":"L"}var d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,A=/[stwN]/,E=/[LRr]/,L=/[Lb1n]/,O=/[1n]/;function Z(j,ae,fe){this.level=j,this.from=ae,this.to=fe}return function(j,ae){var fe=ae=="ltr"?"L":"R";if(j.length==0||ae=="ltr"&&!d.test(j))return!1;for(var Me=j.length,be=[],Fe=0;Fe<Me;++Fe)be.push(g(j.charCodeAt(Fe)));for(var $e=0,Ze=fe;$e<Me;++$e){var je=be[$e];je=="m"?be[$e]=Ze:Ze=je}for(var Je=0,Ye=fe;Je<Me;++Je){var et=be[Je];et=="1"&&Ye=="r"?be[Je]="n":E.test(et)&&(Ye=et,et=="r"&&(be[Je]="R"))}for(var ht=1,ct=be[0];ht<Me-1;++ht){var Tt=be[ht];Tt=="+"&&ct=="1"&&be[ht+1]=="1"?be[ht]="1":Tt==","&&ct==be[ht+1]&&(ct=="1"||ct=="n")&&(be[ht]=ct),ct=Tt}for(var Yt=0;Yt<Me;++Yt){var hn=be[Yt];if(hn==",")be[Yt]="N";else if(hn=="%"){var Qt=void 0;for(Qt=Yt+1;Qt<Me&&be[Qt]=="%";++Qt);for(var Gn=Yt&&be[Yt-1]=="!"||Qt<Me&&be[Qt]=="1"?"1":"N",En=Yt;En<Qt;++En)be[En]=Gn;Yt=Qt-1}}for(var ln=0,kn=fe;ln<Me;++ln){var gn=be[ln];kn=="L"&&gn=="1"?be[ln]="L":E.test(gn)&&(kn=gn)}for(var pn=0;pn<Me;++pn)if(A.test(be[pn])){var cn=void 0;for(cn=pn+1;cn<Me&&A.test(be[cn]);++cn);for(var tn=(pn?be[pn-1]:fe)=="L",Tn=(cn<Me?be[cn]:fe)=="L",vi=tn==Tn?tn?"L":"R":fe,Er=pn;Er<cn;++Er)be[Er]=vi;pn=cn-1}for(var bn=[],Qn,mn=0;mn<Me;)if(L.test(be[mn])){var na=mn;for(++mn;mn<Me&&L.test(be[mn]);++mn);bn.push(new Z(0,na,mn))}else{var dr=mn,Vr=bn.length,Zr=ae=="rtl"?1:0;for(++mn;mn<Me&&be[mn]!="L";++mn);for(var Pn=dr;Pn<mn;)if(O.test(be[Pn])){dr<Pn&&(bn.splice(Vr,0,new Z(1,dr,Pn)),Vr+=Zr);var bi=Pn;for(++Pn;Pn<mn&&O.test(be[Pn]);++Pn);bn.splice(Vr,0,new Z(2,bi,Pn)),Vr+=Zr,dr=Pn}else++Pn;dr<mn&&bn.splice(Vr,0,new Z(1,dr,mn))}return ae=="ltr"&&(bn[0].level==1&&(Qn=j.match(/^\s+/))&&(bn[0].from=Qn[0].length,bn.unshift(new Z(0,0,Qn[0].length))),_t(bn).level==1&&(Qn=j.match(/\s+$/))&&(_t(bn).to-=Qn[0].length,bn.push(new Z(0,Me-Qn[0].length,Me)))),ae=="rtl"?bn.reverse():bn}})();function Gt(a,l){var g=a.order;return g==null&&(g=a.order=it(a.text,l)),g}var zt=[],Ue=function(a,l,g){if(a.addEventListener)a.addEventListener(l,g,!1);else if(a.attachEvent)a.attachEvent("on"+l,g);else{var d=a._handlers||(a._handlers={});d[l]=(d[l]||zt).concat(g)}};function Dt(a,l){return a._handlers&&a._handlers[l]||zt}function It(a,l,g){if(a.removeEventListener)a.removeEventListener(l,g,!1);else if(a.detachEvent)a.detachEvent("on"+l,g);else{var d=a._handlers,A=d&&d[l];if(A){var E=St(A,g);E>-1&&(d[l]=A.slice(0,E).concat(A.slice(E+1)))}}}function Qe(a,l){var g=Dt(a,l);if(g.length)for(var d=Array.prototype.slice.call(arguments,2),A=0;A<g.length;++A)g[A].apply(null,d)}function Bt(a,l,g){return typeof l=="string"&&(l={type:l,preventDefault:function(){this.defaultPrevented=!0}}),Qe(a,g||l.type,a,l),nn(l)||l.codemirrorIgnore}function on(a){var l=a._handlers&&a._handlers.cursorActivity;if(l)for(var g=a.curOp.cursorActivityHandlers||(a.curOp.cursorActivityHandlers=[]),d=0;d<l.length;++d)St(g,l[d])==-1&&g.push(l[d])}function tt(a,l){return Dt(a,l).length>0}function Ct(a){a.prototype.on=function(l,g){Ue(this,l,g)},a.prototype.off=function(l,g){It(this,l,g)}}function Mt(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function Zt(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function nn(a){return a.defaultPrevented!=null?a.defaultPrevented:a.returnValue==!1}function an(a){Mt(a),Zt(a)}function An(a){return a.target||a.srcElement}function B(a){var l=a.which;return l==null&&(a.button&1?l=1:a.button&2?l=3:a.button&4&&(l=2)),ie&&a.ctrlKey&&l==1&&(l=3),l}var te=(function(){if(b&&M<9)return!1;var a=Pe("div");return"draggable"in a||"dragDrop"in a})(),q;function re(a){if(q==null){var l=Pe("span","​");Oe(a,Pe("span",[l,document.createTextNode("x")])),a.firstChild.offsetHeight!=0&&(q=l.offsetWidth<=1&&l.offsetHeight>2&&!(b&&M<8))}var g=q?Pe("span","​"):Pe("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return g.setAttribute("cm-text",""),g}var ue;function ke(a){if(ue!=null)return ue;var l=Oe(a,document.createTextNode("AخA")),g=Xe(l,0,1).getBoundingClientRect(),d=Xe(l,1,2).getBoundingClientRect();return xe(a),!g||g.left==g.right?!1:ue=d.right-g.right<3}var Be=`

b`.split(/\n/).length!=3?function(a){for(var l=0,g=[],d=a.length;l<=d;){var A=a.indexOf(`
`,l);A==-1&&(A=a.length);var E=a.slice(l,a.charAt(A-1)=="\r"?A-1:A),L=E.indexOf("\r");L!=-1?(g.push(E.slice(0,L)),l+=L+1):(g.push(E),l=A+1)}return g}:function(a){return a.split(/\r\n?|\n/)},Ve=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch{return!1}}:function(a){var l;try{l=a.ownerDocument.selection.createRange()}catch{}return!l||l.parentElement()!=a?!1:l.compareEndPoints("StartToEnd",l)!=0},nt=(function(){var a=Pe("div");return"oncopy"in a?!0:(a.setAttribute("oncopy","return;"),typeof a.oncopy=="function")})(),Lt=null;function Jt(a){if(Lt!=null)return Lt;var l=Oe(a,Pe("span","x")),g=l.getBoundingClientRect(),d=Xe(l,0,1).getBoundingClientRect();return Lt=Math.abs(g.left-d.left)>1}var Rn={},Sn={};function zr(a,l){arguments.length>2&&(l.dependencies=Array.prototype.slice.call(arguments,2)),Rn[a]=l}function Hr(a,l){Sn[a]=l}function yn(a){if(typeof a=="string"&&Sn.hasOwnProperty(a))a=Sn[a];else if(a&&typeof a.name=="string"&&Sn.hasOwnProperty(a.name)){var l=Sn[a.name];typeof l=="string"&&(l={name:l}),a=Ot(l,a),a.name=l.name}else{if(typeof a=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return yn("application/xml");if(typeof a=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(a))return yn("application/json")}return typeof a=="string"?{name:a}:a||{name:"null"}}function Ai(a,l){l=yn(l);var g=Rn[l.name];if(!g)return Ai(a,"text/plain");var d=g(a,l);if(hr.hasOwnProperty(l.name)){var A=hr[l.name];for(var E in A)A.hasOwnProperty(E)&&(d.hasOwnProperty(E)&&(d["_"+E]=d[E]),d[E]=A[E])}if(d.name=l.name,l.helperType&&(d.helperType=l.helperType),l.modeProps)for(var L in l.modeProps)d[L]=l.modeProps[L];return d}var hr={};function eo(a,l){var g=hr.hasOwnProperty(a)?hr[a]:hr[a]={};mt(l,g)}function er(a,l){if(l===!0)return l;if(a.copyState)return a.copyState(l);var g={};for(var d in l){var A=l[d];A instanceof Array&&(A=A.concat([])),g[d]=A}return g}function Ci(a,l){for(var g;a.innerMode&&(g=a.innerMode(l),!(!g||g.mode==a));)l=g.state,a=g.mode;return g||{mode:a,state:l}}function is(a,l,g){return a.startState?a.startState(l,g):!0}var en=function(a,l,g){this.pos=this.start=0,this.string=a,this.tabSize=l||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=g};en.prototype.eol=function(){return this.pos>=this.string.length},en.prototype.sol=function(){return this.pos==this.lineStart},en.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},en.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},en.prototype.eat=function(a){var l=this.string.charAt(this.pos),g;if(typeof a=="string"?g=l==a:g=l&&(a.test?a.test(l):a(l)),g)return++this.pos,l},en.prototype.eatWhile=function(a){for(var l=this.pos;this.eat(a););return this.pos>l},en.prototype.eatSpace=function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},en.prototype.skipToEnd=function(){this.pos=this.string.length},en.prototype.skipTo=function(a){var l=this.string.indexOf(a,this.pos);if(l>-1)return this.pos=l,!0},en.prototype.backUp=function(a){this.pos-=a},en.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ee(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ee(this.string,this.lineStart,this.tabSize):0)},en.prototype.indentation=function(){return Ee(this.string,null,this.tabSize)-(this.lineStart?Ee(this.string,this.lineStart,this.tabSize):0)},en.prototype.match=function(a,l,g){if(typeof a=="string"){var d=function(L){return g?L.toLowerCase():L},A=this.string.substr(this.pos,a.length);if(d(A)==d(a))return l!==!1&&(this.pos+=a.length),!0}else{var E=this.string.slice(this.pos).match(a);return E&&E.index>0?null:(E&&l!==!1&&(this.pos+=E[0].length),E)}},en.prototype.current=function(){return this.string.slice(this.start,this.pos)},en.prototype.hideFirstChars=function(a,l){this.lineStart+=a;try{return l()}finally{this.lineStart-=a}},en.prototype.lookAhead=function(a){var l=this.lineOracle;return l&&l.lookAhead(a)},en.prototype.baseToken=function(){var a=this.lineOracle;return a&&a.baseToken(this.pos)};function ot(a,l){if(l-=a.first,l<0||l>=a.size)throw new Error("There is no line "+(l+a.first)+" in the document.");for(var g=a;!g.lines;)for(var d=0;;++d){var A=g.children[d],E=A.chunkSize();if(l<E){g=A;break}l-=E}return g.lines[l]}function nr(a,l,g){var d=[],A=l.line;return a.iter(l.line,g.line+1,function(E){var L=E.text;A==g.line&&(L=L.slice(0,g.ch)),A==l.line&&(L=L.slice(l.ch)),d.push(L),++A}),d}function Mi(a,l,g){var d=[];return a.iter(l,g,function(A){d.push(A.text)}),d}function On(a,l){var g=l-a.height;if(g)for(var d=a;d;d=d.parent)d.height+=g}function Xt(a){if(a.parent==null)return null;for(var l=a.parent,g=St(l.lines,a),d=l.parent;d;l=d,d=d.parent)for(var A=0;d.children[A]!=l;++A)g+=d.children[A].chunkSize();return g+l.first}function rr(a,l){var g=a.first;e:do{for(var d=0;d<a.children.length;++d){var A=a.children[d],E=A.height;if(l<E){a=A;continue e}l-=E,g+=A.chunkSize()}return g}while(!a.lines);for(var L=0;L<a.lines.length;++L){var O=a.lines[L],Z=O.height;if(l<Z)break;l-=Z}return g+L}function kr(a,l){return l>=a.first&&l<a.first+a.size}function xi(a,l){return String(a.lineNumberFormatter(l+a.firstLineNumber))}function We(a,l,g){if(g===void 0&&(g=null),!(this instanceof We))return new We(a,l,g);this.line=a,this.ch=l,this.sticky=g}function xt(a,l){return a.line-l.line||a.ch-l.ch}function Pi(a,l){return a.sticky==l.sticky&&xt(a,l)==0}function Si(a){return We(a.line,a.ch)}function Ur(a,l){return xt(a,l)<0?l:a}function jr(a,l){return xt(a,l)<0?a:l}function ss(a,l){return Math.max(a.first,Math.min(l,a.first+a.size-1))}function Pt(a,l){if(l.line<a.first)return We(a.first,0);var g=a.first+a.size-1;return l.line>g?We(g,ot(a,g).text.length):to(l,ot(a,l.line).text.length)}function to(a,l){var g=a.ch;return g==null||g>l?We(a.line,l):g<0?We(a.line,0):a}function os(a,l){for(var g=[],d=0;d<l.length;d++)g[d]=Pt(a,l[d]);return g}var Yr=function(a,l){this.state=a,this.lookAhead=l},Wn=function(a,l,g,d){this.state=l,this.doc=a,this.line=g,this.maxLookAhead=d||0,this.baseTokens=null,this.baseTokenPos=1};Wn.prototype.lookAhead=function(a){var l=this.doc.getLine(this.line+a);return l!=null&&a>this.maxLookAhead&&(this.maxLookAhead=a),l},Wn.prototype.baseToken=function(a){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=a;)this.baseTokenPos+=2;var l=this.baseTokens[this.baseTokenPos+1];return{type:l&&l.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-a}},Wn.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Wn.fromSaved=function(a,l,g){return l instanceof Yr?new Wn(a,er(a.mode,l.state),g,l.lookAhead):new Wn(a,er(a.mode,l),g)},Wn.prototype.save=function(a){var l=a!==!1?er(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Yr(l,this.maxLookAhead):l};function us(a,l,g,d){var A=[a.state.modeGen],E={};hs(a,l.text,a.doc.mode,g,function(j,ae){return A.push(j,ae)},E,d);for(var L=g.state,O=function(j){g.baseTokens=A;var ae=a.state.overlays[j],fe=1,Me=0;g.state=!0,hs(a,l.text,ae.mode,g,function(be,Fe){for(var $e=fe;Me<be;){var Ze=A[fe];Ze>be&&A.splice(fe,1,be,A[fe+1],Ze),fe+=2,Me=Math.min(be,Ze)}if(Fe)if(ae.opaque)A.splice($e,fe-$e,be,"overlay "+Fe),fe=$e+2;else for(;$e<fe;$e+=2){var je=A[$e+1];A[$e+1]=(je?je+" ":"")+"overlay "+Fe}},E),g.state=L,g.baseTokens=null,g.baseTokenPos=1},Z=0;Z<a.state.overlays.length;++Z)O(Z);return{styles:A,classes:E.bgClass||E.textClass?E:null}}function ls(a,l,g){if(!l.styles||l.styles[0]!=a.state.modeGen){var d=Tr(a,Xt(l)),A=l.text.length>a.options.maxHighlightLength&&er(a.doc.mode,d.state),E=us(a,l,d);A&&(d.state=A),l.stateAfter=d.save(!A),l.styles=E.styles,E.classes?l.styleClasses=E.classes:l.styleClasses&&(l.styleClasses=null),g===a.doc.highlightFrontier&&(a.doc.modeFrontier=Math.max(a.doc.modeFrontier,++a.doc.highlightFrontier))}return l.styles}function Tr(a,l,g){var d=a.doc,A=a.display;if(!d.mode.startState)return new Wn(d,!0,l);var E=no(a,l,g),L=E>d.first&&ot(d,E-1).stateAfter,O=L?Wn.fromSaved(d,L,E):new Wn(d,is(d.mode),E);return d.iter(E,l,function(Z){wi(a,Z.text,O);var j=O.line;Z.stateAfter=j==l-1||j%5==0||j>=A.viewFrom&&j<A.viewTo?O.save():null,O.nextLine()}),g&&(d.modeFrontier=O.line),O}function wi(a,l,g,d){var A=a.doc.mode,E=new en(l,a.options.tabSize,g);for(E.start=E.pos=d||0,l==""&&Di(A,g.state);!E.eol();)Fi(A,E,g.state),E.start=E.pos}function Di(a,l){if(a.blankLine)return a.blankLine(l);if(a.innerMode){var g=Ci(a,l);if(g.mode.blankLine)return g.mode.blankLine(g.state)}}function Fi(a,l,g,d){for(var A=0;A<10;A++){d&&(d[0]=Ci(a,g).mode);var E=a.token(l,g);if(l.pos>l.start)return E}throw new Error("Mode "+a.name+" failed to advance stream.")}var cs=function(a,l,g){this.start=a.start,this.end=a.pos,this.string=a.current(),this.type=l||null,this.state=g};function ps(a,l,g,d){var A=a.doc,E=A.mode,L;l=Pt(A,l);var O=ot(A,l.line),Z=Tr(a,l.line,g),j=new en(O.text,a.options.tabSize,Z),ae;for(d&&(ae=[]);(d||j.pos<l.ch)&&!j.eol();)j.start=j.pos,L=Fi(E,j,Z.state),d&&ae.push(new cs(j,L,er(A.mode,Z.state)));return d?ae:new cs(j,L,Z.state)}function fs(a,l){if(a)for(;;){var g=a.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!g)break;a=a.slice(0,g.index)+a.slice(g.index+g[0].length);var d=g[1]?"bgClass":"textClass";l[d]==null?l[d]=g[2]:new RegExp("(?:^|\\s)"+g[2]+"(?:$|\\s)").test(l[d])||(l[d]+=" "+g[2])}return a}function hs(a,l,g,d,A,E,L){var O=g.flattenSpans;O==null&&(O=a.options.flattenSpans);var Z=0,j=null,ae=new en(l,a.options.tabSize,d),fe,Me=a.options.addModeClass&&[null];for(l==""&&fs(Di(g,d.state),E);!ae.eol();){if(ae.pos>a.options.maxHighlightLength?(O=!1,L&&wi(a,l,d,ae.pos),ae.pos=l.length,fe=null):fe=fs(Fi(g,ae,d.state,Me),E),Me){var be=Me[0].name;be&&(fe="m-"+(fe?be+" "+fe:be))}if(!O||j!=fe){for(;Z<ae.start;)Z=Math.min(ae.start,Z+5e3),A(Z,j);j=fe}ae.start=ae.pos}for(;Z<ae.pos;){var Fe=Math.min(ae.pos,Z+5e3);A(Fe,j),Z=Fe}}function no(a,l,g){for(var d,A,E=a.doc,L=g?-1:l-(a.doc.mode.innerMode?1e3:100),O=l;O>L;--O){if(O<=E.first)return E.first;var Z=ot(E,O-1),j=Z.stateAfter;if(j&&(!g||O+(j instanceof Yr?j.lookAhead:0)<=E.modeFrontier))return O;var ae=Ee(Z.text,null,a.options.tabSize);(A==null||d>ae)&&(A=O-1,d=ae)}return A}function ro(a,l){if(a.modeFrontier=Math.min(a.modeFrontier,l),!(a.highlightFrontier<l-10)){for(var g=a.first,d=l-1;d>g;d--){var A=ot(a,d).stateAfter;if(A&&(!(A instanceof Yr)||d+A.lookAhead<l)){g=d+1;break}}a.highlightFrontier=Math.min(a.highlightFrontier,g)}}var ms=!1,le=!1;function Ft(){ms=!0}function mr(){le=!0}function Cn(a,l,g){this.marker=a,this.from=l,this.to=g}function Kn(a,l){if(a)for(var g=0;g<a.length;++g){var d=a[g];if(d.marker==l)return d}}function at(a,l){for(var g,d=0;d<a.length;++d)a[d]!=l&&(g||(g=[])).push(a[d]);return g}function Nr(a,l,g){var d=g&&window.WeakSet&&(g.markedSpans||(g.markedSpans=new WeakSet));d&&a.markedSpans&&d.has(a.markedSpans)?a.markedSpans.push(l):(a.markedSpans=a.markedSpans?a.markedSpans.concat([l]):[l],d&&d.add(a.markedSpans)),l.marker.attachLine(a)}function io(a,l,g){var d;if(a)for(var A=0;A<a.length;++A){var E=a[A],L=E.marker,O=E.from==null||(L.inclusiveLeft?E.from<=l:E.from<l);if(O||E.from==l&&L.type=="bookmark"&&(!g||!E.marker.insertLeft)){var Z=E.to==null||(L.inclusiveRight?E.to>=l:E.to>l);(d||(d=[])).push(new Cn(L,E.from,Z?null:E.to))}}return d}function gs(a,l,g){var d;if(a)for(var A=0;A<a.length;++A){var E=a[A],L=E.marker,O=E.to==null||(L.inclusiveRight?E.to>=l:E.to>l);if(O||E.from==l&&L.type=="bookmark"&&(!g||E.marker.insertLeft)){var Z=E.from==null||(L.inclusiveLeft?E.from<=l:E.from<l);(d||(d=[])).push(new Cn(L,Z?null:E.from-l,E.to==null?null:E.to-l))}}return d}function Rt(a,l){if(l.full)return null;var g=kr(a,l.from.line)&&ot(a,l.from.line).markedSpans,d=kr(a,l.to.line)&&ot(a,l.to.line).markedSpans;if(!g&&!d)return null;var A=l.from.ch,E=l.to.ch,L=xt(l.from,l.to)==0,O=io(g,A,L),Z=gs(d,E,L),j=l.text.length==1,ae=_t(l.text).length+(j?A:0);if(O)for(var fe=0;fe<O.length;++fe){var Me=O[fe];if(Me.to==null){var be=Kn(Z,Me.marker);be?j&&(Me.to=be.to==null?null:be.to+ae):Me.to=A}}if(Z)for(var Fe=0;Fe<Z.length;++Fe){var $e=Z[Fe];if($e.to!=null&&($e.to+=ae),$e.from==null){var Ze=Kn(O,$e.marker);Ze||($e.from=ae,j&&(O||(O=[])).push($e))}else $e.from+=ae,j&&(O||(O=[])).push($e)}O&&(O=Xn(O)),Z&&Z!=O&&(Z=Xn(Z));var je=[O];if(!j){var Je=l.text.length-2,Ye;if(Je>0&&O)for(var et=0;et<O.length;++et)O[et].to==null&&(Ye||(Ye=[])).push(new Cn(O[et].marker,null,null));for(var ht=0;ht<Je;++ht)je.push(Ye);je.push(Z)}return je}function Xn(a){for(var l=0;l<a.length;++l){var g=a[l];g.from!=null&&g.from==g.to&&g.marker.clearWhenEmpty!==!1&&a.splice(l--,1)}return a.length?a:null}function so(a,l,g){var d=null;if(a.iter(l.line,g.line+1,function(be){if(be.markedSpans)for(var Fe=0;Fe<be.markedSpans.length;++Fe){var $e=be.markedSpans[Fe].marker;$e.readOnly&&(!d||St(d,$e)==-1)&&(d||(d=[])).push($e)}}),!d)return null;for(var A=[{from:l,to:g}],E=0;E<d.length;++E)for(var L=d[E],O=L.find(0),Z=0;Z<A.length;++Z){var j=A[Z];if(!(xt(j.to,O.from)<0||xt(j.from,O.to)>0)){var ae=[Z,1],fe=xt(j.from,O.from),Me=xt(j.to,O.to);(fe<0||!L.inclusiveLeft&&!fe)&&ae.push({from:j.from,to:O.from}),(Me>0||!L.inclusiveRight&&!Me)&&ae.push({from:O.to,to:j.to}),A.splice.apply(A,ae),Z+=ae.length-3}}return A}function Kr(a){var l=a.markedSpans;if(l){for(var g=0;g<l.length;++g)l[g].marker.detachLine(a);a.markedSpans=null}}function Ei(a,l){if(l){for(var g=0;g<l.length;++g)l[g].marker.attachLine(a);a.markedSpans=l}}function gr(a){return a.inclusiveLeft?-1:0}function ft(a){return a.inclusiveRight?1:0}function ki(a,l){var g=a.lines.length-l.lines.length;if(g!=0)return g;var d=a.find(),A=l.find(),E=xt(d.from,A.from)||gr(a)-gr(l);if(E)return-E;var L=xt(d.to,A.to)||ft(a)-ft(l);return L||l.id-a.id}function Ti(a,l){var g=le&&a.markedSpans,d;if(g)for(var A=void 0,E=0;E<g.length;++E)A=g[E],A.marker.collapsed&&(l?A.from:A.to)==null&&(!d||ki(d,A.marker)<0)&&(d=A.marker);return d}function Vn(a){return Ti(a,!0)}function qr(a){return Ti(a,!1)}function oo(a,l){var g=le&&a.markedSpans,d;if(g)for(var A=0;A<g.length;++A){var E=g[A];E.marker.collapsed&&(E.from==null||E.from<l)&&(E.to==null||E.to>l)&&(!d||ki(d,E.marker)<0)&&(d=E.marker)}return d}function _s(a,l,g,d,A){var E=ot(a,l),L=le&&E.markedSpans;if(L)for(var O=0;O<L.length;++O){var Z=L[O];if(Z.marker.collapsed){var j=Z.marker.find(0),ae=xt(j.from,g)||gr(Z.marker)-gr(A),fe=xt(j.to,d)||ft(Z.marker)-ft(A);if(!(ae>=0&&fe<=0||ae<=0&&fe>=0)&&(ae<=0&&(Z.marker.inclusiveRight&&A.inclusiveLeft?xt(j.to,g)>=0:xt(j.to,g)>0)||ae>=0&&(Z.marker.inclusiveRight&&A.inclusiveLeft?xt(j.from,d)<=0:xt(j.from,d)<0)))return!0}}}function Bn(a){for(var l;l=Vn(a);)a=l.find(-1,!0).line;return a}function ao(a){for(var l;l=qr(a);)a=l.find(1,!0).line;return a}function Jr(a){for(var l,g;l=qr(a);)a=l.find(1,!0).line,(g||(g=[])).push(a);return g}function Ni(a,l){var g=ot(a,l),d=Bn(g);return g==d?l:Xt(d)}function ys(a,l){if(l>a.lastLine())return l;var g=ot(a,l),d;if(!wn(a,g))return l;for(;d=qr(g);)g=d.find(1,!0).line;return Xt(g)+1}function wn(a,l){var g=le&&l.markedSpans;if(g){for(var d=void 0,A=0;A<g.length;++A)if(d=g[A],!!d.marker.collapsed){if(d.from==null)return!0;if(!d.marker.widgetNode&&d.from==0&&d.marker.inclusiveLeft&&vt(a,l,d))return!0}}}function vt(a,l,g){if(g.to==null){var d=g.marker.find(1,!0);return vt(a,d.line,Kn(d.line.markedSpans,g.marker))}if(g.marker.inclusiveRight&&g.to==l.text.length)return!0;for(var A=void 0,E=0;E<l.markedSpans.length;++E)if(A=l.markedSpans[E],A.marker.collapsed&&!A.marker.widgetNode&&A.from==g.to&&(A.to==null||A.to!=g.from)&&(A.marker.inclusiveLeft||g.marker.inclusiveRight)&&vt(a,l,A))return!0}function Mn(a){a=Bn(a);for(var l=0,g=a.parent,d=0;d<g.lines.length;++d){var A=g.lines[d];if(A==a)break;l+=A.height}for(var E=g.parent;E;g=E,E=g.parent)for(var L=0;L<E.children.length;++L){var O=E.children[L];if(O==g)break;l+=O.height}return l}function Lr(a){if(a.height==0)return 0;for(var l=a.text.length,g,d=a;g=Vn(d);){var A=g.find(0,!0);d=A.from.line,l+=A.from.ch-A.to.ch}for(d=a;g=qr(d);){var E=g.find(0,!0);l-=d.text.length-E.from.ch,d=E.to.line,l+=d.text.length-E.to.ch}return l}function Qr(a){var l=a.display,g=a.doc;l.maxLine=ot(g,g.first),l.maxLineLength=Lr(l.maxLine),l.maxLineChanged=!0,g.iter(function(d){var A=Lr(d);A>l.maxLineLength&&(l.maxLineLength=A,l.maxLine=d)})}var $n=function(a,l,g){this.text=a,Ei(this,l),this.height=g?g(this):1};$n.prototype.lineNo=function(){return Xt(this)},Ct($n);function ei(a,l,g,d){a.text=l,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),a.order!=null&&(a.order=null),Kr(a),Ei(a,g);var A=d?d(a):1;A!=a.height&&On(a,A)}function vs(a){a.parent=null,Kr(a)}var uo={},lo={};function bs(a,l){if(!a||/^\s*$/.test(a))return null;var g=l.addModeClass?lo:uo;return g[a]||(g[a]=a.replace(/\S+/g,"cm-$&"))}function As(a,l){var g=Le("span",null,null,F?"padding-right: .1px":null),d={pre:Le("pre",[g],"CodeMirror-line"),content:g,col:0,pos:0,cm:a,trailingSpace:!1,splitSpaces:a.getOption("lineWrapping")};l.measure={};for(var A=0;A<=(l.rest?l.rest.length:0);A++){var E=A?l.rest[A-1]:l.line,L=void 0;d.pos=0,d.addToken=Cs,ke(a.display.measure)&&(L=Gt(E,a.doc.direction))&&(d.addToken=po(d.addToken,L)),d.map=[];var O=l!=a.display.externalMeasured&&Xt(E);fo(E,d,ls(a,E,O)),E.styleClasses&&(E.styleClasses.bgClass&&(d.bgClass=Se(E.styleClasses.bgClass,d.bgClass||"")),E.styleClasses.textClass&&(d.textClass=Se(E.styleClasses.textClass,d.textClass||""))),d.map.length==0&&d.map.push(0,0,d.content.appendChild(re(a.display.measure))),A==0?(l.measure.map=d.map,l.measure.cache={}):((l.measure.maps||(l.measure.maps=[])).push(d.map),(l.measure.caches||(l.measure.caches=[])).push({}))}if(F){var Z=d.content.lastChild;(/\bcm-tab\b/.test(Z.className)||Z.querySelector&&Z.querySelector(".cm-tab"))&&(d.content.className="cm-tab-wrap-hack")}return Qe(a,"renderLine",a,l.line,d.pre),d.pre.className&&(d.textClass=Se(d.pre.className,d.textClass||"")),d}function _r(a){var l=Pe("span","•","cm-invalidchar");return l.title="\\u"+a.charCodeAt(0).toString(16),l.setAttribute("aria-label",l.title),l}function Cs(a,l,g,d,A,E,L){if(l){var O=a.splitSpaces?co(l,a.trailingSpace):l,Z=a.cm.state.specialChars,j=!1,ae;if(!Z.test(l))a.col+=l.length,ae=document.createTextNode(O),a.map.push(a.pos,a.pos+l.length,ae),b&&M<9&&(j=!0),a.pos+=l.length;else{ae=document.createDocumentFragment();for(var fe=0;;){Z.lastIndex=fe;var Me=Z.exec(l),be=Me?Me.index-fe:l.length-fe;if(be){var Fe=document.createTextNode(O.slice(fe,fe+be));b&&M<9?ae.appendChild(Pe("span",[Fe])):ae.appendChild(Fe),a.map.push(a.pos,a.pos+be,Fe),a.col+=be,a.pos+=be}if(!Me)break;fe+=be+1;var $e=void 0;if(Me[0]=="	"){var Ze=a.cm.options.tabSize,je=Ze-a.col%Ze;$e=ae.appendChild(Pe("span",Nt(je),"cm-tab")),$e.setAttribute("role","presentation"),$e.setAttribute("cm-text","	"),a.col+=je}else Me[0]=="\r"||Me[0]==`
`?($e=ae.appendChild(Pe("span",Me[0]=="\r"?"␍":"␤","cm-invalidchar")),$e.setAttribute("cm-text",Me[0]),a.col+=1):($e=a.cm.options.specialCharPlaceholder(Me[0]),$e.setAttribute("cm-text",Me[0]),b&&M<9?ae.appendChild(Pe("span",[$e])):ae.appendChild($e),a.col+=1);a.map.push(a.pos,a.pos+1,$e),a.pos++}}if(a.trailingSpace=O.charCodeAt(l.length-1)==32,g||d||A||j||E||L){var Je=g||"";d&&(Je+=d),A&&(Je+=A);var Ye=Pe("span",[ae],Je,E);if(L)for(var et in L)L.hasOwnProperty(et)&&et!="style"&&et!="class"&&Ye.setAttribute(et,L[et]);return a.content.appendChild(Ye)}a.content.appendChild(ae)}}function co(a,l){if(a.length>1&&!/  /.test(a))return a;for(var g=l,d="",A=0;A<a.length;A++){var E=a.charAt(A);E==" "&&g&&(A==a.length-1||a.charCodeAt(A+1)==32)&&(E=" "),d+=E,g=E==" "}return d}function po(a,l){return function(g,d,A,E,L,O,Z){A=A?A+" cm-force-border":"cm-force-border";for(var j=g.pos,ae=j+d.length;;){for(var fe=void 0,Me=0;Me<l.length&&(fe=l[Me],!(fe.to>j&&fe.from<=j));Me++);if(fe.to>=ae)return a(g,d,A,E,L,O,Z);a(g,d.slice(0,fe.to-j),A,E,null,O,Z),E=null,d=d.slice(fe.to-j),j=fe.to}}}function Ms(a,l,g,d){var A=!d&&g.widgetNode;A&&a.map.push(a.pos,a.pos+l,A),!d&&a.cm.display.input.needsContentAttribute&&(A||(A=a.content.appendChild(document.createElement("span"))),A.setAttribute("cm-marker",g.id)),A&&(a.cm.display.input.setUneditable(A),a.content.appendChild(A)),a.pos+=l,a.trailingSpace=!1}function fo(a,l,g){var d=a.markedSpans,A=a.text,E=0;if(!d){for(var L=1;L<g.length;L+=2)l.addToken(l,A.slice(E,E=g[L]),bs(g[L+1],l.cm.options));return}for(var O=A.length,Z=0,j=1,ae="",fe,Me,be=0,Fe,$e,Ze,je,Je;;){if(be==Z){Fe=$e=Ze=Me="",Je=null,je=null,be=1/0;for(var Ye=[],et=void 0,ht=0;ht<d.length;++ht){var ct=d[ht],Tt=ct.marker;if(Tt.type=="bookmark"&&ct.from==Z&&Tt.widgetNode)Ye.push(Tt);else if(ct.from<=Z&&(ct.to==null||ct.to>Z||Tt.collapsed&&ct.to==Z&&ct.from==Z)){if(ct.to!=null&&ct.to!=Z&&be>ct.to&&(be=ct.to,$e=""),Tt.className&&(Fe+=" "+Tt.className),Tt.css&&(Me=(Me?Me+";":"")+Tt.css),Tt.startStyle&&ct.from==Z&&(Ze+=" "+Tt.startStyle),Tt.endStyle&&ct.to==be&&(et||(et=[])).push(Tt.endStyle,ct.to),Tt.title&&((Je||(Je={})).title=Tt.title),Tt.attributes)for(var Yt in Tt.attributes)(Je||(Je={}))[Yt]=Tt.attributes[Yt];Tt.collapsed&&(!je||ki(je.marker,Tt)<0)&&(je=ct)}else ct.from>Z&&be>ct.from&&(be=ct.from)}if(et)for(var hn=0;hn<et.length;hn+=2)et[hn+1]==be&&($e+=" "+et[hn]);if(!je||je.from==Z)for(var Qt=0;Qt<Ye.length;++Qt)Ms(l,0,Ye[Qt]);if(je&&(je.from||0)==Z){if(Ms(l,(je.to==null?O+1:je.to)-Z,je.marker,je.from==null),je.to==null)return;je.to==Z&&(je=!1)}}if(Z>=O)break;for(var Gn=Math.min(O,be);;){if(ae){var En=Z+ae.length;if(!je){var ln=En>Gn?ae.slice(0,Gn-Z):ae;l.addToken(l,ln,fe?fe+Fe:Fe,Ze,Z+ln.length==be?$e:"",Me,Je)}if(En>=Gn){ae=ae.slice(Gn-Z),Z=Gn;break}Z=En,Ze=""}ae=A.slice(E,E=g[j++]),fe=bs(g[j++],l.cm.options)}}}function xs(a,l,g){this.line=l,this.rest=Jr(l),this.size=this.rest?Xt(_t(this.rest))-g+1:1,this.node=this.text=null,this.hidden=wn(a,l)}function ti(a,l,g){for(var d=[],A,E=l;E<g;E=A){var L=new xs(a.doc,ot(a.doc,E),E);A=E+L.size,d.push(L)}return d}var yr=null;function ho(a){yr?yr.ops.push(a):a.ownsGroup=yr={ops:[a],delayedCallbacks:[]}}function Gr(a){var l=a.delayedCallbacks,g=0;do{for(;g<l.length;g++)l[g].call(null);for(var d=0;d<a.ops.length;d++){var A=a.ops[d];if(A.cursorActivityHandlers)for(;A.cursorActivityCalled<A.cursorActivityHandlers.length;)A.cursorActivityHandlers[A.cursorActivityCalled++].call(null,A.cm)}}while(g<l.length)}function qn(a,l){var g=a.ownsGroup;if(g)try{Gr(g)}finally{yr=null,l(g)}}var vr=null;function un(a,l){var g=Dt(a,l);if(g.length){var d=Array.prototype.slice.call(arguments,2),A;yr?A=yr.delayedCallbacks:vr?A=vr:(A=vr=[],setTimeout(mo,0));for(var E=function(O){A.push(function(){return g[O].apply(null,d)})},L=0;L<g.length;++L)E(L)}}function mo(){var a=vr;vr=null;for(var l=0;l<a.length;++l)a[l]()}function Li(a,l,g,d){for(var A=0;A<l.changes.length;A++){var E=l.changes[A];E=="text"?_o(a,l):E=="gutter"?Ss(a,l,g,d):E=="class"?Gi(a,l):E=="widget"&&yo(a,l,d)}l.changes=null}function br(a){return a.node==a.text&&(a.node=Pe("div",null,null,"position: relative"),a.text.parentNode&&a.text.parentNode.replaceChild(a.node,a.text),a.node.appendChild(a.text),b&&M<8&&(a.node.style.zIndex=2)),a.node}function go(a,l){var g=l.bgClass?l.bgClass+" "+(l.line.bgClass||""):l.line.bgClass;if(g&&(g+=" CodeMirror-linebackground"),l.background)g?l.background.className=g:(l.background.parentNode.removeChild(l.background),l.background=null);else if(g){var d=br(l);l.background=d.insertBefore(Pe("div",null,g),d.firstChild),a.display.input.setUneditable(l.background)}}function Ps(a,l){var g=a.display.externalMeasured;return g&&g.line==l.line?(a.display.externalMeasured=null,l.measure=g.measure,g.built):As(a,l)}function _o(a,l){var g=l.text.className,d=Ps(a,l);l.text==l.node&&(l.node=d.pre),l.text.parentNode.replaceChild(d.pre,l.text),l.text=d.pre,d.bgClass!=l.bgClass||d.textClass!=l.textClass?(l.bgClass=d.bgClass,l.textClass=d.textClass,Gi(a,l)):g&&(l.text.className=g)}function Gi(a,l){go(a,l),l.line.wrapClass?br(l).className=l.line.wrapClass:l.node!=l.text&&(l.node.className="");var g=l.textClass?l.textClass+" "+(l.line.textClass||""):l.line.textClass;l.text.className=g||""}function Ss(a,l,g,d){if(l.gutter&&(l.node.removeChild(l.gutter),l.gutter=null),l.gutterBackground&&(l.node.removeChild(l.gutterBackground),l.gutterBackground=null),l.line.gutterClass){var A=br(l);l.gutterBackground=Pe("div",null,"CodeMirror-gutter-background "+l.line.gutterClass,"left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px; width: "+d.gutterTotalWidth+"px"),a.display.input.setUneditable(l.gutterBackground),A.insertBefore(l.gutterBackground,l.text)}var E=l.line.gutterMarkers;if(a.options.lineNumbers||E){var L=br(l),O=l.gutter=Pe("div",null,"CodeMirror-gutter-wrapper","left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px");if(O.setAttribute("aria-hidden","true"),a.display.input.setUneditable(O),L.insertBefore(O,l.text),l.line.gutterClass&&(O.className+=" "+l.line.gutterClass),a.options.lineNumbers&&(!E||!E["CodeMirror-linenumbers"])&&(l.lineNumber=O.appendChild(Pe("div",xi(a.options,g),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+d.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.display.lineNumInnerWidth+"px"))),E)for(var Z=0;Z<a.display.gutterSpecs.length;++Z){var j=a.display.gutterSpecs[Z].className,ae=E.hasOwnProperty(j)&&E[j];ae&&O.appendChild(Pe("div",[ae],"CodeMirror-gutter-elt","left: "+d.gutterLeft[j]+"px; width: "+d.gutterWidth[j]+"px"))}}}function yo(a,l,g){l.alignable&&(l.alignable=null);for(var d=ve("CodeMirror-linewidget"),A=l.node.firstChild,E=void 0;A;A=E)E=A.nextSibling,d.test(A.className)&&l.node.removeChild(A);ws(a,l,g)}function vo(a,l,g,d){var A=Ps(a,l);return l.text=l.node=A.pre,A.bgClass&&(l.bgClass=A.bgClass),A.textClass&&(l.textClass=A.textClass),Gi(a,l),Ss(a,l,g,d),ws(a,l,d),l.node}function ws(a,l,g){if(Ds(a,l.line,l,g,!0),l.rest)for(var d=0;d<l.rest.length;d++)Ds(a,l.rest[d],l,g,!1)}function Ds(a,l,g,d,A){if(l.widgets)for(var E=br(g),L=0,O=l.widgets;L<O.length;++L){var Z=O[L],j=Pe("div",[Z.node],"CodeMirror-linewidget"+(Z.className?" "+Z.className:""));Z.handleMouseEvents||j.setAttribute("cm-ignore-events","true"),bo(Z,j,g,d),a.display.input.setUneditable(j),A&&Z.above?E.insertBefore(j,g.gutter||g.text):E.appendChild(j),un(Z,"redraw")}}function bo(a,l,g,d){if(a.noHScroll){(g.alignable||(g.alignable=[])).push(l);var A=d.wrapperWidth;l.style.left=d.fixedPos+"px",a.coverGutter||(A-=d.gutterTotalWidth,l.style.paddingLeft=d.gutterTotalWidth+"px"),l.style.width=A+"px"}a.coverGutter&&(l.style.zIndex=5,l.style.position="relative",a.noHScroll||(l.style.marginLeft=-d.gutterTotalWidth+"px"))}function sr(a){if(a.height!=null)return a.height;var l=a.doc.cm;if(!l)return 0;if(!Ke(document.body,a.node)){var g="position: relative;";a.coverGutter&&(g+="margin-left: -"+l.display.gutters.offsetWidth+"px;"),a.noHScroll&&(g+="width: "+l.display.wrapper.clientWidth+"px;"),Oe(l.display.measure,Pe("div",[a.node],null,g))}return a.height=a.node.parentNode.offsetHeight}function Hn(a,l){for(var g=An(l);g!=a.wrapper;g=g.parentNode)if(!g||g.nodeType==1&&g.getAttribute("cm-ignore-events")=="true"||g.parentNode==a.sizer&&g!=a.mover)return!0}function ni(a){return a.lineSpace.offsetTop}function Jn(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}function Fs(a){if(a.cachedPaddingH)return a.cachedPaddingH;var l=Oe(a.measure,Pe("pre","x","CodeMirror-line-like")),g=window.getComputedStyle?window.getComputedStyle(l):l.currentStyle,d={left:parseInt(g.paddingLeft),right:parseInt(g.paddingRight)};return!isNaN(d.left)&&!isNaN(d.right)&&(a.cachedPaddingH=d),d}function Zn(a){return pt-a.display.nativeBarWidth}function ur(a){return a.display.scroller.clientWidth-Zn(a)-a.display.barWidth}function Ri(a){return a.display.scroller.clientHeight-Zn(a)-a.display.barHeight}function Ao(a,l,g){var d=a.options.lineWrapping,A=d&&ur(a);if(!l.measure.heights||d&&l.measure.width!=A){var E=l.measure.heights=[];if(d){l.measure.width=A;for(var L=l.text.firstChild.getClientRects(),O=0;O<L.length-1;O++){var Z=L[O],j=L[O+1];Math.abs(Z.bottom-j.bottom)>2&&E.push((Z.bottom+j.top)/2-g.top)}}E.push(g.bottom-g.top)}}function Es(a,l,g){if(a.line==l)return{map:a.measure.map,cache:a.measure.cache};if(a.rest){for(var d=0;d<a.rest.length;d++)if(a.rest[d]==l)return{map:a.measure.maps[d],cache:a.measure.caches[d]};for(var A=0;A<a.rest.length;A++)if(Xt(a.rest[A])>g)return{map:a.measure.maps[A],cache:a.measure.caches[A],before:!0}}}function Co(a,l){l=Bn(l);var g=Xt(l),d=a.display.externalMeasured=new xs(a.doc,l,g);d.lineN=g;var A=d.built=As(a,d);return d.text=A.pre,Oe(a.display.lineMeasure,A.pre),d}function ks(a,l,g,d){return zn(a,Cr(a,l),g,d)}function Ar(a,l){if(l>=a.display.viewFrom&&l<a.display.viewTo)return a.display.view[$r(a,l)];var g=a.display.externalMeasured;if(g&&l>=g.lineN&&l<g.lineN+g.size)return g}function Cr(a,l){var g=Xt(l),d=Ar(a,g);d&&!d.text?d=null:d&&d.changes&&(Li(a,d,g,wo(a)),a.curOp.forceUpdate=!0),d||(d=Co(a,l));var A=Es(d,l,g);return{line:l,view:d,rect:null,map:A.map,cache:A.cache,before:A.before,hasHeights:!1}}function zn(a,l,g,d,A){l.before&&(g=-1);var E=g+(d||""),L;return l.cache.hasOwnProperty(E)?L=l.cache[E]:(l.rect||(l.rect=l.view.text.getBoundingClientRect()),l.hasHeights||(Ao(a,l.view,l.rect),l.hasHeights=!0),L=oe(a,l,g,d),L.bogus||(l.cache[E]=L)),{left:L.left,right:L.right,top:A?L.rtop:L.top,bottom:A?L.rbottom:L.bottom}}var ri={left:0,right:0,top:0,bottom:0};function ii(a,l,g){for(var d,A,E,L,O,Z,j=0;j<a.length;j+=3)if(O=a[j],Z=a[j+1],l<O?(A=0,E=1,L="left"):l<Z?(A=l-O,E=A+1):(j==a.length-3||l==Z&&a[j+3]>l)&&(E=Z-O,A=E-1,l>=Z&&(L="right")),A!=null){if(d=a[j+2],O==Z&&g==(d.insertLeft?"left":"right")&&(L=g),g=="left"&&A==0)for(;j&&a[j-2]==a[j-3]&&a[j-1].insertLeft;)d=a[(j-=3)+2],L="left";if(g=="right"&&A==Z-O)for(;j<a.length-3&&a[j+3]==a[j+4]&&!a[j+5].insertLeft;)d=a[(j+=3)+2],L="right";break}return{node:d,start:A,end:E,collapse:L,coverStart:O,coverEnd:Z}}function I(a,l){var g=ri;if(l=="left")for(var d=0;d<a.length&&(g=a[d]).left==g.right;d++);else for(var A=a.length-1;A>=0&&(g=a[A]).left==g.right;A--);return g}function oe(a,l,g,d){var A=ii(l.map,g,d),E=A.node,L=A.start,O=A.end,Z=A.collapse,j;if(E.nodeType==3){for(var ae=0;ae<4;ae++){for(;L&&ze(l.line.text.charAt(A.coverStart+L));)--L;for(;A.coverStart+O<A.coverEnd&&ze(l.line.text.charAt(A.coverStart+O));)++O;if(b&&M<9&&L==0&&O==A.coverEnd-A.coverStart?j=E.parentNode.getBoundingClientRect():j=I(Xe(E,L,O).getClientRects(),d),j.left||j.right||L==0)break;O=L,L=L-1,Z="right"}b&&M<11&&(j=de(a.display.measure,j))}else{L>0&&(Z=d="right");var fe;a.options.lineWrapping&&(fe=E.getClientRects()).length>1?j=fe[d=="right"?fe.length-1:0]:j=E.getBoundingClientRect()}if(b&&M<9&&!L&&(!j||!j.left&&!j.right)){var Me=E.parentNode.getClientRects()[0];Me?j={left:Me.left,right:Me.left+oi(a.display),top:Me.top,bottom:Me.bottom}:j=ri}for(var be=j.top-l.rect.top,Fe=j.bottom-l.rect.top,$e=(be+Fe)/2,Ze=l.view.measure.heights,je=0;je<Ze.length-1&&!($e<Ze[je]);je++);var Je=je?Ze[je-1]:0,Ye=Ze[je],et={left:(Z=="right"?j.right:j.left)-l.rect.left,right:(Z=="left"?j.left:j.right)-l.rect.left,top:Je,bottom:Ye};return!j.left&&!j.right&&(et.bogus=!0),a.options.singleCursorHeightPerLine||(et.rtop=be,et.rbottom=Fe),et}function de(a,l){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Jt(a))return l;var g=screen.logicalXDPI/screen.deviceXDPI,d=screen.logicalYDPI/screen.deviceYDPI;return{left:l.left*g,right:l.right*g,top:l.top*d,bottom:l.bottom*d}}function Re(a){if(a.measure&&(a.measure.cache={},a.measure.heights=null,a.rest))for(var l=0;l<a.rest.length;l++)a.measure.caches[l]={}}function ut(a){a.display.externalMeasure=null,xe(a.display.lineMeasure);for(var l=0;l<a.display.view.length;l++)Re(a.display.view[l])}function Ht(a){ut(a),a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=null,a.options.lineWrapping||(a.display.maxLineChanged=!0),a.display.lineNumChars=null}function Nn(){return k&&z?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function lr(){return k&&z?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Mo(a){var l=Bn(a),g=l.widgets,d=0;if(g)for(var A=0;A<g.length;++A)g[A].above&&(d+=sr(g[A]));return d}function Ts(a,l,g,d,A){if(!A){var E=Mo(l);g.top+=E,g.bottom+=E}if(d=="line")return g;d||(d="local");var L=Mn(l);if(d=="local"?L+=ni(a.display):L-=a.display.viewOffset,d=="page"||d=="window"){var O=a.display.lineSpace.getBoundingClientRect();L+=O.top+(d=="window"?0:lr());var Z=O.left+(d=="window"?0:Nn());g.left+=Z,g.right+=Z}return g.top+=L,g.bottom+=L,g}function ia(a,l,g){if(g=="div")return l;var d=l.left,A=l.top;if(g=="page")d-=Nn(),A-=lr();else if(g=="local"||!g){var E=a.display.sizer.getBoundingClientRect();d+=E.left,A+=E.top}var L=a.display.lineSpace.getBoundingClientRect();return{left:d-L.left,top:A-L.top}}function Ns(a,l,g,d,A){return d||(d=ot(a.doc,l.line)),Ts(a,d,ks(a,d,l.ch,A),g)}function Un(a,l,g,d,A,E){d=d||ot(a.doc,l.line),A||(A=Cr(a,d));function L(Fe,$e){var Ze=zn(a,A,Fe,$e?"right":"left",E);return $e?Ze.left=Ze.right:Ze.right=Ze.left,Ts(a,d,Ze,g)}var O=Gt(d,a.doc.direction),Z=l.ch,j=l.sticky;if(Z>=d.text.length?(Z=d.text.length,j="before"):Z<=0&&(Z=0,j="after"),!O)return L(j=="before"?Z-1:Z,j=="before");function ae(Fe,$e,Ze){var je=O[$e],Je=je.level==1;return L(Ze?Fe-1:Fe,Je!=Ze)}var fe=He(O,Z,j),Me=Ge,be=ae(Z,fe,j=="before");return Me!=null&&(be.other=ae(Z,Me,j!="before")),be}function sa(a,l){var g=0;l=Pt(a.doc,l),a.options.lineWrapping||(g=oi(a.display)*l.ch);var d=ot(a.doc,l.line),A=Mn(d)+ni(a.display);return{left:g,right:g,top:A,bottom:A+d.height}}function xo(a,l,g,d,A){var E=We(a,l,g);return E.xRel=A,d&&(E.outside=d),E}function Po(a,l,g){var d=a.doc;if(g+=a.display.viewOffset,g<0)return xo(d.first,0,null,-1,-1);var A=rr(d,g),E=d.first+d.size-1;if(A>E)return xo(d.first+d.size-1,ot(d,E).text.length,null,1,1);l<0&&(l=0);for(var L=ot(d,A);;){var O=Mu(a,L,A,l,g),Z=oo(L,O.ch+(O.xRel>0||O.outside>0?1:0));if(!Z)return O;var j=Z.find(1);if(j.line==A)return j;L=ot(d,A=j.line)}}function oa(a,l,g,d){d-=Mo(l);var A=l.text.length,E=De(function(L){return zn(a,g,L-1).bottom<=d},A,0);return A=De(function(L){return zn(a,g,L).top>d},E,A),{begin:E,end:A}}function aa(a,l,g,d){g||(g=Cr(a,l));var A=Ts(a,l,zn(a,g,d),"line").top;return oa(a,l,g,A)}function So(a,l,g,d){return a.bottom<=g?!1:a.top>g?!0:(d?a.left:a.right)>l}function Mu(a,l,g,d,A){A-=Mn(l);var E=Cr(a,l),L=Mo(l),O=0,Z=l.text.length,j=!0,ae=Gt(l,a.doc.direction);if(ae){var fe=(a.options.lineWrapping?Pu:xu)(a,l,g,E,ae,d,A);j=fe.level!=1,O=j?fe.from:fe.to-1,Z=j?fe.to:fe.from-1}var Me=null,be=null,Fe=De(function(ht){var ct=zn(a,E,ht);return ct.top+=L,ct.bottom+=L,So(ct,d,A,!1)?(ct.top<=A&&ct.left<=d&&(Me=ht,be=ct),!0):!1},O,Z),$e,Ze,je=!1;if(be){var Je=d-be.left<be.right-d,Ye=Je==j;Fe=Me+(Ye?0:1),Ze=Ye?"after":"before",$e=Je?be.left:be.right}else{!j&&(Fe==Z||Fe==O)&&Fe++,Ze=Fe==0?"after":Fe==l.text.length?"before":zn(a,E,Fe-(j?1:0)).bottom+L<=A==j?"after":"before";var et=Un(a,We(g,Fe,Ze),"line",l,E);$e=et.left,je=A<et.top?-1:A>=et.bottom?1:0}return Fe=Ne(l.text,Fe,1),xo(g,Fe,Ze,je,d-$e)}function xu(a,l,g,d,A,E,L){var O=De(function(fe){var Me=A[fe],be=Me.level!=1;return So(Un(a,We(g,be?Me.to:Me.from,be?"before":"after"),"line",l,d),E,L,!0)},0,A.length-1),Z=A[O];if(O>0){var j=Z.level!=1,ae=Un(a,We(g,j?Z.from:Z.to,j?"after":"before"),"line",l,d);So(ae,E,L,!0)&&ae.top>L&&(Z=A[O-1])}return Z}function Pu(a,l,g,d,A,E,L){var O=oa(a,l,d,L),Z=O.begin,j=O.end;/\s/.test(l.text.charAt(j-1))&&j--;for(var ae=null,fe=null,Me=0;Me<A.length;Me++){var be=A[Me];if(!(be.from>=j||be.to<=Z)){var Fe=be.level!=1,$e=zn(a,d,Fe?Math.min(j,be.to)-1:Math.max(Z,be.from)).right,Ze=$e<E?E-$e+1e9:$e-E;(!ae||fe>Ze)&&(ae=be,fe=Ze)}}return ae||(ae=A[A.length-1]),ae.from<Z&&(ae={from:Z,to:ae.to,level:ae.level}),ae.to>j&&(ae={from:ae.from,to:j,level:ae.level}),ae}var Rr;function si(a){if(a.cachedTextHeight!=null)return a.cachedTextHeight;if(Rr==null){Rr=Pe("pre",null,"CodeMirror-line-like");for(var l=0;l<49;++l)Rr.appendChild(document.createTextNode("x")),Rr.appendChild(Pe("br"));Rr.appendChild(document.createTextNode("x"))}Oe(a.measure,Rr);var g=Rr.offsetHeight/50;return g>3&&(a.cachedTextHeight=g),xe(a.measure),g||1}function oi(a){if(a.cachedCharWidth!=null)return a.cachedCharWidth;var l=Pe("span","xxxxxxxxxx"),g=Pe("pre",[l],"CodeMirror-line-like");Oe(a.measure,g);var d=l.getBoundingClientRect(),A=(d.right-d.left)/10;return A>2&&(a.cachedCharWidth=A),A||10}function wo(a){for(var l=a.display,g={},d={},A=l.gutters.clientLeft,E=l.gutters.firstChild,L=0;E;E=E.nextSibling,++L){var O=a.display.gutterSpecs[L].className;g[O]=E.offsetLeft+E.clientLeft+A,d[O]=E.clientWidth}return{fixedPos:Do(l),gutterTotalWidth:l.gutters.offsetWidth,gutterLeft:g,gutterWidth:d,wrapperWidth:l.wrapper.clientWidth}}function Do(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function ua(a){var l=si(a.display),g=a.options.lineWrapping,d=g&&Math.max(5,a.display.scroller.clientWidth/oi(a.display)-3);return function(A){if(wn(a.doc,A))return 0;var E=0;if(A.widgets)for(var L=0;L<A.widgets.length;L++)A.widgets[L].height&&(E+=A.widgets[L].height);return g?E+(Math.ceil(A.text.length/d)||1)*l:E+l}}function Fo(a){var l=a.doc,g=ua(a);l.iter(function(d){var A=g(d);A!=d.height&&On(d,A)})}function Br(a,l,g,d){var A=a.display;if(!g&&An(l).getAttribute("cm-not-content")=="true")return null;var E,L,O=A.lineSpace.getBoundingClientRect();try{E=l.clientX-O.left,L=l.clientY-O.top}catch{return null}var Z=Po(a,E,L),j;if(d&&Z.xRel>0&&(j=ot(a.doc,Z.line).text).length==Z.ch){var ae=Ee(j,j.length,a.options.tabSize)-j.length;Z=We(Z.line,Math.max(0,Math.round((E-Fs(a.display).left)/oi(a.display))-ae))}return Z}function $r(a,l){if(l>=a.display.viewTo||(l-=a.display.viewFrom,l<0))return null;for(var g=a.display.view,d=0;d<g.length;d++)if(l-=g[d].size,l<0)return d}function Dn(a,l,g,d){l==null&&(l=a.doc.first),g==null&&(g=a.doc.first+a.doc.size),d||(d=0);var A=a.display;if(d&&g<A.viewTo&&(A.updateLineNumbers==null||A.updateLineNumbers>l)&&(A.updateLineNumbers=l),a.curOp.viewChanged=!0,l>=A.viewTo)le&&Ni(a.doc,l)<A.viewTo&&xr(a);else if(g<=A.viewFrom)le&&ys(a.doc,g+d)>A.viewFrom?xr(a):(A.viewFrom+=d,A.viewTo+=d);else if(l<=A.viewFrom&&g>=A.viewTo)xr(a);else if(l<=A.viewFrom){var E=Ls(a,g,g+d,1);E?(A.view=A.view.slice(E.index),A.viewFrom=E.lineN,A.viewTo+=d):xr(a)}else if(g>=A.viewTo){var L=Ls(a,l,l,-1);L?(A.view=A.view.slice(0,L.index),A.viewTo=L.lineN):xr(a)}else{var O=Ls(a,l,l,-1),Z=Ls(a,g,g+d,1);O&&Z?(A.view=A.view.slice(0,O.index).concat(ti(a,O.lineN,Z.lineN)).concat(A.view.slice(Z.index)),A.viewTo+=d):xr(a)}var j=A.externalMeasured;j&&(g<j.lineN?j.lineN+=d:l<j.lineN+j.size&&(A.externalMeasured=null))}function Mr(a,l,g){a.curOp.viewChanged=!0;var d=a.display,A=a.display.externalMeasured;if(A&&l>=A.lineN&&l<A.lineN+A.size&&(d.externalMeasured=null),!(l<d.viewFrom||l>=d.viewTo)){var E=d.view[$r(a,l)];if(E.node!=null){var L=E.changes||(E.changes=[]);St(L,g)==-1&&L.push(g)}}}function xr(a){a.display.viewFrom=a.display.viewTo=a.doc.first,a.display.view=[],a.display.viewOffset=0}function Ls(a,l,g,d){var A=$r(a,l),E,L=a.display.view;if(!le||g==a.doc.first+a.doc.size)return{index:A,lineN:g};for(var O=a.display.viewFrom,Z=0;Z<A;Z++)O+=L[Z].size;if(O!=l){if(d>0){if(A==L.length-1)return null;E=O+L[A].size-l,A++}else E=O-l;l+=E,g+=E}for(;Ni(a.doc,g)!=g;){if(A==(d<0?0:L.length-1))return null;g+=d*L[A-(d<0?1:0)].size,A+=d}return{index:A,lineN:g}}function Su(a,l,g){var d=a.display,A=d.view;A.length==0||l>=d.viewTo||g<=d.viewFrom?(d.view=ti(a,l,g),d.viewFrom=l):(d.viewFrom>l?d.view=ti(a,l,d.viewFrom).concat(d.view):d.viewFrom<l&&(d.view=d.view.slice($r(a,l))),d.viewFrom=l,d.viewTo<g?d.view=d.view.concat(ti(a,d.viewTo,g)):d.viewTo>g&&(d.view=d.view.slice(0,$r(a,g)))),d.viewTo=g}function la(a){for(var l=a.display.view,g=0,d=0;d<l.length;d++){var A=l[d];!A.hidden&&(!A.node||A.changes)&&++g}return g}function Bi(a){a.display.input.showSelection(a.display.input.prepareSelection())}function ca(a,l){l===void 0&&(l=!0);var g=a.doc,d={},A=d.cursors=document.createDocumentFragment(),E=d.selection=document.createDocumentFragment(),L=a.options.$customCursor;L&&(l=!0);for(var O=0;O<g.sel.ranges.length;O++)if(!(!l&&O==g.sel.primIndex)){var Z=g.sel.ranges[O];if(!(Z.from().line>=a.display.viewTo||Z.to().line<a.display.viewFrom)){var j=Z.empty();if(L){var ae=L(a,Z);ae&&Eo(a,ae,A)}else(j||a.options.showCursorWhenSelecting)&&Eo(a,Z.head,A);j||wu(a,Z,E)}}return d}function Eo(a,l,g){var d=Un(a,l,"div",null,null,!a.options.singleCursorHeightPerLine),A=g.appendChild(Pe("div"," ","CodeMirror-cursor"));if(A.style.left=d.left+"px",A.style.top=d.top+"px",A.style.height=Math.max(0,d.bottom-d.top)*a.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(a.getWrapperElement().className)){var E=Ns(a,l,"div",null,null),L=E.right-E.left;A.style.width=(L>0?L:a.defaultCharWidth())+"px"}if(d.other){var O=g.appendChild(Pe("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));O.style.display="",O.style.left=d.other.left+"px",O.style.top=d.other.top+"px",O.style.height=(d.other.bottom-d.other.top)*.85+"px"}}function Gs(a,l){return a.top-l.top||a.left-l.left}function wu(a,l,g){var d=a.display,A=a.doc,E=document.createDocumentFragment(),L=Fs(a.display),O=L.left,Z=Math.max(d.sizerWidth,ur(a)-d.sizer.offsetLeft)-L.right,j=A.direction=="ltr";function ae(Ye,et,ht,ct){et<0&&(et=0),et=Math.round(et),ct=Math.round(ct),E.appendChild(Pe("div",null,"CodeMirror-selected","position: absolute; left: "+Ye+`px;
                             top: `+et+"px; width: "+(ht??Z-Ye)+`px;
                             height: `+(ct-et)+"px"))}function fe(Ye,et,ht){var ct=ot(A,Ye),Tt=ct.text.length,Yt,hn;function Qt(ln,kn){return Ns(a,We(Ye,ln),"div",ct,kn)}function Gn(ln,kn,gn){var pn=aa(a,ct,null,ln),cn=kn=="ltr"==(gn=="after")?"left":"right",tn=gn=="after"?pn.begin:pn.end-(/\s/.test(ct.text.charAt(pn.end-1))?2:1);return Qt(tn,cn)[cn]}var En=Gt(ct,A.direction);return Ie(En,et||0,ht??Tt,function(ln,kn,gn,pn){var cn=gn=="ltr",tn=Qt(ln,cn?"left":"right"),Tn=Qt(kn-1,cn?"right":"left"),vi=et==null&&ln==0,Er=ht==null&&kn==Tt,bn=pn==0,Qn=!En||pn==En.length-1;if(Tn.top-tn.top<=3){var mn=(j?vi:Er)&&bn,na=(j?Er:vi)&&Qn,dr=mn?O:(cn?tn:Tn).left,Vr=na?Z:(cn?Tn:tn).right;ae(dr,tn.top,Vr-dr,tn.bottom)}else{var Zr,Pn,bi,ra;cn?(Zr=j&&vi&&bn?O:tn.left,Pn=j?Z:Gn(ln,gn,"before"),bi=j?O:Gn(kn,gn,"after"),ra=j&&Er&&Qn?Z:Tn.right):(Zr=j?Gn(ln,gn,"before"):O,Pn=!j&&vi&&bn?Z:tn.right,bi=!j&&Er&&Qn?O:Tn.left,ra=j?Gn(kn,gn,"after"):Z),ae(Zr,tn.top,Pn-Zr,tn.bottom),tn.bottom<Tn.top&&ae(O,tn.bottom,null,Tn.top),ae(bi,Tn.top,ra-bi,Tn.bottom)}(!Yt||Gs(tn,Yt)<0)&&(Yt=tn),Gs(Tn,Yt)<0&&(Yt=Tn),(!hn||Gs(tn,hn)<0)&&(hn=tn),Gs(Tn,hn)<0&&(hn=Tn)}),{start:Yt,end:hn}}var Me=l.from(),be=l.to();if(Me.line==be.line)fe(Me.line,Me.ch,be.ch);else{var Fe=ot(A,Me.line),$e=ot(A,be.line),Ze=Bn(Fe)==Bn($e),je=fe(Me.line,Me.ch,Ze?Fe.text.length+1:null).end,Je=fe(be.line,Ze?0:null,be.ch).start;Ze&&(je.top<Je.top-2?(ae(je.right,je.top,null,je.bottom),ae(O,Je.top,Je.left,Je.bottom)):ae(je.right,je.top,Je.left-je.right,je.bottom)),je.bottom<Je.top&&ae(O,je.bottom,null,Je.top)}g.appendChild(E)}function ko(a){if(a.state.focused){var l=a.display;clearInterval(l.blinker);var g=!0;l.cursorDiv.style.visibility="",a.options.cursorBlinkRate>0?l.blinker=setInterval(function(){a.hasFocus()||ai(a),l.cursorDiv.style.visibility=(g=!g)?"":"hidden"},a.options.cursorBlinkRate):a.options.cursorBlinkRate<0&&(l.cursorDiv.style.visibility="hidden")}}function pa(a){a.hasFocus()||(a.display.input.focus(),a.state.focused||No(a))}function To(a){a.state.delayingBlurEvent=!0,setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1,a.state.focused&&ai(a))},100)}function No(a,l){a.state.delayingBlurEvent&&!a.state.draggingText&&(a.state.delayingBlurEvent=!1),a.options.readOnly!="nocursor"&&(a.state.focused||(Qe(a,"focus",a,l),a.state.focused=!0,ye(a.display.wrapper,"CodeMirror-focused"),!a.curOp&&a.display.selForContextMenu!=a.doc.sel&&(a.display.input.reset(),F&&setTimeout(function(){return a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),ko(a))}function ai(a,l){a.state.delayingBlurEvent||(a.state.focused&&(Qe(a,"blur",a,l),a.state.focused=!1,we(a.display.wrapper,"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.display.shift=!1)},150))}function Rs(a){for(var l=a.display,g=l.lineDiv.offsetTop,d=Math.max(0,l.scroller.getBoundingClientRect().top),A=l.lineDiv.getBoundingClientRect().top,E=0,L=0;L<l.view.length;L++){var O=l.view[L],Z=a.options.lineWrapping,j=void 0,ae=0;if(!O.hidden){if(A+=O.line.height,b&&M<8){var fe=O.node.offsetTop+O.node.offsetHeight;j=fe-g,g=fe}else{var Me=O.node.getBoundingClientRect();j=Me.bottom-Me.top,!Z&&O.text.firstChild&&(ae=O.text.firstChild.getBoundingClientRect().right-Me.left-1)}var be=O.line.height-j;if((be>.005||be<-.005)&&(A<d&&(E-=be),On(O.line,j),fa(O.line),O.rest))for(var Fe=0;Fe<O.rest.length;Fe++)fa(O.rest[Fe]);if(ae>a.display.sizerWidth){var $e=Math.ceil(ae/oi(a.display));$e>a.display.maxLineLength&&(a.display.maxLineLength=$e,a.display.maxLine=O.line,a.display.maxLineChanged=!0)}}}Math.abs(E)>2&&(l.scroller.scrollTop+=E)}function fa(a){if(a.widgets)for(var l=0;l<a.widgets.length;++l){var g=a.widgets[l],d=g.node.parentNode;d&&(g.height=d.offsetHeight)}}function Bs(a,l,g){var d=g&&g.top!=null?Math.max(0,g.top):a.scroller.scrollTop;d=Math.floor(d-ni(a));var A=g&&g.bottom!=null?g.bottom:d+a.wrapper.clientHeight,E=rr(l,d),L=rr(l,A);if(g&&g.ensure){var O=g.ensure.from.line,Z=g.ensure.to.line;O<E?(E=O,L=rr(l,Mn(ot(l,O))+a.wrapper.clientHeight)):Math.min(Z,l.lastLine())>=L&&(E=rr(l,Mn(ot(l,Z))-a.wrapper.clientHeight),L=Z)}return{from:E,to:Math.max(L,E+1)}}function Du(a,l){if(!Bt(a,"scrollCursorIntoView")){var g=a.display,d=g.sizer.getBoundingClientRect(),A=null;if(l.top+d.top<0?A=!0:l.bottom+d.top>(window.innerHeight||document.documentElement.clientHeight)&&(A=!1),A!=null&&!U){var E=Pe("div","​",null,`position: absolute;
                         top: `+(l.top-g.viewOffset-ni(a.display))+`px;
                         height: `+(l.bottom-l.top+Zn(a)+g.barHeight)+`px;
                         left: `+l.left+"px; width: "+Math.max(2,l.right-l.left)+"px;");a.display.lineSpace.appendChild(E),E.scrollIntoView(A),a.display.lineSpace.removeChild(E)}}}function Fu(a,l,g,d){d==null&&(d=0);var A;!a.options.lineWrapping&&l==g&&(g=l.sticky=="before"?We(l.line,l.ch+1,"before"):l,l=l.ch?We(l.line,l.sticky=="before"?l.ch-1:l.ch,"after"):l);for(var E=0;E<5;E++){var L=!1,O=Un(a,l),Z=!g||g==l?O:Un(a,g);A={left:Math.min(O.left,Z.left),top:Math.min(O.top,Z.top)-d,right:Math.max(O.left,Z.left),bottom:Math.max(O.bottom,Z.bottom)+d};var j=Lo(a,A),ae=a.doc.scrollTop,fe=a.doc.scrollLeft;if(j.scrollTop!=null&&(Ii(a,j.scrollTop),Math.abs(a.doc.scrollTop-ae)>1&&(L=!0)),j.scrollLeft!=null&&(Ir(a,j.scrollLeft),Math.abs(a.doc.scrollLeft-fe)>1&&(L=!0)),!L)break}return A}function Eu(a,l){var g=Lo(a,l);g.scrollTop!=null&&Ii(a,g.scrollTop),g.scrollLeft!=null&&Ir(a,g.scrollLeft)}function Lo(a,l){var g=a.display,d=si(a.display);l.top<0&&(l.top=0);var A=a.curOp&&a.curOp.scrollTop!=null?a.curOp.scrollTop:g.scroller.scrollTop,E=Ri(a),L={};l.bottom-l.top>E&&(l.bottom=l.top+E);var O=a.doc.height+Jn(g),Z=l.top<d,j=l.bottom>O-d;if(l.top<A)L.scrollTop=Z?0:l.top;else if(l.bottom>A+E){var ae=Math.min(l.top,(j?O:l.bottom)-E);ae!=A&&(L.scrollTop=ae)}var fe=a.options.fixedGutter?0:g.gutters.offsetWidth,Me=a.curOp&&a.curOp.scrollLeft!=null?a.curOp.scrollLeft:g.scroller.scrollLeft-fe,be=ur(a)-g.gutters.offsetWidth,Fe=l.right-l.left>be;return Fe&&(l.right=l.left+be),l.left<10?L.scrollLeft=0:l.left<Me?L.scrollLeft=Math.max(0,l.left+fe-(Fe?0:10)):l.right>be+Me-3&&(L.scrollLeft=l.right+(Fe?0:10)-be),L}function Go(a,l){l!=null&&($s(a),a.curOp.scrollTop=(a.curOp.scrollTop==null?a.doc.scrollTop:a.curOp.scrollTop)+l)}function ui(a){$s(a);var l=a.getCursor();a.curOp.scrollToPos={from:l,to:l,margin:a.options.cursorScrollMargin}}function $i(a,l,g){(l!=null||g!=null)&&$s(a),l!=null&&(a.curOp.scrollLeft=l),g!=null&&(a.curOp.scrollTop=g)}function ku(a,l){$s(a),a.curOp.scrollToPos=l}function $s(a){var l=a.curOp.scrollToPos;if(l){a.curOp.scrollToPos=null;var g=sa(a,l.from),d=sa(a,l.to);da(a,g,d,l.margin)}}function da(a,l,g,d){var A=Lo(a,{left:Math.min(l.left,g.left),top:Math.min(l.top,g.top)-d,right:Math.max(l.right,g.right),bottom:Math.max(l.bottom,g.bottom)+d});$i(a,A.scrollLeft,A.scrollTop)}function Ii(a,l){Math.abs(a.doc.scrollTop-l)<2||(o||Bo(a,{top:l}),ha(a,l,!0),o&&Bo(a),Xi(a,100))}function ha(a,l,g){l=Math.max(0,Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,l)),!(a.display.scroller.scrollTop==l&&!g)&&(a.doc.scrollTop=l,a.display.scrollbars.setScrollTop(l),a.display.scroller.scrollTop!=l&&(a.display.scroller.scrollTop=l))}function Ir(a,l,g,d){l=Math.max(0,Math.min(l,a.display.scroller.scrollWidth-a.display.scroller.clientWidth)),!((g?l==a.doc.scrollLeft:Math.abs(a.doc.scrollLeft-l)<2)&&!d)&&(a.doc.scrollLeft=l,va(a),a.display.scroller.scrollLeft!=l&&(a.display.scroller.scrollLeft=l),a.display.scrollbars.setScrollLeft(l))}function Oi(a){var l=a.display,g=l.gutters.offsetWidth,d=Math.round(a.doc.height+Jn(a.display));return{clientHeight:l.scroller.clientHeight,viewHeight:l.wrapper.clientHeight,scrollWidth:l.scroller.scrollWidth,clientWidth:l.scroller.clientWidth,viewWidth:l.wrapper.clientWidth,barLeft:a.options.fixedGutter?g:0,docHeight:d,scrollHeight:d+Zn(a)+l.barHeight,nativeBarWidth:l.nativeBarWidth,gutterWidth:g}}var Or=function(a,l,g){this.cm=g;var d=this.vert=Pe("div",[Pe("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),A=this.horiz=Pe("div",[Pe("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");d.tabIndex=A.tabIndex=-1,a(d),a(A),Ue(d,"scroll",function(){d.clientHeight&&l(d.scrollTop,"vertical")}),Ue(A,"scroll",function(){A.clientWidth&&l(A.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,b&&M<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Or.prototype.update=function(a){var l=a.scrollWidth>a.clientWidth+1,g=a.scrollHeight>a.clientHeight+1,d=a.nativeBarWidth;if(g){this.vert.style.display="block",this.vert.style.bottom=l?d+"px":"0";var A=a.viewHeight-(l?d:0);this.vert.firstChild.style.height=Math.max(0,a.scrollHeight-a.clientHeight+A)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(l){this.horiz.style.display="block",this.horiz.style.right=g?d+"px":"0",this.horiz.style.left=a.barLeft+"px";var E=a.viewWidth-a.barLeft-(g?d:0);this.horiz.firstChild.style.width=Math.max(0,a.scrollWidth-a.clientWidth+E)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&a.clientHeight>0&&(d==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:g?d:0,bottom:l?d:0}},Or.prototype.setScrollLeft=function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Or.prototype.setScrollTop=function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Or.prototype.zeroWidthHack=function(){var a=ie&&!R?"12px":"18px";this.horiz.style.height=this.vert.style.width=a,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new rt,this.disableVert=new rt},Or.prototype.enableZeroWidthBar=function(a,l,g){a.style.pointerEvents="auto";function d(){var A=a.getBoundingClientRect(),E=g=="vert"?document.elementFromPoint(A.right-1,(A.top+A.bottom)/2):document.elementFromPoint((A.right+A.left)/2,A.bottom-1);E!=a?a.style.pointerEvents="none":l.set(1e3,d)}l.set(1e3,d)},Or.prototype.clear=function(){var a=this.horiz.parentNode;a.removeChild(this.horiz),a.removeChild(this.vert)};var Wi=function(){};Wi.prototype.update=function(){return{bottom:0,right:0}},Wi.prototype.setScrollLeft=function(){},Wi.prototype.setScrollTop=function(){},Wi.prototype.clear=function(){};function li(a,l){l||(l=Oi(a));var g=a.display.barWidth,d=a.display.barHeight;ma(a,l);for(var A=0;A<4&&g!=a.display.barWidth||d!=a.display.barHeight;A++)g!=a.display.barWidth&&a.options.lineWrapping&&Rs(a),ma(a,Oi(a)),g=a.display.barWidth,d=a.display.barHeight}function ma(a,l){var g=a.display,d=g.scrollbars.update(l);g.sizer.style.paddingRight=(g.barWidth=d.right)+"px",g.sizer.style.paddingBottom=(g.barHeight=d.bottom)+"px",g.heightForcer.style.borderBottom=d.bottom+"px solid transparent",d.right&&d.bottom?(g.scrollbarFiller.style.display="block",g.scrollbarFiller.style.height=d.bottom+"px",g.scrollbarFiller.style.width=d.right+"px"):g.scrollbarFiller.style.display="",d.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(g.gutterFiller.style.display="block",g.gutterFiller.style.height=d.bottom+"px",g.gutterFiller.style.width=l.gutterWidth+"px"):g.gutterFiller.style.display=""}var ga={native:Or,null:Wi};function _a(a){a.display.scrollbars&&(a.display.scrollbars.clear(),a.display.scrollbars.addClass&&we(a.display.wrapper,a.display.scrollbars.addClass)),a.display.scrollbars=new ga[a.options.scrollbarStyle](function(l){a.display.wrapper.insertBefore(l,a.display.scrollbarFiller),Ue(l,"mousedown",function(){a.state.focused&&setTimeout(function(){return a.display.input.focus()},0)}),l.setAttribute("cm-not-content","true")},function(l,g){g=="horizontal"?Ir(a,l):Ii(a,l)},a),a.display.scrollbars.addClass&&ye(a.display.wrapper,a.display.scrollbars.addClass)}var Tu=0;function Wr(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Tu,markArrays:null},ho(a.curOp)}function Xr(a){var l=a.curOp;l&&qn(l,function(g){for(var d=0;d<g.ops.length;d++)g.ops[d].cm.curOp=null;Nu(g)})}function Nu(a){for(var l=a.ops,g=0;g<l.length;g++)Lu(l[g]);for(var d=0;d<l.length;d++)Gu(l[d]);for(var A=0;A<l.length;A++)Ru(l[A]);for(var E=0;E<l.length;E++)Bu(l[E]);for(var L=0;L<l.length;L++)$u(l[L])}function Lu(a){var l=a.cm,g=l.display;Ou(l),a.updateMaxLine&&Qr(l),a.mustUpdate=a.viewChanged||a.forceUpdate||a.scrollTop!=null||a.scrollToPos&&(a.scrollToPos.from.line<g.viewFrom||a.scrollToPos.to.line>=g.viewTo)||g.maxLineChanged&&l.options.lineWrapping,a.update=a.mustUpdate&&new Is(l,a.mustUpdate&&{top:a.scrollTop,ensure:a.scrollToPos},a.forceUpdate)}function Gu(a){a.updatedDisplay=a.mustUpdate&&Ro(a.cm,a.update)}function Ru(a){var l=a.cm,g=l.display;a.updatedDisplay&&Rs(l),a.barMeasure=Oi(l),g.maxLineChanged&&!l.options.lineWrapping&&(a.adjustWidthTo=ks(l,g.maxLine,g.maxLine.text.length).left+3,l.display.sizerWidth=a.adjustWidthTo,a.barMeasure.scrollWidth=Math.max(g.scroller.clientWidth,g.sizer.offsetLeft+a.adjustWidthTo+Zn(l)+l.display.barWidth),a.maxScrollLeft=Math.max(0,g.sizer.offsetLeft+a.adjustWidthTo-ur(l))),(a.updatedDisplay||a.selectionChanged)&&(a.preparedSelection=g.input.prepareSelection())}function Bu(a){var l=a.cm;a.adjustWidthTo!=null&&(l.display.sizer.style.minWidth=a.adjustWidthTo+"px",a.maxScrollLeft<l.doc.scrollLeft&&Ir(l,Math.min(l.display.scroller.scrollLeft,a.maxScrollLeft),!0),l.display.maxLineChanged=!1);var g=a.focus&&a.focus==me();a.preparedSelection&&l.display.input.showSelection(a.preparedSelection,g),(a.updatedDisplay||a.startHeight!=l.doc.height)&&li(l,a.barMeasure),a.updatedDisplay&&Io(l,a.barMeasure),a.selectionChanged&&ko(l),l.state.focused&&a.updateInput&&l.display.input.reset(a.typing),g&&pa(a.cm)}function $u(a){var l=a.cm,g=l.display,d=l.doc;if(a.updatedDisplay&&ya(l,a.update),g.wheelStartX!=null&&(a.scrollTop!=null||a.scrollLeft!=null||a.scrollToPos)&&(g.wheelStartX=g.wheelStartY=null),a.scrollTop!=null&&ha(l,a.scrollTop,a.forceScroll),a.scrollLeft!=null&&Ir(l,a.scrollLeft,!0,!0),a.scrollToPos){var A=Fu(l,Pt(d,a.scrollToPos.from),Pt(d,a.scrollToPos.to),a.scrollToPos.margin);Du(l,A)}var E=a.maybeHiddenMarkers,L=a.maybeUnhiddenMarkers;if(E)for(var O=0;O<E.length;++O)E[O].lines.length||Qe(E[O],"hide");if(L)for(var Z=0;Z<L.length;++Z)L[Z].lines.length&&Qe(L[Z],"unhide");g.wrapper.offsetHeight&&(d.scrollTop=l.display.scroller.scrollTop),a.changeObjs&&Qe(l,"changes",l,a.changeObjs),a.update&&a.update.finish()}function Ln(a,l){if(a.curOp)return l();Wr(a);try{return l()}finally{Xr(a)}}function fn(a,l){return function(){if(a.curOp)return l.apply(a,arguments);Wr(a);try{return l.apply(a,arguments)}finally{Xr(a)}}}function xn(a){return function(){if(this.curOp)return a.apply(this,arguments);Wr(this);try{return a.apply(this,arguments)}finally{Xr(this)}}}function dn(a){return function(){var l=this.cm;if(!l||l.curOp)return a.apply(this,arguments);Wr(l);try{return a.apply(this,arguments)}finally{Xr(l)}}}function Xi(a,l){a.doc.highlightFrontier<a.display.viewTo&&a.state.highlight.set(l,st(Iu,a))}function Iu(a){var l=a.doc;if(!(l.highlightFrontier>=a.display.viewTo)){var g=+new Date+a.options.workTime,d=Tr(a,l.highlightFrontier),A=[];l.iter(d.line,Math.min(l.first+l.size,a.display.viewTo+500),function(E){if(d.line>=a.display.viewFrom){var L=E.styles,O=E.text.length>a.options.maxHighlightLength?er(l.mode,d.state):null,Z=us(a,E,d,!0);O&&(d.state=O),E.styles=Z.styles;var j=E.styleClasses,ae=Z.classes;ae?E.styleClasses=ae:j&&(E.styleClasses=null);for(var fe=!L||L.length!=E.styles.length||j!=ae&&(!j||!ae||j.bgClass!=ae.bgClass||j.textClass!=ae.textClass),Me=0;!fe&&Me<L.length;++Me)fe=L[Me]!=E.styles[Me];fe&&A.push(d.line),E.stateAfter=d.save(),d.nextLine()}else E.text.length<=a.options.maxHighlightLength&&wi(a,E.text,d),E.stateAfter=d.line%5==0?d.save():null,d.nextLine();if(+new Date>g)return Xi(a,a.options.workDelay),!0}),l.highlightFrontier=d.line,l.modeFrontier=Math.max(l.modeFrontier,d.line),A.length&&Ln(a,function(){for(var E=0;E<A.length;E++)Mr(a,A[E],"text")})}}var Is=function(a,l,g){var d=a.display;this.viewport=l,this.visible=Bs(d,a.doc,l),this.editorIsHidden=!d.wrapper.offsetWidth,this.wrapperHeight=d.wrapper.clientHeight,this.wrapperWidth=d.wrapper.clientWidth,this.oldDisplayWidth=ur(a),this.force=g,this.dims=wo(a),this.events=[]};Is.prototype.signal=function(a,l){tt(a,l)&&this.events.push(arguments)},Is.prototype.finish=function(){for(var a=0;a<this.events.length;a++)Qe.apply(null,this.events[a])};function Ou(a){var l=a.display;!l.scrollbarsClipped&&l.scroller.offsetWidth&&(l.nativeBarWidth=l.scroller.offsetWidth-l.scroller.clientWidth,l.heightForcer.style.height=Zn(a)+"px",l.sizer.style.marginBottom=-l.nativeBarWidth+"px",l.sizer.style.borderRightWidth=Zn(a)+"px",l.scrollbarsClipped=!0)}function Wu(a){if(a.hasFocus())return null;var l=me();if(!l||!Ke(a.display.lineDiv,l))return null;var g={activeElt:l};if(window.getSelection){var d=window.getSelection();d.anchorNode&&d.extend&&Ke(a.display.lineDiv,d.anchorNode)&&(g.anchorNode=d.anchorNode,g.anchorOffset=d.anchorOffset,g.focusNode=d.focusNode,g.focusOffset=d.focusOffset)}return g}function Xu(a){if(!(!a||!a.activeElt||a.activeElt==me())&&(a.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(a.activeElt.nodeName)&&a.anchorNode&&Ke(document.body,a.anchorNode)&&Ke(document.body,a.focusNode))){var l=window.getSelection(),g=document.createRange();g.setEnd(a.anchorNode,a.anchorOffset),g.collapse(!1),l.removeAllRanges(),l.addRange(g),l.extend(a.focusNode,a.focusOffset)}}function Ro(a,l){var g=a.display,d=a.doc;if(l.editorIsHidden)return xr(a),!1;if(!l.force&&l.visible.from>=g.viewFrom&&l.visible.to<=g.viewTo&&(g.updateLineNumbers==null||g.updateLineNumbers>=g.viewTo)&&g.renderedView==g.view&&la(a)==0)return!1;ba(a)&&(xr(a),l.dims=wo(a));var A=d.first+d.size,E=Math.max(l.visible.from-a.options.viewportMargin,d.first),L=Math.min(A,l.visible.to+a.options.viewportMargin);g.viewFrom<E&&E-g.viewFrom<20&&(E=Math.max(d.first,g.viewFrom)),g.viewTo>L&&g.viewTo-L<20&&(L=Math.min(A,g.viewTo)),le&&(E=Ni(a.doc,E),L=ys(a.doc,L));var O=E!=g.viewFrom||L!=g.viewTo||g.lastWrapHeight!=l.wrapperHeight||g.lastWrapWidth!=l.wrapperWidth;Su(a,E,L),g.viewOffset=Mn(ot(a.doc,g.viewFrom)),a.display.mover.style.top=g.viewOffset+"px";var Z=la(a);if(!O&&Z==0&&!l.force&&g.renderedView==g.view&&(g.updateLineNumbers==null||g.updateLineNumbers>=g.viewTo))return!1;var j=Wu(a);return Z>4&&(g.lineDiv.style.display="none"),Vu(a,g.updateLineNumbers,l.dims),Z>4&&(g.lineDiv.style.display=""),g.renderedView=g.view,Xu(j),xe(g.cursorDiv),xe(g.selectionDiv),g.gutters.style.height=g.sizer.style.minHeight=0,O&&(g.lastWrapHeight=l.wrapperHeight,g.lastWrapWidth=l.wrapperWidth,Xi(a,400)),g.updateLineNumbers=null,!0}function ya(a,l){for(var g=l.viewport,d=!0;;d=!1){if(!d||!a.options.lineWrapping||l.oldDisplayWidth==ur(a)){if(g&&g.top!=null&&(g={top:Math.min(a.doc.height+Jn(a.display)-Ri(a),g.top)}),l.visible=Bs(a.display,a.doc,g),l.visible.from>=a.display.viewFrom&&l.visible.to<=a.display.viewTo)break}else d&&(l.visible=Bs(a.display,a.doc,g));if(!Ro(a,l))break;Rs(a);var A=Oi(a);Bi(a),li(a,A),Io(a,A),l.force=!1}l.signal(a,"update",a),(a.display.viewFrom!=a.display.reportedViewFrom||a.display.viewTo!=a.display.reportedViewTo)&&(l.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=a.display.viewFrom,a.display.reportedViewTo=a.display.viewTo)}function Bo(a,l){var g=new Is(a,l);if(Ro(a,g)){Rs(a),ya(a,g);var d=Oi(a);Bi(a),li(a,d),Io(a,d),g.finish()}}function Vu(a,l,g){var d=a.display,A=a.options.lineNumbers,E=d.lineDiv,L=E.firstChild;function O(Fe){var $e=Fe.nextSibling;return F&&ie&&a.display.currentWheelTarget==Fe?Fe.style.display="none":Fe.parentNode.removeChild(Fe),$e}for(var Z=d.view,j=d.viewFrom,ae=0;ae<Z.length;ae++){var fe=Z[ae];if(!fe.hidden)if(!fe.node||fe.node.parentNode!=E){var Me=vo(a,fe,j,g);E.insertBefore(Me,L)}else{for(;L!=fe.node;)L=O(L);var be=A&&l!=null&&l<=j&&fe.lineNumber;fe.changes&&(St(fe.changes,"gutter")>-1&&(be=!1),Li(a,fe,j,g)),be&&(xe(fe.lineNumber),fe.lineNumber.appendChild(document.createTextNode(xi(a.options,j)))),L=fe.node.nextSibling}j+=fe.size}for(;L;)L=O(L)}function $o(a){var l=a.gutters.offsetWidth;a.sizer.style.marginLeft=l+"px",un(a,"gutterChanged",a)}function Io(a,l){a.display.sizer.style.minHeight=l.docHeight+"px",a.display.heightForcer.style.top=l.docHeight+"px",a.display.gutters.style.height=l.docHeight+a.display.barHeight+Zn(a)+"px"}function va(a){var l=a.display,g=l.view;if(!(!l.alignWidgets&&(!l.gutters.firstChild||!a.options.fixedGutter))){for(var d=Do(l)-l.scroller.scrollLeft+a.doc.scrollLeft,A=l.gutters.offsetWidth,E=d+"px",L=0;L<g.length;L++)if(!g[L].hidden){a.options.fixedGutter&&(g[L].gutter&&(g[L].gutter.style.left=E),g[L].gutterBackground&&(g[L].gutterBackground.style.left=E));var O=g[L].alignable;if(O)for(var Z=0;Z<O.length;Z++)O[Z].style.left=E}a.options.fixedGutter&&(l.gutters.style.left=d+A+"px")}}function ba(a){if(!a.options.lineNumbers)return!1;var l=a.doc,g=xi(a.options,l.first+l.size-1),d=a.display;if(g.length!=d.lineNumChars){var A=d.measure.appendChild(Pe("div",[Pe("div",g)],"CodeMirror-linenumber CodeMirror-gutter-elt")),E=A.firstChild.offsetWidth,L=A.offsetWidth-E;return d.lineGutter.style.width="",d.lineNumInnerWidth=Math.max(E,d.lineGutter.offsetWidth-L)+1,d.lineNumWidth=d.lineNumInnerWidth+L,d.lineNumChars=d.lineNumInnerWidth?g.length:-1,d.lineGutter.style.width=d.lineNumWidth+"px",$o(a.display),!0}return!1}function Oo(a,l){for(var g=[],d=!1,A=0;A<a.length;A++){var E=a[A],L=null;if(typeof E!="string"&&(L=E.style,E=E.className),E=="CodeMirror-linenumbers")if(l)d=!0;else continue;g.push({className:E,style:L})}return l&&!d&&g.push({className:"CodeMirror-linenumbers",style:null}),g}function Aa(a){var l=a.gutters,g=a.gutterSpecs;xe(l),a.lineGutter=null;for(var d=0;d<g.length;++d){var A=g[d],E=A.className,L=A.style,O=l.appendChild(Pe("div",null,"CodeMirror-gutter "+E));L&&(O.style.cssText=L),E=="CodeMirror-linenumbers"&&(a.lineGutter=O,O.style.width=(a.lineNumWidth||1)+"px")}l.style.display=g.length?"":"none",$o(a)}function Vi(a){Aa(a.display),Dn(a),va(a)}function Zu(a,l,g,d){var A=this;this.input=g,A.scrollbarFiller=Pe("div",null,"CodeMirror-scrollbar-filler"),A.scrollbarFiller.setAttribute("cm-not-content","true"),A.gutterFiller=Pe("div",null,"CodeMirror-gutter-filler"),A.gutterFiller.setAttribute("cm-not-content","true"),A.lineDiv=Le("div",null,"CodeMirror-code"),A.selectionDiv=Pe("div",null,null,"position: relative; z-index: 1"),A.cursorDiv=Pe("div",null,"CodeMirror-cursors"),A.measure=Pe("div",null,"CodeMirror-measure"),A.lineMeasure=Pe("div",null,"CodeMirror-measure"),A.lineSpace=Le("div",[A.measure,A.lineMeasure,A.selectionDiv,A.cursorDiv,A.lineDiv],null,"position: relative; outline: none");var E=Le("div",[A.lineSpace],"CodeMirror-lines");A.mover=Pe("div",[E],null,"position: relative"),A.sizer=Pe("div",[A.mover],"CodeMirror-sizer"),A.sizerWidth=null,A.heightForcer=Pe("div",null,null,"position: absolute; height: "+pt+"px; width: 1px;"),A.gutters=Pe("div",null,"CodeMirror-gutters"),A.lineGutter=null,A.scroller=Pe("div",[A.sizer,A.heightForcer,A.gutters],"CodeMirror-scroll"),A.scroller.setAttribute("tabIndex","-1"),A.wrapper=Pe("div",[A.scrollbarFiller,A.gutterFiller,A.scroller],"CodeMirror"),A.wrapper.setAttribute("translate","no"),b&&M<8&&(A.gutters.style.zIndex=-1,A.scroller.style.paddingRight=0),!F&&!(o&&K)&&(A.scroller.draggable=!0),a&&(a.appendChild?a.appendChild(A.wrapper):a(A.wrapper)),A.viewFrom=A.viewTo=l.first,A.reportedViewFrom=A.reportedViewTo=l.first,A.view=[],A.renderedView=null,A.externalMeasured=null,A.viewOffset=0,A.lastWrapHeight=A.lastWrapWidth=0,A.updateLineNumbers=null,A.nativeBarWidth=A.barHeight=A.barWidth=0,A.scrollbarsClipped=!1,A.lineNumWidth=A.lineNumInnerWidth=A.lineNumChars=null,A.alignWidgets=!1,A.cachedCharWidth=A.cachedTextHeight=A.cachedPaddingH=null,A.maxLine=null,A.maxLineLength=0,A.maxLineChanged=!1,A.wheelDX=A.wheelDY=A.wheelStartX=A.wheelStartY=null,A.shift=!1,A.selForContextMenu=null,A.activeTouch=null,A.gutterSpecs=Oo(d.gutters,d.lineNumbers),Aa(A),g.init(A)}var Os=0,cr=null;b?cr=-.53:o?cr=15:k?cr=-.7:$&&(cr=-1/3);function Ca(a){var l=a.wheelDeltaX,g=a.wheelDeltaY;return l==null&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(l=a.detail),g==null&&a.detail&&a.axis==a.VERTICAL_AXIS?g=a.detail:g==null&&(g=a.wheelDelta),{x:l,y:g}}function zu(a){var l=Ca(a);return l.x*=cr,l.y*=cr,l}function Ma(a,l){var g=Ca(l),d=g.x,A=g.y,E=cr;l.deltaMode===0&&(d=l.deltaX,A=l.deltaY,E=1);var L=a.display,O=L.scroller,Z=O.scrollWidth>O.clientWidth,j=O.scrollHeight>O.clientHeight;if(d&&Z||A&&j){if(A&&ie&&F){e:for(var ae=l.target,fe=L.view;ae!=O;ae=ae.parentNode)for(var Me=0;Me<fe.length;Me++)if(fe[Me].node==ae){a.display.currentWheelTarget=ae;break e}}if(d&&!o&&!N&&E!=null){A&&j&&Ii(a,Math.max(0,O.scrollTop+A*E)),Ir(a,Math.max(0,O.scrollLeft+d*E)),(!A||A&&j)&&Mt(l),L.wheelStartX=null;return}if(A&&E!=null){var be=A*E,Fe=a.doc.scrollTop,$e=Fe+L.wrapper.clientHeight;be<0?Fe=Math.max(0,Fe+be-50):$e=Math.min(a.doc.height,$e+be+50),Bo(a,{top:Fe,bottom:$e})}Os<20&&l.deltaMode!==0&&(L.wheelStartX==null?(L.wheelStartX=O.scrollLeft,L.wheelStartY=O.scrollTop,L.wheelDX=d,L.wheelDY=A,setTimeout(function(){if(L.wheelStartX!=null){var Ze=O.scrollLeft-L.wheelStartX,je=O.scrollTop-L.wheelStartY,Je=je&&L.wheelDY&&je/L.wheelDY||Ze&&L.wheelDX&&Ze/L.wheelDX;L.wheelStartX=L.wheelStartY=null,Je&&(cr=(cr*Os+Je)/(Os+1),++Os)}},200)):(L.wheelDX+=d,L.wheelDY+=A))}}var In=function(a,l){this.ranges=a,this.primIndex=l};In.prototype.primary=function(){return this.ranges[this.primIndex]},In.prototype.equals=function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||a.ranges.length!=this.ranges.length)return!1;for(var l=0;l<this.ranges.length;l++){var g=this.ranges[l],d=a.ranges[l];if(!Pi(g.anchor,d.anchor)||!Pi(g.head,d.head))return!1}return!0},In.prototype.deepCopy=function(){for(var a=[],l=0;l<this.ranges.length;l++)a[l]=new Vt(Si(this.ranges[l].anchor),Si(this.ranges[l].head));return new In(a,this.primIndex)},In.prototype.somethingSelected=function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1},In.prototype.contains=function(a,l){l||(l=a);for(var g=0;g<this.ranges.length;g++){var d=this.ranges[g];if(xt(l,d.from())>=0&&xt(a,d.to())<=0)return g}return-1};var Vt=function(a,l){this.anchor=a,this.head=l};Vt.prototype.from=function(){return jr(this.anchor,this.head)},Vt.prototype.to=function(){return Ur(this.anchor,this.head)},Vt.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function jn(a,l,g){var d=a&&a.options.selectionsMayTouch,A=l[g];l.sort(function(Me,be){return xt(Me.from(),be.from())}),g=St(l,A);for(var E=1;E<l.length;E++){var L=l[E],O=l[E-1],Z=xt(O.to(),L.from());if(d&&!L.empty()?Z>0:Z>=0){var j=jr(O.from(),L.from()),ae=Ur(O.to(),L.to()),fe=O.empty()?L.from()==L.head:O.from()==O.head;E<=g&&--g,l.splice(--E,2,new Vt(fe?ae:j,fe?j:ae))}}return new In(l,g)}function Pr(a,l){return new In([new Vt(a,l||a)],0)}function Sr(a){return a.text?We(a.from.line+a.text.length-1,_t(a.text).length+(a.text.length==1?a.from.ch:0)):a.to}function xa(a,l){if(xt(a,l.from)<0)return a;if(xt(a,l.to)<=0)return Sr(l);var g=a.line+l.text.length-(l.to.line-l.from.line)-1,d=a.ch;return a.line==l.to.line&&(d+=Sr(l).ch-l.to.ch),We(g,d)}function Wo(a,l){for(var g=[],d=0;d<a.sel.ranges.length;d++){var A=a.sel.ranges[d];g.push(new Vt(xa(A.anchor,l),xa(A.head,l)))}return jn(a.cm,g,a.sel.primIndex)}function Pa(a,l,g){return a.line==l.line?We(g.line,a.ch-l.ch+g.ch):We(g.line+(a.line-l.line),a.ch)}function Hu(a,l,g){for(var d=[],A=We(a.first,0),E=A,L=0;L<l.length;L++){var O=l[L],Z=Pa(O.from,A,E),j=Pa(Sr(O),A,E);if(A=O.to,E=j,g=="around"){var ae=a.sel.ranges[L],fe=xt(ae.head,ae.anchor)<0;d[L]=new Vt(fe?j:Z,fe?Z:j)}else d[L]=new Vt(Z,Z)}return new In(d,a.sel.primIndex)}function Xo(a){a.doc.mode=Ai(a.options,a.doc.modeOption),Zi(a)}function Zi(a){a.doc.iter(function(l){l.stateAfter&&(l.stateAfter=null),l.styles&&(l.styles=null)}),a.doc.modeFrontier=a.doc.highlightFrontier=a.doc.first,Xi(a,100),a.state.modeGen++,a.curOp&&Dn(a)}function Sa(a,l){return l.from.ch==0&&l.to.ch==0&&_t(l.text)==""&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}function Vo(a,l,g,d){function A(Je){return g?g[Je]:null}function E(Je,Ye,et){ei(Je,Ye,et,d),un(Je,"change",Je,l)}function L(Je,Ye){for(var et=[],ht=Je;ht<Ye;++ht)et.push(new $n(j[ht],A(ht),d));return et}var O=l.from,Z=l.to,j=l.text,ae=ot(a,O.line),fe=ot(a,Z.line),Me=_t(j),be=A(j.length-1),Fe=Z.line-O.line;if(l.full)a.insert(0,L(0,j.length)),a.remove(j.length,a.size-j.length);else if(Sa(a,l)){var $e=L(0,j.length-1);E(fe,fe.text,be),Fe&&a.remove(O.line,Fe),$e.length&&a.insert(O.line,$e)}else if(ae==fe)if(j.length==1)E(ae,ae.text.slice(0,O.ch)+Me+ae.text.slice(Z.ch),be);else{var Ze=L(1,j.length-1);Ze.push(new $n(Me+ae.text.slice(Z.ch),be,d)),E(ae,ae.text.slice(0,O.ch)+j[0],A(0)),a.insert(O.line+1,Ze)}else if(j.length==1)E(ae,ae.text.slice(0,O.ch)+j[0]+fe.text.slice(Z.ch),A(0)),a.remove(O.line+1,Fe);else{E(ae,ae.text.slice(0,O.ch)+j[0],A(0)),E(fe,Me+fe.text.slice(Z.ch),be);var je=L(1,j.length-1);Fe>1&&a.remove(O.line+1,Fe-1),a.insert(O.line+1,je)}un(a,"change",a,l)}function wr(a,l,g){function d(A,E,L){if(A.linked)for(var O=0;O<A.linked.length;++O){var Z=A.linked[O];if(Z.doc!=E){var j=L&&Z.sharedHist;g&&!j||(l(Z.doc,j),d(Z.doc,A,j))}}}d(a,null,!0)}function wa(a,l){if(l.cm)throw new Error("This document is already in use.");a.doc=l,l.cm=a,Fo(a),Xo(a),Da(a),a.options.direction=l.direction,a.options.lineWrapping||Qr(a),a.options.mode=l.modeOption,Dn(a)}function Da(a){(a.doc.direction=="rtl"?ye:we)(a.display.lineDiv,"CodeMirror-rtl")}function Uu(a){Ln(a,function(){Da(a),Dn(a)})}function Ws(a){this.done=[],this.undone=[],this.undoDepth=a?a.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=a?a.maxGeneration:1}function Zo(a,l){var g={from:Si(l.from),to:Sr(l),text:nr(a,l.from,l.to)};return ka(a,g,l.from.line,l.to.line+1),wr(a,function(d){return ka(d,g,l.from.line,l.to.line+1)},!0),g}function Fa(a){for(;a.length;){var l=_t(a);if(l.ranges)a.pop();else break}}function ju(a,l){if(l)return Fa(a.done),_t(a.done);if(a.done.length&&!_t(a.done).ranges)return _t(a.done);if(a.done.length>1&&!a.done[a.done.length-2].ranges)return a.done.pop(),_t(a.done)}function Ea(a,l,g,d){var A=a.history;A.undone.length=0;var E=+new Date,L,O;if((A.lastOp==d||A.lastOrigin==l.origin&&l.origin&&(l.origin.charAt(0)=="+"&&A.lastModTime>E-(a.cm?a.cm.options.historyEventDelay:500)||l.origin.charAt(0)=="*"))&&(L=ju(A,A.lastOp==d)))O=_t(L.changes),xt(l.from,l.to)==0&&xt(l.from,O.to)==0?O.to=Sr(l):L.changes.push(Zo(a,l));else{var Z=_t(A.done);for((!Z||!Z.ranges)&&Xs(a.sel,A.done),L={changes:[Zo(a,l)],generation:A.generation},A.done.push(L);A.done.length>A.undoDepth;)A.done.shift(),A.done[0].ranges||A.done.shift()}A.done.push(g),A.generation=++A.maxGeneration,A.lastModTime=A.lastSelTime=E,A.lastOp=A.lastSelOp=d,A.lastOrigin=A.lastSelOrigin=l.origin,O||Qe(a,"historyAdded")}function Yu(a,l,g,d){var A=l.charAt(0);return A=="*"||A=="+"&&g.ranges.length==d.ranges.length&&g.somethingSelected()==d.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}function Ku(a,l,g,d){var A=a.history,E=d&&d.origin;g==A.lastSelOp||E&&A.lastSelOrigin==E&&(A.lastModTime==A.lastSelTime&&A.lastOrigin==E||Yu(a,E,_t(A.done),l))?A.done[A.done.length-1]=l:Xs(l,A.done),A.lastSelTime=+new Date,A.lastSelOrigin=E,A.lastSelOp=g,d&&d.clearRedo!==!1&&Fa(A.undone)}function Xs(a,l){var g=_t(l);g&&g.ranges&&g.equals(a)||l.push(a)}function ka(a,l,g,d){var A=l["spans_"+a.id],E=0;a.iter(Math.max(a.first,g),Math.min(a.first+a.size,d),function(L){L.markedSpans&&((A||(A=l["spans_"+a.id]={}))[E]=L.markedSpans),++E})}function qu(a){if(!a)return null;for(var l,g=0;g<a.length;++g)a[g].marker.explicitlyCleared?l||(l=a.slice(0,g)):l&&l.push(a[g]);return l?l.length?l:null:a}function Ju(a,l){var g=l["spans_"+a.id];if(!g)return null;for(var d=[],A=0;A<l.text.length;++A)d.push(qu(g[A]));return d}function Ta(a,l){var g=Ju(a,l),d=Rt(a,l);if(!g)return d;if(!d)return g;for(var A=0;A<g.length;++A){var E=g[A],L=d[A];if(E&&L)e:for(var O=0;O<L.length;++O){for(var Z=L[O],j=0;j<E.length;++j)if(E[j].marker==Z.marker)continue e;E.push(Z)}else L&&(g[A]=L)}return g}function ci(a,l,g){for(var d=[],A=0;A<a.length;++A){var E=a[A];if(E.ranges){d.push(g?In.prototype.deepCopy.call(E):E);continue}var L=E.changes,O=[];d.push({changes:O});for(var Z=0;Z<L.length;++Z){var j=L[Z],ae=void 0;if(O.push({from:j.from,to:j.to,text:j.text}),l)for(var fe in j)(ae=fe.match(/^spans_(\d+)$/))&&St(l,Number(ae[1]))>-1&&(_t(O)[fe]=j[fe],delete j[fe])}}return d}function zo(a,l,g,d){if(d){var A=a.anchor;if(g){var E=xt(l,A)<0;E!=xt(g,A)<0?(A=l,l=g):E!=xt(l,g)<0&&(l=g)}return new Vt(A,l)}else return new Vt(g||l,l)}function Vs(a,l,g,d,A){A==null&&(A=a.cm&&(a.cm.display.shift||a.extend)),vn(a,new In([zo(a.sel.primary(),l,g,A)],0),d)}function Na(a,l,g){for(var d=[],A=a.cm&&(a.cm.display.shift||a.extend),E=0;E<a.sel.ranges.length;E++)d[E]=zo(a.sel.ranges[E],l[E],null,A);var L=jn(a.cm,d,a.sel.primIndex);vn(a,L,g)}function Ho(a,l,g,d){var A=a.sel.ranges.slice(0);A[l]=g,vn(a,jn(a.cm,A,a.sel.primIndex),d)}function La(a,l,g,d){vn(a,Pr(l,g),d)}function Qu(a,l,g){var d={ranges:l.ranges,update:function(A){this.ranges=[];for(var E=0;E<A.length;E++)this.ranges[E]=new Vt(Pt(a,A[E].anchor),Pt(a,A[E].head))},origin:g&&g.origin};return Qe(a,"beforeSelectionChange",a,d),a.cm&&Qe(a.cm,"beforeSelectionChange",a.cm,d),d.ranges!=l.ranges?jn(a.cm,d.ranges,d.ranges.length-1):l}function Ga(a,l,g){var d=a.history.done,A=_t(d);A&&A.ranges?(d[d.length-1]=l,Zs(a,l,g)):vn(a,l,g)}function vn(a,l,g){Zs(a,l,g),Ku(a,a.sel,a.cm?a.cm.curOp.id:NaN,g)}function Zs(a,l,g){(tt(a,"beforeSelectionChange")||a.cm&&tt(a.cm,"beforeSelectionChange"))&&(l=Qu(a,l,g));var d=g&&g.bias||(xt(l.primary().head,a.sel.primary().head)<0?-1:1);Ra(a,$a(a,l,d,!0)),!(g&&g.scroll===!1)&&a.cm&&a.cm.getOption("readOnly")!="nocursor"&&ui(a.cm)}function Ra(a,l){l.equals(a.sel)||(a.sel=l,a.cm&&(a.cm.curOp.updateInput=1,a.cm.curOp.selectionChanged=!0,on(a.cm)),un(a,"cursorActivity",a))}function Ba(a){Ra(a,$a(a,a.sel,null,!1))}function $a(a,l,g,d){for(var A,E=0;E<l.ranges.length;E++){var L=l.ranges[E],O=l.ranges.length==a.sel.ranges.length&&a.sel.ranges[E],Z=zs(a,L.anchor,O&&O.anchor,g,d),j=zs(a,L.head,O&&O.head,g,d);(A||Z!=L.anchor||j!=L.head)&&(A||(A=l.ranges.slice(0,E)),A[E]=new Vt(Z,j))}return A?jn(a.cm,A,l.primIndex):l}function pi(a,l,g,d,A){var E=ot(a,l.line);if(E.markedSpans)for(var L=0;L<E.markedSpans.length;++L){var O=E.markedSpans[L],Z=O.marker,j="selectLeft"in Z?!Z.selectLeft:Z.inclusiveLeft,ae="selectRight"in Z?!Z.selectRight:Z.inclusiveRight;if((O.from==null||(j?O.from<=l.ch:O.from<l.ch))&&(O.to==null||(ae?O.to>=l.ch:O.to>l.ch))){if(A&&(Qe(Z,"beforeCursorEnter"),Z.explicitlyCleared))if(E.markedSpans){--L;continue}else break;if(!Z.atomic)continue;if(g){var fe=Z.find(d<0?1:-1),Me=void 0;if((d<0?ae:j)&&(fe=Ia(a,fe,-d,fe&&fe.line==l.line?E:null)),fe&&fe.line==l.line&&(Me=xt(fe,g))&&(d<0?Me<0:Me>0))return pi(a,fe,l,d,A)}var be=Z.find(d<0?-1:1);return(d<0?j:ae)&&(be=Ia(a,be,d,be.line==l.line?E:null)),be?pi(a,be,l,d,A):null}}return l}function zs(a,l,g,d,A){var E=d||1,L=pi(a,l,g,E,A)||!A&&pi(a,l,g,E,!0)||pi(a,l,g,-E,A)||!A&&pi(a,l,g,-E,!0);return L||(a.cantEdit=!0,We(a.first,0))}function Ia(a,l,g,d){return g<0&&l.ch==0?l.line>a.first?Pt(a,We(l.line-1)):null:g>0&&l.ch==(d||ot(a,l.line)).text.length?l.line<a.first+a.size-1?We(l.line+1,0):null:new We(l.line,l.ch+g)}function Oa(a){a.setSelection(We(a.firstLine(),0),We(a.lastLine()),yt)}function Wa(a,l,g){var d={canceled:!1,from:l.from,to:l.to,text:l.text,origin:l.origin,cancel:function(){return d.canceled=!0}};return g&&(d.update=function(A,E,L,O){A&&(d.from=Pt(a,A)),E&&(d.to=Pt(a,E)),L&&(d.text=L),O!==void 0&&(d.origin=O)}),Qe(a,"beforeChange",a,d),a.cm&&Qe(a.cm,"beforeChange",a.cm,d),d.canceled?(a.cm&&(a.cm.curOp.updateInput=2),null):{from:d.from,to:d.to,text:d.text,origin:d.origin}}function fi(a,l,g){if(a.cm){if(!a.cm.curOp)return fn(a.cm,fi)(a,l,g);if(a.cm.state.suppressEdits)return}if(!((tt(a,"beforeChange")||a.cm&&tt(a.cm,"beforeChange"))&&(l=Wa(a,l,!0),!l))){var d=ms&&!g&&so(a,l.from,l.to);if(d)for(var A=d.length-1;A>=0;--A)Xa(a,{from:d[A].from,to:d[A].to,text:A?[""]:l.text,origin:l.origin});else Xa(a,l)}}function Xa(a,l){if(!(l.text.length==1&&l.text[0]==""&&xt(l.from,l.to)==0)){var g=Wo(a,l);Ea(a,l,g,a.cm?a.cm.curOp.id:NaN),zi(a,l,g,Rt(a,l));var d=[];wr(a,function(A,E){!E&&St(d,A.history)==-1&&(Ha(A.history,l),d.push(A.history)),zi(A,l,null,Rt(A,l))})}}function Hs(a,l,g){var d=a.cm&&a.cm.state.suppressEdits;if(!(d&&!g)){for(var A=a.history,E,L=a.sel,O=l=="undo"?A.done:A.undone,Z=l=="undo"?A.undone:A.done,j=0;j<O.length&&(E=O[j],!(g?E.ranges&&!E.equals(a.sel):!E.ranges));j++);if(j!=O.length){for(A.lastOrigin=A.lastSelOrigin=null;;)if(E=O.pop(),E.ranges){if(Xs(E,Z),g&&!E.equals(a.sel)){vn(a,E,{clearRedo:!1});return}L=E}else if(d){O.push(E);return}else break;var ae=[];Xs(L,Z),Z.push({changes:ae,generation:A.generation}),A.generation=E.generation||++A.maxGeneration;for(var fe=tt(a,"beforeChange")||a.cm&&tt(a.cm,"beforeChange"),Me=function($e){var Ze=E.changes[$e];if(Ze.origin=l,fe&&!Wa(a,Ze,!1))return O.length=0,{};ae.push(Zo(a,Ze));var je=$e?Wo(a,Ze):_t(O);zi(a,Ze,je,Ta(a,Ze)),!$e&&a.cm&&a.cm.scrollIntoView({from:Ze.from,to:Sr(Ze)});var Je=[];wr(a,function(Ye,et){!et&&St(Je,Ye.history)==-1&&(Ha(Ye.history,Ze),Je.push(Ye.history)),zi(Ye,Ze,null,Ta(Ye,Ze))})},be=E.changes.length-1;be>=0;--be){var Fe=Me(be);if(Fe)return Fe.v}}}}function Va(a,l){if(l!=0&&(a.first+=l,a.sel=new In($t(a.sel.ranges,function(A){return new Vt(We(A.anchor.line+l,A.anchor.ch),We(A.head.line+l,A.head.ch))}),a.sel.primIndex),a.cm)){Dn(a.cm,a.first,a.first-l,l);for(var g=a.cm.display,d=g.viewFrom;d<g.viewTo;d++)Mr(a.cm,d,"gutter")}}function zi(a,l,g,d){if(a.cm&&!a.cm.curOp)return fn(a.cm,zi)(a,l,g,d);if(l.to.line<a.first){Va(a,l.text.length-1-(l.to.line-l.from.line));return}if(!(l.from.line>a.lastLine())){if(l.from.line<a.first){var A=l.text.length-1-(a.first-l.from.line);Va(a,A),l={from:We(a.first,0),to:We(l.to.line+A,l.to.ch),text:[_t(l.text)],origin:l.origin}}var E=a.lastLine();l.to.line>E&&(l={from:l.from,to:We(E,ot(a,E).text.length),text:[l.text[0]],origin:l.origin}),l.removed=nr(a,l.from,l.to),g||(g=Wo(a,l)),a.cm?el(a.cm,l,d):Vo(a,l,d),Zs(a,g,yt),a.cantEdit&&zs(a,We(a.firstLine(),0))&&(a.cantEdit=!1)}}function el(a,l,g){var d=a.doc,A=a.display,E=l.from,L=l.to,O=!1,Z=E.line;a.options.lineWrapping||(Z=Xt(Bn(ot(d,E.line))),d.iter(Z,L.line+1,function(be){if(be==A.maxLine)return O=!0,!0})),d.sel.contains(l.from,l.to)>-1&&on(a),Vo(d,l,g,ua(a)),a.options.lineWrapping||(d.iter(Z,E.line+l.text.length,function(be){var Fe=Lr(be);Fe>A.maxLineLength&&(A.maxLine=be,A.maxLineLength=Fe,A.maxLineChanged=!0,O=!1)}),O&&(a.curOp.updateMaxLine=!0)),ro(d,E.line),Xi(a,400);var j=l.text.length-(L.line-E.line)-1;l.full?Dn(a):E.line==L.line&&l.text.length==1&&!Sa(a.doc,l)?Mr(a,E.line,"text"):Dn(a,E.line,L.line+1,j);var ae=tt(a,"changes"),fe=tt(a,"change");if(fe||ae){var Me={from:E,to:L,text:l.text,removed:l.removed,origin:l.origin};fe&&un(a,"change",a,Me),ae&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(Me)}a.display.selForContextMenu=null}function di(a,l,g,d,A){var E;d||(d=g),xt(d,g)<0&&(E=[d,g],g=E[0],d=E[1]),typeof l=="string"&&(l=a.splitLines(l)),fi(a,{from:g,to:d,text:l,origin:A})}function Za(a,l,g,d){g<a.line?a.line+=d:l<a.line&&(a.line=l,a.ch=0)}function za(a,l,g,d){for(var A=0;A<a.length;++A){var E=a[A],L=!0;if(E.ranges){E.copied||(E=a[A]=E.deepCopy(),E.copied=!0);for(var O=0;O<E.ranges.length;O++)Za(E.ranges[O].anchor,l,g,d),Za(E.ranges[O].head,l,g,d);continue}for(var Z=0;Z<E.changes.length;++Z){var j=E.changes[Z];if(g<j.from.line)j.from=We(j.from.line+d,j.from.ch),j.to=We(j.to.line+d,j.to.ch);else if(l<=j.to.line){L=!1;break}}L||(a.splice(0,A+1),A=0)}}function Ha(a,l){var g=l.from.line,d=l.to.line,A=l.text.length-(d-g)-1;za(a.done,g,d,A),za(a.undone,g,d,A)}function Hi(a,l,g,d){var A=l,E=l;return typeof l=="number"?E=ot(a,ss(a,l)):A=Xt(l),A==null?null:(d(E,A)&&a.cm&&Mr(a.cm,A,g),E)}function Ui(a){this.lines=a,this.parent=null;for(var l=0,g=0;g<a.length;++g)a[g].parent=this,l+=a[g].height;this.height=l}Ui.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,l){for(var g=a,d=a+l;g<d;++g){var A=this.lines[g];this.height-=A.height,vs(A),un(A,"delete")}this.lines.splice(a,l)},collapse:function(a){a.push.apply(a,this.lines)},insertInner:function(a,l,g){this.height+=g,this.lines=this.lines.slice(0,a).concat(l).concat(this.lines.slice(a));for(var d=0;d<l.length;++d)l[d].parent=this},iterN:function(a,l,g){for(var d=a+l;a<d;++a)if(g(this.lines[a]))return!0}};function ji(a){this.children=a;for(var l=0,g=0,d=0;d<a.length;++d){var A=a[d];l+=A.chunkSize(),g+=A.height,A.parent=this}this.size=l,this.height=g,this.parent=null}ji.prototype={chunkSize:function(){return this.size},removeInner:function(a,l){this.size-=l;for(var g=0;g<this.children.length;++g){var d=this.children[g],A=d.chunkSize();if(a<A){var E=Math.min(l,A-a),L=d.height;if(d.removeInner(a,E),this.height-=L-d.height,A==E&&(this.children.splice(g--,1),d.parent=null),(l-=E)==0)break;a=0}else a-=A}if(this.size-l<25&&(this.children.length>1||!(this.children[0]instanceof Ui))){var O=[];this.collapse(O),this.children=[new Ui(O)],this.children[0].parent=this}},collapse:function(a){for(var l=0;l<this.children.length;++l)this.children[l].collapse(a)},insertInner:function(a,l,g){this.size+=l.length,this.height+=g;for(var d=0;d<this.children.length;++d){var A=this.children[d],E=A.chunkSize();if(a<=E){if(A.insertInner(a,l,g),A.lines&&A.lines.length>50){for(var L=A.lines.length%25+25,O=L;O<A.lines.length;){var Z=new Ui(A.lines.slice(O,O+=25));A.height-=Z.height,this.children.splice(++d,0,Z),Z.parent=this}A.lines=A.lines.slice(0,L),this.maybeSpill()}break}a-=E}},maybeSpill:function(){if(!(this.children.length<=10)){var a=this;do{var l=a.children.splice(a.children.length-5,5),g=new ji(l);if(a.parent){a.size-=g.size,a.height-=g.height;var A=St(a.parent.children,a);a.parent.children.splice(A+1,0,g)}else{var d=new ji(a.children);d.parent=a,a.children=[d,g],a=d}g.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()}},iterN:function(a,l,g){for(var d=0;d<this.children.length;++d){var A=this.children[d],E=A.chunkSize();if(a<E){var L=Math.min(l,E-a);if(A.iterN(a,L,g))return!0;if((l-=L)==0)break;a=0}else a-=E}}};var Yi=function(a,l,g){if(g)for(var d in g)g.hasOwnProperty(d)&&(this[d]=g[d]);this.doc=a,this.node=l};Yi.prototype.clear=function(){var a=this.doc.cm,l=this.line.widgets,g=this.line,d=Xt(g);if(!(d==null||!l)){for(var A=0;A<l.length;++A)l[A]==this&&l.splice(A--,1);l.length||(g.widgets=null);var E=sr(this);On(g,Math.max(0,g.height-E)),a&&(Ln(a,function(){Ua(a,g,-E),Mr(a,d,"widget")}),un(a,"lineWidgetCleared",a,this,d))}},Yi.prototype.changed=function(){var a=this,l=this.height,g=this.doc.cm,d=this.line;this.height=null;var A=sr(this)-l;A&&(wn(this.doc,d)||On(d,d.height+A),g&&Ln(g,function(){g.curOp.forceUpdate=!0,Ua(g,d,A),un(g,"lineWidgetChanged",g,a,Xt(d))}))},Ct(Yi);function Ua(a,l,g){Mn(l)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&Go(a,g)}function tl(a,l,g,d){var A=new Yi(a,g,d),E=a.cm;return E&&A.noHScroll&&(E.display.alignWidgets=!0),Hi(a,l,"widget",function(L){var O=L.widgets||(L.widgets=[]);if(A.insertAt==null?O.push(A):O.splice(Math.min(O.length,Math.max(0,A.insertAt)),0,A),A.line=L,E&&!wn(a,L)){var Z=Mn(L)<a.scrollTop;On(L,L.height+sr(A)),Z&&Go(E,A.height),E.curOp.forceUpdate=!0}return!0}),E&&un(E,"lineWidgetAdded",E,A,typeof l=="number"?l:Xt(l)),A}var ja=0,Dr=function(a,l){this.lines=[],this.type=l,this.doc=a,this.id=++ja};Dr.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,l=a&&!a.curOp;if(l&&Wr(a),tt(this,"clear")){var g=this.find();g&&un(this,"clear",g.from,g.to)}for(var d=null,A=null,E=0;E<this.lines.length;++E){var L=this.lines[E],O=Kn(L.markedSpans,this);a&&!this.collapsed?Mr(a,Xt(L),"text"):a&&(O.to!=null&&(A=Xt(L)),O.from!=null&&(d=Xt(L))),L.markedSpans=at(L.markedSpans,O),O.from==null&&this.collapsed&&!wn(this.doc,L)&&a&&On(L,si(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(var Z=0;Z<this.lines.length;++Z){var j=Bn(this.lines[Z]),ae=Lr(j);ae>a.display.maxLineLength&&(a.display.maxLine=j,a.display.maxLineLength=ae,a.display.maxLineChanged=!0)}d!=null&&a&&this.collapsed&&Dn(a,d,A+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Ba(a.doc)),a&&un(a,"markerCleared",a,this,d,A),l&&Xr(a),this.parent&&this.parent.clear()}},Dr.prototype.find=function(a,l){a==null&&this.type=="bookmark"&&(a=1);for(var g,d,A=0;A<this.lines.length;++A){var E=this.lines[A],L=Kn(E.markedSpans,this);if(L.from!=null&&(g=We(l?E:Xt(E),L.from),a==-1))return g;if(L.to!=null&&(d=We(l?E:Xt(E),L.to),a==1))return d}return g&&{from:g,to:d}},Dr.prototype.changed=function(){var a=this,l=this.find(-1,!0),g=this,d=this.doc.cm;!l||!d||Ln(d,function(){var A=l.line,E=Xt(l.line),L=Ar(d,E);if(L&&(Re(L),d.curOp.selectionChanged=d.curOp.forceUpdate=!0),d.curOp.updateMaxLine=!0,!wn(g.doc,A)&&g.height!=null){var O=g.height;g.height=null;var Z=sr(g)-O;Z&&On(A,A.height+Z)}un(d,"markerChanged",d,a)})},Dr.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(!l.maybeHiddenMarkers||St(l.maybeHiddenMarkers,this)==-1)&&(l.maybeUnhiddenMarkers||(l.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)},Dr.prototype.detachLine=function(a){if(this.lines.splice(St(this.lines,a),1),!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(l.maybeHiddenMarkers||(l.maybeHiddenMarkers=[])).push(this)}},Ct(Dr);function hi(a,l,g,d,A){if(d&&d.shared)return nl(a,l,g,d,A);if(a.cm&&!a.cm.curOp)return fn(a.cm,hi)(a,l,g,d,A);var E=new Dr(a,A),L=xt(l,g);if(d&&mt(d,E,!1),L>0||L==0&&E.clearWhenEmpty!==!1)return E;if(E.replacedWith&&(E.collapsed=!0,E.widgetNode=Le("span",[E.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||E.widgetNode.setAttribute("cm-ignore-events","true"),d.insertLeft&&(E.widgetNode.insertLeft=!0)),E.collapsed){if(_s(a,l.line,l,g,E)||l.line!=g.line&&_s(a,g.line,l,g,E))throw new Error("Inserting collapsed marker partially overlapping an existing one");mr()}E.addToHistory&&Ea(a,{from:l,to:g,origin:"markText"},a.sel,NaN);var O=l.line,Z=a.cm,j;if(a.iter(O,g.line+1,function(fe){Z&&E.collapsed&&!Z.options.lineWrapping&&Bn(fe)==Z.display.maxLine&&(j=!0),E.collapsed&&O!=l.line&&On(fe,0),Nr(fe,new Cn(E,O==l.line?l.ch:null,O==g.line?g.ch:null),a.cm&&a.cm.curOp),++O}),E.collapsed&&a.iter(l.line,g.line+1,function(fe){wn(a,fe)&&On(fe,0)}),E.clearOnEnter&&Ue(E,"beforeCursorEnter",function(){return E.clear()}),E.readOnly&&(Ft(),(a.history.done.length||a.history.undone.length)&&a.clearHistory()),E.collapsed&&(E.id=++ja,E.atomic=!0),Z){if(j&&(Z.curOp.updateMaxLine=!0),E.collapsed)Dn(Z,l.line,g.line+1);else if(E.className||E.startStyle||E.endStyle||E.css||E.attributes||E.title)for(var ae=l.line;ae<=g.line;ae++)Mr(Z,ae,"text");E.atomic&&Ba(Z.doc),un(Z,"markerAdded",Z,E)}return E}var Ki=function(a,l){this.markers=a,this.primary=l;for(var g=0;g<a.length;++g)a[g].parent=this};Ki.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();un(this,"clear")}},Ki.prototype.find=function(a,l){return this.primary.find(a,l)},Ct(Ki);function nl(a,l,g,d,A){d=mt(d),d.shared=!1;var E=[hi(a,l,g,d,A)],L=E[0],O=d.widgetNode;return wr(a,function(Z){O&&(d.widgetNode=O.cloneNode(!0)),E.push(hi(Z,Pt(Z,l),Pt(Z,g),d,A));for(var j=0;j<Z.linked.length;++j)if(Z.linked[j].isParent)return;L=_t(E)}),new Ki(E,L)}function Ya(a){return a.findMarks(We(a.first,0),a.clipPos(We(a.lastLine())),function(l){return l.parent})}function rl(a,l){for(var g=0;g<l.length;g++){var d=l[g],A=d.find(),E=a.clipPos(A.from),L=a.clipPos(A.to);if(xt(E,L)){var O=hi(a,E,L,d.primary,d.primary.type);d.markers.push(O),O.parent=d}}}function il(a){for(var l=function(d){var A=a[d],E=[A.primary.doc];wr(A.primary.doc,function(Z){return E.push(Z)});for(var L=0;L<A.markers.length;L++){var O=A.markers[L];St(E,O.doc)==-1&&(O.parent=null,A.markers.splice(L--,1))}},g=0;g<a.length;g++)l(g)}var sl=0,Fn=function(a,l,g,d,A){if(!(this instanceof Fn))return new Fn(a,l,g,d,A);g==null&&(g=0),ji.call(this,[new Ui([new $n("",null)])]),this.first=g,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=g;var E=We(g,0);this.sel=Pr(E),this.history=new Ws(null),this.id=++sl,this.modeOption=l,this.lineSep=d,this.direction=A=="rtl"?"rtl":"ltr",this.extend=!1,typeof a=="string"&&(a=this.splitLines(a)),Vo(this,{from:E,to:E,text:a}),vn(this,Pr(E),yt)};Fn.prototype=Ot(ji.prototype,{constructor:Fn,iter:function(a,l,g){g?this.iterN(a-this.first,l-a,g):this.iterN(this.first,this.first+this.size,a)},insert:function(a,l){for(var g=0,d=0;d<l.length;++d)g+=l[d].height;this.insertInner(a-this.first,l,g)},remove:function(a,l){this.removeInner(a-this.first,l)},getValue:function(a){var l=Mi(this,this.first,this.first+this.size);return a===!1?l:l.join(a||this.lineSeparator())},setValue:dn(function(a){var l=We(this.first,0),g=this.first+this.size-1;fi(this,{from:l,to:We(g,ot(this,g).text.length),text:this.splitLines(a),origin:"setValue",full:!0},!0),this.cm&&$i(this.cm,0,0),vn(this,Pr(l),yt)}),replaceRange:function(a,l,g,d){l=Pt(this,l),g=g?Pt(this,g):l,di(this,a,l,g,d)},getRange:function(a,l,g){var d=nr(this,Pt(this,a),Pt(this,l));return g===!1?d:g===""?d.join(""):d.join(g||this.lineSeparator())},getLine:function(a){var l=this.getLineHandle(a);return l&&l.text},getLineHandle:function(a){if(kr(this,a))return ot(this,a)},getLineNumber:function(a){return Xt(a)},getLineHandleVisualStart:function(a){return typeof a=="number"&&(a=ot(this,a)),Bn(a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return Pt(this,a)},getCursor:function(a){var l=this.sel.primary(),g;return a==null||a=="head"?g=l.head:a=="anchor"?g=l.anchor:a=="end"||a=="to"||a===!1?g=l.to():g=l.from(),g},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:dn(function(a,l,g){La(this,Pt(this,typeof a=="number"?We(a,l||0):a),null,g)}),setSelection:dn(function(a,l,g){La(this,Pt(this,a),Pt(this,l||a),g)}),extendSelection:dn(function(a,l,g){Vs(this,Pt(this,a),l&&Pt(this,l),g)}),extendSelections:dn(function(a,l){Na(this,os(this,a),l)}),extendSelectionsBy:dn(function(a,l){var g=$t(this.sel.ranges,a);Na(this,os(this,g),l)}),setSelections:dn(function(a,l,g){if(a.length){for(var d=[],A=0;A<a.length;A++)d[A]=new Vt(Pt(this,a[A].anchor),Pt(this,a[A].head||a[A].anchor));l==null&&(l=Math.min(a.length-1,this.sel.primIndex)),vn(this,jn(this.cm,d,l),g)}}),addSelection:dn(function(a,l,g){var d=this.sel.ranges.slice(0);d.push(new Vt(Pt(this,a),Pt(this,l||a))),vn(this,jn(this.cm,d,d.length-1),g)}),getSelection:function(a){for(var l=this.sel.ranges,g,d=0;d<l.length;d++){var A=nr(this,l[d].from(),l[d].to());g=g?g.concat(A):A}return a===!1?g:g.join(a||this.lineSeparator())},getSelections:function(a){for(var l=[],g=this.sel.ranges,d=0;d<g.length;d++){var A=nr(this,g[d].from(),g[d].to());a!==!1&&(A=A.join(a||this.lineSeparator())),l[d]=A}return l},replaceSelection:function(a,l,g){for(var d=[],A=0;A<this.sel.ranges.length;A++)d[A]=a;this.replaceSelections(d,l,g||"+input")},replaceSelections:dn(function(a,l,g){for(var d=[],A=this.sel,E=0;E<A.ranges.length;E++){var L=A.ranges[E];d[E]={from:L.from(),to:L.to(),text:this.splitLines(a[E]),origin:g}}for(var O=l&&l!="end"&&Hu(this,d,l),Z=d.length-1;Z>=0;Z--)fi(this,d[Z]);O?Ga(this,O):this.cm&&ui(this.cm)}),undo:dn(function(){Hs(this,"undo")}),redo:dn(function(){Hs(this,"redo")}),undoSelection:dn(function(){Hs(this,"undo",!0)}),redoSelection:dn(function(){Hs(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=this.history,l=0,g=0,d=0;d<a.done.length;d++)a.done[d].ranges||++l;for(var A=0;A<a.undone.length;A++)a.undone[A].ranges||++g;return{undo:l,redo:g}},clearHistory:function(){var a=this;this.history=new Ws(this.history),wr(this,function(l){return l.history=a.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){return a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:ci(this.history.done),undone:ci(this.history.undone)}},setHistory:function(a){var l=this.history=new Ws(this.history);l.done=ci(a.done.slice(0),null,!0),l.undone=ci(a.undone.slice(0),null,!0)},setGutterMarker:dn(function(a,l,g){return Hi(this,a,"gutter",function(d){var A=d.gutterMarkers||(d.gutterMarkers={});return A[l]=g,!g&&ge(A)&&(d.gutterMarkers=null),!0})}),clearGutter:dn(function(a){var l=this;this.iter(function(g){g.gutterMarkers&&g.gutterMarkers[a]&&Hi(l,g,"gutter",function(){return g.gutterMarkers[a]=null,ge(g.gutterMarkers)&&(g.gutterMarkers=null),!0})})}),lineInfo:function(a){var l;if(typeof a=="number"){if(!kr(this,a)||(l=a,a=ot(this,a),!a))return null}else if(l=Xt(a),l==null)return null;return{line:l,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},addLineClass:dn(function(a,l,g){return Hi(this,a,l=="gutter"?"gutter":"class",function(d){var A=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass";if(!d[A])d[A]=g;else{if(ve(g).test(d[A]))return!1;d[A]+=" "+g}return!0})}),removeLineClass:dn(function(a,l,g){return Hi(this,a,l=="gutter"?"gutter":"class",function(d){var A=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass",E=d[A];if(E)if(g==null)d[A]=null;else{var L=E.match(ve(g));if(!L)return!1;var O=L.index+L[0].length;d[A]=E.slice(0,L.index)+(!L.index||O==E.length?"":" ")+E.slice(O)||null}else return!1;return!0})}),addLineWidget:dn(function(a,l,g){return tl(this,a,l,g)}),removeLineWidget:function(a){a.clear()},markText:function(a,l,g){return hi(this,Pt(this,a),Pt(this,l),g,g&&g.type||"range")},setBookmark:function(a,l){var g={replacedWith:l&&(l.nodeType==null?l.widget:l),insertLeft:l&&l.insertLeft,clearWhenEmpty:!1,shared:l&&l.shared,handleMouseEvents:l&&l.handleMouseEvents};return a=Pt(this,a),hi(this,a,a,g,"bookmark")},findMarksAt:function(a){a=Pt(this,a);var l=[],g=ot(this,a.line).markedSpans;if(g)for(var d=0;d<g.length;++d){var A=g[d];(A.from==null||A.from<=a.ch)&&(A.to==null||A.to>=a.ch)&&l.push(A.marker.parent||A.marker)}return l},findMarks:function(a,l,g){a=Pt(this,a),l=Pt(this,l);var d=[],A=a.line;return this.iter(a.line,l.line+1,function(E){var L=E.markedSpans;if(L)for(var O=0;O<L.length;O++){var Z=L[O];!(Z.to!=null&&A==a.line&&a.ch>=Z.to||Z.from==null&&A!=a.line||Z.from!=null&&A==l.line&&Z.from>=l.ch)&&(!g||g(Z.marker))&&d.push(Z.marker.parent||Z.marker)}++A}),d},getAllMarks:function(){var a=[];return this.iter(function(l){var g=l.markedSpans;if(g)for(var d=0;d<g.length;++d)g[d].from!=null&&a.push(g[d].marker)}),a},posFromIndex:function(a){var l,g=this.first,d=this.lineSeparator().length;return this.iter(function(A){var E=A.text.length+d;if(E>a)return l=a,!0;a-=E,++g}),Pt(this,We(g,l))},indexFromPos:function(a){a=Pt(this,a);var l=a.ch;if(a.line<this.first||a.ch<0)return 0;var g=this.lineSeparator().length;return this.iter(this.first,a.line,function(d){l+=d.text.length+g}),l},copy:function(a){var l=new Fn(Mi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return l.scrollTop=this.scrollTop,l.scrollLeft=this.scrollLeft,l.sel=this.sel,l.extend=!1,a&&(l.history.undoDepth=this.history.undoDepth,l.setHistory(this.getHistory())),l},linkedDoc:function(a){a||(a={});var l=this.first,g=this.first+this.size;a.from!=null&&a.from>l&&(l=a.from),a.to!=null&&a.to<g&&(g=a.to);var d=new Fn(Mi(this,l,g),a.mode||this.modeOption,l,this.lineSep,this.direction);return a.sharedHist&&(d.history=this.history),(this.linked||(this.linked=[])).push({doc:d,sharedHist:a.sharedHist}),d.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}],rl(d,Ya(this)),d},unlinkDoc:function(a){if(a instanceof qt&&(a=a.doc),this.linked)for(var l=0;l<this.linked.length;++l){var g=this.linked[l];if(g.doc==a){this.linked.splice(l,1),a.unlinkDoc(this),il(Ya(this));break}}if(a.history==this.history){var d=[a.id];wr(a,function(A){return d.push(A.id)},!0),a.history=new Ws(null),a.history.done=ci(this.history.done,d),a.history.undone=ci(this.history.undone,d)}},iterLinkedDocs:function(a){wr(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?a.split(this.lineSep):Be(a)},lineSeparator:function(){return this.lineSep||`
`},setDirection:dn(function(a){a!="rtl"&&(a="ltr"),a!=this.direction&&(this.direction=a,this.iter(function(l){return l.order=null}),this.cm&&Uu(this.cm))})}),Fn.prototype.eachLine=Fn.prototype.iter;var Ka=0;function ol(a){var l=this;if(qa(l),!(Bt(l,a)||Hn(l.display,a))){Mt(a),b&&(Ka=+new Date);var g=Br(l,a,!0),d=a.dataTransfer.files;if(!(!g||l.isReadOnly()))if(d&&d.length&&window.FileReader&&window.File)for(var A=d.length,E=Array(A),L=0,O=function(){++L==A&&fn(l,function(){g=Pt(l.doc,g);var be={from:g,to:g,text:l.doc.splitLines(E.filter(function(Fe){return Fe!=null}).join(l.doc.lineSeparator())),origin:"paste"};fi(l.doc,be),Ga(l.doc,Pr(Pt(l.doc,g),Pt(l.doc,Sr(be))))})()},Z=function(be,Fe){if(l.options.allowDropFileTypes&&St(l.options.allowDropFileTypes,be.type)==-1){O();return}var $e=new FileReader;$e.onerror=function(){return O()},$e.onload=function(){var Ze=$e.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(Ze)){O();return}E[Fe]=Ze,O()},$e.readAsText(be)},j=0;j<d.length;j++)Z(d[j],j);else{if(l.state.draggingText&&l.doc.sel.contains(g)>-1){l.state.draggingText(a),setTimeout(function(){return l.display.input.focus()},20);return}try{var ae=a.dataTransfer.getData("Text");if(ae){var fe;if(l.state.draggingText&&!l.state.draggingText.copy&&(fe=l.listSelections()),Zs(l.doc,Pr(g,g)),fe)for(var Me=0;Me<fe.length;++Me)di(l.doc,"",fe[Me].anchor,fe[Me].head,"drag");l.replaceSelection(ae,"around","paste"),l.display.input.focus()}}catch{}}}}function al(a,l){if(b&&(!a.state.draggingText||+new Date-Ka<100)){an(l);return}if(!(Bt(a,l)||Hn(a.display,l))&&(l.dataTransfer.setData("Text",a.getSelection()),l.dataTransfer.effectAllowed="copyMove",l.dataTransfer.setDragImage&&!$)){var g=Pe("img",null,null,"position: fixed; left: 0; top: 0;");g.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",N&&(g.width=g.height=1,a.display.wrapper.appendChild(g),g._top=g.offsetTop),l.dataTransfer.setDragImage(g,0,0),N&&g.parentNode.removeChild(g)}}function ul(a,l){var g=Br(a,l);if(g){var d=document.createDocumentFragment();Eo(a,g,d),a.display.dragCursor||(a.display.dragCursor=Pe("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),a.display.lineSpace.insertBefore(a.display.dragCursor,a.display.cursorDiv)),Oe(a.display.dragCursor,d)}}function qa(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=null)}function Ja(a){if(document.getElementsByClassName){for(var l=document.getElementsByClassName("CodeMirror"),g=[],d=0;d<l.length;d++){var A=l[d].CodeMirror;A&&g.push(A)}g.length&&g[0].operation(function(){for(var E=0;E<g.length;E++)a(g[E])})}}var Qa=!1;function ll(){Qa||(cl(),Qa=!0)}function cl(){var a;Ue(window,"resize",function(){a==null&&(a=setTimeout(function(){a=null,Ja(pl)},100))}),Ue(window,"blur",function(){return Ja(ai)})}function pl(a){var l=a.display;l.cachedCharWidth=l.cachedTextHeight=l.cachedPaddingH=null,l.scrollbarsClipped=!1,a.setSize()}for(var Fr={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},qi=0;qi<10;qi++)Fr[qi+48]=Fr[qi+96]=String(qi);for(var Us=65;Us<=90;Us++)Fr[Us]=String.fromCharCode(Us);for(var Ji=1;Ji<=12;Ji++)Fr[Ji+111]=Fr[Ji+63235]="F"+Ji;var fr={};fr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},fr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},fr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},fr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},fr.default=ie?fr.macDefault:fr.pcDefault;function fl(a){var l=a.split(/-(?!$)/);a=l[l.length-1];for(var g,d,A,E,L=0;L<l.length-1;L++){var O=l[L];if(/^(cmd|meta|m)$/i.test(O))E=!0;else if(/^a(lt)?$/i.test(O))g=!0;else if(/^(c|ctrl|control)$/i.test(O))d=!0;else if(/^s(hift)?$/i.test(O))A=!0;else throw new Error("Unrecognized modifier name: "+O)}return g&&(a="Alt-"+a),d&&(a="Ctrl-"+a),E&&(a="Cmd-"+a),A&&(a="Shift-"+a),a}function dl(a){var l={};for(var g in a)if(a.hasOwnProperty(g)){var d=a[g];if(/^(name|fallthrough|(de|at)tach)$/.test(g))continue;if(d=="..."){delete a[g];continue}for(var A=$t(g.split(" "),fl),E=0;E<A.length;E++){var L=void 0,O=void 0;E==A.length-1?(O=A.join(" "),L=d):(O=A.slice(0,E+1).join(" "),L="...");var Z=l[O];if(!Z)l[O]=L;else if(Z!=L)throw new Error("Inconsistent bindings for "+O)}delete a[g]}for(var j in l)a[j]=l[j];return a}function mi(a,l,g,d){l=js(l);var A=l.call?l.call(a,d):l[a];if(A===!1)return"nothing";if(A==="...")return"multi";if(A!=null&&g(A))return"handled";if(l.fallthrough){if(Object.prototype.toString.call(l.fallthrough)!="[object Array]")return mi(a,l.fallthrough,g,d);for(var E=0;E<l.fallthrough.length;E++){var L=mi(a,l.fallthrough[E],g,d);if(L)return L}}}function eu(a){var l=typeof a=="string"?a:Fr[a.keyCode];return l=="Ctrl"||l=="Alt"||l=="Shift"||l=="Mod"}function tu(a,l,g){var d=a;return l.altKey&&d!="Alt"&&(a="Alt-"+a),(pe?l.metaKey:l.ctrlKey)&&d!="Ctrl"&&(a="Ctrl-"+a),(pe?l.ctrlKey:l.metaKey)&&d!="Mod"&&(a="Cmd-"+a),!g&&l.shiftKey&&d!="Shift"&&(a="Shift-"+a),a}function nu(a,l){if(N&&a.keyCode==34&&a.char)return!1;var g=Fr[a.keyCode];return g==null||a.altGraphKey?!1:(a.keyCode==3&&a.code&&(g=a.code),tu(g,a,l))}function js(a){return typeof a=="string"?fr[a]:a}function gi(a,l){for(var g=a.doc.sel.ranges,d=[],A=0;A<g.length;A++){for(var E=l(g[A]);d.length&&xt(E.from,_t(d).to)<=0;){var L=d.pop();if(xt(L.from,E.from)<0){E.from=L.from;break}}d.push(E)}Ln(a,function(){for(var O=d.length-1;O>=0;O--)di(a.doc,"",d[O].from,d[O].to,"+delete");ui(a)})}function Uo(a,l,g){var d=Ne(a.text,l+g,g);return d<0||d>a.text.length?null:d}function jo(a,l,g){var d=Uo(a,l.ch,g);return d==null?null:new We(l.line,d,g<0?"after":"before")}function Yo(a,l,g,d,A){if(a){l.doc.direction=="rtl"&&(A=-A);var E=Gt(g,l.doc.direction);if(E){var L=A<0?_t(E):E[0],O=A<0==(L.level==1),Z=O?"after":"before",j;if(L.level>0||l.doc.direction=="rtl"){var ae=Cr(l,g);j=A<0?g.text.length-1:0;var fe=zn(l,ae,j).top;j=De(function(Me){return zn(l,ae,Me).top==fe},A<0==(L.level==1)?L.from:L.to-1,j),Z=="before"&&(j=Uo(g,j,1))}else j=A<0?L.to:L.from;return new We(d,j,Z)}}return new We(d,A<0?g.text.length:0,A<0?"before":"after")}function hl(a,l,g,d){var A=Gt(l,a.doc.direction);if(!A)return jo(l,g,d);g.ch>=l.text.length?(g.ch=l.text.length,g.sticky="before"):g.ch<=0&&(g.ch=0,g.sticky="after");var E=He(A,g.ch,g.sticky),L=A[E];if(a.doc.direction=="ltr"&&L.level%2==0&&(d>0?L.to>g.ch:L.from<g.ch))return jo(l,g,d);var O=function(je,Je){return Uo(l,je instanceof We?je.ch:je,Je)},Z,j=function(je){return a.options.lineWrapping?(Z=Z||Cr(a,l),aa(a,l,Z,je)):{begin:0,end:l.text.length}},ae=j(g.sticky=="before"?O(g,-1):g.ch);if(a.doc.direction=="rtl"||L.level==1){var fe=L.level==1==d<0,Me=O(g,fe?1:-1);if(Me!=null&&(fe?Me<=L.to&&Me<=ae.end:Me>=L.from&&Me>=ae.begin)){var be=fe?"before":"after";return new We(g.line,Me,be)}}var Fe=function(je,Je,Ye){for(var et=function(Yt,hn){return hn?new We(g.line,O(Yt,1),"before"):new We(g.line,Yt,"after")};je>=0&&je<A.length;je+=Je){var ht=A[je],ct=Je>0==(ht.level!=1),Tt=ct?Ye.begin:O(Ye.end,-1);if(ht.from<=Tt&&Tt<ht.to||(Tt=ct?ht.from:O(ht.to,-1),Ye.begin<=Tt&&Tt<Ye.end))return et(Tt,ct)}},$e=Fe(E+d,d,ae);if($e)return $e;var Ze=d>0?ae.end:O(ae.begin,-1);return Ze!=null&&!(d>0&&Ze==l.text.length)&&($e=Fe(d>0?0:A.length-1,d,j(Ze)),$e)?$e:null}var Qi={selectAll:Oa,singleSelection:function(a){return a.setSelection(a.getCursor("anchor"),a.getCursor("head"),yt)},killLine:function(a){return gi(a,function(l){if(l.empty()){var g=ot(a.doc,l.head.line).text.length;return l.head.ch==g&&l.head.line<a.lastLine()?{from:l.head,to:We(l.head.line+1,0)}:{from:l.head,to:We(l.head.line,g)}}else return{from:l.from(),to:l.to()}})},deleteLine:function(a){return gi(a,function(l){return{from:We(l.from().line,0),to:Pt(a.doc,We(l.to().line+1,0))}})},delLineLeft:function(a){return gi(a,function(l){return{from:We(l.from().line,0),to:l.from()}})},delWrappedLineLeft:function(a){return gi(a,function(l){var g=a.charCoords(l.head,"div").top+5,d=a.coordsChar({left:0,top:g},"div");return{from:d,to:l.from()}})},delWrappedLineRight:function(a){return gi(a,function(l){var g=a.charCoords(l.head,"div").top+5,d=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:g},"div");return{from:l.from(),to:d}})},undo:function(a){return a.undo()},redo:function(a){return a.redo()},undoSelection:function(a){return a.undoSelection()},redoSelection:function(a){return a.redoSelection()},goDocStart:function(a){return a.extendSelection(We(a.firstLine(),0))},goDocEnd:function(a){return a.extendSelection(We(a.lastLine()))},goLineStart:function(a){return a.extendSelectionsBy(function(l){return ru(a,l.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){return a.extendSelectionsBy(function(l){return iu(a,l.head)},{origin:"+move",bias:1})},goLineEnd:function(a){return a.extendSelectionsBy(function(l){return ml(a,l.head.line)},{origin:"+move",bias:-1})},goLineRight:function(a){return a.extendSelectionsBy(function(l){var g=a.cursorCoords(l.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:g},"div")},Et)},goLineLeft:function(a){return a.extendSelectionsBy(function(l){var g=a.cursorCoords(l.head,"div").top+5;return a.coordsChar({left:0,top:g},"div")},Et)},goLineLeftSmart:function(a){return a.extendSelectionsBy(function(l){var g=a.cursorCoords(l.head,"div").top+5,d=a.coordsChar({left:0,top:g},"div");return d.ch<a.getLine(d.line).search(/\S/)?iu(a,l.head):d},Et)},goLineUp:function(a){return a.moveV(-1,"line")},goLineDown:function(a){return a.moveV(1,"line")},goPageUp:function(a){return a.moveV(-1,"page")},goPageDown:function(a){return a.moveV(1,"page")},goCharLeft:function(a){return a.moveH(-1,"char")},goCharRight:function(a){return a.moveH(1,"char")},goColumnLeft:function(a){return a.moveH(-1,"column")},goColumnRight:function(a){return a.moveH(1,"column")},goWordLeft:function(a){return a.moveH(-1,"word")},goGroupRight:function(a){return a.moveH(1,"group")},goGroupLeft:function(a){return a.moveH(-1,"group")},goWordRight:function(a){return a.moveH(1,"word")},delCharBefore:function(a){return a.deleteH(-1,"codepoint")},delCharAfter:function(a){return a.deleteH(1,"char")},delWordBefore:function(a){return a.deleteH(-1,"word")},delWordAfter:function(a){return a.deleteH(1,"word")},delGroupBefore:function(a){return a.deleteH(-1,"group")},delGroupAfter:function(a){return a.deleteH(1,"group")},indentAuto:function(a){return a.indentSelection("smart")},indentMore:function(a){return a.indentSelection("add")},indentLess:function(a){return a.indentSelection("subtract")},insertTab:function(a){return a.replaceSelection("	")},insertSoftTab:function(a){for(var l=[],g=a.listSelections(),d=a.options.tabSize,A=0;A<g.length;A++){var E=g[A].from(),L=Ee(a.getLine(E.line),E.ch,d);l.push(Nt(d-L%d))}a.replaceSelections(l)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){return Ln(a,function(){for(var l=a.listSelections(),g=[],d=0;d<l.length;d++)if(l[d].empty()){var A=l[d].head,E=ot(a.doc,A.line).text;if(E){if(A.ch==E.length&&(A=new We(A.line,A.ch-1)),A.ch>0)A=new We(A.line,A.ch+1),a.replaceRange(E.charAt(A.ch-1)+E.charAt(A.ch-2),We(A.line,A.ch-2),A,"+transpose");else if(A.line>a.doc.first){var L=ot(a.doc,A.line-1).text;L&&(A=new We(A.line,1),a.replaceRange(E.charAt(0)+a.doc.lineSeparator()+L.charAt(L.length-1),We(A.line-1,L.length-1),A,"+transpose"))}}g.push(new Vt(A,A))}a.setSelections(g)})},newlineAndIndent:function(a){return Ln(a,function(){for(var l=a.listSelections(),g=l.length-1;g>=0;g--)a.replaceRange(a.doc.lineSeparator(),l[g].anchor,l[g].head,"+input");l=a.listSelections();for(var d=0;d<l.length;d++)a.indentLine(l[d].from().line,null,!0);ui(a)})},openLine:function(a){return a.replaceSelection(`
`,"start")},toggleOverwrite:function(a){return a.toggleOverwrite()}};function ru(a,l){var g=ot(a.doc,l),d=Bn(g);return d!=g&&(l=Xt(d)),Yo(!0,a,d,l,1)}function ml(a,l){var g=ot(a.doc,l),d=ao(g);return d!=g&&(l=Xt(d)),Yo(!0,a,g,l,-1)}function iu(a,l){var g=ru(a,l.line),d=ot(a.doc,g.line),A=Gt(d,a.doc.direction);if(!A||A[0].level==0){var E=Math.max(g.ch,d.text.search(/\S/)),L=l.line==g.line&&l.ch<=E&&l.ch;return We(g.line,L?0:E,g.sticky)}return g}function Ys(a,l,g){if(typeof l=="string"&&(l=Qi[l],!l))return!1;a.display.input.ensurePolled();var d=a.display.shift,A=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),g&&(a.display.shift=!1),A=l(a)!=bt}finally{a.display.shift=d,a.state.suppressEdits=!1}return A}function gl(a,l,g){for(var d=0;d<a.state.keyMaps.length;d++){var A=mi(l,a.state.keyMaps[d],g,a);if(A)return A}return a.options.extraKeys&&mi(l,a.options.extraKeys,g,a)||mi(l,a.options.keyMap,g,a)}var _l=new rt;function es(a,l,g,d){var A=a.state.keySeq;if(A){if(eu(l))return"handled";if(/\'$/.test(l)?a.state.keySeq=null:_l.set(50,function(){a.state.keySeq==A&&(a.state.keySeq=null,a.display.input.reset())}),su(a,A+" "+l,g,d))return!0}return su(a,l,g,d)}function su(a,l,g,d){var A=gl(a,l,d);return A=="multi"&&(a.state.keySeq=l),A=="handled"&&un(a,"keyHandled",a,l,g),(A=="handled"||A=="multi")&&(Mt(g),ko(a)),!!A}function ou(a,l){var g=nu(l,!0);return g?l.shiftKey&&!a.state.keySeq?es(a,"Shift-"+g,l,function(d){return Ys(a,d,!0)})||es(a,g,l,function(d){if(typeof d=="string"?/^go[A-Z]/.test(d):d.motion)return Ys(a,d)}):es(a,g,l,function(d){return Ys(a,d)}):!1}function yl(a,l,g){return es(a,"'"+g+"'",l,function(d){return Ys(a,d,!0)})}var Ko=null;function au(a){var l=this;if(!(a.target&&a.target!=l.display.input.getField())&&(l.curOp.focus=me(),!Bt(l,a))){b&&M<11&&a.keyCode==27&&(a.returnValue=!1);var g=a.keyCode;l.display.shift=g==16||a.shiftKey;var d=ou(l,a);N&&(Ko=d?g:null,!d&&g==88&&!nt&&(ie?a.metaKey:a.ctrlKey)&&l.replaceSelection("",null,"cut")),o&&!ie&&!d&&g==46&&a.shiftKey&&!a.ctrlKey&&document.execCommand&&document.execCommand("cut"),g==18&&!/\bCodeMirror-crosshair\b/.test(l.display.lineDiv.className)&&vl(l)}}function vl(a){var l=a.display.lineDiv;ye(l,"CodeMirror-crosshair");function g(d){(d.keyCode==18||!d.altKey)&&(we(l,"CodeMirror-crosshair"),It(document,"keyup",g),It(document,"mouseover",g))}Ue(document,"keyup",g),Ue(document,"mouseover",g)}function uu(a){a.keyCode==16&&(this.doc.sel.shift=!1),Bt(this,a)}function lu(a){var l=this;if(!(a.target&&a.target!=l.display.input.getField())&&!(Hn(l.display,a)||Bt(l,a)||a.ctrlKey&&!a.altKey||ie&&a.metaKey)){var g=a.keyCode,d=a.charCode;if(N&&g==Ko){Ko=null,Mt(a);return}if(!(N&&(!a.which||a.which<10)&&ou(l,a))){var A=String.fromCharCode(d??g);A!="\b"&&(yl(l,a,A)||l.display.input.onKeyPress(a))}}}var bl=400,qo=function(a,l,g){this.time=a,this.pos=l,this.button=g};qo.prototype.compare=function(a,l,g){return this.time+bl>a&&xt(l,this.pos)==0&&g==this.button};var ts,ns;function Al(a,l){var g=+new Date;return ns&&ns.compare(g,a,l)?(ts=ns=null,"triple"):ts&&ts.compare(g,a,l)?(ns=new qo(g,a,l),ts=null,"double"):(ts=new qo(g,a,l),ns=null,"single")}function cu(a){var l=this,g=l.display;if(!(Bt(l,a)||g.activeTouch&&g.input.supportsTouch())){if(g.input.ensurePolled(),g.shift=a.shiftKey,Hn(g,a)){F||(g.scroller.draggable=!1,setTimeout(function(){return g.scroller.draggable=!0},100));return}if(!Jo(l,a)){var d=Br(l,a),A=B(a),E=d?Al(d,A):"single";window.focus(),A==1&&l.state.selectingText&&l.state.selectingText(a),!(d&&Cl(l,A,d,E,a))&&(A==1?d?xl(l,d,E,a):An(a)==g.scroller&&Mt(a):A==2?(d&&Vs(l.doc,d),setTimeout(function(){return g.input.focus()},20)):A==3&&(_e?l.display.input.onContextMenu(a):To(l)))}}}function Cl(a,l,g,d,A){var E="Click";return d=="double"?E="Double"+E:d=="triple"&&(E="Triple"+E),E=(l==1?"Left":l==2?"Middle":"Right")+E,es(a,tu(E,A),A,function(L){if(typeof L=="string"&&(L=Qi[L]),!L)return!1;var O=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),O=L(a,g)!=bt}finally{a.state.suppressEdits=!1}return O})}function Ml(a,l,g){var d=a.getOption("configureMouse"),A=d?d(a,l,g):{};if(A.unit==null){var E=he?g.shiftKey&&g.metaKey:g.altKey;A.unit=E?"rectangle":l=="single"?"char":l=="double"?"word":"line"}return(A.extend==null||a.doc.extend)&&(A.extend=a.doc.extend||g.shiftKey),A.addNew==null&&(A.addNew=ie?g.metaKey:g.ctrlKey),A.moveOnDrag==null&&(A.moveOnDrag=!(ie?g.altKey:g.ctrlKey)),A}function xl(a,l,g,d){b?setTimeout(st(pa,a),0):a.curOp.focus=me();var A=Ml(a,g,d),E=a.doc.sel,L;a.options.dragDrop&&te&&!a.isReadOnly()&&g=="single"&&(L=E.contains(l))>-1&&(xt((L=E.ranges[L]).from(),l)<0||l.xRel>0)&&(xt(L.to(),l)>0||l.xRel<0)?Pl(a,d,l,A):Sl(a,d,l,A)}function Pl(a,l,g,d){var A=a.display,E=!1,L=fn(a,function(j){F&&(A.scroller.draggable=!1),a.state.draggingText=!1,a.state.delayingBlurEvent&&(a.hasFocus()?a.state.delayingBlurEvent=!1:To(a)),It(A.wrapper.ownerDocument,"mouseup",L),It(A.wrapper.ownerDocument,"mousemove",O),It(A.scroller,"dragstart",Z),It(A.scroller,"drop",L),E||(Mt(j),d.addNew||Vs(a.doc,g,null,null,d.extend),F&&!$||b&&M==9?setTimeout(function(){A.wrapper.ownerDocument.body.focus({preventScroll:!0}),A.input.focus()},20):A.input.focus())}),O=function(j){E=E||Math.abs(l.clientX-j.clientX)+Math.abs(l.clientY-j.clientY)>=10},Z=function(){return E=!0};F&&(A.scroller.draggable=!0),a.state.draggingText=L,L.copy=!d.moveOnDrag,Ue(A.wrapper.ownerDocument,"mouseup",L),Ue(A.wrapper.ownerDocument,"mousemove",O),Ue(A.scroller,"dragstart",Z),Ue(A.scroller,"drop",L),a.state.delayingBlurEvent=!0,setTimeout(function(){return A.input.focus()},20),A.scroller.dragDrop&&A.scroller.dragDrop()}function pu(a,l,g){if(g=="char")return new Vt(l,l);if(g=="word")return a.findWordAt(l);if(g=="line")return new Vt(We(l.line,0),Pt(a.doc,We(l.line+1,0)));var d=g(a,l);return new Vt(d.from,d.to)}function Sl(a,l,g,d){b&&To(a);var A=a.display,E=a.doc;Mt(l);var L,O,Z=E.sel,j=Z.ranges;if(d.addNew&&!d.extend?(O=E.sel.contains(g),O>-1?L=j[O]:L=new Vt(g,g)):(L=E.sel.primary(),O=E.sel.primIndex),d.unit=="rectangle")d.addNew||(L=new Vt(g,g)),g=Br(a,l,!0,!0),O=-1;else{var ae=pu(a,g,d.unit);d.extend?L=zo(L,ae.anchor,ae.head,d.extend):L=ae}d.addNew?O==-1?(O=j.length,vn(E,jn(a,j.concat([L]),O),{scroll:!1,origin:"*mouse"})):j.length>1&&j[O].empty()&&d.unit=="char"&&!d.extend?(vn(E,jn(a,j.slice(0,O).concat(j.slice(O+1)),0),{scroll:!1,origin:"*mouse"}),Z=E.sel):Ho(E,O,L,At):(O=0,vn(E,new In([L],0),At),Z=E.sel);var fe=g;function Me(Ye){if(xt(fe,Ye)!=0)if(fe=Ye,d.unit=="rectangle"){for(var et=[],ht=a.options.tabSize,ct=Ee(ot(E,g.line).text,g.ch,ht),Tt=Ee(ot(E,Ye.line).text,Ye.ch,ht),Yt=Math.min(ct,Tt),hn=Math.max(ct,Tt),Qt=Math.min(g.line,Ye.line),Gn=Math.min(a.lastLine(),Math.max(g.line,Ye.line));Qt<=Gn;Qt++){var En=ot(E,Qt).text,ln=Kt(En,Yt,ht);Yt==hn?et.push(new Vt(We(Qt,ln),We(Qt,ln))):En.length>ln&&et.push(new Vt(We(Qt,ln),We(Qt,Kt(En,hn,ht))))}et.length||et.push(new Vt(g,g)),vn(E,jn(a,Z.ranges.slice(0,O).concat(et),O),{origin:"*mouse",scroll:!1}),a.scrollIntoView(Ye)}else{var kn=L,gn=pu(a,Ye,d.unit),pn=kn.anchor,cn;xt(gn.anchor,pn)>0?(cn=gn.head,pn=jr(kn.from(),gn.anchor)):(cn=gn.anchor,pn=Ur(kn.to(),gn.head));var tn=Z.ranges.slice(0);tn[O]=wl(a,new Vt(Pt(E,pn),cn)),vn(E,jn(a,tn,O),At)}}var be=A.wrapper.getBoundingClientRect(),Fe=0;function $e(Ye){var et=++Fe,ht=Br(a,Ye,!0,d.unit=="rectangle");if(ht)if(xt(ht,fe)!=0){a.curOp.focus=me(),Me(ht);var ct=Bs(A,E);(ht.line>=ct.to||ht.line<ct.from)&&setTimeout(fn(a,function(){Fe==et&&$e(Ye)}),150)}else{var Tt=Ye.clientY<be.top?-20:Ye.clientY>be.bottom?20:0;Tt&&setTimeout(fn(a,function(){Fe==et&&(A.scroller.scrollTop+=Tt,$e(Ye))}),50)}}function Ze(Ye){a.state.selectingText=!1,Fe=1/0,Ye&&(Mt(Ye),A.input.focus()),It(A.wrapper.ownerDocument,"mousemove",je),It(A.wrapper.ownerDocument,"mouseup",Je),E.history.lastSelOrigin=null}var je=fn(a,function(Ye){Ye.buttons===0||!B(Ye)?Ze(Ye):$e(Ye)}),Je=fn(a,Ze);a.state.selectingText=Je,Ue(A.wrapper.ownerDocument,"mousemove",je),Ue(A.wrapper.ownerDocument,"mouseup",Je)}function wl(a,l){var g=l.anchor,d=l.head,A=ot(a.doc,g.line);if(xt(g,d)==0&&g.sticky==d.sticky)return l;var E=Gt(A);if(!E)return l;var L=He(E,g.ch,g.sticky),O=E[L];if(O.from!=g.ch&&O.to!=g.ch)return l;var Z=L+(O.from==g.ch==(O.level!=1)?0:1);if(Z==0||Z==E.length)return l;var j;if(d.line!=g.line)j=(d.line-g.line)*(a.doc.direction=="ltr"?1:-1)>0;else{var ae=He(E,d.ch,d.sticky),fe=ae-L||(d.ch-g.ch)*(O.level==1?-1:1);ae==Z-1||ae==Z?j=fe<0:j=fe>0}var Me=E[Z+(j?-1:0)],be=j==(Me.level==1),Fe=be?Me.from:Me.to,$e=be?"after":"before";return g.ch==Fe&&g.sticky==$e?l:new Vt(new We(g.line,Fe,$e),d)}function fu(a,l,g,d){var A,E;if(l.touches)A=l.touches[0].clientX,E=l.touches[0].clientY;else try{A=l.clientX,E=l.clientY}catch{return!1}if(A>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;d&&Mt(l);var L=a.display,O=L.lineDiv.getBoundingClientRect();if(E>O.bottom||!tt(a,g))return nn(l);E-=O.top-L.viewOffset;for(var Z=0;Z<a.display.gutterSpecs.length;++Z){var j=L.gutters.childNodes[Z];if(j&&j.getBoundingClientRect().right>=A){var ae=rr(a.doc,E),fe=a.display.gutterSpecs[Z];return Qe(a,g,a,ae,fe.className,l),nn(l)}}}function Jo(a,l){return fu(a,l,"gutterClick",!0)}function du(a,l){Hn(a.display,l)||Dl(a,l)||Bt(a,l,"contextmenu")||_e||a.display.input.onContextMenu(l)}function Dl(a,l){return tt(a,"gutterContextMenu")?fu(a,l,"gutterContextMenu",!1):!1}function hu(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ht(a)}var _i={toString:function(){return"CodeMirror.Init"}},mu={},Ks={};function Fl(a){var l=a.optionHandlers;function g(d,A,E,L){a.defaults[d]=A,E&&(l[d]=L?function(O,Z,j){j!=_i&&E(O,Z,j)}:E)}a.defineOption=g,a.Init=_i,g("value","",function(d,A){return d.setValue(A)},!0),g("mode",null,function(d,A){d.doc.modeOption=A,Xo(d)},!0),g("indentUnit",2,Xo,!0),g("indentWithTabs",!1),g("smartIndent",!0),g("tabSize",4,function(d){Zi(d),Ht(d),Dn(d)},!0),g("lineSeparator",null,function(d,A){if(d.doc.lineSep=A,!!A){var E=[],L=d.doc.first;d.doc.iter(function(Z){for(var j=0;;){var ae=Z.text.indexOf(A,j);if(ae==-1)break;j=ae+A.length,E.push(We(L,ae))}L++});for(var O=E.length-1;O>=0;O--)di(d.doc,A,E[O],We(E[O].line,E[O].ch+A.length))}}),g("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(d,A,E){d.state.specialChars=new RegExp(A.source+(A.test("	")?"":"|	"),"g"),E!=_i&&d.refresh()}),g("specialCharPlaceholder",_r,function(d){return d.refresh()},!0),g("electricChars",!0),g("inputStyle",K?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),g("spellcheck",!1,function(d,A){return d.getInputField().spellcheck=A},!0),g("autocorrect",!1,function(d,A){return d.getInputField().autocorrect=A},!0),g("autocapitalize",!1,function(d,A){return d.getInputField().autocapitalize=A},!0),g("rtlMoveVisually",!se),g("wholeLineUpdateBefore",!0),g("theme","default",function(d){hu(d),Vi(d)},!0),g("keyMap","default",function(d,A,E){var L=js(A),O=E!=_i&&js(E);O&&O.detach&&O.detach(d,L),L.attach&&L.attach(d,O||null)}),g("extraKeys",null),g("configureMouse",null),g("lineWrapping",!1,kl,!0),g("gutters",[],function(d,A){d.display.gutterSpecs=Oo(A,d.options.lineNumbers),Vi(d)},!0),g("fixedGutter",!0,function(d,A){d.display.gutters.style.left=A?Do(d.display)+"px":"0",d.refresh()},!0),g("coverGutterNextToScrollbar",!1,function(d){return li(d)},!0),g("scrollbarStyle","native",function(d){_a(d),li(d),d.display.scrollbars.setScrollTop(d.doc.scrollTop),d.display.scrollbars.setScrollLeft(d.doc.scrollLeft)},!0),g("lineNumbers",!1,function(d,A){d.display.gutterSpecs=Oo(d.options.gutters,A),Vi(d)},!0),g("firstLineNumber",1,Vi,!0),g("lineNumberFormatter",function(d){return d},Vi,!0),g("showCursorWhenSelecting",!1,Bi,!0),g("resetSelectionOnContextMenu",!0),g("lineWiseCopyCut",!0),g("pasteLinesPerSelection",!0),g("selectionsMayTouch",!1),g("readOnly",!1,function(d,A){A=="nocursor"&&(ai(d),d.display.input.blur()),d.display.input.readOnlyChanged(A)}),g("screenReaderLabel",null,function(d,A){A=A===""?null:A,d.display.input.screenReaderLabelChanged(A)}),g("disableInput",!1,function(d,A){A||d.display.input.reset()},!0),g("dragDrop",!0,El),g("allowDropFileTypes",null),g("cursorBlinkRate",530),g("cursorScrollMargin",0),g("cursorHeight",1,Bi,!0),g("singleCursorHeightPerLine",!0,Bi,!0),g("workTime",100),g("workDelay",100),g("flattenSpans",!0,Zi,!0),g("addModeClass",!1,Zi,!0),g("pollInterval",100),g("undoDepth",200,function(d,A){return d.doc.history.undoDepth=A}),g("historyEventDelay",1250),g("viewportMargin",10,function(d){return d.refresh()},!0),g("maxHighlightLength",1e4,Zi,!0),g("moveInputWithCursor",!0,function(d,A){A||d.display.input.resetPosition()}),g("tabindex",null,function(d,A){return d.display.input.getField().tabIndex=A||""}),g("autofocus",null),g("direction","ltr",function(d,A){return d.doc.setDirection(A)},!0),g("phrases",null)}function El(a,l,g){var d=g&&g!=_i;if(!l!=!d){var A=a.display.dragFunctions,E=l?Ue:It;E(a.display.scroller,"dragstart",A.start),E(a.display.scroller,"dragenter",A.enter),E(a.display.scroller,"dragover",A.over),E(a.display.scroller,"dragleave",A.leave),E(a.display.scroller,"drop",A.drop)}}function kl(a){a.options.lineWrapping?(ye(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(we(a.display.wrapper,"CodeMirror-wrap"),Qr(a)),Fo(a),Dn(a),Ht(a),setTimeout(function(){return li(a)},100)}function qt(a,l){var g=this;if(!(this instanceof qt))return new qt(a,l);this.options=l=l?mt(l):{},mt(mu,l,!1);var d=l.value;typeof d=="string"?d=new Fn(d,l.mode,null,l.lineSeparator,l.direction):l.mode&&(d.modeOption=l.mode),this.doc=d;var A=new qt.inputStyles[l.inputStyle](this),E=this.display=new Zu(a,d,A,l);E.wrapper.CodeMirror=this,hu(this),l.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),_a(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new rt,keySeq:null,specialChars:null},l.autofocus&&!K&&E.input.focus(),b&&M<11&&setTimeout(function(){return g.display.input.reset(!0)},20),Tl(this),ll(),Wr(this),this.curOp.forceUpdate=!0,wa(this,d),l.autofocus&&!K||this.hasFocus()?setTimeout(function(){g.hasFocus()&&!g.state.focused&&No(g)},20):ai(this);for(var L in Ks)Ks.hasOwnProperty(L)&&Ks[L](this,l[L],_i);ba(this),l.finishInit&&l.finishInit(this);for(var O=0;O<Qo.length;++O)Qo[O](this);Xr(this),F&&l.lineWrapping&&getComputedStyle(E.lineDiv).textRendering=="optimizelegibility"&&(E.lineDiv.style.textRendering="auto")}qt.defaults=mu,qt.optionHandlers=Ks;function Tl(a){var l=a.display;Ue(l.scroller,"mousedown",fn(a,cu)),b&&M<11?Ue(l.scroller,"dblclick",fn(a,function(Z){if(!Bt(a,Z)){var j=Br(a,Z);if(!(!j||Jo(a,Z)||Hn(a.display,Z))){Mt(Z);var ae=a.findWordAt(j);Vs(a.doc,ae.anchor,ae.head)}}})):Ue(l.scroller,"dblclick",function(Z){return Bt(a,Z)||Mt(Z)}),Ue(l.scroller,"contextmenu",function(Z){return du(a,Z)}),Ue(l.input.getField(),"contextmenu",function(Z){l.scroller.contains(Z.target)||du(a,Z)});var g,d={end:0};function A(){l.activeTouch&&(g=setTimeout(function(){return l.activeTouch=null},1e3),d=l.activeTouch,d.end=+new Date)}function E(Z){if(Z.touches.length!=1)return!1;var j=Z.touches[0];return j.radiusX<=1&&j.radiusY<=1}function L(Z,j){if(j.left==null)return!0;var ae=j.left-Z.left,fe=j.top-Z.top;return ae*ae+fe*fe>400}Ue(l.scroller,"touchstart",function(Z){if(!Bt(a,Z)&&!E(Z)&&!Jo(a,Z)){l.input.ensurePolled(),clearTimeout(g);var j=+new Date;l.activeTouch={start:j,moved:!1,prev:j-d.end<=300?d:null},Z.touches.length==1&&(l.activeTouch.left=Z.touches[0].pageX,l.activeTouch.top=Z.touches[0].pageY)}}),Ue(l.scroller,"touchmove",function(){l.activeTouch&&(l.activeTouch.moved=!0)}),Ue(l.scroller,"touchend",function(Z){var j=l.activeTouch;if(j&&!Hn(l,Z)&&j.left!=null&&!j.moved&&new Date-j.start<300){var ae=a.coordsChar(l.activeTouch,"page"),fe;!j.prev||L(j,j.prev)?fe=new Vt(ae,ae):!j.prev.prev||L(j,j.prev.prev)?fe=a.findWordAt(ae):fe=new Vt(We(ae.line,0),Pt(a.doc,We(ae.line+1,0))),a.setSelection(fe.anchor,fe.head),a.focus(),Mt(Z)}A()}),Ue(l.scroller,"touchcancel",A),Ue(l.scroller,"scroll",function(){l.scroller.clientHeight&&(Ii(a,l.scroller.scrollTop),Ir(a,l.scroller.scrollLeft,!0),Qe(a,"scroll",a))}),Ue(l.scroller,"mousewheel",function(Z){return Ma(a,Z)}),Ue(l.scroller,"DOMMouseScroll",function(Z){return Ma(a,Z)}),Ue(l.wrapper,"scroll",function(){return l.wrapper.scrollTop=l.wrapper.scrollLeft=0}),l.dragFunctions={enter:function(Z){Bt(a,Z)||an(Z)},over:function(Z){Bt(a,Z)||(ul(a,Z),an(Z))},start:function(Z){return al(a,Z)},drop:fn(a,ol),leave:function(Z){Bt(a,Z)||qa(a)}};var O=l.input.getField();Ue(O,"keyup",function(Z){return uu.call(a,Z)}),Ue(O,"keydown",fn(a,au)),Ue(O,"keypress",fn(a,lu)),Ue(O,"focus",function(Z){return No(a,Z)}),Ue(O,"blur",function(Z){return ai(a,Z)})}var Qo=[];qt.defineInitHook=function(a){return Qo.push(a)};function rs(a,l,g,d){var A=a.doc,E;g==null&&(g="add"),g=="smart"&&(A.mode.indent?E=Tr(a,l).state:g="prev");var L=a.options.tabSize,O=ot(A,l),Z=Ee(O.text,null,L);O.stateAfter&&(O.stateAfter=null);var j=O.text.match(/^\s*/)[0],ae;if(!d&&!/\S/.test(O.text))ae=0,g="not";else if(g=="smart"&&(ae=A.mode.indent(E,O.text.slice(j.length),O.text),ae==bt||ae>150)){if(!d)return;g="prev"}g=="prev"?l>A.first?ae=Ee(ot(A,l-1).text,null,L):ae=0:g=="add"?ae=Z+a.options.indentUnit:g=="subtract"?ae=Z-a.options.indentUnit:typeof g=="number"&&(ae=Z+g),ae=Math.max(0,ae);var fe="",Me=0;if(a.options.indentWithTabs)for(var be=Math.floor(ae/L);be;--be)Me+=L,fe+="	";if(Me<ae&&(fe+=Nt(ae-Me)),fe!=j)return di(A,fe,We(l,0),We(l,j.length),"+input"),O.stateAfter=null,!0;for(var Fe=0;Fe<A.sel.ranges.length;Fe++){var $e=A.sel.ranges[Fe];if($e.head.line==l&&$e.head.ch<j.length){var Ze=We(l,j.length);Ho(A,Fe,new Vt(Ze,Ze));break}}}var Yn=null;function qs(a){Yn=a}function ea(a,l,g,d,A){var E=a.doc;a.display.shift=!1,d||(d=E.sel);var L=+new Date-200,O=A=="paste"||a.state.pasteIncoming>L,Z=Be(l),j=null;if(O&&d.ranges.length>1)if(Yn&&Yn.text.join(`
`)==l){if(d.ranges.length%Yn.text.length==0){j=[];for(var ae=0;ae<Yn.text.length;ae++)j.push(E.splitLines(Yn.text[ae]))}}else Z.length==d.ranges.length&&a.options.pasteLinesPerSelection&&(j=$t(Z,function(je){return[je]}));for(var fe=a.curOp.updateInput,Me=d.ranges.length-1;Me>=0;Me--){var be=d.ranges[Me],Fe=be.from(),$e=be.to();be.empty()&&(g&&g>0?Fe=We(Fe.line,Fe.ch-g):a.state.overwrite&&!O?$e=We($e.line,Math.min(ot(E,$e.line).text.length,$e.ch+_t(Z).length)):O&&Yn&&Yn.lineWise&&Yn.text.join(`
`)==Z.join(`
`)&&(Fe=$e=We(Fe.line,0)));var Ze={from:Fe,to:$e,text:j?j[Me%j.length]:Z,origin:A||(O?"paste":a.state.cutIncoming>L?"cut":"+input")};fi(a.doc,Ze),un(a,"inputRead",a,Ze)}l&&!O&&_u(a,l),ui(a),a.curOp.updateInput<2&&(a.curOp.updateInput=fe),a.curOp.typing=!0,a.state.pasteIncoming=a.state.cutIncoming=-1}function gu(a,l){var g=a.clipboardData&&a.clipboardData.getData("Text");if(g)return a.preventDefault(),!l.isReadOnly()&&!l.options.disableInput&&l.hasFocus()&&Ln(l,function(){return ea(l,g,0,null,"paste")}),!0}function _u(a,l){if(!(!a.options.electricChars||!a.options.smartIndent))for(var g=a.doc.sel,d=g.ranges.length-1;d>=0;d--){var A=g.ranges[d];if(!(A.head.ch>100||d&&g.ranges[d-1].head.line==A.head.line)){var E=a.getModeAt(A.head),L=!1;if(E.electricChars){for(var O=0;O<E.electricChars.length;O++)if(l.indexOf(E.electricChars.charAt(O))>-1){L=rs(a,A.head.line,"smart");break}}else E.electricInput&&E.electricInput.test(ot(a.doc,A.head.line).text.slice(0,A.head.ch))&&(L=rs(a,A.head.line,"smart"));L&&un(a,"electricInput",a,A.head.line)}}}function yu(a){for(var l=[],g=[],d=0;d<a.doc.sel.ranges.length;d++){var A=a.doc.sel.ranges[d].head.line,E={anchor:We(A,0),head:We(A+1,0)};g.push(E),l.push(a.getRange(E.anchor,E.head))}return{text:l,ranges:g}}function vu(a,l,g,d){a.setAttribute("autocorrect",g?"":"off"),a.setAttribute("autocapitalize",d?"":"off"),a.setAttribute("spellcheck",!!l)}function bu(){var a=Pe("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),l=Pe("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return F?a.style.width="1000px":a.setAttribute("wrap","off"),V&&(a.style.border="1px solid black"),vu(a),l}function Nl(a){var l=a.optionHandlers,g=a.helpers={};a.prototype={constructor:a,focus:function(){window.focus(),this.display.input.focus()},setOption:function(d,A){var E=this.options,L=E[d];E[d]==A&&d!="mode"||(E[d]=A,l.hasOwnProperty(d)&&fn(this,l[d])(this,A,L),Qe(this,"optionChange",this,d))},getOption:function(d){return this.options[d]},getDoc:function(){return this.doc},addKeyMap:function(d,A){this.state.keyMaps[A?"push":"unshift"](js(d))},removeKeyMap:function(d){for(var A=this.state.keyMaps,E=0;E<A.length;++E)if(A[E]==d||A[E].name==d)return A.splice(E,1),!0},addOverlay:xn(function(d,A){var E=d.token?d:a.getMode(this.options,d);if(E.startState)throw new Error("Overlays may not be stateful.");sn(this.state.overlays,{mode:E,modeSpec:d,opaque:A&&A.opaque,priority:A&&A.priority||0},function(L){return L.priority}),this.state.modeGen++,Dn(this)}),removeOverlay:xn(function(d){for(var A=this.state.overlays,E=0;E<A.length;++E){var L=A[E].modeSpec;if(L==d||typeof d=="string"&&L.name==d){A.splice(E,1),this.state.modeGen++,Dn(this);return}}}),indentLine:xn(function(d,A,E){typeof A!="string"&&typeof A!="number"&&(A==null?A=this.options.smartIndent?"smart":"prev":A=A?"add":"subtract"),kr(this.doc,d)&&rs(this,d,A,E)}),indentSelection:xn(function(d){for(var A=this.doc.sel.ranges,E=-1,L=0;L<A.length;L++){var O=A[L];if(O.empty())O.head.line>E&&(rs(this,O.head.line,d,!0),E=O.head.line,L==this.doc.sel.primIndex&&ui(this));else{var Z=O.from(),j=O.to(),ae=Math.max(E,Z.line);E=Math.min(this.lastLine(),j.line-(j.ch?0:1))+1;for(var fe=ae;fe<E;++fe)rs(this,fe,d);var Me=this.doc.sel.ranges;Z.ch==0&&A.length==Me.length&&Me[L].from().ch>0&&Ho(this.doc,L,new Vt(Z,Me[L].to()),yt)}}}),getTokenAt:function(d,A){return ps(this,d,A)},getLineTokens:function(d,A){return ps(this,We(d),A,!0)},getTokenTypeAt:function(d){d=Pt(this.doc,d);var A=ls(this,ot(this.doc,d.line)),E=0,L=(A.length-1)/2,O=d.ch,Z;if(O==0)Z=A[2];else for(;;){var j=E+L>>1;if((j?A[j*2-1]:0)>=O)L=j;else if(A[j*2+1]<O)E=j+1;else{Z=A[j*2+2];break}}var ae=Z?Z.indexOf("overlay "):-1;return ae<0?Z:ae==0?null:Z.slice(0,ae-1)},getModeAt:function(d){var A=this.doc.mode;return A.innerMode?a.innerMode(A,this.getTokenAt(d).state).mode:A},getHelper:function(d,A){return this.getHelpers(d,A)[0]},getHelpers:function(d,A){var E=[];if(!g.hasOwnProperty(A))return E;var L=g[A],O=this.getModeAt(d);if(typeof O[A]=="string")L[O[A]]&&E.push(L[O[A]]);else if(O[A])for(var Z=0;Z<O[A].length;Z++){var j=L[O[A][Z]];j&&E.push(j)}else O.helperType&&L[O.helperType]?E.push(L[O.helperType]):L[O.name]&&E.push(L[O.name]);for(var ae=0;ae<L._global.length;ae++){var fe=L._global[ae];fe.pred(O,this)&&St(E,fe.val)==-1&&E.push(fe.val)}return E},getStateAfter:function(d,A){var E=this.doc;return d=ss(E,d??E.first+E.size-1),Tr(this,d+1,A).state},cursorCoords:function(d,A){var E,L=this.doc.sel.primary();return d==null?E=L.head:typeof d=="object"?E=Pt(this.doc,d):E=d?L.from():L.to(),Un(this,E,A||"page")},charCoords:function(d,A){return Ns(this,Pt(this.doc,d),A||"page")},coordsChar:function(d,A){return d=ia(this,d,A||"page"),Po(this,d.left,d.top)},lineAtHeight:function(d,A){return d=ia(this,{top:d,left:0},A||"page").top,rr(this.doc,d+this.display.viewOffset)},heightAtLine:function(d,A,E){var L=!1,O;if(typeof d=="number"){var Z=this.doc.first+this.doc.size-1;d<this.doc.first?d=this.doc.first:d>Z&&(d=Z,L=!0),O=ot(this.doc,d)}else O=d;return Ts(this,O,{top:0,left:0},A||"page",E||L).top+(L?this.doc.height-Mn(O):0)},defaultTextHeight:function(){return si(this.display)},defaultCharWidth:function(){return oi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(d,A,E,L,O){var Z=this.display;d=Un(this,Pt(this.doc,d));var j=d.bottom,ae=d.left;if(A.style.position="absolute",A.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(A),Z.sizer.appendChild(A),L=="over")j=d.top;else if(L=="above"||L=="near"){var fe=Math.max(Z.wrapper.clientHeight,this.doc.height),Me=Math.max(Z.sizer.clientWidth,Z.lineSpace.clientWidth);(L=="above"||d.bottom+A.offsetHeight>fe)&&d.top>A.offsetHeight?j=d.top-A.offsetHeight:d.bottom+A.offsetHeight<=fe&&(j=d.bottom),ae+A.offsetWidth>Me&&(ae=Me-A.offsetWidth)}A.style.top=j+"px",A.style.left=A.style.right="",O=="right"?(ae=Z.sizer.clientWidth-A.offsetWidth,A.style.right="0px"):(O=="left"?ae=0:O=="middle"&&(ae=(Z.sizer.clientWidth-A.offsetWidth)/2),A.style.left=ae+"px"),E&&Eu(this,{left:ae,top:j,right:ae+A.offsetWidth,bottom:j+A.offsetHeight})},triggerOnKeyDown:xn(au),triggerOnKeyPress:xn(lu),triggerOnKeyUp:uu,triggerOnMouseDown:xn(cu),execCommand:function(d){if(Qi.hasOwnProperty(d))return Qi[d].call(null,this)},triggerElectric:xn(function(d){_u(this,d)}),findPosH:function(d,A,E,L){var O=1;A<0&&(O=-1,A=-A);for(var Z=Pt(this.doc,d),j=0;j<A&&(Z=ta(this.doc,Z,O,E,L),!Z.hitSide);++j);return Z},moveH:xn(function(d,A){var E=this;this.extendSelectionsBy(function(L){return E.display.shift||E.doc.extend||L.empty()?ta(E.doc,L.head,d,A,E.options.rtlMoveVisually):d<0?L.from():L.to()},Et)}),deleteH:xn(function(d,A){var E=this.doc.sel,L=this.doc;E.somethingSelected()?L.replaceSelection("",null,"+delete"):gi(this,function(O){var Z=ta(L,O.head,d,A,!1);return d<0?{from:Z,to:O.head}:{from:O.head,to:Z}})}),findPosV:function(d,A,E,L){var O=1,Z=L;A<0&&(O=-1,A=-A);for(var j=Pt(this.doc,d),ae=0;ae<A;++ae){var fe=Un(this,j,"div");if(Z==null?Z=fe.left:fe.left=Z,j=Au(this,fe,O,E),j.hitSide)break}return j},moveV:xn(function(d,A){var E=this,L=this.doc,O=[],Z=!this.display.shift&&!L.extend&&L.sel.somethingSelected();if(L.extendSelectionsBy(function(ae){if(Z)return d<0?ae.from():ae.to();var fe=Un(E,ae.head,"div");ae.goalColumn!=null&&(fe.left=ae.goalColumn),O.push(fe.left);var Me=Au(E,fe,d,A);return A=="page"&&ae==L.sel.primary()&&Go(E,Ns(E,Me,"div").top-fe.top),Me},Et),O.length)for(var j=0;j<L.sel.ranges.length;j++)L.sel.ranges[j].goalColumn=O[j]}),findWordAt:function(d){var A=this.doc,E=ot(A,d.line).text,L=d.ch,O=d.ch;if(E){var Z=this.getHelper(d,"wordChars");(d.sticky=="before"||O==E.length)&&L?--L:++O;for(var j=E.charAt(L),ae=Ce(j,Z)?function(fe){return Ce(fe,Z)}:/\s/.test(j)?function(fe){return/\s/.test(fe)}:function(fe){return!/\s/.test(fe)&&!Ce(fe)};L>0&&ae(E.charAt(L-1));)--L;for(;O<E.length&&ae(E.charAt(O));)++O}return new Vt(We(d.line,L),We(d.line,O))},toggleOverwrite:function(d){d!=null&&d==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?ye(this.display.cursorDiv,"CodeMirror-overwrite"):we(this.display.cursorDiv,"CodeMirror-overwrite"),Qe(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==me()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:xn(function(d,A){$i(this,d,A)}),getScrollInfo:function(){var d=this.display.scroller;return{left:d.scrollLeft,top:d.scrollTop,height:d.scrollHeight-Zn(this)-this.display.barHeight,width:d.scrollWidth-Zn(this)-this.display.barWidth,clientHeight:Ri(this),clientWidth:ur(this)}},scrollIntoView:xn(function(d,A){d==null?(d={from:this.doc.sel.primary().head,to:null},A==null&&(A=this.options.cursorScrollMargin)):typeof d=="number"?d={from:We(d,0),to:null}:d.from==null&&(d={from:d,to:null}),d.to||(d.to=d.from),d.margin=A||0,d.from.line!=null?ku(this,d):da(this,d.from,d.to,d.margin)}),setSize:xn(function(d,A){var E=this,L=function(Z){return typeof Z=="number"||/^\d+$/.test(String(Z))?Z+"px":Z};d!=null&&(this.display.wrapper.style.width=L(d)),A!=null&&(this.display.wrapper.style.height=L(A)),this.options.lineWrapping&&ut(this);var O=this.display.viewFrom;this.doc.iter(O,this.display.viewTo,function(Z){if(Z.widgets){for(var j=0;j<Z.widgets.length;j++)if(Z.widgets[j].noHScroll){Mr(E,O,"widget");break}}++O}),this.curOp.forceUpdate=!0,Qe(this,"refresh",this)}),operation:function(d){return Ln(this,d)},startOperation:function(){return Wr(this)},endOperation:function(){return Xr(this)},refresh:xn(function(){var d=this.display.cachedTextHeight;Dn(this),this.curOp.forceUpdate=!0,Ht(this),$i(this,this.doc.scrollLeft,this.doc.scrollTop),$o(this.display),(d==null||Math.abs(d-si(this.display))>.5||this.options.lineWrapping)&&Fo(this),Qe(this,"refresh",this)}),swapDoc:xn(function(d){var A=this.doc;return A.cm=null,this.state.selectingText&&this.state.selectingText(),wa(this,d),Ht(this),this.display.input.reset(),$i(this,d.scrollLeft,d.scrollTop),this.curOp.forceScroll=!0,un(this,"swapDoc",this,A),A}),phrase:function(d){var A=this.options.phrases;return A&&Object.prototype.hasOwnProperty.call(A,d)?A[d]:d},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ct(a),a.registerHelper=function(d,A,E){g.hasOwnProperty(d)||(g[d]=a[d]={_global:[]}),g[d][A]=E},a.registerGlobalHelper=function(d,A,E,L){a.registerHelper(d,A,L),g[d]._global.push({pred:E,val:L})}}function ta(a,l,g,d,A){var E=l,L=g,O=ot(a,l.line),Z=A&&a.direction=="rtl"?-g:g;function j(){var Je=l.line+Z;return Je<a.first||Je>=a.first+a.size?!1:(l=new We(Je,l.ch,l.sticky),O=ot(a,Je))}function ae(Je){var Ye;if(d=="codepoint"){var et=O.text.charCodeAt(l.ch+(g>0?0:-1));if(isNaN(et))Ye=null;else{var ht=g>0?et>=55296&&et<56320:et>=56320&&et<57343;Ye=new We(l.line,Math.max(0,Math.min(O.text.length,l.ch+g*(ht?2:1))),-g)}}else A?Ye=hl(a.cm,O,l,g):Ye=jo(O,l,g);if(Ye==null)if(!Je&&j())l=Yo(A,a.cm,O,l.line,Z);else return!1;else l=Ye;return!0}if(d=="char"||d=="codepoint")ae();else if(d=="column")ae(!0);else if(d=="word"||d=="group")for(var fe=null,Me=d=="group",be=a.cm&&a.cm.getHelper(l,"wordChars"),Fe=!0;!(g<0&&!ae(!Fe));Fe=!1){var $e=O.text.charAt(l.ch)||`
`,Ze=Ce($e,be)?"w":Me&&$e==`
`?"n":!Me||/\s/.test($e)?null:"p";if(Me&&!Fe&&!Ze&&(Ze="s"),fe&&fe!=Ze){g<0&&(g=1,ae(),l.sticky="after");break}if(Ze&&(fe=Ze),g>0&&!ae(!Fe))break}var je=zs(a,l,E,L,!0);return Pi(E,je)&&(je.hitSide=!0),je}function Au(a,l,g,d){var A=a.doc,E=l.left,L;if(d=="page"){var O=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),Z=Math.max(O-.5*si(a.display),3);L=(g>0?l.bottom:l.top)+g*Z}else d=="line"&&(L=g>0?l.bottom+3:l.top-3);for(var j;j=Po(a,E,L),!!j.outside;){if(g<0?L<=0:L>=A.height){j.hitSide=!0;break}L+=g*5}return j}var Ut=function(a){this.cm=a,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new rt,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};Ut.prototype.init=function(a){var l=this,g=this,d=g.cm,A=g.div=a.lineDiv;A.contentEditable=!0,vu(A,d.options.spellcheck,d.options.autocorrect,d.options.autocapitalize);function E(O){for(var Z=O.target;Z;Z=Z.parentNode){if(Z==A)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(Z.className))break}return!1}Ue(A,"paste",function(O){!E(O)||Bt(d,O)||gu(O,d)||M<=11&&setTimeout(fn(d,function(){return l.updateFromDOM()}),20)}),Ue(A,"compositionstart",function(O){l.composing={data:O.data,done:!1}}),Ue(A,"compositionupdate",function(O){l.composing||(l.composing={data:O.data,done:!1})}),Ue(A,"compositionend",function(O){l.composing&&(O.data!=l.composing.data&&l.readFromDOMSoon(),l.composing.done=!0)}),Ue(A,"touchstart",function(){return g.forceCompositionEnd()}),Ue(A,"input",function(){l.composing||l.readFromDOMSoon()});function L(O){if(!(!E(O)||Bt(d,O))){if(d.somethingSelected())qs({lineWise:!1,text:d.getSelections()}),O.type=="cut"&&d.replaceSelection("",null,"cut");else if(d.options.lineWiseCopyCut){var Z=yu(d);qs({lineWise:!0,text:Z.text}),O.type=="cut"&&d.operation(function(){d.setSelections(Z.ranges,0,yt),d.replaceSelection("",null,"cut")})}else return;if(O.clipboardData){O.clipboardData.clearData();var j=Yn.text.join(`
`);if(O.clipboardData.setData("Text",j),O.clipboardData.getData("Text")==j){O.preventDefault();return}}var ae=bu(),fe=ae.firstChild;d.display.lineSpace.insertBefore(ae,d.display.lineSpace.firstChild),fe.value=Yn.text.join(`
`);var Me=me();qe(fe),setTimeout(function(){d.display.lineSpace.removeChild(ae),Me.focus(),Me==A&&g.showPrimarySelection()},50)}}Ue(A,"copy",L),Ue(A,"cut",L)},Ut.prototype.screenReaderLabelChanged=function(a){a?this.div.setAttribute("aria-label",a):this.div.removeAttribute("aria-label")},Ut.prototype.prepareSelection=function(){var a=ca(this.cm,!1);return a.focus=me()==this.div,a},Ut.prototype.showSelection=function(a,l){!a||!this.cm.display.view.length||((a.focus||l)&&this.showPrimarySelection(),this.showMultipleSelections(a))},Ut.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Ut.prototype.showPrimarySelection=function(){var a=this.getSelection(),l=this.cm,g=l.doc.sel.primary(),d=g.from(),A=g.to();if(l.display.viewTo==l.display.viewFrom||d.line>=l.display.viewTo||A.line<l.display.viewFrom){a.removeAllRanges();return}var E=Js(l,a.anchorNode,a.anchorOffset),L=Js(l,a.focusNode,a.focusOffset);if(!(E&&!E.bad&&L&&!L.bad&&xt(jr(E,L),d)==0&&xt(Ur(E,L),A)==0)){var O=l.display.view,Z=d.line>=l.display.viewFrom&&Cu(l,d)||{node:O[0].measure.map[2],offset:0},j=A.line<l.display.viewTo&&Cu(l,A);if(!j){var ae=O[O.length-1].measure,fe=ae.maps?ae.maps[ae.maps.length-1]:ae.map;j={node:fe[fe.length-1],offset:fe[fe.length-2]-fe[fe.length-3]}}if(!Z||!j){a.removeAllRanges();return}var Me=a.rangeCount&&a.getRangeAt(0),be;try{be=Xe(Z.node,Z.offset,j.offset,j.node)}catch{}be&&(!o&&l.state.focused?(a.collapse(Z.node,Z.offset),be.collapsed||(a.removeAllRanges(),a.addRange(be))):(a.removeAllRanges(),a.addRange(be)),Me&&a.anchorNode==null?a.addRange(Me):o&&this.startGracePeriod()),this.rememberSelection()}},Ut.prototype.startGracePeriod=function(){var a=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){a.gracePeriod=!1,a.selectionChanged()&&a.cm.operation(function(){return a.cm.curOp.selectionChanged=!0})},20)},Ut.prototype.showMultipleSelections=function(a){Oe(this.cm.display.cursorDiv,a.cursors),Oe(this.cm.display.selectionDiv,a.selection)},Ut.prototype.rememberSelection=function(){var a=this.getSelection();this.lastAnchorNode=a.anchorNode,this.lastAnchorOffset=a.anchorOffset,this.lastFocusNode=a.focusNode,this.lastFocusOffset=a.focusOffset},Ut.prototype.selectionInEditor=function(){var a=this.getSelection();if(!a.rangeCount)return!1;var l=a.getRangeAt(0).commonAncestorContainer;return Ke(this.div,l)},Ut.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||me()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},Ut.prototype.blur=function(){this.div.blur()},Ut.prototype.getField=function(){return this.div},Ut.prototype.supportsTouch=function(){return!0},Ut.prototype.receivedFocus=function(){var a=this,l=this;this.selectionInEditor()?setTimeout(function(){return a.pollSelection()},20):Ln(this.cm,function(){return l.cm.curOp.selectionChanged=!0});function g(){l.cm.state.focused&&(l.pollSelection(),l.polling.set(l.cm.options.pollInterval,g))}this.polling.set(this.cm.options.pollInterval,g)},Ut.prototype.selectionChanged=function(){var a=this.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset},Ut.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var a=this.getSelection(),l=this.cm;if(z&&k&&this.cm.display.gutterSpecs.length&&Ll(a.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var g=Js(l,a.anchorNode,a.anchorOffset),d=Js(l,a.focusNode,a.focusOffset);g&&d&&Ln(l,function(){vn(l.doc,Pr(g,d),yt),(g.bad||d.bad)&&(l.curOp.selectionChanged=!0)})}}},Ut.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var a=this.cm,l=a.display,g=a.doc.sel.primary(),d=g.from(),A=g.to();if(d.ch==0&&d.line>a.firstLine()&&(d=We(d.line-1,ot(a.doc,d.line-1).length)),A.ch==ot(a.doc,A.line).text.length&&A.line<a.lastLine()&&(A=We(A.line+1,0)),d.line<l.viewFrom||A.line>l.viewTo-1)return!1;var E,L,O;d.line==l.viewFrom||(E=$r(a,d.line))==0?(L=Xt(l.view[0].line),O=l.view[0].node):(L=Xt(l.view[E].line),O=l.view[E-1].node.nextSibling);var Z=$r(a,A.line),j,ae;if(Z==l.view.length-1?(j=l.viewTo-1,ae=l.lineDiv.lastChild):(j=Xt(l.view[Z+1].line)-1,ae=l.view[Z+1].node.previousSibling),!O)return!1;for(var fe=a.doc.splitLines(Gl(a,O,ae,L,j)),Me=nr(a.doc,We(L,0),We(j,ot(a.doc,j).text.length));fe.length>1&&Me.length>1;)if(_t(fe)==_t(Me))fe.pop(),Me.pop(),j--;else if(fe[0]==Me[0])fe.shift(),Me.shift(),L++;else break;for(var be=0,Fe=0,$e=fe[0],Ze=Me[0],je=Math.min($e.length,Ze.length);be<je&&$e.charCodeAt(be)==Ze.charCodeAt(be);)++be;for(var Je=_t(fe),Ye=_t(Me),et=Math.min(Je.length-(fe.length==1?be:0),Ye.length-(Me.length==1?be:0));Fe<et&&Je.charCodeAt(Je.length-Fe-1)==Ye.charCodeAt(Ye.length-Fe-1);)++Fe;if(fe.length==1&&Me.length==1&&L==d.line)for(;be&&be>d.ch&&Je.charCodeAt(Je.length-Fe-1)==Ye.charCodeAt(Ye.length-Fe-1);)be--,Fe++;fe[fe.length-1]=Je.slice(0,Je.length-Fe).replace(/^\u200b+/,""),fe[0]=fe[0].slice(be).replace(/\u200b+$/,"");var ht=We(L,be),ct=We(j,Me.length?_t(Me).length-Fe:0);if(fe.length>1||fe[0]||xt(ht,ct))return di(a.doc,fe,ht,ct,"+input"),!0},Ut.prototype.ensurePolled=function(){this.forceCompositionEnd()},Ut.prototype.reset=function(){this.forceCompositionEnd()},Ut.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Ut.prototype.readFromDOMSoon=function(){var a=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(a.readDOMTimeout=null,a.composing)if(a.composing.done)a.composing=null;else return;a.updateFromDOM()},80))},Ut.prototype.updateFromDOM=function(){var a=this;(this.cm.isReadOnly()||!this.pollContent())&&Ln(this.cm,function(){return Dn(a.cm)})},Ut.prototype.setUneditable=function(a){a.contentEditable="false"},Ut.prototype.onKeyPress=function(a){a.charCode==0||this.composing||(a.preventDefault(),this.cm.isReadOnly()||fn(this.cm,ea)(this.cm,String.fromCharCode(a.charCode==null?a.keyCode:a.charCode),0))},Ut.prototype.readOnlyChanged=function(a){this.div.contentEditable=String(a!="nocursor")},Ut.prototype.onContextMenu=function(){},Ut.prototype.resetPosition=function(){},Ut.prototype.needsContentAttribute=!0;function Cu(a,l){var g=Ar(a,l.line);if(!g||g.hidden)return null;var d=ot(a.doc,l.line),A=Es(g,d,l.line),E=Gt(d,a.doc.direction),L="left";if(E){var O=He(E,l.ch);L=O%2?"right":"left"}var Z=ii(A.map,l.ch,L);return Z.offset=Z.collapse=="right"?Z.end:Z.start,Z}function Ll(a){for(var l=a;l;l=l.parentNode)if(/CodeMirror-gutter-wrapper/.test(l.className))return!0;return!1}function yi(a,l){return l&&(a.bad=!0),a}function Gl(a,l,g,d,A){var E="",L=!1,O=a.doc.lineSeparator(),Z=!1;function j(be){return function(Fe){return Fe.id==be}}function ae(){L&&(E+=O,Z&&(E+=O),L=Z=!1)}function fe(be){be&&(ae(),E+=be)}function Me(be){if(be.nodeType==1){var Fe=be.getAttribute("cm-text");if(Fe){fe(Fe);return}var $e=be.getAttribute("cm-marker"),Ze;if($e){var je=a.findMarks(We(d,0),We(A+1,0),j(+$e));je.length&&(Ze=je[0].find(0))&&fe(nr(a.doc,Ze.from,Ze.to).join(O));return}if(be.getAttribute("contenteditable")=="false")return;var Je=/^(pre|div|p|li|table|br)$/i.test(be.nodeName);if(!/^br$/i.test(be.nodeName)&&be.textContent.length==0)return;Je&&ae();for(var Ye=0;Ye<be.childNodes.length;Ye++)Me(be.childNodes[Ye]);/^(pre|p)$/i.test(be.nodeName)&&(Z=!0),Je&&(L=!0)}else be.nodeType==3&&fe(be.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;Me(l),l!=g;)l=l.nextSibling,Z=!1;return E}function Js(a,l,g){var d;if(l==a.display.lineDiv){if(d=a.display.lineDiv.childNodes[g],!d)return yi(a.clipPos(We(a.display.viewTo-1)),!0);l=null,g=0}else for(d=l;;d=d.parentNode){if(!d||d==a.display.lineDiv)return null;if(d.parentNode&&d.parentNode==a.display.lineDiv)break}for(var A=0;A<a.display.view.length;A++){var E=a.display.view[A];if(E.node==d)return Rl(E,l,g)}}function Rl(a,l,g){var d=a.text.firstChild,A=!1;if(!l||!Ke(d,l))return yi(We(Xt(a.line),0),!0);if(l==d&&(A=!0,l=d.childNodes[g],g=0,!l)){var E=a.rest?_t(a.rest):a.line;return yi(We(Xt(E),E.text.length),A)}var L=l.nodeType==3?l:null,O=l;for(!L&&l.childNodes.length==1&&l.firstChild.nodeType==3&&(L=l.firstChild,g&&(g=L.nodeValue.length));O.parentNode!=d;)O=O.parentNode;var Z=a.measure,j=Z.maps;function ae(Ze,je,Je){for(var Ye=-1;Ye<(j?j.length:0);Ye++)for(var et=Ye<0?Z.map:j[Ye],ht=0;ht<et.length;ht+=3){var ct=et[ht+2];if(ct==Ze||ct==je){var Tt=Xt(Ye<0?a.line:a.rest[Ye]),Yt=et[ht]+Je;return(Je<0||ct!=Ze)&&(Yt=et[ht+(Je?1:0)]),We(Tt,Yt)}}}var fe=ae(L,O,g);if(fe)return yi(fe,A);for(var Me=O.nextSibling,be=L?L.nodeValue.length-g:0;Me;Me=Me.nextSibling){if(fe=ae(Me,Me.firstChild,0),fe)return yi(We(fe.line,fe.ch-be),A);be+=Me.textContent.length}for(var Fe=O.previousSibling,$e=g;Fe;Fe=Fe.previousSibling){if(fe=ae(Fe,Fe.firstChild,-1),fe)return yi(We(fe.line,fe.ch+$e),A);$e+=Fe.textContent.length}}var rn=function(a){this.cm=a,this.prevInput="",this.pollingFast=!1,this.polling=new rt,this.hasSelection=!1,this.composing=null};rn.prototype.init=function(a){var l=this,g=this,d=this.cm;this.createField(a);var A=this.textarea;a.wrapper.insertBefore(this.wrapper,a.wrapper.firstChild),V&&(A.style.width="0px"),Ue(A,"input",function(){b&&M>=9&&l.hasSelection&&(l.hasSelection=null),g.poll()}),Ue(A,"paste",function(L){Bt(d,L)||gu(L,d)||(d.state.pasteIncoming=+new Date,g.fastPoll())});function E(L){if(!Bt(d,L)){if(d.somethingSelected())qs({lineWise:!1,text:d.getSelections()});else if(d.options.lineWiseCopyCut){var O=yu(d);qs({lineWise:!0,text:O.text}),L.type=="cut"?d.setSelections(O.ranges,null,yt):(g.prevInput="",A.value=O.text.join(`
`),qe(A))}else return;L.type=="cut"&&(d.state.cutIncoming=+new Date)}}Ue(A,"cut",E),Ue(A,"copy",E),Ue(a.scroller,"paste",function(L){if(!(Hn(a,L)||Bt(d,L))){if(!A.dispatchEvent){d.state.pasteIncoming=+new Date,g.focus();return}var O=new Event("paste");O.clipboardData=L.clipboardData,A.dispatchEvent(O)}}),Ue(a.lineSpace,"selectstart",function(L){Hn(a,L)||Mt(L)}),Ue(A,"compositionstart",function(){var L=d.getCursor("from");g.composing&&g.composing.range.clear(),g.composing={start:L,range:d.markText(L,d.getCursor("to"),{className:"CodeMirror-composing"})}}),Ue(A,"compositionend",function(){g.composing&&(g.poll(),g.composing.range.clear(),g.composing=null)})},rn.prototype.createField=function(a){this.wrapper=bu(),this.textarea=this.wrapper.firstChild},rn.prototype.screenReaderLabelChanged=function(a){a?this.textarea.setAttribute("aria-label",a):this.textarea.removeAttribute("aria-label")},rn.prototype.prepareSelection=function(){var a=this.cm,l=a.display,g=a.doc,d=ca(a);if(a.options.moveInputWithCursor){var A=Un(a,g.sel.primary().head,"div"),E=l.wrapper.getBoundingClientRect(),L=l.lineDiv.getBoundingClientRect();d.teTop=Math.max(0,Math.min(l.wrapper.clientHeight-10,A.top+L.top-E.top)),d.teLeft=Math.max(0,Math.min(l.wrapper.clientWidth-10,A.left+L.left-E.left))}return d},rn.prototype.showSelection=function(a){var l=this.cm,g=l.display;Oe(g.cursorDiv,a.cursors),Oe(g.selectionDiv,a.selection),a.teTop!=null&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")},rn.prototype.reset=function(a){if(!(this.contextMenuPending||this.composing)){var l=this.cm;if(l.somethingSelected()){this.prevInput="";var g=l.getSelection();this.textarea.value=g,l.state.focused&&qe(this.textarea),b&&M>=9&&(this.hasSelection=g)}else a||(this.prevInput=this.textarea.value="",b&&M>=9&&(this.hasSelection=null))}},rn.prototype.getField=function(){return this.textarea},rn.prototype.supportsTouch=function(){return!1},rn.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!K||me()!=this.textarea))try{this.textarea.focus()}catch{}},rn.prototype.blur=function(){this.textarea.blur()},rn.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},rn.prototype.receivedFocus=function(){this.slowPoll()},rn.prototype.slowPoll=function(){var a=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){a.poll(),a.cm.state.focused&&a.slowPoll()})},rn.prototype.fastPoll=function(){var a=!1,l=this;l.pollingFast=!0;function g(){var d=l.poll();!d&&!a?(a=!0,l.polling.set(60,g)):(l.pollingFast=!1,l.slowPoll())}l.polling.set(20,g)},rn.prototype.poll=function(){var a=this,l=this.cm,g=this.textarea,d=this.prevInput;if(this.contextMenuPending||!l.state.focused||Ve(g)&&!d&&!this.composing||l.isReadOnly()||l.options.disableInput||l.state.keySeq)return!1;var A=g.value;if(A==d&&!l.somethingSelected())return!1;if(b&&M>=9&&this.hasSelection===A||ie&&/[\uf700-\uf7ff]/.test(A))return l.display.input.reset(),!1;if(l.doc.sel==l.display.selForContextMenu){var E=A.charCodeAt(0);if(E==8203&&!d&&(d="​"),E==8666)return this.reset(),this.cm.execCommand("undo")}for(var L=0,O=Math.min(d.length,A.length);L<O&&d.charCodeAt(L)==A.charCodeAt(L);)++L;return Ln(l,function(){ea(l,A.slice(L),d.length-L,null,a.composing?"*compose":null),A.length>1e3||A.indexOf(`
`)>-1?g.value=a.prevInput="":a.prevInput=A,a.composing&&(a.composing.range.clear(),a.composing.range=l.markText(a.composing.start,l.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},rn.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},rn.prototype.onKeyPress=function(){b&&M>=9&&(this.hasSelection=null),this.fastPoll()},rn.prototype.onContextMenu=function(a){var l=this,g=l.cm,d=g.display,A=l.textarea;l.contextMenuPending&&l.contextMenuPending();var E=Br(g,a),L=d.scroller.scrollTop;if(!E||N)return;var O=g.options.resetSelectionOnContextMenu;O&&g.doc.sel.contains(E)==-1&&fn(g,vn)(g.doc,Pr(E),yt);var Z=A.style.cssText,j=l.wrapper.style.cssText,ae=l.wrapper.offsetParent.getBoundingClientRect();l.wrapper.style.cssText="position: static",A.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(a.clientY-ae.top-5)+"px; left: "+(a.clientX-ae.left-5)+`px;
      z-index: 1000; background: `+(b?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var fe;F&&(fe=window.scrollY),d.input.focus(),F&&window.scrollTo(null,fe),d.input.reset(),g.somethingSelected()||(A.value=l.prevInput=" "),l.contextMenuPending=be,d.selForContextMenu=g.doc.sel,clearTimeout(d.detectingSelectAll);function Me(){if(A.selectionStart!=null){var $e=g.somethingSelected(),Ze="​"+($e?A.value:"");A.value="⇚",A.value=Ze,l.prevInput=$e?"":"​",A.selectionStart=1,A.selectionEnd=Ze.length,d.selForContextMenu=g.doc.sel}}function be(){if(l.contextMenuPending==be&&(l.contextMenuPending=!1,l.wrapper.style.cssText=j,A.style.cssText=Z,b&&M<9&&d.scrollbars.setScrollTop(d.scroller.scrollTop=L),A.selectionStart!=null)){(!b||b&&M<9)&&Me();var $e=0,Ze=function(){d.selForContextMenu==g.doc.sel&&A.selectionStart==0&&A.selectionEnd>0&&l.prevInput=="​"?fn(g,Oa)(g):$e++<10?d.detectingSelectAll=setTimeout(Ze,500):(d.selForContextMenu=null,d.input.reset())};d.detectingSelectAll=setTimeout(Ze,200)}}if(b&&M>=9&&Me(),_e){an(a);var Fe=function(){It(window,"mouseup",Fe),setTimeout(be,20)};Ue(window,"mouseup",Fe)}else setTimeout(be,50)},rn.prototype.readOnlyChanged=function(a){a||this.reset(),this.textarea.disabled=a=="nocursor",this.textarea.readOnly=!!a},rn.prototype.setUneditable=function(){},rn.prototype.needsContentAttribute=!1;function Bl(a,l){if(l=l?mt(l):{},l.value=a.value,!l.tabindex&&a.tabIndex&&(l.tabindex=a.tabIndex),!l.placeholder&&a.placeholder&&(l.placeholder=a.placeholder),l.autofocus==null){var g=me();l.autofocus=g==a||a.getAttribute("autofocus")!=null&&g==document.body}function d(){a.value=O.getValue()}var A;if(a.form&&(Ue(a.form,"submit",d),!l.leaveSubmitMethodAlone)){var E=a.form;A=E.submit;try{var L=E.submit=function(){d(),E.submit=A,E.submit(),E.submit=L}}catch{}}l.finishInit=function(Z){Z.save=d,Z.getTextArea=function(){return a},Z.toTextArea=function(){Z.toTextArea=isNaN,d(),a.parentNode.removeChild(Z.getWrapperElement()),a.style.display="",a.form&&(It(a.form,"submit",d),!l.leaveSubmitMethodAlone&&typeof a.form.submit=="function"&&(a.form.submit=A))}},a.style.display="none";var O=qt(function(Z){return a.parentNode.insertBefore(Z,a.nextSibling)},l);return O}function $l(a){a.off=It,a.on=Ue,a.wheelEventPixels=zu,a.Doc=Fn,a.splitLines=Be,a.countColumn=Ee,a.findColumn=Kt,a.isWordChar=Ae,a.Pass=bt,a.signal=Qe,a.Line=$n,a.changeEnd=Sr,a.scrollbarModel=ga,a.Pos=We,a.cmpPos=xt,a.modes=Rn,a.mimeModes=Sn,a.resolveMode=yn,a.getMode=Ai,a.modeExtensions=hr,a.extendMode=eo,a.copyState=er,a.startState=is,a.innerMode=Ci,a.commands=Qi,a.keyMap=fr,a.keyName=nu,a.isModifierKey=eu,a.lookupKey=mi,a.normalizeKeyMap=dl,a.StringStream=en,a.SharedTextMarker=Ki,a.TextMarker=Dr,a.LineWidget=Yi,a.e_preventDefault=Mt,a.e_stopPropagation=Zt,a.e_stop=an,a.addClass=ye,a.contains=Ke,a.rmClass=we,a.keyNames=Fr}Fl(qt),Nl(qt);var Il="iter insert remove copy getEditor constructor".split(" ");for(var Qs in Fn.prototype)Fn.prototype.hasOwnProperty(Qs)&&St(Il,Qs)<0&&(qt.prototype[Qs]=(function(a){return function(){return a.apply(this.doc,arguments)}})(Fn.prototype[Qs]));return Ct(Fn),qt.inputStyles={textarea:rn,contenteditable:Ut},qt.defineMode=function(a){!qt.defaults.mode&&a!="null"&&(qt.defaults.mode=a),zr.apply(this,arguments)},qt.defineMIME=Hr,qt.defineMode("null",function(){return{token:function(a){return a.skipToEnd()}}}),qt.defineMIME("text/plain","null"),qt.defineExtension=function(a,l){qt.prototype[a]=l},qt.defineDocExtension=function(a,l){Fn.prototype[a]=l},qt.fromTextArea=Bl,$l(qt),qt.version="5.65.4",qt})),(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){function t(me,ye,Se,qe,st,mt){this.indented=me,this.column=ye,this.type=Se,this.info=qe,this.align=st,this.prev=mt}function o(me,ye,Se,qe){var st=me.indented;return me.context&&me.context.type=="statement"&&Se!="statement"&&(st=me.context.indented),me.context=new t(st,ye,Se,qe,null,me.context)}function u(me){var ye=me.context.type;return(ye==")"||ye=="]"||ye=="}")&&(me.indented=me.context.indented),me.context=me.context.prev}function p(me,ye,Se){if(ye.prevToken=="variable"||ye.prevToken=="type"||/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(me.string.slice(0,Se))||ye.typeAtEndOfLine&&me.column()==me.indentation())return!0}function f(me){for(;;){if(!me||me.type=="top")return!0;if(me.type=="}"&&me.prev.info!="namespace")return!1;me=me.prev}}e.defineMode("clike",function(me,ye){var Se=me.indentUnit,qe=ye.statementIndentUnit||Se,st=ye.dontAlignCalls,mt=ye.keywords||{},Ee=ye.types||{},rt=ye.builtin||{},St=ye.blockKeywords||{},pt=ye.defKeywords||{},bt=ye.atoms||{},yt=ye.hooks||{},At=ye.multiLineStrings,Et=ye.indentStatements!==!1,Kt=ye.indentSwitch!==!1,jt=ye.namespaceSeparator,Nt=ye.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,_t=ye.numberStart||/[\d\.]/,$t=ye.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,sn=ye.isOperatorChar||/[+\-*&%=<>!?|\/]/,kt=ye.isIdentifierChar||/[\w\$_\xa1-\uffff]/,Ot=ye.isReservedIdentifier||!1,Wt,Ae;function Ce(Ne,De){var Ie=Ne.next();if(yt[Ie]){var Ge=yt[Ie](Ne,De);if(Ge!==!1)return Ge}if(Ie=='"'||Ie=="'")return De.tokenize=ge(Ie),De.tokenize(Ne,De);if(_t.test(Ie)){if(Ne.backUp(1),Ne.match($t))return"number";Ne.next()}if(Nt.test(Ie))return Wt=Ie,null;if(Ie=="/"){if(Ne.eat("*"))return De.tokenize=Te,Te(Ne,De);if(Ne.eat("/"))return Ne.skipToEnd(),"comment"}if(sn.test(Ie)){for(;!Ne.match(/^\/[\/*]/,!1)&&Ne.eat(sn););return"operator"}if(Ne.eatWhile(kt),jt)for(;Ne.match(jt);)Ne.eatWhile(kt);var He=Ne.current();return M(mt,He)?(M(St,He)&&(Wt="newstatement"),M(pt,He)&&(Ae=!0),"keyword"):M(Ee,He)?"type":M(rt,He)||Ot&&Ot(He)?(M(St,He)&&(Wt="newstatement"),"builtin"):M(bt,He)?"atom":"variable"}function ge(Ne){return function(De,Ie){for(var Ge=!1,He,it=!1;(He=De.next())!=null;){if(He==Ne&&!Ge){it=!0;break}Ge=!Ge&&He=="\\"}return(it||!(Ge||At))&&(Ie.tokenize=null),"string"}}function Te(Ne,De){for(var Ie=!1,Ge;Ge=Ne.next();){if(Ge=="/"&&Ie){De.tokenize=null;break}Ie=Ge=="*"}return"comment"}function ze(Ne,De){ye.typeFirstDefinitions&&Ne.eol()&&f(De.context)&&(De.typeAtEndOfLine=p(Ne,De,Ne.pos))}return{startState:function(Ne){return{tokenize:null,context:new t((Ne||0)-Se,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(Ne,De){var Ie=De.context;if(Ne.sol()&&(Ie.align==null&&(Ie.align=!1),De.indented=Ne.indentation(),De.startOfLine=!0),Ne.eatSpace())return ze(Ne,De),null;Wt=Ae=null;var Ge=(De.tokenize||Ce)(Ne,De);if(Ge=="comment"||Ge=="meta")return Ge;if(Ie.align==null&&(Ie.align=!0),Wt==";"||Wt==":"||Wt==","&&Ne.match(/^\s*(?:\/\/.*)?$/,!1))for(;De.context.type=="statement";)u(De);else if(Wt=="{")o(De,Ne.column(),"}");else if(Wt=="[")o(De,Ne.column(),"]");else if(Wt=="(")o(De,Ne.column(),")");else if(Wt=="}"){for(;Ie.type=="statement";)Ie=u(De);for(Ie.type=="}"&&(Ie=u(De));Ie.type=="statement";)Ie=u(De)}else Wt==Ie.type?u(De):Et&&((Ie.type=="}"||Ie.type=="top")&&Wt!=";"||Ie.type=="statement"&&Wt=="newstatement")&&o(De,Ne.column(),"statement",Ne.current());if(Ge=="variable"&&(De.prevToken=="def"||ye.typeFirstDefinitions&&p(Ne,De,Ne.start)&&f(De.context)&&Ne.match(/^\s*\(/,!1))&&(Ge="def"),yt.token){var He=yt.token(Ne,De,Ge);He!==void 0&&(Ge=He)}return Ge=="def"&&ye.styleDefs===!1&&(Ge="variable"),De.startOfLine=!1,De.prevToken=Ae?"def":Ge||Wt,ze(Ne,De),Ge},indent:function(Ne,De){if(Ne.tokenize!=Ce&&Ne.tokenize!=null||Ne.typeAtEndOfLine)return e.Pass;var Ie=Ne.context,Ge=De&&De.charAt(0),He=Ge==Ie.type;if(Ie.type=="statement"&&Ge=="}"&&(Ie=Ie.prev),ye.dontIndentStatements)for(;Ie.type=="statement"&&ye.dontIndentStatements.test(Ie.info);)Ie=Ie.prev;if(yt.indent){var it=yt.indent(Ne,Ie,De,Se);if(typeof it=="number")return it}var Gt=Ie.prev&&Ie.prev.info=="switch";if(ye.allmanIndentation&&/[{(]/.test(Ge)){for(;Ie.type!="top"&&Ie.type!="}";)Ie=Ie.prev;return Ie.indented}return Ie.type=="statement"?Ie.indented+(Ge=="{"?0:qe):Ie.align&&(!st||Ie.type!=")")?Ie.column+(He?0:1):Ie.type==")"&&!He?Ie.indented+qe:Ie.indented+(He?0:Se)+(!He&&Gt&&!/^(?:case|default)\b/.test(De)?Se:0)},electricInput:Kt?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:"//",fold:"brace"}});function b(me){for(var ye={},Se=me.split(" "),qe=0;qe<Se.length;++qe)ye[Se[qe]]=!0;return ye}function M(me,ye){return typeof me=="function"?me(ye):me.propertyIsEnumerable(ye)}var F="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile inline restrict asm fortran",S="alignas alignof and and_eq audit axiom bitand bitor catch class compl concept constexpr const_cast decltype delete dynamic_cast explicit export final friend import module mutable namespace new noexcept not not_eq operator or or_eq override private protected public reinterpret_cast requires static_assert static_cast template this thread_local throw try typeid typename using virtual xor xor_eq",k="bycopy byref in inout oneway out self super atomic nonatomic retain copy readwrite readonly strong weak assign typeof nullable nonnull null_resettable _cmd @interface @implementation @end @protocol @encode @property @synthesize @dynamic @class @public @package @private @protected @required @optional @try @catch @finally @import @selector @encode @defs @synchronized @autoreleasepool @compatibility_alias @available",N="FOUNDATION_EXPORT FOUNDATION_EXTERN NS_INLINE NS_FORMAT_FUNCTION  NS_RETURNS_RETAINEDNS_ERROR_ENUM NS_RETURNS_NOT_RETAINED NS_RETURNS_INNER_POINTER NS_DESIGNATED_INITIALIZER NS_ENUM NS_OPTIONS NS_REQUIRES_NIL_TERMINATION NS_ASSUME_NONNULL_BEGIN NS_ASSUME_NONNULL_END NS_SWIFT_NAME NS_REFINED_FOR_SWIFT",$=b("int long char short double float unsigned signed void bool"),R=b("SEL instancetype id Class Protocol BOOL");function U(me){return M($,me)||/.+_t$/.test(me)}function V(me){return U(me)||M(R,me)}var z="case do else for if switch while struct enum union",K="struct enum union";function ie(me,ye){if(!ye.startOfLine)return!1;for(var Se,qe=null;Se=me.peek();){if(Se=="\\"&&me.match(/^.$/)){qe=ie;break}else if(Se=="/"&&me.match(/^\/[\/\*]/,!1))break;me.next()}return ye.tokenize=qe,"meta"}function he(me,ye){return ye.prevToken=="type"?"type":!1}function se(me){return!me||me.length<2||me[0]!="_"?!1:me[1]=="_"||me[1]!==me[1].toLowerCase()}function ee(me){return me.eatWhile(/[\w\.']/),"number"}function pe(me,ye){if(me.backUp(1),me.match(/^(?:R|u8R|uR|UR|LR)/)){var Se=me.match(/^"([^\s\\()]{0,16})\(/);return Se?(ye.cpp11RawStringDelim=Se[1],ye.tokenize=we,we(me,ye)):!1}return me.match(/^(?:u8|u|U|L)/)?me.match(/^["']/,!1)?"string":!1:(me.next(),!1)}function _e(me){var ye=/(\w+)::~?(\w+)$/.exec(me);return ye&&ye[1]==ye[2]}function ve(me,ye){for(var Se;(Se=me.next())!=null;)if(Se=='"'&&!me.eat('"')){ye.tokenize=null;break}return"string"}function we(me,ye){var Se=ye.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),qe=me.match(new RegExp(".*?\\)"+Se+'"'));return qe?ye.tokenize=null:me.skipToEnd(),"string"}function xe(me,ye){typeof me=="string"&&(me=[me]);var Se=[];function qe(mt){if(mt)for(var Ee in mt)mt.hasOwnProperty(Ee)&&Se.push(Ee)}qe(ye.keywords),qe(ye.types),qe(ye.builtin),qe(ye.atoms),Se.length&&(ye.helperType=me[0],e.registerHelper("hintWords",me[0],Se));for(var st=0;st<me.length;++st)e.defineMIME(me[st],ye)}xe(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:b(F),types:U,blockKeywords:b(z),defKeywords:b(K),typeFirstDefinitions:!0,atoms:b("NULL true false"),isReservedIdentifier:se,hooks:{"#":ie,"*":he},modeProps:{fold:["brace","include"]}}),xe(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:b(F+" "+S),types:U,blockKeywords:b(z+" class try catch"),defKeywords:b(K+" class namespace"),typeFirstDefinitions:!0,atoms:b("true false NULL nullptr"),dontIndentStatements:/^template$/,isIdentifierChar:/[\w\$_~\xa1-\uffff]/,isReservedIdentifier:se,hooks:{"#":ie,"*":he,u:pe,U:pe,L:pe,R:pe,0:ee,1:ee,2:ee,3:ee,4:ee,5:ee,6:ee,7:ee,8:ee,9:ee,token:function(me,ye,Se){if(Se=="variable"&&me.peek()=="("&&(ye.prevToken==";"||ye.prevToken==null||ye.prevToken=="}")&&_e(me.current()))return"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),xe("text/x-java",{name:"clike",keywords:b("abstract assert break case catch class const continue default do else enum extends final finally for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while @interface"),types:b("var byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:b("catch class do else finally for if switch try while"),defKeywords:b("class interface enum @interface"),typeFirstDefinitions:!0,atoms:b("true false null"),number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+\.?\d*|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,hooks:{"@":function(me){return me.match("interface",!1)?!1:(me.eatWhile(/[\w\$_]/),"meta")},'"':function(me,ye){return me.match(/""$/)?(ye.tokenize=Oe,ye.tokenize(me,ye)):!1}},modeProps:{fold:["brace","import"]}}),xe("text/x-csharp",{name:"clike",keywords:b("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:b("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:b("catch class do else finally for foreach if struct switch try while"),defKeywords:b("class interface namespace struct var"),typeFirstDefinitions:!0,atoms:b("true false null"),hooks:{"@":function(me,ye){return me.eat('"')?(ye.tokenize=ve,ve(me,ye)):(me.eatWhile(/[\w\$_]/),"meta")}}});function Oe(me,ye){for(var Se=!1;!me.eol();){if(!Se&&me.match('"""')){ye.tokenize=null;break}Se=me.next()=="\\"&&!Se}return"string"}function Pe(me){return function(ye,Se){for(var qe;qe=ye.next();)if(qe=="*"&&ye.eat("/"))if(me==1){Se.tokenize=null;break}else return Se.tokenize=Pe(me-1),Se.tokenize(ye,Se);else if(qe=="/"&&ye.eat("*"))return Se.tokenize=Pe(me+1),Se.tokenize(ye,Se);return"comment"}}xe("text/x-scala",{name:"clike",keywords:b("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble"),types:b("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:b("catch class enum do else finally for forSome if match switch try while"),defKeywords:b("class enum def object package trait type val var"),atoms:b("true false null"),indentStatements:!1,indentSwitch:!1,isOperatorChar:/[+\-*&%=<>!?|\/#:@]/,hooks:{"@":function(me){return me.eatWhile(/[\w\$_]/),"meta"},'"':function(me,ye){return me.match('""')?(ye.tokenize=Oe,ye.tokenize(me,ye)):!1},"'":function(me){return me.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},"=":function(me,ye){var Se=ye.context;return Se.type=="}"&&Se.align&&me.eat(">")?(ye.context=new t(Se.indented,Se.column,Se.type,Se.info,null,Se.prev),"operator"):!1},"/":function(me,ye){return me.eat("*")?(ye.tokenize=Pe(1),ye.tokenize(me,ye)):!1}},modeProps:{closeBrackets:{pairs:'()[]{}""',triples:'"'}}});function Le(me){return function(ye,Se){for(var qe=!1,st,mt=!1;!ye.eol();){if(!me&&!qe&&ye.match('"')){mt=!0;break}if(me&&ye.match('"""')){mt=!0;break}st=ye.next(),!qe&&st=="$"&&ye.match("{")&&ye.skipTo("}"),qe=!qe&&st=="\\"&&!me}return(mt||!me)&&(Se.tokenize=null),"string"}}xe("text/x-kotlin",{name:"clike",keywords:b("package as typealias class interface this super val operator var fun for is in This throw return annotation break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix suspend actual expect setparam value"),types:b("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void Annotation Any BooleanArray ByteArray Char CharArray DeprecationLevel DoubleArray Enum FloatArray Function Int IntArray Lazy LazyThreadSafetyMode LongArray Nothing ShortArray Unit"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+(\.\d+)?|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,blockKeywords:b("catch class do else finally for if where try while enum"),defKeywords:b("class val var object interface fun"),atoms:b("true false null this"),hooks:{"@":function(me){return me.eatWhile(/[\w\$_]/),"meta"},"*":function(me,ye){return ye.prevToken=="."?"variable":"operator"},'"':function(me,ye){return ye.tokenize=Le(me.match('""')),ye.tokenize(me,ye)},"/":function(me,ye){return me.eat("*")?(ye.tokenize=Pe(1),ye.tokenize(me,ye)):!1},indent:function(me,ye,Se,qe){var st=Se&&Se.charAt(0);if((me.prevToken=="}"||me.prevToken==")")&&Se=="")return me.indented;if(me.prevToken=="operator"&&Se!="}"&&me.context.type!="}"||me.prevToken=="variable"&&st=="."||(me.prevToken=="}"||me.prevToken==")")&&st==".")return qe*2+ye.indented;if(ye.align&&ye.type=="}")return ye.indented+(me.context.type==(Se||"").charAt(0)?0:qe)}},modeProps:{closeBrackets:{triples:'"'}}}),xe(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:b("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:b("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:b("for while do if else struct"),builtin:b("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:b("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TextureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":ie},modeProps:{fold:["brace","include"]}}),xe("text/x-nesc",{name:"clike",keywords:b(F+" as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:U,blockKeywords:b(z),atoms:b("null true false"),hooks:{"#":ie},modeProps:{fold:["brace","include"]}}),xe("text/x-objectivec",{name:"clike",keywords:b(F+" "+k),types:V,builtin:b(N),blockKeywords:b(z+" @synthesize @try @catch @finally @autoreleasepool @synchronized"),defKeywords:b(K+" @interface @implementation @protocol @class"),dontIndentStatements:/^@.*$/,typeFirstDefinitions:!0,atoms:b("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:se,hooks:{"#":ie,"*":he},modeProps:{fold:["brace","include"]}}),xe("text/x-objectivec++",{name:"clike",keywords:b(F+" "+k+" "+S),types:V,builtin:b(N),blockKeywords:b(z+" @synthesize @try @catch @finally @autoreleasepool @synchronized class try catch"),defKeywords:b(K+" @interface @implementation @protocol @class class namespace"),dontIndentStatements:/^@.*$|^template$/,typeFirstDefinitions:!0,atoms:b("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:se,hooks:{"#":ie,"*":he,u:pe,U:pe,L:pe,R:pe,0:ee,1:ee,2:ee,3:ee,4:ee,5:ee,6:ee,7:ee,8:ee,9:ee,token:function(me,ye,Se){if(Se=="variable"&&me.peek()=="("&&(ye.prevToken==";"||ye.prevToken==null||ye.prevToken=="}")&&_e(me.current()))return"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),xe("text/x-squirrel",{name:"clike",keywords:b("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:U,blockKeywords:b("case catch class else for foreach if switch try while"),defKeywords:b("function local class"),typeFirstDefinitions:!0,atoms:b("true false null"),hooks:{"#":ie},modeProps:{fold:["brace","include"]}});var Xe=null;function Ke(me){return function(ye,Se){for(var qe=!1,st,mt=!1;!ye.eol();){if(!qe&&ye.match('"')&&(me=="single"||ye.match('""'))){mt=!0;break}if(!qe&&ye.match("``")){Xe=Ke(me),mt=!0;break}st=ye.next(),qe=me=="single"&&!qe&&st=="\\"}return mt&&(Se.tokenize=null),"string"}}xe("text/x-ceylon",{name:"clike",keywords:b("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(me){var ye=me.charAt(0);return ye===ye.toUpperCase()&&ye!==ye.toLowerCase()},blockKeywords:b("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:b("class dynamic function interface module object package value"),builtin:b("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:b("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(me){return me.eatWhile(/[\w\$_]/),"meta"},'"':function(me,ye){return ye.tokenize=Ke(me.match('""')?"triple":"single"),ye.tokenize(me,ye)},"`":function(me,ye){return!Xe||!me.match("`")?!1:(ye.tokenize=Xe,Xe=null,ye.tokenize(me,ye))},"'":function(me){return me.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(me,ye,Se){if((Se=="variable"||Se=="type")&&ye.prevToken==".")return"variable-2"}},modeProps:{fold:["brace","import"],closeBrackets:{triples:'"'}}})}),(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){var t="CodeMirror-hint",o="CodeMirror-hint-active";e.showHint=function(V,z,K){if(!z)return V.showHint(K);K&&K.async&&(z.async=!0);var ie={hint:z};if(K)for(var he in K)ie[he]=K[he];return V.showHint(ie)},e.defineExtension("showHint",function(V){V=b(this,this.getCursor("start"),V);var z=this.listSelections();if(!(z.length>1)){if(this.somethingSelected()){if(!V.hint.supportsSelection)return;for(var K=0;K<z.length;K++)if(z[K].head.line!=z[K].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var ie=this.state.completionActive=new u(this,V);ie.options.hint&&(e.signal(this,"startCompletion",this),ie.update(!0))}}),e.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});function u(V,z){if(this.cm=V,this.options=z,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,this.options.updateOnCursorActivity){var K=this;V.on("cursorActivity",this.activityFunc=function(){K.cursorActivity()})}}var p=window.requestAnimationFrame||function(V){return setTimeout(V,1e3/60)},f=window.cancelAnimationFrame||clearTimeout;u.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.options.updateOnCursorActivity&&this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(V,z){var K=V.list[z],ie=this;this.cm.operation(function(){K.hint?K.hint(ie.cm,V,K):ie.cm.replaceRange(M(K),K.from||V.from,K.to||V.to,"complete"),e.signal(V,"pick",K),ie.cm.scrollIntoView()}),this.options.closeOnPick&&this.close()},cursorActivity:function(){this.debounce&&(f(this.debounce),this.debounce=0);var V=this.startPos;this.data&&(V=this.data.from);var z=this.cm.getCursor(),K=this.cm.getLine(z.line);if(z.line!=this.startPos.line||K.length-z.ch!=this.startLen-this.startPos.ch||z.ch<V.ch||this.cm.somethingSelected()||!z.ch||this.options.closeCharacters.test(K.charAt(z.ch-1)))this.close();else{var ie=this;this.debounce=p(function(){ie.update()}),this.widget&&this.widget.disable()}},update:function(V){if(this.tick!=null){var z=this,K=++this.tick;$(this.options.hint,this.cm,this.options,function(ie){z.tick==K&&z.finishUpdate(ie,V)})}},finishUpdate:function(V,z){this.data&&e.signal(this.data,"update");var K=this.widget&&this.widget.picked||z&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=V,V&&V.list.length&&(K&&V.list.length==1?this.pick(V,0):(this.widget=new k(this,V),e.signal(V,"shown")))}};function b(V,z,K){var ie=V.options.hintOptions,he={};for(var se in U)he[se]=U[se];if(ie)for(var se in ie)ie[se]!==void 0&&(he[se]=ie[se]);if(K)for(var se in K)K[se]!==void 0&&(he[se]=K[se]);return he.hint.resolve&&(he.hint=he.hint.resolve(V,z)),he}function M(V){return typeof V=="string"?V:V.text}function F(V,z){var K={Up:function(){z.moveFocus(-1)},Down:function(){z.moveFocus(1)},PageUp:function(){z.moveFocus(-z.menuSize()+1,!0)},PageDown:function(){z.moveFocus(z.menuSize()-1,!0)},Home:function(){z.setFocus(0)},End:function(){z.setFocus(z.length-1)},Enter:z.pick,Tab:z.pick,Esc:z.close},ie=/Mac/.test(navigator.platform);ie&&(K["Ctrl-P"]=function(){z.moveFocus(-1)},K["Ctrl-N"]=function(){z.moveFocus(1)});var he=V.options.customKeys,se=he?{}:K;function ee(ve,we){var xe;typeof we!="string"?xe=function(Oe){return we(Oe,z)}:K.hasOwnProperty(we)?xe=K[we]:xe=we,se[ve]=xe}if(he)for(var pe in he)he.hasOwnProperty(pe)&&ee(pe,he[pe]);var _e=V.options.extraKeys;if(_e)for(var pe in _e)_e.hasOwnProperty(pe)&&ee(pe,_e[pe]);return se}function S(V,z){for(;z&&z!=V;){if(z.nodeName.toUpperCase()==="LI"&&z.parentNode==V)return z;z=z.parentNode}}function k(V,z){this.id="cm-complete-"+Math.floor(Math.random(1e6)),this.completion=V,this.data=z,this.picked=!1;var K=this,ie=V.cm,he=ie.getInputField().ownerDocument,se=he.defaultView||he.parentWindow,ee=this.hints=he.createElement("ul");ee.setAttribute("role","listbox"),ee.setAttribute("aria-expanded","true"),ee.id=this.id;var pe=V.cm.options.theme;ee.className="CodeMirror-hints "+pe,this.selectedHint=z.selectedHint||0;for(var _e=z.list,ve=0;ve<_e.length;++ve){var we=ee.appendChild(he.createElement("li")),xe=_e[ve],Oe=t+(ve!=this.selectedHint?"":" "+o);xe.className!=null&&(Oe=xe.className+" "+Oe),we.className=Oe,ve==this.selectedHint&&we.setAttribute("aria-selected","true"),we.id=this.id+"-"+ve,we.setAttribute("role","option"),xe.render?xe.render(we,z,xe):we.appendChild(he.createTextNode(xe.displayText||M(xe))),we.hintId=ve}var Pe=V.options.container||he.body,Le=ie.cursorCoords(V.options.alignWithWord?z.from:null),Xe=Le.left,Ke=Le.bottom,me=!0,ye=0,Se=0;if(Pe!==he.body){var qe=["absolute","relative","fixed"].indexOf(se.getComputedStyle(Pe).position)!==-1,st=qe?Pe:Pe.offsetParent,mt=st.getBoundingClientRect(),Ee=he.body.getBoundingClientRect();ye=mt.left-Ee.left-st.scrollLeft,Se=mt.top-Ee.top-st.scrollTop}ee.style.left=Xe-ye+"px",ee.style.top=Ke-Se+"px";var rt=se.innerWidth||Math.max(he.body.offsetWidth,he.documentElement.offsetWidth),St=se.innerHeight||Math.max(he.body.offsetHeight,he.documentElement.offsetHeight);Pe.appendChild(ee),ie.getInputField().setAttribute("aria-autocomplete","list"),ie.getInputField().setAttribute("aria-owns",this.id),ie.getInputField().setAttribute("aria-activedescendant",this.id+"-"+this.selectedHint);var pt=V.options.moveOnOverlap?ee.getBoundingClientRect():new DOMRect,bt=V.options.paddingForScrollbar?ee.scrollHeight>ee.clientHeight+1:!1,yt;setTimeout(function(){yt=ie.getScrollInfo()});var At=pt.bottom-St;if(At>0){var Et=pt.bottom-pt.top,Kt=Le.top-(Le.bottom-pt.top);if(Kt-Et>0)ee.style.top=(Ke=Le.top-Et-Se)+"px",me=!1;else if(Et>St){ee.style.height=St-5+"px",ee.style.top=(Ke=Le.bottom-pt.top-Se)+"px";var jt=ie.getCursor();z.from.ch!=jt.ch&&(Le=ie.cursorCoords(jt),ee.style.left=(Xe=Le.left-ye)+"px",pt=ee.getBoundingClientRect())}}var Nt=pt.right-rt;if(bt&&(Nt+=ie.display.nativeBarWidth),Nt>0&&(pt.right-pt.left>rt&&(ee.style.width=rt-5+"px",Nt-=pt.right-pt.left-rt),ee.style.left=(Xe=Le.left-Nt-ye)+"px"),bt)for(var _t=ee.firstChild;_t;_t=_t.nextSibling)_t.style.paddingRight=ie.display.nativeBarWidth+"px";if(ie.addKeyMap(this.keyMap=F(V,{moveFocus:function(kt,Ot){K.changeActive(K.selectedHint+kt,Ot)},setFocus:function(kt){K.changeActive(kt)},menuSize:function(){return K.screenAmount()},length:_e.length,close:function(){V.close()},pick:function(){K.pick()},data:z})),V.options.closeOnUnfocus){var $t;ie.on("blur",this.onBlur=function(){$t=setTimeout(function(){V.close()},100)}),ie.on("focus",this.onFocus=function(){clearTimeout($t)})}ie.on("scroll",this.onScroll=function(){var kt=ie.getScrollInfo(),Ot=ie.getWrapperElement().getBoundingClientRect();yt||(yt=ie.getScrollInfo());var Wt=Ke+yt.top-kt.top,Ae=Wt-(se.pageYOffset||(he.documentElement||he.body).scrollTop);if(me||(Ae+=ee.offsetHeight),Ae<=Ot.top||Ae>=Ot.bottom)return V.close();ee.style.top=Wt+"px",ee.style.left=Xe+yt.left-kt.left+"px"}),e.on(ee,"dblclick",function(kt){var Ot=S(ee,kt.target||kt.srcElement);Ot&&Ot.hintId!=null&&(K.changeActive(Ot.hintId),K.pick())}),e.on(ee,"click",function(kt){var Ot=S(ee,kt.target||kt.srcElement);Ot&&Ot.hintId!=null&&(K.changeActive(Ot.hintId),V.options.completeOnSingleClick&&K.pick())}),e.on(ee,"mousedown",function(){setTimeout(function(){ie.focus()},20)});var sn=this.getSelectedHintRange();return(sn.from!==0||sn.to!==0)&&this.scrollToActive(),e.signal(z,"select",_e[this.selectedHint],ee.childNodes[this.selectedHint]),!0}k.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode&&this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var V=this.completion.cm.getInputField();V.removeAttribute("aria-activedescendant"),V.removeAttribute("aria-owns");var z=this.completion.cm;this.completion.options.closeOnUnfocus&&(z.off("blur",this.onBlur),z.off("focus",this.onFocus)),z.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var V=this;this.keyMap={Enter:function(){V.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(V,z){if(V>=this.data.list.length?V=z?this.data.list.length-1:0:V<0&&(V=z?0:this.data.list.length-1),this.selectedHint!=V){var K=this.hints.childNodes[this.selectedHint];K&&(K.className=K.className.replace(" "+o,""),K.removeAttribute("aria-selected")),K=this.hints.childNodes[this.selectedHint=V],K.className+=" "+o,K.setAttribute("aria-selected","true"),this.completion.cm.getInputField().setAttribute("aria-activedescendant",K.id),this.scrollToActive(),e.signal(this.data,"select",this.data.list[this.selectedHint],K)}},scrollToActive:function(){var V=this.getSelectedHintRange(),z=this.hints.childNodes[V.from],K=this.hints.childNodes[V.to],ie=this.hints.firstChild;z.offsetTop<this.hints.scrollTop?this.hints.scrollTop=z.offsetTop-ie.offsetTop:K.offsetTop+K.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=K.offsetTop+K.offsetHeight-this.hints.clientHeight+ie.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1},getSelectedHintRange:function(){var V=this.completion.options.scrollMargin||0;return{from:Math.max(0,this.selectedHint-V),to:Math.min(this.data.list.length-1,this.selectedHint+V)}}};function N(V,z){if(!V.somethingSelected())return z;for(var K=[],ie=0;ie<z.length;ie++)z[ie].supportsSelection&&K.push(z[ie]);return K}function $(V,z,K,ie){if(V.async)V(z,ie,K);else{var he=V(z,K);he&&he.then?he.then(ie):ie(he)}}function R(V,z){var K=V.getHelpers(z,"hint"),ie;if(K.length){var he=function(se,ee,pe){var _e=N(se,K);function ve(we){if(we==_e.length)return ee(null);$(_e[we],se,pe,function(xe){xe&&xe.list.length>0?ee(xe):ve(we+1)})}ve(0)};return he.async=!0,he.supportsSelection=!0,he}else return(ie=V.getHelper(V.getCursor(),"hintWords"))?function(se){return e.hint.fromList(se,{words:ie})}:e.hint.anyword?function(se,ee){return e.hint.anyword(se,ee)}:function(){}}e.registerHelper("hint","auto",{resolve:R}),e.registerHelper("hint","fromList",function(V,z){var K=V.getCursor(),ie=V.getTokenAt(K),he,se=e.Pos(K.line,ie.start),ee=K;ie.start<K.ch&&/\w/.test(ie.string.charAt(K.ch-ie.start-1))?he=ie.string.substr(0,K.ch-ie.start):(he="",se=K);for(var pe=[],_e=0;_e<z.words.length;_e++){var ve=z.words[_e];ve.slice(0,he.length)==he&&pe.push(ve)}if(pe.length)return{list:pe,from:se,to:ee}}),e.commands.autocomplete=e.showHint;var U={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnPick:!0,closeOnUnfocus:!0,updateOnCursorActivity:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null,paddingForScrollbar:!0,moveOnOverlap:!0};e.defineOption("hintOptions",null)})})();
