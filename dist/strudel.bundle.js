(function(){"use strict";const App$1={};window.App=App$1;const DOM$1={};DOM$1.dataset_obj={},DOM$1.dataset_id=0,DOM$1.el=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),t.querySelector(e)),DOM$1.els=(e,t=document)=>(typeof t=="string"&&(t=DOM$1.el(t)),Array.from(t.querySelectorAll(e))),DOM$1.el_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=t.querySelector(e);return o||t.classList.contains(DOM$1.clean_dot(e))&&(o=t),o},DOM$1.els_or_self=(e,t=document)=>{t=DOM$1.element(t);let o=Array.from(t.querySelectorAll(e));return o.length===0&&t.classList.contains(DOM$1.clean_dot(e))&&(o=[t]),o},DOM$1.clone=e=>(e=DOM$1.element(e),e.cloneNode(!0)),DOM$1.clone_children=e=>{e=DOM$1.element(e);let t=Array.from(e.children),o=[];for(let u of t)o.push(DOM$1.clone(u));return o},DOM$1.dataset=(e,t,o)=>{if(e=DOM$1.element(e),!e)return;let u=e.dataset.dataset_id;if(u||(u=DOM$1.dataset_id,DOM$1.dataset_id+=1,e.dataset.dataset_id=u,DOM$1.dataset_obj[u]={}),o!==void 0)DOM$1.dataset_obj[u][t]=o;else return DOM$1.dataset_obj[u][t]},DOM$1.create=(e,t="",o="")=>{let u=document.createElement(e);if(t){let f=t.split(" ").filter(p=>p!=="");for(let p of f)u.classList.add(p)}return o&&(u.id=o),u},DOM$1.ev=(e,t,o,u)=>{e=DOM$1.element(e),e.addEventListener(t,o,u)},DOM$1.evs=(e,t,o,u)=>{e=DOM$1.element(e);for(let f of t)e.addEventListener(f,o,u)},DOM$1.index=e=>(e=DOM$1.element(e),Array.from(e.parentNode.children).indexOf(e)),DOM$1.class=(e,t)=>{e=DOM$1.element(e);for(let o of t)if(e.classList.contains(DOM$1.clean_dot(o)))return!0;return!1},DOM$1.parent=(e,t)=>{e=DOM$1.element(e);for(let o of t){let u=e.closest(o);if(u)return u}},DOM$1.clean_dot=e=>e.replace(".",""),DOM$1.show=(e,t=1)=>{e=DOM$1.element(e),e.classList.remove(DOM$1.hidden(t))},DOM$1.hide=(e,t=1)=>{e=DOM$1.element(e),e.classList.add(DOM$1.hidden(t))},DOM$1.hidden=(e=1)=>{let t="hidden";return e>1&&(t+=`_${e}`),t},DOM$1.is_hidden=(e,t=1)=>e.classList.contains(DOM$1.hidden(t)),DOM$1.element=e=>typeof e=="string"?DOM$1.el(e):e,typeof window<"u"&&(window.DOM=DOM$1);const NeedContext$1={};NeedContext$1.created=!1,NeedContext$1.after_show=()=>{},NeedContext$1.after_hide=()=>{},NeedContext$1.min_width="25px",NeedContext$1.min_height="25px",NeedContext$1.back_icon="⬅️",NeedContext$1.back_text="Back",NeedContext$1.clear_text="Clear",NeedContext$1.item_sep="4px",NeedContext$1.layers={},NeedContext$1.level=0,NeedContext$1.gap="0.5rem",NeedContext$1.side_padding="0.5rem",NeedContext$1.compact_padding="0.3rem",NeedContext$1.center_top=20,NeedContext$1.dragging=!1,NeedContext$1.autohide_delay=500,NeedContext$1.autoclick_delay=500,NeedContext$1.autohide_threshold=5,NeedContext$1.set_defaults=()=>{NeedContext$1.open=!1,NeedContext$1.mousedown=!1,NeedContext$1.first_mousedown=!1,NeedContext$1.keydown=!1,NeedContext$1.filtered=!1,NeedContext$1.last_x=0,NeedContext$1.last_y=0,NeedContext$1.layers={},NeedContext$1.mouse_activity={},NeedContext$1.autohide_enabled=!1,NeedContext$1.reset_debouncers()},NeedContext$1.clear_filter=()=>{NeedContext$1.filter.value="",NeedContext$1.do_filter(),NeedContext$1.filter.focus()},NeedContext$1.do_filter=()=>{let e=NeedContext$1.filter.value,t=NeedContext$1.remove_spaces_2(e).toLowerCase(),o=t.includes(":"),u=!1;for(let g of document.querySelectorAll(".needcontext-separator"))t?g.classList.add("needcontext-hidden"):g.classList.remove("needcontext-hidden");for(let g of document.querySelectorAll(".needcontext-text")){let M=g.closest(".needcontext-item"),F=g.textContent.toLowerCase();F=NeedContext$1.remove_spaces(F),o||(F=F.replace(/:/g,"")),F.includes(t)?(M.classList.remove("needcontext-hidden"),u||(NeedContext$1.select_item(parseInt(M.dataset.index)),u=!0)):M.classList.add("needcontext-hidden")}let f=document.querySelector("#needcontext-back"),p=document.querySelector("#needcontext-clear");if(NeedContext$1.filtered=t!=="",NeedContext$1.filtered){let g=document.querySelector("#needcontext-clear-text");g.textContent=e.trim(),p.classList.remove("needcontext-hidden"),f&&f.classList.add("needcontext-hidden")}else p.classList.add("needcontext-hidden"),f&&f.classList.remove("needcontext-hidden");NeedContext$1.scroll_to_selected()},NeedContext$1.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},NeedContext$1.show=(e={})=>{let t={root:!0,expand:!1,picker_mode:!1,margin:0,compact:!1,autohide:!1,autoclick:!1};if(NeedContext$1.def_args(t,e),!e.items.length)return;if(NeedContext$1.reset_debouncers(),NeedContext$1.created||NeedContext$1.create(),e.e&&e.e.clientX!==void 0&&e.e.clientY!==void 0)e.x=e.e.clientX,e.y=e.e.clientY;else if(e.element){let S=e.element.getBoundingClientRect();e.x=S.left,e.y=S.top+e.margin}e.root&&(NeedContext$1.level=0);let o=e.x===void 0||e.y===void 0;if(e.items=e.items.slice(0),e.index===void 0){let S=e.items.filter(k=>!k.separator);for(let[k,N]of S.entries())if(N.selected){e.index=k;break}}e.index===void 0&&(e.index=0),e.index>=e.items.length&&(e.index=e.items.length-1);let u,f=NeedContext$1.get_layer();f?u=f.last_index:u=e.index,u=u||0;for(let[S,k]of e.items.entries())S===u?k.selected=!0:k.selected=!1;let p=0,g=NeedContext$1.container;if(g.innerHTML="",g.style.left="unset",g.style.top="unset",g.style.transform="unset",g.style.minWidth="unset",g.style.minHeight="unset",e.title&&!e.compact){let S=document.createElement("div");S.id="needcontext-title",e.title_icon&&(document.createElement("div").classList.add("needcontext-title-icon"),S.append(e.title_icon));let k=document.createElement("div");if(k.textContent=e.title.trim(),S.append(k),g.append(S),e.title_number){let N=document.createElement("div");N.classList.add("needcontext-title-number"),S.append(N)}g.classList.add("with_title"),g.classList.remove("without_title")}else g.classList.remove("with_title"),g.classList.add("without_title");e.root||g.append(NeedContext$1.back_button()),g.append(NeedContext$1.clear_button());let M=[];e.compact?g.classList.add("needcontext-compact"):g.classList.remove("needcontext-compact");for(let S of e.items){if(e.compact&&!S.icon)continue;let k=document.createElement("div");if(k.classList.add("needcontext-item"),S.separator)k.classList.add("needcontext-separator");else{if(k.classList.add("needcontext-normal"),S.highlight&&k.classList.add("needcontext-highlight"),S.image){let N=document.createElement("img");N.loading="lazy",N.addEventListener("error",$=>{$.target.classList.add("needcontext-hidden")}),N.classList.add("needcontext-image"),N.src=S.image,k.append(N)}if(S.icon){let N=document.createElement("div");N.classList.add("needcontext-icon"),S.icon_action&&N.addEventListener("click",$=>{S.icon_action($,N)}),N.append(S.icon),k.append(N)}if(S.text){let N=document.createElement("div");N.classList.add("needcontext-text"),N.textContent=S.text.trim(),k.append(N)}if(e.compact){if(e.compact){let N=[S.text,S.info].filter(Boolean);k.title=N.join(" - ")}}else S.info&&(k.title=S.info.trim());S.bold&&k.classList.add("needcontext-bold"),S.direct_action&&k.addEventListener("click",()=>{S.direct_action(),NeedContext$1.hide()}),k.dataset.index=p,S.index=p,k.addEventListener("mousemove",()=>{let N=parseInt(k.dataset.index);NeedContext$1.index!==N&&NeedContext$1.select_item(N)}),p+=1,M.push(S)}e.on_drag&&(k.draggable=!0),S.element=k,S.picked=!1,g.append(k)}NeedContext$1.layers[NeedContext$1.level]={root:e.root,items:e.items,normal_items:M,last_index:u,x:e.x,y:e.y},NeedContext$1.main.classList.remove("needcontext-hidden"),NeedContext$1.update_title(),o&&(g.style.left="50%",g.style.transform="translateX(-50%)",e.y=NeedContext$1.center_top),e.y<5&&(e.y=5),e.x<5&&(e.x=5);let F=5;if(e.y+g.offsetHeight+5>window.innerHeight){let S=Math.abs(e.y+g.offsetHeight-window.innerHeight);e.y-=S+F}if(e.x+g.offsetWidth+5>window.innerWidth){let S=Math.abs(e.x+g.offsetWidth-window.innerWidth);e.x-=S+F}NeedContext$1.last_x=e.x,NeedContext$1.last_y=e.y,e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),g.style.top=`${e.y}px`,o||(g.style.left=`${e.x}px`,g.style.transform="unset"),NeedContext$1.filter.value="",NeedContext$1.filter.focus(),e.expand&&e.element?g.style.minWidth=`${e.element.clientWidth}px`:g.style.minWidth=NeedContext$1.min_width,g.style.minHeight=NeedContext$1.min_height,NeedContext$1.filter.value="",NeedContext$1.filtered=!1,NeedContext$1.select_item(u),NeedContext$1.scroll_to_selected(),NeedContext$1.open=!0,NeedContext$1.after_show(),e.root&&(NeedContext$1.args=e)},NeedContext$1.hide=e=>{NeedContext$1.open&&(NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.set_defaults(),NeedContext$1.after_hide(),NeedContext$1.args.after_hide&&NeedContext$1.args.after_hide(e))},NeedContext$1.select_item=e=>{let t=Array.from(document.querySelectorAll(".needcontext-normal"));for(let o of t)parseInt(o.dataset.index)===e?o.classList.add("needcontext-item-selected"):o.classList.remove("needcontext-item-selected");NeedContext$1.index=e},NeedContext$1.scroll_to_selected=(e="center")=>{let t=document.querySelector(".needcontext-item-selected");t&&t.scrollIntoView({block:e})},NeedContext$1.select_next=(e="down",t=!1)=>{let o=!1,u,f=NeedContext$1.get_layer().normal_items.slice(0);f=f.filter(p=>!p.removed),e==="up"&&f.reverse();for(let p of f)if(NeedContext$1.is_visible(p.element)){if(u===void 0&&(u=p.index),o){NeedContext$1.select_item(p.index),NeedContext$1.scroll_to_selected("nearest");return}p.index===NeedContext$1.index&&(o=!0)}if(!t)return NeedContext$1.select_item(u),NeedContext$1.scroll_to_selected("nearest"),!0;NeedContext$1.select_next("up")},NeedContext$1.select_action=(e,t=NeedContext$1.index,o="mouse")=>{if(o==="mouse"&&!e.target.closest(".needcontext-normal"))return;let u=NeedContext$1.get_layer().normal_items[t];if(!u)return;let f=NeedContext$1.last_x,p=NeedContext$1.last_y,g=S=>{NeedContext$1.get_layer().last_index=t,NeedContext$1.level+=1,e.clientY&&(p=e.clientY),NeedContext$1.show({x:f,y:p,items:S,root:!1})},M=S=>{S.length===1&&S[0].direct?NeedContext$1.action(S[0],e):g(S)};async function F(){if(u.action){e.shiftKey?u.shift_action&&NeedContext$1.shift_action(u,e):e.ctrlKey?u.ctrl_action&&NeedContext$1.ctrl_action(u,e):e.altKey?u.alt_action&&NeedContext$1.alt_action(u,e):NeedContext$1.action(u,e);return}else if(u.items)M(u.items);else if(u.get_items){let S=await u.get_items();M(S)}}if(o==="keyboard"){F();return}e.button===0?e.shiftKey?u.shift_action&&NeedContext$1.shift_action(u,e):e.ctrlKey?u.ctrl_action&&NeedContext$1.ctrl_action(u,e):e.altKey?u.alt_action&&NeedContext$1.alt_action(u,e):F():e.button===1?u.middle_action&&NeedContext$1.middle_action(u,e):e.button===2&&u.context_action&&NeedContext$1.context_action(u,e)},NeedContext$1.is_visible=e=>!e.classList.contains("needcontext-hidden"),NeedContext$1.remove_spaces=e=>e.replace(/[\s-]+/g,""),NeedContext$1.remove_spaces_2=e=>e.replace(/\s+/g,""),NeedContext$1.init=()=>{let e=document.createElement("style"),t=`
    #needcontext-main {
      position: fixed;
      z-index: 999999999;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }

    .needcontext-hidden {
      display: none !important;
    }

    #needcontext-container {
      z-index: 2;
      position: absolute;
      background-color: white;
      color: black;
      font-size: 16px;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      user-select: none;
      border: 1px solid #2B2F39;
      border-radius: 5px;
      padding-bottom: 5px;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: hidden;
      text-align: left;
      max-width: 98%;
    }

    #needcontext-container.needcontext-compact {
      flex-direction: row;
      flex-wrap: wrap;
      padding-left: ${NeedContext$1.compact_padding};
      padding-right: ${NeedContext$1.compact_padding};
    }

    .needcontext-compact .needcontext-text {
      display: none;
    }

    .needcontext-compact .needcontext-separator {
      display: none;
    }

    #needcontext-container.without_title {
      padding-top: 5px;
    }

    #needcontext-title {
      font-weight: bold;
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      background-color: rgba(67, 220, 255, 0.47);
      padding-top: 4px;
      padding-bottom: 4px;
      margin-bottom: 2px;
      display: flex;
      flex-direction: row;
      gap: ${NeedContext$1.gap};
      align-items: center;
      justify-content: flex-start;
    }

    #needcontext-filter {
      opacity: 0;
    }

    .needcontext-item {
      white-space: nowrap;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
    }

    .needcontext-normal {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      cursor: pointer;
    }

    .needcontext-highlight {
      border: 1px solid currentColor !important;
      border-radius: 10px;
    }

    .needcontext-picked .needcontext-text {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .needcontext-button {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
      cursor: pointer;
    }

    .needcontext-button:hover {
      text-shadow: 0 0 1rem currentColor;
    }

    .needcontext-separator {
      border-top: 1px solid currentColor;
      margin-left: ${NeedContext$1.side_padding};
      margin-right: ${NeedContext$1.side_padding};
      margin-top: ${NeedContext$1.item_sep};
      margin-bottom: ${NeedContext$1.item_sep};
      opacity: 0.7;
    }

    .needcontext-item-selected {
      background-color: rgba(0, 0, 0, 0.18);
    }

    .needcontext-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .needcontext-image {
      width: 1.11rem;
      height: 1.11rem;
      object-fit: contain;
      margin-right: 0.1rem;
    }

    .needcontext-bold {
      font-weight: bold;
    }
  `;e.innerText=t,document.head.appendChild(e),document.addEventListener("mousedown",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.first_mousedown=!0,o.target.closest("#needcontext-container")&&(NeedContext$1.mousedown=!0))}),document.addEventListener("mouseup",o=>{!NeedContext$1.open||!o.target||(o.target.closest("#needcontext-container")?o.target.closest(".needcontext-back")?o.button===0&&NeedContext$1.go_back():o.target.closest(".needcontext-clear")?o.button===0&&NeedContext$1.clear_filter():NeedContext$1.mousedown&&NeedContext$1.select_action(o):NeedContext$1.first_mousedown&&NeedContext$1.dismiss(o),NeedContext$1.mousedown=!1)}),document.addEventListener("mousemove",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.addEventListener("mouseover",o=>{!NeedContext$1.open||!o.target||(NeedContext$1.check_mouse_range(o),NeedContext$1.check_auto_funcs(o))}),document.documentElement.addEventListener("mouseleave",o=>{NeedContext$1.open&&NeedContext$1.args.autohide&&NeedContext$1.autohide_debouncer.call_2(o)}),document.addEventListener("keydown",o=>{NeedContext$1.open&&(NeedContext$1.keydown=!0,["ArrowUp","ArrowLeft"].includes(o.key)?(NeedContext$1.select_next("up"),o.preventDefault()):["ArrowDown","ArrowRight"].includes(o.key)?(NeedContext$1.select_next(),o.preventDefault()):o.key==="Backspace"&&(NeedContext$1.filtered||(NeedContext$1.go_back(),o.preventDefault())))}),document.addEventListener("keyup",o=>{NeedContext$1.open&&NeedContext$1.keydown&&(NeedContext$1.keydown=!1,o.key==="Escape"?(NeedContext$1.dismiss(o),o.preventDefault()):o.key==="Enter"&&(NeedContext$1.select_action(o,void 0,"keyboard"),o.preventDefault()))}),NeedContext$1.start_autohide(),NeedContext$1.start_autoclick(),NeedContext$1.set_defaults()},NeedContext$1.create=()=>{NeedContext$1.main=document.createElement("div"),NeedContext$1.main.id="needcontext-main",NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.container=document.createElement("div"),NeedContext$1.container.id="needcontext-container",NeedContext$1.filter=document.createElement("input"),NeedContext$1.filter.id="needcontext-filter",NeedContext$1.filter.type="text",NeedContext$1.filter.autocomplete="off",NeedContext$1.filter.spellcheck=!1,NeedContext$1.filter.placeholder="Filter",NeedContext$1.filter.addEventListener("input",e=>{NeedContext$1.do_filter()}),NeedContext$1.main.addEventListener("contextmenu",e=>{e.preventDefault()}),NeedContext$1.container.addEventListener("dragstart",e=>{NeedContext$1.dragging=!0,NeedContext$1.dragstart_action(e)}),NeedContext$1.container.addEventListener("dragenter",e=>{NeedContext$1.dragenter_action(e)}),NeedContext$1.container.addEventListener("dragend",e=>{NeedContext$1.dragging=!1,NeedContext$1.dragend_action(e)}),NeedContext$1.main.append(NeedContext$1.filter),NeedContext$1.main.append(NeedContext$1.container),document.body.appendChild(NeedContext$1.main),NeedContext$1.created=!0},NeedContext$1.dragstart_action=e=>{NeedContext$1.dragged_item=e.target;let t=NeedContext$1.container,o=Array.from(t.querySelectorAll(".needcontext-item"));NeedContext$1.dragged_index=o.indexOf(e.target)},NeedContext$1.dragenter_action=e=>{let t=NeedContext$1.dragged_item;if(t===e.target)return;let o=NeedContext$1.container,u=Array.from(o.querySelectorAll(".needcontext-item")),f=u.indexOf(t),p=u.indexOf(e.target);if(f<0||p<0)return;f<p?o.insertBefore(t,e.target.nextSibling):o.insertBefore(t,e.target),u=Array.from(o.querySelectorAll(".needcontext-item"));let g=u.indexOf(t),M=u.indexOf(e.target);t.dataset.index=g,e.target.dataset.index=M,NeedContext$1.select_item(g)},NeedContext$1.dragend_action=e=>{let t=NeedContext$1.container,o=NeedContext$1.dragged_item,f=Array.from(t.querySelectorAll(".needcontext-item")).indexOf(o);NeedContext$1.hide(e),NeedContext$1.args.on_drag(NeedContext$1.dragged_index,f)},NeedContext$1.get_layer=()=>NeedContext$1.layers[NeedContext$1.level],NeedContext$1.prev_layer=()=>NeedContext$1.layers[NeedContext$1.level-1],NeedContext$1.go_back=()=>{if(NeedContext$1.level===0)return;let e=NeedContext$1.prev_layer();NeedContext$1.level-=1;let t={x:e.x,y:e.y,items:e.items,root:e.root};t.compact=NeedContext$1.args.compact,t.autohide=NeedContext$1.args.autohide,t.autoclick=NeedContext$1.args.autoclick,NeedContext$1.show(t)},NeedContext$1.back_button=()=>{let e=document.createElement("div");e.id="needcontext-back",e.classList.add("needcontext-back"),e.classList.add("needcontext-button");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.textContent=NeedContext$1.back_text.trim(),e.append(t),e.append(o),e.title="Shortcut: Backspace",e},NeedContext$1.clear_button=()=>{let e=document.createElement("div");e.id="needcontext-clear",e.classList.add("needcontext-clear"),e.classList.add("needcontext-button"),e.classList.add("needcontext-hidden");let t=document.createElement("div");t.append(NeedContext$1.back_icon);let o=document.createElement("div");return o.id="needcontext-clear-text",o.textContent=NeedContext$1.clear_text.trim(),e.append(t),e.append(o),e.title="Type to filter. Click to clear",e},NeedContext$1.action=(e,t)=>{if(e.element&&(!NeedContext$1.is_visible(e.element)||t.target.closest(".needcontext-icon")&&e.icon_action))return;let o=NeedContext$1.args,u=NeedContext$1.args.after_action;if(o.picker_mode){e.element.classList.add("needcontext-picked"),NeedContext$1.filter.focus(),e.picked=!0;let f=!0;for(let p of o.items)if(!p.picked){f=!1;break}f&&NeedContext$1.hide(t)}else NeedContext$1.hide(t);e.action(t),u&&u(t)},NeedContext$1.dismiss=e=>{NeedContext$1.args.after_dismiss&&NeedContext$1.args.after_dismiss(e),NeedContext$1.hide(e)},NeedContext$1.shift_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_shift_action&&NeedContext$1.args.after_shift_action(t),NeedContext$1.hide(t),e.shift_action(t))},NeedContext$1.ctrl_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_ctrl_action&&NeedContext$1.args.after_ctrl_action(t),NeedContext$1.hide(t),e.ctrl_action(t))},NeedContext$1.alt_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_alt_action&&NeedContext$1.args.after_alt_action(t),NeedContext$1.hide(t),e.alt_action(t))},NeedContext$1.middle_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_middle_action&&NeedContext$1.args.after_middle_action(t),NeedContext$1.args.middle_action_remove?NeedContext$1.remove_item(e):NeedContext$1.hide(t),e.middle_action(t))},NeedContext$1.context_action=(e,t)=>{e.element&&!NeedContext$1.is_visible(e.element)||(NeedContext$1.args.after_context_action&&NeedContext$1.args.after_context_action(t),NeedContext$1.hide(t),e.context_action(t))},NeedContext$1.remove_item=e=>{NeedContext$1.select_next("down",!0),e.removed=!0,e.element.remove(),NeedContext$1.update_title()},NeedContext$1.update_title=()=>{let e=document.querySelector("#needcontext-title");if(!e)return;let t=e.querySelector(".needcontext-title-number");if(!t)return;let o=NeedContext$1.count_items();t.textContent=`(${o})`},NeedContext$1.count_items=()=>{let e=NeedContext$1.get_layer().normal_items;return e=e.filter(t=>!t.removed),e=e.filter(t=>!t.fake),e.length},NeedContext$1.create_debouncer=(e,t)=>{let o,u={};function f(){clearTimeout(o),o=void 0}function p(...g){e(...g)}return u.call=(...g)=>{f(),o=setTimeout(()=>{p(...g)},t)},u.call_2=(...g)=>{o||u.call(g)},u.now=(...g)=>{f(),p(...g)},u.cancel=()=>{f()},u},NeedContext$1.reset_debouncers=()=>{NeedContext$1.autohide_debouncer.cancel(),NeedContext$1.autoclick_debouncer.cancel()},NeedContext$1.check_auto_funcs=e=>{if(!NeedContext$1.open||!e.target)return;let t=e.target.id==="needcontext-main";if(t||NeedContext$1.reset_debouncers(),NeedContext$1.args.autohide&&t&&NeedContext$1.autohide_enabled&&NeedContext$1.autohide_debouncer.call_2(e),NeedContext$1.args.autoclick){let o=e.target.closest(".needcontext-item");o||(o=e.target.closest(".needcontext-back")),o&&NeedContext$1.autoclick_debouncer.call(o,e)}},NeedContext$1.check_mouse_range=e=>{if(NeedContext$1.autohide_enabled||e.target.id!=="needcontext-main")return;let t=e.clientX,o=e.clientY;if(NeedContext$1.mouse_activity.initial_x===void 0){NeedContext$1.mouse_activity.initial_x=t,NeedContext$1.mouse_activity.initial_y=o;return}let u=NeedContext$1.container.getBoundingClientRect();function f(p){let g=p>NeedContext$1.autohide_threshold;return g&&(NeedContext$1.autohide_enabled=!0),g}if(o<u.top&&o<NeedContext$1.mouse_activity.initial_y&&o<u.top){let p=u.top-o;if(f(p))return}if(o>u.bottom&&o>NeedContext$1.mouse_activity.initial_y&&o>u.bottom){let p=o-u.bottom;if(f(p))return}if(t<u.left&&t<NeedContext$1.mouse_activity.initial_x&&t<u.left){let p=u.left-t;if(f(p))return}if(t>u.right&&t>NeedContext$1.mouse_activity.initial_x&&t>u.right){let p=t-u.right;if(f(p))return}},NeedContext$1.start_autohide=e=>{NeedContext$1.autohide_debouncer=NeedContext$1.create_debouncer(t=>{NeedContext$1.hide(t)},e||NeedContext$1.autohide_delay)},NeedContext$1.start_autoclick=e=>{NeedContext$1.autoclick_debouncer=NeedContext$1.create_debouncer((t,o)=>{t.closest(".needcontext-item")?NeedContext$1.select_action(o):t.closest(".needcontext-back")&&NeedContext$1.go_back()},e||NeedContext$1.autoclick_delay)},typeof window<"u"&&(window.NeedContext=NeedContext$1),(function(e,t){var o=t(e);typeof module<"u"&&"exports"in module?module.exports=o:typeof define=="function"&&define.amd?define([],function(){return o}):e.jdenticon=o})(typeof self<"u"?self:void 0,function(e){function t(xe,Pe,ye){return parseInt(xe.substr(Pe,ye),16)}function o(xe){return xe|=0,xe<0?"00":xe<16?"0"+xe.toString(16):xe<256?xe.toString(16):"ff"}function u(xe,Pe,ye){return ye=ye<0?ye+6:ye>6?ye-6:ye,o(255*(ye<1?xe+(Pe-xe)*ye:ye<3?Pe:ye<4?xe+(Pe-xe)*(4-ye):xe))}function f(xe){if(/^#[0-9a-f]{3,8}$/i.test(xe)){var Pe,ye=xe.length;if(ye<6){var Te=xe[1],He=xe[2],et=xe[3],We=xe[4]||"";Pe="#"+Te+Te+He+He+et+et+We+We}return(ye==7||ye>8)&&(Pe=xe),Pe}}function p(xe){var Pe=t(xe,7,2),ye;if(isNaN(Pe))ye=xe;else{var Te=t(xe,1,2),He=t(xe,3,2),et=t(xe,5,2);ye="rgba("+Te+","+He+","+et+","+(Pe/255).toFixed(2)+")"}return ye}function g(xe,Pe,ye){var Te;if(Pe==0){var He=o(ye*255);Te=He+He+He}else{var et=ye<=.5?ye*(Pe+1):ye+Pe-ye*Pe,We=ye*2-et;Te=u(We,et,xe*6+2)+u(We,et,xe*6)+u(We,et,xe*6-2)}return"#"+Te}function M(xe,Pe,ye){var Te=[.55,.5,.5,.46,.6,.55,.55],He=Te[xe*6+.5|0];return ye=ye<.5?ye*He*2:He+(ye-.5)*(1-He)*2,g(xe,Pe,ye)}var F=e,S={G:"jdenticon_config",n:"config"},k={};function N(xe){k=xe}function $(xe){return arguments.length&&(k[S.n]=xe),k[S.n]}function R(xe,Pe){var ye=typeof xe=="object"&&xe||k[S.n]||F[S.G]||{},Te=ye.lightness||{},He=ye.saturation||{},et="color"in He?He.color:He,We=He.grayscale,yt=ye.backColor,$e=ye.padding;function Ye(It,zt){var Ue=Te[It];return Ue&&Ue.length>1||(Ue=zt),function(Et){return Et=Ue[0]+Et*(Ue[1]-Ue[0]),Et<0?0:Et>1?1:Et}}function mt(It){var zt=ye.hues,Ue;return zt&&zt.length>0&&(Ue=zt[0|.999*It*zt.length]),typeof Ue=="number"?(Ue/360%1+1)%1:It}return{X:mt,p:typeof et=="number"?et:.5,H:typeof We=="number"?We:0,q:Ye("color",[.4,.8]),I:Ye("grayscale",[.3,.9]),J:f(yt),Y:typeof xe=="number"?xe:typeof $e=="number"?$e:Pe}}var U=1,O=2,Z={t:"data-jdenticon-hash",o:"data-jdenticon-value"},K="["+Z.t+"],["+Z.o+"]",ie=typeof document<"u"&&document.querySelectorAll.bind(document);function de(xe){if(xe){var Pe=xe.tagName;if(/^svg$/i.test(Pe))return U;if(/^canvas$/i.test(Pe)&&"getContext"in xe)return O}}function te(xe){if(typeof MutationObserver<"u"){var Pe=new MutationObserver(function(Te){for(var He=0;He<Te.length;He++){for(var et=Te[He],We=et.addedNodes,yt=0;We&&yt<We.length;yt++){var $e=We[yt];if($e.nodeType==1)if(de($e))xe($e);else for(var Ye=$e.querySelectorAll(K),mt=0;mt<Ye.length;mt++)xe(Ye[mt])}et.type=="attributes"&&de(et.target)&&xe(et.target)}});Pe.observe(document.body,{childList:!0,attributes:!0,attributeFilter:[Z.o,Z.t,"width","height"],subtree:!0})}}function re(xe,Pe){this.x=xe,this.y=Pe}function ue(xe,Pe,ye,Te){this.u=xe,this.v=Pe,this.K=ye,this.Z=Te}ue.prototype.L=function(Pe,ye,Te,He){var et=this.u+this.K,We=this.v+this.K,yt=this.Z;return yt===1?new re(et-ye-(He||0),this.v+Pe):yt===2?new re(et-Pe-(Te||0),We-ye-(He||0)):yt===3?new re(this.u+ye,We-Pe-(Te||0)):new re(this.u+Pe,this.v+ye)};var ve=new ue(0,0,0,0);function Ae(xe){this.M=xe,this.A=ve}var Fe=Ae.prototype;Fe.g=function(Pe,ye){for(var Te=this,He=ye?-2:2,et=[],We=ye?Pe.length-2:0;We<Pe.length&&We>=0;We+=He)et.push(Te.A.L(Pe[We],Pe[We+1]));this.M.g(et)},Fe.h=function(Pe,ye,Te,He){var et=this.A.L(Pe,ye,Te,Te);this.M.h(et,Te,He)},Fe.i=function(Pe,ye,Te,He,et){this.g([Pe,ye,Pe+Te,ye,Pe+Te,ye+He,Pe,ye+He],et)},Fe.j=function(Pe,ye,Te,He,et,We){var yt=[Pe+Te,ye,Pe+Te,ye+He,Pe,ye+He,Pe,ye];yt.splice((et||0)%4*2,2),this.g(yt,We)},Fe.N=function(Pe,ye,Te,He,et){this.g([Pe+Te/2,ye,Pe+Te,ye+He/2,Pe+Te/2,ye+He,Pe,ye+He/2],et)};function we(xe,Pe,ye,Te){xe=xe%14;var He,et,We,yt,$e,Ye;xe?xe==1?(We=0|ye*.5,yt=0|ye*.8,Pe.j(ye-We,0,We,yt,2)):xe==2?(We=0|ye/3,Pe.i(We,We,ye-We,ye-We)):xe==3?($e=ye*.1,Ye=ye<6?1:ye<8?2:0|ye*.25,$e=$e>1?0|$e:$e>.5?1:$e,Pe.i(Ye,Ye,ye-$e-Ye,ye-$e-Ye)):xe==4?(et=0|ye*.15,We=0|ye*.5,Pe.h(ye-We-et,ye-We-et,We)):xe==5?($e=ye*.1,Ye=$e*4,Ye>3&&(Ye=0|Ye),Pe.i(0,0,ye,ye),Pe.g([Ye,Ye,ye-$e,Ye,Ye+(ye-Ye-$e)/2,ye-$e],!0)):xe==6?Pe.g([0,0,ye,0,ye,ye*.7,ye*.4,ye*.4,ye*.7,ye,0,ye]):xe==7?Pe.j(ye/2,ye/2,ye/2,ye/2,3):xe==8?(Pe.i(0,0,ye,ye/2),Pe.i(0,ye/2,ye/2,ye/2),Pe.j(ye/2,ye/2,ye/2,ye/2,1)):xe==9?($e=ye*.14,Ye=ye<4?1:ye<6?2:0|ye*.35,$e=ye<8?$e:0|$e,Pe.i(0,0,ye,ye),Pe.i(Ye,Ye,ye-Ye-$e,ye-Ye-$e,!0)):xe==10?($e=ye*.12,Ye=$e*3,Pe.i(0,0,ye,ye),Pe.h(Ye,Ye,ye-$e-Ye,!0)):xe==11?Pe.j(ye/2,ye/2,ye/2,ye/2,3):xe==12?(et=ye*.25,Pe.i(0,0,ye,ye),Pe.N(et,et,ye-et,ye-et,!0)):!Te&&(et=ye*.4,We=ye*1.2,Pe.h(et,et,We)):(He=ye*.42,Pe.g([0,0,ye,0,ye,ye-He*2,ye-He,ye,0,ye]))}function Ce(xe,Pe,ye){xe=xe%4;var Te;xe?xe==1?Pe.j(0,ye/2,ye,ye/2,0):xe==2?Pe.N(0,0,ye,ye):(Te=ye/6,Pe.h(Te,Te,ye-2*Te)):Pe.j(0,0,ye,ye,0)}function be(xe,Pe){return xe=Pe.X(xe),[M(xe,Pe.H,Pe.I(0)),M(xe,Pe.p,Pe.q(.5)),M(xe,Pe.H,Pe.I(1)),M(xe,Pe.p,Pe.q(1)),M(xe,Pe.p,Pe.q(0))]}function le(xe,Pe,ye){var Te=R(ye,.08);Te.J&&xe.m(Te.J);var He=xe.k,et=.5+He*Te.Y|0;He-=et*2;var We=new Ae(xe),yt=0|He/4,$e=0|et+He/2-yt*2,Ye=0|et+He/2-yt*2;function mt(Wt,sn,ot,Pt,Dt){var Ut=t(Pe,ot,1),Kt=Pt?t(Pe,Pt,1):0;xe.O(zt[Ue[Wt]]);for(var ln=0;ln<Dt.length;ln++)We.A=new ue($e+Dt[ln][0]*yt,Ye+Dt[ln][1]*yt,yt,Kt++%4),sn(Ut,We,yt,ln);xe.P()}var It=t(Pe,-7)/268435455,zt=be(It,Te),Ue=[],Et;function Ht(Wt){if(Wt.indexOf(Et)>=0){for(var sn=0;sn<Wt.length;sn++)if(Ue.indexOf(Wt[sn])>=0)return!0}}for(var Oe=0;Oe<3;Oe++)Et=t(Pe,8+Oe,1)%zt.length,(Ht([0,4])||Ht([2,3]))&&(Et=1),Ue.push(Et);mt(0,Ce,2,3,[[1,0],[2,0],[2,3],[1,3],[0,1],[3,1],[3,2],[0,2]]),mt(1,Ce,4,5,[[0,0],[3,0],[3,3],[0,3]]),mt(2,we,1,null,[[1,1],[2,1],[2,2],[1,2]]),xe.finish()}function Ze(xe){var Pe=40,ye=16,Te=0,He=0,et=encodeURI(xe)+"%80",We=[],yt,$e=[],Ye=1732584193,mt=4023233417,It=~Ye,zt=~mt,Ue=3285377520,Et=[Ye,mt,It,zt,Ue],Ht=0,Oe="";function Wt(sn,ot){return sn<<ot|sn>>>32-ot}for(;Te<et.length;He++)We[He>>2]=We[He>>2]|(et[Te]=="%"?parseInt(et.substring(Te+1,Te+=3),16):et.charCodeAt(Te++))<<(3-(He&3))*8;for(yt=((He+7>>6)+1)*ye,We[yt-1]=He*8-8;Ht<yt;Ht+=ye){for(Te=0;Te<80;Te++)He=Wt(Ye,5)+Ue+(Te<20?(mt&It^~mt&zt)+1518500249:Te<40?(mt^It^zt)+1859775393:Te<60?(mt&It^mt&zt^It&zt)+2400959708:(mt^It^zt)+3395469782)+($e[Te]=Te<ye?We[Ht+Te]|0:Wt($e[Te-3]^$e[Te-8]^$e[Te-14]^$e[Te-16],1)),Ue=zt,zt=It,It=Wt(mt,30),mt=Ye,Ye=He;Et[0]=Ye=Et[0]+Ye|0,Et[1]=mt=Et[1]+mt|0,Et[2]=It=Et[2]+It|0,Et[3]=zt=Et[3]+zt|0,Et[4]=Ue=Et[4]+Ue|0}for(Te=0;Te<Pe;Te++)Oe+=(Et[Te>>3]>>>(7-(Te&7))*4&15).toString(16);return Oe}function Je(xe){return/^[0-9a-f]{11,}$/i.test(xe)&&xe}function Qe(xe){return Ze(xe==null?"":""+xe)}function rt(xe,Pe){var ye=xe.canvas,Te=ye.width,He=ye.height;xe.save(),Pe||(Pe=Math.min(Te,He),xe.translate((Te-Pe)/2|0,(He-Pe)/2|0)),this.l=xe,this.k=Pe,xe.clearRect(0,0,Pe,Pe)}var tt=rt.prototype;tt.m=function(Pe){var ye=this.l,Te=this.k;ye.fillStyle=p(Pe),ye.fillRect(0,0,Te,Te)},tt.O=function(Pe){var ye=this.l;ye.fillStyle=p(Pe),ye.beginPath()},tt.P=function(){this.l.fill()},tt.g=function(Pe){var ye=this.l;ye.moveTo(Pe[0].x,Pe[0].y);for(var Te=1;Te<Pe.length;Te++)ye.lineTo(Pe[Te].x,Pe[Te].y);ye.closePath()},tt.h=function(Pe,ye,Te){var He=this.l,et=ye/2;He.moveTo(Pe.x+et,Pe.y+et),He.arc(Pe.x+et,Pe.y+et,et,0,Math.PI*2,Te),He.closePath()},tt.finish=function(){this.l.restore()};function kt(xe,Pe,ye,Te){if(!xe)throw new Error("No canvas specified.");le(new rt(xe,ye),Je(Pe)||Qe(Pe),Te)}function Lt(xe){return(xe*10+.5|0)/10}function Tt(){this.B=""}var ke=Tt.prototype;ke.g=function(Pe){for(var ye="",Te=0;Te<Pe.length;Te++)ye+=(Te?"L":"M")+Lt(Pe[Te].x)+" "+Lt(Pe[Te].y);this.B+=ye+"Z"},ke.h=function(Pe,ye,Te){var He=Te?0:1,et=Lt(ye/2),We=Lt(ye),yt="a"+et+","+et+" 0 1,"+He+" ";this.B+="M"+Lt(Pe.x)+" "+Lt(Pe.y+ye/2)+yt+We+",0"+yt+-We+",0"};function at(xe){this.C,this.D={},this.R=xe,this.k=xe.k}var je=at.prototype;je.m=function(Pe){var ye=/^(#......)(..)?/.exec(Pe),Te=ye[2]?t(ye[2],0)/255:1;this.R.m(ye[1],Te)},je.O=function(Pe){this.C=this.D[Pe]||(this.D[Pe]=new Tt)},je.P=function(){},je.g=function(Pe){this.C.g(Pe)},je.h=function(Pe,ye,Te){this.C.h(Pe,ye,Te)},je.finish=function(){var Pe=this,ye=this.D;for(var Te in ye)ye.hasOwnProperty(Te)&&Pe.R.S(Te,ye[Te].B)};var Ie={T:"http://www.w3.org/2000/svg",U:"width",V:"height"};function nt(xe){this.k=xe,this.F='<svg xmlns="'+Ie.T+'" width="'+xe+'" height="'+xe+'" viewBox="0 0 '+xe+" "+xe+'">'}var pt=nt.prototype;pt.m=function(Pe,ye){ye&&(this.F+='<rect width="100%" height="100%" fill="'+Pe+'" opacity="'+ye.toFixed(2)+'"/>')},pt.S=function(Pe,ye){this.F+='<path fill="'+Pe+'" d="'+ye+'"/>'},pt.toString=function(){return this.F+"</svg>"};function Ft(xe,Pe,ye){var Te=new nt(Pe);return le(new at(Te),Je(xe)||Qe(xe),ye),Te.toString()}function ht(xe,Pe){for(var ye=[],Te=arguments.length-2;Te-- >0;)ye[Te]=arguments[Te+2];for(var He=document.createElementNS(Ie.T,Pe),et=0;et+1<ye.length;et+=2)He.setAttribute(ye[et],ye[et+1]);xe.appendChild(He)}function Zt(xe){var Pe=this.k=Math.min(Number(xe.getAttribute(Ie.U))||100,Number(xe.getAttribute(Ie.V))||100);for(this.W=xe;xe.firstChild;)xe.removeChild(xe.firstChild);xe.setAttribute("viewBox","0 0 "+Pe+" "+Pe),xe.setAttribute("preserveAspectRatio","xMidYMid meet")}var Qt=Zt.prototype;Qt.m=function(Pe,ye){ye&&ht(this.W,"rect",Ie.U,"100%",Ie.V,"100%","fill",Pe,"opacity",ye)},Qt.S=function(Pe,ye){ht(this.W,"path","fill",Pe,"d",ye)};function Bt(){ie&&_t(K)}function _t(xe,Pe,ye){$t(xe,Pe,ye,function(Te,He){if(He)return He==U?new at(new Zt(Te)):new rt(Te.getContext("2d"))})}function $t(xe,Pe,ye,Te){if(typeof xe=="string"){if(ie)for(var He=ie(xe),et=0;et<He.length;et++)$t(He[et],Pe,ye,Te);return}var We=Je(Pe)||Pe!=null&&Qe(Pe)||Je(xe.getAttribute(Z.t))||xe.hasAttribute(Z.o)&&Qe(xe.getAttribute(Z.o));if(We){var yt=Te(xe,de(xe));yt&&le(yt,We,ye)}}function rn(xe,Pe){return this.each(function(ye,Te){_t(Te,xe,Pe)}),this}var Gt=Bt;N(Gt),Gt.configure=$,Gt.drawIcon=kt,Gt.toSvg=Ft,Gt.update=_t,Gt.updateCanvas=_t,Gt.updateSvg=_t,Gt.version="3.1.1",Gt.bundle="browser-umd";var Yt=F.jQuery;Yt&&(Yt.fn.jdenticon=rn);function yn(){var xe=(Gt[S.n]||F[S.G]||{}).replaceMode;xe!="never"&&(Bt(),xe=="observe"&&te(_t))}return typeof setTimeout=="function"&&setTimeout(yn,0),Gt});const m$2=(function(){const e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",u={};function f(g,M){if(!u[g]){u[g]={};for(let F=0;F<g.length;F++)u[g][g.charAt(F)]=F}return u[g][M]}const p={compressToBase64:function(g){if(g==null)return"";const M=p._compress(g,6,function(F){return t.charAt(F)});switch(M.length%4){default:case 0:return M;case 1:return M+"===";case 2:return M+"==";case 3:return M+"="}},decompressFromBase64:function(g){return g==null?"":g==""?null:p._decompress(g.length,32,function(M){return f(t,g.charAt(M))})},compressToUTF16:function(g){return g==null?"":p._compress(g,15,function(M){return e(M+32)})+" "},decompressFromUTF16:function(g){return g==null?"":g==""?null:p._decompress(g.length,16384,function(M){return g.charCodeAt(M)-32})},compressToUint8Array:function(g){const M=p.compress(g),F=new Uint8Array(M.length*2);for(let S=0,k=M.length;S<k;S++){const N=M.charCodeAt(S);F[S*2]=N>>>8,F[S*2+1]=N%256}return F},decompressFromUint8Array:function(g){if(g==null)return p.decompress(g);{const M=new Array(g.length/2);for(let S=0,k=M.length;S<k;S++)M[S]=g[S*2]*256+g[S*2+1];const F=[];return M.forEach(function(S){F.push(e(S))}),p.decompress(F.join(""))}},compressToEncodedURIComponent:function(g){return g==null?"":p._compress(g,6,function(M){return o.charAt(M)})},decompressFromEncodedURIComponent:function(g){return g==null?"":g==""?null:(g=g.replace(/ /g,"+"),p._decompress(g.length,32,function(M){return f(o,g.charAt(M))}))},compress:function(g){return p._compress(g,16,function(M){return e(M)})},_compress:function(g,M,F){if(g==null)return"";let S,k;const N={},$={};let R="",U="",O="",Z=2,K=3,ie=2;const de=[];let te=0,re=0,ue;for(ue=0;ue<g.length;ue+=1)if(R=g.charAt(ue),Object.prototype.hasOwnProperty.call(N,R)||(N[R]=K++,$[R]=!0),U=O+R,Object.prototype.hasOwnProperty.call(N,U))O=U;else{if(Object.prototype.hasOwnProperty.call($,O)){if(O.charCodeAt(0)<256){for(S=0;S<ie;S++)te=te<<1,re==M-1?(re=0,de.push(F(te)),te=0):re++;for(k=O.charCodeAt(0),S=0;S<8;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1}else{for(k=1,S=0;S<ie;S++)te=te<<1|k,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=0;for(k=O.charCodeAt(0),S=0;S<16;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1}Z--,Z==0&&(Z=Math.pow(2,ie),ie++),delete $[O]}else for(k=N[O],S=0;S<ie;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1;Z--,Z==0&&(Z=Math.pow(2,ie),ie++),N[U]=K++,O=String(R)}if(O!==""){if(Object.prototype.hasOwnProperty.call($,O)){if(O.charCodeAt(0)<256){for(S=0;S<ie;S++)te=te<<1,re==M-1?(re=0,de.push(F(te)),te=0):re++;for(k=O.charCodeAt(0),S=0;S<8;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1}else{for(k=1,S=0;S<ie;S++)te=te<<1|k,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=0;for(k=O.charCodeAt(0),S=0;S<16;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1}Z--,Z==0&&(Z=Math.pow(2,ie),ie++),delete $[O]}else for(k=N[O],S=0;S<ie;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1;Z--,Z==0&&(Z=Math.pow(2,ie),ie++)}for(k=2,S=0;S<ie;S++)te=te<<1|k&1,re==M-1?(re=0,de.push(F(te)),te=0):re++,k=k>>1;for(;;)if(te=te<<1,re==M-1){de.push(F(te));break}else re++;return de.join("")},decompress:function(g){return g==null?"":g==""?null:p._decompress(g.length,32768,function(M){return g.charCodeAt(M)})},_decompress:function(g,M,F){const S=[];let k=4,N=4,$=3,R="";const U=[];let O,Z,K,ie,de,te,re;const ue={val:F(0),position:M,index:1};for(O=0;O<3;O+=1)S[O]=String(O);for(K=0,de=Math.pow(2,2),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;switch(K){case 0:for(K=0,de=Math.pow(2,8),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;re=e(K);break;case 1:for(K=0,de=Math.pow(2,16),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;re=e(K);break;case 2:return""}for(S[3]=String(re),Z=String(re),U.push(String(re));;){if(ue.index>g)return"";for(K=0,de=Math.pow(2,$),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;switch(re=K){case 0:for(K=0,de=Math.pow(2,8),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;S[N++]=e(K),re=N-1,k--;break;case 1:for(K=0,de=Math.pow(2,16),te=1;te!=de;)ie=ue.val&ue.position,ue.position>>=1,ue.position==0&&(ue.position=M,ue.val=F(ue.index++)),K|=(ie>0?1:0)*te,te<<=1;S[N++]=e(K),re=N-1,k--;break;case 2:return U.join("")}if(k==0&&(k=Math.pow(2,$),$++),S[re])R=String(S[re]);else if(re===N)R=Z+Z.charAt(0);else return null;U.push(R),S[N++]=Z+R.charAt(0),k--,Z=R,k==0&&(k=Math.pow(2,$),$++)}}};return p})();(function(e,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.CodeMirror=t())})(void 0,(function(){var e=navigator.userAgent,t=navigator.platform,o=/gecko\/\d/i.test(e),u=/MSIE \d/.test(e),f=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),p=/Edge\/(\d+)/.exec(e),g=u||f||p,M=g&&(u?document.documentMode||6:+(p||f)[1]),F=!p&&/WebKit\//.test(e),S=F&&/Qt\/\d+\.\d+/.test(e),k=!p&&/Chrome\//.test(e),N=/Opera\//.test(e),$=/Apple Computer/.test(navigator.vendor),R=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),U=/PhantomJS/.test(e),O=$&&(/Mobile\/\w+/.test(e)||navigator.maxTouchPoints>2),Z=/Android/.test(e),K=O||Z||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),ie=O||/Mac/.test(t),de=/\bCrOS\b/.test(e),te=/win/i.test(t),re=N&&e.match(/Version\/(\d*\.\d*)/);re&&(re=Number(re[1])),re&&re>=15&&(N=!1,F=!0);var ue=ie&&(S||N&&(re==null||re<12.11)),ve=o||g&&M>=9;function Ae(a){return new RegExp("(^|\\s)"+a+"(?:$|\\s)\\s*")}var Fe=function(a,l){var b=a.className,d=Ae(l).exec(b);if(d){var A=b.slice(d.index+d[0].length);a.className=b.slice(0,d.index)+(A?d[1]+A:"")}};function we(a){for(var l=a.childNodes.length;l>0;--l)a.removeChild(a.firstChild);return a}function Ce(a,l){return we(a).appendChild(l)}function be(a,l,b,d){var A=document.createElement(a);if(b&&(A.className=b),d&&(A.style.cssText=d),typeof l=="string")A.appendChild(document.createTextNode(l));else if(l)for(var E=0;E<l.length;++E)A.appendChild(l[E]);return A}function le(a,l,b,d){var A=be(a,l,b,d);return A.setAttribute("role","presentation"),A}var Ze;document.createRange?Ze=function(a,l,b,d){var A=document.createRange();return A.setEnd(d||a,b),A.setStart(a,l),A}:Ze=function(a,l,b){var d=document.body.createTextRange();try{d.moveToElementText(a.parentNode)}catch{return d}return d.collapse(!0),d.moveEnd("character",b),d.moveStart("character",l),d};function Je(a,l){if(l.nodeType==3&&(l=l.parentNode),a.contains)return a.contains(l);do if(l.nodeType==11&&(l=l.host),l==a)return!0;while(l=l.parentNode)}function Qe(){var a;try{a=document.activeElement}catch{a=document.body||null}for(;a&&a.shadowRoot&&a.shadowRoot.activeElement;)a=a.shadowRoot.activeElement;return a}function rt(a,l){var b=a.className;Ae(l).test(b)||(a.className+=(b?" ":"")+l)}function tt(a,l){for(var b=a.split(" "),d=0;d<b.length;d++)b[d]&&!Ae(b[d]).test(l)&&(l+=" "+b[d]);return l}var kt=function(a){a.select()};O?kt=function(a){a.selectionStart=0,a.selectionEnd=a.value.length}:g&&(kt=function(a){try{a.select()}catch{}});function Lt(a){var l=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,l)}}function Tt(a,l,b){l||(l={});for(var d in a)a.hasOwnProperty(d)&&(b!==!1||!l.hasOwnProperty(d))&&(l[d]=a[d]);return l}function ke(a,l,b,d,A){l==null&&(l=a.search(/[^\s\u00a0]/),l==-1&&(l=a.length));for(var E=d||0,L=A||0;;){var V=a.indexOf("	",E);if(V<0||V>=l)return L+(l-E);L+=V-E,L+=b-L%b,E=V+1}}var at=function(){this.id=null,this.f=null,this.time=0,this.handler=Lt(this.onTimeout,this)};at.prototype.onTimeout=function(a){a.id=0,a.time<=+new Date?a.f():setTimeout(a.handler,a.time-+new Date)},at.prototype.set=function(a,l){this.f=l;var b=+new Date+a;(!this.id||b<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,a),this.time=b)};function je(a,l){for(var b=0;b<a.length;++b)if(a[b]==l)return b;return-1}var Ie=50,nt={toString:function(){return"CodeMirror.Pass"}},pt={scroll:!1},Ft={origin:"*mouse"},ht={origin:"+move"};function Zt(a,l,b){for(var d=0,A=0;;){var E=a.indexOf("	",d);E==-1&&(E=a.length);var L=E-d;if(E==a.length||A+L>=l)return d+Math.min(L,l-A);if(A+=E-d,A+=b-A%b,d=E+1,A>=l)return d}}var Qt=[""];function Bt(a){for(;Qt.length<=a;)Qt.push(_t(Qt)+" ");return Qt[a]}function _t(a){return a[a.length-1]}function $t(a,l){for(var b=[],d=0;d<a.length;d++)b[d]=l(a[d],d);return b}function rn(a,l,b){for(var d=0,A=b(l);d<a.length&&b(a[d])<=A;)d++;a.splice(d,0,l)}function Gt(){}function Yt(a,l){var b;return Object.create?b=Object.create(a):(Gt.prototype=a,b=new Gt),l&&Tt(l,b),b}var yn=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function xe(a){return/\w/.test(a)||a>""&&(a.toUpperCase()!=a.toLowerCase()||yn.test(a))}function Pe(a,l){return l?l.source.indexOf("\\w")>-1&&xe(a)?!0:l.test(a):xe(a)}function ye(a){for(var l in a)if(a.hasOwnProperty(l)&&a[l])return!1;return!0}var Te=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function He(a){return a.charCodeAt(0)>=768&&Te.test(a)}function et(a,l,b){for(;(b<0?l>0:l<a.length)&&He(a.charAt(l));)l+=b;return l}function We(a,l,b){for(var d=l>b?-1:1;;){if(l==b)return l;var A=(l+b)/2,E=d<0?Math.ceil(A):Math.floor(A);if(E==l)return a(E)?l:b;a(E)?b=E:l=E+d}}function yt(a,l,b,d){if(!a)return d(l,b,"ltr",0);for(var A=!1,E=0;E<a.length;++E){var L=a[E];(L.from<b&&L.to>l||l==b&&L.to==l)&&(d(Math.max(L.from,l),Math.min(L.to,b),L.level==1?"rtl":"ltr",E),A=!0)}A||d(l,b,"ltr")}var $e=null;function Ye(a,l,b){var d;$e=null;for(var A=0;A<a.length;++A){var E=a[A];if(E.from<l&&E.to>l)return A;E.to==l&&(E.from!=E.to&&b=="before"?d=A:$e=A),E.from==l&&(E.from!=E.to&&b!="before"?d=A:$e=A)}return d??$e}var mt=(function(){var a="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",l="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function b(j){return j<=247?a.charAt(j):1424<=j&&j<=1524?"R":1536<=j&&j<=1785?l.charAt(j-1536):1774<=j&&j<=2220?"r":8192<=j&&j<=8203?"w":j==8204?"b":"L"}var d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,A=/[stwN]/,E=/[LRr]/,L=/[Lb1n]/,V=/[1n]/;function z(j,fe,me){this.level=j,this.from=fe,this.to=me}return function(j,fe){var me=fe=="ltr"?"L":"R";if(j.length==0||fe=="ltr"&&!d.test(j))return!1;for(var Se=j.length,Me=[],Ee=0;Ee<Se;++Ee)Me.push(b(j.charCodeAt(Ee)));for(var Re=0,ze=me;Re<Se;++Re){var Ke=Me[Re];Ke=="m"?Me[Re]=ze:ze=Ke}for(var it=0,qe=me;it<Se;++it){var ct=Me[it];ct=="1"&&qe=="r"?Me[it]="n":E.test(ct)&&(qe=ct,ct=="r"&&(Me[it]="R"))}for(var Mt=1,At=Me[0];Mt<Se-1;++Mt){var Ot=Me[Mt];Ot=="+"&&At=="1"&&Me[Mt+1]=="1"?Me[Mt]="1":Ot==","&&At==Me[Mt+1]&&(At=="1"||At=="n")&&(Me[Mt]=At),At=Ot}for(var nn=0;nn<Se;++nn){var xn=Me[nn];if(xn==",")Me[nn]="N";else if(xn=="%"){var un=void 0;for(un=nn+1;un<Se&&Me[un]=="%";++un);for(var Hn=nn&&Me[nn-1]=="!"||un<Se&&Me[un]=="1"?"1":"N",On=nn;On<un;++On)Me[On]=Hn;nn=un-1}}for(var gn=0,Wn=me;gn<Se;++gn){var Sn=Me[gn];Wn=="L"&&Sn=="1"?Me[gn]="L":E.test(Sn)&&(Wn=Sn)}for(var vn=0;vn<Se;++vn)if(A.test(Me[vn])){var _n=void 0;for(_n=vn+1;_n<Se&&A.test(Me[_n]);++_n);for(var cn=(vn?Me[vn-1]:me)=="L",Xn=(_n<Se?Me[_n]:me)=="L",Ei=cn==Xn?cn?"L":"R":me,Vr=vn;Vr<_n;++Vr)Me[Vr]=Ei;vn=_n-1}for(var Fn=[],_r,Pn=0;Pn<Se;)if(L.test(Me[Pn])){var na=Pn;for(++Pn;Pn<Se&&L.test(Me[Pn]);++Pn);Fn.push(new z(0,na,Pn))}else{var Pr=Pn,si=Fn.length,oi=fe=="rtl"?1:0;for(++Pn;Pn<Se&&Me[Pn]!="L";++Pn);for(var Ln=Pr;Ln<Pn;)if(V.test(Me[Ln])){Pr<Ln&&(Fn.splice(si,0,new z(1,Pr,Ln)),si+=oi);var ki=Ln;for(++Ln;Ln<Pn&&V.test(Me[Ln]);++Ln);Fn.splice(si,0,new z(2,ki,Ln)),si+=oi,Pr=Ln}else++Ln;Pr<Pn&&Fn.splice(si,0,new z(1,Pr,Pn))}return fe=="ltr"&&(Fn[0].level==1&&(_r=j.match(/^\s+/))&&(Fn[0].from=_r[0].length,Fn.unshift(new z(0,0,_r[0].length))),_t(Fn).level==1&&(_r=j.match(/\s+$/))&&(_t(Fn).to-=_r[0].length,Fn.push(new z(0,Se-_r[0].length,Se)))),fe=="rtl"?Fn.reverse():Fn}})();function It(a,l){var b=a.order;return b==null&&(b=a.order=mt(a.text,l)),b}var zt=[],Ue=function(a,l,b){if(a.addEventListener)a.addEventListener(l,b,!1);else if(a.attachEvent)a.attachEvent("on"+l,b);else{var d=a._handlers||(a._handlers={});d[l]=(d[l]||zt).concat(b)}};function Et(a,l){return a._handlers&&a._handlers[l]||zt}function Ht(a,l,b){if(a.removeEventListener)a.removeEventListener(l,b,!1);else if(a.detachEvent)a.detachEvent("on"+l,b);else{var d=a._handlers,A=d&&d[l];if(A){var E=je(A,b);E>-1&&(d[l]=A.slice(0,E).concat(A.slice(E+1)))}}}function Oe(a,l){var b=Et(a,l);if(b.length)for(var d=Array.prototype.slice.call(arguments,2),A=0;A<b.length;++A)b[A].apply(null,d)}function Wt(a,l,b){return typeof l=="string"&&(l={type:l,preventDefault:function(){this.defaultPrevented=!0}}),Oe(a,b||l.type,a,l),Kt(l)||l.codemirrorIgnore}function sn(a){var l=a._handlers&&a._handlers.cursorActivity;if(l)for(var b=a.curOp.cursorActivityHandlers||(a.curOp.cursorActivityHandlers=[]),d=0;d<l.length;++d)je(b,l[d])==-1&&b.push(l[d])}function ot(a,l){return Et(a,l).length>0}function Pt(a){a.prototype.on=function(l,b){Ue(this,l,b)},a.prototype.off=function(l,b){Ht(this,l,b)}}function Dt(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function Ut(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function Kt(a){return a.defaultPrevented!=null?a.defaultPrevented:a.returnValue==!1}function ln(a){Dt(a),Ut(a)}function hn(a){return a.target||a.srcElement}function B(a){var l=a.which;return l==null&&(a.button&1?l=1:a.button&2?l=3:a.button&4&&(l=2)),ie&&a.ctrlKey&&l==1&&(l=3),l}var se=(function(){if(g&&M<9)return!1;var a=be("div");return"draggable"in a||"dragDrop"in a})(),ee;function oe(a){if(ee==null){var l=be("span","​");Ce(a,be("span",[l,document.createTextNode("x")])),a.firstChild.offsetHeight!=0&&(ee=l.offsetWidth<=1&&l.offsetHeight>2&&!(g&&M<8))}var b=ee?be("span","​"):be("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return b.setAttribute("cm-text",""),b}var pe;function De(a){if(pe!=null)return pe;var l=Ce(a,document.createTextNode("AخA")),b=Ze(l,0,1).getBoundingClientRect(),d=Ze(l,1,2).getBoundingClientRect();return we(a),!b||b.left==b.right?!1:pe=d.right-b.right<3}var Ge=`

b`.split(/\n/).length!=3?function(a){for(var l=0,b=[],d=a.length;l<=d;){var A=a.indexOf(`
`,l);A==-1&&(A=a.length);var E=a.slice(l,a.charAt(A-1)=="\r"?A-1:A),L=E.indexOf("\r");L!=-1?(b.push(E.slice(0,L)),l+=L+1):(b.push(E),l=A+1)}return b}:function(a){return a.split(/\r\n?|\n/)},Ve=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch{return!1}}:function(a){var l;try{l=a.ownerDocument.selection.createRange()}catch{}return!l||l.parentElement()!=a?!1:l.compareEndPoints("StartToEnd",l)!=0},ut=(function(){var a=be("div");return"oncopy"in a?!0:(a.setAttribute("oncopy","return;"),typeof a.oncopy=="function")})(),Rt=null;function Jt(a){if(Rt!=null)return Rt;var l=Ce(a,be("span","x")),b=l.getBoundingClientRect(),d=Ze(l,0,1).getBoundingClientRect();return Rt=Math.abs(b.left-d.left)>1}var fn={},pn={};function yr(a,l){arguments.length>2&&(l.dependencies=Array.prototype.slice.call(arguments,2)),fn[a]=l}function Vn(a,l){pn[a]=l}function bn(a){if(typeof a=="string"&&pn.hasOwnProperty(a))a=pn[a];else if(a&&typeof a.name=="string"&&pn.hasOwnProperty(a.name)){var l=pn[a.name];typeof l=="string"&&(l={name:l}),a=Yt(l,a),a.name=l.name}else{if(typeof a=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return bn("application/xml");if(typeof a=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(a))return bn("application/json")}return typeof a=="string"?{name:a}:a||{name:"null"}}function Sr(a,l){l=bn(l);var b=fn[l.name];if(!b)return Sr(a,"text/plain");var d=b(a,l);if(Un.hasOwnProperty(l.name)){var A=Un[l.name];for(var E in A)A.hasOwnProperty(E)&&(d.hasOwnProperty(E)&&(d["_"+E]=d[E]),d[E]=A[E])}if(d.name=l.name,l.helperType&&(d.helperType=l.helperType),l.modeProps)for(var L in l.modeProps)d[L]=l.modeProps[L];return d}var Un={};function jn(a,l){var b=Un.hasOwnProperty(a)?Un[a]:Un[a]={};Tt(l,b)}function Gn(a,l){if(l===!0)return l;if(a.copyState)return a.copyState(l);var b={};for(var d in l){var A=l[d];A instanceof Array&&(A=A.concat([])),b[d]=A}return b}function Zr(a,l){for(var b;a.innerMode&&(b=a.innerMode(l),!(!b||b.mode==a));)l=b.state,a=b.mode;return b||{mode:a,state:l}}function zr(a,l,b){return a.startState?a.startState(l,b):!0}var on=function(a,l,b){this.pos=this.start=0,this.string=a,this.tabSize=l||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=b};on.prototype.eol=function(){return this.pos>=this.string.length},on.prototype.sol=function(){return this.pos==this.lineStart},on.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},on.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},on.prototype.eat=function(a){var l=this.string.charAt(this.pos),b;if(typeof a=="string"?b=l==a:b=l&&(a.test?a.test(l):a(l)),b)return++this.pos,l},on.prototype.eatWhile=function(a){for(var l=this.pos;this.eat(a););return this.pos>l},on.prototype.eatSpace=function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},on.prototype.skipToEnd=function(){this.pos=this.string.length},on.prototype.skipTo=function(a){var l=this.string.indexOf(a,this.pos);if(l>-1)return this.pos=l,!0},on.prototype.backUp=function(a){this.pos-=a},on.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ke(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ke(this.string,this.lineStart,this.tabSize):0)},on.prototype.indentation=function(){return ke(this.string,null,this.tabSize)-(this.lineStart?ke(this.string,this.lineStart,this.tabSize):0)},on.prototype.match=function(a,l,b){if(typeof a=="string"){var d=function(L){return b?L.toLowerCase():L},A=this.string.substr(this.pos,a.length);if(d(A)==d(a))return l!==!1&&(this.pos+=a.length),!0}else{var E=this.string.slice(this.pos).match(a);return E&&E.index>0?null:(E&&l!==!1&&(this.pos+=E[0].length),E)}},on.prototype.current=function(){return this.string.slice(this.start,this.pos)},on.prototype.hideFirstChars=function(a,l){this.lineStart+=a;try{return l()}finally{this.lineStart-=a}},on.prototype.lookAhead=function(a){var l=this.lineOracle;return l&&l.lookAhead(a)},on.prototype.baseToken=function(){var a=this.lineOracle;return a&&a.baseToken(this.pos)};function ft(a,l){if(l-=a.first,l<0||l>=a.size)throw new Error("There is no line "+(l+a.first)+" in the document.");for(var b=a;!b.lines;)for(var d=0;;++d){var A=b.children[d],E=A.chunkSize();if(l<E){b=A;break}l-=E}return b.lines[l]}function Jn(a,l,b){var d=[],A=l.line;return a.iter(l.line,b.line+1,function(E){var L=E.text;A==b.line&&(L=L.slice(0,b.ch)),A==l.line&&(L=L.slice(l.ch)),d.push(L),++A}),d}function Hr(a,l,b){var d=[];return a.iter(l,b,function(A){d.push(A.text)}),d}function En(a,l){var b=l-a.height;if(b)for(var d=a;d;d=d.parent)d.height+=b}function jt(a){if(a.parent==null)return null;for(var l=a.parent,b=je(l.lines,a),d=l.parent;d;l=d,d=d.parent)for(var A=0;d.children[A]!=l;++A)b+=d.children[A].chunkSize();return b+l.first}function Qn(a,l){var b=a.first;e:do{for(var d=0;d<a.children.length;++d){var A=a.children[d],E=A.height;if(l<E){a=A;continue e}l-=E,b+=A.chunkSize()}return b}while(!a.lines);for(var L=0;L<a.lines.length;++L){var V=a.lines[L],z=V.height;if(l<z)break;l-=z}return b+L}function vr(a,l){return l>=a.first&&l<a.first+a.size}function Ur(a,l){return String(a.lineNumberFormatter(l+a.firstLineNumber))}function Be(a,l,b){if(b===void 0&&(b=null),!(this instanceof Be))return new Be(a,l,b);this.line=a,this.ch=l,this.sticky=b}function q(a,l){return a.line-l.line||a.ch-l.ch}function ge(a,l){return a.sticky==l.sticky&&q(a,l)==0}function Ne(a){return Be(a.line,a.ch)}function Xe(a,l){return q(a,l)<0?l:a}function St(a,l){return q(a,l)<0?a:l}function Vt(a,l){return Math.max(a.first,Math.min(l,a.first+a.size-1))}function st(a,l){if(l.line<a.first)return Be(a.first,0);var b=a.first+a.size-1;return l.line>b?Be(b,ft(a,b).text.length):An(l,ft(a,l.line).text.length)}function An(a,l){var b=a.ch;return b==null||b>l?Be(a.line,l):b<0?Be(a.line,0):a}function Rn(a,l){for(var b=[],d=0;d<l.length;d++)b[d]=st(a,l[d]);return b}var wr=function(a,l){this.state=a,this.lookAhead=l},er=function(a,l,b,d){this.state=l,this.doc=a,this.line=b,this.maxLookAhead=d||0,this.baseTokens=null,this.baseTokenPos=1};er.prototype.lookAhead=function(a){var l=this.doc.getLine(this.line+a);return l!=null&&a>this.maxLookAhead&&(this.maxLookAhead=a),l},er.prototype.baseToken=function(a){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=a;)this.baseTokenPos+=2;var l=this.baseTokens[this.baseTokenPos+1];return{type:l&&l.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-a}},er.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},er.fromSaved=function(a,l,b){return l instanceof wr?new er(a,Gn(a.mode,l.state),b,l.lookAhead):new er(a,Gn(a.mode,l),b)},er.prototype.save=function(a){var l=a!==!1?Gn(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new wr(l,this.maxLookAhead):l};function cs(a,l,b,d){var A=[a.state.modeGen],E={};gs(a,l.text,a.doc.mode,b,function(j,fe){return A.push(j,fe)},E,d);for(var L=b.state,V=function(j){b.baseTokens=A;var fe=a.state.overlays[j],me=1,Se=0;b.state=!0,gs(a,l.text,fe.mode,b,function(Me,Ee){for(var Re=me;Se<Me;){var ze=A[me];ze>Me&&A.splice(me,1,Me,A[me+1],ze),me+=2,Se=Math.min(Me,ze)}if(Ee)if(fe.opaque)A.splice(Re,me-Re,Me,"overlay "+Ee),me=Re+2;else for(;Re<me;Re+=2){var Ke=A[Re+1];A[Re+1]=(Ke?Ke+" ":"")+"overlay "+Ee}},E),b.state=L,b.baseTokens=null,b.baseTokenPos=1},z=0;z<a.state.overlays.length;++z)V(z);return{styles:A,classes:E.bgClass||E.textClass?E:null}}function fs(a,l,b){if(!l.styles||l.styles[0]!=a.state.modeGen){var d=jr(a,jt(l)),A=l.text.length>a.options.maxHighlightLength&&Gn(a.doc.mode,d.state),E=cs(a,l,d);A&&(d.state=A),l.stateAfter=d.save(!A),l.styles=E.styles,E.classes?l.styleClasses=E.classes:l.styleClasses&&(l.styleClasses=null),b===a.doc.highlightFrontier&&(a.doc.modeFrontier=Math.max(a.doc.modeFrontier,++a.doc.highlightFrontier))}return l.styles}function jr(a,l,b){var d=a.doc,A=a.display;if(!d.mode.startState)return new er(d,!0,l);var E=no(a,l,b),L=E>d.first&&ft(d,E-1).stateAfter,V=L?er.fromSaved(d,L,E):new er(d,zr(d.mode),E);return d.iter(E,l,function(z){Ti(a,z.text,V);var j=V.line;z.stateAfter=j==l-1||j%5==0||j>=A.viewFrom&&j<A.viewTo?V.save():null,V.nextLine()}),b&&(d.modeFrontier=V.line),V}function Ti(a,l,b,d){var A=a.doc.mode,E=new on(l,a.options.tabSize,b);for(E.start=E.pos=d||0,l==""&&Ni(A,b.state);!E.eol();)Li(A,E,b.state),E.start=E.pos}function Ni(a,l){if(a.blankLine)return a.blankLine(l);if(a.innerMode){var b=Zr(a,l);if(b.mode.blankLine)return b.mode.blankLine(b.state)}}function Li(a,l,b,d){for(var A=0;A<10;A++){d&&(d[0]=Zr(a,b).mode);var E=a.token(l,b);if(l.pos>l.start)return E}throw new Error("Mode "+a.name+" failed to advance stream.")}var ps=function(a,l,b){this.start=a.start,this.end=a.pos,this.string=a.current(),this.type=l||null,this.state=b};function hs(a,l,b,d){var A=a.doc,E=A.mode,L;l=st(A,l);var V=ft(A,l.line),z=jr(a,l.line,b),j=new on(V.text,a.options.tabSize,z),fe;for(d&&(fe=[]);(d||j.pos<l.ch)&&!j.eol();)j.start=j.pos,L=Li(E,j,z.state),d&&fe.push(new ps(j,L,Gn(A.mode,z.state)));return d?fe:new ps(j,L,z.state)}function ms(a,l){if(a)for(;;){var b=a.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!b)break;a=a.slice(0,b.index)+a.slice(b.index+b[0].length);var d=b[1]?"bgClass":"textClass";l[d]==null?l[d]=b[2]:new RegExp("(?:^|\\s)"+b[2]+"(?:$|\\s)").test(l[d])||(l[d]+=" "+b[2])}return a}function gs(a,l,b,d,A,E,L){var V=b.flattenSpans;V==null&&(V=a.options.flattenSpans);var z=0,j=null,fe=new on(l,a.options.tabSize,d),me,Se=a.options.addModeClass&&[null];for(l==""&&ms(Ni(b,d.state),E);!fe.eol();){if(fe.pos>a.options.maxHighlightLength?(V=!1,L&&Ti(a,l,d,fe.pos),fe.pos=l.length,me=null):me=ms(Li(b,fe,d.state,Se),E),Se){var Me=Se[0].name;Me&&(me="m-"+(me?Me+" "+me:Me))}if(!V||j!=me){for(;z<fe.start;)z=Math.min(fe.start,z+5e3),A(z,j);j=me}fe.start=fe.pos}for(;z<fe.pos;){var Ee=Math.min(fe.pos,z+5e3);A(Ee,j),z=Ee}}function no(a,l,b){for(var d,A,E=a.doc,L=b?-1:l-(a.doc.mode.innerMode?1e3:100),V=l;V>L;--V){if(V<=E.first)return E.first;var z=ft(E,V-1),j=z.stateAfter;if(j&&(!b||V+(j instanceof wr?j.lookAhead:0)<=E.modeFrontier))return V;var fe=ke(z.text,null,a.options.tabSize);(A==null||d>fe)&&(A=V-1,d=fe)}return A}function ro(a,l){if(a.modeFrontier=Math.min(a.modeFrontier,l),!(a.highlightFrontier<l-10)){for(var b=a.first,d=l-1;d>b;d--){var A=ft(a,d).stateAfter;if(A&&(!(A instanceof wr)||d+A.lookAhead<l)){b=d+1;break}}a.highlightFrontier=Math.min(a.highlightFrontier,b)}}var _s=!1,he=!1;function Nt(){_s=!0}function Dr(){he=!0}function kn(a,l,b){this.marker=a,this.from=l,this.to=b}function hr(a,l){if(a)for(var b=0;b<a.length;++b){var d=a[b];if(d.marker==l)return d}}function vt(a,l){for(var b,d=0;d<a.length;++d)a[d]!=l&&(b||(b=[])).push(a[d]);return b}function Yr(a,l,b){var d=b&&window.WeakSet&&(b.markedSpans||(b.markedSpans=new WeakSet));d&&a.markedSpans&&d.has(a.markedSpans)?a.markedSpans.push(l):(a.markedSpans=a.markedSpans?a.markedSpans.concat([l]):[l],d&&d.add(a.markedSpans)),l.marker.attachLine(a)}function io(a,l,b){var d;if(a)for(var A=0;A<a.length;++A){var E=a[A],L=E.marker,V=E.from==null||(L.inclusiveLeft?E.from<=l:E.from<l);if(V||E.from==l&&L.type=="bookmark"&&(!b||!E.marker.insertLeft)){var z=E.to==null||(L.inclusiveRight?E.to>=l:E.to>l);(d||(d=[])).push(new kn(L,E.from,z?null:E.to))}}return d}function ys(a,l,b){var d;if(a)for(var A=0;A<a.length;++A){var E=a[A],L=E.marker,V=E.to==null||(L.inclusiveRight?E.to>=l:E.to>l);if(V||E.from==l&&L.type=="bookmark"&&(!b||E.marker.insertLeft)){var z=E.from==null||(L.inclusiveLeft?E.from<=l:E.from<l);(d||(d=[])).push(new kn(L,z?null:E.from-l,E.to==null?null:E.to-l))}}return d}function Xt(a,l){if(l.full)return null;var b=vr(a,l.from.line)&&ft(a,l.from.line).markedSpans,d=vr(a,l.to.line)&&ft(a,l.to.line).markedSpans;if(!b&&!d)return null;var A=l.from.ch,E=l.to.ch,L=q(l.from,l.to)==0,V=io(b,A,L),z=ys(d,E,L),j=l.text.length==1,fe=_t(l.text).length+(j?A:0);if(V)for(var me=0;me<V.length;++me){var Se=V[me];if(Se.to==null){var Me=hr(z,Se.marker);Me?j&&(Se.to=Me.to==null?null:Me.to+fe):Se.to=A}}if(z)for(var Ee=0;Ee<z.length;++Ee){var Re=z[Ee];if(Re.to!=null&&(Re.to+=fe),Re.from==null){var ze=hr(V,Re.marker);ze||(Re.from=fe,j&&(V||(V=[])).push(Re))}else Re.from+=fe,j&&(V||(V=[])).push(Re)}V&&(V=nr(V)),z&&z!=V&&(z=nr(z));var Ke=[V];if(!j){var it=l.text.length-2,qe;if(it>0&&V)for(var ct=0;ct<V.length;++ct)V[ct].to==null&&(qe||(qe=[])).push(new kn(V[ct].marker,null,null));for(var Mt=0;Mt<it;++Mt)Ke.push(qe);Ke.push(z)}return Ke}function nr(a){for(var l=0;l<a.length;++l){var b=a[l];b.from!=null&&b.from==b.to&&b.marker.clearWhenEmpty!==!1&&a.splice(l--,1)}return a.length?a:null}function so(a,l,b){var d=null;if(a.iter(l.line,b.line+1,function(Me){if(Me.markedSpans)for(var Ee=0;Ee<Me.markedSpans.length;++Ee){var Re=Me.markedSpans[Ee].marker;Re.readOnly&&(!d||je(d,Re)==-1)&&(d||(d=[])).push(Re)}}),!d)return null;for(var A=[{from:l,to:b}],E=0;E<d.length;++E)for(var L=d[E],V=L.find(0),z=0;z<A.length;++z){var j=A[z];if(!(q(j.to,V.from)<0||q(j.from,V.to)>0)){var fe=[z,1],me=q(j.from,V.from),Se=q(j.to,V.to);(me<0||!L.inclusiveLeft&&!me)&&fe.push({from:j.from,to:V.from}),(Se>0||!L.inclusiveRight&&!Se)&&fe.push({from:V.to,to:j.to}),A.splice.apply(A,fe),z+=fe.length-3}}return A}function ai(a){var l=a.markedSpans;if(l){for(var b=0;b<l.length;++b)l[b].marker.detachLine(a);a.markedSpans=null}}function Gi(a,l){if(l){for(var b=0;b<l.length;++b)l[b].marker.attachLine(a);a.markedSpans=l}}function Fr(a){return a.inclusiveLeft?-1:0}function Ct(a){return a.inclusiveRight?1:0}function Ri(a,l){var b=a.lines.length-l.lines.length;if(b!=0)return b;var d=a.find(),A=l.find(),E=q(d.from,A.from)||Fr(a)-Fr(l);if(E)return-E;var L=q(d.to,A.to)||Ct(a)-Ct(l);return L||l.id-a.id}function Bi(a,l){var b=he&&a.markedSpans,d;if(b)for(var A=void 0,E=0;E<b.length;++E)A=b[E],A.marker.collapsed&&(l?A.from:A.to)==null&&(!d||Ri(d,A.marker)<0)&&(d=A.marker);return d}function rr(a){return Bi(a,!0)}function ui(a){return Bi(a,!1)}function oo(a,l){var b=he&&a.markedSpans,d;if(b)for(var A=0;A<b.length;++A){var E=b[A];E.marker.collapsed&&(E.from==null||E.from<l)&&(E.to==null||E.to>l)&&(!d||Ri(d,E.marker)<0)&&(d=E.marker)}return d}function vs(a,l,b,d,A){var E=ft(a,l),L=he&&E.markedSpans;if(L)for(var V=0;V<L.length;++V){var z=L[V];if(z.marker.collapsed){var j=z.marker.find(0),fe=q(j.from,b)||Fr(z.marker)-Fr(A),me=q(j.to,d)||Ct(z.marker)-Ct(A);if(!(fe>=0&&me<=0||fe<=0&&me>=0)&&(fe<=0&&(z.marker.inclusiveRight&&A.inclusiveLeft?q(j.to,b)>=0:q(j.to,b)>0)||fe>=0&&(z.marker.inclusiveRight&&A.inclusiveLeft?q(j.from,d)<=0:q(j.from,d)<0)))return!0}}}function Yn(a){for(var l;l=rr(a);)a=l.find(-1,!0).line;return a}function ao(a){for(var l;l=ui(a);)a=l.find(1,!0).line;return a}function li(a){for(var l,b;l=ui(a);)a=l.find(1,!0).line,(b||(b=[])).push(a);return b}function $i(a,l){var b=ft(a,l),d=Yn(b);return b==d?l:jt(d)}function bs(a,l){if(l>a.lastLine())return l;var b=ft(a,l),d;if(!Bn(a,b))return l;for(;d=ui(b);)b=d.find(1,!0).line;return jt(b)+1}function Bn(a,l){var b=he&&l.markedSpans;if(b){for(var d=void 0,A=0;A<b.length;++A)if(d=b[A],!!d.marker.collapsed){if(d.from==null)return!0;if(!d.marker.widgetNode&&d.from==0&&d.marker.inclusiveLeft&&xt(a,l,d))return!0}}}function xt(a,l,b){if(b.to==null){var d=b.marker.find(1,!0);return xt(a,d.line,hr(d.line.markedSpans,b.marker))}if(b.marker.inclusiveRight&&b.to==l.text.length)return!0;for(var A=void 0,E=0;E<l.markedSpans.length;++E)if(A=l.markedSpans[E],A.marker.collapsed&&!A.marker.widgetNode&&A.from==b.to&&(A.to==null||A.to!=b.from)&&(A.marker.inclusiveLeft||b.marker.inclusiveRight)&&xt(a,l,A))return!0}function Tn(a){a=Yn(a);for(var l=0,b=a.parent,d=0;d<b.lines.length;++d){var A=b.lines[d];if(A==a)break;l+=A.height}for(var E=b.parent;E;b=E,E=b.parent)for(var L=0;L<E.children.length;++L){var V=E.children[L];if(V==b)break;l+=V.height}return l}function Kr(a){if(a.height==0)return 0;for(var l=a.text.length,b,d=a;b=rr(d);){var A=b.find(0,!0);d=A.from.line,l+=A.from.ch-A.to.ch}for(d=a;b=ui(d);){var E=b.find(0,!0);l-=d.text.length-E.from.ch,d=E.to.line,l+=d.text.length-E.to.ch}return l}function ci(a){var l=a.display,b=a.doc;l.maxLine=ft(b,b.first),l.maxLineLength=Kr(l.maxLine),l.maxLineChanged=!0,b.iter(function(d){var A=Kr(d);A>l.maxLineLength&&(l.maxLineLength=A,l.maxLine=d)})}var Kn=function(a,l,b){this.text=a,Gi(this,l),this.height=b?b(this):1};Kn.prototype.lineNo=function(){return jt(this)},Pt(Kn);function fi(a,l,b,d){a.text=l,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),a.order!=null&&(a.order=null),ai(a),Gi(a,b);var A=d?d(a):1;A!=a.height&&En(a,A)}function As(a){a.parent=null,ai(a)}var uo={},lo={};function Cs(a,l){if(!a||/^\s*$/.test(a))return null;var b=l.addModeClass?lo:uo;return b[a]||(b[a]=a.replace(/\S+/g,"cm-$&"))}function Ms(a,l){var b=le("span",null,null,F?"padding-right: .1px":null),d={pre:le("pre",[b],"CodeMirror-line"),content:b,col:0,pos:0,cm:a,trailingSpace:!1,splitSpaces:a.getOption("lineWrapping")};l.measure={};for(var A=0;A<=(l.rest?l.rest.length:0);A++){var E=A?l.rest[A-1]:l.line,L=void 0;d.pos=0,d.addToken=xs,De(a.display.measure)&&(L=It(E,a.doc.direction))&&(d.addToken=fo(d.addToken,L)),d.map=[];var V=l!=a.display.externalMeasured&&jt(E);po(E,d,fs(a,E,V)),E.styleClasses&&(E.styleClasses.bgClass&&(d.bgClass=tt(E.styleClasses.bgClass,d.bgClass||"")),E.styleClasses.textClass&&(d.textClass=tt(E.styleClasses.textClass,d.textClass||""))),d.map.length==0&&d.map.push(0,0,d.content.appendChild(oe(a.display.measure))),A==0?(l.measure.map=d.map,l.measure.cache={}):((l.measure.maps||(l.measure.maps=[])).push(d.map),(l.measure.caches||(l.measure.caches=[])).push({}))}if(F){var z=d.content.lastChild;(/\bcm-tab\b/.test(z.className)||z.querySelector&&z.querySelector(".cm-tab"))&&(d.content.className="cm-tab-wrap-hack")}return Oe(a,"renderLine",a,l.line,d.pre),d.pre.className&&(d.textClass=tt(d.pre.className,d.textClass||"")),d}function Er(a){var l=be("span","•","cm-invalidchar");return l.title="\\u"+a.charCodeAt(0).toString(16),l.setAttribute("aria-label",l.title),l}function xs(a,l,b,d,A,E,L){if(l){var V=a.splitSpaces?co(l,a.trailingSpace):l,z=a.cm.state.specialChars,j=!1,fe;if(!z.test(l))a.col+=l.length,fe=document.createTextNode(V),a.map.push(a.pos,a.pos+l.length,fe),g&&M<9&&(j=!0),a.pos+=l.length;else{fe=document.createDocumentFragment();for(var me=0;;){z.lastIndex=me;var Se=z.exec(l),Me=Se?Se.index-me:l.length-me;if(Me){var Ee=document.createTextNode(V.slice(me,me+Me));g&&M<9?fe.appendChild(be("span",[Ee])):fe.appendChild(Ee),a.map.push(a.pos,a.pos+Me,Ee),a.col+=Me,a.pos+=Me}if(!Se)break;me+=Me+1;var Re=void 0;if(Se[0]=="	"){var ze=a.cm.options.tabSize,Ke=ze-a.col%ze;Re=fe.appendChild(be("span",Bt(Ke),"cm-tab")),Re.setAttribute("role","presentation"),Re.setAttribute("cm-text","	"),a.col+=Ke}else Se[0]=="\r"||Se[0]==`
`?(Re=fe.appendChild(be("span",Se[0]=="\r"?"␍":"␤","cm-invalidchar")),Re.setAttribute("cm-text",Se[0]),a.col+=1):(Re=a.cm.options.specialCharPlaceholder(Se[0]),Re.setAttribute("cm-text",Se[0]),g&&M<9?fe.appendChild(be("span",[Re])):fe.appendChild(Re),a.col+=1);a.map.push(a.pos,a.pos+1,Re),a.pos++}}if(a.trailingSpace=V.charCodeAt(l.length-1)==32,b||d||A||j||E||L){var it=b||"";d&&(it+=d),A&&(it+=A);var qe=be("span",[fe],it,E);if(L)for(var ct in L)L.hasOwnProperty(ct)&&ct!="style"&&ct!="class"&&qe.setAttribute(ct,L[ct]);return a.content.appendChild(qe)}a.content.appendChild(fe)}}function co(a,l){if(a.length>1&&!/  /.test(a))return a;for(var b=l,d="",A=0;A<a.length;A++){var E=a.charAt(A);E==" "&&b&&(A==a.length-1||a.charCodeAt(A+1)==32)&&(E=" "),d+=E,b=E==" "}return d}function fo(a,l){return function(b,d,A,E,L,V,z){A=A?A+" cm-force-border":"cm-force-border";for(var j=b.pos,fe=j+d.length;;){for(var me=void 0,Se=0;Se<l.length&&(me=l[Se],!(me.to>j&&me.from<=j));Se++);if(me.to>=fe)return a(b,d,A,E,L,V,z);a(b,d.slice(0,me.to-j),A,E,null,V,z),E=null,d=d.slice(me.to-j),j=me.to}}}function Ps(a,l,b,d){var A=!d&&b.widgetNode;A&&a.map.push(a.pos,a.pos+l,A),!d&&a.cm.display.input.needsContentAttribute&&(A||(A=a.content.appendChild(document.createElement("span"))),A.setAttribute("cm-marker",b.id)),A&&(a.cm.display.input.setUneditable(A),a.content.appendChild(A)),a.pos+=l,a.trailingSpace=!1}function po(a,l,b){var d=a.markedSpans,A=a.text,E=0;if(!d){for(var L=1;L<b.length;L+=2)l.addToken(l,A.slice(E,E=b[L]),Cs(b[L+1],l.cm.options));return}for(var V=A.length,z=0,j=1,fe="",me,Se,Me=0,Ee,Re,ze,Ke,it;;){if(Me==z){Ee=Re=ze=Se="",it=null,Ke=null,Me=1/0;for(var qe=[],ct=void 0,Mt=0;Mt<d.length;++Mt){var At=d[Mt],Ot=At.marker;if(Ot.type=="bookmark"&&At.from==z&&Ot.widgetNode)qe.push(Ot);else if(At.from<=z&&(At.to==null||At.to>z||Ot.collapsed&&At.to==z&&At.from==z)){if(At.to!=null&&At.to!=z&&Me>At.to&&(Me=At.to,Re=""),Ot.className&&(Ee+=" "+Ot.className),Ot.css&&(Se=(Se?Se+";":"")+Ot.css),Ot.startStyle&&At.from==z&&(ze+=" "+Ot.startStyle),Ot.endStyle&&At.to==Me&&(ct||(ct=[])).push(Ot.endStyle,At.to),Ot.title&&((it||(it={})).title=Ot.title),Ot.attributes)for(var nn in Ot.attributes)(it||(it={}))[nn]=Ot.attributes[nn];Ot.collapsed&&(!Ke||Ri(Ke.marker,Ot)<0)&&(Ke=At)}else At.from>z&&Me>At.from&&(Me=At.from)}if(ct)for(var xn=0;xn<ct.length;xn+=2)ct[xn+1]==Me&&(Re+=" "+ct[xn]);if(!Ke||Ke.from==z)for(var un=0;un<qe.length;++un)Ps(l,0,qe[un]);if(Ke&&(Ke.from||0)==z){if(Ps(l,(Ke.to==null?V+1:Ke.to)-z,Ke.marker,Ke.from==null),Ke.to==null)return;Ke.to==z&&(Ke=!1)}}if(z>=V)break;for(var Hn=Math.min(V,Me);;){if(fe){var On=z+fe.length;if(!Ke){var gn=On>Hn?fe.slice(0,Hn-z):fe;l.addToken(l,gn,me?me+Ee:Ee,ze,z+gn.length==Me?Re:"",Se,it)}if(On>=Hn){fe=fe.slice(Hn-z),z=Hn;break}z=On,ze=""}fe=A.slice(E,E=b[j++]),me=Cs(b[j++],l.cm.options)}}}function Ss(a,l,b){this.line=l,this.rest=li(l),this.size=this.rest?jt(_t(this.rest))-b+1:1,this.node=this.text=null,this.hidden=Bn(a,l)}function pi(a,l,b){for(var d=[],A,E=l;E<b;E=A){var L=new Ss(a.doc,ft(a.doc,E),E);A=E+L.size,d.push(L)}return d}var kr=null;function ho(a){kr?kr.ops.push(a):a.ownsGroup=kr={ops:[a],delayedCallbacks:[]}}function qr(a){var l=a.delayedCallbacks,b=0;do{for(;b<l.length;b++)l[b].call(null);for(var d=0;d<a.ops.length;d++){var A=a.ops[d];if(A.cursorActivityHandlers)for(;A.cursorActivityCalled<A.cursorActivityHandlers.length;)A.cursorActivityHandlers[A.cursorActivityCalled++].call(null,A.cm)}}while(b<l.length)}function mr(a,l){var b=a.ownsGroup;if(b)try{qr(b)}finally{kr=null,l(b)}}var Tr=null;function mn(a,l){var b=Et(a,l);if(b.length){var d=Array.prototype.slice.call(arguments,2),A;kr?A=kr.delayedCallbacks:Tr?A=Tr:(A=Tr=[],setTimeout(mo,0));for(var E=function(V){A.push(function(){return b[V].apply(null,d)})},L=0;L<b.length;++L)E(L)}}function mo(){var a=Tr;Tr=null;for(var l=0;l<a.length;++l)a[l]()}function Ii(a,l,b,d){for(var A=0;A<l.changes.length;A++){var E=l.changes[A];E=="text"?_o(a,l):E=="gutter"?Ds(a,l,b,d):E=="class"?Oi(a,l):E=="widget"&&yo(a,l,d)}l.changes=null}function Nr(a){return a.node==a.text&&(a.node=be("div",null,null,"position: relative"),a.text.parentNode&&a.text.parentNode.replaceChild(a.node,a.text),a.node.appendChild(a.text),g&&M<8&&(a.node.style.zIndex=2)),a.node}function go(a,l){var b=l.bgClass?l.bgClass+" "+(l.line.bgClass||""):l.line.bgClass;if(b&&(b+=" CodeMirror-linebackground"),l.background)b?l.background.className=b:(l.background.parentNode.removeChild(l.background),l.background=null);else if(b){var d=Nr(l);l.background=d.insertBefore(be("div",null,b),d.firstChild),a.display.input.setUneditable(l.background)}}function ws(a,l){var b=a.display.externalMeasured;return b&&b.line==l.line?(a.display.externalMeasured=null,l.measure=b.measure,b.built):Ms(a,l)}function _o(a,l){var b=l.text.className,d=ws(a,l);l.text==l.node&&(l.node=d.pre),l.text.parentNode.replaceChild(d.pre,l.text),l.text=d.pre,d.bgClass!=l.bgClass||d.textClass!=l.textClass?(l.bgClass=d.bgClass,l.textClass=d.textClass,Oi(a,l)):b&&(l.text.className=b)}function Oi(a,l){go(a,l),l.line.wrapClass?Nr(l).className=l.line.wrapClass:l.node!=l.text&&(l.node.className="");var b=l.textClass?l.textClass+" "+(l.line.textClass||""):l.line.textClass;l.text.className=b||""}function Ds(a,l,b,d){if(l.gutter&&(l.node.removeChild(l.gutter),l.gutter=null),l.gutterBackground&&(l.node.removeChild(l.gutterBackground),l.gutterBackground=null),l.line.gutterClass){var A=Nr(l);l.gutterBackground=be("div",null,"CodeMirror-gutter-background "+l.line.gutterClass,"left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px; width: "+d.gutterTotalWidth+"px"),a.display.input.setUneditable(l.gutterBackground),A.insertBefore(l.gutterBackground,l.text)}var E=l.line.gutterMarkers;if(a.options.lineNumbers||E){var L=Nr(l),V=l.gutter=be("div",null,"CodeMirror-gutter-wrapper","left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px");if(V.setAttribute("aria-hidden","true"),a.display.input.setUneditable(V),L.insertBefore(V,l.text),l.line.gutterClass&&(V.className+=" "+l.line.gutterClass),a.options.lineNumbers&&(!E||!E["CodeMirror-linenumbers"])&&(l.lineNumber=V.appendChild(be("div",Ur(a.options,b),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+d.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.display.lineNumInnerWidth+"px"))),E)for(var z=0;z<a.display.gutterSpecs.length;++z){var j=a.display.gutterSpecs[z].className,fe=E.hasOwnProperty(j)&&E[j];fe&&V.appendChild(be("div",[fe],"CodeMirror-gutter-elt","left: "+d.gutterLeft[j]+"px; width: "+d.gutterWidth[j]+"px"))}}}function yo(a,l,b){l.alignable&&(l.alignable=null);for(var d=Ae("CodeMirror-linewidget"),A=l.node.firstChild,E=void 0;A;A=E)E=A.nextSibling,d.test(A.className)&&l.node.removeChild(A);Fs(a,l,b)}function vo(a,l,b,d){var A=ws(a,l);return l.text=l.node=A.pre,A.bgClass&&(l.bgClass=A.bgClass),A.textClass&&(l.textClass=A.textClass),Oi(a,l),Ds(a,l,b,d),Fs(a,l,d),l.node}function Fs(a,l,b){if(Es(a,l.line,l,b,!0),l.rest)for(var d=0;d<l.rest.length;d++)Es(a,l.rest[d],l,b,!1)}function Es(a,l,b,d,A){if(l.widgets)for(var E=Nr(b),L=0,V=l.widgets;L<V.length;++L){var z=V[L],j=be("div",[z.node],"CodeMirror-linewidget"+(z.className?" "+z.className:""));z.handleMouseEvents||j.setAttribute("cm-ignore-events","true"),bo(z,j,b,d),a.display.input.setUneditable(j),A&&z.above?E.insertBefore(j,b.gutter||b.text):E.appendChild(j),mn(z,"redraw")}}function bo(a,l,b,d){if(a.noHScroll){(b.alignable||(b.alignable=[])).push(l);var A=d.wrapperWidth;l.style.left=d.fixedPos+"px",a.coverGutter||(A-=d.gutterTotalWidth,l.style.paddingLeft=d.gutterTotalWidth+"px"),l.style.width=A+"px"}a.coverGutter&&(l.style.zIndex=5,l.style.position="relative",a.noHScroll||(l.style.marginLeft=-d.gutterTotalWidth+"px"))}function br(a){if(a.height!=null)return a.height;var l=a.doc.cm;if(!l)return 0;if(!Je(document.body,a.node)){var b="position: relative;";a.coverGutter&&(b+="margin-left: -"+l.display.gutters.offsetWidth+"px;"),a.noHScroll&&(b+="width: "+l.display.wrapper.clientWidth+"px;"),Ce(l.display.measure,be("div",[a.node],null,b))}return a.height=a.node.parentNode.offsetHeight}function lr(a,l){for(var b=hn(l);b!=a.wrapper;b=b.parentNode)if(!b||b.nodeType==1&&b.getAttribute("cm-ignore-events")=="true"||b.parentNode==a.sizer&&b!=a.mover)return!0}function di(a){return a.lineSpace.offsetTop}function gr(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}function ks(a){if(a.cachedPaddingH)return a.cachedPaddingH;var l=Ce(a.measure,be("pre","x","CodeMirror-line-like")),b=window.getComputedStyle?window.getComputedStyle(l):l.currentStyle,d={left:parseInt(b.paddingLeft),right:parseInt(b.paddingRight)};return!isNaN(d.left)&&!isNaN(d.right)&&(a.cachedPaddingH=d),d}function sr(a){return Ie-a.display.nativeBarWidth}function Ar(a){return a.display.scroller.clientWidth-sr(a)-a.display.barWidth}function Wi(a){return a.display.scroller.clientHeight-sr(a)-a.display.barHeight}function Ao(a,l,b){var d=a.options.lineWrapping,A=d&&Ar(a);if(!l.measure.heights||d&&l.measure.width!=A){var E=l.measure.heights=[];if(d){l.measure.width=A;for(var L=l.text.firstChild.getClientRects(),V=0;V<L.length-1;V++){var z=L[V],j=L[V+1];Math.abs(z.bottom-j.bottom)>2&&E.push((z.bottom+j.top)/2-b.top)}}E.push(b.bottom-b.top)}}function Ts(a,l,b){if(a.line==l)return{map:a.measure.map,cache:a.measure.cache};if(a.rest){for(var d=0;d<a.rest.length;d++)if(a.rest[d]==l)return{map:a.measure.maps[d],cache:a.measure.caches[d]};for(var A=0;A<a.rest.length;A++)if(jt(a.rest[A])>b)return{map:a.measure.maps[A],cache:a.measure.caches[A],before:!0}}}function Co(a,l){l=Yn(l);var b=jt(l),d=a.display.externalMeasured=new Ss(a.doc,l,b);d.lineN=b;var A=d.built=Ms(a,d);return d.text=A.pre,Ce(a.display.lineMeasure,A.pre),d}function Ns(a,l,b,d){return ur(a,Gr(a,l),b,d)}function Lr(a,l){if(l>=a.display.viewFrom&&l<a.display.viewTo)return a.display.view[ei(a,l)];var b=a.display.externalMeasured;if(b&&l>=b.lineN&&l<b.lineN+b.size)return b}function Gr(a,l){var b=jt(l),d=Lr(a,b);d&&!d.text?d=null:d&&d.changes&&(Ii(a,d,b,wo(a)),a.curOp.forceUpdate=!0),d||(d=Co(a,l));var A=Ts(d,l,b);return{line:l,view:d,rect:null,map:A.map,cache:A.cache,before:A.before,hasHeights:!1}}function ur(a,l,b,d,A){l.before&&(b=-1);var E=b+(d||""),L;return l.cache.hasOwnProperty(E)?L=l.cache[E]:(l.rect||(l.rect=l.view.text.getBoundingClientRect()),l.hasHeights||(Ao(a,l.view,l.rect),l.hasHeights=!0),L=ae(a,l,b,d),L.bogus||(l.cache[E]=L)),{left:L.left,right:L.right,top:A?L.rtop:L.top,bottom:A?L.rbottom:L.bottom}}var hi={left:0,right:0,top:0,bottom:0};function mi(a,l,b){for(var d,A,E,L,V,z,j=0;j<a.length;j+=3)if(V=a[j],z=a[j+1],l<V?(A=0,E=1,L="left"):l<z?(A=l-V,E=A+1):(j==a.length-3||l==z&&a[j+3]>l)&&(E=z-V,A=E-1,l>=z&&(L="right")),A!=null){if(d=a[j+2],V==z&&b==(d.insertLeft?"left":"right")&&(L=b),b=="left"&&A==0)for(;j&&a[j-2]==a[j-3]&&a[j-1].insertLeft;)d=a[(j-=3)+2],L="left";if(b=="right"&&A==z-V)for(;j<a.length-3&&a[j+3]==a[j+4]&&!a[j+5].insertLeft;)d=a[(j+=3)+2],L="right";break}return{node:d,start:A,end:E,collapse:L,coverStart:V,coverEnd:z}}function I(a,l){var b=hi;if(l=="left")for(var d=0;d<a.length&&(b=a[d]).left==b.right;d++);else for(var A=a.length-1;A>=0&&(b=a[A]).left==b.right;A--);return b}function ae(a,l,b,d){var A=mi(l.map,b,d),E=A.node,L=A.start,V=A.end,z=A.collapse,j;if(E.nodeType==3){for(var fe=0;fe<4;fe++){for(;L&&He(l.line.text.charAt(A.coverStart+L));)--L;for(;A.coverStart+V<A.coverEnd&&He(l.line.text.charAt(A.coverStart+V));)++V;if(g&&M<9&&L==0&&V==A.coverEnd-A.coverStart?j=E.parentNode.getBoundingClientRect():j=I(Ze(E,L,V).getClientRects(),d),j.left||j.right||L==0)break;V=L,L=L-1,z="right"}g&&M<11&&(j=_e(a.display.measure,j))}else{L>0&&(z=d="right");var me;a.options.lineWrapping&&(me=E.getClientRects()).length>1?j=me[d=="right"?me.length-1:0]:j=E.getBoundingClientRect()}if(g&&M<9&&!L&&(!j||!j.left&&!j.right)){var Se=E.parentNode.getClientRects()[0];Se?j={left:Se.left,right:Se.left+_i(a.display),top:Se.top,bottom:Se.bottom}:j=hi}for(var Me=j.top-l.rect.top,Ee=j.bottom-l.rect.top,Re=(Me+Ee)/2,ze=l.view.measure.heights,Ke=0;Ke<ze.length-1&&!(Re<ze[Ke]);Ke++);var it=Ke?ze[Ke-1]:0,qe=ze[Ke],ct={left:(z=="right"?j.right:j.left)-l.rect.left,right:(z=="left"?j.left:j.right)-l.rect.left,top:it,bottom:qe};return!j.left&&!j.right&&(ct.bogus=!0),a.options.singleCursorHeightPerLine||(ct.rtop=Me,ct.rbottom=Ee),ct}function _e(a,l){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Jt(a))return l;var b=screen.logicalXDPI/screen.deviceXDPI,d=screen.logicalYDPI/screen.deviceYDPI;return{left:l.left*b,right:l.right*b,top:l.top*d,bottom:l.bottom*d}}function Le(a){if(a.measure&&(a.measure.cache={},a.measure.heights=null,a.rest))for(var l=0;l<a.rest.length;l++)a.measure.caches[l]={}}function bt(a){a.display.externalMeasure=null,we(a.display.lineMeasure);for(var l=0;l<a.display.view.length;l++)Le(a.display.view[l])}function en(a){bt(a),a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=null,a.options.lineWrapping||(a.display.maxLineChanged=!0),a.display.lineNumChars=null}function Zn(){return k&&Z?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Cr(){return k&&Z?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Mo(a){var l=Yn(a),b=l.widgets,d=0;if(b)for(var A=0;A<b.length;++A)b[A].above&&(d+=br(b[A]));return d}function Ls(a,l,b,d,A){if(!A){var E=Mo(l);b.top+=E,b.bottom+=E}if(d=="line")return b;d||(d="local");var L=Tn(l);if(d=="local"?L+=di(a.display):L-=a.display.viewOffset,d=="page"||d=="window"){var V=a.display.lineSpace.getBoundingClientRect();L+=V.top+(d=="window"?0:Cr());var z=V.left+(d=="window"?0:Zn());b.left+=z,b.right+=z}return b.top+=L,b.bottom+=L,b}function ia(a,l,b){if(b=="div")return l;var d=l.left,A=l.top;if(b=="page")d-=Zn(),A-=Cr();else if(b=="local"||!b){var E=a.display.sizer.getBoundingClientRect();d+=E.left,A+=E.top}var L=a.display.lineSpace.getBoundingClientRect();return{left:d-L.left,top:A-L.top}}function Gs(a,l,b,d,A){return d||(d=ft(a.doc,l.line)),Ls(a,d,Ns(a,d,l.ch,A),b)}function cr(a,l,b,d,A,E){d=d||ft(a.doc,l.line),A||(A=Gr(a,d));function L(Ee,Re){var ze=ur(a,A,Ee,Re?"right":"left",E);return Re?ze.left=ze.right:ze.right=ze.left,Ls(a,d,ze,b)}var V=It(d,a.doc.direction),z=l.ch,j=l.sticky;if(z>=d.text.length?(z=d.text.length,j="before"):z<=0&&(z=0,j="after"),!V)return L(j=="before"?z-1:z,j=="before");function fe(Ee,Re,ze){var Ke=V[Re],it=Ke.level==1;return L(ze?Ee-1:Ee,it!=ze)}var me=Ye(V,z,j),Se=$e,Me=fe(z,me,j=="before");return Se!=null&&(Me.other=fe(z,Se,j!="before")),Me}function sa(a,l){var b=0;l=st(a.doc,l),a.options.lineWrapping||(b=_i(a.display)*l.ch);var d=ft(a.doc,l.line),A=Tn(d)+di(a.display);return{left:b,right:b,top:A,bottom:A+d.height}}function xo(a,l,b,d,A){var E=Be(a,l,b);return E.xRel=A,d&&(E.outside=d),E}function Po(a,l,b){var d=a.doc;if(b+=a.display.viewOffset,b<0)return xo(d.first,0,null,-1,-1);var A=Qn(d,b),E=d.first+d.size-1;if(A>E)return xo(d.first+d.size-1,ft(d,E).text.length,null,1,1);l<0&&(l=0);for(var L=ft(d,A);;){var V=Mu(a,L,A,l,b),z=oo(L,V.ch+(V.xRel>0||V.outside>0?1:0));if(!z)return V;var j=z.find(1);if(j.line==A)return j;L=ft(d,A=j.line)}}function oa(a,l,b,d){d-=Mo(l);var A=l.text.length,E=We(function(L){return ur(a,b,L-1).bottom<=d},A,0);return A=We(function(L){return ur(a,b,L).top>d},E,A),{begin:E,end:A}}function aa(a,l,b,d){b||(b=Gr(a,l));var A=Ls(a,l,ur(a,b,d),"line").top;return oa(a,l,b,A)}function So(a,l,b,d){return a.bottom<=b?!1:a.top>b?!0:(d?a.left:a.right)>l}function Mu(a,l,b,d,A){A-=Tn(l);var E=Gr(a,l),L=Mo(l),V=0,z=l.text.length,j=!0,fe=It(l,a.doc.direction);if(fe){var me=(a.options.lineWrapping?Pu:xu)(a,l,b,E,fe,d,A);j=me.level!=1,V=j?me.from:me.to-1,z=j?me.to:me.from-1}var Se=null,Me=null,Ee=We(function(Mt){var At=ur(a,E,Mt);return At.top+=L,At.bottom+=L,So(At,d,A,!1)?(At.top<=A&&At.left<=d&&(Se=Mt,Me=At),!0):!1},V,z),Re,ze,Ke=!1;if(Me){var it=d-Me.left<Me.right-d,qe=it==j;Ee=Se+(qe?0:1),ze=qe?"after":"before",Re=it?Me.left:Me.right}else{!j&&(Ee==z||Ee==V)&&Ee++,ze=Ee==0?"after":Ee==l.text.length?"before":ur(a,E,Ee-(j?1:0)).bottom+L<=A==j?"after":"before";var ct=cr(a,Be(b,Ee,ze),"line",l,E);Re=ct.left,Ke=A<ct.top?-1:A>=ct.bottom?1:0}return Ee=et(l.text,Ee,1),xo(b,Ee,ze,Ke,d-Re)}function xu(a,l,b,d,A,E,L){var V=We(function(me){var Se=A[me],Me=Se.level!=1;return So(cr(a,Be(b,Me?Se.to:Se.from,Me?"before":"after"),"line",l,d),E,L,!0)},0,A.length-1),z=A[V];if(V>0){var j=z.level!=1,fe=cr(a,Be(b,j?z.from:z.to,j?"after":"before"),"line",l,d);So(fe,E,L,!0)&&fe.top>L&&(z=A[V-1])}return z}function Pu(a,l,b,d,A,E,L){var V=oa(a,l,d,L),z=V.begin,j=V.end;/\s/.test(l.text.charAt(j-1))&&j--;for(var fe=null,me=null,Se=0;Se<A.length;Se++){var Me=A[Se];if(!(Me.from>=j||Me.to<=z)){var Ee=Me.level!=1,Re=ur(a,d,Ee?Math.min(j,Me.to)-1:Math.max(z,Me.from)).right,ze=Re<E?E-Re+1e9:Re-E;(!fe||me>ze)&&(fe=Me,me=ze)}}return fe||(fe=A[A.length-1]),fe.from<z&&(fe={from:z,to:fe.to,level:fe.level}),fe.to>j&&(fe={from:fe.from,to:j,level:fe.level}),fe}var Jr;function gi(a){if(a.cachedTextHeight!=null)return a.cachedTextHeight;if(Jr==null){Jr=be("pre",null,"CodeMirror-line-like");for(var l=0;l<49;++l)Jr.appendChild(document.createTextNode("x")),Jr.appendChild(be("br"));Jr.appendChild(document.createTextNode("x"))}Ce(a.measure,Jr);var b=Jr.offsetHeight/50;return b>3&&(a.cachedTextHeight=b),we(a.measure),b||1}function _i(a){if(a.cachedCharWidth!=null)return a.cachedCharWidth;var l=be("span","xxxxxxxxxx"),b=be("pre",[l],"CodeMirror-line-like");Ce(a.measure,b);var d=l.getBoundingClientRect(),A=(d.right-d.left)/10;return A>2&&(a.cachedCharWidth=A),A||10}function wo(a){for(var l=a.display,b={},d={},A=l.gutters.clientLeft,E=l.gutters.firstChild,L=0;E;E=E.nextSibling,++L){var V=a.display.gutterSpecs[L].className;b[V]=E.offsetLeft+E.clientLeft+A,d[V]=E.clientWidth}return{fixedPos:Do(l),gutterTotalWidth:l.gutters.offsetWidth,gutterLeft:b,gutterWidth:d,wrapperWidth:l.wrapper.clientWidth}}function Do(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function ua(a){var l=gi(a.display),b=a.options.lineWrapping,d=b&&Math.max(5,a.display.scroller.clientWidth/_i(a.display)-3);return function(A){if(Bn(a.doc,A))return 0;var E=0;if(A.widgets)for(var L=0;L<A.widgets.length;L++)A.widgets[L].height&&(E+=A.widgets[L].height);return b?E+(Math.ceil(A.text.length/d)||1)*l:E+l}}function Fo(a){var l=a.doc,b=ua(a);l.iter(function(d){var A=b(d);A!=d.height&&En(d,A)})}function Qr(a,l,b,d){var A=a.display;if(!b&&hn(l).getAttribute("cm-not-content")=="true")return null;var E,L,V=A.lineSpace.getBoundingClientRect();try{E=l.clientX-V.left,L=l.clientY-V.top}catch{return null}var z=Po(a,E,L),j;if(d&&z.xRel>0&&(j=ft(a.doc,z.line).text).length==z.ch){var fe=ke(j,j.length,a.options.tabSize)-j.length;z=Be(z.line,Math.max(0,Math.round((E-ks(a.display).left)/_i(a.display))-fe))}return z}function ei(a,l){if(l>=a.display.viewTo||(l-=a.display.viewFrom,l<0))return null;for(var b=a.display.view,d=0;d<b.length;d++)if(l-=b[d].size,l<0)return d}function $n(a,l,b,d){l==null&&(l=a.doc.first),b==null&&(b=a.doc.first+a.doc.size),d||(d=0);var A=a.display;if(d&&b<A.viewTo&&(A.updateLineNumbers==null||A.updateLineNumbers>l)&&(A.updateLineNumbers=l),a.curOp.viewChanged=!0,l>=A.viewTo)he&&$i(a.doc,l)<A.viewTo&&Br(a);else if(b<=A.viewFrom)he&&bs(a.doc,b+d)>A.viewFrom?Br(a):(A.viewFrom+=d,A.viewTo+=d);else if(l<=A.viewFrom&&b>=A.viewTo)Br(a);else if(l<=A.viewFrom){var E=Rs(a,b,b+d,1);E?(A.view=A.view.slice(E.index),A.viewFrom=E.lineN,A.viewTo+=d):Br(a)}else if(b>=A.viewTo){var L=Rs(a,l,l,-1);L?(A.view=A.view.slice(0,L.index),A.viewTo=L.lineN):Br(a)}else{var V=Rs(a,l,l,-1),z=Rs(a,b,b+d,1);V&&z?(A.view=A.view.slice(0,V.index).concat(pi(a,V.lineN,z.lineN)).concat(A.view.slice(z.index)),A.viewTo+=d):Br(a)}var j=A.externalMeasured;j&&(b<j.lineN?j.lineN+=d:l<j.lineN+j.size&&(A.externalMeasured=null))}function Rr(a,l,b){a.curOp.viewChanged=!0;var d=a.display,A=a.display.externalMeasured;if(A&&l>=A.lineN&&l<A.lineN+A.size&&(d.externalMeasured=null),!(l<d.viewFrom||l>=d.viewTo)){var E=d.view[ei(a,l)];if(E.node!=null){var L=E.changes||(E.changes=[]);je(L,b)==-1&&L.push(b)}}}function Br(a){a.display.viewFrom=a.display.viewTo=a.doc.first,a.display.view=[],a.display.viewOffset=0}function Rs(a,l,b,d){var A=ei(a,l),E,L=a.display.view;if(!he||b==a.doc.first+a.doc.size)return{index:A,lineN:b};for(var V=a.display.viewFrom,z=0;z<A;z++)V+=L[z].size;if(V!=l){if(d>0){if(A==L.length-1)return null;E=V+L[A].size-l,A++}else E=V-l;l+=E,b+=E}for(;$i(a.doc,b)!=b;){if(A==(d<0?0:L.length-1))return null;b+=d*L[A-(d<0?1:0)].size,A+=d}return{index:A,lineN:b}}function Su(a,l,b){var d=a.display,A=d.view;A.length==0||l>=d.viewTo||b<=d.viewFrom?(d.view=pi(a,l,b),d.viewFrom=l):(d.viewFrom>l?d.view=pi(a,l,d.viewFrom).concat(d.view):d.viewFrom<l&&(d.view=d.view.slice(ei(a,l))),d.viewFrom=l,d.viewTo<b?d.view=d.view.concat(pi(a,d.viewTo,b)):d.viewTo>b&&(d.view=d.view.slice(0,ei(a,b)))),d.viewTo=b}function la(a){for(var l=a.display.view,b=0,d=0;d<l.length;d++){var A=l[d];!A.hidden&&(!A.node||A.changes)&&++b}return b}function Xi(a){a.display.input.showSelection(a.display.input.prepareSelection())}function ca(a,l){l===void 0&&(l=!0);var b=a.doc,d={},A=d.cursors=document.createDocumentFragment(),E=d.selection=document.createDocumentFragment(),L=a.options.$customCursor;L&&(l=!0);for(var V=0;V<b.sel.ranges.length;V++)if(!(!l&&V==b.sel.primIndex)){var z=b.sel.ranges[V];if(!(z.from().line>=a.display.viewTo||z.to().line<a.display.viewFrom)){var j=z.empty();if(L){var fe=L(a,z);fe&&Eo(a,fe,A)}else(j||a.options.showCursorWhenSelecting)&&Eo(a,z.head,A);j||wu(a,z,E)}}return d}function Eo(a,l,b){var d=cr(a,l,"div",null,null,!a.options.singleCursorHeightPerLine),A=b.appendChild(be("div"," ","CodeMirror-cursor"));if(A.style.left=d.left+"px",A.style.top=d.top+"px",A.style.height=Math.max(0,d.bottom-d.top)*a.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(a.getWrapperElement().className)){var E=Gs(a,l,"div",null,null),L=E.right-E.left;A.style.width=(L>0?L:a.defaultCharWidth())+"px"}if(d.other){var V=b.appendChild(be("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));V.style.display="",V.style.left=d.other.left+"px",V.style.top=d.other.top+"px",V.style.height=(d.other.bottom-d.other.top)*.85+"px"}}function Bs(a,l){return a.top-l.top||a.left-l.left}function wu(a,l,b){var d=a.display,A=a.doc,E=document.createDocumentFragment(),L=ks(a.display),V=L.left,z=Math.max(d.sizerWidth,Ar(a)-d.sizer.offsetLeft)-L.right,j=A.direction=="ltr";function fe(qe,ct,Mt,At){ct<0&&(ct=0),ct=Math.round(ct),At=Math.round(At),E.appendChild(be("div",null,"CodeMirror-selected","position: absolute; left: "+qe+`px;
                             top: `+ct+"px; width: "+(Mt??z-qe)+`px;
                             height: `+(At-ct)+"px"))}function me(qe,ct,Mt){var At=ft(A,qe),Ot=At.text.length,nn,xn;function un(gn,Wn){return Gs(a,Be(qe,gn),"div",At,Wn)}function Hn(gn,Wn,Sn){var vn=aa(a,At,null,gn),_n=Wn=="ltr"==(Sn=="after")?"left":"right",cn=Sn=="after"?vn.begin:vn.end-(/\s/.test(At.text.charAt(vn.end-1))?2:1);return un(cn,_n)[_n]}var On=It(At,A.direction);return yt(On,ct||0,Mt??Ot,function(gn,Wn,Sn,vn){var _n=Sn=="ltr",cn=un(gn,_n?"left":"right"),Xn=un(Wn-1,_n?"right":"left"),Ei=ct==null&&gn==0,Vr=Mt==null&&Wn==Ot,Fn=vn==0,_r=!On||vn==On.length-1;if(Xn.top-cn.top<=3){var Pn=(j?Ei:Vr)&&Fn,na=(j?Vr:Ei)&&_r,Pr=Pn?V:(_n?cn:Xn).left,si=na?z:(_n?Xn:cn).right;fe(Pr,cn.top,si-Pr,cn.bottom)}else{var oi,Ln,ki,ra;_n?(oi=j&&Ei&&Fn?V:cn.left,Ln=j?z:Hn(gn,Sn,"before"),ki=j?V:Hn(Wn,Sn,"after"),ra=j&&Vr&&_r?z:Xn.right):(oi=j?Hn(gn,Sn,"before"):V,Ln=!j&&Ei&&Fn?z:cn.right,ki=!j&&Vr&&_r?V:Xn.left,ra=j?Hn(Wn,Sn,"after"):z),fe(oi,cn.top,Ln-oi,cn.bottom),cn.bottom<Xn.top&&fe(V,cn.bottom,null,Xn.top),fe(ki,Xn.top,ra-ki,Xn.bottom)}(!nn||Bs(cn,nn)<0)&&(nn=cn),Bs(Xn,nn)<0&&(nn=Xn),(!xn||Bs(cn,xn)<0)&&(xn=cn),Bs(Xn,xn)<0&&(xn=Xn)}),{start:nn,end:xn}}var Se=l.from(),Me=l.to();if(Se.line==Me.line)me(Se.line,Se.ch,Me.ch);else{var Ee=ft(A,Se.line),Re=ft(A,Me.line),ze=Yn(Ee)==Yn(Re),Ke=me(Se.line,Se.ch,ze?Ee.text.length+1:null).end,it=me(Me.line,ze?0:null,Me.ch).start;ze&&(Ke.top<it.top-2?(fe(Ke.right,Ke.top,null,Ke.bottom),fe(V,it.top,it.left,it.bottom)):fe(Ke.right,Ke.top,it.left-Ke.right,Ke.bottom)),Ke.bottom<it.top&&fe(V,Ke.bottom,null,it.top)}b.appendChild(E)}function ko(a){if(a.state.focused){var l=a.display;clearInterval(l.blinker);var b=!0;l.cursorDiv.style.visibility="",a.options.cursorBlinkRate>0?l.blinker=setInterval(function(){a.hasFocus()||yi(a),l.cursorDiv.style.visibility=(b=!b)?"":"hidden"},a.options.cursorBlinkRate):a.options.cursorBlinkRate<0&&(l.cursorDiv.style.visibility="hidden")}}function fa(a){a.hasFocus()||(a.display.input.focus(),a.state.focused||No(a))}function To(a){a.state.delayingBlurEvent=!0,setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1,a.state.focused&&yi(a))},100)}function No(a,l){a.state.delayingBlurEvent&&!a.state.draggingText&&(a.state.delayingBlurEvent=!1),a.options.readOnly!="nocursor"&&(a.state.focused||(Oe(a,"focus",a,l),a.state.focused=!0,rt(a.display.wrapper,"CodeMirror-focused"),!a.curOp&&a.display.selForContextMenu!=a.doc.sel&&(a.display.input.reset(),F&&setTimeout(function(){return a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),ko(a))}function yi(a,l){a.state.delayingBlurEvent||(a.state.focused&&(Oe(a,"blur",a,l),a.state.focused=!1,Fe(a.display.wrapper,"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.display.shift=!1)},150))}function $s(a){for(var l=a.display,b=l.lineDiv.offsetTop,d=Math.max(0,l.scroller.getBoundingClientRect().top),A=l.lineDiv.getBoundingClientRect().top,E=0,L=0;L<l.view.length;L++){var V=l.view[L],z=a.options.lineWrapping,j=void 0,fe=0;if(!V.hidden){if(A+=V.line.height,g&&M<8){var me=V.node.offsetTop+V.node.offsetHeight;j=me-b,b=me}else{var Se=V.node.getBoundingClientRect();j=Se.bottom-Se.top,!z&&V.text.firstChild&&(fe=V.text.firstChild.getBoundingClientRect().right-Se.left-1)}var Me=V.line.height-j;if((Me>.005||Me<-.005)&&(A<d&&(E-=Me),En(V.line,j),pa(V.line),V.rest))for(var Ee=0;Ee<V.rest.length;Ee++)pa(V.rest[Ee]);if(fe>a.display.sizerWidth){var Re=Math.ceil(fe/_i(a.display));Re>a.display.maxLineLength&&(a.display.maxLineLength=Re,a.display.maxLine=V.line,a.display.maxLineChanged=!0)}}}Math.abs(E)>2&&(l.scroller.scrollTop+=E)}function pa(a){if(a.widgets)for(var l=0;l<a.widgets.length;++l){var b=a.widgets[l],d=b.node.parentNode;d&&(b.height=d.offsetHeight)}}function Is(a,l,b){var d=b&&b.top!=null?Math.max(0,b.top):a.scroller.scrollTop;d=Math.floor(d-di(a));var A=b&&b.bottom!=null?b.bottom:d+a.wrapper.clientHeight,E=Qn(l,d),L=Qn(l,A);if(b&&b.ensure){var V=b.ensure.from.line,z=b.ensure.to.line;V<E?(E=V,L=Qn(l,Tn(ft(l,V))+a.wrapper.clientHeight)):Math.min(z,l.lastLine())>=L&&(E=Qn(l,Tn(ft(l,z))-a.wrapper.clientHeight),L=z)}return{from:E,to:Math.max(L,E+1)}}function Du(a,l){if(!Wt(a,"scrollCursorIntoView")){var b=a.display,d=b.sizer.getBoundingClientRect(),A=null;if(l.top+d.top<0?A=!0:l.bottom+d.top>(window.innerHeight||document.documentElement.clientHeight)&&(A=!1),A!=null&&!U){var E=be("div","​",null,`position: absolute;
                         top: `+(l.top-b.viewOffset-di(a.display))+`px;
                         height: `+(l.bottom-l.top+sr(a)+b.barHeight)+`px;
                         left: `+l.left+"px; width: "+Math.max(2,l.right-l.left)+"px;");a.display.lineSpace.appendChild(E),E.scrollIntoView(A),a.display.lineSpace.removeChild(E)}}}function Fu(a,l,b,d){d==null&&(d=0);var A;!a.options.lineWrapping&&l==b&&(b=l.sticky=="before"?Be(l.line,l.ch+1,"before"):l,l=l.ch?Be(l.line,l.sticky=="before"?l.ch-1:l.ch,"after"):l);for(var E=0;E<5;E++){var L=!1,V=cr(a,l),z=!b||b==l?V:cr(a,b);A={left:Math.min(V.left,z.left),top:Math.min(V.top,z.top)-d,right:Math.max(V.left,z.left),bottom:Math.max(V.bottom,z.bottom)+d};var j=Lo(a,A),fe=a.doc.scrollTop,me=a.doc.scrollLeft;if(j.scrollTop!=null&&(Zi(a,j.scrollTop),Math.abs(a.doc.scrollTop-fe)>1&&(L=!0)),j.scrollLeft!=null&&(ti(a,j.scrollLeft),Math.abs(a.doc.scrollLeft-me)>1&&(L=!0)),!L)break}return A}function Eu(a,l){var b=Lo(a,l);b.scrollTop!=null&&Zi(a,b.scrollTop),b.scrollLeft!=null&&ti(a,b.scrollLeft)}function Lo(a,l){var b=a.display,d=gi(a.display);l.top<0&&(l.top=0);var A=a.curOp&&a.curOp.scrollTop!=null?a.curOp.scrollTop:b.scroller.scrollTop,E=Wi(a),L={};l.bottom-l.top>E&&(l.bottom=l.top+E);var V=a.doc.height+gr(b),z=l.top<d,j=l.bottom>V-d;if(l.top<A)L.scrollTop=z?0:l.top;else if(l.bottom>A+E){var fe=Math.min(l.top,(j?V:l.bottom)-E);fe!=A&&(L.scrollTop=fe)}var me=a.options.fixedGutter?0:b.gutters.offsetWidth,Se=a.curOp&&a.curOp.scrollLeft!=null?a.curOp.scrollLeft:b.scroller.scrollLeft-me,Me=Ar(a)-b.gutters.offsetWidth,Ee=l.right-l.left>Me;return Ee&&(l.right=l.left+Me),l.left<10?L.scrollLeft=0:l.left<Se?L.scrollLeft=Math.max(0,l.left+me-(Ee?0:10)):l.right>Me+Se-3&&(L.scrollLeft=l.right+(Ee?0:10)-Me),L}function Go(a,l){l!=null&&(Os(a),a.curOp.scrollTop=(a.curOp.scrollTop==null?a.doc.scrollTop:a.curOp.scrollTop)+l)}function vi(a){Os(a);var l=a.getCursor();a.curOp.scrollToPos={from:l,to:l,margin:a.options.cursorScrollMargin}}function Vi(a,l,b){(l!=null||b!=null)&&Os(a),l!=null&&(a.curOp.scrollLeft=l),b!=null&&(a.curOp.scrollTop=b)}function ku(a,l){Os(a),a.curOp.scrollToPos=l}function Os(a){var l=a.curOp.scrollToPos;if(l){a.curOp.scrollToPos=null;var b=sa(a,l.from),d=sa(a,l.to);da(a,b,d,l.margin)}}function da(a,l,b,d){var A=Lo(a,{left:Math.min(l.left,b.left),top:Math.min(l.top,b.top)-d,right:Math.max(l.right,b.right),bottom:Math.max(l.bottom,b.bottom)+d});Vi(a,A.scrollLeft,A.scrollTop)}function Zi(a,l){Math.abs(a.doc.scrollTop-l)<2||(o||Bo(a,{top:l}),ha(a,l,!0),o&&Bo(a),Ui(a,100))}function ha(a,l,b){l=Math.max(0,Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,l)),!(a.display.scroller.scrollTop==l&&!b)&&(a.doc.scrollTop=l,a.display.scrollbars.setScrollTop(l),a.display.scroller.scrollTop!=l&&(a.display.scroller.scrollTop=l))}function ti(a,l,b,d){l=Math.max(0,Math.min(l,a.display.scroller.scrollWidth-a.display.scroller.clientWidth)),!((b?l==a.doc.scrollLeft:Math.abs(a.doc.scrollLeft-l)<2)&&!d)&&(a.doc.scrollLeft=l,va(a),a.display.scroller.scrollLeft!=l&&(a.display.scroller.scrollLeft=l),a.display.scrollbars.setScrollLeft(l))}function zi(a){var l=a.display,b=l.gutters.offsetWidth,d=Math.round(a.doc.height+gr(a.display));return{clientHeight:l.scroller.clientHeight,viewHeight:l.wrapper.clientHeight,scrollWidth:l.scroller.scrollWidth,clientWidth:l.scroller.clientWidth,viewWidth:l.wrapper.clientWidth,barLeft:a.options.fixedGutter?b:0,docHeight:d,scrollHeight:d+sr(a)+l.barHeight,nativeBarWidth:l.nativeBarWidth,gutterWidth:b}}var ni=function(a,l,b){this.cm=b;var d=this.vert=be("div",[be("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),A=this.horiz=be("div",[be("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");d.tabIndex=A.tabIndex=-1,a(d),a(A),Ue(d,"scroll",function(){d.clientHeight&&l(d.scrollTop,"vertical")}),Ue(A,"scroll",function(){A.clientWidth&&l(A.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,g&&M<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};ni.prototype.update=function(a){var l=a.scrollWidth>a.clientWidth+1,b=a.scrollHeight>a.clientHeight+1,d=a.nativeBarWidth;if(b){this.vert.style.display="block",this.vert.style.bottom=l?d+"px":"0";var A=a.viewHeight-(l?d:0);this.vert.firstChild.style.height=Math.max(0,a.scrollHeight-a.clientHeight+A)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(l){this.horiz.style.display="block",this.horiz.style.right=b?d+"px":"0",this.horiz.style.left=a.barLeft+"px";var E=a.viewWidth-a.barLeft-(b?d:0);this.horiz.firstChild.style.width=Math.max(0,a.scrollWidth-a.clientWidth+E)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&a.clientHeight>0&&(d==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:b?d:0,bottom:l?d:0}},ni.prototype.setScrollLeft=function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},ni.prototype.setScrollTop=function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},ni.prototype.zeroWidthHack=function(){var a=ie&&!R?"12px":"18px";this.horiz.style.height=this.vert.style.width=a,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new at,this.disableVert=new at},ni.prototype.enableZeroWidthBar=function(a,l,b){a.style.pointerEvents="auto";function d(){var A=a.getBoundingClientRect(),E=b=="vert"?document.elementFromPoint(A.right-1,(A.top+A.bottom)/2):document.elementFromPoint((A.right+A.left)/2,A.bottom-1);E!=a?a.style.pointerEvents="none":l.set(1e3,d)}l.set(1e3,d)},ni.prototype.clear=function(){var a=this.horiz.parentNode;a.removeChild(this.horiz),a.removeChild(this.vert)};var Hi=function(){};Hi.prototype.update=function(){return{bottom:0,right:0}},Hi.prototype.setScrollLeft=function(){},Hi.prototype.setScrollTop=function(){},Hi.prototype.clear=function(){};function bi(a,l){l||(l=zi(a));var b=a.display.barWidth,d=a.display.barHeight;ma(a,l);for(var A=0;A<4&&b!=a.display.barWidth||d!=a.display.barHeight;A++)b!=a.display.barWidth&&a.options.lineWrapping&&$s(a),ma(a,zi(a)),b=a.display.barWidth,d=a.display.barHeight}function ma(a,l){var b=a.display,d=b.scrollbars.update(l);b.sizer.style.paddingRight=(b.barWidth=d.right)+"px",b.sizer.style.paddingBottom=(b.barHeight=d.bottom)+"px",b.heightForcer.style.borderBottom=d.bottom+"px solid transparent",d.right&&d.bottom?(b.scrollbarFiller.style.display="block",b.scrollbarFiller.style.height=d.bottom+"px",b.scrollbarFiller.style.width=d.right+"px"):b.scrollbarFiller.style.display="",d.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(b.gutterFiller.style.display="block",b.gutterFiller.style.height=d.bottom+"px",b.gutterFiller.style.width=l.gutterWidth+"px"):b.gutterFiller.style.display=""}var ga={native:ni,null:Hi};function _a(a){a.display.scrollbars&&(a.display.scrollbars.clear(),a.display.scrollbars.addClass&&Fe(a.display.wrapper,a.display.scrollbars.addClass)),a.display.scrollbars=new ga[a.options.scrollbarStyle](function(l){a.display.wrapper.insertBefore(l,a.display.scrollbarFiller),Ue(l,"mousedown",function(){a.state.focused&&setTimeout(function(){return a.display.input.focus()},0)}),l.setAttribute("cm-not-content","true")},function(l,b){b=="horizontal"?ti(a,l):Zi(a,l)},a),a.display.scrollbars.addClass&&rt(a.display.wrapper,a.display.scrollbars.addClass)}var Tu=0;function ri(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Tu,markArrays:null},ho(a.curOp)}function ii(a){var l=a.curOp;l&&mr(l,function(b){for(var d=0;d<b.ops.length;d++)b.ops[d].cm.curOp=null;Nu(b)})}function Nu(a){for(var l=a.ops,b=0;b<l.length;b++)Lu(l[b]);for(var d=0;d<l.length;d++)Gu(l[d]);for(var A=0;A<l.length;A++)Ru(l[A]);for(var E=0;E<l.length;E++)Bu(l[E]);for(var L=0;L<l.length;L++)$u(l[L])}function Lu(a){var l=a.cm,b=l.display;Ou(l),a.updateMaxLine&&ci(l),a.mustUpdate=a.viewChanged||a.forceUpdate||a.scrollTop!=null||a.scrollToPos&&(a.scrollToPos.from.line<b.viewFrom||a.scrollToPos.to.line>=b.viewTo)||b.maxLineChanged&&l.options.lineWrapping,a.update=a.mustUpdate&&new Ws(l,a.mustUpdate&&{top:a.scrollTop,ensure:a.scrollToPos},a.forceUpdate)}function Gu(a){a.updatedDisplay=a.mustUpdate&&Ro(a.cm,a.update)}function Ru(a){var l=a.cm,b=l.display;a.updatedDisplay&&$s(l),a.barMeasure=zi(l),b.maxLineChanged&&!l.options.lineWrapping&&(a.adjustWidthTo=Ns(l,b.maxLine,b.maxLine.text.length).left+3,l.display.sizerWidth=a.adjustWidthTo,a.barMeasure.scrollWidth=Math.max(b.scroller.clientWidth,b.sizer.offsetLeft+a.adjustWidthTo+sr(l)+l.display.barWidth),a.maxScrollLeft=Math.max(0,b.sizer.offsetLeft+a.adjustWidthTo-Ar(l))),(a.updatedDisplay||a.selectionChanged)&&(a.preparedSelection=b.input.prepareSelection())}function Bu(a){var l=a.cm;a.adjustWidthTo!=null&&(l.display.sizer.style.minWidth=a.adjustWidthTo+"px",a.maxScrollLeft<l.doc.scrollLeft&&ti(l,Math.min(l.display.scroller.scrollLeft,a.maxScrollLeft),!0),l.display.maxLineChanged=!1);var b=a.focus&&a.focus==Qe();a.preparedSelection&&l.display.input.showSelection(a.preparedSelection,b),(a.updatedDisplay||a.startHeight!=l.doc.height)&&bi(l,a.barMeasure),a.updatedDisplay&&Io(l,a.barMeasure),a.selectionChanged&&ko(l),l.state.focused&&a.updateInput&&l.display.input.reset(a.typing),b&&fa(a.cm)}function $u(a){var l=a.cm,b=l.display,d=l.doc;if(a.updatedDisplay&&ya(l,a.update),b.wheelStartX!=null&&(a.scrollTop!=null||a.scrollLeft!=null||a.scrollToPos)&&(b.wheelStartX=b.wheelStartY=null),a.scrollTop!=null&&ha(l,a.scrollTop,a.forceScroll),a.scrollLeft!=null&&ti(l,a.scrollLeft,!0,!0),a.scrollToPos){var A=Fu(l,st(d,a.scrollToPos.from),st(d,a.scrollToPos.to),a.scrollToPos.margin);Du(l,A)}var E=a.maybeHiddenMarkers,L=a.maybeUnhiddenMarkers;if(E)for(var V=0;V<E.length;++V)E[V].lines.length||Oe(E[V],"hide");if(L)for(var z=0;z<L.length;++z)L[z].lines.length&&Oe(L[z],"unhide");b.wrapper.offsetHeight&&(d.scrollTop=l.display.scroller.scrollTop),a.changeObjs&&Oe(l,"changes",l,a.changeObjs),a.update&&a.update.finish()}function zn(a,l){if(a.curOp)return l();ri(a);try{return l()}finally{ii(a)}}function Cn(a,l){return function(){if(a.curOp)return l.apply(a,arguments);ri(a);try{return l.apply(a,arguments)}finally{ii(a)}}}function Nn(a){return function(){if(this.curOp)return a.apply(this,arguments);ri(this);try{return a.apply(this,arguments)}finally{ii(this)}}}function Mn(a){return function(){var l=this.cm;if(!l||l.curOp)return a.apply(this,arguments);ri(l);try{return a.apply(this,arguments)}finally{ii(l)}}}function Ui(a,l){a.doc.highlightFrontier<a.display.viewTo&&a.state.highlight.set(l,Lt(Iu,a))}function Iu(a){var l=a.doc;if(!(l.highlightFrontier>=a.display.viewTo)){var b=+new Date+a.options.workTime,d=jr(a,l.highlightFrontier),A=[];l.iter(d.line,Math.min(l.first+l.size,a.display.viewTo+500),function(E){if(d.line>=a.display.viewFrom){var L=E.styles,V=E.text.length>a.options.maxHighlightLength?Gn(l.mode,d.state):null,z=cs(a,E,d,!0);V&&(d.state=V),E.styles=z.styles;var j=E.styleClasses,fe=z.classes;fe?E.styleClasses=fe:j&&(E.styleClasses=null);for(var me=!L||L.length!=E.styles.length||j!=fe&&(!j||!fe||j.bgClass!=fe.bgClass||j.textClass!=fe.textClass),Se=0;!me&&Se<L.length;++Se)me=L[Se]!=E.styles[Se];me&&A.push(d.line),E.stateAfter=d.save(),d.nextLine()}else E.text.length<=a.options.maxHighlightLength&&Ti(a,E.text,d),E.stateAfter=d.line%5==0?d.save():null,d.nextLine();if(+new Date>b)return Ui(a,a.options.workDelay),!0}),l.highlightFrontier=d.line,l.modeFrontier=Math.max(l.modeFrontier,d.line),A.length&&zn(a,function(){for(var E=0;E<A.length;E++)Rr(a,A[E],"text")})}}var Ws=function(a,l,b){var d=a.display;this.viewport=l,this.visible=Is(d,a.doc,l),this.editorIsHidden=!d.wrapper.offsetWidth,this.wrapperHeight=d.wrapper.clientHeight,this.wrapperWidth=d.wrapper.clientWidth,this.oldDisplayWidth=Ar(a),this.force=b,this.dims=wo(a),this.events=[]};Ws.prototype.signal=function(a,l){ot(a,l)&&this.events.push(arguments)},Ws.prototype.finish=function(){for(var a=0;a<this.events.length;a++)Oe.apply(null,this.events[a])};function Ou(a){var l=a.display;!l.scrollbarsClipped&&l.scroller.offsetWidth&&(l.nativeBarWidth=l.scroller.offsetWidth-l.scroller.clientWidth,l.heightForcer.style.height=sr(a)+"px",l.sizer.style.marginBottom=-l.nativeBarWidth+"px",l.sizer.style.borderRightWidth=sr(a)+"px",l.scrollbarsClipped=!0)}function Wu(a){if(a.hasFocus())return null;var l=Qe();if(!l||!Je(a.display.lineDiv,l))return null;var b={activeElt:l};if(window.getSelection){var d=window.getSelection();d.anchorNode&&d.extend&&Je(a.display.lineDiv,d.anchorNode)&&(b.anchorNode=d.anchorNode,b.anchorOffset=d.anchorOffset,b.focusNode=d.focusNode,b.focusOffset=d.focusOffset)}return b}function Xu(a){if(!(!a||!a.activeElt||a.activeElt==Qe())&&(a.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(a.activeElt.nodeName)&&a.anchorNode&&Je(document.body,a.anchorNode)&&Je(document.body,a.focusNode))){var l=window.getSelection(),b=document.createRange();b.setEnd(a.anchorNode,a.anchorOffset),b.collapse(!1),l.removeAllRanges(),l.addRange(b),l.extend(a.focusNode,a.focusOffset)}}function Ro(a,l){var b=a.display,d=a.doc;if(l.editorIsHidden)return Br(a),!1;if(!l.force&&l.visible.from>=b.viewFrom&&l.visible.to<=b.viewTo&&(b.updateLineNumbers==null||b.updateLineNumbers>=b.viewTo)&&b.renderedView==b.view&&la(a)==0)return!1;ba(a)&&(Br(a),l.dims=wo(a));var A=d.first+d.size,E=Math.max(l.visible.from-a.options.viewportMargin,d.first),L=Math.min(A,l.visible.to+a.options.viewportMargin);b.viewFrom<E&&E-b.viewFrom<20&&(E=Math.max(d.first,b.viewFrom)),b.viewTo>L&&b.viewTo-L<20&&(L=Math.min(A,b.viewTo)),he&&(E=$i(a.doc,E),L=bs(a.doc,L));var V=E!=b.viewFrom||L!=b.viewTo||b.lastWrapHeight!=l.wrapperHeight||b.lastWrapWidth!=l.wrapperWidth;Su(a,E,L),b.viewOffset=Tn(ft(a.doc,b.viewFrom)),a.display.mover.style.top=b.viewOffset+"px";var z=la(a);if(!V&&z==0&&!l.force&&b.renderedView==b.view&&(b.updateLineNumbers==null||b.updateLineNumbers>=b.viewTo))return!1;var j=Wu(a);return z>4&&(b.lineDiv.style.display="none"),Vu(a,b.updateLineNumbers,l.dims),z>4&&(b.lineDiv.style.display=""),b.renderedView=b.view,Xu(j),we(b.cursorDiv),we(b.selectionDiv),b.gutters.style.height=b.sizer.style.minHeight=0,V&&(b.lastWrapHeight=l.wrapperHeight,b.lastWrapWidth=l.wrapperWidth,Ui(a,400)),b.updateLineNumbers=null,!0}function ya(a,l){for(var b=l.viewport,d=!0;;d=!1){if(!d||!a.options.lineWrapping||l.oldDisplayWidth==Ar(a)){if(b&&b.top!=null&&(b={top:Math.min(a.doc.height+gr(a.display)-Wi(a),b.top)}),l.visible=Is(a.display,a.doc,b),l.visible.from>=a.display.viewFrom&&l.visible.to<=a.display.viewTo)break}else d&&(l.visible=Is(a.display,a.doc,b));if(!Ro(a,l))break;$s(a);var A=zi(a);Xi(a),bi(a,A),Io(a,A),l.force=!1}l.signal(a,"update",a),(a.display.viewFrom!=a.display.reportedViewFrom||a.display.viewTo!=a.display.reportedViewTo)&&(l.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=a.display.viewFrom,a.display.reportedViewTo=a.display.viewTo)}function Bo(a,l){var b=new Ws(a,l);if(Ro(a,b)){$s(a),ya(a,b);var d=zi(a);Xi(a),bi(a,d),Io(a,d),b.finish()}}function Vu(a,l,b){var d=a.display,A=a.options.lineNumbers,E=d.lineDiv,L=E.firstChild;function V(Ee){var Re=Ee.nextSibling;return F&&ie&&a.display.currentWheelTarget==Ee?Ee.style.display="none":Ee.parentNode.removeChild(Ee),Re}for(var z=d.view,j=d.viewFrom,fe=0;fe<z.length;fe++){var me=z[fe];if(!me.hidden)if(!me.node||me.node.parentNode!=E){var Se=vo(a,me,j,b);E.insertBefore(Se,L)}else{for(;L!=me.node;)L=V(L);var Me=A&&l!=null&&l<=j&&me.lineNumber;me.changes&&(je(me.changes,"gutter")>-1&&(Me=!1),Ii(a,me,j,b)),Me&&(we(me.lineNumber),me.lineNumber.appendChild(document.createTextNode(Ur(a.options,j)))),L=me.node.nextSibling}j+=me.size}for(;L;)L=V(L)}function $o(a){var l=a.gutters.offsetWidth;a.sizer.style.marginLeft=l+"px",mn(a,"gutterChanged",a)}function Io(a,l){a.display.sizer.style.minHeight=l.docHeight+"px",a.display.heightForcer.style.top=l.docHeight+"px",a.display.gutters.style.height=l.docHeight+a.display.barHeight+sr(a)+"px"}function va(a){var l=a.display,b=l.view;if(!(!l.alignWidgets&&(!l.gutters.firstChild||!a.options.fixedGutter))){for(var d=Do(l)-l.scroller.scrollLeft+a.doc.scrollLeft,A=l.gutters.offsetWidth,E=d+"px",L=0;L<b.length;L++)if(!b[L].hidden){a.options.fixedGutter&&(b[L].gutter&&(b[L].gutter.style.left=E),b[L].gutterBackground&&(b[L].gutterBackground.style.left=E));var V=b[L].alignable;if(V)for(var z=0;z<V.length;z++)V[z].style.left=E}a.options.fixedGutter&&(l.gutters.style.left=d+A+"px")}}function ba(a){if(!a.options.lineNumbers)return!1;var l=a.doc,b=Ur(a.options,l.first+l.size-1),d=a.display;if(b.length!=d.lineNumChars){var A=d.measure.appendChild(be("div",[be("div",b)],"CodeMirror-linenumber CodeMirror-gutter-elt")),E=A.firstChild.offsetWidth,L=A.offsetWidth-E;return d.lineGutter.style.width="",d.lineNumInnerWidth=Math.max(E,d.lineGutter.offsetWidth-L)+1,d.lineNumWidth=d.lineNumInnerWidth+L,d.lineNumChars=d.lineNumInnerWidth?b.length:-1,d.lineGutter.style.width=d.lineNumWidth+"px",$o(a.display),!0}return!1}function Oo(a,l){for(var b=[],d=!1,A=0;A<a.length;A++){var E=a[A],L=null;if(typeof E!="string"&&(L=E.style,E=E.className),E=="CodeMirror-linenumbers")if(l)d=!0;else continue;b.push({className:E,style:L})}return l&&!d&&b.push({className:"CodeMirror-linenumbers",style:null}),b}function Aa(a){var l=a.gutters,b=a.gutterSpecs;we(l),a.lineGutter=null;for(var d=0;d<b.length;++d){var A=b[d],E=A.className,L=A.style,V=l.appendChild(be("div",null,"CodeMirror-gutter "+E));L&&(V.style.cssText=L),E=="CodeMirror-linenumbers"&&(a.lineGutter=V,V.style.width=(a.lineNumWidth||1)+"px")}l.style.display=b.length?"":"none",$o(a)}function ji(a){Aa(a.display),$n(a),va(a)}function Zu(a,l,b,d){var A=this;this.input=b,A.scrollbarFiller=be("div",null,"CodeMirror-scrollbar-filler"),A.scrollbarFiller.setAttribute("cm-not-content","true"),A.gutterFiller=be("div",null,"CodeMirror-gutter-filler"),A.gutterFiller.setAttribute("cm-not-content","true"),A.lineDiv=le("div",null,"CodeMirror-code"),A.selectionDiv=be("div",null,null,"position: relative; z-index: 1"),A.cursorDiv=be("div",null,"CodeMirror-cursors"),A.measure=be("div",null,"CodeMirror-measure"),A.lineMeasure=be("div",null,"CodeMirror-measure"),A.lineSpace=le("div",[A.measure,A.lineMeasure,A.selectionDiv,A.cursorDiv,A.lineDiv],null,"position: relative; outline: none");var E=le("div",[A.lineSpace],"CodeMirror-lines");A.mover=be("div",[E],null,"position: relative"),A.sizer=be("div",[A.mover],"CodeMirror-sizer"),A.sizerWidth=null,A.heightForcer=be("div",null,null,"position: absolute; height: "+Ie+"px; width: 1px;"),A.gutters=be("div",null,"CodeMirror-gutters"),A.lineGutter=null,A.scroller=be("div",[A.sizer,A.heightForcer,A.gutters],"CodeMirror-scroll"),A.scroller.setAttribute("tabIndex","-1"),A.wrapper=be("div",[A.scrollbarFiller,A.gutterFiller,A.scroller],"CodeMirror"),A.wrapper.setAttribute("translate","no"),g&&M<8&&(A.gutters.style.zIndex=-1,A.scroller.style.paddingRight=0),!F&&!(o&&K)&&(A.scroller.draggable=!0),a&&(a.appendChild?a.appendChild(A.wrapper):a(A.wrapper)),A.viewFrom=A.viewTo=l.first,A.reportedViewFrom=A.reportedViewTo=l.first,A.view=[],A.renderedView=null,A.externalMeasured=null,A.viewOffset=0,A.lastWrapHeight=A.lastWrapWidth=0,A.updateLineNumbers=null,A.nativeBarWidth=A.barHeight=A.barWidth=0,A.scrollbarsClipped=!1,A.lineNumWidth=A.lineNumInnerWidth=A.lineNumChars=null,A.alignWidgets=!1,A.cachedCharWidth=A.cachedTextHeight=A.cachedPaddingH=null,A.maxLine=null,A.maxLineLength=0,A.maxLineChanged=!1,A.wheelDX=A.wheelDY=A.wheelStartX=A.wheelStartY=null,A.shift=!1,A.selForContextMenu=null,A.activeTouch=null,A.gutterSpecs=Oo(d.gutters,d.lineNumbers),Aa(A),b.init(A)}var Xs=0,Mr=null;g?Mr=-.53:o?Mr=15:k?Mr=-.7:$&&(Mr=-1/3);function Ca(a){var l=a.wheelDeltaX,b=a.wheelDeltaY;return l==null&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(l=a.detail),b==null&&a.detail&&a.axis==a.VERTICAL_AXIS?b=a.detail:b==null&&(b=a.wheelDelta),{x:l,y:b}}function zu(a){var l=Ca(a);return l.x*=Mr,l.y*=Mr,l}function Ma(a,l){var b=Ca(l),d=b.x,A=b.y,E=Mr;l.deltaMode===0&&(d=l.deltaX,A=l.deltaY,E=1);var L=a.display,V=L.scroller,z=V.scrollWidth>V.clientWidth,j=V.scrollHeight>V.clientHeight;if(d&&z||A&&j){if(A&&ie&&F){e:for(var fe=l.target,me=L.view;fe!=V;fe=fe.parentNode)for(var Se=0;Se<me.length;Se++)if(me[Se].node==fe){a.display.currentWheelTarget=fe;break e}}if(d&&!o&&!N&&E!=null){A&&j&&Zi(a,Math.max(0,V.scrollTop+A*E)),ti(a,Math.max(0,V.scrollLeft+d*E)),(!A||A&&j)&&Dt(l),L.wheelStartX=null;return}if(A&&E!=null){var Me=A*E,Ee=a.doc.scrollTop,Re=Ee+L.wrapper.clientHeight;Me<0?Ee=Math.max(0,Ee+Me-50):Re=Math.min(a.doc.height,Re+Me+50),Bo(a,{top:Ee,bottom:Re})}Xs<20&&l.deltaMode!==0&&(L.wheelStartX==null?(L.wheelStartX=V.scrollLeft,L.wheelStartY=V.scrollTop,L.wheelDX=d,L.wheelDY=A,setTimeout(function(){if(L.wheelStartX!=null){var ze=V.scrollLeft-L.wheelStartX,Ke=V.scrollTop-L.wheelStartY,it=Ke&&L.wheelDY&&Ke/L.wheelDY||ze&&L.wheelDX&&ze/L.wheelDX;L.wheelStartX=L.wheelStartY=null,it&&(Mr=(Mr*Xs+it)/(Xs+1),++Xs)}},200)):(L.wheelDX+=d,L.wheelDY+=A))}}var qn=function(a,l){this.ranges=a,this.primIndex=l};qn.prototype.primary=function(){return this.ranges[this.primIndex]},qn.prototype.equals=function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||a.ranges.length!=this.ranges.length)return!1;for(var l=0;l<this.ranges.length;l++){var b=this.ranges[l],d=a.ranges[l];if(!ge(b.anchor,d.anchor)||!ge(b.head,d.head))return!1}return!0},qn.prototype.deepCopy=function(){for(var a=[],l=0;l<this.ranges.length;l++)a[l]=new qt(Ne(this.ranges[l].anchor),Ne(this.ranges[l].head));return new qn(a,this.primIndex)},qn.prototype.somethingSelected=function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1},qn.prototype.contains=function(a,l){l||(l=a);for(var b=0;b<this.ranges.length;b++){var d=this.ranges[b];if(q(l,d.from())>=0&&q(a,d.to())<=0)return b}return-1};var qt=function(a,l){this.anchor=a,this.head=l};qt.prototype.from=function(){return St(this.anchor,this.head)},qt.prototype.to=function(){return Xe(this.anchor,this.head)},qt.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function fr(a,l,b){var d=a&&a.options.selectionsMayTouch,A=l[b];l.sort(function(Se,Me){return q(Se.from(),Me.from())}),b=je(l,A);for(var E=1;E<l.length;E++){var L=l[E],V=l[E-1],z=q(V.to(),L.from());if(d&&!L.empty()?z>0:z>=0){var j=St(V.from(),L.from()),fe=Xe(V.to(),L.to()),me=V.empty()?L.from()==L.head:V.from()==V.head;E<=b&&--b,l.splice(--E,2,new qt(me?fe:j,me?j:fe))}}return new qn(l,b)}function $r(a,l){return new qn([new qt(a,l||a)],0)}function Ir(a){return a.text?Be(a.from.line+a.text.length-1,_t(a.text).length+(a.text.length==1?a.from.ch:0)):a.to}function xa(a,l){if(q(a,l.from)<0)return a;if(q(a,l.to)<=0)return Ir(l);var b=a.line+l.text.length-(l.to.line-l.from.line)-1,d=a.ch;return a.line==l.to.line&&(d+=Ir(l).ch-l.to.ch),Be(b,d)}function Wo(a,l){for(var b=[],d=0;d<a.sel.ranges.length;d++){var A=a.sel.ranges[d];b.push(new qt(xa(A.anchor,l),xa(A.head,l)))}return fr(a.cm,b,a.sel.primIndex)}function Pa(a,l,b){return a.line==l.line?Be(b.line,a.ch-l.ch+b.ch):Be(b.line+(a.line-l.line),a.ch)}function Hu(a,l,b){for(var d=[],A=Be(a.first,0),E=A,L=0;L<l.length;L++){var V=l[L],z=Pa(V.from,A,E),j=Pa(Ir(V),A,E);if(A=V.to,E=j,b=="around"){var fe=a.sel.ranges[L],me=q(fe.head,fe.anchor)<0;d[L]=new qt(me?j:z,me?z:j)}else d[L]=new qt(z,z)}return new qn(d,a.sel.primIndex)}function Xo(a){a.doc.mode=Sr(a.options,a.doc.modeOption),Yi(a)}function Yi(a){a.doc.iter(function(l){l.stateAfter&&(l.stateAfter=null),l.styles&&(l.styles=null)}),a.doc.modeFrontier=a.doc.highlightFrontier=a.doc.first,Ui(a,100),a.state.modeGen++,a.curOp&&$n(a)}function Sa(a,l){return l.from.ch==0&&l.to.ch==0&&_t(l.text)==""&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}function Vo(a,l,b,d){function A(it){return b?b[it]:null}function E(it,qe,ct){fi(it,qe,ct,d),mn(it,"change",it,l)}function L(it,qe){for(var ct=[],Mt=it;Mt<qe;++Mt)ct.push(new Kn(j[Mt],A(Mt),d));return ct}var V=l.from,z=l.to,j=l.text,fe=ft(a,V.line),me=ft(a,z.line),Se=_t(j),Me=A(j.length-1),Ee=z.line-V.line;if(l.full)a.insert(0,L(0,j.length)),a.remove(j.length,a.size-j.length);else if(Sa(a,l)){var Re=L(0,j.length-1);E(me,me.text,Me),Ee&&a.remove(V.line,Ee),Re.length&&a.insert(V.line,Re)}else if(fe==me)if(j.length==1)E(fe,fe.text.slice(0,V.ch)+Se+fe.text.slice(z.ch),Me);else{var ze=L(1,j.length-1);ze.push(new Kn(Se+fe.text.slice(z.ch),Me,d)),E(fe,fe.text.slice(0,V.ch)+j[0],A(0)),a.insert(V.line+1,ze)}else if(j.length==1)E(fe,fe.text.slice(0,V.ch)+j[0]+me.text.slice(z.ch),A(0)),a.remove(V.line+1,Ee);else{E(fe,fe.text.slice(0,V.ch)+j[0],A(0)),E(me,Se+me.text.slice(z.ch),Me);var Ke=L(1,j.length-1);Ee>1&&a.remove(V.line+1,Ee-1),a.insert(V.line+1,Ke)}mn(a,"change",a,l)}function Or(a,l,b){function d(A,E,L){if(A.linked)for(var V=0;V<A.linked.length;++V){var z=A.linked[V];if(z.doc!=E){var j=L&&z.sharedHist;b&&!j||(l(z.doc,j),d(z.doc,A,j))}}}d(a,null,!0)}function wa(a,l){if(l.cm)throw new Error("This document is already in use.");a.doc=l,l.cm=a,Fo(a),Xo(a),Da(a),a.options.direction=l.direction,a.options.lineWrapping||ci(a),a.options.mode=l.modeOption,$n(a)}function Da(a){(a.doc.direction=="rtl"?rt:Fe)(a.display.lineDiv,"CodeMirror-rtl")}function Uu(a){zn(a,function(){Da(a),$n(a)})}function Vs(a){this.done=[],this.undone=[],this.undoDepth=a?a.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=a?a.maxGeneration:1}function Zo(a,l){var b={from:Ne(l.from),to:Ir(l),text:Jn(a,l.from,l.to)};return ka(a,b,l.from.line,l.to.line+1),Or(a,function(d){return ka(d,b,l.from.line,l.to.line+1)},!0),b}function Fa(a){for(;a.length;){var l=_t(a);if(l.ranges)a.pop();else break}}function ju(a,l){if(l)return Fa(a.done),_t(a.done);if(a.done.length&&!_t(a.done).ranges)return _t(a.done);if(a.done.length>1&&!a.done[a.done.length-2].ranges)return a.done.pop(),_t(a.done)}function Ea(a,l,b,d){var A=a.history;A.undone.length=0;var E=+new Date,L,V;if((A.lastOp==d||A.lastOrigin==l.origin&&l.origin&&(l.origin.charAt(0)=="+"&&A.lastModTime>E-(a.cm?a.cm.options.historyEventDelay:500)||l.origin.charAt(0)=="*"))&&(L=ju(A,A.lastOp==d)))V=_t(L.changes),q(l.from,l.to)==0&&q(l.from,V.to)==0?V.to=Ir(l):L.changes.push(Zo(a,l));else{var z=_t(A.done);for((!z||!z.ranges)&&Zs(a.sel,A.done),L={changes:[Zo(a,l)],generation:A.generation},A.done.push(L);A.done.length>A.undoDepth;)A.done.shift(),A.done[0].ranges||A.done.shift()}A.done.push(b),A.generation=++A.maxGeneration,A.lastModTime=A.lastSelTime=E,A.lastOp=A.lastSelOp=d,A.lastOrigin=A.lastSelOrigin=l.origin,V||Oe(a,"historyAdded")}function Yu(a,l,b,d){var A=l.charAt(0);return A=="*"||A=="+"&&b.ranges.length==d.ranges.length&&b.somethingSelected()==d.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}function Ku(a,l,b,d){var A=a.history,E=d&&d.origin;b==A.lastSelOp||E&&A.lastSelOrigin==E&&(A.lastModTime==A.lastSelTime&&A.lastOrigin==E||Yu(a,E,_t(A.done),l))?A.done[A.done.length-1]=l:Zs(l,A.done),A.lastSelTime=+new Date,A.lastSelOrigin=E,A.lastSelOp=b,d&&d.clearRedo!==!1&&Fa(A.undone)}function Zs(a,l){var b=_t(l);b&&b.ranges&&b.equals(a)||l.push(a)}function ka(a,l,b,d){var A=l["spans_"+a.id],E=0;a.iter(Math.max(a.first,b),Math.min(a.first+a.size,d),function(L){L.markedSpans&&((A||(A=l["spans_"+a.id]={}))[E]=L.markedSpans),++E})}function qu(a){if(!a)return null;for(var l,b=0;b<a.length;++b)a[b].marker.explicitlyCleared?l||(l=a.slice(0,b)):l&&l.push(a[b]);return l?l.length?l:null:a}function Ju(a,l){var b=l["spans_"+a.id];if(!b)return null;for(var d=[],A=0;A<l.text.length;++A)d.push(qu(b[A]));return d}function Ta(a,l){var b=Ju(a,l),d=Xt(a,l);if(!b)return d;if(!d)return b;for(var A=0;A<b.length;++A){var E=b[A],L=d[A];if(E&&L)e:for(var V=0;V<L.length;++V){for(var z=L[V],j=0;j<E.length;++j)if(E[j].marker==z.marker)continue e;E.push(z)}else L&&(b[A]=L)}return b}function Ai(a,l,b){for(var d=[],A=0;A<a.length;++A){var E=a[A];if(E.ranges){d.push(b?qn.prototype.deepCopy.call(E):E);continue}var L=E.changes,V=[];d.push({changes:V});for(var z=0;z<L.length;++z){var j=L[z],fe=void 0;if(V.push({from:j.from,to:j.to,text:j.text}),l)for(var me in j)(fe=me.match(/^spans_(\d+)$/))&&je(l,Number(fe[1]))>-1&&(_t(V)[me]=j[me],delete j[me])}}return d}function zo(a,l,b,d){if(d){var A=a.anchor;if(b){var E=q(l,A)<0;E!=q(b,A)<0?(A=l,l=b):E!=q(l,b)<0&&(l=b)}return new qt(A,l)}else return new qt(b||l,l)}function zs(a,l,b,d,A){A==null&&(A=a.cm&&(a.cm.display.shift||a.extend)),Dn(a,new qn([zo(a.sel.primary(),l,b,A)],0),d)}function Na(a,l,b){for(var d=[],A=a.cm&&(a.cm.display.shift||a.extend),E=0;E<a.sel.ranges.length;E++)d[E]=zo(a.sel.ranges[E],l[E],null,A);var L=fr(a.cm,d,a.sel.primIndex);Dn(a,L,b)}function Ho(a,l,b,d){var A=a.sel.ranges.slice(0);A[l]=b,Dn(a,fr(a.cm,A,a.sel.primIndex),d)}function La(a,l,b,d){Dn(a,$r(l,b),d)}function Qu(a,l,b){var d={ranges:l.ranges,update:function(A){this.ranges=[];for(var E=0;E<A.length;E++)this.ranges[E]=new qt(st(a,A[E].anchor),st(a,A[E].head))},origin:b&&b.origin};return Oe(a,"beforeSelectionChange",a,d),a.cm&&Oe(a.cm,"beforeSelectionChange",a.cm,d),d.ranges!=l.ranges?fr(a.cm,d.ranges,d.ranges.length-1):l}function Ga(a,l,b){var d=a.history.done,A=_t(d);A&&A.ranges?(d[d.length-1]=l,Hs(a,l,b)):Dn(a,l,b)}function Dn(a,l,b){Hs(a,l,b),Ku(a,a.sel,a.cm?a.cm.curOp.id:NaN,b)}function Hs(a,l,b){(ot(a,"beforeSelectionChange")||a.cm&&ot(a.cm,"beforeSelectionChange"))&&(l=Qu(a,l,b));var d=b&&b.bias||(q(l.primary().head,a.sel.primary().head)<0?-1:1);Ra(a,$a(a,l,d,!0)),!(b&&b.scroll===!1)&&a.cm&&a.cm.getOption("readOnly")!="nocursor"&&vi(a.cm)}function Ra(a,l){l.equals(a.sel)||(a.sel=l,a.cm&&(a.cm.curOp.updateInput=1,a.cm.curOp.selectionChanged=!0,sn(a.cm)),mn(a,"cursorActivity",a))}function Ba(a){Ra(a,$a(a,a.sel,null,!1))}function $a(a,l,b,d){for(var A,E=0;E<l.ranges.length;E++){var L=l.ranges[E],V=l.ranges.length==a.sel.ranges.length&&a.sel.ranges[E],z=Us(a,L.anchor,V&&V.anchor,b,d),j=Us(a,L.head,V&&V.head,b,d);(A||z!=L.anchor||j!=L.head)&&(A||(A=l.ranges.slice(0,E)),A[E]=new qt(z,j))}return A?fr(a.cm,A,l.primIndex):l}function Ci(a,l,b,d,A){var E=ft(a,l.line);if(E.markedSpans)for(var L=0;L<E.markedSpans.length;++L){var V=E.markedSpans[L],z=V.marker,j="selectLeft"in z?!z.selectLeft:z.inclusiveLeft,fe="selectRight"in z?!z.selectRight:z.inclusiveRight;if((V.from==null||(j?V.from<=l.ch:V.from<l.ch))&&(V.to==null||(fe?V.to>=l.ch:V.to>l.ch))){if(A&&(Oe(z,"beforeCursorEnter"),z.explicitlyCleared))if(E.markedSpans){--L;continue}else break;if(!z.atomic)continue;if(b){var me=z.find(d<0?1:-1),Se=void 0;if((d<0?fe:j)&&(me=Ia(a,me,-d,me&&me.line==l.line?E:null)),me&&me.line==l.line&&(Se=q(me,b))&&(d<0?Se<0:Se>0))return Ci(a,me,l,d,A)}var Me=z.find(d<0?-1:1);return(d<0?j:fe)&&(Me=Ia(a,Me,d,Me.line==l.line?E:null)),Me?Ci(a,Me,l,d,A):null}}return l}function Us(a,l,b,d,A){var E=d||1,L=Ci(a,l,b,E,A)||!A&&Ci(a,l,b,E,!0)||Ci(a,l,b,-E,A)||!A&&Ci(a,l,b,-E,!0);return L||(a.cantEdit=!0,Be(a.first,0))}function Ia(a,l,b,d){return b<0&&l.ch==0?l.line>a.first?st(a,Be(l.line-1)):null:b>0&&l.ch==(d||ft(a,l.line)).text.length?l.line<a.first+a.size-1?Be(l.line+1,0):null:new Be(l.line,l.ch+b)}function Oa(a){a.setSelection(Be(a.firstLine(),0),Be(a.lastLine()),pt)}function Wa(a,l,b){var d={canceled:!1,from:l.from,to:l.to,text:l.text,origin:l.origin,cancel:function(){return d.canceled=!0}};return b&&(d.update=function(A,E,L,V){A&&(d.from=st(a,A)),E&&(d.to=st(a,E)),L&&(d.text=L),V!==void 0&&(d.origin=V)}),Oe(a,"beforeChange",a,d),a.cm&&Oe(a.cm,"beforeChange",a.cm,d),d.canceled?(a.cm&&(a.cm.curOp.updateInput=2),null):{from:d.from,to:d.to,text:d.text,origin:d.origin}}function Mi(a,l,b){if(a.cm){if(!a.cm.curOp)return Cn(a.cm,Mi)(a,l,b);if(a.cm.state.suppressEdits)return}if(!((ot(a,"beforeChange")||a.cm&&ot(a.cm,"beforeChange"))&&(l=Wa(a,l,!0),!l))){var d=_s&&!b&&so(a,l.from,l.to);if(d)for(var A=d.length-1;A>=0;--A)Xa(a,{from:d[A].from,to:d[A].to,text:A?[""]:l.text,origin:l.origin});else Xa(a,l)}}function Xa(a,l){if(!(l.text.length==1&&l.text[0]==""&&q(l.from,l.to)==0)){var b=Wo(a,l);Ea(a,l,b,a.cm?a.cm.curOp.id:NaN),Ki(a,l,b,Xt(a,l));var d=[];Or(a,function(A,E){!E&&je(d,A.history)==-1&&(Ha(A.history,l),d.push(A.history)),Ki(A,l,null,Xt(A,l))})}}function js(a,l,b){var d=a.cm&&a.cm.state.suppressEdits;if(!(d&&!b)){for(var A=a.history,E,L=a.sel,V=l=="undo"?A.done:A.undone,z=l=="undo"?A.undone:A.done,j=0;j<V.length&&(E=V[j],!(b?E.ranges&&!E.equals(a.sel):!E.ranges));j++);if(j!=V.length){for(A.lastOrigin=A.lastSelOrigin=null;;)if(E=V.pop(),E.ranges){if(Zs(E,z),b&&!E.equals(a.sel)){Dn(a,E,{clearRedo:!1});return}L=E}else if(d){V.push(E);return}else break;var fe=[];Zs(L,z),z.push({changes:fe,generation:A.generation}),A.generation=E.generation||++A.maxGeneration;for(var me=ot(a,"beforeChange")||a.cm&&ot(a.cm,"beforeChange"),Se=function(Re){var ze=E.changes[Re];if(ze.origin=l,me&&!Wa(a,ze,!1))return V.length=0,{};fe.push(Zo(a,ze));var Ke=Re?Wo(a,ze):_t(V);Ki(a,ze,Ke,Ta(a,ze)),!Re&&a.cm&&a.cm.scrollIntoView({from:ze.from,to:Ir(ze)});var it=[];Or(a,function(qe,ct){!ct&&je(it,qe.history)==-1&&(Ha(qe.history,ze),it.push(qe.history)),Ki(qe,ze,null,Ta(qe,ze))})},Me=E.changes.length-1;Me>=0;--Me){var Ee=Se(Me);if(Ee)return Ee.v}}}}function Va(a,l){if(l!=0&&(a.first+=l,a.sel=new qn($t(a.sel.ranges,function(A){return new qt(Be(A.anchor.line+l,A.anchor.ch),Be(A.head.line+l,A.head.ch))}),a.sel.primIndex),a.cm)){$n(a.cm,a.first,a.first-l,l);for(var b=a.cm.display,d=b.viewFrom;d<b.viewTo;d++)Rr(a.cm,d,"gutter")}}function Ki(a,l,b,d){if(a.cm&&!a.cm.curOp)return Cn(a.cm,Ki)(a,l,b,d);if(l.to.line<a.first){Va(a,l.text.length-1-(l.to.line-l.from.line));return}if(!(l.from.line>a.lastLine())){if(l.from.line<a.first){var A=l.text.length-1-(a.first-l.from.line);Va(a,A),l={from:Be(a.first,0),to:Be(l.to.line+A,l.to.ch),text:[_t(l.text)],origin:l.origin}}var E=a.lastLine();l.to.line>E&&(l={from:l.from,to:Be(E,ft(a,E).text.length),text:[l.text[0]],origin:l.origin}),l.removed=Jn(a,l.from,l.to),b||(b=Wo(a,l)),a.cm?el(a.cm,l,d):Vo(a,l,d),Hs(a,b,pt),a.cantEdit&&Us(a,Be(a.firstLine(),0))&&(a.cantEdit=!1)}}function el(a,l,b){var d=a.doc,A=a.display,E=l.from,L=l.to,V=!1,z=E.line;a.options.lineWrapping||(z=jt(Yn(ft(d,E.line))),d.iter(z,L.line+1,function(Me){if(Me==A.maxLine)return V=!0,!0})),d.sel.contains(l.from,l.to)>-1&&sn(a),Vo(d,l,b,ua(a)),a.options.lineWrapping||(d.iter(z,E.line+l.text.length,function(Me){var Ee=Kr(Me);Ee>A.maxLineLength&&(A.maxLine=Me,A.maxLineLength=Ee,A.maxLineChanged=!0,V=!1)}),V&&(a.curOp.updateMaxLine=!0)),ro(d,E.line),Ui(a,400);var j=l.text.length-(L.line-E.line)-1;l.full?$n(a):E.line==L.line&&l.text.length==1&&!Sa(a.doc,l)?Rr(a,E.line,"text"):$n(a,E.line,L.line+1,j);var fe=ot(a,"changes"),me=ot(a,"change");if(me||fe){var Se={from:E,to:L,text:l.text,removed:l.removed,origin:l.origin};me&&mn(a,"change",a,Se),fe&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(Se)}a.display.selForContextMenu=null}function xi(a,l,b,d,A){var E;d||(d=b),q(d,b)<0&&(E=[d,b],b=E[0],d=E[1]),typeof l=="string"&&(l=a.splitLines(l)),Mi(a,{from:b,to:d,text:l,origin:A})}function Za(a,l,b,d){b<a.line?a.line+=d:l<a.line&&(a.line=l,a.ch=0)}function za(a,l,b,d){for(var A=0;A<a.length;++A){var E=a[A],L=!0;if(E.ranges){E.copied||(E=a[A]=E.deepCopy(),E.copied=!0);for(var V=0;V<E.ranges.length;V++)Za(E.ranges[V].anchor,l,b,d),Za(E.ranges[V].head,l,b,d);continue}for(var z=0;z<E.changes.length;++z){var j=E.changes[z];if(b<j.from.line)j.from=Be(j.from.line+d,j.from.ch),j.to=Be(j.to.line+d,j.to.ch);else if(l<=j.to.line){L=!1;break}}L||(a.splice(0,A+1),A=0)}}function Ha(a,l){var b=l.from.line,d=l.to.line,A=l.text.length-(d-b)-1;za(a.done,b,d,A),za(a.undone,b,d,A)}function qi(a,l,b,d){var A=l,E=l;return typeof l=="number"?E=ft(a,Vt(a,l)):A=jt(l),A==null?null:(d(E,A)&&a.cm&&Rr(a.cm,A,b),E)}function Ji(a){this.lines=a,this.parent=null;for(var l=0,b=0;b<a.length;++b)a[b].parent=this,l+=a[b].height;this.height=l}Ji.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,l){for(var b=a,d=a+l;b<d;++b){var A=this.lines[b];this.height-=A.height,As(A),mn(A,"delete")}this.lines.splice(a,l)},collapse:function(a){a.push.apply(a,this.lines)},insertInner:function(a,l,b){this.height+=b,this.lines=this.lines.slice(0,a).concat(l).concat(this.lines.slice(a));for(var d=0;d<l.length;++d)l[d].parent=this},iterN:function(a,l,b){for(var d=a+l;a<d;++a)if(b(this.lines[a]))return!0}};function Qi(a){this.children=a;for(var l=0,b=0,d=0;d<a.length;++d){var A=a[d];l+=A.chunkSize(),b+=A.height,A.parent=this}this.size=l,this.height=b,this.parent=null}Qi.prototype={chunkSize:function(){return this.size},removeInner:function(a,l){this.size-=l;for(var b=0;b<this.children.length;++b){var d=this.children[b],A=d.chunkSize();if(a<A){var E=Math.min(l,A-a),L=d.height;if(d.removeInner(a,E),this.height-=L-d.height,A==E&&(this.children.splice(b--,1),d.parent=null),(l-=E)==0)break;a=0}else a-=A}if(this.size-l<25&&(this.children.length>1||!(this.children[0]instanceof Ji))){var V=[];this.collapse(V),this.children=[new Ji(V)],this.children[0].parent=this}},collapse:function(a){for(var l=0;l<this.children.length;++l)this.children[l].collapse(a)},insertInner:function(a,l,b){this.size+=l.length,this.height+=b;for(var d=0;d<this.children.length;++d){var A=this.children[d],E=A.chunkSize();if(a<=E){if(A.insertInner(a,l,b),A.lines&&A.lines.length>50){for(var L=A.lines.length%25+25,V=L;V<A.lines.length;){var z=new Ji(A.lines.slice(V,V+=25));A.height-=z.height,this.children.splice(++d,0,z),z.parent=this}A.lines=A.lines.slice(0,L),this.maybeSpill()}break}a-=E}},maybeSpill:function(){if(!(this.children.length<=10)){var a=this;do{var l=a.children.splice(a.children.length-5,5),b=new Qi(l);if(a.parent){a.size-=b.size,a.height-=b.height;var A=je(a.parent.children,a);a.parent.children.splice(A+1,0,b)}else{var d=new Qi(a.children);d.parent=a,a.children=[d,b],a=d}b.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()}},iterN:function(a,l,b){for(var d=0;d<this.children.length;++d){var A=this.children[d],E=A.chunkSize();if(a<E){var L=Math.min(l,E-a);if(A.iterN(a,L,b))return!0;if((l-=L)==0)break;a=0}else a-=E}}};var es=function(a,l,b){if(b)for(var d in b)b.hasOwnProperty(d)&&(this[d]=b[d]);this.doc=a,this.node=l};es.prototype.clear=function(){var a=this.doc.cm,l=this.line.widgets,b=this.line,d=jt(b);if(!(d==null||!l)){for(var A=0;A<l.length;++A)l[A]==this&&l.splice(A--,1);l.length||(b.widgets=null);var E=br(this);En(b,Math.max(0,b.height-E)),a&&(zn(a,function(){Ua(a,b,-E),Rr(a,d,"widget")}),mn(a,"lineWidgetCleared",a,this,d))}},es.prototype.changed=function(){var a=this,l=this.height,b=this.doc.cm,d=this.line;this.height=null;var A=br(this)-l;A&&(Bn(this.doc,d)||En(d,d.height+A),b&&zn(b,function(){b.curOp.forceUpdate=!0,Ua(b,d,A),mn(b,"lineWidgetChanged",b,a,jt(d))}))},Pt(es);function Ua(a,l,b){Tn(l)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&Go(a,b)}function tl(a,l,b,d){var A=new es(a,b,d),E=a.cm;return E&&A.noHScroll&&(E.display.alignWidgets=!0),qi(a,l,"widget",function(L){var V=L.widgets||(L.widgets=[]);if(A.insertAt==null?V.push(A):V.splice(Math.min(V.length,Math.max(0,A.insertAt)),0,A),A.line=L,E&&!Bn(a,L)){var z=Tn(L)<a.scrollTop;En(L,L.height+br(A)),z&&Go(E,A.height),E.curOp.forceUpdate=!0}return!0}),E&&mn(E,"lineWidgetAdded",E,A,typeof l=="number"?l:jt(l)),A}var ja=0,Wr=function(a,l){this.lines=[],this.type=l,this.doc=a,this.id=++ja};Wr.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,l=a&&!a.curOp;if(l&&ri(a),ot(this,"clear")){var b=this.find();b&&mn(this,"clear",b.from,b.to)}for(var d=null,A=null,E=0;E<this.lines.length;++E){var L=this.lines[E],V=hr(L.markedSpans,this);a&&!this.collapsed?Rr(a,jt(L),"text"):a&&(V.to!=null&&(A=jt(L)),V.from!=null&&(d=jt(L))),L.markedSpans=vt(L.markedSpans,V),V.from==null&&this.collapsed&&!Bn(this.doc,L)&&a&&En(L,gi(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(var z=0;z<this.lines.length;++z){var j=Yn(this.lines[z]),fe=Kr(j);fe>a.display.maxLineLength&&(a.display.maxLine=j,a.display.maxLineLength=fe,a.display.maxLineChanged=!0)}d!=null&&a&&this.collapsed&&$n(a,d,A+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Ba(a.doc)),a&&mn(a,"markerCleared",a,this,d,A),l&&ii(a),this.parent&&this.parent.clear()}},Wr.prototype.find=function(a,l){a==null&&this.type=="bookmark"&&(a=1);for(var b,d,A=0;A<this.lines.length;++A){var E=this.lines[A],L=hr(E.markedSpans,this);if(L.from!=null&&(b=Be(l?E:jt(E),L.from),a==-1))return b;if(L.to!=null&&(d=Be(l?E:jt(E),L.to),a==1))return d}return b&&{from:b,to:d}},Wr.prototype.changed=function(){var a=this,l=this.find(-1,!0),b=this,d=this.doc.cm;!l||!d||zn(d,function(){var A=l.line,E=jt(l.line),L=Lr(d,E);if(L&&(Le(L),d.curOp.selectionChanged=d.curOp.forceUpdate=!0),d.curOp.updateMaxLine=!0,!Bn(b.doc,A)&&b.height!=null){var V=b.height;b.height=null;var z=br(b)-V;z&&En(A,A.height+z)}mn(d,"markerChanged",d,a)})},Wr.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(!l.maybeHiddenMarkers||je(l.maybeHiddenMarkers,this)==-1)&&(l.maybeUnhiddenMarkers||(l.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)},Wr.prototype.detachLine=function(a){if(this.lines.splice(je(this.lines,a),1),!this.lines.length&&this.doc.cm){var l=this.doc.cm.curOp;(l.maybeHiddenMarkers||(l.maybeHiddenMarkers=[])).push(this)}},Pt(Wr);function Pi(a,l,b,d,A){if(d&&d.shared)return nl(a,l,b,d,A);if(a.cm&&!a.cm.curOp)return Cn(a.cm,Pi)(a,l,b,d,A);var E=new Wr(a,A),L=q(l,b);if(d&&Tt(d,E,!1),L>0||L==0&&E.clearWhenEmpty!==!1)return E;if(E.replacedWith&&(E.collapsed=!0,E.widgetNode=le("span",[E.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||E.widgetNode.setAttribute("cm-ignore-events","true"),d.insertLeft&&(E.widgetNode.insertLeft=!0)),E.collapsed){if(vs(a,l.line,l,b,E)||l.line!=b.line&&vs(a,b.line,l,b,E))throw new Error("Inserting collapsed marker partially overlapping an existing one");Dr()}E.addToHistory&&Ea(a,{from:l,to:b,origin:"markText"},a.sel,NaN);var V=l.line,z=a.cm,j;if(a.iter(V,b.line+1,function(me){z&&E.collapsed&&!z.options.lineWrapping&&Yn(me)==z.display.maxLine&&(j=!0),E.collapsed&&V!=l.line&&En(me,0),Yr(me,new kn(E,V==l.line?l.ch:null,V==b.line?b.ch:null),a.cm&&a.cm.curOp),++V}),E.collapsed&&a.iter(l.line,b.line+1,function(me){Bn(a,me)&&En(me,0)}),E.clearOnEnter&&Ue(E,"beforeCursorEnter",function(){return E.clear()}),E.readOnly&&(Nt(),(a.history.done.length||a.history.undone.length)&&a.clearHistory()),E.collapsed&&(E.id=++ja,E.atomic=!0),z){if(j&&(z.curOp.updateMaxLine=!0),E.collapsed)$n(z,l.line,b.line+1);else if(E.className||E.startStyle||E.endStyle||E.css||E.attributes||E.title)for(var fe=l.line;fe<=b.line;fe++)Rr(z,fe,"text");E.atomic&&Ba(z.doc),mn(z,"markerAdded",z,E)}return E}var ts=function(a,l){this.markers=a,this.primary=l;for(var b=0;b<a.length;++b)a[b].parent=this};ts.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();mn(this,"clear")}},ts.prototype.find=function(a,l){return this.primary.find(a,l)},Pt(ts);function nl(a,l,b,d,A){d=Tt(d),d.shared=!1;var E=[Pi(a,l,b,d,A)],L=E[0],V=d.widgetNode;return Or(a,function(z){V&&(d.widgetNode=V.cloneNode(!0)),E.push(Pi(z,st(z,l),st(z,b),d,A));for(var j=0;j<z.linked.length;++j)if(z.linked[j].isParent)return;L=_t(E)}),new ts(E,L)}function Ya(a){return a.findMarks(Be(a.first,0),a.clipPos(Be(a.lastLine())),function(l){return l.parent})}function rl(a,l){for(var b=0;b<l.length;b++){var d=l[b],A=d.find(),E=a.clipPos(A.from),L=a.clipPos(A.to);if(q(E,L)){var V=Pi(a,E,L,d.primary,d.primary.type);d.markers.push(V),V.parent=d}}}function il(a){for(var l=function(d){var A=a[d],E=[A.primary.doc];Or(A.primary.doc,function(z){return E.push(z)});for(var L=0;L<A.markers.length;L++){var V=A.markers[L];je(E,V.doc)==-1&&(V.parent=null,A.markers.splice(L--,1))}},b=0;b<a.length;b++)l(b)}var sl=0,In=function(a,l,b,d,A){if(!(this instanceof In))return new In(a,l,b,d,A);b==null&&(b=0),Qi.call(this,[new Ji([new Kn("",null)])]),this.first=b,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=b;var E=Be(b,0);this.sel=$r(E),this.history=new Vs(null),this.id=++sl,this.modeOption=l,this.lineSep=d,this.direction=A=="rtl"?"rtl":"ltr",this.extend=!1,typeof a=="string"&&(a=this.splitLines(a)),Vo(this,{from:E,to:E,text:a}),Dn(this,$r(E),pt)};In.prototype=Yt(Qi.prototype,{constructor:In,iter:function(a,l,b){b?this.iterN(a-this.first,l-a,b):this.iterN(this.first,this.first+this.size,a)},insert:function(a,l){for(var b=0,d=0;d<l.length;++d)b+=l[d].height;this.insertInner(a-this.first,l,b)},remove:function(a,l){this.removeInner(a-this.first,l)},getValue:function(a){var l=Hr(this,this.first,this.first+this.size);return a===!1?l:l.join(a||this.lineSeparator())},setValue:Mn(function(a){var l=Be(this.first,0),b=this.first+this.size-1;Mi(this,{from:l,to:Be(b,ft(this,b).text.length),text:this.splitLines(a),origin:"setValue",full:!0},!0),this.cm&&Vi(this.cm,0,0),Dn(this,$r(l),pt)}),replaceRange:function(a,l,b,d){l=st(this,l),b=b?st(this,b):l,xi(this,a,l,b,d)},getRange:function(a,l,b){var d=Jn(this,st(this,a),st(this,l));return b===!1?d:b===""?d.join(""):d.join(b||this.lineSeparator())},getLine:function(a){var l=this.getLineHandle(a);return l&&l.text},getLineHandle:function(a){if(vr(this,a))return ft(this,a)},getLineNumber:function(a){return jt(a)},getLineHandleVisualStart:function(a){return typeof a=="number"&&(a=ft(this,a)),Yn(a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return st(this,a)},getCursor:function(a){var l=this.sel.primary(),b;return a==null||a=="head"?b=l.head:a=="anchor"?b=l.anchor:a=="end"||a=="to"||a===!1?b=l.to():b=l.from(),b},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Mn(function(a,l,b){La(this,st(this,typeof a=="number"?Be(a,l||0):a),null,b)}),setSelection:Mn(function(a,l,b){La(this,st(this,a),st(this,l||a),b)}),extendSelection:Mn(function(a,l,b){zs(this,st(this,a),l&&st(this,l),b)}),extendSelections:Mn(function(a,l){Na(this,Rn(this,a),l)}),extendSelectionsBy:Mn(function(a,l){var b=$t(this.sel.ranges,a);Na(this,Rn(this,b),l)}),setSelections:Mn(function(a,l,b){if(a.length){for(var d=[],A=0;A<a.length;A++)d[A]=new qt(st(this,a[A].anchor),st(this,a[A].head||a[A].anchor));l==null&&(l=Math.min(a.length-1,this.sel.primIndex)),Dn(this,fr(this.cm,d,l),b)}}),addSelection:Mn(function(a,l,b){var d=this.sel.ranges.slice(0);d.push(new qt(st(this,a),st(this,l||a))),Dn(this,fr(this.cm,d,d.length-1),b)}),getSelection:function(a){for(var l=this.sel.ranges,b,d=0;d<l.length;d++){var A=Jn(this,l[d].from(),l[d].to());b=b?b.concat(A):A}return a===!1?b:b.join(a||this.lineSeparator())},getSelections:function(a){for(var l=[],b=this.sel.ranges,d=0;d<b.length;d++){var A=Jn(this,b[d].from(),b[d].to());a!==!1&&(A=A.join(a||this.lineSeparator())),l[d]=A}return l},replaceSelection:function(a,l,b){for(var d=[],A=0;A<this.sel.ranges.length;A++)d[A]=a;this.replaceSelections(d,l,b||"+input")},replaceSelections:Mn(function(a,l,b){for(var d=[],A=this.sel,E=0;E<A.ranges.length;E++){var L=A.ranges[E];d[E]={from:L.from(),to:L.to(),text:this.splitLines(a[E]),origin:b}}for(var V=l&&l!="end"&&Hu(this,d,l),z=d.length-1;z>=0;z--)Mi(this,d[z]);V?Ga(this,V):this.cm&&vi(this.cm)}),undo:Mn(function(){js(this,"undo")}),redo:Mn(function(){js(this,"redo")}),undoSelection:Mn(function(){js(this,"undo",!0)}),redoSelection:Mn(function(){js(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=this.history,l=0,b=0,d=0;d<a.done.length;d++)a.done[d].ranges||++l;for(var A=0;A<a.undone.length;A++)a.undone[A].ranges||++b;return{undo:l,redo:b}},clearHistory:function(){var a=this;this.history=new Vs(this.history),Or(this,function(l){return l.history=a.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){return a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:Ai(this.history.done),undone:Ai(this.history.undone)}},setHistory:function(a){var l=this.history=new Vs(this.history);l.done=Ai(a.done.slice(0),null,!0),l.undone=Ai(a.undone.slice(0),null,!0)},setGutterMarker:Mn(function(a,l,b){return qi(this,a,"gutter",function(d){var A=d.gutterMarkers||(d.gutterMarkers={});return A[l]=b,!b&&ye(A)&&(d.gutterMarkers=null),!0})}),clearGutter:Mn(function(a){var l=this;this.iter(function(b){b.gutterMarkers&&b.gutterMarkers[a]&&qi(l,b,"gutter",function(){return b.gutterMarkers[a]=null,ye(b.gutterMarkers)&&(b.gutterMarkers=null),!0})})}),lineInfo:function(a){var l;if(typeof a=="number"){if(!vr(this,a)||(l=a,a=ft(this,a),!a))return null}else if(l=jt(a),l==null)return null;return{line:l,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},addLineClass:Mn(function(a,l,b){return qi(this,a,l=="gutter"?"gutter":"class",function(d){var A=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass";if(!d[A])d[A]=b;else{if(Ae(b).test(d[A]))return!1;d[A]+=" "+b}return!0})}),removeLineClass:Mn(function(a,l,b){return qi(this,a,l=="gutter"?"gutter":"class",function(d){var A=l=="text"?"textClass":l=="background"?"bgClass":l=="gutter"?"gutterClass":"wrapClass",E=d[A];if(E)if(b==null)d[A]=null;else{var L=E.match(Ae(b));if(!L)return!1;var V=L.index+L[0].length;d[A]=E.slice(0,L.index)+(!L.index||V==E.length?"":" ")+E.slice(V)||null}else return!1;return!0})}),addLineWidget:Mn(function(a,l,b){return tl(this,a,l,b)}),removeLineWidget:function(a){a.clear()},markText:function(a,l,b){return Pi(this,st(this,a),st(this,l),b,b&&b.type||"range")},setBookmark:function(a,l){var b={replacedWith:l&&(l.nodeType==null?l.widget:l),insertLeft:l&&l.insertLeft,clearWhenEmpty:!1,shared:l&&l.shared,handleMouseEvents:l&&l.handleMouseEvents};return a=st(this,a),Pi(this,a,a,b,"bookmark")},findMarksAt:function(a){a=st(this,a);var l=[],b=ft(this,a.line).markedSpans;if(b)for(var d=0;d<b.length;++d){var A=b[d];(A.from==null||A.from<=a.ch)&&(A.to==null||A.to>=a.ch)&&l.push(A.marker.parent||A.marker)}return l},findMarks:function(a,l,b){a=st(this,a),l=st(this,l);var d=[],A=a.line;return this.iter(a.line,l.line+1,function(E){var L=E.markedSpans;if(L)for(var V=0;V<L.length;V++){var z=L[V];!(z.to!=null&&A==a.line&&a.ch>=z.to||z.from==null&&A!=a.line||z.from!=null&&A==l.line&&z.from>=l.ch)&&(!b||b(z.marker))&&d.push(z.marker.parent||z.marker)}++A}),d},getAllMarks:function(){var a=[];return this.iter(function(l){var b=l.markedSpans;if(b)for(var d=0;d<b.length;++d)b[d].from!=null&&a.push(b[d].marker)}),a},posFromIndex:function(a){var l,b=this.first,d=this.lineSeparator().length;return this.iter(function(A){var E=A.text.length+d;if(E>a)return l=a,!0;a-=E,++b}),st(this,Be(b,l))},indexFromPos:function(a){a=st(this,a);var l=a.ch;if(a.line<this.first||a.ch<0)return 0;var b=this.lineSeparator().length;return this.iter(this.first,a.line,function(d){l+=d.text.length+b}),l},copy:function(a){var l=new In(Hr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return l.scrollTop=this.scrollTop,l.scrollLeft=this.scrollLeft,l.sel=this.sel,l.extend=!1,a&&(l.history.undoDepth=this.history.undoDepth,l.setHistory(this.getHistory())),l},linkedDoc:function(a){a||(a={});var l=this.first,b=this.first+this.size;a.from!=null&&a.from>l&&(l=a.from),a.to!=null&&a.to<b&&(b=a.to);var d=new In(Hr(this,l,b),a.mode||this.modeOption,l,this.lineSep,this.direction);return a.sharedHist&&(d.history=this.history),(this.linked||(this.linked=[])).push({doc:d,sharedHist:a.sharedHist}),d.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}],rl(d,Ya(this)),d},unlinkDoc:function(a){if(a instanceof an&&(a=a.doc),this.linked)for(var l=0;l<this.linked.length;++l){var b=this.linked[l];if(b.doc==a){this.linked.splice(l,1),a.unlinkDoc(this),il(Ya(this));break}}if(a.history==this.history){var d=[a.id];Or(a,function(A){return d.push(A.id)},!0),a.history=new Vs(null),a.history.done=Ai(this.history.done,d),a.history.undone=Ai(this.history.undone,d)}},iterLinkedDocs:function(a){Or(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?a.split(this.lineSep):Ge(a)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Mn(function(a){a!="rtl"&&(a="ltr"),a!=this.direction&&(this.direction=a,this.iter(function(l){return l.order=null}),this.cm&&Uu(this.cm))})}),In.prototype.eachLine=In.prototype.iter;var Ka=0;function ol(a){var l=this;if(qa(l),!(Wt(l,a)||lr(l.display,a))){Dt(a),g&&(Ka=+new Date);var b=Qr(l,a,!0),d=a.dataTransfer.files;if(!(!b||l.isReadOnly()))if(d&&d.length&&window.FileReader&&window.File)for(var A=d.length,E=Array(A),L=0,V=function(){++L==A&&Cn(l,function(){b=st(l.doc,b);var Me={from:b,to:b,text:l.doc.splitLines(E.filter(function(Ee){return Ee!=null}).join(l.doc.lineSeparator())),origin:"paste"};Mi(l.doc,Me),Ga(l.doc,$r(st(l.doc,b),st(l.doc,Ir(Me))))})()},z=function(Me,Ee){if(l.options.allowDropFileTypes&&je(l.options.allowDropFileTypes,Me.type)==-1){V();return}var Re=new FileReader;Re.onerror=function(){return V()},Re.onload=function(){var ze=Re.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(ze)){V();return}E[Ee]=ze,V()},Re.readAsText(Me)},j=0;j<d.length;j++)z(d[j],j);else{if(l.state.draggingText&&l.doc.sel.contains(b)>-1){l.state.draggingText(a),setTimeout(function(){return l.display.input.focus()},20);return}try{var fe=a.dataTransfer.getData("Text");if(fe){var me;if(l.state.draggingText&&!l.state.draggingText.copy&&(me=l.listSelections()),Hs(l.doc,$r(b,b)),me)for(var Se=0;Se<me.length;++Se)xi(l.doc,"",me[Se].anchor,me[Se].head,"drag");l.replaceSelection(fe,"around","paste"),l.display.input.focus()}}catch{}}}}function al(a,l){if(g&&(!a.state.draggingText||+new Date-Ka<100)){ln(l);return}if(!(Wt(a,l)||lr(a.display,l))&&(l.dataTransfer.setData("Text",a.getSelection()),l.dataTransfer.effectAllowed="copyMove",l.dataTransfer.setDragImage&&!$)){var b=be("img",null,null,"position: fixed; left: 0; top: 0;");b.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",N&&(b.width=b.height=1,a.display.wrapper.appendChild(b),b._top=b.offsetTop),l.dataTransfer.setDragImage(b,0,0),N&&b.parentNode.removeChild(b)}}function ul(a,l){var b=Qr(a,l);if(b){var d=document.createDocumentFragment();Eo(a,b,d),a.display.dragCursor||(a.display.dragCursor=be("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),a.display.lineSpace.insertBefore(a.display.dragCursor,a.display.cursorDiv)),Ce(a.display.dragCursor,d)}}function qa(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=null)}function Ja(a){if(document.getElementsByClassName){for(var l=document.getElementsByClassName("CodeMirror"),b=[],d=0;d<l.length;d++){var A=l[d].CodeMirror;A&&b.push(A)}b.length&&b[0].operation(function(){for(var E=0;E<b.length;E++)a(b[E])})}}var Qa=!1;function ll(){Qa||(cl(),Qa=!0)}function cl(){var a;Ue(window,"resize",function(){a==null&&(a=setTimeout(function(){a=null,Ja(fl)},100))}),Ue(window,"blur",function(){return Ja(yi)})}function fl(a){var l=a.display;l.cachedCharWidth=l.cachedTextHeight=l.cachedPaddingH=null,l.scrollbarsClipped=!1,a.setSize()}for(var Xr={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ns=0;ns<10;ns++)Xr[ns+48]=Xr[ns+96]=String(ns);for(var Ys=65;Ys<=90;Ys++)Xr[Ys]=String.fromCharCode(Ys);for(var rs=1;rs<=12;rs++)Xr[rs+111]=Xr[rs+63235]="F"+rs;var xr={};xr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},xr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},xr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},xr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},xr.default=ie?xr.macDefault:xr.pcDefault;function pl(a){var l=a.split(/-(?!$)/);a=l[l.length-1];for(var b,d,A,E,L=0;L<l.length-1;L++){var V=l[L];if(/^(cmd|meta|m)$/i.test(V))E=!0;else if(/^a(lt)?$/i.test(V))b=!0;else if(/^(c|ctrl|control)$/i.test(V))d=!0;else if(/^s(hift)?$/i.test(V))A=!0;else throw new Error("Unrecognized modifier name: "+V)}return b&&(a="Alt-"+a),d&&(a="Ctrl-"+a),E&&(a="Cmd-"+a),A&&(a="Shift-"+a),a}function dl(a){var l={};for(var b in a)if(a.hasOwnProperty(b)){var d=a[b];if(/^(name|fallthrough|(de|at)tach)$/.test(b))continue;if(d=="..."){delete a[b];continue}for(var A=$t(b.split(" "),pl),E=0;E<A.length;E++){var L=void 0,V=void 0;E==A.length-1?(V=A.join(" "),L=d):(V=A.slice(0,E+1).join(" "),L="...");var z=l[V];if(!z)l[V]=L;else if(z!=L)throw new Error("Inconsistent bindings for "+V)}delete a[b]}for(var j in l)a[j]=l[j];return a}function Si(a,l,b,d){l=Ks(l);var A=l.call?l.call(a,d):l[a];if(A===!1)return"nothing";if(A==="...")return"multi";if(A!=null&&b(A))return"handled";if(l.fallthrough){if(Object.prototype.toString.call(l.fallthrough)!="[object Array]")return Si(a,l.fallthrough,b,d);for(var E=0;E<l.fallthrough.length;E++){var L=Si(a,l.fallthrough[E],b,d);if(L)return L}}}function eu(a){var l=typeof a=="string"?a:Xr[a.keyCode];return l=="Ctrl"||l=="Alt"||l=="Shift"||l=="Mod"}function tu(a,l,b){var d=a;return l.altKey&&d!="Alt"&&(a="Alt-"+a),(ue?l.metaKey:l.ctrlKey)&&d!="Ctrl"&&(a="Ctrl-"+a),(ue?l.ctrlKey:l.metaKey)&&d!="Mod"&&(a="Cmd-"+a),!b&&l.shiftKey&&d!="Shift"&&(a="Shift-"+a),a}function nu(a,l){if(N&&a.keyCode==34&&a.char)return!1;var b=Xr[a.keyCode];return b==null||a.altGraphKey?!1:(a.keyCode==3&&a.code&&(b=a.code),tu(b,a,l))}function Ks(a){return typeof a=="string"?xr[a]:a}function wi(a,l){for(var b=a.doc.sel.ranges,d=[],A=0;A<b.length;A++){for(var E=l(b[A]);d.length&&q(E.from,_t(d).to)<=0;){var L=d.pop();if(q(L.from,E.from)<0){E.from=L.from;break}}d.push(E)}zn(a,function(){for(var V=d.length-1;V>=0;V--)xi(a.doc,"",d[V].from,d[V].to,"+delete");vi(a)})}function Uo(a,l,b){var d=et(a.text,l+b,b);return d<0||d>a.text.length?null:d}function jo(a,l,b){var d=Uo(a,l.ch,b);return d==null?null:new Be(l.line,d,b<0?"after":"before")}function Yo(a,l,b,d,A){if(a){l.doc.direction=="rtl"&&(A=-A);var E=It(b,l.doc.direction);if(E){var L=A<0?_t(E):E[0],V=A<0==(L.level==1),z=V?"after":"before",j;if(L.level>0||l.doc.direction=="rtl"){var fe=Gr(l,b);j=A<0?b.text.length-1:0;var me=ur(l,fe,j).top;j=We(function(Se){return ur(l,fe,Se).top==me},A<0==(L.level==1)?L.from:L.to-1,j),z=="before"&&(j=Uo(b,j,1))}else j=A<0?L.to:L.from;return new Be(d,j,z)}}return new Be(d,A<0?b.text.length:0,A<0?"before":"after")}function hl(a,l,b,d){var A=It(l,a.doc.direction);if(!A)return jo(l,b,d);b.ch>=l.text.length?(b.ch=l.text.length,b.sticky="before"):b.ch<=0&&(b.ch=0,b.sticky="after");var E=Ye(A,b.ch,b.sticky),L=A[E];if(a.doc.direction=="ltr"&&L.level%2==0&&(d>0?L.to>b.ch:L.from<b.ch))return jo(l,b,d);var V=function(Ke,it){return Uo(l,Ke instanceof Be?Ke.ch:Ke,it)},z,j=function(Ke){return a.options.lineWrapping?(z=z||Gr(a,l),aa(a,l,z,Ke)):{begin:0,end:l.text.length}},fe=j(b.sticky=="before"?V(b,-1):b.ch);if(a.doc.direction=="rtl"||L.level==1){var me=L.level==1==d<0,Se=V(b,me?1:-1);if(Se!=null&&(me?Se<=L.to&&Se<=fe.end:Se>=L.from&&Se>=fe.begin)){var Me=me?"before":"after";return new Be(b.line,Se,Me)}}var Ee=function(Ke,it,qe){for(var ct=function(nn,xn){return xn?new Be(b.line,V(nn,1),"before"):new Be(b.line,nn,"after")};Ke>=0&&Ke<A.length;Ke+=it){var Mt=A[Ke],At=it>0==(Mt.level!=1),Ot=At?qe.begin:V(qe.end,-1);if(Mt.from<=Ot&&Ot<Mt.to||(Ot=At?Mt.from:V(Mt.to,-1),qe.begin<=Ot&&Ot<qe.end))return ct(Ot,At)}},Re=Ee(E+d,d,fe);if(Re)return Re;var ze=d>0?fe.end:V(fe.begin,-1);return ze!=null&&!(d>0&&ze==l.text.length)&&(Re=Ee(d>0?0:A.length-1,d,j(ze)),Re)?Re:null}var is={selectAll:Oa,singleSelection:function(a){return a.setSelection(a.getCursor("anchor"),a.getCursor("head"),pt)},killLine:function(a){return wi(a,function(l){if(l.empty()){var b=ft(a.doc,l.head.line).text.length;return l.head.ch==b&&l.head.line<a.lastLine()?{from:l.head,to:Be(l.head.line+1,0)}:{from:l.head,to:Be(l.head.line,b)}}else return{from:l.from(),to:l.to()}})},deleteLine:function(a){return wi(a,function(l){return{from:Be(l.from().line,0),to:st(a.doc,Be(l.to().line+1,0))}})},delLineLeft:function(a){return wi(a,function(l){return{from:Be(l.from().line,0),to:l.from()}})},delWrappedLineLeft:function(a){return wi(a,function(l){var b=a.charCoords(l.head,"div").top+5,d=a.coordsChar({left:0,top:b},"div");return{from:d,to:l.from()}})},delWrappedLineRight:function(a){return wi(a,function(l){var b=a.charCoords(l.head,"div").top+5,d=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div");return{from:l.from(),to:d}})},undo:function(a){return a.undo()},redo:function(a){return a.redo()},undoSelection:function(a){return a.undoSelection()},redoSelection:function(a){return a.redoSelection()},goDocStart:function(a){return a.extendSelection(Be(a.firstLine(),0))},goDocEnd:function(a){return a.extendSelection(Be(a.lastLine()))},goLineStart:function(a){return a.extendSelectionsBy(function(l){return ru(a,l.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){return a.extendSelectionsBy(function(l){return iu(a,l.head)},{origin:"+move",bias:1})},goLineEnd:function(a){return a.extendSelectionsBy(function(l){return ml(a,l.head.line)},{origin:"+move",bias:-1})},goLineRight:function(a){return a.extendSelectionsBy(function(l){var b=a.cursorCoords(l.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div")},ht)},goLineLeft:function(a){return a.extendSelectionsBy(function(l){var b=a.cursorCoords(l.head,"div").top+5;return a.coordsChar({left:0,top:b},"div")},ht)},goLineLeftSmart:function(a){return a.extendSelectionsBy(function(l){var b=a.cursorCoords(l.head,"div").top+5,d=a.coordsChar({left:0,top:b},"div");return d.ch<a.getLine(d.line).search(/\S/)?iu(a,l.head):d},ht)},goLineUp:function(a){return a.moveV(-1,"line")},goLineDown:function(a){return a.moveV(1,"line")},goPageUp:function(a){return a.moveV(-1,"page")},goPageDown:function(a){return a.moveV(1,"page")},goCharLeft:function(a){return a.moveH(-1,"char")},goCharRight:function(a){return a.moveH(1,"char")},goColumnLeft:function(a){return a.moveH(-1,"column")},goColumnRight:function(a){return a.moveH(1,"column")},goWordLeft:function(a){return a.moveH(-1,"word")},goGroupRight:function(a){return a.moveH(1,"group")},goGroupLeft:function(a){return a.moveH(-1,"group")},goWordRight:function(a){return a.moveH(1,"word")},delCharBefore:function(a){return a.deleteH(-1,"codepoint")},delCharAfter:function(a){return a.deleteH(1,"char")},delWordBefore:function(a){return a.deleteH(-1,"word")},delWordAfter:function(a){return a.deleteH(1,"word")},delGroupBefore:function(a){return a.deleteH(-1,"group")},delGroupAfter:function(a){return a.deleteH(1,"group")},indentAuto:function(a){return a.indentSelection("smart")},indentMore:function(a){return a.indentSelection("add")},indentLess:function(a){return a.indentSelection("subtract")},insertTab:function(a){return a.replaceSelection("	")},insertSoftTab:function(a){for(var l=[],b=a.listSelections(),d=a.options.tabSize,A=0;A<b.length;A++){var E=b[A].from(),L=ke(a.getLine(E.line),E.ch,d);l.push(Bt(d-L%d))}a.replaceSelections(l)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){return zn(a,function(){for(var l=a.listSelections(),b=[],d=0;d<l.length;d++)if(l[d].empty()){var A=l[d].head,E=ft(a.doc,A.line).text;if(E){if(A.ch==E.length&&(A=new Be(A.line,A.ch-1)),A.ch>0)A=new Be(A.line,A.ch+1),a.replaceRange(E.charAt(A.ch-1)+E.charAt(A.ch-2),Be(A.line,A.ch-2),A,"+transpose");else if(A.line>a.doc.first){var L=ft(a.doc,A.line-1).text;L&&(A=new Be(A.line,1),a.replaceRange(E.charAt(0)+a.doc.lineSeparator()+L.charAt(L.length-1),Be(A.line-1,L.length-1),A,"+transpose"))}}b.push(new qt(A,A))}a.setSelections(b)})},newlineAndIndent:function(a){return zn(a,function(){for(var l=a.listSelections(),b=l.length-1;b>=0;b--)a.replaceRange(a.doc.lineSeparator(),l[b].anchor,l[b].head,"+input");l=a.listSelections();for(var d=0;d<l.length;d++)a.indentLine(l[d].from().line,null,!0);vi(a)})},openLine:function(a){return a.replaceSelection(`
`,"start")},toggleOverwrite:function(a){return a.toggleOverwrite()}};function ru(a,l){var b=ft(a.doc,l),d=Yn(b);return d!=b&&(l=jt(d)),Yo(!0,a,d,l,1)}function ml(a,l){var b=ft(a.doc,l),d=ao(b);return d!=b&&(l=jt(d)),Yo(!0,a,b,l,-1)}function iu(a,l){var b=ru(a,l.line),d=ft(a.doc,b.line),A=It(d,a.doc.direction);if(!A||A[0].level==0){var E=Math.max(b.ch,d.text.search(/\S/)),L=l.line==b.line&&l.ch<=E&&l.ch;return Be(b.line,L?0:E,b.sticky)}return b}function qs(a,l,b){if(typeof l=="string"&&(l=is[l],!l))return!1;a.display.input.ensurePolled();var d=a.display.shift,A=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),b&&(a.display.shift=!1),A=l(a)!=nt}finally{a.display.shift=d,a.state.suppressEdits=!1}return A}function gl(a,l,b){for(var d=0;d<a.state.keyMaps.length;d++){var A=Si(l,a.state.keyMaps[d],b,a);if(A)return A}return a.options.extraKeys&&Si(l,a.options.extraKeys,b,a)||Si(l,a.options.keyMap,b,a)}var _l=new at;function ss(a,l,b,d){var A=a.state.keySeq;if(A){if(eu(l))return"handled";if(/\'$/.test(l)?a.state.keySeq=null:_l.set(50,function(){a.state.keySeq==A&&(a.state.keySeq=null,a.display.input.reset())}),su(a,A+" "+l,b,d))return!0}return su(a,l,b,d)}function su(a,l,b,d){var A=gl(a,l,d);return A=="multi"&&(a.state.keySeq=l),A=="handled"&&mn(a,"keyHandled",a,l,b),(A=="handled"||A=="multi")&&(Dt(b),ko(a)),!!A}function ou(a,l){var b=nu(l,!0);return b?l.shiftKey&&!a.state.keySeq?ss(a,"Shift-"+b,l,function(d){return qs(a,d,!0)})||ss(a,b,l,function(d){if(typeof d=="string"?/^go[A-Z]/.test(d):d.motion)return qs(a,d)}):ss(a,b,l,function(d){return qs(a,d)}):!1}function yl(a,l,b){return ss(a,"'"+b+"'",l,function(d){return qs(a,d,!0)})}var Ko=null;function au(a){var l=this;if(!(a.target&&a.target!=l.display.input.getField())&&(l.curOp.focus=Qe(),!Wt(l,a))){g&&M<11&&a.keyCode==27&&(a.returnValue=!1);var b=a.keyCode;l.display.shift=b==16||a.shiftKey;var d=ou(l,a);N&&(Ko=d?b:null,!d&&b==88&&!ut&&(ie?a.metaKey:a.ctrlKey)&&l.replaceSelection("",null,"cut")),o&&!ie&&!d&&b==46&&a.shiftKey&&!a.ctrlKey&&document.execCommand&&document.execCommand("cut"),b==18&&!/\bCodeMirror-crosshair\b/.test(l.display.lineDiv.className)&&vl(l)}}function vl(a){var l=a.display.lineDiv;rt(l,"CodeMirror-crosshair");function b(d){(d.keyCode==18||!d.altKey)&&(Fe(l,"CodeMirror-crosshair"),Ht(document,"keyup",b),Ht(document,"mouseover",b))}Ue(document,"keyup",b),Ue(document,"mouseover",b)}function uu(a){a.keyCode==16&&(this.doc.sel.shift=!1),Wt(this,a)}function lu(a){var l=this;if(!(a.target&&a.target!=l.display.input.getField())&&!(lr(l.display,a)||Wt(l,a)||a.ctrlKey&&!a.altKey||ie&&a.metaKey)){var b=a.keyCode,d=a.charCode;if(N&&b==Ko){Ko=null,Dt(a);return}if(!(N&&(!a.which||a.which<10)&&ou(l,a))){var A=String.fromCharCode(d??b);A!="\b"&&(yl(l,a,A)||l.display.input.onKeyPress(a))}}}var bl=400,qo=function(a,l,b){this.time=a,this.pos=l,this.button=b};qo.prototype.compare=function(a,l,b){return this.time+bl>a&&q(l,this.pos)==0&&b==this.button};var os,us;function Al(a,l){var b=+new Date;return us&&us.compare(b,a,l)?(os=us=null,"triple"):os&&os.compare(b,a,l)?(us=new qo(b,a,l),os=null,"double"):(os=new qo(b,a,l),us=null,"single")}function cu(a){var l=this,b=l.display;if(!(Wt(l,a)||b.activeTouch&&b.input.supportsTouch())){if(b.input.ensurePolled(),b.shift=a.shiftKey,lr(b,a)){F||(b.scroller.draggable=!1,setTimeout(function(){return b.scroller.draggable=!0},100));return}if(!Jo(l,a)){var d=Qr(l,a),A=B(a),E=d?Al(d,A):"single";window.focus(),A==1&&l.state.selectingText&&l.state.selectingText(a),!(d&&Cl(l,A,d,E,a))&&(A==1?d?xl(l,d,E,a):hn(a)==b.scroller&&Dt(a):A==2?(d&&zs(l.doc,d),setTimeout(function(){return b.input.focus()},20)):A==3&&(ve?l.display.input.onContextMenu(a):To(l)))}}}function Cl(a,l,b,d,A){var E="Click";return d=="double"?E="Double"+E:d=="triple"&&(E="Triple"+E),E=(l==1?"Left":l==2?"Middle":"Right")+E,ss(a,tu(E,A),A,function(L){if(typeof L=="string"&&(L=is[L]),!L)return!1;var V=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),V=L(a,b)!=nt}finally{a.state.suppressEdits=!1}return V})}function Ml(a,l,b){var d=a.getOption("configureMouse"),A=d?d(a,l,b):{};if(A.unit==null){var E=de?b.shiftKey&&b.metaKey:b.altKey;A.unit=E?"rectangle":l=="single"?"char":l=="double"?"word":"line"}return(A.extend==null||a.doc.extend)&&(A.extend=a.doc.extend||b.shiftKey),A.addNew==null&&(A.addNew=ie?b.metaKey:b.ctrlKey),A.moveOnDrag==null&&(A.moveOnDrag=!(ie?b.altKey:b.ctrlKey)),A}function xl(a,l,b,d){g?setTimeout(Lt(fa,a),0):a.curOp.focus=Qe();var A=Ml(a,b,d),E=a.doc.sel,L;a.options.dragDrop&&se&&!a.isReadOnly()&&b=="single"&&(L=E.contains(l))>-1&&(q((L=E.ranges[L]).from(),l)<0||l.xRel>0)&&(q(L.to(),l)>0||l.xRel<0)?Pl(a,d,l,A):Sl(a,d,l,A)}function Pl(a,l,b,d){var A=a.display,E=!1,L=Cn(a,function(j){F&&(A.scroller.draggable=!1),a.state.draggingText=!1,a.state.delayingBlurEvent&&(a.hasFocus()?a.state.delayingBlurEvent=!1:To(a)),Ht(A.wrapper.ownerDocument,"mouseup",L),Ht(A.wrapper.ownerDocument,"mousemove",V),Ht(A.scroller,"dragstart",z),Ht(A.scroller,"drop",L),E||(Dt(j),d.addNew||zs(a.doc,b,null,null,d.extend),F&&!$||g&&M==9?setTimeout(function(){A.wrapper.ownerDocument.body.focus({preventScroll:!0}),A.input.focus()},20):A.input.focus())}),V=function(j){E=E||Math.abs(l.clientX-j.clientX)+Math.abs(l.clientY-j.clientY)>=10},z=function(){return E=!0};F&&(A.scroller.draggable=!0),a.state.draggingText=L,L.copy=!d.moveOnDrag,Ue(A.wrapper.ownerDocument,"mouseup",L),Ue(A.wrapper.ownerDocument,"mousemove",V),Ue(A.scroller,"dragstart",z),Ue(A.scroller,"drop",L),a.state.delayingBlurEvent=!0,setTimeout(function(){return A.input.focus()},20),A.scroller.dragDrop&&A.scroller.dragDrop()}function fu(a,l,b){if(b=="char")return new qt(l,l);if(b=="word")return a.findWordAt(l);if(b=="line")return new qt(Be(l.line,0),st(a.doc,Be(l.line+1,0)));var d=b(a,l);return new qt(d.from,d.to)}function Sl(a,l,b,d){g&&To(a);var A=a.display,E=a.doc;Dt(l);var L,V,z=E.sel,j=z.ranges;if(d.addNew&&!d.extend?(V=E.sel.contains(b),V>-1?L=j[V]:L=new qt(b,b)):(L=E.sel.primary(),V=E.sel.primIndex),d.unit=="rectangle")d.addNew||(L=new qt(b,b)),b=Qr(a,l,!0,!0),V=-1;else{var fe=fu(a,b,d.unit);d.extend?L=zo(L,fe.anchor,fe.head,d.extend):L=fe}d.addNew?V==-1?(V=j.length,Dn(E,fr(a,j.concat([L]),V),{scroll:!1,origin:"*mouse"})):j.length>1&&j[V].empty()&&d.unit=="char"&&!d.extend?(Dn(E,fr(a,j.slice(0,V).concat(j.slice(V+1)),0),{scroll:!1,origin:"*mouse"}),z=E.sel):Ho(E,V,L,Ft):(V=0,Dn(E,new qn([L],0),Ft),z=E.sel);var me=b;function Se(qe){if(q(me,qe)!=0)if(me=qe,d.unit=="rectangle"){for(var ct=[],Mt=a.options.tabSize,At=ke(ft(E,b.line).text,b.ch,Mt),Ot=ke(ft(E,qe.line).text,qe.ch,Mt),nn=Math.min(At,Ot),xn=Math.max(At,Ot),un=Math.min(b.line,qe.line),Hn=Math.min(a.lastLine(),Math.max(b.line,qe.line));un<=Hn;un++){var On=ft(E,un).text,gn=Zt(On,nn,Mt);nn==xn?ct.push(new qt(Be(un,gn),Be(un,gn))):On.length>gn&&ct.push(new qt(Be(un,gn),Be(un,Zt(On,xn,Mt))))}ct.length||ct.push(new qt(b,b)),Dn(E,fr(a,z.ranges.slice(0,V).concat(ct),V),{origin:"*mouse",scroll:!1}),a.scrollIntoView(qe)}else{var Wn=L,Sn=fu(a,qe,d.unit),vn=Wn.anchor,_n;q(Sn.anchor,vn)>0?(_n=Sn.head,vn=St(Wn.from(),Sn.anchor)):(_n=Sn.anchor,vn=Xe(Wn.to(),Sn.head));var cn=z.ranges.slice(0);cn[V]=wl(a,new qt(st(E,vn),_n)),Dn(E,fr(a,cn,V),Ft)}}var Me=A.wrapper.getBoundingClientRect(),Ee=0;function Re(qe){var ct=++Ee,Mt=Qr(a,qe,!0,d.unit=="rectangle");if(Mt)if(q(Mt,me)!=0){a.curOp.focus=Qe(),Se(Mt);var At=Is(A,E);(Mt.line>=At.to||Mt.line<At.from)&&setTimeout(Cn(a,function(){Ee==ct&&Re(qe)}),150)}else{var Ot=qe.clientY<Me.top?-20:qe.clientY>Me.bottom?20:0;Ot&&setTimeout(Cn(a,function(){Ee==ct&&(A.scroller.scrollTop+=Ot,Re(qe))}),50)}}function ze(qe){a.state.selectingText=!1,Ee=1/0,qe&&(Dt(qe),A.input.focus()),Ht(A.wrapper.ownerDocument,"mousemove",Ke),Ht(A.wrapper.ownerDocument,"mouseup",it),E.history.lastSelOrigin=null}var Ke=Cn(a,function(qe){qe.buttons===0||!B(qe)?ze(qe):Re(qe)}),it=Cn(a,ze);a.state.selectingText=it,Ue(A.wrapper.ownerDocument,"mousemove",Ke),Ue(A.wrapper.ownerDocument,"mouseup",it)}function wl(a,l){var b=l.anchor,d=l.head,A=ft(a.doc,b.line);if(q(b,d)==0&&b.sticky==d.sticky)return l;var E=It(A);if(!E)return l;var L=Ye(E,b.ch,b.sticky),V=E[L];if(V.from!=b.ch&&V.to!=b.ch)return l;var z=L+(V.from==b.ch==(V.level!=1)?0:1);if(z==0||z==E.length)return l;var j;if(d.line!=b.line)j=(d.line-b.line)*(a.doc.direction=="ltr"?1:-1)>0;else{var fe=Ye(E,d.ch,d.sticky),me=fe-L||(d.ch-b.ch)*(V.level==1?-1:1);fe==z-1||fe==z?j=me<0:j=me>0}var Se=E[z+(j?-1:0)],Me=j==(Se.level==1),Ee=Me?Se.from:Se.to,Re=Me?"after":"before";return b.ch==Ee&&b.sticky==Re?l:new qt(new Be(b.line,Ee,Re),d)}function pu(a,l,b,d){var A,E;if(l.touches)A=l.touches[0].clientX,E=l.touches[0].clientY;else try{A=l.clientX,E=l.clientY}catch{return!1}if(A>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;d&&Dt(l);var L=a.display,V=L.lineDiv.getBoundingClientRect();if(E>V.bottom||!ot(a,b))return Kt(l);E-=V.top-L.viewOffset;for(var z=0;z<a.display.gutterSpecs.length;++z){var j=L.gutters.childNodes[z];if(j&&j.getBoundingClientRect().right>=A){var fe=Qn(a.doc,E),me=a.display.gutterSpecs[z];return Oe(a,b,a,fe,me.className,l),Kt(l)}}}function Jo(a,l){return pu(a,l,"gutterClick",!0)}function du(a,l){lr(a.display,l)||Dl(a,l)||Wt(a,l,"contextmenu")||ve||a.display.input.onContextMenu(l)}function Dl(a,l){return ot(a,"gutterContextMenu")?pu(a,l,"gutterContextMenu",!1):!1}function hu(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-"),en(a)}var Di={toString:function(){return"CodeMirror.Init"}},mu={},Js={};function Fl(a){var l=a.optionHandlers;function b(d,A,E,L){a.defaults[d]=A,E&&(l[d]=L?function(V,z,j){j!=Di&&E(V,z,j)}:E)}a.defineOption=b,a.Init=Di,b("value","",function(d,A){return d.setValue(A)},!0),b("mode",null,function(d,A){d.doc.modeOption=A,Xo(d)},!0),b("indentUnit",2,Xo,!0),b("indentWithTabs",!1),b("smartIndent",!0),b("tabSize",4,function(d){Yi(d),en(d),$n(d)},!0),b("lineSeparator",null,function(d,A){if(d.doc.lineSep=A,!!A){var E=[],L=d.doc.first;d.doc.iter(function(z){for(var j=0;;){var fe=z.text.indexOf(A,j);if(fe==-1)break;j=fe+A.length,E.push(Be(L,fe))}L++});for(var V=E.length-1;V>=0;V--)xi(d.doc,A,E[V],Be(E[V].line,E[V].ch+A.length))}}),b("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(d,A,E){d.state.specialChars=new RegExp(A.source+(A.test("	")?"":"|	"),"g"),E!=Di&&d.refresh()}),b("specialCharPlaceholder",Er,function(d){return d.refresh()},!0),b("electricChars",!0),b("inputStyle",K?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),b("spellcheck",!1,function(d,A){return d.getInputField().spellcheck=A},!0),b("autocorrect",!1,function(d,A){return d.getInputField().autocorrect=A},!0),b("autocapitalize",!1,function(d,A){return d.getInputField().autocapitalize=A},!0),b("rtlMoveVisually",!te),b("wholeLineUpdateBefore",!0),b("theme","default",function(d){hu(d),ji(d)},!0),b("keyMap","default",function(d,A,E){var L=Ks(A),V=E!=Di&&Ks(E);V&&V.detach&&V.detach(d,L),L.attach&&L.attach(d,V||null)}),b("extraKeys",null),b("configureMouse",null),b("lineWrapping",!1,kl,!0),b("gutters",[],function(d,A){d.display.gutterSpecs=Oo(A,d.options.lineNumbers),ji(d)},!0),b("fixedGutter",!0,function(d,A){d.display.gutters.style.left=A?Do(d.display)+"px":"0",d.refresh()},!0),b("coverGutterNextToScrollbar",!1,function(d){return bi(d)},!0),b("scrollbarStyle","native",function(d){_a(d),bi(d),d.display.scrollbars.setScrollTop(d.doc.scrollTop),d.display.scrollbars.setScrollLeft(d.doc.scrollLeft)},!0),b("lineNumbers",!1,function(d,A){d.display.gutterSpecs=Oo(d.options.gutters,A),ji(d)},!0),b("firstLineNumber",1,ji,!0),b("lineNumberFormatter",function(d){return d},ji,!0),b("showCursorWhenSelecting",!1,Xi,!0),b("resetSelectionOnContextMenu",!0),b("lineWiseCopyCut",!0),b("pasteLinesPerSelection",!0),b("selectionsMayTouch",!1),b("readOnly",!1,function(d,A){A=="nocursor"&&(yi(d),d.display.input.blur()),d.display.input.readOnlyChanged(A)}),b("screenReaderLabel",null,function(d,A){A=A===""?null:A,d.display.input.screenReaderLabelChanged(A)}),b("disableInput",!1,function(d,A){A||d.display.input.reset()},!0),b("dragDrop",!0,El),b("allowDropFileTypes",null),b("cursorBlinkRate",530),b("cursorScrollMargin",0),b("cursorHeight",1,Xi,!0),b("singleCursorHeightPerLine",!0,Xi,!0),b("workTime",100),b("workDelay",100),b("flattenSpans",!0,Yi,!0),b("addModeClass",!1,Yi,!0),b("pollInterval",100),b("undoDepth",200,function(d,A){return d.doc.history.undoDepth=A}),b("historyEventDelay",1250),b("viewportMargin",10,function(d){return d.refresh()},!0),b("maxHighlightLength",1e4,Yi,!0),b("moveInputWithCursor",!0,function(d,A){A||d.display.input.resetPosition()}),b("tabindex",null,function(d,A){return d.display.input.getField().tabIndex=A||""}),b("autofocus",null),b("direction","ltr",function(d,A){return d.doc.setDirection(A)},!0),b("phrases",null)}function El(a,l,b){var d=b&&b!=Di;if(!l!=!d){var A=a.display.dragFunctions,E=l?Ue:Ht;E(a.display.scroller,"dragstart",A.start),E(a.display.scroller,"dragenter",A.enter),E(a.display.scroller,"dragover",A.over),E(a.display.scroller,"dragleave",A.leave),E(a.display.scroller,"drop",A.drop)}}function kl(a){a.options.lineWrapping?(rt(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(Fe(a.display.wrapper,"CodeMirror-wrap"),ci(a)),Fo(a),$n(a),en(a),setTimeout(function(){return bi(a)},100)}function an(a,l){var b=this;if(!(this instanceof an))return new an(a,l);this.options=l=l?Tt(l):{},Tt(mu,l,!1);var d=l.value;typeof d=="string"?d=new In(d,l.mode,null,l.lineSeparator,l.direction):l.mode&&(d.modeOption=l.mode),this.doc=d;var A=new an.inputStyles[l.inputStyle](this),E=this.display=new Zu(a,d,A,l);E.wrapper.CodeMirror=this,hu(this),l.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),_a(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new at,keySeq:null,specialChars:null},l.autofocus&&!K&&E.input.focus(),g&&M<11&&setTimeout(function(){return b.display.input.reset(!0)},20),Tl(this),ll(),ri(this),this.curOp.forceUpdate=!0,wa(this,d),l.autofocus&&!K||this.hasFocus()?setTimeout(function(){b.hasFocus()&&!b.state.focused&&No(b)},20):yi(this);for(var L in Js)Js.hasOwnProperty(L)&&Js[L](this,l[L],Di);ba(this),l.finishInit&&l.finishInit(this);for(var V=0;V<Qo.length;++V)Qo[V](this);ii(this),F&&l.lineWrapping&&getComputedStyle(E.lineDiv).textRendering=="optimizelegibility"&&(E.lineDiv.style.textRendering="auto")}an.defaults=mu,an.optionHandlers=Js;function Tl(a){var l=a.display;Ue(l.scroller,"mousedown",Cn(a,cu)),g&&M<11?Ue(l.scroller,"dblclick",Cn(a,function(z){if(!Wt(a,z)){var j=Qr(a,z);if(!(!j||Jo(a,z)||lr(a.display,z))){Dt(z);var fe=a.findWordAt(j);zs(a.doc,fe.anchor,fe.head)}}})):Ue(l.scroller,"dblclick",function(z){return Wt(a,z)||Dt(z)}),Ue(l.scroller,"contextmenu",function(z){return du(a,z)}),Ue(l.input.getField(),"contextmenu",function(z){l.scroller.contains(z.target)||du(a,z)});var b,d={end:0};function A(){l.activeTouch&&(b=setTimeout(function(){return l.activeTouch=null},1e3),d=l.activeTouch,d.end=+new Date)}function E(z){if(z.touches.length!=1)return!1;var j=z.touches[0];return j.radiusX<=1&&j.radiusY<=1}function L(z,j){if(j.left==null)return!0;var fe=j.left-z.left,me=j.top-z.top;return fe*fe+me*me>400}Ue(l.scroller,"touchstart",function(z){if(!Wt(a,z)&&!E(z)&&!Jo(a,z)){l.input.ensurePolled(),clearTimeout(b);var j=+new Date;l.activeTouch={start:j,moved:!1,prev:j-d.end<=300?d:null},z.touches.length==1&&(l.activeTouch.left=z.touches[0].pageX,l.activeTouch.top=z.touches[0].pageY)}}),Ue(l.scroller,"touchmove",function(){l.activeTouch&&(l.activeTouch.moved=!0)}),Ue(l.scroller,"touchend",function(z){var j=l.activeTouch;if(j&&!lr(l,z)&&j.left!=null&&!j.moved&&new Date-j.start<300){var fe=a.coordsChar(l.activeTouch,"page"),me;!j.prev||L(j,j.prev)?me=new qt(fe,fe):!j.prev.prev||L(j,j.prev.prev)?me=a.findWordAt(fe):me=new qt(Be(fe.line,0),st(a.doc,Be(fe.line+1,0))),a.setSelection(me.anchor,me.head),a.focus(),Dt(z)}A()}),Ue(l.scroller,"touchcancel",A),Ue(l.scroller,"scroll",function(){l.scroller.clientHeight&&(Zi(a,l.scroller.scrollTop),ti(a,l.scroller.scrollLeft,!0),Oe(a,"scroll",a))}),Ue(l.scroller,"mousewheel",function(z){return Ma(a,z)}),Ue(l.scroller,"DOMMouseScroll",function(z){return Ma(a,z)}),Ue(l.wrapper,"scroll",function(){return l.wrapper.scrollTop=l.wrapper.scrollLeft=0}),l.dragFunctions={enter:function(z){Wt(a,z)||ln(z)},over:function(z){Wt(a,z)||(ul(a,z),ln(z))},start:function(z){return al(a,z)},drop:Cn(a,ol),leave:function(z){Wt(a,z)||qa(a)}};var V=l.input.getField();Ue(V,"keyup",function(z){return uu.call(a,z)}),Ue(V,"keydown",Cn(a,au)),Ue(V,"keypress",Cn(a,lu)),Ue(V,"focus",function(z){return No(a,z)}),Ue(V,"blur",function(z){return yi(a,z)})}var Qo=[];an.defineInitHook=function(a){return Qo.push(a)};function ls(a,l,b,d){var A=a.doc,E;b==null&&(b="add"),b=="smart"&&(A.mode.indent?E=jr(a,l).state:b="prev");var L=a.options.tabSize,V=ft(A,l),z=ke(V.text,null,L);V.stateAfter&&(V.stateAfter=null);var j=V.text.match(/^\s*/)[0],fe;if(!d&&!/\S/.test(V.text))fe=0,b="not";else if(b=="smart"&&(fe=A.mode.indent(E,V.text.slice(j.length),V.text),fe==nt||fe>150)){if(!d)return;b="prev"}b=="prev"?l>A.first?fe=ke(ft(A,l-1).text,null,L):fe=0:b=="add"?fe=z+a.options.indentUnit:b=="subtract"?fe=z-a.options.indentUnit:typeof b=="number"&&(fe=z+b),fe=Math.max(0,fe);var me="",Se=0;if(a.options.indentWithTabs)for(var Me=Math.floor(fe/L);Me;--Me)Se+=L,me+="	";if(Se<fe&&(me+=Bt(fe-Se)),me!=j)return xi(A,me,Be(l,0),Be(l,j.length),"+input"),V.stateAfter=null,!0;for(var Ee=0;Ee<A.sel.ranges.length;Ee++){var Re=A.sel.ranges[Ee];if(Re.head.line==l&&Re.head.ch<j.length){var ze=Be(l,j.length);Ho(A,Ee,new qt(ze,ze));break}}}var dr=null;function Qs(a){dr=a}function ea(a,l,b,d,A){var E=a.doc;a.display.shift=!1,d||(d=E.sel);var L=+new Date-200,V=A=="paste"||a.state.pasteIncoming>L,z=Ge(l),j=null;if(V&&d.ranges.length>1)if(dr&&dr.text.join(`
`)==l){if(d.ranges.length%dr.text.length==0){j=[];for(var fe=0;fe<dr.text.length;fe++)j.push(E.splitLines(dr.text[fe]))}}else z.length==d.ranges.length&&a.options.pasteLinesPerSelection&&(j=$t(z,function(Ke){return[Ke]}));for(var me=a.curOp.updateInput,Se=d.ranges.length-1;Se>=0;Se--){var Me=d.ranges[Se],Ee=Me.from(),Re=Me.to();Me.empty()&&(b&&b>0?Ee=Be(Ee.line,Ee.ch-b):a.state.overwrite&&!V?Re=Be(Re.line,Math.min(ft(E,Re.line).text.length,Re.ch+_t(z).length)):V&&dr&&dr.lineWise&&dr.text.join(`
`)==z.join(`
`)&&(Ee=Re=Be(Ee.line,0)));var ze={from:Ee,to:Re,text:j?j[Se%j.length]:z,origin:A||(V?"paste":a.state.cutIncoming>L?"cut":"+input")};Mi(a.doc,ze),mn(a,"inputRead",a,ze)}l&&!V&&_u(a,l),vi(a),a.curOp.updateInput<2&&(a.curOp.updateInput=me),a.curOp.typing=!0,a.state.pasteIncoming=a.state.cutIncoming=-1}function gu(a,l){var b=a.clipboardData&&a.clipboardData.getData("Text");if(b)return a.preventDefault(),!l.isReadOnly()&&!l.options.disableInput&&l.hasFocus()&&zn(l,function(){return ea(l,b,0,null,"paste")}),!0}function _u(a,l){if(!(!a.options.electricChars||!a.options.smartIndent))for(var b=a.doc.sel,d=b.ranges.length-1;d>=0;d--){var A=b.ranges[d];if(!(A.head.ch>100||d&&b.ranges[d-1].head.line==A.head.line)){var E=a.getModeAt(A.head),L=!1;if(E.electricChars){for(var V=0;V<E.electricChars.length;V++)if(l.indexOf(E.electricChars.charAt(V))>-1){L=ls(a,A.head.line,"smart");break}}else E.electricInput&&E.electricInput.test(ft(a.doc,A.head.line).text.slice(0,A.head.ch))&&(L=ls(a,A.head.line,"smart"));L&&mn(a,"electricInput",a,A.head.line)}}}function yu(a){for(var l=[],b=[],d=0;d<a.doc.sel.ranges.length;d++){var A=a.doc.sel.ranges[d].head.line,E={anchor:Be(A,0),head:Be(A+1,0)};b.push(E),l.push(a.getRange(E.anchor,E.head))}return{text:l,ranges:b}}function vu(a,l,b,d){a.setAttribute("autocorrect",b?"":"off"),a.setAttribute("autocapitalize",d?"":"off"),a.setAttribute("spellcheck",!!l)}function bu(){var a=be("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),l=be("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return F?a.style.width="1000px":a.setAttribute("wrap","off"),O&&(a.style.border="1px solid black"),vu(a),l}function Nl(a){var l=a.optionHandlers,b=a.helpers={};a.prototype={constructor:a,focus:function(){window.focus(),this.display.input.focus()},setOption:function(d,A){var E=this.options,L=E[d];E[d]==A&&d!="mode"||(E[d]=A,l.hasOwnProperty(d)&&Cn(this,l[d])(this,A,L),Oe(this,"optionChange",this,d))},getOption:function(d){return this.options[d]},getDoc:function(){return this.doc},addKeyMap:function(d,A){this.state.keyMaps[A?"push":"unshift"](Ks(d))},removeKeyMap:function(d){for(var A=this.state.keyMaps,E=0;E<A.length;++E)if(A[E]==d||A[E].name==d)return A.splice(E,1),!0},addOverlay:Nn(function(d,A){var E=d.token?d:a.getMode(this.options,d);if(E.startState)throw new Error("Overlays may not be stateful.");rn(this.state.overlays,{mode:E,modeSpec:d,opaque:A&&A.opaque,priority:A&&A.priority||0},function(L){return L.priority}),this.state.modeGen++,$n(this)}),removeOverlay:Nn(function(d){for(var A=this.state.overlays,E=0;E<A.length;++E){var L=A[E].modeSpec;if(L==d||typeof d=="string"&&L.name==d){A.splice(E,1),this.state.modeGen++,$n(this);return}}}),indentLine:Nn(function(d,A,E){typeof A!="string"&&typeof A!="number"&&(A==null?A=this.options.smartIndent?"smart":"prev":A=A?"add":"subtract"),vr(this.doc,d)&&ls(this,d,A,E)}),indentSelection:Nn(function(d){for(var A=this.doc.sel.ranges,E=-1,L=0;L<A.length;L++){var V=A[L];if(V.empty())V.head.line>E&&(ls(this,V.head.line,d,!0),E=V.head.line,L==this.doc.sel.primIndex&&vi(this));else{var z=V.from(),j=V.to(),fe=Math.max(E,z.line);E=Math.min(this.lastLine(),j.line-(j.ch?0:1))+1;for(var me=fe;me<E;++me)ls(this,me,d);var Se=this.doc.sel.ranges;z.ch==0&&A.length==Se.length&&Se[L].from().ch>0&&Ho(this.doc,L,new qt(z,Se[L].to()),pt)}}}),getTokenAt:function(d,A){return hs(this,d,A)},getLineTokens:function(d,A){return hs(this,Be(d),A,!0)},getTokenTypeAt:function(d){d=st(this.doc,d);var A=fs(this,ft(this.doc,d.line)),E=0,L=(A.length-1)/2,V=d.ch,z;if(V==0)z=A[2];else for(;;){var j=E+L>>1;if((j?A[j*2-1]:0)>=V)L=j;else if(A[j*2+1]<V)E=j+1;else{z=A[j*2+2];break}}var fe=z?z.indexOf("overlay "):-1;return fe<0?z:fe==0?null:z.slice(0,fe-1)},getModeAt:function(d){var A=this.doc.mode;return A.innerMode?a.innerMode(A,this.getTokenAt(d).state).mode:A},getHelper:function(d,A){return this.getHelpers(d,A)[0]},getHelpers:function(d,A){var E=[];if(!b.hasOwnProperty(A))return E;var L=b[A],V=this.getModeAt(d);if(typeof V[A]=="string")L[V[A]]&&E.push(L[V[A]]);else if(V[A])for(var z=0;z<V[A].length;z++){var j=L[V[A][z]];j&&E.push(j)}else V.helperType&&L[V.helperType]?E.push(L[V.helperType]):L[V.name]&&E.push(L[V.name]);for(var fe=0;fe<L._global.length;fe++){var me=L._global[fe];me.pred(V,this)&&je(E,me.val)==-1&&E.push(me.val)}return E},getStateAfter:function(d,A){var E=this.doc;return d=Vt(E,d??E.first+E.size-1),jr(this,d+1,A).state},cursorCoords:function(d,A){var E,L=this.doc.sel.primary();return d==null?E=L.head:typeof d=="object"?E=st(this.doc,d):E=d?L.from():L.to(),cr(this,E,A||"page")},charCoords:function(d,A){return Gs(this,st(this.doc,d),A||"page")},coordsChar:function(d,A){return d=ia(this,d,A||"page"),Po(this,d.left,d.top)},lineAtHeight:function(d,A){return d=ia(this,{top:d,left:0},A||"page").top,Qn(this.doc,d+this.display.viewOffset)},heightAtLine:function(d,A,E){var L=!1,V;if(typeof d=="number"){var z=this.doc.first+this.doc.size-1;d<this.doc.first?d=this.doc.first:d>z&&(d=z,L=!0),V=ft(this.doc,d)}else V=d;return Ls(this,V,{top:0,left:0},A||"page",E||L).top+(L?this.doc.height-Tn(V):0)},defaultTextHeight:function(){return gi(this.display)},defaultCharWidth:function(){return _i(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(d,A,E,L,V){var z=this.display;d=cr(this,st(this.doc,d));var j=d.bottom,fe=d.left;if(A.style.position="absolute",A.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(A),z.sizer.appendChild(A),L=="over")j=d.top;else if(L=="above"||L=="near"){var me=Math.max(z.wrapper.clientHeight,this.doc.height),Se=Math.max(z.sizer.clientWidth,z.lineSpace.clientWidth);(L=="above"||d.bottom+A.offsetHeight>me)&&d.top>A.offsetHeight?j=d.top-A.offsetHeight:d.bottom+A.offsetHeight<=me&&(j=d.bottom),fe+A.offsetWidth>Se&&(fe=Se-A.offsetWidth)}A.style.top=j+"px",A.style.left=A.style.right="",V=="right"?(fe=z.sizer.clientWidth-A.offsetWidth,A.style.right="0px"):(V=="left"?fe=0:V=="middle"&&(fe=(z.sizer.clientWidth-A.offsetWidth)/2),A.style.left=fe+"px"),E&&Eu(this,{left:fe,top:j,right:fe+A.offsetWidth,bottom:j+A.offsetHeight})},triggerOnKeyDown:Nn(au),triggerOnKeyPress:Nn(lu),triggerOnKeyUp:uu,triggerOnMouseDown:Nn(cu),execCommand:function(d){if(is.hasOwnProperty(d))return is[d].call(null,this)},triggerElectric:Nn(function(d){_u(this,d)}),findPosH:function(d,A,E,L){var V=1;A<0&&(V=-1,A=-A);for(var z=st(this.doc,d),j=0;j<A&&(z=ta(this.doc,z,V,E,L),!z.hitSide);++j);return z},moveH:Nn(function(d,A){var E=this;this.extendSelectionsBy(function(L){return E.display.shift||E.doc.extend||L.empty()?ta(E.doc,L.head,d,A,E.options.rtlMoveVisually):d<0?L.from():L.to()},ht)}),deleteH:Nn(function(d,A){var E=this.doc.sel,L=this.doc;E.somethingSelected()?L.replaceSelection("",null,"+delete"):wi(this,function(V){var z=ta(L,V.head,d,A,!1);return d<0?{from:z,to:V.head}:{from:V.head,to:z}})}),findPosV:function(d,A,E,L){var V=1,z=L;A<0&&(V=-1,A=-A);for(var j=st(this.doc,d),fe=0;fe<A;++fe){var me=cr(this,j,"div");if(z==null?z=me.left:me.left=z,j=Au(this,me,V,E),j.hitSide)break}return j},moveV:Nn(function(d,A){var E=this,L=this.doc,V=[],z=!this.display.shift&&!L.extend&&L.sel.somethingSelected();if(L.extendSelectionsBy(function(fe){if(z)return d<0?fe.from():fe.to();var me=cr(E,fe.head,"div");fe.goalColumn!=null&&(me.left=fe.goalColumn),V.push(me.left);var Se=Au(E,me,d,A);return A=="page"&&fe==L.sel.primary()&&Go(E,Gs(E,Se,"div").top-me.top),Se},ht),V.length)for(var j=0;j<L.sel.ranges.length;j++)L.sel.ranges[j].goalColumn=V[j]}),findWordAt:function(d){var A=this.doc,E=ft(A,d.line).text,L=d.ch,V=d.ch;if(E){var z=this.getHelper(d,"wordChars");(d.sticky=="before"||V==E.length)&&L?--L:++V;for(var j=E.charAt(L),fe=Pe(j,z)?function(me){return Pe(me,z)}:/\s/.test(j)?function(me){return/\s/.test(me)}:function(me){return!/\s/.test(me)&&!Pe(me)};L>0&&fe(E.charAt(L-1));)--L;for(;V<E.length&&fe(E.charAt(V));)++V}return new qt(Be(d.line,L),Be(d.line,V))},toggleOverwrite:function(d){d!=null&&d==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?rt(this.display.cursorDiv,"CodeMirror-overwrite"):Fe(this.display.cursorDiv,"CodeMirror-overwrite"),Oe(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Qe()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:Nn(function(d,A){Vi(this,d,A)}),getScrollInfo:function(){var d=this.display.scroller;return{left:d.scrollLeft,top:d.scrollTop,height:d.scrollHeight-sr(this)-this.display.barHeight,width:d.scrollWidth-sr(this)-this.display.barWidth,clientHeight:Wi(this),clientWidth:Ar(this)}},scrollIntoView:Nn(function(d,A){d==null?(d={from:this.doc.sel.primary().head,to:null},A==null&&(A=this.options.cursorScrollMargin)):typeof d=="number"?d={from:Be(d,0),to:null}:d.from==null&&(d={from:d,to:null}),d.to||(d.to=d.from),d.margin=A||0,d.from.line!=null?ku(this,d):da(this,d.from,d.to,d.margin)}),setSize:Nn(function(d,A){var E=this,L=function(z){return typeof z=="number"||/^\d+$/.test(String(z))?z+"px":z};d!=null&&(this.display.wrapper.style.width=L(d)),A!=null&&(this.display.wrapper.style.height=L(A)),this.options.lineWrapping&&bt(this);var V=this.display.viewFrom;this.doc.iter(V,this.display.viewTo,function(z){if(z.widgets){for(var j=0;j<z.widgets.length;j++)if(z.widgets[j].noHScroll){Rr(E,V,"widget");break}}++V}),this.curOp.forceUpdate=!0,Oe(this,"refresh",this)}),operation:function(d){return zn(this,d)},startOperation:function(){return ri(this)},endOperation:function(){return ii(this)},refresh:Nn(function(){var d=this.display.cachedTextHeight;$n(this),this.curOp.forceUpdate=!0,en(this),Vi(this,this.doc.scrollLeft,this.doc.scrollTop),$o(this.display),(d==null||Math.abs(d-gi(this.display))>.5||this.options.lineWrapping)&&Fo(this),Oe(this,"refresh",this)}),swapDoc:Nn(function(d){var A=this.doc;return A.cm=null,this.state.selectingText&&this.state.selectingText(),wa(this,d),en(this),this.display.input.reset(),Vi(this,d.scrollLeft,d.scrollTop),this.curOp.forceScroll=!0,mn(this,"swapDoc",this,A),A}),phrase:function(d){var A=this.options.phrases;return A&&Object.prototype.hasOwnProperty.call(A,d)?A[d]:d},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Pt(a),a.registerHelper=function(d,A,E){b.hasOwnProperty(d)||(b[d]=a[d]={_global:[]}),b[d][A]=E},a.registerGlobalHelper=function(d,A,E,L){a.registerHelper(d,A,L),b[d]._global.push({pred:E,val:L})}}function ta(a,l,b,d,A){var E=l,L=b,V=ft(a,l.line),z=A&&a.direction=="rtl"?-b:b;function j(){var it=l.line+z;return it<a.first||it>=a.first+a.size?!1:(l=new Be(it,l.ch,l.sticky),V=ft(a,it))}function fe(it){var qe;if(d=="codepoint"){var ct=V.text.charCodeAt(l.ch+(b>0?0:-1));if(isNaN(ct))qe=null;else{var Mt=b>0?ct>=55296&&ct<56320:ct>=56320&&ct<57343;qe=new Be(l.line,Math.max(0,Math.min(V.text.length,l.ch+b*(Mt?2:1))),-b)}}else A?qe=hl(a.cm,V,l,b):qe=jo(V,l,b);if(qe==null)if(!it&&j())l=Yo(A,a.cm,V,l.line,z);else return!1;else l=qe;return!0}if(d=="char"||d=="codepoint")fe();else if(d=="column")fe(!0);else if(d=="word"||d=="group")for(var me=null,Se=d=="group",Me=a.cm&&a.cm.getHelper(l,"wordChars"),Ee=!0;!(b<0&&!fe(!Ee));Ee=!1){var Re=V.text.charAt(l.ch)||`
`,ze=Pe(Re,Me)?"w":Se&&Re==`
`?"n":!Se||/\s/.test(Re)?null:"p";if(Se&&!Ee&&!ze&&(ze="s"),me&&me!=ze){b<0&&(b=1,fe(),l.sticky="after");break}if(ze&&(me=ze),b>0&&!fe(!Ee))break}var Ke=Us(a,l,E,L,!0);return ge(E,Ke)&&(Ke.hitSide=!0),Ke}function Au(a,l,b,d){var A=a.doc,E=l.left,L;if(d=="page"){var V=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),z=Math.max(V-.5*gi(a.display),3);L=(b>0?l.bottom:l.top)+b*z}else d=="line"&&(L=b>0?l.bottom+3:l.top-3);for(var j;j=Po(a,E,L),!!j.outside;){if(b<0?L<=0:L>=A.height){j.hitSide=!0;break}L+=b*5}return j}var tn=function(a){this.cm=a,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new at,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};tn.prototype.init=function(a){var l=this,b=this,d=b.cm,A=b.div=a.lineDiv;A.contentEditable=!0,vu(A,d.options.spellcheck,d.options.autocorrect,d.options.autocapitalize);function E(V){for(var z=V.target;z;z=z.parentNode){if(z==A)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(z.className))break}return!1}Ue(A,"paste",function(V){!E(V)||Wt(d,V)||gu(V,d)||M<=11&&setTimeout(Cn(d,function(){return l.updateFromDOM()}),20)}),Ue(A,"compositionstart",function(V){l.composing={data:V.data,done:!1}}),Ue(A,"compositionupdate",function(V){l.composing||(l.composing={data:V.data,done:!1})}),Ue(A,"compositionend",function(V){l.composing&&(V.data!=l.composing.data&&l.readFromDOMSoon(),l.composing.done=!0)}),Ue(A,"touchstart",function(){return b.forceCompositionEnd()}),Ue(A,"input",function(){l.composing||l.readFromDOMSoon()});function L(V){if(!(!E(V)||Wt(d,V))){if(d.somethingSelected())Qs({lineWise:!1,text:d.getSelections()}),V.type=="cut"&&d.replaceSelection("",null,"cut");else if(d.options.lineWiseCopyCut){var z=yu(d);Qs({lineWise:!0,text:z.text}),V.type=="cut"&&d.operation(function(){d.setSelections(z.ranges,0,pt),d.replaceSelection("",null,"cut")})}else return;if(V.clipboardData){V.clipboardData.clearData();var j=dr.text.join(`
`);if(V.clipboardData.setData("Text",j),V.clipboardData.getData("Text")==j){V.preventDefault();return}}var fe=bu(),me=fe.firstChild;d.display.lineSpace.insertBefore(fe,d.display.lineSpace.firstChild),me.value=dr.text.join(`
`);var Se=Qe();kt(me),setTimeout(function(){d.display.lineSpace.removeChild(fe),Se.focus(),Se==A&&b.showPrimarySelection()},50)}}Ue(A,"copy",L),Ue(A,"cut",L)},tn.prototype.screenReaderLabelChanged=function(a){a?this.div.setAttribute("aria-label",a):this.div.removeAttribute("aria-label")},tn.prototype.prepareSelection=function(){var a=ca(this.cm,!1);return a.focus=Qe()==this.div,a},tn.prototype.showSelection=function(a,l){!a||!this.cm.display.view.length||((a.focus||l)&&this.showPrimarySelection(),this.showMultipleSelections(a))},tn.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},tn.prototype.showPrimarySelection=function(){var a=this.getSelection(),l=this.cm,b=l.doc.sel.primary(),d=b.from(),A=b.to();if(l.display.viewTo==l.display.viewFrom||d.line>=l.display.viewTo||A.line<l.display.viewFrom){a.removeAllRanges();return}var E=eo(l,a.anchorNode,a.anchorOffset),L=eo(l,a.focusNode,a.focusOffset);if(!(E&&!E.bad&&L&&!L.bad&&q(St(E,L),d)==0&&q(Xe(E,L),A)==0)){var V=l.display.view,z=d.line>=l.display.viewFrom&&Cu(l,d)||{node:V[0].measure.map[2],offset:0},j=A.line<l.display.viewTo&&Cu(l,A);if(!j){var fe=V[V.length-1].measure,me=fe.maps?fe.maps[fe.maps.length-1]:fe.map;j={node:me[me.length-1],offset:me[me.length-2]-me[me.length-3]}}if(!z||!j){a.removeAllRanges();return}var Se=a.rangeCount&&a.getRangeAt(0),Me;try{Me=Ze(z.node,z.offset,j.offset,j.node)}catch{}Me&&(!o&&l.state.focused?(a.collapse(z.node,z.offset),Me.collapsed||(a.removeAllRanges(),a.addRange(Me))):(a.removeAllRanges(),a.addRange(Me)),Se&&a.anchorNode==null?a.addRange(Se):o&&this.startGracePeriod()),this.rememberSelection()}},tn.prototype.startGracePeriod=function(){var a=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){a.gracePeriod=!1,a.selectionChanged()&&a.cm.operation(function(){return a.cm.curOp.selectionChanged=!0})},20)},tn.prototype.showMultipleSelections=function(a){Ce(this.cm.display.cursorDiv,a.cursors),Ce(this.cm.display.selectionDiv,a.selection)},tn.prototype.rememberSelection=function(){var a=this.getSelection();this.lastAnchorNode=a.anchorNode,this.lastAnchorOffset=a.anchorOffset,this.lastFocusNode=a.focusNode,this.lastFocusOffset=a.focusOffset},tn.prototype.selectionInEditor=function(){var a=this.getSelection();if(!a.rangeCount)return!1;var l=a.getRangeAt(0).commonAncestorContainer;return Je(this.div,l)},tn.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||Qe()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},tn.prototype.blur=function(){this.div.blur()},tn.prototype.getField=function(){return this.div},tn.prototype.supportsTouch=function(){return!0},tn.prototype.receivedFocus=function(){var a=this,l=this;this.selectionInEditor()?setTimeout(function(){return a.pollSelection()},20):zn(this.cm,function(){return l.cm.curOp.selectionChanged=!0});function b(){l.cm.state.focused&&(l.pollSelection(),l.polling.set(l.cm.options.pollInterval,b))}this.polling.set(this.cm.options.pollInterval,b)},tn.prototype.selectionChanged=function(){var a=this.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset},tn.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var a=this.getSelection(),l=this.cm;if(Z&&k&&this.cm.display.gutterSpecs.length&&Ll(a.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var b=eo(l,a.anchorNode,a.anchorOffset),d=eo(l,a.focusNode,a.focusOffset);b&&d&&zn(l,function(){Dn(l.doc,$r(b,d),pt),(b.bad||d.bad)&&(l.curOp.selectionChanged=!0)})}}},tn.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var a=this.cm,l=a.display,b=a.doc.sel.primary(),d=b.from(),A=b.to();if(d.ch==0&&d.line>a.firstLine()&&(d=Be(d.line-1,ft(a.doc,d.line-1).length)),A.ch==ft(a.doc,A.line).text.length&&A.line<a.lastLine()&&(A=Be(A.line+1,0)),d.line<l.viewFrom||A.line>l.viewTo-1)return!1;var E,L,V;d.line==l.viewFrom||(E=ei(a,d.line))==0?(L=jt(l.view[0].line),V=l.view[0].node):(L=jt(l.view[E].line),V=l.view[E-1].node.nextSibling);var z=ei(a,A.line),j,fe;if(z==l.view.length-1?(j=l.viewTo-1,fe=l.lineDiv.lastChild):(j=jt(l.view[z+1].line)-1,fe=l.view[z+1].node.previousSibling),!V)return!1;for(var me=a.doc.splitLines(Gl(a,V,fe,L,j)),Se=Jn(a.doc,Be(L,0),Be(j,ft(a.doc,j).text.length));me.length>1&&Se.length>1;)if(_t(me)==_t(Se))me.pop(),Se.pop(),j--;else if(me[0]==Se[0])me.shift(),Se.shift(),L++;else break;for(var Me=0,Ee=0,Re=me[0],ze=Se[0],Ke=Math.min(Re.length,ze.length);Me<Ke&&Re.charCodeAt(Me)==ze.charCodeAt(Me);)++Me;for(var it=_t(me),qe=_t(Se),ct=Math.min(it.length-(me.length==1?Me:0),qe.length-(Se.length==1?Me:0));Ee<ct&&it.charCodeAt(it.length-Ee-1)==qe.charCodeAt(qe.length-Ee-1);)++Ee;if(me.length==1&&Se.length==1&&L==d.line)for(;Me&&Me>d.ch&&it.charCodeAt(it.length-Ee-1)==qe.charCodeAt(qe.length-Ee-1);)Me--,Ee++;me[me.length-1]=it.slice(0,it.length-Ee).replace(/^\u200b+/,""),me[0]=me[0].slice(Me).replace(/\u200b+$/,"");var Mt=Be(L,Me),At=Be(j,Se.length?_t(Se).length-Ee:0);if(me.length>1||me[0]||q(Mt,At))return xi(a.doc,me,Mt,At,"+input"),!0},tn.prototype.ensurePolled=function(){this.forceCompositionEnd()},tn.prototype.reset=function(){this.forceCompositionEnd()},tn.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},tn.prototype.readFromDOMSoon=function(){var a=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(a.readDOMTimeout=null,a.composing)if(a.composing.done)a.composing=null;else return;a.updateFromDOM()},80))},tn.prototype.updateFromDOM=function(){var a=this;(this.cm.isReadOnly()||!this.pollContent())&&zn(this.cm,function(){return $n(a.cm)})},tn.prototype.setUneditable=function(a){a.contentEditable="false"},tn.prototype.onKeyPress=function(a){a.charCode==0||this.composing||(a.preventDefault(),this.cm.isReadOnly()||Cn(this.cm,ea)(this.cm,String.fromCharCode(a.charCode==null?a.keyCode:a.charCode),0))},tn.prototype.readOnlyChanged=function(a){this.div.contentEditable=String(a!="nocursor")},tn.prototype.onContextMenu=function(){},tn.prototype.resetPosition=function(){},tn.prototype.needsContentAttribute=!0;function Cu(a,l){var b=Lr(a,l.line);if(!b||b.hidden)return null;var d=ft(a.doc,l.line),A=Ts(b,d,l.line),E=It(d,a.doc.direction),L="left";if(E){var V=Ye(E,l.ch);L=V%2?"right":"left"}var z=mi(A.map,l.ch,L);return z.offset=z.collapse=="right"?z.end:z.start,z}function Ll(a){for(var l=a;l;l=l.parentNode)if(/CodeMirror-gutter-wrapper/.test(l.className))return!0;return!1}function Fi(a,l){return l&&(a.bad=!0),a}function Gl(a,l,b,d,A){var E="",L=!1,V=a.doc.lineSeparator(),z=!1;function j(Me){return function(Ee){return Ee.id==Me}}function fe(){L&&(E+=V,z&&(E+=V),L=z=!1)}function me(Me){Me&&(fe(),E+=Me)}function Se(Me){if(Me.nodeType==1){var Ee=Me.getAttribute("cm-text");if(Ee){me(Ee);return}var Re=Me.getAttribute("cm-marker"),ze;if(Re){var Ke=a.findMarks(Be(d,0),Be(A+1,0),j(+Re));Ke.length&&(ze=Ke[0].find(0))&&me(Jn(a.doc,ze.from,ze.to).join(V));return}if(Me.getAttribute("contenteditable")=="false")return;var it=/^(pre|div|p|li|table|br)$/i.test(Me.nodeName);if(!/^br$/i.test(Me.nodeName)&&Me.textContent.length==0)return;it&&fe();for(var qe=0;qe<Me.childNodes.length;qe++)Se(Me.childNodes[qe]);/^(pre|p)$/i.test(Me.nodeName)&&(z=!0),it&&(L=!0)}else Me.nodeType==3&&me(Me.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;Se(l),l!=b;)l=l.nextSibling,z=!1;return E}function eo(a,l,b){var d;if(l==a.display.lineDiv){if(d=a.display.lineDiv.childNodes[b],!d)return Fi(a.clipPos(Be(a.display.viewTo-1)),!0);l=null,b=0}else for(d=l;;d=d.parentNode){if(!d||d==a.display.lineDiv)return null;if(d.parentNode&&d.parentNode==a.display.lineDiv)break}for(var A=0;A<a.display.view.length;A++){var E=a.display.view[A];if(E.node==d)return Rl(E,l,b)}}function Rl(a,l,b){var d=a.text.firstChild,A=!1;if(!l||!Je(d,l))return Fi(Be(jt(a.line),0),!0);if(l==d&&(A=!0,l=d.childNodes[b],b=0,!l)){var E=a.rest?_t(a.rest):a.line;return Fi(Be(jt(E),E.text.length),A)}var L=l.nodeType==3?l:null,V=l;for(!L&&l.childNodes.length==1&&l.firstChild.nodeType==3&&(L=l.firstChild,b&&(b=L.nodeValue.length));V.parentNode!=d;)V=V.parentNode;var z=a.measure,j=z.maps;function fe(ze,Ke,it){for(var qe=-1;qe<(j?j.length:0);qe++)for(var ct=qe<0?z.map:j[qe],Mt=0;Mt<ct.length;Mt+=3){var At=ct[Mt+2];if(At==ze||At==Ke){var Ot=jt(qe<0?a.line:a.rest[qe]),nn=ct[Mt]+it;return(it<0||At!=ze)&&(nn=ct[Mt+(it?1:0)]),Be(Ot,nn)}}}var me=fe(L,V,b);if(me)return Fi(me,A);for(var Se=V.nextSibling,Me=L?L.nodeValue.length-b:0;Se;Se=Se.nextSibling){if(me=fe(Se,Se.firstChild,0),me)return Fi(Be(me.line,me.ch-Me),A);Me+=Se.textContent.length}for(var Ee=V.previousSibling,Re=b;Ee;Ee=Ee.previousSibling){if(me=fe(Ee,Ee.firstChild,-1),me)return Fi(Be(me.line,me.ch+Re),A);Re+=Ee.textContent.length}}var dn=function(a){this.cm=a,this.prevInput="",this.pollingFast=!1,this.polling=new at,this.hasSelection=!1,this.composing=null};dn.prototype.init=function(a){var l=this,b=this,d=this.cm;this.createField(a);var A=this.textarea;a.wrapper.insertBefore(this.wrapper,a.wrapper.firstChild),O&&(A.style.width="0px"),Ue(A,"input",function(){g&&M>=9&&l.hasSelection&&(l.hasSelection=null),b.poll()}),Ue(A,"paste",function(L){Wt(d,L)||gu(L,d)||(d.state.pasteIncoming=+new Date,b.fastPoll())});function E(L){if(!Wt(d,L)){if(d.somethingSelected())Qs({lineWise:!1,text:d.getSelections()});else if(d.options.lineWiseCopyCut){var V=yu(d);Qs({lineWise:!0,text:V.text}),L.type=="cut"?d.setSelections(V.ranges,null,pt):(b.prevInput="",A.value=V.text.join(`
`),kt(A))}else return;L.type=="cut"&&(d.state.cutIncoming=+new Date)}}Ue(A,"cut",E),Ue(A,"copy",E),Ue(a.scroller,"paste",function(L){if(!(lr(a,L)||Wt(d,L))){if(!A.dispatchEvent){d.state.pasteIncoming=+new Date,b.focus();return}var V=new Event("paste");V.clipboardData=L.clipboardData,A.dispatchEvent(V)}}),Ue(a.lineSpace,"selectstart",function(L){lr(a,L)||Dt(L)}),Ue(A,"compositionstart",function(){var L=d.getCursor("from");b.composing&&b.composing.range.clear(),b.composing={start:L,range:d.markText(L,d.getCursor("to"),{className:"CodeMirror-composing"})}}),Ue(A,"compositionend",function(){b.composing&&(b.poll(),b.composing.range.clear(),b.composing=null)})},dn.prototype.createField=function(a){this.wrapper=bu(),this.textarea=this.wrapper.firstChild},dn.prototype.screenReaderLabelChanged=function(a){a?this.textarea.setAttribute("aria-label",a):this.textarea.removeAttribute("aria-label")},dn.prototype.prepareSelection=function(){var a=this.cm,l=a.display,b=a.doc,d=ca(a);if(a.options.moveInputWithCursor){var A=cr(a,b.sel.primary().head,"div"),E=l.wrapper.getBoundingClientRect(),L=l.lineDiv.getBoundingClientRect();d.teTop=Math.max(0,Math.min(l.wrapper.clientHeight-10,A.top+L.top-E.top)),d.teLeft=Math.max(0,Math.min(l.wrapper.clientWidth-10,A.left+L.left-E.left))}return d},dn.prototype.showSelection=function(a){var l=this.cm,b=l.display;Ce(b.cursorDiv,a.cursors),Ce(b.selectionDiv,a.selection),a.teTop!=null&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")},dn.prototype.reset=function(a){if(!(this.contextMenuPending||this.composing)){var l=this.cm;if(l.somethingSelected()){this.prevInput="";var b=l.getSelection();this.textarea.value=b,l.state.focused&&kt(this.textarea),g&&M>=9&&(this.hasSelection=b)}else a||(this.prevInput=this.textarea.value="",g&&M>=9&&(this.hasSelection=null))}},dn.prototype.getField=function(){return this.textarea},dn.prototype.supportsTouch=function(){return!1},dn.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!K||Qe()!=this.textarea))try{this.textarea.focus()}catch{}},dn.prototype.blur=function(){this.textarea.blur()},dn.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},dn.prototype.receivedFocus=function(){this.slowPoll()},dn.prototype.slowPoll=function(){var a=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){a.poll(),a.cm.state.focused&&a.slowPoll()})},dn.prototype.fastPoll=function(){var a=!1,l=this;l.pollingFast=!0;function b(){var d=l.poll();!d&&!a?(a=!0,l.polling.set(60,b)):(l.pollingFast=!1,l.slowPoll())}l.polling.set(20,b)},dn.prototype.poll=function(){var a=this,l=this.cm,b=this.textarea,d=this.prevInput;if(this.contextMenuPending||!l.state.focused||Ve(b)&&!d&&!this.composing||l.isReadOnly()||l.options.disableInput||l.state.keySeq)return!1;var A=b.value;if(A==d&&!l.somethingSelected())return!1;if(g&&M>=9&&this.hasSelection===A||ie&&/[\uf700-\uf7ff]/.test(A))return l.display.input.reset(),!1;if(l.doc.sel==l.display.selForContextMenu){var E=A.charCodeAt(0);if(E==8203&&!d&&(d="​"),E==8666)return this.reset(),this.cm.execCommand("undo")}for(var L=0,V=Math.min(d.length,A.length);L<V&&d.charCodeAt(L)==A.charCodeAt(L);)++L;return zn(l,function(){ea(l,A.slice(L),d.length-L,null,a.composing?"*compose":null),A.length>1e3||A.indexOf(`
`)>-1?b.value=a.prevInput="":a.prevInput=A,a.composing&&(a.composing.range.clear(),a.composing.range=l.markText(a.composing.start,l.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},dn.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},dn.prototype.onKeyPress=function(){g&&M>=9&&(this.hasSelection=null),this.fastPoll()},dn.prototype.onContextMenu=function(a){var l=this,b=l.cm,d=b.display,A=l.textarea;l.contextMenuPending&&l.contextMenuPending();var E=Qr(b,a),L=d.scroller.scrollTop;if(!E||N)return;var V=b.options.resetSelectionOnContextMenu;V&&b.doc.sel.contains(E)==-1&&Cn(b,Dn)(b.doc,$r(E),pt);var z=A.style.cssText,j=l.wrapper.style.cssText,fe=l.wrapper.offsetParent.getBoundingClientRect();l.wrapper.style.cssText="position: static",A.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(a.clientY-fe.top-5)+"px; left: "+(a.clientX-fe.left-5)+`px;
      z-index: 1000; background: `+(g?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var me;F&&(me=window.scrollY),d.input.focus(),F&&window.scrollTo(null,me),d.input.reset(),b.somethingSelected()||(A.value=l.prevInput=" "),l.contextMenuPending=Me,d.selForContextMenu=b.doc.sel,clearTimeout(d.detectingSelectAll);function Se(){if(A.selectionStart!=null){var Re=b.somethingSelected(),ze="​"+(Re?A.value:"");A.value="⇚",A.value=ze,l.prevInput=Re?"":"​",A.selectionStart=1,A.selectionEnd=ze.length,d.selForContextMenu=b.doc.sel}}function Me(){if(l.contextMenuPending==Me&&(l.contextMenuPending=!1,l.wrapper.style.cssText=j,A.style.cssText=z,g&&M<9&&d.scrollbars.setScrollTop(d.scroller.scrollTop=L),A.selectionStart!=null)){(!g||g&&M<9)&&Se();var Re=0,ze=function(){d.selForContextMenu==b.doc.sel&&A.selectionStart==0&&A.selectionEnd>0&&l.prevInput=="​"?Cn(b,Oa)(b):Re++<10?d.detectingSelectAll=setTimeout(ze,500):(d.selForContextMenu=null,d.input.reset())};d.detectingSelectAll=setTimeout(ze,200)}}if(g&&M>=9&&Se(),ve){ln(a);var Ee=function(){Ht(window,"mouseup",Ee),setTimeout(Me,20)};Ue(window,"mouseup",Ee)}else setTimeout(Me,50)},dn.prototype.readOnlyChanged=function(a){a||this.reset(),this.textarea.disabled=a=="nocursor",this.textarea.readOnly=!!a},dn.prototype.setUneditable=function(){},dn.prototype.needsContentAttribute=!1;function Bl(a,l){if(l=l?Tt(l):{},l.value=a.value,!l.tabindex&&a.tabIndex&&(l.tabindex=a.tabIndex),!l.placeholder&&a.placeholder&&(l.placeholder=a.placeholder),l.autofocus==null){var b=Qe();l.autofocus=b==a||a.getAttribute("autofocus")!=null&&b==document.body}function d(){a.value=V.getValue()}var A;if(a.form&&(Ue(a.form,"submit",d),!l.leaveSubmitMethodAlone)){var E=a.form;A=E.submit;try{var L=E.submit=function(){d(),E.submit=A,E.submit(),E.submit=L}}catch{}}l.finishInit=function(z){z.save=d,z.getTextArea=function(){return a},z.toTextArea=function(){z.toTextArea=isNaN,d(),a.parentNode.removeChild(z.getWrapperElement()),a.style.display="",a.form&&(Ht(a.form,"submit",d),!l.leaveSubmitMethodAlone&&typeof a.form.submit=="function"&&(a.form.submit=A))}},a.style.display="none";var V=an(function(z){return a.parentNode.insertBefore(z,a.nextSibling)},l);return V}function $l(a){a.off=Ht,a.on=Ue,a.wheelEventPixels=zu,a.Doc=In,a.splitLines=Ge,a.countColumn=ke,a.findColumn=Zt,a.isWordChar=xe,a.Pass=nt,a.signal=Oe,a.Line=Kn,a.changeEnd=Ir,a.scrollbarModel=ga,a.Pos=Be,a.cmpPos=q,a.modes=fn,a.mimeModes=pn,a.resolveMode=bn,a.getMode=Sr,a.modeExtensions=Un,a.extendMode=jn,a.copyState=Gn,a.startState=zr,a.innerMode=Zr,a.commands=is,a.keyMap=xr,a.keyName=nu,a.isModifierKey=eu,a.lookupKey=Si,a.normalizeKeyMap=dl,a.StringStream=on,a.SharedTextMarker=ts,a.TextMarker=Wr,a.LineWidget=es,a.e_preventDefault=Dt,a.e_stopPropagation=Ut,a.e_stop=ln,a.addClass=rt,a.contains=Je,a.rmClass=Fe,a.keyNames=Xr}Fl(an),Nl(an);var Il="iter insert remove copy getEditor constructor".split(" ");for(var to in In.prototype)In.prototype.hasOwnProperty(to)&&je(Il,to)<0&&(an.prototype[to]=(function(a){return function(){return a.apply(this.doc,arguments)}})(In.prototype[to]));return Pt(In),an.inputStyles={textarea:dn,contenteditable:tn},an.defineMode=function(a){!an.defaults.mode&&a!="null"&&(an.defaults.mode=a),yr.apply(this,arguments)},an.defineMIME=Vn,an.defineMode("null",function(){return{token:function(a){return a.skipToEnd()}}}),an.defineMIME("text/plain","null"),an.defineExtension=function(a,l){an.prototype[a]=l},an.defineDocExtension=function(a,l){In.prototype[a]=l},an.fromTextArea=Bl,$l(an),an.version="5.65.4",an})),(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){e.defineMode("javascript",function(t,o){var u=t.indentUnit,f=o.statementIndent,p=o.jsonld,g=o.json||p,M=o.trackScope!==!1,F=o.typescript,S=o.wordCharacters||/[\w$\xa1-\uffff]/,k=(function(){function q(An){return{type:An,style:"keyword"}}var ge=q("keyword a"),Ne=q("keyword b"),Xe=q("keyword c"),St=q("keyword d"),Vt=q("operator"),st={type:"atom",style:"atom"};return{if:q("if"),while:ge,with:ge,else:Ne,do:Ne,try:Ne,finally:Ne,return:St,break:St,continue:St,new:q("new"),delete:Xe,void:Xe,throw:Xe,debugger:q("debugger"),var:q("var"),const:q("var"),let:q("var"),function:q("function"),catch:q("catch"),for:q("for"),switch:q("switch"),case:q("case"),default:q("default"),in:Vt,typeof:Vt,instanceof:Vt,true:st,false:st,null:st,undefined:st,NaN:st,Infinity:st,this:q("this"),class:q("class"),super:q("atom"),yield:Xe,export:q("export"),import:q("import"),extends:Xe,await:Xe}})(),N=/[+\-*&%=<>!?|~^@]/,$=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function R(q){for(var ge=!1,Ne,Xe=!1;(Ne=q.next())!=null;){if(!ge){if(Ne=="/"&&!Xe)return;Ne=="["?Xe=!0:Xe&&Ne=="]"&&(Xe=!1)}ge=!ge&&Ne=="\\"}}var U,O;function Z(q,ge,Ne){return U=q,O=Ne,ge}function K(q,ge){var Ne=q.next();if(Ne=='"'||Ne=="'")return ge.tokenize=ie(Ne),ge.tokenize(q,ge);if(Ne=="."&&q.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return Z("number","number");if(Ne=="."&&q.match(".."))return Z("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(Ne))return Z(Ne);if(Ne=="="&&q.eat(">"))return Z("=>","operator");if(Ne=="0"&&q.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return Z("number","number");if(/\d/.test(Ne))return q.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),Z("number","number");if(Ne=="/")return q.eat("*")?(ge.tokenize=de,de(q,ge)):q.eat("/")?(q.skipToEnd(),Z("comment","comment")):Be(q,ge,1)?(R(q),q.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),Z("regexp","string-2")):(q.eat("="),Z("operator","operator",q.current()));if(Ne=="`")return ge.tokenize=te,te(q,ge);if(Ne=="#"&&q.peek()=="!")return q.skipToEnd(),Z("meta","meta");if(Ne=="#"&&q.eatWhile(S))return Z("variable","property");if(Ne=="<"&&q.match("!--")||Ne=="-"&&q.match("->")&&!/\S/.test(q.string.slice(0,q.start)))return q.skipToEnd(),Z("comment","comment");if(N.test(Ne))return(Ne!=">"||!ge.lexical||ge.lexical.type!=">")&&(q.eat("=")?(Ne=="!"||Ne=="=")&&q.eat("="):/[<>*+\-|&?]/.test(Ne)&&(q.eat(Ne),Ne==">"&&q.eat(Ne))),Ne=="?"&&q.eat(".")?Z("."):Z("operator","operator",q.current());if(S.test(Ne)){q.eatWhile(S);var Xe=q.current();if(ge.lastType!="."){if(k.propertyIsEnumerable(Xe)){var St=k[Xe];return Z(St.type,St.style,Xe)}if(Xe=="async"&&q.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return Z("async","keyword",Xe)}return Z("variable","variable",Xe)}}function ie(q){return function(ge,Ne){var Xe=!1,St;if(p&&ge.peek()=="@"&&ge.match($))return Ne.tokenize=K,Z("jsonld-keyword","meta");for(;(St=ge.next())!=null&&!(St==q&&!Xe);)Xe=!Xe&&St=="\\";return Xe||(Ne.tokenize=K),Z("string","string")}}function de(q,ge){for(var Ne=!1,Xe;Xe=q.next();){if(Xe=="/"&&Ne){ge.tokenize=K;break}Ne=Xe=="*"}return Z("comment","comment")}function te(q,ge){for(var Ne=!1,Xe;(Xe=q.next())!=null;){if(!Ne&&(Xe=="`"||Xe=="$"&&q.eat("{"))){ge.tokenize=K;break}Ne=!Ne&&Xe=="\\"}return Z("quasi","string-2",q.current())}var re="([{}])";function ue(q,ge){ge.fatArrowAt&&(ge.fatArrowAt=null);var Ne=q.string.indexOf("=>",q.start);if(!(Ne<0)){if(F){var Xe=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(q.string.slice(q.start,Ne));Xe&&(Ne=Xe.index)}for(var St=0,Vt=!1,st=Ne-1;st>=0;--st){var An=q.string.charAt(st),Rn=re.indexOf(An);if(Rn>=0&&Rn<3){if(!St){++st;break}if(--St==0){An=="("&&(Vt=!0);break}}else if(Rn>=3&&Rn<6)++St;else if(S.test(An))Vt=!0;else if(/["'\/`]/.test(An))for(;;--st){if(st==0)return;var wr=q.string.charAt(st-1);if(wr==An&&q.string.charAt(st-2)!="\\"){st--;break}}else if(Vt&&!St){++st;break}}Vt&&!St&&(ge.fatArrowAt=st)}}var ve={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function Ae(q,ge,Ne,Xe,St,Vt){this.indented=q,this.column=ge,this.type=Ne,this.prev=St,this.info=Vt,Xe!=null&&(this.align=Xe)}function Fe(q,ge){if(!M)return!1;for(var Ne=q.localVars;Ne;Ne=Ne.next)if(Ne.name==ge)return!0;for(var Xe=q.context;Xe;Xe=Xe.prev)for(var Ne=Xe.vars;Ne;Ne=Ne.next)if(Ne.name==ge)return!0}function we(q,ge,Ne,Xe,St){var Vt=q.cc;for(Ce.state=q,Ce.stream=St,Ce.marked=null,Ce.cc=Vt,Ce.style=ge,q.lexical.hasOwnProperty("align")||(q.lexical.align=!0);;){var st=Vt.length?Vt.pop():g?ht:pt;if(st(Ne,Xe)){for(;Vt.length&&Vt[Vt.length-1].lex;)Vt.pop()();return Ce.marked?Ce.marked:Ne=="variable"&&Fe(q,Xe)?"variable-2":ge}}}var Ce={state:null,marked:null,cc:null};function be(){for(var q=arguments.length-1;q>=0;q--)Ce.cc.push(arguments[q])}function le(){return be.apply(null,arguments),!0}function Ze(q,ge){for(var Ne=ge;Ne;Ne=Ne.next)if(Ne.name==q)return!0;return!1}function Je(q){var ge=Ce.state;if(Ce.marked="def",!!M){if(ge.context){if(ge.lexical.info=="var"&&ge.context&&ge.context.block){var Ne=Qe(q,ge.context);if(Ne!=null){ge.context=Ne;return}}else if(!Ze(q,ge.localVars)){ge.localVars=new kt(q,ge.localVars);return}}o.globalVars&&!Ze(q,ge.globalVars)&&(ge.globalVars=new kt(q,ge.globalVars))}}function Qe(q,ge){if(ge)if(ge.block){var Ne=Qe(q,ge.prev);return Ne?Ne==ge.prev?ge:new tt(Ne,ge.vars,!0):null}else return Ze(q,ge.vars)?ge:new tt(ge.prev,new kt(q,ge.vars),!1);else return null}function rt(q){return q=="public"||q=="private"||q=="protected"||q=="abstract"||q=="readonly"}function tt(q,ge,Ne){this.prev=q,this.vars=ge,this.block=Ne}function kt(q,ge){this.name=q,this.next=ge}var Lt=new kt("this",new kt("arguments",null));function Tt(){Ce.state.context=new tt(Ce.state.context,Ce.state.localVars,!1),Ce.state.localVars=Lt}function ke(){Ce.state.context=new tt(Ce.state.context,Ce.state.localVars,!0),Ce.state.localVars=null}Tt.lex=ke.lex=!0;function at(){Ce.state.localVars=Ce.state.context.vars,Ce.state.context=Ce.state.context.prev}at.lex=!0;function je(q,ge){var Ne=function(){var Xe=Ce.state,St=Xe.indented;if(Xe.lexical.type=="stat")St=Xe.lexical.indented;else for(var Vt=Xe.lexical;Vt&&Vt.type==")"&&Vt.align;Vt=Vt.prev)St=Vt.indented;Xe.lexical=new Ae(St,Ce.stream.column(),q,null,Xe.lexical,ge)};return Ne.lex=!0,Ne}function Ie(){var q=Ce.state;q.lexical.prev&&(q.lexical.type==")"&&(q.indented=q.lexical.indented),q.lexical=q.lexical.prev)}Ie.lex=!0;function nt(q){function ge(Ne){return Ne==q?le():q==";"||Ne=="}"||Ne==")"||Ne=="]"?be():le(ge)}return ge}function pt(q,ge){return q=="var"?le(je("vardef",ge),se,nt(";"),Ie):q=="keyword a"?le(je("form"),Qt,pt,Ie):q=="keyword b"?le(je("form"),pt,Ie):q=="keyword d"?Ce.stream.match(/^\s*$/,!1)?le():le(je("stat"),_t,nt(";"),Ie):q=="debugger"?le(nt(";")):q=="{"?le(je("}"),ke,It,Ie,at):q==";"?le():q=="if"?(Ce.state.lexical.info=="else"&&Ce.state.cc[Ce.state.cc.length-1]==Ie&&Ce.state.cc.pop()(),le(je("form"),Qt,pt,Ie,Ve)):q=="function"?le(fn):q=="for"?le(je("form"),ke,ut,pt,at,Ie):q=="class"||F&&ge=="interface"?(Ce.marked="keyword",le(je("form",q=="class"?q:ge),Sr,Ie)):q=="variable"?F&&ge=="declare"?(Ce.marked="keyword",le(pt)):F&&(ge=="module"||ge=="enum"||ge=="type")&&Ce.stream.match(/^\s*\w/,!1)?(Ce.marked="keyword",ge=="enum"?le(Qn):ge=="type"?le(yr,nt("operator"),Oe,nt(";")):le(je("form"),ee,nt("{"),je("}"),It,Ie,Ie)):F&&ge=="namespace"?(Ce.marked="keyword",le(je("form"),ht,pt,Ie)):F&&ge=="abstract"?(Ce.marked="keyword",le(pt)):le(je("stat"),He):q=="switch"?le(je("form"),Qt,nt("{"),je("}","switch"),ke,It,Ie,Ie,at):q=="case"?le(ht,nt(":")):q=="default"?le(nt(":")):q=="catch"?le(je("form"),Tt,Ft,pt,Ie,at):q=="export"?le(je("stat"),Zr,Ie):q=="import"?le(je("stat"),on,Ie):q=="async"?le(pt):ge=="@"?le(ht,pt):be(je("stat"),ht,nt(";"),Ie)}function Ft(q){if(q=="(")return le(Vn,nt(")"))}function ht(q,ge){return Bt(q,ge,!1)}function Zt(q,ge){return Bt(q,ge,!0)}function Qt(q){return q!="("?be():le(je(")"),_t,nt(")"),Ie)}function Bt(q,ge,Ne){if(Ce.state.fatArrowAt==Ce.stream.start){var Xe=Ne?xe:yn;if(q=="(")return le(Tt,je(")"),Ye(Vn,")"),Ie,nt("=>"),Xe,at);if(q=="variable")return be(Tt,ee,nt("=>"),Xe,at)}var St=Ne?rn:$t;return ve.hasOwnProperty(q)?le(St):q=="function"?le(fn,St):q=="class"||F&&ge=="interface"?(Ce.marked="keyword",le(je("form"),bn,Ie)):q=="keyword c"||q=="async"?le(Ne?Zt:ht):q=="("?le(je(")"),_t,nt(")"),Ie,St):q=="operator"||q=="spread"?le(Ne?Zt:ht):q=="["?le(je("]"),jt,Ie,St):q=="{"?mt(We,"}",null,St):q=="quasi"?be(Gt,St):q=="new"?le(Pe(Ne)):le()}function _t(q){return q.match(/[;\}\)\],]/)?be():be(ht)}function $t(q,ge){return q==","?le(_t):rn(q,ge,!1)}function rn(q,ge,Ne){var Xe=Ne==!1?$t:rn,St=Ne==!1?ht:Zt;if(q=="=>")return le(Tt,Ne?xe:yn,at);if(q=="operator")return/\+\+|--/.test(ge)||F&&ge=="!"?le(Xe):F&&ge=="<"&&Ce.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?le(je(">"),Ye(Oe,">"),Ie,Xe):ge=="?"?le(ht,nt(":"),St):le(St);if(q=="quasi")return be(Gt,Xe);if(q!=";"){if(q=="(")return mt(Zt,")","call",Xe);if(q==".")return le(et,Xe);if(q=="[")return le(je("]"),_t,nt("]"),Ie,Xe);if(F&&ge=="as")return Ce.marked="keyword",le(Oe,Xe);if(q=="regexp")return Ce.state.lastType=Ce.marked="operator",Ce.stream.backUp(Ce.stream.pos-Ce.stream.start-1),le(St)}}function Gt(q,ge){return q!="quasi"?be():ge.slice(ge.length-2)!="${"?le(Gt):le(_t,Yt)}function Yt(q){if(q=="}")return Ce.marked="string-2",Ce.state.tokenize=te,le(Gt)}function yn(q){return ue(Ce.stream,Ce.state),be(q=="{"?pt:ht)}function xe(q){return ue(Ce.stream,Ce.state),be(q=="{"?pt:Zt)}function Pe(q){return function(ge){return ge=="."?le(q?Te:ye):ge=="variable"&&F?le(ln,q?rn:$t):be(q?Zt:ht)}}function ye(q,ge){if(ge=="target")return Ce.marked="keyword",le($t)}function Te(q,ge){if(ge=="target")return Ce.marked="keyword",le(rn)}function He(q){return q==":"?le(Ie,pt):be($t,nt(";"),Ie)}function et(q){if(q=="variable")return Ce.marked="property",le()}function We(q,ge){if(q=="async")return Ce.marked="property",le(We);if(q=="variable"||Ce.style=="keyword"){if(Ce.marked="property",ge=="get"||ge=="set")return le(yt);var Ne;return F&&Ce.state.fatArrowAt==Ce.stream.start&&(Ne=Ce.stream.match(/^\s*:\s*/,!1))&&(Ce.state.fatArrowAt=Ce.stream.pos+Ne[0].length),le($e)}else{if(q=="number"||q=="string")return Ce.marked=p?"property":Ce.style+" property",le($e);if(q=="jsonld-keyword")return le($e);if(F&&rt(ge))return Ce.marked="keyword",le(We);if(q=="[")return le(ht,zt,nt("]"),$e);if(q=="spread")return le(Zt,$e);if(ge=="*")return Ce.marked="keyword",le(We);if(q==":")return be($e)}}function yt(q){return q!="variable"?be($e):(Ce.marked="property",le(fn))}function $e(q){if(q==":")return le(Zt);if(q=="(")return be(fn)}function Ye(q,ge,Ne){function Xe(St,Vt){if(Ne?Ne.indexOf(St)>-1:St==","){var st=Ce.state.lexical;return st.info=="call"&&(st.pos=(st.pos||0)+1),le(function(An,Rn){return An==ge||Rn==ge?be():be(q)},Xe)}return St==ge||Vt==ge?le():Ne&&Ne.indexOf(";")>-1?be(q):le(nt(ge))}return function(St,Vt){return St==ge||Vt==ge?le():be(q,Xe)}}function mt(q,ge,Ne){for(var Xe=3;Xe<arguments.length;Xe++)Ce.cc.push(arguments[Xe]);return le(je(ge,Ne),Ye(q,ge),Ie)}function It(q){return q=="}"?le():be(pt,It)}function zt(q,ge){if(F){if(q==":")return le(Oe);if(ge=="?")return le(zt)}}function Ue(q,ge){if(F&&(q==":"||ge=="in"))return le(Oe)}function Et(q){if(F&&q==":")return Ce.stream.match(/^\s*\w+\s+is\b/,!1)?le(ht,Ht,Oe):le(Oe)}function Ht(q,ge){if(ge=="is")return Ce.marked="keyword",le()}function Oe(q,ge){if(ge=="keyof"||ge=="typeof"||ge=="infer"||ge=="readonly")return Ce.marked="keyword",le(ge=="typeof"?Zt:Oe);if(q=="variable"||ge=="void")return Ce.marked="type",le(Kt);if(ge=="|"||ge=="&")return le(Oe);if(q=="string"||q=="number"||q=="atom")return le(Kt);if(q=="[")return le(je("]"),Ye(Oe,"]",","),Ie,Kt);if(q=="{")return le(je("}"),sn,Ie,Kt);if(q=="(")return le(Ye(Ut,")"),Wt,Kt);if(q=="<")return le(Ye(Oe,">"),Oe);if(q=="quasi")return be(Pt,Kt)}function Wt(q){if(q=="=>")return le(Oe)}function sn(q){return q.match(/[\}\)\]]/)?le():q==","||q==";"?le(sn):be(ot,sn)}function ot(q,ge){if(q=="variable"||Ce.style=="keyword")return Ce.marked="property",le(ot);if(ge=="?"||q=="number"||q=="string")return le(ot);if(q==":")return le(Oe);if(q=="[")return le(nt("variable"),Ue,nt("]"),ot);if(q=="(")return be(pn,ot);if(!q.match(/[;\}\)\],]/))return le()}function Pt(q,ge){return q!="quasi"?be():ge.slice(ge.length-2)!="${"?le(Pt):le(Oe,Dt)}function Dt(q){if(q=="}")return Ce.marked="string-2",Ce.state.tokenize=te,le(Pt)}function Ut(q,ge){return q=="variable"&&Ce.stream.match(/^\s*[?:]/,!1)||ge=="?"?le(Ut):q==":"?le(Oe):q=="spread"?le(Ut):be(Oe)}function Kt(q,ge){if(ge=="<")return le(je(">"),Ye(Oe,">"),Ie,Kt);if(ge=="|"||q=="."||ge=="&")return le(Oe);if(q=="[")return le(Oe,nt("]"),Kt);if(ge=="extends"||ge=="implements")return Ce.marked="keyword",le(Oe);if(ge=="?")return le(Oe,nt(":"),Oe)}function ln(q,ge){if(ge=="<")return le(je(">"),Ye(Oe,">"),Ie,Kt)}function hn(){return be(Oe,B)}function B(q,ge){if(ge=="=")return le(Oe)}function se(q,ge){return ge=="enum"?(Ce.marked="keyword",le(Qn)):be(ee,zt,De,Ge)}function ee(q,ge){if(F&&rt(ge))return Ce.marked="keyword",le(ee);if(q=="variable")return Je(ge),le();if(q=="spread")return le(ee);if(q=="[")return mt(pe,"]");if(q=="{")return mt(oe,"}")}function oe(q,ge){return q=="variable"&&!Ce.stream.match(/^\s*:/,!1)?(Je(ge),le(De)):(q=="variable"&&(Ce.marked="property"),q=="spread"?le(ee):q=="}"?be():q=="["?le(ht,nt("]"),nt(":"),oe):le(nt(":"),ee,De))}function pe(){return be(ee,De)}function De(q,ge){if(ge=="=")return le(Zt)}function Ge(q){if(q==",")return le(se)}function Ve(q,ge){if(q=="keyword b"&&ge=="else")return le(je("form","else"),pt,Ie)}function ut(q,ge){if(ge=="await")return le(ut);if(q=="(")return le(je(")"),Rt,Ie)}function Rt(q){return q=="var"?le(se,Jt):q=="variable"?le(Jt):be(Jt)}function Jt(q,ge){return q==")"?le():q==";"?le(Jt):ge=="in"||ge=="of"?(Ce.marked="keyword",le(ht,Jt)):be(ht,Jt)}function fn(q,ge){if(ge=="*")return Ce.marked="keyword",le(fn);if(q=="variable")return Je(ge),le(fn);if(q=="(")return le(Tt,je(")"),Ye(Vn,")"),Ie,Et,pt,at);if(F&&ge=="<")return le(je(">"),Ye(hn,">"),Ie,fn)}function pn(q,ge){if(ge=="*")return Ce.marked="keyword",le(pn);if(q=="variable")return Je(ge),le(pn);if(q=="(")return le(Tt,je(")"),Ye(Vn,")"),Ie,Et,at);if(F&&ge=="<")return le(je(">"),Ye(hn,">"),Ie,pn)}function yr(q,ge){if(q=="keyword"||q=="variable")return Ce.marked="type",le(yr);if(ge=="<")return le(je(">"),Ye(hn,">"),Ie)}function Vn(q,ge){return ge=="@"&&le(ht,Vn),q=="spread"?le(Vn):F&&rt(ge)?(Ce.marked="keyword",le(Vn)):F&&q=="this"?le(zt,De):be(ee,zt,De)}function bn(q,ge){return q=="variable"?Sr(q,ge):Un(q,ge)}function Sr(q,ge){if(q=="variable")return Je(ge),le(Un)}function Un(q,ge){if(ge=="<")return le(je(">"),Ye(hn,">"),Ie,Un);if(ge=="extends"||ge=="implements"||F&&q==",")return ge=="implements"&&(Ce.marked="keyword"),le(F?Oe:ht,Un);if(q=="{")return le(je("}"),jn,Ie)}function jn(q,ge){if(q=="async"||q=="variable"&&(ge=="static"||ge=="get"||ge=="set"||F&&rt(ge))&&Ce.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return Ce.marked="keyword",le(jn);if(q=="variable"||Ce.style=="keyword")return Ce.marked="property",le(Gn,jn);if(q=="number"||q=="string")return le(Gn,jn);if(q=="[")return le(ht,zt,nt("]"),Gn,jn);if(ge=="*")return Ce.marked="keyword",le(jn);if(F&&q=="(")return be(pn,jn);if(q==";"||q==",")return le(jn);if(q=="}")return le();if(ge=="@")return le(ht,jn)}function Gn(q,ge){if(ge=="!"||ge=="?")return le(Gn);if(q==":")return le(Oe,De);if(ge=="=")return le(Zt);var Ne=Ce.state.lexical.prev,Xe=Ne&&Ne.info=="interface";return be(Xe?pn:fn)}function Zr(q,ge){return ge=="*"?(Ce.marked="keyword",le(En,nt(";"))):ge=="default"?(Ce.marked="keyword",le(ht,nt(";"))):q=="{"?le(Ye(zr,"}"),En,nt(";")):be(pt)}function zr(q,ge){if(ge=="as")return Ce.marked="keyword",le(nt("variable"));if(q=="variable")return be(Zt,zr)}function on(q){return q=="string"?le():q=="("?be(ht):q=="."?be($t):be(ft,Jn,En)}function ft(q,ge){return q=="{"?mt(ft,"}"):(q=="variable"&&Je(ge),ge=="*"&&(Ce.marked="keyword"),le(Hr))}function Jn(q){if(q==",")return le(ft,Jn)}function Hr(q,ge){if(ge=="as")return Ce.marked="keyword",le(ft)}function En(q,ge){if(ge=="from")return Ce.marked="keyword",le(ht)}function jt(q){return q=="]"?le():be(Ye(Zt,"]"))}function Qn(){return be(je("form"),ee,nt("{"),je("}"),Ye(vr,"}"),Ie,Ie)}function vr(){return be(ee,De)}function Ur(q,ge){return q.lastType=="operator"||q.lastType==","||N.test(ge.charAt(0))||/[,.]/.test(ge.charAt(0))}function Be(q,ge,Ne){return ge.tokenize==K&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(ge.lastType)||ge.lastType=="quasi"&&/\{\s*$/.test(q.string.slice(0,q.pos-(Ne||0)))}return{startState:function(q){var ge={tokenize:K,lastType:"sof",cc:[],lexical:new Ae((q||0)-u,0,"block",!1),localVars:o.localVars,context:o.localVars&&new tt(null,null,!1),indented:q||0};return o.globalVars&&typeof o.globalVars=="object"&&(ge.globalVars=o.globalVars),ge},token:function(q,ge){if(q.sol()&&(ge.lexical.hasOwnProperty("align")||(ge.lexical.align=!1),ge.indented=q.indentation(),ue(q,ge)),ge.tokenize!=de&&q.eatSpace())return null;var Ne=ge.tokenize(q,ge);return U=="comment"?Ne:(ge.lastType=U=="operator"&&(O=="++"||O=="--")?"incdec":U,we(ge,Ne,U,O,q))},indent:function(q,ge){if(q.tokenize==de||q.tokenize==te)return e.Pass;if(q.tokenize!=K)return 0;var Ne=ge&&ge.charAt(0),Xe=q.lexical,St;if(!/^\s*else\b/.test(ge))for(var Vt=q.cc.length-1;Vt>=0;--Vt){var st=q.cc[Vt];if(st==Ie)Xe=Xe.prev;else if(st!=Ve&&st!=at)break}for(;(Xe.type=="stat"||Xe.type=="form")&&(Ne=="}"||(St=q.cc[q.cc.length-1])&&(St==$t||St==rn)&&!/^[,\.=+\-*:?[\(]/.test(ge));)Xe=Xe.prev;f&&Xe.type==")"&&Xe.prev.type=="stat"&&(Xe=Xe.prev);var An=Xe.type,Rn=Ne==An;return An=="vardef"?Xe.indented+(q.lastType=="operator"||q.lastType==","?Xe.info.length+1:0):An=="form"&&Ne=="{"?Xe.indented:An=="form"?Xe.indented+u:An=="stat"?Xe.indented+(Ur(q,ge)?f||u:0):Xe.info=="switch"&&!Rn&&o.doubleIndentSwitch!=!1?Xe.indented+(/^(?:case|default)\b/.test(ge)?u:2*u):Xe.align?Xe.column+(Rn?0:1):Xe.indented+(Rn?0:u)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:g?null:"/*",blockCommentEnd:g?null:"*/",blockCommentContinue:g?null:" * ",lineComment:g?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:g?"json":"javascript",jsonldMode:p,jsonMode:g,expressionAllowed:Be,skipExpression:function(q){we(q,"atom","atom","true",new e.StringStream("",2,null))}}}),e.registerHelper("wordChars","javascript",/[\w$]/),e.defineMIME("text/javascript","javascript"),e.defineMIME("text/ecmascript","javascript"),e.defineMIME("application/javascript","javascript"),e.defineMIME("application/x-javascript","javascript"),e.defineMIME("application/ecmascript","javascript"),e.defineMIME("application/json",{name:"javascript",json:!0}),e.defineMIME("application/x-json",{name:"javascript",json:!0}),e.defineMIME("application/manifest+json",{name:"javascript",json:!0}),e.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),e.defineMIME("text/typescript",{name:"javascript",typescript:!0}),e.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){var t="CodeMirror-hint",o="CodeMirror-hint-active";e.showHint=function(O,Z,K){if(!Z)return O.showHint(K);K&&K.async&&(Z.async=!0);var ie={hint:Z};if(K)for(var de in K)ie[de]=K[de];return O.showHint(ie)},e.defineExtension("showHint",function(O){O=g(this,this.getCursor("start"),O);var Z=this.listSelections();if(!(Z.length>1)){if(this.somethingSelected()){if(!O.hint.supportsSelection)return;for(var K=0;K<Z.length;K++)if(Z[K].head.line!=Z[K].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var ie=this.state.completionActive=new u(this,O);ie.options.hint&&(e.signal(this,"startCompletion",this),ie.update(!0))}}),e.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});function u(O,Z){if(this.cm=O,this.options=Z,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,this.options.updateOnCursorActivity){var K=this;O.on("cursorActivity",this.activityFunc=function(){K.cursorActivity()})}}var f=window.requestAnimationFrame||function(O){return setTimeout(O,1e3/60)},p=window.cancelAnimationFrame||clearTimeout;u.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.options.updateOnCursorActivity&&this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(O,Z){var K=O.list[Z],ie=this;this.cm.operation(function(){K.hint?K.hint(ie.cm,O,K):ie.cm.replaceRange(M(K),K.from||O.from,K.to||O.to,"complete"),e.signal(O,"pick",K),ie.cm.scrollIntoView()}),this.options.closeOnPick&&this.close()},cursorActivity:function(){this.debounce&&(p(this.debounce),this.debounce=0);var O=this.startPos;this.data&&(O=this.data.from);var Z=this.cm.getCursor(),K=this.cm.getLine(Z.line);if(Z.line!=this.startPos.line||K.length-Z.ch!=this.startLen-this.startPos.ch||Z.ch<O.ch||this.cm.somethingSelected()||!Z.ch||this.options.closeCharacters.test(K.charAt(Z.ch-1)))this.close();else{var ie=this;this.debounce=f(function(){ie.update()}),this.widget&&this.widget.disable()}},update:function(O){if(this.tick!=null){var Z=this,K=++this.tick;$(this.options.hint,this.cm,this.options,function(ie){Z.tick==K&&Z.finishUpdate(ie,O)})}},finishUpdate:function(O,Z){this.data&&e.signal(this.data,"update");var K=this.widget&&this.widget.picked||Z&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=O,O&&O.list.length&&(K&&O.list.length==1?this.pick(O,0):(this.widget=new k(this,O),e.signal(O,"shown")))}};function g(O,Z,K){var ie=O.options.hintOptions,de={};for(var te in U)de[te]=U[te];if(ie)for(var te in ie)ie[te]!==void 0&&(de[te]=ie[te]);if(K)for(var te in K)K[te]!==void 0&&(de[te]=K[te]);return de.hint.resolve&&(de.hint=de.hint.resolve(O,Z)),de}function M(O){return typeof O=="string"?O:O.text}function F(O,Z){var K={Up:function(){Z.moveFocus(-1)},Down:function(){Z.moveFocus(1)},PageUp:function(){Z.moveFocus(-Z.menuSize()+1,!0)},PageDown:function(){Z.moveFocus(Z.menuSize()-1,!0)},Home:function(){Z.setFocus(0)},End:function(){Z.setFocus(Z.length-1)},Enter:Z.pick,Tab:Z.pick,Esc:Z.close},ie=/Mac/.test(navigator.platform);ie&&(K["Ctrl-P"]=function(){Z.moveFocus(-1)},K["Ctrl-N"]=function(){Z.moveFocus(1)});var de=O.options.customKeys,te=de?{}:K;function re(Ae,Fe){var we;typeof Fe!="string"?we=function(Ce){return Fe(Ce,Z)}:K.hasOwnProperty(Fe)?we=K[Fe]:we=Fe,te[Ae]=we}if(de)for(var ue in de)de.hasOwnProperty(ue)&&re(ue,de[ue]);var ve=O.options.extraKeys;if(ve)for(var ue in ve)ve.hasOwnProperty(ue)&&re(ue,ve[ue]);return te}function S(O,Z){for(;Z&&Z!=O;){if(Z.nodeName.toUpperCase()==="LI"&&Z.parentNode==O)return Z;Z=Z.parentNode}}function k(O,Z){this.id="cm-complete-"+Math.floor(Math.random(1e6)),this.completion=O,this.data=Z,this.picked=!1;var K=this,ie=O.cm,de=ie.getInputField().ownerDocument,te=de.defaultView||de.parentWindow,re=this.hints=de.createElement("ul");re.setAttribute("role","listbox"),re.setAttribute("aria-expanded","true"),re.id=this.id;var ue=O.cm.options.theme;re.className="CodeMirror-hints "+ue,this.selectedHint=Z.selectedHint||0;for(var ve=Z.list,Ae=0;Ae<ve.length;++Ae){var Fe=re.appendChild(de.createElement("li")),we=ve[Ae],Ce=t+(Ae!=this.selectedHint?"":" "+o);we.className!=null&&(Ce=we.className+" "+Ce),Fe.className=Ce,Ae==this.selectedHint&&Fe.setAttribute("aria-selected","true"),Fe.id=this.id+"-"+Ae,Fe.setAttribute("role","option"),we.render?we.render(Fe,Z,we):Fe.appendChild(de.createTextNode(we.displayText||M(we))),Fe.hintId=Ae}var be=O.options.container||de.body,le=ie.cursorCoords(O.options.alignWithWord?Z.from:null),Ze=le.left,Je=le.bottom,Qe=!0,rt=0,tt=0;if(be!==de.body){var kt=["absolute","relative","fixed"].indexOf(te.getComputedStyle(be).position)!==-1,Lt=kt?be:be.offsetParent,Tt=Lt.getBoundingClientRect(),ke=de.body.getBoundingClientRect();rt=Tt.left-ke.left-Lt.scrollLeft,tt=Tt.top-ke.top-Lt.scrollTop}re.style.left=Ze-rt+"px",re.style.top=Je-tt+"px";var at=te.innerWidth||Math.max(de.body.offsetWidth,de.documentElement.offsetWidth),je=te.innerHeight||Math.max(de.body.offsetHeight,de.documentElement.offsetHeight);be.appendChild(re),ie.getInputField().setAttribute("aria-autocomplete","list"),ie.getInputField().setAttribute("aria-owns",this.id),ie.getInputField().setAttribute("aria-activedescendant",this.id+"-"+this.selectedHint);var Ie=O.options.moveOnOverlap?re.getBoundingClientRect():new DOMRect,nt=O.options.paddingForScrollbar?re.scrollHeight>re.clientHeight+1:!1,pt;setTimeout(function(){pt=ie.getScrollInfo()});var Ft=Ie.bottom-je;if(Ft>0){var ht=Ie.bottom-Ie.top,Zt=le.top-(le.bottom-Ie.top);if(Zt-ht>0)re.style.top=(Je=le.top-ht-tt)+"px",Qe=!1;else if(ht>je){re.style.height=je-5+"px",re.style.top=(Je=le.bottom-Ie.top-tt)+"px";var Qt=ie.getCursor();Z.from.ch!=Qt.ch&&(le=ie.cursorCoords(Qt),re.style.left=(Ze=le.left-rt)+"px",Ie=re.getBoundingClientRect())}}var Bt=Ie.right-at;if(nt&&(Bt+=ie.display.nativeBarWidth),Bt>0&&(Ie.right-Ie.left>at&&(re.style.width=at-5+"px",Bt-=Ie.right-Ie.left-at),re.style.left=(Ze=le.left-Bt-rt)+"px"),nt)for(var _t=re.firstChild;_t;_t=_t.nextSibling)_t.style.paddingRight=ie.display.nativeBarWidth+"px";if(ie.addKeyMap(this.keyMap=F(O,{moveFocus:function(Gt,Yt){K.changeActive(K.selectedHint+Gt,Yt)},setFocus:function(Gt){K.changeActive(Gt)},menuSize:function(){return K.screenAmount()},length:ve.length,close:function(){O.close()},pick:function(){K.pick()},data:Z})),O.options.closeOnUnfocus){var $t;ie.on("blur",this.onBlur=function(){$t=setTimeout(function(){O.close()},100)}),ie.on("focus",this.onFocus=function(){clearTimeout($t)})}ie.on("scroll",this.onScroll=function(){var Gt=ie.getScrollInfo(),Yt=ie.getWrapperElement().getBoundingClientRect();pt||(pt=ie.getScrollInfo());var yn=Je+pt.top-Gt.top,xe=yn-(te.pageYOffset||(de.documentElement||de.body).scrollTop);if(Qe||(xe+=re.offsetHeight),xe<=Yt.top||xe>=Yt.bottom)return O.close();re.style.top=yn+"px",re.style.left=Ze+pt.left-Gt.left+"px"}),e.on(re,"dblclick",function(Gt){var Yt=S(re,Gt.target||Gt.srcElement);Yt&&Yt.hintId!=null&&(K.changeActive(Yt.hintId),K.pick())}),e.on(re,"click",function(Gt){var Yt=S(re,Gt.target||Gt.srcElement);Yt&&Yt.hintId!=null&&(K.changeActive(Yt.hintId),O.options.completeOnSingleClick&&K.pick())}),e.on(re,"mousedown",function(){setTimeout(function(){ie.focus()},20)});var rn=this.getSelectedHintRange();return(rn.from!==0||rn.to!==0)&&this.scrollToActive(),e.signal(Z,"select",ve[this.selectedHint],re.childNodes[this.selectedHint]),!0}k.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode&&this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var O=this.completion.cm.getInputField();O.removeAttribute("aria-activedescendant"),O.removeAttribute("aria-owns");var Z=this.completion.cm;this.completion.options.closeOnUnfocus&&(Z.off("blur",this.onBlur),Z.off("focus",this.onFocus)),Z.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var O=this;this.keyMap={Enter:function(){O.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(O,Z){if(O>=this.data.list.length?O=Z?this.data.list.length-1:0:O<0&&(O=Z?0:this.data.list.length-1),this.selectedHint!=O){var K=this.hints.childNodes[this.selectedHint];K&&(K.className=K.className.replace(" "+o,""),K.removeAttribute("aria-selected")),K=this.hints.childNodes[this.selectedHint=O],K.className+=" "+o,K.setAttribute("aria-selected","true"),this.completion.cm.getInputField().setAttribute("aria-activedescendant",K.id),this.scrollToActive(),e.signal(this.data,"select",this.data.list[this.selectedHint],K)}},scrollToActive:function(){var O=this.getSelectedHintRange(),Z=this.hints.childNodes[O.from],K=this.hints.childNodes[O.to],ie=this.hints.firstChild;Z.offsetTop<this.hints.scrollTop?this.hints.scrollTop=Z.offsetTop-ie.offsetTop:K.offsetTop+K.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=K.offsetTop+K.offsetHeight-this.hints.clientHeight+ie.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1},getSelectedHintRange:function(){var O=this.completion.options.scrollMargin||0;return{from:Math.max(0,this.selectedHint-O),to:Math.min(this.data.list.length-1,this.selectedHint+O)}}};function N(O,Z){if(!O.somethingSelected())return Z;for(var K=[],ie=0;ie<Z.length;ie++)Z[ie].supportsSelection&&K.push(Z[ie]);return K}function $(O,Z,K,ie){if(O.async)O(Z,ie,K);else{var de=O(Z,K);de&&de.then?de.then(ie):ie(de)}}function R(O,Z){var K=O.getHelpers(Z,"hint"),ie;if(K.length){var de=function(te,re,ue){var ve=N(te,K);function Ae(Fe){if(Fe==ve.length)return re(null);$(ve[Fe],te,ue,function(we){we&&we.list.length>0?re(we):Ae(Fe+1)})}Ae(0)};return de.async=!0,de.supportsSelection=!0,de}else return(ie=O.getHelper(O.getCursor(),"hintWords"))?function(te){return e.hint.fromList(te,{words:ie})}:e.hint.anyword?function(te,re){return e.hint.anyword(te,re)}:function(){}}e.registerHelper("hint","auto",{resolve:R}),e.registerHelper("hint","fromList",function(O,Z){var K=O.getCursor(),ie=O.getTokenAt(K),de,te=e.Pos(K.line,ie.start),re=K;ie.start<K.ch&&/\w/.test(ie.string.charAt(K.ch-ie.start-1))?de=ie.string.substr(0,K.ch-ie.start):(de="",te=K);for(var ue=[],ve=0;ve<Z.words.length;ve++){var Ae=Z.words[ve];Ae.slice(0,de.length)==de&&ue.push(Ae)}if(ue.length)return{list:ue,from:te,to:re}}),e.commands.autocomplete=e.showHint;var U={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnPick:!0,closeOnUnfocus:!0,updateOnCursorActivity:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null,paddingForScrollbar:!0,moveOnOverlap:!0};e.defineOption("hintOptions",null)}),(function(){let e=window.AudioContext||window.webkitAudioContext;function t(u,f=3,p=2){let g=u.sampleRate,M=g*f,F=u.createBuffer(2,M,g),S=F.getChannelData(0),k=F.getChannelData(1);for(let N=0;N<M;N++){let $=N/M,R=Math.pow(1-$,p);S[N]=(Math.random()*2-1)*R,k[N]=(Math.random()*2-1)*R}return F}class o extends e{constructor(...f){super(...f);let p=this;const g=!window.master_fx;console.log(g?"Intercepted MAIN AudioContext (Seamless Reverb + LFO Mode)":"Intercepted SECONDARY AudioContext");let M=p.createBiquadFilter();M.type="lowshelf",M.frequency.value=320,M.gain.value=0;let F=p.createBiquadFilter();F.type="peaking",F.frequency.value=1e3,F.Q.value=1,F.gain.value=0;let S=p.createBiquadFilter();S.type="highshelf",S.frequency.value=4e3,S.gain.value=0,App.panning=p.createStereoPanner(),App.panning.pan.value=0;let k=p.createOscillator();k.type="sine",k.frequency.value=0;let N=p.createGain();N.gain.value=0,k.connect(N),N.connect(App.panning.pan),k.start();let $=p.createConvolver();$.buffer=t(p);let R=p.createGain();R.gain.value=0;let U=p.createGain();if(U.gain.value=1,M.connect(F),F.connect(S),S.connect(App.panning),App.panning.connect(U),U.connect(super.destination),Object.defineProperty(M,"maxChannelCount",{get:()=>super.destination.maxChannelCount}),Object.defineProperty(p,"destination",{get:()=>M,configurable:!0}),g){let O={timer:null,is_connected:!1};window.master_fx={context:p,nodes:{eq_low:M,eq_mid:F,eq_high:S,panner:App.panning,reverb_gain:R,master_gain:U,lfo:k,lfo_gain:N},set_eq:(Z,K,ie)=>{let de=p.currentTime,te=.1;Z!==void 0&&M.gain.setTargetAtTime(Z,de,te),K!==void 0&&F.gain.setTargetAtTime(K,de,te),ie!==void 0&&S.gain.setTargetAtTime(ie,de,te)},set_volume:Z=>{U.gain.setTargetAtTime(Z,p.currentTime,.1)},set_panning:Z=>{App.panning.pan.setTargetAtTime(Z,p.currentTime+.02,.1)},set_auto_pan:(Z,K)=>{let ie=p.currentTime;k.frequency.setTargetAtTime(Z,ie,.1),N.gain.setTargetAtTime(K,ie,.1)},splash_reverb:(Z=3)=>{let K=p.currentTime,ie=.1,de=.5,te=.5;O.timer&&(clearTimeout(O.timer),O.timer=null),R.gain.cancelScheduledValues(K),O.is_connected||(App.panning.connect($),$.connect(R),R.connect(U),R.gain.setValueAtTime(0,K),O.is_connected=!0),R.gain.linearRampToValueAtTime(te,K+ie);let re=K+Z;R.gain.setValueAtTime(te,re),R.gain.linearRampToValueAtTime(0,re+de),O.timer=setTimeout(()=>{R.disconnect(),$.disconnect(),O.is_connected=!1},(Z+de)*1e3+100)}}}}}window.AudioContext=o,window.webkitAudioContext&&(window.webkitAudioContext=o)})(),typeof globalThis.process>"u"&&(globalThis.process={env:{}}),typeof globalThis.process.env>"u"&&(globalThis.process.env={}),typeof globalThis.process.env.NODE_ENV>"u"&&(globalThis.process.env.NODE_ENV="production");function peg$subclass(e,t){function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o}function peg$SyntaxError(e,t,o,u){var f=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(f,peg$SyntaxError.prototype),f.expected=t,f.found=o,f.location=u,f.name="SyntaxError",f}peg$subclass(peg$SyntaxError,Error);function peg$padEnd(e,t,o){return o=o||" ",e.length>t?e:(t-=e.length,o+=o.repeat(t),e+o.slice(0,t))}peg$SyntaxError.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var o=null,u;for(u=0;u<e.length;u++)if(e[u].source===this.location.source){o=e[u].text.split(/\r\n|\n|\r/g);break}var f=this.location.start,p=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(f):f,g=this.location.source+":"+p.line+":"+p.column;if(o){var M=this.location.end,F=peg$padEnd("",p.line.toString().length," "),S=o[f.line-1],k=f.line===M.line?M.column:S.length+1,N=k-f.column||1;t+=`
 --> `+g+`
`+F+` |
`+p.line+" | "+S+`
`+F+" | "+peg$padEnd("",f.column-1," ")+peg$padEnd("",N,"^")}else t+=`
 at `+g}return t},peg$SyntaxError.buildMessage=function(e,t){var o={literal:function(S){return'"'+f(S.text)+'"'},class:function(S){var k=S.parts.map(function(N){return Array.isArray(N)?p(N[0])+"-"+p(N[1]):p(N)});return"["+(S.inverted?"^":"")+k.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};function u(S){return S.charCodeAt(0).toString(16).toUpperCase()}function f(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(k){return"\\x0"+u(k)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(k){return"\\x"+u(k)})}function p(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(k){return"\\x0"+u(k)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(k){return"\\x"+u(k)})}function g(S){return o[S.type](S)}function M(S){var k=S.map(g),N,$;if(k.sort(),k.length>0){for(N=1,$=1;N<k.length;N++)k[N-1]!==k[N]&&(k[$]=k[N],$++);k.length=$}switch(k.length){case 1:return k[0];case 2:return k[0]+" or "+k[1];default:return k.slice(0,-1).join(", ")+", or "+k[k.length-1]}}function F(S){return S?'"'+f(S)+'"':"end of input"}return"Expected "+M(e)+" but "+F(t)+" found."};function peg$parse(e,t){t=t!==void 0?t:{};var o={},u=t.grammarSource,f={start:Bi},p=Bi,g=".",M="-",F="0",S=",",k="|",N="[",$="]",R="{",U="}",O="%",Z="<",K=">",ie="!",de="(",te=")",re="/",ue="*",ve="?",Ae=":",Fe="..",we="^",Ce="struct",be="target",le="euclid",Ze="slow",Je="rotL",Qe="rotR",rt="fast",tt="scale",kt="//",Lt="cat",Tt="$",ke="setcps",at="setbpm",je="hush",Ie=/^[1-9]/,nt=/^[eE]/,pt=/^[+\-]/,Ft=/^[0-9]/,ht=/^[ \n\r\t\xA0]/,Zt=/^["']/,Qt=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Bt=/^[@_]/,_t=/^[^\n]/,$t=ai("number"),rn=Xt(".",!1),Gt=nr([["1","9"]],!1,!1),Yt=nr(["e","E"],!1,!1),yn=nr(["+","-"],!1,!1),xe=Xt("-",!1),Pe=Xt("0",!1),ye=nr([["0","9"]],!1,!1),Te=ai("whitespace"),He=nr([" ",`
`,"\r","	"," "],!1,!1),et=Xt(",",!1),We=Xt("|",!1),yt=nr(['"',"'"],!1,!1),$e=ai('a letter, a number, "-", "#", ".", "^", "_"'),Ye=nr(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),mt=Xt("[",!1),It=Xt("]",!1),zt=Xt("{",!1),Ue=Xt("}",!1),Et=Xt("%",!1),Ht=Xt("<",!1),Oe=Xt(">",!1),Wt=nr(["@","_"],!1,!1),sn=Xt("!",!1),ot=Xt("(",!1),Pt=Xt(")",!1),Dt=Xt("/",!1),Ut=Xt("*",!1),Kt=Xt("?",!1),ln=Xt(":",!1),hn=Xt("..",!1),B=Xt("^",!1),se=Xt("struct",!1),ee=Xt("target",!1),oe=Xt("euclid",!1),pe=Xt("slow",!1),De=Xt("rotL",!1),Ge=Xt("rotR",!1),Ve=Xt("fast",!1),ut=Xt("scale",!1),Rt=Xt("//",!1),Jt=nr([`
`],!0,!1),fn=Xt("cat",!1),pn=Xt("$",!1),yr=Xt("setcps",!1),Vn=Xt("setbpm",!1),bn=Xt("hush",!1),Sr=function(){return parseFloat(io())},Un=function(I){const ae=I.join("");return ae==="."||ae==="_"},jn=function(I){return new Ns(I.join(""))},Gn=function(I){return I},Zr=function(I,ae){return I.arguments_.stepsPerCycle=ae,I},zr=function(I){return I},on=function(I){return I.arguments_.alignment="polymeter_slowcat",I},ft=function(I){return ae=>ae.options_.weight=(ae.options_.weight??1)+(I??2)-1},Jn=function(I){return ae=>{const _e=(ae.options_.reps??1)+(I??2)-1;ae.options_.reps=_e,ae.options_.ops=ae.options_.ops.filter(Le=>Le.type_!=="replicate"),ae.options_.ops.push({type_:"replicate",arguments_:{amount:_e}}),ae.options_.weight=_e}},Hr=function(I,ae,_e){return Le=>Le.options_.ops.push({type_:"bjorklund",arguments_:{pulse:I,step:ae,rotation:_e}})},En=function(I){return ae=>ae.options_.ops.push({type_:"stretch",arguments_:{amount:I,type:"slow"}})},jt=function(I){return ae=>ae.options_.ops.push({type_:"stretch",arguments_:{amount:I,type:"fast"}})},Qn=function(I){return ae=>ae.options_.ops.push({type_:"degradeBy",arguments_:{amount:I,seed:mi++}})},vr=function(I){return ae=>ae.options_.ops.push({type_:"tail",arguments_:{element:I}})},Ur=function(I){return ae=>ae.options_.ops.push({type_:"range",arguments_:{element:I}})},Be=function(I,ae){const _e=new ur(I,{ops:[],weight:1,reps:1});for(const Le of ae)Le(_e);return _e},q=function(I,ae){return new Lr(ae,"fastcat",void 0,!!I)},ge=function(I){return{alignment:"stack",list:I}},Ne=function(I){return{alignment:"rand",list:I,seed:mi++}},Xe=function(I){return{alignment:"feet",list:I,seed:mi++}},St=function(I,ae){return ae&&ae.list.length>0?new Lr([I,...ae.list],ae.alignment,ae.seed):I},Vt=function(I,ae){return new Lr(ae?[I,...ae.list]:[I],"polymeter")},st=function(I){return I},An=function(I){return{name:"struct",args:{mini:I}}},Rn=function(I){return{name:"target",args:{name:I}}},wr=function(I,ae,_e){return{name:"bjorklund",args:{pulse:I,step:parseInt(ae)}}},er=function(I){return{name:"stretch",args:{amount:I}}},cs=function(I){return{name:"shift",args:{amount:"-"+I}}},fs=function(I){return{name:"shift",args:{amount:I}}},jr=function(I){return{name:"stretch",args:{amount:"1/"+I}}},Ti=function(I){return{name:"scale",args:{scale:I.join("")}}},Ni=function(I,ae){return ae},Li=function(I,ae){return ae.unshift(I),new Lr(ae,"slowcat")},ps=function(I){return I},hs=function(I,ae){return new Gr(I.name,I.args,ae)},ms=function(I){return I},gs=function(I){return I},no=function(I){return new hi("setcps",{value:I})},ro=function(I){return new hi("setcps",{value:I/120/2})},_s=function(){return new hi("hush")},he=t.peg$currPos|0,Nt=he,Dr=[{line:1,column:1}],kn=he,hr=t.peg$maxFailExpected||[],vt=t.peg$silentFails|0,Yr;if(t.startRule){if(!(t.startRule in f))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');p=f[t.startRule]}function io(){return e.substring(Nt,he)}function ys(){return Fr(Nt,he)}function Xt(I,ae){return{type:"literal",text:I,ignoreCase:ae}}function nr(I,ae,_e){return{type:"class",parts:I,inverted:ae,ignoreCase:_e}}function so(){return{type:"end"}}function ai(I){return{type:"other",description:I}}function Gi(I){var ae=Dr[I],_e;if(ae)return ae;if(I>=Dr.length)_e=Dr.length-1;else for(_e=I;!Dr[--_e];);for(ae=Dr[_e],ae={line:ae.line,column:ae.column};_e<I;)e.charCodeAt(_e)===10?(ae.line++,ae.column=1):ae.column++,_e++;return Dr[I]=ae,ae}function Fr(I,ae,_e){var Le=Gi(I),bt=Gi(ae),en={source:u,start:{offset:I,line:Le.line,column:Le.column},end:{offset:ae,line:bt.line,column:bt.column}};return en}function Ct(I){he<kn||(he>kn&&(kn=he,hr=[]),hr.push(I))}function Ri(I,ae,_e){return new peg$SyntaxError(peg$SyntaxError.buildMessage(I,ae),I,ae,_e)}function Bi(){var I;return I=Co(),I}function rr(){var I,ae;return vt++,I=he,$i(),ae=li(),ae!==o?(ao(),Yn(),Nt=I,I=Sr()):(he=I,I=o),vt--,I===o&&vt===0&&Ct($t),I}function ui(){var I;return e.charCodeAt(he)===46?(I=g,he++):(I=o,vt===0&&Ct(rn)),I}function oo(){var I;return I=e.charAt(he),Ie.test(I)?he++:(I=o,vt===0&&Ct(Gt)),I}function vs(){var I;return I=e.charAt(he),nt.test(I)?he++:(I=o,vt===0&&Ct(Yt)),I}function Yn(){var I,ae,_e,Le,bt;if(I=he,ae=vs(),ae!==o){if(_e=e.charAt(he),pt.test(_e)?he++:(_e=o,vt===0&&Ct(yn)),_e===o&&(_e=null),Le=[],bt=Bn(),bt!==o)for(;bt!==o;)Le.push(bt),bt=Bn();else Le=o;Le!==o?(ae=[ae,_e,Le],I=ae):(he=I,I=o)}else he=I,I=o;return I}function ao(){var I,ae,_e,Le;if(I=he,ae=ui(),ae!==o){if(_e=[],Le=Bn(),Le!==o)for(;Le!==o;)_e.push(Le),Le=Bn();else _e=o;_e!==o?(ae=[ae,_e],I=ae):(he=I,I=o)}else he=I,I=o;return I}function li(){var I,ae,_e,Le;if(I=bs(),I===o)if(I=he,ae=oo(),ae!==o){for(_e=[],Le=Bn();Le!==o;)_e.push(Le),Le=Bn();ae=[ae,_e],I=ae}else he=I,I=o;return I}function $i(){var I;return e.charCodeAt(he)===45?(I=M,he++):(I=o,vt===0&&Ct(xe)),I}function bs(){var I;return e.charCodeAt(he)===48?(I=F,he++):(I=o,vt===0&&Ct(Pe)),I}function Bn(){var I;return I=e.charAt(he),Ft.test(I)?he++:(I=o,vt===0&&Ct(ye)),I}function xt(){var I,ae;for(vt++,I=[],ae=e.charAt(he),ht.test(ae)?he++:(ae=o,vt===0&&Ct(He));ae!==o;)I.push(ae),ae=e.charAt(he),ht.test(ae)?he++:(ae=o,vt===0&&Ct(He));return vt--,ae=o,vt===0&&Ct(Te),I}function Tn(){var I,ae,_e,Le;return I=he,ae=xt(),e.charCodeAt(he)===44?(_e=S,he++):(_e=o,vt===0&&Ct(et)),_e!==o?(Le=xt(),ae=[ae,_e,Le],I=ae):(he=I,I=o),I}function Kr(){var I,ae,_e,Le;return I=he,ae=xt(),e.charCodeAt(he)===124?(_e=k,he++):(_e=o,vt===0&&Ct(We)),_e!==o?(Le=xt(),ae=[ae,_e,Le],I=ae):(he=I,I=o),I}function ci(){var I,ae,_e,Le;return I=he,ae=xt(),e.charCodeAt(he)===46?(_e=g,he++):(_e=o,vt===0&&Ct(rn)),_e!==o?(Le=xt(),ae=[ae,_e,Le],I=ae):(he=I,I=o),I}function Kn(){var I;return I=e.charAt(he),Zt.test(I)?he++:(I=o,vt===0&&Ct(yt)),I}function fi(){var I;return vt++,I=e.charAt(he),Qt.test(I)?he++:(I=o,vt===0&&Ct(Ye)),vt--,I===o&&vt===0&&Ct($e),I}function As(){var I,ae,_e,Le;if(I=he,xt(),ae=[],_e=fi(),_e!==o)for(;_e!==o;)ae.push(_e),_e=fi();else ae=o;return ae!==o?(_e=xt(),Nt=he,Le=Un(ae),Le?Le=o:Le=void 0,Le!==o?(Nt=I,I=jn(ae)):(he=I,I=o)):(he=I,I=o),I}function uo(){var I,ae,_e,Le;return I=he,xt(),e.charCodeAt(he)===91?(ae=N,he++):(ae=o,vt===0&&Ct(mt)),ae!==o?(xt(),_e=Ii(),_e!==o?(xt(),e.charCodeAt(he)===93?(Le=$,he++):(Le=o,vt===0&&Ct(It)),Le!==o?(xt(),Nt=I,I=Gn(_e)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function lo(){var I,ae,_e,Le,bt;return I=he,xt(),e.charCodeAt(he)===123?(ae=R,he++):(ae=o,vt===0&&Ct(zt)),ae!==o?(xt(),_e=Nr(),_e!==o?(xt(),e.charCodeAt(he)===125?(Le=U,he++):(Le=o,vt===0&&Ct(Ue)),Le!==o?(bt=Cs(),bt===o&&(bt=null),xt(),Nt=I,I=Zr(_e,bt)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function Cs(){var I,ae,_e;return I=he,e.charCodeAt(he)===37?(ae=O,he++):(ae=o,vt===0&&Ct(Et)),ae!==o?(_e=Er(),_e!==o?(Nt=I,I=zr(_e)):(he=I,I=o)):(he=I,I=o),I}function Ms(){var I,ae,_e,Le;return I=he,xt(),e.charCodeAt(he)===60?(ae=Z,he++):(ae=o,vt===0&&Ct(Ht)),ae!==o?(xt(),_e=Nr(),_e!==o?(xt(),e.charCodeAt(he)===62?(Le=K,he++):(Le=o,vt===0&&Ct(Oe)),Le!==o?(xt(),Nt=I,I=on(_e)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function Er(){var I;return I=As(),I===o&&(I=uo(),I===o&&(I=lo(),I===o&&(I=Ms()))),I}function xs(){var I;return I=co(),I===o&&(I=Ps(),I===o&&(I=po(),I===o&&(I=Ss(),I===o&&(I=fo(),I===o&&(I=pi(),I===o&&(I=kr(),I===o&&(I=ho()))))))),I}function co(){var I,ae,_e;return I=he,xt(),ae=e.charAt(he),Bt.test(ae)?he++:(ae=o,vt===0&&Ct(Wt)),ae!==o?(_e=rr(),_e===o&&(_e=null),Nt=I,I=ft(_e)):(he=I,I=o),I}function fo(){var I,ae,_e;return I=he,xt(),e.charCodeAt(he)===33?(ae=ie,he++):(ae=o,vt===0&&Ct(sn)),ae!==o?(_e=rr(),_e===o&&(_e=null),Nt=I,I=Jn(_e)):(he=I,I=o),I}function Ps(){var I,ae,_e,Le,bt,en,Zn;return I=he,e.charCodeAt(he)===40?(ae=de,he++):(ae=o,vt===0&&Ct(ot)),ae!==o?(xt(),_e=qr(),_e!==o?(xt(),Le=Tn(),Le!==o?(xt(),bt=qr(),bt!==o?(xt(),Tn(),xt(),en=qr(),en===o&&(en=null),xt(),e.charCodeAt(he)===41?(Zn=te,he++):(Zn=o,vt===0&&Ct(Pt)),Zn!==o?(Nt=I,I=Hr(_e,bt,en)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function po(){var I,ae,_e;return I=he,e.charCodeAt(he)===47?(ae=re,he++):(ae=o,vt===0&&Ct(Dt)),ae!==o?(_e=Er(),_e!==o?(Nt=I,I=En(_e)):(he=I,I=o)):(he=I,I=o),I}function Ss(){var I,ae,_e;return I=he,e.charCodeAt(he)===42?(ae=ue,he++):(ae=o,vt===0&&Ct(Ut)),ae!==o?(_e=Er(),_e!==o?(Nt=I,I=jt(_e)):(he=I,I=o)):(he=I,I=o),I}function pi(){var I,ae,_e;return I=he,e.charCodeAt(he)===63?(ae=ve,he++):(ae=o,vt===0&&Ct(Kt)),ae!==o?(_e=rr(),_e===o&&(_e=null),Nt=I,I=Qn(_e)):(he=I,I=o),I}function kr(){var I,ae,_e;return I=he,e.charCodeAt(he)===58?(ae=Ae,he++):(ae=o,vt===0&&Ct(ln)),ae!==o?(_e=Er(),_e!==o?(Nt=I,I=vr(_e)):(he=I,I=o)):(he=I,I=o),I}function ho(){var I,ae,_e;return I=he,e.substr(he,2)===Fe?(ae=Fe,he+=2):(ae=o,vt===0&&Ct(hn)),ae!==o?(_e=Er(),_e!==o?(Nt=I,I=Ur(_e)):(he=I,I=o)):(he=I,I=o),I}function qr(){var I,ae,_e,Le;if(I=he,ae=Er(),ae!==o){for(_e=[],Le=xs();Le!==o;)_e.push(Le),Le=xs();Nt=I,I=Be(ae,_e)}else he=I,I=o;return I}function mr(){var I,ae,_e,Le;if(I=he,e.charCodeAt(he)===94?(ae=we,he++):(ae=o,vt===0&&Ct(B)),ae===o&&(ae=null),_e=[],Le=qr(),Le!==o)for(;Le!==o;)_e.push(Le),Le=qr();else _e=o;return _e!==o?(Nt=I,I=q(ae,_e)):(he=I,I=o),I}function Tr(){var I,ae,_e,Le,bt;if(I=he,ae=[],_e=he,Le=Tn(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o),_e!==o)for(;_e!==o;)ae.push(_e),_e=he,Le=Tn(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o);else ae=o;return ae!==o&&(Nt=I,ae=ge(ae)),I=ae,I}function mn(){var I,ae,_e,Le,bt;if(I=he,ae=[],_e=he,Le=Kr(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o),_e!==o)for(;_e!==o;)ae.push(_e),_e=he,Le=Kr(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o);else ae=o;return ae!==o&&(Nt=I,ae=Ne(ae)),I=ae,I}function mo(){var I,ae,_e,Le,bt;if(I=he,ae=[],_e=he,Le=ci(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o),_e!==o)for(;_e!==o;)ae.push(_e),_e=he,Le=ci(),Le!==o?(bt=mr(),bt!==o?_e=bt:(he=_e,_e=o)):(he=_e,_e=o);else ae=o;return ae!==o&&(Nt=I,ae=Xe(ae)),I=ae,I}function Ii(){var I,ae,_e;return I=he,ae=mr(),ae!==o?(_e=Tr(),_e===o&&(_e=mn(),_e===o&&(_e=mo())),_e===o&&(_e=null),Nt=I,I=St(ae,_e)):(he=I,I=o),I}function Nr(){var I,ae,_e;return I=he,ae=mr(),ae!==o?(_e=Tr(),_e===o&&(_e=null),Nt=I,I=Vt(ae,_e)):(he=I,I=o),I}function go(){var I,ae,_e,Le;return I=he,xt(),ae=Kn(),ae!==o?(xt(),_e=Ii(),_e!==o?(xt(),Le=Kn(),Le!==o?(Nt=I,I=st(_e)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function ws(){var I;return I=bo(),I===o&&(I=yo(),I===o&&(I=Es(),I===o&&(I=Oi(),I===o&&(I=Ds(),I===o&&(I=_o(),I===o&&(I=Fs(),I===o&&(I=vo()))))))),I}function _o(){var I,ae,_e;return I=he,e.substr(he,6)===Ce?(ae=Ce,he+=6):(ae=o,vt===0&&Ct(se)),ae!==o?(xt(),_e=gr(),_e!==o?(Nt=I,I=An(_e)):(he=I,I=o)):(he=I,I=o),I}function Oi(){var I,ae,_e,Le,bt;return I=he,e.substr(he,6)===be?(ae=be,he+=6):(ae=o,vt===0&&Ct(ee)),ae!==o?(xt(),_e=Kn(),_e!==o?(Le=As(),Le!==o?(bt=Kn(),bt!==o?(Nt=I,I=Rn(Le)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function Ds(){var I,ae,_e,Le;return I=he,e.substr(he,6)===le?(ae=le,he+=6):(ae=o,vt===0&&Ct(oe)),ae!==o?(xt(),_e=li(),_e!==o?(xt(),Le=li(),Le!==o?(xt(),li(),Nt=I,I=wr(_e,Le)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o),I}function yo(){var I,ae,_e;return I=he,e.substr(he,4)===Ze?(ae=Ze,he+=4):(ae=o,vt===0&&Ct(pe)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=er(_e)):(he=I,I=o)):(he=I,I=o),I}function vo(){var I,ae,_e;return I=he,e.substr(he,4)===Je?(ae=Je,he+=4):(ae=o,vt===0&&Ct(De)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=cs(_e)):(he=I,I=o)):(he=I,I=o),I}function Fs(){var I,ae,_e;return I=he,e.substr(he,4)===Qe?(ae=Qe,he+=4):(ae=o,vt===0&&Ct(Ge)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=fs(_e)):(he=I,I=o)):(he=I,I=o),I}function Es(){var I,ae,_e;return I=he,e.substr(he,4)===rt?(ae=rt,he+=4):(ae=o,vt===0&&Ct(Ve)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=jr(_e)):(he=I,I=o)):(he=I,I=o),I}function bo(){var I,ae,_e,Le,bt;if(I=he,e.substr(he,5)===tt?(ae=tt,he+=5):(ae=o,vt===0&&Ct(ut)),ae!==o)if(xt(),_e=Kn(),_e!==o){if(Le=[],bt=fi(),bt!==o)for(;bt!==o;)Le.push(bt),bt=fi();else Le=o;Le!==o?(bt=Kn(),bt!==o?(Nt=I,I=Ti(Le)):(he=I,I=o)):(he=I,I=o)}else he=I,I=o;else he=I,I=o;return I}function br(){var I,ae,_e,Le;if(I=he,e.substr(he,2)===kt?(ae=kt,he+=2):(ae=o,vt===0&&Ct(Rt)),ae!==o){for(_e=[],Le=e.charAt(he),_t.test(Le)?he++:(Le=o,vt===0&&Ct(Jt));Le!==o;)_e.push(Le),Le=e.charAt(he),_t.test(Le)?he++:(Le=o,vt===0&&Ct(Jt));ae=[ae,_e],I=ae}else he=I,I=o;return I}function lr(){var I,ae,_e,Le,bt,en,Zn,Cr;if(I=he,e.substr(he,3)===Lt?(ae=Lt,he+=3):(ae=o,vt===0&&Ct(fn)),ae!==o)if(xt(),e.charCodeAt(he)===91?(_e=N,he++):(_e=o,vt===0&&Ct(mt)),_e!==o)if(xt(),Le=gr(),Le!==o){for(bt=[],en=he,Zn=Tn(),Zn!==o?(Cr=gr(),Cr!==o?(Nt=en,en=Ni(Le,Cr)):(he=en,en=o)):(he=en,en=o);en!==o;)bt.push(en),en=he,Zn=Tn(),Zn!==o?(Cr=gr(),Cr!==o?(Nt=en,en=Ni(Le,Cr)):(he=en,en=o)):(he=en,en=o);en=xt(),e.charCodeAt(he)===93?(Zn=$,he++):(Zn=o,vt===0&&Ct(It)),Zn!==o?(Nt=I,I=Li(Le,bt)):(he=I,I=o)}else he=I,I=o;else he=I,I=o;else he=I,I=o;return I}function di(){var I;return I=lr(),I===o&&(I=go()),I}function gr(){var I,ae,_e,Le,bt;if(I=he,ae=di(),ae!==o){for(xt(),_e=[],Le=br();Le!==o;)_e.push(Le),Le=br();Nt=I,I=ps(ae)}else he=I,I=o;return I===o&&(I=he,ae=ws(),ae!==o?(xt(),e.charCodeAt(he)===36?(_e=Tt,he++):(_e=o,vt===0&&Ct(pn)),_e!==o?(Le=xt(),bt=gr(),bt!==o?(Nt=I,I=hs(ae,bt)):(he=I,I=o)):(he=I,I=o)):(he=I,I=o)),I}function ks(){var I,ae;return I=he,ae=gr(),ae!==o&&(Nt=I,ae=ms(ae)),I=ae,I===o&&(I=br()),I}function sr(){var I;return I=ks(),I}function Ar(){var I,ae;return I=he,xt(),ae=Wi(),ae===o&&(ae=Ao(),ae===o&&(ae=Ts())),ae!==o?(xt(),Nt=I,I=gs(ae)):(he=I,I=o),I}function Wi(){var I,ae,_e;return I=he,e.substr(he,6)===ke?(ae=ke,he+=6):(ae=o,vt===0&&Ct(yr)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=no(_e)):(he=I,I=o)):(he=I,I=o),I}function Ao(){var I,ae,_e;return I=he,e.substr(he,6)===at?(ae=at,he+=6):(ae=o,vt===0&&Ct(Vn)),ae!==o?(xt(),_e=rr(),_e!==o?(Nt=I,I=ro(_e)):(he=I,I=o)):(he=I,I=o),I}function Ts(){var I,ae;return I=he,e.substr(he,4)===je?(ae=je,he+=4):(ae=o,vt===0&&Ct(bn)),ae!==o&&(Nt=I,ae=_s()),I=ae,I}function Co(){var I;return I=sr(),I===o&&(I=Ar()),I}var Ns=function(I){this.type_="atom",this.source_=I,this.location_=ys()},Lr=function(I,ae,_e,Le){this.type_="pattern",this.arguments_={alignment:ae,_steps:Le},_e!==void 0&&(this.arguments_.seed=_e),this.source_=I},Gr=function(I,ae,_e){this.type_=I,this.arguments_=ae,this.source_=_e},ur=function(I,ae){this.type_="element",this.source_=I,this.options_=ae,this.location_=ys()},hi=function(I,ae){this.type_="command",this.name_=I,this.options_=ae},mi=0;if(Yr=p(),t.peg$library)return{peg$result:Yr,peg$currPos:he,peg$FAILED:o,peg$maxFailExpected:hr,peg$maxFailPos:kn};if(Yr!==o&&he===e.length)return Yr;throw Yr!==o&&he<e.length&&Ct(so()),Ri(hr,kn<e.length?e.charAt(kn):null,kn<e.length?Fr(kn,kn+1):Fr(kn,kn))}const peg$allowedStartRules=["start"];typeof BigInt>"u"&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const C_ZERO=BigInt(0),C_ONE=BigInt(1),C_TWO=BigInt(2),C_FIVE=BigInt(5),C_TEN=BigInt(10),MAX_CYCLE_LEN=2e3,P={s:C_ONE,n:C_ZERO,d:C_ONE};function assign(e,t){try{e=BigInt(e)}catch{throw InvalidParameter()}return e*t}function trunc(e){return typeof e=="bigint"?e:Math.floor(e)}function newFraction(e,t){if(t===C_ZERO)throw DivisionByZero();const o=Object.create(Fraction$1.prototype);o.s=e<C_ZERO?-C_ONE:C_ONE,e=e<C_ZERO?-e:e;const u=gcd$1(e,t);return o.n=e/u,o.d=t/u,o}function factorize(e){const t={};let o=e,u=C_TWO,f=C_FIVE-C_ONE;for(;f<=o;){for(;o%u===C_ZERO;)o/=u,t[u]=(t[u]||C_ZERO)+C_ONE;f+=C_ONE+C_TWO*u++}return o!==e?o>1&&(t[o]=(t[o]||C_ZERO)+C_ONE):t[e]=(t[e]||C_ZERO)+C_ONE,t}const parse$b=function(e,t){let o=C_ZERO,u=C_ONE,f=C_ONE;if(e!=null)if(t!==void 0){if(typeof e=="bigint")o=e;else{if(isNaN(e))throw InvalidParameter();if(e%1!==0)throw NonIntegerParameter();o=BigInt(e)}if(typeof t=="bigint")u=t;else{if(isNaN(t))throw InvalidParameter();if(t%1!==0)throw NonIntegerParameter();u=BigInt(t)}f=o*u}else if(typeof e=="object"){if("d"in e&&"n"in e)o=BigInt(e.n),u=BigInt(e.d),"s"in e&&(o*=BigInt(e.s));else if(0 in e)o=BigInt(e[0]),1 in e&&(u=BigInt(e[1]));else if(typeof e=="bigint")o=e;else throw InvalidParameter();f=o*u}else if(typeof e=="number"){if(isNaN(e))throw InvalidParameter();if(e<0&&(f=-C_ONE,e=-e),e%1===0)o=BigInt(e);else if(e>0){let p=1,g=0,M=1,F=1,S=1,k=1e7;for(e>=1&&(p=10**Math.floor(1+Math.log10(e)),e/=p);M<=k&&S<=k;){let N=(g+F)/(M+S);if(e===N){M+S<=k?(o=g+F,u=M+S):S>M?(o=F,u=S):(o=g,u=M);break}else e>N?(g+=F,M+=S):(F+=g,S+=M),M>k?(o=F,u=S):(o=g,u=M)}o=BigInt(o)*BigInt(p),u=BigInt(u)}}else if(typeof e=="string"){let p=0,g=C_ZERO,M=C_ZERO,F=C_ZERO,S=C_ONE,k=C_ONE,N=e.replace(/_/g,"").match(/\d+|./g);if(N===null)throw InvalidParameter();if(N[p]==="-"?(f=-C_ONE,p++):N[p]==="+"&&p++,N.length===p+1?M=assign(N[p++],f):N[p+1]==="."||N[p]==="."?(N[p]!=="."&&(g=assign(N[p++],f)),p++,(p+1===N.length||N[p+1]==="("&&N[p+3]===")"||N[p+1]==="'"&&N[p+3]==="'")&&(M=assign(N[p],f),S=C_TEN**BigInt(N[p].length),p++),(N[p]==="("&&N[p+2]===")"||N[p]==="'"&&N[p+2]==="'")&&(F=assign(N[p+1],f),k=C_TEN**BigInt(N[p+1].length)-C_ONE,p+=3)):N[p+1]==="/"||N[p+1]===":"?(M=assign(N[p],f),S=assign(N[p+2],C_ONE),p+=3):N[p+3]==="/"&&N[p+1]===" "&&(g=assign(N[p],f),M=assign(N[p+2],f),S=assign(N[p+4],C_ONE),p+=5),N.length<=p)u=S*k,f=o=F+u*g+k*M;else throw InvalidParameter()}else if(typeof e=="bigint")o=e,f=e,u=C_ONE;else throw InvalidParameter();if(u===C_ZERO)throw DivisionByZero();P.s=f<C_ZERO?-C_ONE:C_ONE,P.n=o<C_ZERO?-o:o,P.d=u<C_ZERO?-u:u};function modpow(e,t,o){let u=C_ONE;for(;t>C_ZERO;e=e*e%o,t>>=C_ONE)t&C_ONE&&(u=u*e%o);return u}function cycleLen(e,t){for(;t%C_TWO===C_ZERO;t/=C_TWO);for(;t%C_FIVE===C_ZERO;t/=C_FIVE);if(t===C_ONE)return C_ZERO;let o=C_TEN%t,u=1;for(;o!==C_ONE;u++)if(o=o*C_TEN%t,u>MAX_CYCLE_LEN)return C_ZERO;return BigInt(u)}function cycleStart(e,t,o){let u=C_ONE,f=modpow(C_TEN,o,t);for(let p=0;p<300;p++){if(u===f)return BigInt(p);u=u*C_TEN%t,f=f*C_TEN%t}return 0}function gcd$1(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function Fraction$1(e,t){if(parse$b(e,t),this instanceof Fraction$1)e=gcd$1(P.d,P.n),this.s=P.s,this.n=P.n/e,this.d=P.d/e;else return newFraction(P.s*P.n,P.d)}var DivisionByZero=function(){return new Error("Division by Zero")},InvalidParameter=function(){return new Error("Invalid argument")},NonIntegerParameter=function(){return new Error("Parameters must be integer")};Fraction$1.prototype={s:C_ONE,n:C_ZERO,d:C_ONE,abs:function(){return newFraction(this.n,this.d)},neg:function(){return newFraction(-this.s*this.n,this.d)},add:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d+P.s*this.d*P.n,this.d*P.d)},sub:function(e,t){return parse$b(e,t),newFraction(this.s*this.n*P.d-P.s*this.d*P.n,this.d*P.d)},mul:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.n,this.d*P.d)},div:function(e,t){return parse$b(e,t),newFraction(this.s*P.s*this.n*P.d,this.d*P.n)},clone:function(){return newFraction(this.s*this.n,this.d)},mod:function(e,t){if(e===void 0)return newFraction(this.s*this.n%this.d,C_ONE);if(parse$b(e,t),C_ZERO===P.n*this.d)throw DivisionByZero();return newFraction(this.s*(P.d*this.n)%(P.n*this.d),P.d*this.d)},gcd:function(e,t){return parse$b(e,t),newFraction(gcd$1(P.n,this.n)*gcd$1(P.d,this.d),P.d*this.d)},lcm:function(e,t){return parse$b(e,t),P.n===C_ZERO&&this.n===C_ZERO?newFraction(C_ZERO,C_ONE):newFraction(P.n*this.n,gcd$1(P.n,this.n)*gcd$1(P.d,this.d))},inverse:function(){return newFraction(this.s*this.d,this.n)},pow:function(e,t){if(parse$b(e,t),P.d===C_ONE)return P.s<C_ZERO?newFraction((this.s*this.d)**P.n,this.n**P.n):newFraction((this.s*this.n)**P.n,this.d**P.n);if(this.s<C_ZERO)return null;let o=factorize(this.n),u=factorize(this.d),f=C_ONE,p=C_ONE;for(let g in o)if(g!=="1"){if(g==="0"){f=C_ZERO;break}if(o[g]*=P.n,o[g]%P.d===C_ZERO)o[g]/=P.d;else return null;f*=BigInt(g)**o[g]}for(let g in u)if(g!=="1"){if(u[g]*=P.n,u[g]%P.d===C_ZERO)u[g]/=P.d;else return null;p*=BigInt(g)**u[g]}return P.s<C_ZERO?newFraction(p,f):newFraction(f,p)},log:function(e,t){if(parse$b(e,t),this.s<=C_ZERO||P.s<=C_ZERO)return null;const o={},u=factorize(P.n),f=factorize(P.d),p=factorize(this.n),g=factorize(this.d);for(const S in f)u[S]=(u[S]||C_ZERO)-f[S];for(const S in g)p[S]=(p[S]||C_ZERO)-g[S];for(const S in u)S!=="1"&&(o[S]=!0);for(const S in p)S!=="1"&&(o[S]=!0);let M=null,F=null;for(const S in o){const k=u[S]||C_ZERO,N=p[S]||C_ZERO;if(k===C_ZERO){if(N!==C_ZERO)return null;continue}let $=N,R=k;const U=gcd$1($,R);if($/=U,R/=U,M===null&&F===null)M=$,F=R;else if($*F!==M*R)return null}return M!==null&&F!==null?newFraction(M,F):null},equals:function(e,t){return parse$b(e,t),this.s*this.n*P.d===P.s*P.n*this.d},lt:function(e,t){return parse$b(e,t),this.s*this.n*P.d<P.s*P.n*this.d},lte:function(e,t){return parse$b(e,t),this.s*this.n*P.d<=P.s*P.n*this.d},gt:function(e,t){return parse$b(e,t),this.s*this.n*P.d>P.s*P.n*this.d},gte:function(e,t){return parse$b(e,t),this.s*this.n*P.d>=P.s*P.n*this.d},compare:function(e,t){parse$b(e,t);let o=this.s*this.n*P.d-P.s*P.n*this.d;return(C_ZERO<o)-(o<C_ZERO)},ceil:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+(e*this.n%this.d>C_ZERO&&this.s>=C_ZERO?C_ONE:C_ZERO),e)},floor:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)-(e*this.n%this.d>C_ZERO&&this.s<C_ZERO?C_ONE:C_ZERO),e)},round:function(e){return e=C_TEN**BigInt(e||0),newFraction(trunc(this.s*e*this.n/this.d)+this.s*((this.s>=C_ZERO?C_ONE:C_ZERO)+C_TWO*(e*this.n%this.d)>this.d?C_ONE:C_ZERO),e)},roundTo:function(e,t){parse$b(e,t);const o=this.n*P.d,u=this.d*P.n,f=o%u;let p=trunc(o/u);return f+f>=u&&p++,newFraction(this.s*p*P.n,P.d)},divisible:function(e,t){return parse$b(e,t),!(!(P.n*this.d)||this.n*P.d%(P.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,o=this.d;e=e||15;let u=cycleLen(t,o),f=cycleStart(t,o,u),p=this.s<C_ZERO?"-":"";if(p+=trunc(t/o),t%=o,t*=C_TEN,t&&(p+="."),u){for(let g=f;g--;)p+=trunc(t/o),t%=o,t*=C_TEN;p+="(";for(let g=u;g--;)p+=trunc(t/o),t%=o,t*=C_TEN;p+=")"}else for(let g=e;t&&g--;)p+=trunc(t/o),t%=o,t*=C_TEN;return p},toFraction:function(e){let t=this.n,o=this.d,u=this.s<C_ZERO?"-":"";if(o===C_ONE)u+=t;else{let f=trunc(t/o);e&&f>C_ZERO&&(u+=f,u+=" ",t%=o),u+=t,u+="/",u+=o}return u},toLatex:function(e){let t=this.n,o=this.d,u=this.s<C_ZERO?"-":"";if(o===C_ONE)u+=t;else{let f=trunc(t/o);e&&f>C_ZERO&&(u+=f,t%=o),u+="\\frac{",u+=t,u+="}{",u+=o,u+="}"}return u},toContinued:function(){let e=this.n,t=this.d,o=[];do{o.push(trunc(e/t));let u=e%t;e=t,t=u}while(e!==C_ONE);return o},simplify:function(e){const t=BigInt(1/(e||.001)|0),o=this.abs(),u=o.toContinued();for(let f=1;f<u.length;f++){let p=newFraction(u[f-1],C_ONE);for(let M=f-2;M>=0;M--)p=p.inverse().add(u[M]);let g=p.sub(o);if(g.n*t<g.d)return p.mul(this.s)}return this}};const logKey="strudel.log";let debounce=1e3,lastMessage,lastTime;function errorLogger$1(e,t="cyclist"){process.env.NODE_ENV==="development"&&console.error(e),logger$2(`[${t}] error: ${e.message}`)}function logger$2(e,t,o={}){let u=performance.now();lastMessage===e&&u-lastTime<debounce||(lastMessage=e,lastTime=u,console.log(`%c${e}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(logKey,{detail:{message:e,type:t,data:o}})))}logger$2.key=logKey;const isNoteWithOctave=e=>/^[a-gA-G][#bsf]*[0-9]*$/.test(e),isNote=e=>/^[a-gA-G][#bsf]*-?[0-9]*$/.test(e),tokenizeNote$3=e=>{if(typeof e!="string")return[];const[t,o="",u]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,u?Number(u):void 0]:[]},chromas$2={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$2={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset$1=e=>e?.split("").reduce((t,o)=>t+accs$2[o],0)||0,noteToMidi$1=(e,t=3)=>{const[o,u,f=t]=tokenizeNote$3(e);if(!o)throw new Error('not a note: "'+e+'"');const p=chromas$2[o.toLowerCase()],g=getAccidentalsOffset$1(u);return(Number(f)+1)*12+p+g},midiToFreq$2=e=>Math.pow(2,(e-69)/12)*440,freqToMidi$2=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi$1=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:u}=e;if(typeof o=="number")return freqToMidi$2(o);if(typeof u=="string")return noteToMidi$1(u);if(typeof u=="number")return u;if(!t)throw new Error("valueToMidi: expected freq or note to be set");return t},getEventOffsetMs=(e,t)=>(e-t)*1e3,getFreq=e=>midiToFreq$2(typeof e=="number"?e:noteToMidi$1(e)),pcs$1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],midi2note$1=e=>{const t=Math.floor(e/12)-1;return pcs$1[e%12]+t},_mod$2=(e,t)=>(e%t+t)%t,averageArray=e=>e.reduce((t,o)=>t+o)/e.length;function nanFallback$1(e,t=0){return isNaN(Number(e))?(logger$2(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const getSoundIndex$1=(e,t)=>_mod$2(Math.round(nanFallback$1(e??0,0)),t),getPlayableNoteValue=e=>{let{value:t,context:o}=e,u=t;if(typeof u=="object"&&!Array.isArray(u)&&(u=u.note||u.n||u.value,u===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(t)}`);if(typeof u=="number"&&o.type!=="frequency")u=midiToFreq$2(e.value);else if(typeof u=="number"&&o.type==="frequency")u=e.value;else if(typeof u!="string"||!isNote(u))throw new Error("not a note: "+JSON.stringify(u));return u},getFrequency=e=>{let{value:t,context:o}=e;if(typeof t=="object")return t.freq?t.freq:getFreq(t.note||t.n||t.value);if(typeof t=="number"&&o.type!=="frequency")t=midiToFreq$2(e.value);else if(typeof t=="string"&&isNote(t))t=midiToFreq$2(noteToMidi$1(e.value));else if(typeof t!="number")throw new Error("not a note or frequency: "+t);return t},rotate$2=(e,t)=>e.slice(t).concat(e.slice(0,t)),pipe=(...e)=>e.reduce((t,o)=>(...u)=>t(o(...u)),t=>t),compose=(...e)=>pipe(...e.reverse()),removeUndefineds=e=>e.filter(t=>t!=null),flatten=e=>[].concat(...e),id=e=>e,constant=(e,t)=>e,listRange=(e,t)=>Array.from({length:t-e+1},(o,u)=>u+e);function curry(e,t,o=e.length){const u=function f(...p){if(p.length>=o)return e.apply(this,p);{const g=function(...M){return f.apply(this,p.concat(M))};return t&&t(g,p),g}};return t&&t(u,[]),u}function parseNumeral(e){const t=Number(e);if(!isNaN(t))return t;if(isNote(e))return noteToMidi$1(e);throw new Error(`cannot parse as numeral: "${e}"`)}function mapArgs(e,t){return(...o)=>e(...o.map(t))}function numeralArgs(e){return mapArgs(e,parseNumeral)}function parseFractional(e){const t=Number(e);if(!isNaN(t))return t;const o={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[e];if(typeof o<"u")return o;throw new Error(`cannot parse as fractional: "${e}"`)}const fractionalArgs=e=>mapArgs(e,parseFractional),splitAt=function(e,t){return[t.slice(0,e),t.slice(e)]},zipWith=(e,t,o)=>t.map((u,f)=>e(u,o[f])),pairs=function(e){const t=[];for(let o=0;o<e.length-1;++o)t.push([e[o],e[o+1]]);return t},clamp$1=(e,t,o)=>Math.min(Math.max(e,t),o),solfeggio=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],indian=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],german=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],byzantine=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],japanese=["I","Ro","Ha","Ni","Ho","He","To"],english=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],sol2note=(e,t="letters")=>{const u=(t==="solfeggio"?solfeggio:t==="indian"?indian:t==="german"?german:t==="byzantine"?byzantine:t==="japanese"?japanese:english)[e%12],f=Math.floor(e/12)-1;return u+f};function uniq(e){var t={};return e.filter(function(o){return t.hasOwn(o)?!1:t[o]=!0})}function uniqsort(e){return e.sort().filter(function(t,o,u){return!o||t!=u[o-1]})}function uniqsortr(e){return e.sort((t,o)=>t.compare(o)).filter(function(t,o,u){return!o||t.ne(u[o-1])})}function unicodeToBase64(e){const t=new TextEncoder().encode(e);return btoa(String.fromCharCode(...t))}function base64ToUnicode(e){const t=new Uint8Array(atob(e).split("").map(u=>u.charCodeAt(0)));return new TextDecoder().decode(t)}function code2hash(e){return encodeURIComponent(unicodeToBase64(e))}function hash2code(e){return base64ToUnicode(decodeURIComponent(e))}function objectMap(e,t){return Array.isArray(e)?e.map(t):Object.fromEntries(Object.entries(e).map(([o,u],f)=>[o,t(u,o,f)]))}function cycleToSeconds$1(e,t){return e/t}class ClockCollator{constructor({getTargetClockTime:t=getUnixTimeSeconds,weight:o=16,offsetDelta:u=.005,checkAfterTime:f=2,resetAfterTime:p=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=t,this.weight=o,this.offsetDelta=u,this.checkAfterTime=f,this.resetAfterTime=p,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(t){const o=this.getTargetClockTime(),u=o-this.timeAtPrevOffsetSample,f=o-t;if(u>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=f),this.prevOffsetTimes.push(f),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||u>this.checkAfterTime){this.timeAtPrevOffsetSample=o;const p=averageArray(this.prevOffsetTimes);Math.abs(p-this.offsetTime)>this.offsetDelta&&(this.offsetTime=p)}return this.offsetTime}calculateTimestamp(t,o){return this.calculateOffset(t)+o}}function getPerformanceTimeSeconds(){return performance.now()*.001}function getUnixTimeSeconds(){return Date.now()*.001}const keyAlias=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let keyState;function getCurrentKeyboardState(){if(keyState==null){if(typeof window>"u")return;keyState={},window.addEventListener("keydown",e=>{keyState[e.key]=!0}),window.addEventListener("keyup",e=>{keyState[e.key]=!1})}return{...keyState}}function stringifyValues(e,t=!1){return typeof e=="object"?t?JSON.stringify(e).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(e):e}Fraction$1.prototype.sam=function(){return this.floor()},Fraction$1.prototype.nextSam=function(){return this.sam().add(1)},Fraction$1.prototype.wholeCycle=function(){return new TimeSpan(this.sam(),this.nextSam())},Fraction$1.prototype.cyclePos=function(){return this.sub(this.sam())},Fraction$1.prototype.lt=function(e){return this.compare(e)<0},Fraction$1.prototype.gt=function(e){return this.compare(e)>0},Fraction$1.prototype.lte=function(e){return this.compare(e)<=0},Fraction$1.prototype.gte=function(e){return this.compare(e)>=0},Fraction$1.prototype.eq=function(e){return this.compare(e)==0},Fraction$1.prototype.ne=function(e){return this.compare(e)!=0},Fraction$1.prototype.max=function(e){return this.gt(e)?this:e},Fraction$1.prototype.maximum=function(...e){return e=e.map(t=>new Fraction$1(t)),e.reduce((t,o)=>o.max(t),this)},Fraction$1.prototype.min=function(e){return this.lt(e)?this:e},Fraction$1.prototype.mulmaybe=function(e){return e!==void 0?this.mul(e):void 0},Fraction$1.prototype.divmaybe=function(e){return e!==void 0?this.div(e):void 0},Fraction$1.prototype.addmaybe=function(e){return e!==void 0?this.add(e):void 0},Fraction$1.prototype.submaybe=function(e){return e!==void 0?this.sub(e):void 0},Fraction$1.prototype.show=function(){return this.s*this.n+"/"+this.d},Fraction$1.prototype.or=function(e){return this.eq(0)?e:this};const fraction$1=e=>Fraction$1(e),gcd=(...e)=>{if(e=removeUndefineds(e),e.length!==0)return e.reduce((t,o)=>t.gcd(o),fraction$1(1))},lcm=(...e)=>{if(e=removeUndefineds(e),e.length===0)return;const t=e.pop();return e.reduce((o,u)=>o===void 0||u===void 0?void 0:o.lcm(u),t)},isFraction=e=>e instanceof Fraction$1;fraction$1._original=Fraction$1;const Fraction=fraction$1;class TimeSpan{constructor(t,o){this.begin=Fraction(t),this.end=Fraction(o)}get spanCycles(){const t=[];var o=this.begin;const u=this.end,f=u.sam();if(o.equals(u))return[new TimeSpan(o,u)];for(;u.gt(o);){if(o.sam().equals(f)){t.push(new TimeSpan(o,this.end));break}const p=o.nextSam();t.push(new TimeSpan(o,p)),o=p}return t}get duration(){return this.end.sub(this.begin)}cycleArc(){const t=this.begin.cyclePos(),o=t.add(this.duration);return new TimeSpan(t,o)}withTime(t){return new TimeSpan(t(this.begin),t(this.end))}withEnd(t){return new TimeSpan(this.begin,t(this.end))}withCycle(t){const o=this.begin.sam(),u=o.add(t(this.begin.sub(o))),f=o.add(t(this.end.sub(o)));return new TimeSpan(u,f)}intersection(t){const o=this.begin.max(t.begin),u=this.end.min(t.end);if(!o.gt(u)&&!(o.equals(u)&&(o.equals(this.end)&&this.begin.lt(this.end)||o.equals(t.end)&&t.begin.lt(t.end))))return new TimeSpan(o,u)}intersection_e(t){const o=this.intersection(t);if(o==null)throw"TimeSpans do not intersect";return o}midpoint(){return this.begin.add(this.duration.div(Fraction(2)))}equals(t){return this.begin.equals(t.begin)&&this.end.equals(t.end)}show(){return this.begin.show()+" → "+this.end.show()}}class Hap{constructor(t,o,u,f={},p=!1){this.whole=t,this.part=o,this.value=u,this.context=f,this.stateful=p,p&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){let t;return typeof this.value?.duration=="number"?t=Fraction(this.value.duration):t=this.whole.end.sub(this.whole.begin),typeof this.value?.clip=="number"?t.mul(this.value.clip):t}get endClipped(){return this.whole.begin.add(this.duration)}isActive(t){return this.whole.begin<=t&&this.endClipped>=t}isInPast(t){return t>this.endClipped}isInNearPast(t,o){return o-t<=this.endClipped}isInFuture(t){return t<this.whole.begin}isInNearFuture(t,o){return o<this.whole.begin&&o>this.whole.begin-t}isWithinTime(t,o){return this.whole.begin<=o&&this.endClipped>=t}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(t){const o=this.whole?t(this.whole):void 0;return new Hap(o,t(this.part),this.value,this.context)}withValue(t){return new Hap(this.whole,this.part,t(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(t){return this.context.tags?.includes(t)}resolveState(t){if(this.stateful&&this.hasOnset()){console.log("stateful");const o=this.value,[u,f]=o(t);return[u,new Hap(this.whole,this.part,f,this.context,!1)]}return[t,this]}spanEquals(t){return this.whole==null&&t.whole==null||this.whole.equals(t.whole)}equals(t){return this.spanEquals(t)&&this.part.equals(t.part)&&this.value===t.value}show(t=!1){const o=typeof this.value=="object"?t?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var u="";if(this.whole==null)u="~"+this.part.show;else{var f=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(u=this.whole.begin.show()+" ⇜ "),f||(u+="("),u+=this.part.show(),f||(u+=")"),this.whole.end.equals(this.part.end)||(u+=" ⇝ "+this.whole.end.show())}return"[ "+u+" | "+o+" ]"}showWhole(t=!1){return`${this.whole==null?"~":this.whole.show()}: ${stringifyValues(this.value,t)}`}combineContext(t){const o=this;return{...o.context,...t.context,locations:(o.context.locations||[]).concat(t.context.locations||[])}}setContext(t){return new Hap(this.whole,this.part,this.value,t)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class State{constructor(t,o={}){this.span=t,this.controls=o}setSpan(t){return new State(t,this.controls)}withSpan(t){return this.setSpan(t(this.span))}setControls(t){return new State(this.span,{...this.controls,...t})}}function unionWithObj(e,t,o){if(t?.value!==void 0&&Object.keys(t).length===1)return logger$2("[warn]: Can't do arithmetic on control pattern."),e;const u=Object.keys(e).filter(f=>Object.keys(t).includes(f));return Object.assign({},e,t,Object.fromEntries(u.map(f=>[f,o(e[f],t[f])])))}curry((e,t)=>e*t),curry((e,t)=>t.map(e));function drawLine(e,t=60){let o=0,u=Fraction(0),f=[""],p="";for(;f[0].length<t;){const g=e.queryArc(o,o+1),M=g.filter(k=>k.hasOnset()).map(k=>k.duration),F=gcd(...M),S=F.inverse();f=f.map(k=>k+"|"),p+="|";for(let k=0;k<S;k++){const[N,$]=[u,u.add(F)],R=g.filter(O=>O.whole.begin.lte(N)&&O.whole.end.gte($)),U=R.length-f.length;U>0&&(f=f.concat(Array(U).fill(p))),f=f.map((O,Z)=>{const K=R[Z];if(K){const de=K.whole.begin.eq(N)?""+K.value:"-";return O+de}return O+"."}),p+=".",u=u.add(F)}o++}return f.join(`
`)}let stringParser,__steps=!0;const calculateSteps=function(e){__steps=!!e},setStringParser=e=>stringParser=e;let Pattern$1=class wn{constructor(t,o=void 0){this.query=t,this._Pattern=!0,this._steps=o}get _steps(){return this.__steps}set _steps(t){this.__steps=t===void 0?void 0:Fraction(t)}setSteps(t){return this._steps=t,this}withSteps(t){return __steps?new wn(this.query,this._steps===void 0?void 0:t(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(t){const o=new wn(u=>this.query(u).map(f=>f.withValue(t)));return o._steps=this._steps,o}withState(t){return new wn(o=>this.query(t(o)))}fmap(t){return this.withValue(t)}appWhole(t,o){const u=this,f=function(p){const g=u.query(p),M=o.query(p),F=function(S,k){const N=S.part.intersection(k.part);if(N!=null)return new Hap(t(S.whole,k.whole),N,S.value(k.value),k.combineContext(S))};return flatten(g.map(S=>removeUndefineds(M.map(k=>F(S,k)))))};return new wn(f)}appBoth(t){const o=this,u=function(p,g){if(!(p==null||g==null))return p.intersection_e(g)},f=o.appWhole(u,t);return __steps&&(f._steps=lcm(t._steps,o._steps)),f}appLeft(t){const o=this,u=function(p){const g=[];for(const M of o.query(p)){const F=t.query(p.setSpan(M.wholeOrPart()));for(const S of F){const k=M.whole,N=M.part.intersection(S.part);if(N){const $=M.value(S.value),R=S.combineContext(M),U=new Hap(k,N,$,R);g.push(U)}}}return g},f=new wn(u);return f._steps=this._steps,f}appRight(t){const o=this,u=function(p){const g=[];for(const M of t.query(p)){const F=o.query(p.setSpan(M.wholeOrPart()));for(const S of F){const k=M.whole,N=S.part.intersection(M.part);if(N){const $=S.value(M.value),R=M.combineContext(S),U=new Hap(k,N,$,R);g.push(U)}}}return g},f=new wn(u);return f._steps=t._steps,f}bindWhole(t,o){const u=this,f=function(p){const g=function(F,S){return new Hap(t(F.whole,S.whole),S.part,S.value,Object.assign({},F.context,S.context,{locations:(F.context.locations||[]).concat(S.context.locations||[])}))},M=function(F){return o(F.value).query(p.setSpan(F.part)).map(S=>g(F,S))};return flatten(u.query(p).map(F=>M(F)))};return new wn(f)}bind(t){const o=function(u,f){if(!(u==null||f==null))return u.intersection_e(f)};return this.bindWhole(o,t)}join(){return this.bind(id)}outerBind(t){return this.bindWhole(o=>o,t).setSteps(this._steps)}outerJoin(){return this.outerBind(id)}innerBind(t){return this.bindWhole((o,u)=>u,t)}innerJoin(){return this.innerBind(id)}resetJoin(t=!1){const o=this;return new wn(u=>o.discreteOnly().query(u).map(f=>f.value.late(t?f.whole.begin:f.whole.begin.cyclePos()).query(u).map(p=>new Hap(p.whole?p.whole.intersection(f.whole):void 0,p.part.intersection(f.part),p.value).setContext(f.combineContext(p))).filter(p=>p.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const t=this;function o(u){const f=t.discreteOnly().query(u);function p(M){const S=M.value._focusSpan(M.wholeOrPart()).query(u.setSpan(M.part));function k(N,$){let R;if($.whole&&N.whole&&(R=$.whole.intersection(N.whole),!R))return;const U=$.part.intersection(N.part);if(!U)return;const O=$.combineContext(N);return new Hap(R,U,$.value,O)}return S.map(N=>k(M,N))}return flatten(f.map(p)).filter(M=>M)}return new wn(o)}squeezeBind(t){return this.fmap(t).squeezeJoin()}polyJoin=function(){const t=this;return t.fmap(o=>o.extend(t._steps.div(o._steps))).outerJoin()};polyBind(t){return this.fmap(t).polyJoin()}queryArc(t,o,u={}){try{return this.query(new State(new TimeSpan(t,o),u))}catch(f){return errorLogger$1(f,"query"),[]}}splitQueries(){const t=this,o=u=>flatten(u.span.spanCycles.map(f=>t.query(u.setSpan(f))));return new wn(o)}withQuerySpan(t){return new wn(o=>this.query(o.withSpan(t)))}withQuerySpanMaybe(t){const o=this;return new wn(u=>{const f=u.withSpan(t);return f.span?o.query(f):[]})}withQueryTime(t){return new wn(o=>this.query(o.withSpan(u=>u.withTime(t))))}withHapSpan(t){return new wn(o=>this.query(o).map(u=>u.withSpan(t)))}withHapTime(t){return this.withHapSpan(o=>o.withTime(t))}withHaps(t){const o=new wn(u=>t(this.query(u),u));return o._steps=this._steps,o}withHap(t){return this.withHaps(o=>o.map(t))}setContext(t){return this.withHap(o=>o.setContext(t))}withContext(t){const o=this.withHap(u=>u.setContext(t(u.context)));return this.__pure!==void 0&&(o.__pure=this.__pure,o.__pure_loc=this.__pure_loc),o}stripContext(){return this.withHap(t=>t.setContext({}))}withLoc(t,o){const u={start:t,end:o},f=this.withContext(p=>{const g=(p.locations||[]).concat([u]);return{...p,locations:g}});return this.__pure&&(f.__pure=this.__pure,f.__pure_loc=u),f}filterHaps(t){return new wn(o=>this.query(o).filter(t))}filterValues(t){return new wn(o=>this.query(o).filter(u=>t(u.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(t=>t!=null)}onsetsOnly(){return this.filterHaps(t=>t.hasOnset())}discreteOnly(){return this.filterHaps(t=>t.whole)}defragmentHaps(){return this.discreteOnly().withHaps(o=>{const u=[];for(var f=0;f<o.length;++f){for(var p=!0,g=o[f];p;){const S=JSON.stringify(o[f].value);for(var M=!1,F=f+1;F<o.length;F++){const k=o[F];if(g.whole.equals(k.whole)){if(g.part.begin.eq(k.part.end)){if(S===JSON.stringify(k.value)){g=new Hap(g.whole,new TimeSpan(k.part.begin,g.part.end),g.value),o.splice(F,1),M=!0;break}}else if(k.part.begin.eq(g.part.end)&&S==JSON.stringify(k.value)){g=new Hap(g.whole,new TimeSpan(g.part.begin,k.part.end),g.value),o.splice(F,1),M=!0;break}}}p=M}u.push(g)}return u})}firstCycle(t=!1){var o=this;return t||(o=o.stripContext()),o.query(new State(new TimeSpan(Fraction(0),Fraction(1))))}get firstCycleValues(){return this.firstCycle().map(t=>t.value)}get showFirstCycle(){return this.firstCycle().map(t=>`${t.value}: ${t.whole.begin.toFraction()} - ${t.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(t=>t.sort((o,u)=>o.part.begin.sub(u.part.begin).or(o.part.end.sub(u.part.end)).or(o.whole.begin.sub(u.whole.begin).or(o.whole.end.sub(u.whole.end)))))}asNumber(){return this.fmap(parseNumeral)}_opIn(t,o){return this.fmap(o).appLeft(reify(t))}_opOut(t,o){return this.fmap(o).appRight(reify(t))}_opMix(t,o){return this.fmap(o).appBoth(reify(t))}_opSqueeze(t,o){const u=reify(t);return this.fmap(f=>u.fmap(p=>o(f)(p))).squeezeJoin()}_opSqueezeOut(t,o){const u=this;return reify(t).fmap(p=>u.fmap(g=>o(g)(p))).squeezeJoin()}_opReset(t,o){return reify(t).fmap(f=>this.fmap(p=>o(p)(f))).resetJoin()}_opRestart(t,o){return reify(t).fmap(f=>this.fmap(p=>o(p)(f))).restartJoin()}_opPoly(t,o){const u=reify(t);return this.fmap(f=>u.fmap(p=>o(p)(f))).polyJoin()}layer(...t){return stack(...t.map(o=>o(this)))}superimpose(...t){return this.stack(...t.map(o=>o(this)))}stack(...t){return stack(this,...t)}sequence(...t){return sequence(this,...t)}seq(...t){return sequence(this,...t)}cat(...t){return cat(this,...t)}fastcat(...t){return fastcat(this,...t)}slowcat(...t){return slowcat(this,...t)}onTrigger(t,o=!0){return this.withHap(u=>u.setContext({...u.context,onTrigger:(...f)=>{u.context.onTrigger?.(...f),t(...f)},dominantTrigger:u.context.dominantTrigger||o}))}log(t=u=>`[hap] ${u.showWhole(!0)}`,o=u=>({hap:u})){return this.onTrigger((...u)=>{logger$2(t(...u),void 0,o(...u))},!1)}logValues(t=o=>`[hap] ${stringifyValues(o,!0)}`){return this.log(o=>t(o.value))}drawLine(){return console.log(drawLine(this)),this}unjoin(t,o=id){return t.withHap(u=>u.withValue(f=>f?o(this.ribbon(u.whole.begin,u.whole.duration)):this))}into(t,o){return this.unjoin(t,o).innerJoin()}};function groupHapsBy(e,t){let o=[];return t.forEach(u=>{const f=o.findIndex(([p])=>e(u,p));f===-1?o.push([u]):o[f].push(u)}),o}const congruent=(e,t)=>e.spanEquals(t);Pattern$1.prototype.collect=function(){return this.withHaps(e=>groupHapsBy(congruent,e).map(t=>new Hap(t[0].whole,t[0].part,t,{})))};const arpWith=register("arpWith",(e,t)=>t.collect().fmap(o=>reify(e(o))).innerJoin().withHap(o=>new Hap(o.whole,o.part,o.value.value,o.combineContext(o.value)))),arp=register("arp",(e,t)=>t.arpWith(o=>reify(e).fmap(u=>o[u%o.length])),!1);function _nonArrayObject(e){return!Array.isArray(e)&&typeof e=="object"&&!isFraction(e)}function _composeOp(e,t,o){return _nonArrayObject(e)||_nonArrayObject(t)?(_nonArrayObject(e)||(e={value:e}),_nonArrayObject(t)||(t={value:t}),unionWithObj(e,t,o)):o(e,t)}(function(){const e={set:[(o,u)=>u],keep:[o=>o],keepif:[(o,u)=>u?o:void 0],add:[numeralArgs((o,u)=>o+u)],sub:[numeralArgs((o,u)=>o-u)],mul:[numeralArgs((o,u)=>o*u)],div:[numeralArgs((o,u)=>o/u)],mod:[numeralArgs(_mod$2)],pow:[numeralArgs(Math.pow)],log2:[numeralArgs(Math.log2)],band:[numeralArgs((o,u)=>o&u)],bor:[numeralArgs((o,u)=>o|u)],bxor:[numeralArgs((o,u)=>o^u)],blshift:[numeralArgs((o,u)=>o<<u)],brshift:[numeralArgs((o,u)=>o>>u)],lt:[(o,u)=>o<u],gt:[(o,u)=>o>u],lte:[(o,u)=>o<=u],gte:[(o,u)=>o>=u],eq:[(o,u)=>o==u],eqt:[(o,u)=>o===u],ne:[(o,u)=>o!=u],net:[(o,u)=>o!==u],and:[(o,u)=>o&&u],or:[(o,u)=>o||u],func:[(o,u)=>u(o)]},t=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[o,[u,f]]of Object.entries(e)){Pattern$1.prototype["_"+o]=function(p){return this.fmap(g=>u(g,p))},Object.defineProperty(Pattern$1.prototype,o,{get:function(){const p=this,g=(...M)=>p[o].in(...M);for(const M of t)g[M.toLowerCase()]=function(...F){var S=p;F=sequence(F),f&&(S=f(S),F=f(F));var k;return o==="keepif"?(k=S["_op"+M](F,N=>$=>u(N,$)),k=k.removeUndefineds()):k=S["_op"+M](F,N=>$=>_composeOp(N,$,u)),k};return g.squeezein=g.squeeze,g}});for(const p of t)Pattern$1.prototype[p.toLowerCase()]=function(...g){return this.set[p.toLowerCase()](g)}}Pattern$1.prototype.struct=function(...o){return this.keepif.out(...o)},Pattern$1.prototype.structAll=function(...o){return this.keep.out(...o)},Pattern$1.prototype.mask=function(...o){return this.keepif.in(...o)},Pattern$1.prototype.maskAll=function(...o){return this.keep.in(...o)},Pattern$1.prototype.reset=function(...o){return this.keepif.reset(...o)},Pattern$1.prototype.resetAll=function(...o){return this.keep.reset(...o)},Pattern$1.prototype.restart=function(...o){return this.keepif.restart(...o)},Pattern$1.prototype.restartAll=function(...o){return this.keep.restart(...o)}})();const polyrhythm=stack,pr=stack,pm=polymeter,gap=e=>new Pattern$1(()=>[],e),silence=gap(1),nothing=gap(0);function pure(e){function t(u){return u.span.spanCycles.map(f=>new Hap(Fraction(f.begin).wholeCycle(),f,e))}const o=new Pattern$1(t,1);return o.__pure=e,o}function isPattern(e){return e instanceof Pattern$1||e?._Pattern}function reify(e){return isPattern(e)?e:stringParser&&typeof e=="string"?stringParser(e):pure(e)}function sequenceP(e){let t=pure([]);for(const o of e)t=t.bind(u=>o.fmap(f=>u.concat([f])));return t}function stack(...e){e=e.map(u=>Array.isArray(u)?sequence(...u):reify(u));const t=u=>flatten(e.map(f=>f.query(u))),o=new Pattern$1(t);return __steps&&(o._steps=lcm(...e.map(u=>u._steps))),o}function _stackWith(e,t){if(t=t.map(p=>Array.isArray(p)?sequence(...p):reify(p)),t.length===0)return silence;if(t.length===1)return t[0];const[o,...u]=t.map(p=>p._steps),f=__steps?o.maximum(...u):void 0;return stack(...e(f,t))}function stackLeft(...e){return _stackWith((t,o)=>o.map(u=>u._steps.eq(t)?u:stepcat(u,gap(t.sub(u._steps)))),e)}function stackRight(...e){return _stackWith((t,o)=>o.map(u=>u._steps.eq(t)?u:stepcat(gap(t.sub(u._steps)),u)),e)}function stackCentre(...e){return _stackWith((t,o)=>o.map(u=>{if(u._steps.eq(t))return u;const f=gap(t.sub(u._steps).div(2));return stepcat(f,u,f)}),e)}function stackBy(e,...t){const[o,...u]=t.map(g=>g._steps),f=o.maximum(...u),p={centre:stackCentre,left:stackLeft,right:stackRight,expand:stack,repeat:(...g)=>polymeter(...g).steps(f)};return e.inhabit(p).fmap(g=>g(...t)).innerJoin().setSteps(f)}function slowcat(...e){if(e=e.map(u=>Array.isArray(u)?fastcat(...u):reify(u)),e.length==1)return e[0];const t=function(u){const f=u.span,p=_mod$2(f.begin.sam(),e.length),g=e[p];if(!g)return[];const M=f.begin.floor().sub(f.begin.div(e.length).floor());return g.withHapTime(F=>F.add(M)).query(u.setSpan(f.withTime(F=>F.sub(M))))},o=__steps?lcm(...e.map(u=>u._steps)):void 0;return new Pattern$1(t).splitQueries().setSteps(o)}function slowcatPrime(...e){e=e.map(reify);const t=function(o){const u=Math.floor(o.span.begin)%e.length;return e[u]?.query(o)||[]};return new Pattern$1(t).splitQueries()}function cat(...e){return slowcat(...e)}function arrange(...e){const t=e.reduce((o,[u])=>o+u,0);return e=e.map(([o,u])=>[o,u.fast(o)]),stepcat(...e).slow(t)}function seqPLoop(...e){let t=Fraction(0);for(let o of e)o.length==2&&o.unshift(t),t=o[1];return stack(...e.map(([o,u,f])=>pure(reify(f)).compress(Fraction(o).div(t),Fraction(u).div(t)))).slow(t).innerJoin()}function fastcat(...e){let t=slowcat(...e);return e.length>1&&(t=t._fast(e.length),t._steps=e.length),e.length==1&&e[0].__steps_source&&(e._steps=e[0]._steps),t}function sequence(...e){return fastcat(...e)}function seq(...e){return fastcat(...e)}function _sequenceCount(e){return Array.isArray(e)?e.length==0?[silence,0]:e.length==1?_sequenceCount(e[0]):[fastcat(...e.map(t=>_sequenceCount(t)[0])),e.length]:[reify(e),1]}const mask=curry((e,t)=>reify(t).mask(e)),struct=curry((e,t)=>reify(t).struct(e)),superimpose=curry((e,t)=>reify(t).superimpose(...e)),withValue=curry((e,t)=>reify(t).withValue(e)),bind=curry((e,t)=>reify(t).bind(e)),innerBind=curry((e,t)=>reify(t).innerBind(e)),outerBind=curry((e,t)=>reify(t).outerBind(e)),squeezeBind=curry((e,t)=>reify(t).squeezeBind(e)),stepBind=curry((e,t)=>reify(t).stepBind(e)),polyBind=curry((e,t)=>reify(t).polyBind(e)),set=curry((e,t)=>reify(t).set(e)),keep=curry((e,t)=>reify(t).keep(e)),keepif=curry((e,t)=>reify(t).keepif(e)),add$7=curry((e,t)=>reify(t).add(e)),sub=curry((e,t)=>reify(t).sub(e)),mul=curry((e,t)=>reify(t).mul(e)),div=curry((e,t)=>reify(t).div(e)),mod$3=curry((e,t)=>reify(t).mod(e)),pow=curry((e,t)=>reify(t).pow(e)),band=curry((e,t)=>reify(t).band(e)),bor=curry((e,t)=>reify(t).bor(e)),bxor=curry((e,t)=>reify(t).bxor(e)),blshift=curry((e,t)=>reify(t).blshift(e)),brshift=curry((e,t)=>reify(t).brshift(e)),lt=curry((e,t)=>reify(t).lt(e)),gt=curry((e,t)=>reify(t).gt(e)),lte=curry((e,t)=>reify(t).lte(e)),gte=curry((e,t)=>reify(t).gte(e)),eq=curry((e,t)=>reify(t).eq(e)),eqt=curry((e,t)=>reify(t).eqt(e)),ne=curry((e,t)=>reify(t).ne(e)),net=curry((e,t)=>reify(t).net(e)),and=curry((e,t)=>reify(t).and(e)),or=curry((e,t)=>reify(t).or(e)),func=curry((e,t)=>reify(t).func(e));function register(e,t,o=!0,u=!1,f=p=>p.innerJoin()){if(Array.isArray(e)){const M={};for(const F of e)M[F]=register(F,t,o,u,f);return M}const p=t.length;var g;return o?g=function(...M){M=M.map(reify);const F=M[M.length-1];let S;if(p===1)S=t(F);else{const k=M.slice(0,-1);if(k.every(N=>N.__pure!=null)){const N=k.map(R=>R.__pure),$=k.filter(R=>R.__pure_loc).map(R=>R.__pure_loc);S=t(...N,F),S=S.withContext(R=>{const U=(R.locations||[]).concat($);return{...R,locations:U}})}else{const[N,...$]=k;let R=(...U)=>t(...U,F);R=curry(R,null,p-1),S=f($.reduce((U,O)=>U.appLeft(O),N.fmap(R)))}}return u&&(S._steps=F._steps),S}:g=function(...M){M=M.map(reify);const F=t(...M);return u&&(F._steps=M[M.length-1]._steps),F},Pattern$1.prototype[e]=function(...M){if(p===2&&M.length!==1)M=[sequence(...M)];else if(p!==M.length+1)throw new Error(`.${e}() expects ${p-1} inputs but got ${M.length}.`);return M=M.map(reify),g(...M,this)},p>1&&(Pattern$1.prototype["_"+e]=function(...M){const F=t(...M,this);return u&&F.setSteps(this._steps),F}),curry(g,null,p)}function stepRegister(e,t,o=!0,u=!1,f=p=>p.stepJoin()){return register(e,t,o,u,f)}const round=register("round",function(e){return e.asNumber().fmap(t=>Math.round(t))}),floor=register("floor",function(e){return e.asNumber().fmap(t=>Math.floor(t))}),ceil=register("ceil",function(e){return e.asNumber().fmap(t=>Math.ceil(t))}),toBipolar=register("toBipolar",function(e){return e.fmap(t=>t*2-1)}),fromBipolar=register("fromBipolar",function(e){return e.fmap(t=>(t+1)/2)}),range$2=register("range",function(e,t,o){return o.mul(t-e).add(e)}),rangex=register("rangex",function(e,t,o){return o._range(Math.log(e),Math.log(t)).fmap(Math.exp)}),range2=register("range2",function(e,t,o){return o.fromBipolar()._range(e,t)}),ratio=register("ratio",e=>e.fmap(t=>Array.isArray(t)?t.slice(1).reduce((o,u)=>o/u,t[0]):t)),compress=register("compress",function(e,t,o){return e=Fraction(e),t=Fraction(t),e.gt(t)||e.gt(1)||t.gt(1)||e.lt(0)||t.lt(0)?silence:o._fastGap(Fraction(1).div(t.sub(e)))._late(e)}),{compressSpan,compressspan}=register(["compressSpan","compressspan"],function(e,t){return t._compress(e.begin,e.end)}),{fastGap,fastgap}=register(["fastGap","fastgap"],function(e,t){const o=function(f){const p=f.begin.sam(),g=f.begin.sub(p).mul(e).min(1),M=f.end.sub(p).mul(e).min(1);if(!(g>=1))return new TimeSpan(p.add(g),p.add(M))},u=function(f){const p=f.part.begin,g=f.part.end,M=p.sam(),F=p.sub(M).div(e).min(1),S=g.sub(M).div(e).min(1),k=new TimeSpan(M.add(F),M.add(S)),N=f.whole?new TimeSpan(k.begin.sub(p.sub(f.whole.begin).div(e)),k.end.add(f.whole.end.sub(g).div(e))):void 0;return new Hap(N,k,f.value,f.context)};return t.withQuerySpanMaybe(o).withHap(u).splitQueries()}),focus=register("focus",function(e,t,o){return e=Fraction(e),t=Fraction(t),o._early(e.sam())._fast(Fraction(1).div(t.sub(e)))._late(e)}),{focusSpan,focusspan}=register(["focusSpan","focusspan"],function(e,t){return t._focus(e.begin,e.end)}),ply=register("ply",function(e,t){const o=t.fmap(u=>pure(u)._fast(e)).squeezeJoin();return __steps&&(o._steps=Fraction(e).mulmaybe(t._steps)),o}),{fast,density:density$1}=register(["fast","density"],function(e,t){return e===0?silence:(e=Fraction(e),t.withQueryTime(u=>u.mul(e)).withHapTime(u=>u.div(e)).setSteps(t._steps))},!0,!0),hurry=register("hurry",function(e,t){return t._fast(e).mul(pure({speed:e}))}),{slow,sparsity}=register(["slow","sparsity"],function(e,t){return e===0?silence:t._fast(Fraction(1).div(e))}),inside=register("inside",function(e,t,o){return t(o._slow(e))._fast(e)}),outside=register("outside",function(e,t,o){return t(o._fast(e))._slow(e)}),lastOf=register("lastOf",function(e,t,o){const u=Array(e-1).fill(o);return u.push(t(o)),slowcatPrime(...u)}),{firstOf,every}=register(["firstOf","every"],function(e,t,o){const u=Array(e-1).fill(o);return u.unshift(t(o)),slowcatPrime(...u)}),apply=register("apply",function(e,t){return e(t)}),cpm=register("cpm",function(e,t){return t._fast(e/60/1)}),early=register("early",function(e,t){return e=Fraction(e),t.withQueryTime(o=>o.add(e)).withHapTime(o=>o.sub(e))},!0,!0),late=register("late",function(e,t){return e=Fraction(e),t._early(Fraction(0).sub(e))},!0,!0),zoom=register("zoom",function(e,t,o){if(t=Fraction(t),e=Fraction(e),e.gte(t))return nothing;const u=t.sub(e),f=__steps?o._steps?.mulmaybe(u):void 0;return o.withQuerySpan(p=>p.withCycle(g=>g.mul(u).add(e))).withHapSpan(p=>p.withCycle(g=>g.sub(e).div(u))).splitQueries().setSteps(f)}),{zoomArc,zoomarc}=register(["zoomArc","zoomarc"],function(e,t){return t.zoom(e.begin,e.end)}),bite=register("bite",(e,t,o)=>t.fmap(u=>f=>{const p=Fraction(u).div(f).mod(1),g=p.add(Fraction(1).div(f));return o.zoom(p,g)}).appLeft(e).squeezeJoin(),!1),linger=register("linger",function(e,t){return e==0?silence:e<0?t._zoom(e.add(1),1)._slow(e):t._zoom(0,e)._slow(e)},!0,!0),{segment,seg}=register(["segment","seg"],function(e,t){return t.struct(pure(!0)._fast(e)).setSteps(e)}),swingBy=register("swingBy",(e,t,o)=>o.inside(t,late(seq(0,e/2)))),swing=register("swing",(e,t)=>t.swingBy(1/3,e)),{invert:invert$1,inv}=register(["invert","inv"],function(e){return e.fmap(t=>!t)},!0,!0),when=register("when",function(e,t,o){return e?t(o):o}),off=register("off",function(e,t,o){return stack(o,t(o.late(e)))}),brak=register("brak",function(e){return e.when(slowcat(!1,!0),t=>fastcat(t,silence)._late(.25))}),rev=register("rev",function(e){const t=function(o){const u=o.span,f=u.begin.sam(),p=u.begin.nextSam(),g=function(F){const S=F.withTime(N=>f.add(p.sub(N))),k=S.begin;return S.begin=S.end,S.end=k,S};return e.query(o.setSpan(g(u))).map(F=>F.withSpan(g))};return new Pattern$1(t).splitQueries()},!1,!0),revv=register("revv",function(e){const t=o=>new TimeSpan(Fraction(0).sub(o.end),Fraction(0).sub(o.begin));return e.withQuerySpan(t).withHapSpan(t)}),pressBy=register("pressBy",function(e,t){return t.fmap(o=>pure(o).compress(e,1)).squeezeJoin()}),press=register("press",function(e){return e._pressBy(.5)});Pattern$1.prototype.hush=function(){return silence};const palindrome=register("palindrome",function(e){return e.lastOf(2,rev)},!0,!0),{juxBy,juxby}=register(["juxBy","juxby"],function(e,t,o){e/=2;const u=function(g,M,F){return M in g?g[M]:F},f=o.withValue(g=>Object.assign({},g,{pan:u(g,"pan",.5)-e})),p=t(o.withValue(g=>Object.assign({},g,{pan:u(g,"pan",.5)+e})));return stack(f,p).setSteps(__steps?lcm(f._steps,p._steps):void 0)}),jux=register("jux",function(e,t){return t._juxBy(1,e,t)}),{echoWith,echowith,stutWith,stutwith}=register(["echoWith","echowith","stutWith","stutwith"],function(e,t,o,u){return stack(...listRange(0,e-1).map(f=>o(u.late(Fraction(t).mul(f)),f)))}),echo=register("echo",function(e,t,o,u){return u._echoWith(e,t,(f,p)=>f.gain(Math.pow(o,p)))}),stut=register("stut",function(e,t,o,u){return u._echoWith(e,o,(f,p)=>f.gain(Math.pow(t,p)))}),applyN=register("applyN",function(e,t,o){let u=o;for(let f=0;f<e;f++)u=t(u);return u}),plyWith=register(["plyWith","plywith"],function(e,t,o){const u=o.fmap(f=>cat(...listRange(0,e-1).map(p=>applyN(p,t,f)))._fast(e)).squeezeJoin();return __steps&&(u._steps=Fraction(e).mulmaybe(o._steps)),u}),plyForEach=register(["plyForEach","plyforeach"],function(e,t,o){const u=o.fmap(f=>cat(cat(pure(f),...listRange(1,e-1).map(p=>t(pure(f),p))))._fast(e)).squeezeJoin();return __steps&&(u._steps=Fraction(e).mulmaybe(o._steps)),u}),_iter=function(e,t,o=!1){return e=Fraction(e),slowcat(...listRange(0,e.sub(1)).map(u=>o?t.late(Fraction(u).div(e)):t.early(Fraction(u).div(e))))},iter=register("iter",function(e,t){return _iter(e,t,!1)},!0,!0),{iterBack,iterback}=register(["iterBack","iterback"],function(e,t){return _iter(e,t,!0)},!0,!0),{repeatCycles}=register("repeatCycles",function(e,t){return new Pattern$1(function(o){const u=o.span.begin.sam(),f=u.div(e).sam(),p=u.sub(f);return o=o.withSpan(g=>g.withTime(M=>M.sub(p))),t.query(o).map(g=>g.withSpan(M=>M.withTime(F=>F.add(p))))}).splitQueries()},!0,!0),_chunk=function(e,t,o,u=!1,f=!1){const p=Array(e-1).fill(!1);p.unshift(!0);const g=_iter(e,sequence(...p),!u);return f||(o=o.repeatCycles(e)),o.when(g,t)},{chunk,slowchunk,slowChunk}=register(["chunk","slowchunk","slowChunk"],function(e,t,o){return _chunk(e,t,o,!1,!1)},!0,!0),{chunkBack,chunkback}=register(["chunkBack","chunkback"],function(e,t,o){return _chunk(e,t,o,!0)},!0,!0),{fastchunk,fastChunk}=register(["fastchunk","fastChunk"],function(e,t,o){return _chunk(e,t,o,!1,!0)},!0,!0),{chunkinto,chunkInto}=register(["chunkinto","chunkInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iterback(e),t)}),{chunkbackinto,chunkBackInto}=register(["chunkbackinto","chunkBackInto"],function(e,t,o){return o.into(fastcat(!0,...Array(e-1).fill(!1))._iter(e)._early(1),t)}),bypass=register("bypass",function(e,t){return e=!!parseInt(e),e?silence:t},!0,!0),{ribbon,rib}=register(["ribbon","rib"],(e,t,o)=>o.early(e).restart(pure(1).slow(t))),hsla=register("hsla",(e,t,o,u,f)=>f.color(`hsla(${e}turn,${t*100}%,${o*100}%,${u})`)),hsl=register("hsl",(e,t,o,u)=>u.color(`hsl(${e}turn,${t*100}%,${o*100}%)`));Pattern$1.prototype.tag=function(e){return this.withContext(t=>({...t,tags:(t.tags||[]).concat([e])}))};const filter$1=register("filter",(e,t)=>t.withHaps(o=>o.filter(e))),filterWhen=register("filterWhen",(e,t)=>t.filter(o=>e(o.whole.begin))),within=register("within",(e,t,o,u)=>stack(o(u.filterWhen(f=>f.cyclePos()>=e&&f.cyclePos()<=t)),u.filterWhen(f=>f.cyclePos()<e||f.cyclePos()>t)));Pattern$1.prototype.stepJoin=function(){const e=this,t=stepcat(..._retime(_slices(e.queryArc(0,1))))._steps,o=function(u){const p=e.early(u.span.begin.sam()).query(u.setSpan(new TimeSpan(Fraction(0),Fraction(1))));return stepcat(..._retime(_slices(p))).query(u)};return new Pattern$1(o,t)},Pattern$1.prototype.stepBind=function(e){return this.fmap(e).stepJoin()};function _retime(e){const t=e.filter((p,g)=>g.hasSteps).reduce((p,g)=>p.add(g),Fraction(0)),o=removeUndefineds(e.map((p,g)=>g._steps)).reduce((p,g)=>p.add(g),Fraction(0)),u=t.eq(0)?void 0:o.div(t);function f(p,g){return g._steps===void 0?[p.mulmaybe(u),g]:[g._steps,g]}return e.map(p=>f(...p))}function _slices(e){const t=flatten(e.map(f=>[f.part.begin,f.part.end])),o=uniqsortr([Fraction(0),Fraction(1),...t]);return pairs(o).map(f=>[f[1].sub(f[0]),stack(..._fitslice(new TimeSpan(...f),e).map(p=>p.value.withHap(g=>g.setContext(g.combineContext(p)))))])}function _fitslice(e,t){return removeUndefineds(t.map(o=>_match(e,o)))}function _match(e,t){const o=e.intersection(t.part);if(o!=null)return new Hap(t.whole,o,t.value,t.context)}const pace=register("pace",function(e,t){return t._steps===void 0?t:t._steps.eq(Fraction(0))?nothing:t._fast(Fraction(e).div(t._steps)).setSteps(e)});function _polymeterListSteps(e,...t){const o=t.map(f=>_sequenceCount(f));if(o.length==0)return silence;e==0&&(e=o[0][1]);const u=[];for(const f of o)f[1]!=0&&(e==f[1]?u.push(f[0]):u.push(f[0]._fast(Fraction(e).div(Fraction(f[1])))));return stack(...u)}function polymeter(...e){if(Array.isArray(e[0]))return _polymeterListSteps(0,...e);if(e=e.filter(u=>u.hasSteps),e.length==0)return silence;const t=lcm(...e.map(u=>u._steps));if(t.eq(Fraction(0)))return nothing;const o=stack(...e.map(u=>u.pace(t)));return o._steps=t,o}function stepcat(...e){if(e.length===0)return nothing;const t=g=>Array.isArray(g)?g:[g._steps??1,g];if(e=e.map(t),e.find(g=>g[0]===void 0)){const g=e.map(F=>F[0]).filter(F=>F!==void 0);if(g.length===0)return fastcat(...e.map(F=>F[1]));if(g.length===e.length)return nothing;const M=g.reduce((F,S)=>F.add(S),Fraction(0)).div(g.length);for(let F of e)F[0]===void 0&&(F[0]=M)}if(e.length==1)return reify(e[0][1]).withSteps(M=>e[0][0]);const o=e.map(g=>g[0]).reduce((g,M)=>g.add(M),Fraction(0));let u=Fraction(0);const f=[];for(const[g,M]of e){if(Fraction(g).eq(0))continue;const F=u.add(g);f.push(reify(M)._compress(u.div(o),F.div(o))),u=F}const p=stack(...f);return p._steps=o,p}function stepalt(...e){e=e.map(f=>Array.isArray(f)?f.map(reify):[reify(f)]);const t=lcm(...e.map(f=>Fraction(f.length)));let o=[];for(let f=0;f<t;++f)o.push(...e.map(p=>p.length==0?silence:p[f%p.length]));o=o.filter(f=>f.hasSteps&&f._steps>0);const u=o.reduce((f,p)=>f.add(p._steps),Fraction(0));return o=stepcat(...o),o._steps=u,o}const take=stepRegister("take",function(e,t){if(!t.hasSteps||t._steps.lte(0)||(e=Fraction(e),e.eq(0)))return nothing;const o=e<0;o&&(e=e.abs());const u=e.div(t._steps);return u.lte(0)?nothing:u.gte(1)?t:o?t.zoom(Fraction(1).sub(u),1):t.zoom(0,u)}),drop=stepRegister("drop",function(e,t){return t.hasSteps?(e=Fraction(e),e.lt(0)?t.take(t._steps.add(e)):t.take(Fraction(0).sub(t._steps.sub(e)))):nothing}),extend=stepRegister("extend",function(e,t){return t.fast(e).expand(e)}),replicate=stepRegister("replicate",function(e,t){return t.repeatCycles(e).fast(e).expand(e)}),expand=stepRegister("expand",function(e,t){return t.withSteps(o=>o.mul(Fraction(e)))}),contract=stepRegister("contract",function(e,t){return t.withSteps(o=>o.div(Fraction(e)))});Pattern$1.prototype.shrinklist=function(e){const t=this;if(!t.hasSteps)return[t];let[o,u]=Array.isArray(e)?e:[e,t._steps];if(o=Fraction(o),u===0||o===0)return[t];const f=o>0,p=[];if(f){const g=Fraction(1).div(t._steps).mul(o);for(let M=0;M<u;++M){const F=g.mul(M);if(F.gt(1))break;p.push([F,1])}}else{o=Fraction(0).sub(o);const g=Fraction(1).div(t._steps).mul(o);for(let M=0;M<u;++M){const F=Fraction(1).sub(g.mul(M));if(F.lt(0))break;p.push([Fraction(0),F])}}return p.map(g=>t.zoom(...g))};const shrinklist=(e,t)=>t.shrinklist(e),shrink=register("shrink",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(e),u=stepcat(...o);return u._steps=o.reduce((f,p)=>f.add(p._steps),Fraction(0)),u},!0,!1,e=>e.stepJoin()),grow=register("grow",function(e,t){if(!t.hasSteps)return nothing;const o=t.shrinklist(Fraction(0).sub(e));o.reverse();const u=stepcat(...o);return u._steps=o.reduce((f,p)=>f.add(p._steps),Fraction(0)),u},!0,!1,e=>e.stepJoin()),tour=function(e,...t){return e.tour(...t)};Pattern$1.prototype.tour=function(...e){return stepcat(...[].concat(...e.map((t,o)=>[...e.slice(0,e.length-o),this,...e.slice(e.length-o)]),this,...e))};const zip=function(...e){e=e.filter(u=>u.hasSteps);const t=slowcat(...e.map(u=>u._slow(u._steps))),o=lcm(...e.map(u=>u._steps));return t._fast(o).setSteps(o)},timecat=stepcat,timeCat=stepcat,s_cat=stepcat,s_alt=stepalt,s_polymeter=polymeter;Pattern$1.prototype.s_polymeter=Pattern$1.prototype.polymeter;const s_taper=shrink;Pattern$1.prototype.s_taper=Pattern$1.prototype.shrink;const s_taperlist=shrinklist;Pattern$1.prototype.s_taperlist=Pattern$1.prototype.shrinklist;const s_add=take;Pattern$1.prototype.s_add=Pattern$1.prototype.take;const s_sub=drop;Pattern$1.prototype.s_sub=Pattern$1.prototype.drop;const s_expand=expand;Pattern$1.prototype.s_expand=Pattern$1.prototype.expand;const s_extend=extend;Pattern$1.prototype.s_extend=Pattern$1.prototype.extend;const s_contract=contract;Pattern$1.prototype.s_contract=Pattern$1.prototype.contract;const s_tour=tour;Pattern$1.prototype.s_tour=Pattern$1.prototype.tour;const s_zip=zip;Pattern$1.prototype.s_zip=Pattern$1.prototype.zip;const steps$2=pace;Pattern$1.prototype.steps=Pattern$1.prototype.pace;const chop=register("chop",function(e,t){const u=Array.from({length:e},(g,M)=>M).map(g=>({begin:g/e,end:(g+1)/e})),f=function(g,M){if("begin"in g&&"end"in g&&g.begin!==void 0&&g.end!==void 0){const F=g.end-g.begin;M={begin:g.begin+M.begin*F,end:g.begin+M.end*F}}return Object.assign({},g,M)},p=function(g){return sequence(u.map(M=>f(g,M)))};return t.squeezeBind(p).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),striate=register("striate",function(e,t){const u=Array.from({length:e},(p,g)=>g).map(p=>({begin:p/e,end:(p+1)/e})),f=slowcat(...u);return t.set(f)._fast(e).setSteps(__steps?Fraction(e).mulmaybe(t._steps):void 0)}),_loopAt=function(e,t,o=.5){return t.speed(1/e*o).unit("c").slow(e)},slice=register("slice",function(e,t,o){return e.innerBind(u=>t.outerBind(f=>o.outerBind(p=>{p=p instanceof Object?p:{s:p};const g=Array.isArray(u)?u[f]:f/u,M=Array.isArray(u)?u[f+1]:(f+1)/u;return pure({begin:g,end:M,_slices:u,...p})}))).setSteps(t._steps)},!1);Pattern$1.prototype.onTriggerTime=function(e){return this.onTrigger((t,o,u,f)=>{const p=f-o;window.setTimeout(()=>{e(t)},p*1e3)},!1)};const splice=register("splice",function(e,t,o){const u=slice(e,t,o);return new Pattern$1(f=>{const p=f.controls._cps||1;return u.query(f).map(M=>M.withValue(F=>({speed:p/F._slices/M.whole.duration*(F.speed||1),unit:"c",...F})))}).setSteps(t._steps)},!1),{loopAt,loopat}=register(["loopAt","loopat"],function(e,t){const o=t._steps?t._steps.div(e):void 0;return new Pattern$1(u=>_loopAt(e,t,u.controls._cps).query(u),o)}),fit=register("fit",e=>e.withHaps((t,o)=>t.map(u=>u.withValue(f=>{const p=("end"in f?f.end:1)-("begin"in f?f.begin:0);return{...f,speed:(o.controls._cps||1)/u.whole.duration*p,unit:"c"}})))),{loopAtCps,loopatcps}=register(["loopAtCps","loopatcps"],function(e,t,o){return _loopAt(e,o,t)}),ref$1=e=>pure(1).withValue(()=>reify(e())).innerJoin();let fadeGain=e=>e<.5?1:1-(e-.5)/.5,xfade=(e,t,o)=>{t=reify(t),e=reify(e),o=reify(o);let u=t.fmap(p=>({gain:fadeGain(p)})),f=t.fmap(p=>({gain:fadeGain(1-p)}));return stack(e.mul(u),o.mul(f))};Pattern$1.prototype.xfade=function(e,t){return xfade(this,e,t)};const __beat=e=>(t,o,u)=>{t=Fraction(t).mod(o),o=Fraction(o);const f=t.div(o),p=t.add(1).div(o);return e(u.fmap(g=>pure(g)._compress(f,p)))},{beat}=register(["beat"],__beat(e=>e.innerJoin())),_morph=(e,t,o)=>{o=Fraction(o);const u=Fraction(1).div(e.length),f=M=>{const F=[];for(const[S,k]of M.entries())k&&F.push([Fraction(S).div(M.length),k]);return F},p=zipWith(([M,F],[S,k])=>{const N=o.mul(S-M).add(M),$=N.add(u);return new TimeSpan(N,$)},f(e),f(t));function g(M){const F=M.span.begin.sam(),S=M.span.cycleArc(),k=[];for(const N of p){const $=N.intersection(S);$!==void 0&&k.push(new Hap(N.withTime(R=>R.add(F)),$.withTime(R=>R.add(F)),!0))}return k}return new Pattern$1(g).splitQueries()},morph=(e,t,o)=>(e=reify(e),t=reify(t),o=reify(o),e.innerBind(u=>t.innerBind(f=>o.innerBind(p=>_morph(u,f,p))))),distAlgoNames=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const e of distAlgoNames)Pattern$1.prototype[e]=function(t){const o=reify(t).fmap(u=>Array.isArray(u)?[...u,e]:[u,1,e]);return this.distort(o)};const parray=e=>{let o=pure(curry((...u)=>u,null,e.length));for(const u of e)o=o.appBoth(reify(u));return o},_ensureListPattern=e=>Array.isArray(e)?parray(e):reify(e);Pattern$1.prototype.partials=function(e){return this.withValue(t=>o=>({...t,partials:o})).appLeft(_ensureListPattern(e))};const partials=e=>_ensureListPattern(e).as("partials");Pattern$1.prototype.phases=function(e){return this.withValue(t=>o=>({...t,phases:o})).appLeft(_ensureListPattern(e))};const phases=e=>_ensureListPattern(e).as("phases");function createParam(e){let t=Array.isArray(e);e=t?e:[e];const o=e[0],u=p=>{let g;if(typeof p=="object"&&p.value!==void 0&&(g={...p},p=p.value,delete g.value),t&&Array.isArray(p)){const M=g||{};return p.forEach((F,S)=>{S<e.length&&(M[e[S]]=F)}),M}else return g?(g[o]=p,g):{[o]:p}},f=function(p,g){return g?typeof p>"u"?g.fmap(u):g.set(reify(p).withValue(u)):reify(p).withValue(u)};return Pattern$1.prototype[o]=function(p){return f(p,this)},f}const controlAlias=new Map;function isControlName(e){return controlAlias.has(e)}function registerControl(e,...t){const o=Array.isArray(e)?e[0]:e;let u={};return u[o]=createParam(e),controlAlias.set(o,o),t.forEach(f=>{u[f]=u[o],controlAlias.set(f,o),Pattern$1.prototype[f]=Pattern$1.prototype[o]}),u}const{s,sound}=registerControl(["s","n","gain"],"sound"),{wt,wavetablePosition}=registerControl("wt","wavetablePosition"),{wtenv}=registerControl("wtenv"),{wtattack,wtatt}=registerControl("wtattack","wtatt"),{wtdecay,wtdec}=registerControl("wtdecay","wtdec"),{wtsustain,wtsus}=registerControl("wtsustain","wtsus"),{wtrelease,wtrel}=registerControl("wtrelease","wtrel"),{wtrate}=registerControl("wtrate"),{wtsync}=registerControl("wtsync"),{wtdepth}=registerControl("wtdepth"),{wtshape}=registerControl("wtshape"),{wtdc}=registerControl("wtdc"),{wtskew}=registerControl("wtskew"),{warp,wavetableWarp}=registerControl("warp","wavetableWarp"),{warpattack,warpatt}=registerControl("warpattack","warpatt"),{warpdecay,warpdec}=registerControl("warpdecay","warpdec"),{warpsustain,warpsus}=registerControl("warpsustain","warpsus"),{warprelease,warprel}=registerControl("warprelease","warprel"),{warprate}=registerControl("warprate"),{warpdepth}=registerControl("warpdepth"),{warpshape}=registerControl("warpshape"),{warpdc}=registerControl("warpdc"),{warpskew}=registerControl("warpskew"),{warpmode,wavetableWarpMode}=registerControl("warpmode","wavetableWarpMode"),{wtphaserand,wavetablePhaseRand}=registerControl("wtphaserand","wavetablePhaseRand"),{warpenv}=registerControl("warpenv"),{warpsync}=registerControl("warpsync"),{source,src}=registerControl("source","src"),{n}=registerControl("n"),{note:note$2}=registerControl(["note","n"]),{accelerate}=registerControl("accelerate"),{velocity}=registerControl("velocity"),{gain}=registerControl("gain"),{postgain}=registerControl("postgain"),{amp}=registerControl("amp"),{attack,att}=registerControl("attack","att"),{fmh}=registerControl(["fmh","fmi"],"fmh"),{fmi,fm:fm$1}=registerControl(["fmi","fmh"],"fm"),{fmenv}=registerControl("fmenv"),{fmattack}=registerControl("fmattack"),{fmwave}=registerControl("fmwave"),{fmdecay}=registerControl("fmdecay"),{fmsustain}=registerControl("fmsustain"),{fmrelease}=registerControl("fmrelease"),{fmvelocity}=registerControl("fmvelocity"),{bank}=registerControl("bank"),{chorus}=registerControl("chorus"),{analyze}=registerControl("analyze"),{fft}=registerControl("fft"),{decay,dec}=registerControl("decay","dec"),{sustain,sus}=registerControl("sustain","sus"),{release,rel}=registerControl("release","rel"),{hold}=registerControl("hold"),{bandf,bpf,bp}=registerControl(["bandf","bandq","bpenv"],"bpf","bp"),{bandq,bpq}=registerControl("bandq","bpq"),{begin}=registerControl("begin"),{end}=registerControl("end"),{loop}=registerControl("loop"),{loopBegin,loopb}=registerControl("loopBegin","loopb"),{loopEnd,loope}=registerControl("loopEnd","loope"),{crush}=registerControl("crush"),{coarse}=registerControl("coarse"),{tremolo}=registerControl(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync}=registerControl(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth}=registerControl("tremolodepth","tremdepth"),{tremoloskew}=registerControl("tremoloskew","tremskew"),{tremolophase}=registerControl("tremolophase","tremphase"),{tremoloshape}=registerControl("tremoloshape","tremshape"),{drive}=registerControl("drive"),{duck}=registerControl("duckorbit","duck"),{duckdepth}=registerControl("duckdepth"),{duckonset}=registerControl("duckonset","duckons"),{duckattack}=registerControl("duckattack","duckatt"),{byteBeatExpression,bbexpr}=registerControl("byteBeatExpression","bbexpr"),{byteBeatStartTime,bbst}=registerControl("byteBeatStartTime","bbst"),{channels,ch}=registerControl("channels","ch"),{pw}=registerControl(["pw","pwrate","pwsweep"]),{pwrate}=registerControl("pwrate"),{pwsweep}=registerControl("pwsweep"),{phaserrate,ph,phaser}=registerControl(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep,phs}=registerControl("phasersweep","phs"),{phasercenter,phc}=registerControl("phasercenter","phc"),{phaserdepth,phd,phasdp}=registerControl("phaserdepth","phd","phasdp"),{channel}=registerControl("channel"),{cut}=registerControl("cut"),{cutoff,ctf,lpf,lp}=registerControl(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv,lpe}=registerControl("lpenv","lpe"),{hpenv,hpe}=registerControl("hpenv","hpe"),{bpenv,bpe}=registerControl("bpenv","bpe"),{lpattack,lpa}=registerControl("lpattack","lpa"),{hpattack,hpa}=registerControl("hpattack","hpa"),{bpattack,bpa}=registerControl("bpattack","bpa"),{lpdecay,lpd}=registerControl("lpdecay","lpd"),{hpdecay,hpd}=registerControl("hpdecay","hpd"),{bpdecay,bpd}=registerControl("bpdecay","bpd"),{lpsustain,lps}=registerControl("lpsustain","lps"),{hpsustain,hps}=registerControl("hpsustain","hps"),{bpsustain,bps}=registerControl("bpsustain","bps"),{lprelease,lpr}=registerControl("lprelease","lpr"),{hprelease,hpr}=registerControl("hprelease","hpr"),{bprelease,bpr}=registerControl("bprelease","bpr"),{ftype}=registerControl("ftype"),{fanchor}=registerControl("fanchor"),{lprate}=registerControl("lprate"),{lpsync}=registerControl("lpsync"),{lpdepth}=registerControl("lpdepth"),{lpdepthfrequency}=registerControl("lpdepthfrequency","lpdepthfreq"),{lpshape}=registerControl("lpshape"),{lpdc}=registerControl("lpdc"),{lpskew}=registerControl("lpskew"),{bprate}=registerControl("bprate"),{bpsync}=registerControl("bpsync"),{bpdepth}=registerControl("bpdepth"),{bpdepthfrequency}=registerControl("bpdepthfrequency","bpdepthfreq"),{bpshape}=registerControl("bpshape"),{bpdc}=registerControl("bpdc"),{bpskew}=registerControl("bpskew"),{hprate}=registerControl("hprate"),{hpsync}=registerControl("hpsync"),{hpdepth,hpdepthfreq}=registerControl("hpdepth"),{hpdepthfrequency}=registerControl("hpdepthfrequency","hpdepthfreq"),{hpshape}=registerControl("hpshape"),{hpdc}=registerControl("hpdc"),{hpskew}=registerControl("hpskew"),{vib,vibrato,v}=registerControl(["vib","vibmod"],"vibrato","v"),{noise}=registerControl("noise"),{vibmod,vmod}=registerControl(["vibmod","vib"],"vmod"),{hcutoff,hpf,hp}=registerControl(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance,hpq}=registerControl("hresonance","hpq"),{resonance,lpq}=registerControl("resonance","lpq"),{djf}=registerControl("djf"),{delay}=registerControl(["delay","delaytime","delayfeedback"]),{delayfeedback,delayfb,dfb}=registerControl("delayfeedback","delayfb","dfb"),{delayspeed}=registerControl("delayspeed"),{delaytime,delayt,dt}=registerControl("delaytime","delayt","dt"),{delaysync}=registerControl("delaysync"),{lock}=registerControl("lock"),{detune,det}=registerControl("detune","det"),{unison}=registerControl("unison"),{spread}=registerControl("spread"),{dry}=registerControl("dry"),{fadeTime,fadeOutTime}=registerControl("fadeTime","fadeOutTime"),{fadeInTime}=registerControl("fadeInTime"),{freq:freq$1}=registerControl("freq"),{pattack,patt}=registerControl("pattack","patt"),{pdecay,pdec}=registerControl("pdecay","pdec"),{psustain,psus}=registerControl("psustain","psus"),{prelease,prel}=registerControl("prelease","prel"),{penv}=registerControl("penv"),{pcurve}=registerControl("pcurve"),{panchor}=registerControl("panchor"),{gate,gat}=registerControl("gate","gat"),{leslie}=registerControl("leslie"),{lrate}=registerControl("lrate"),{lsize}=registerControl("lsize"),{activeLabel}=registerControl("activeLabel"),{label}=registerControl(["label","activeLabel"]),{degree}=registerControl("degree"),{mtranspose}=registerControl("mtranspose"),{ctranspose}=registerControl("ctranspose"),{harmonic}=registerControl("harmonic"),{stepsPerOctave}=registerControl("stepsPerOctave"),{octaveR}=registerControl("octaveR"),{nudge}=registerControl("nudge"),{octave:octave$1,oct}=registerControl("octave","oct"),{orbit}=registerControl("orbit","o"),{overgain}=registerControl("overgain"),{overshape}=registerControl("overshape"),{pan}=registerControl("pan"),{panspan}=registerControl("panspan"),{pansplay}=registerControl("pansplay"),{panwidth}=registerControl("panwidth"),{panorient}=registerControl("panorient"),{rate}=registerControl("rate"),{slide}=registerControl("slide"),{semitone}=registerControl("semitone"),{voice}=registerControl("voice"),{chord:chord$1}=registerControl("chord"),{dictionary:dictionary$5,dict}=registerControl("dictionary","dict"),{anchor}=registerControl("anchor"),{offset}=registerControl("offset"),{octaves}=registerControl("octaves"),{mode:mode$1}=registerControl(["mode","anchor"]),{room}=registerControl(["room","size"]),{roomlp,rlp}=registerControl("roomlp","rlp"),{roomdim,rdim}=registerControl("roomdim","rdim"),{roomfade,rfade}=registerControl("roomfade","rfade"),{ir,iresponse}=registerControl(["ir","i"],"iresponse"),{irspeed}=registerControl("irspeed"),{irbegin}=registerControl("irbegin"),{roomsize,size,sz,rsize}=registerControl("roomsize","size","sz","rsize"),{shape}=registerControl(["shape","shapevol"]),{distort,dist:dist$2}=registerControl(["distort","distortvol","distorttype"],"dist"),{distortvol}=registerControl("distortvol","distvol"),{distorttype}=registerControl("distorttype","disttype"),{compressor}=registerControl(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee}=registerControl("compressorKnee"),{compressorRatio}=registerControl("compressorRatio"),{compressorAttack}=registerControl("compressorAttack"),{compressorRelease}=registerControl("compressorRelease"),{speed}=registerControl("speed"),{stretch}=registerControl("stretch"),{unit}=registerControl("unit"),{squiz}=registerControl("squiz"),{vowel}=registerControl("vowel"),{waveloss}=registerControl("waveloss"),{density}=registerControl("density"),{expression}=registerControl("expression"),{sustainpedal}=registerControl("sustainpedal"),{fshift}=registerControl("fshift"),{fshiftnote}=registerControl("fshiftnote"),{fshiftphase}=registerControl("fshiftphase"),{triode}=registerControl("triode"),{krush}=registerControl("krush"),{kcutoff}=registerControl("kcutoff"),{octer}=registerControl("octer"),{octersub}=registerControl("octersub"),{octersubsub}=registerControl("octersubsub"),{ring}=registerControl("ring"),{ringf}=registerControl("ringf"),{ringdf}=registerControl("ringdf"),{freeze}=registerControl("freeze"),{xsdelay}=registerControl("xsdelay"),{tsdelay}=registerControl("tsdelay"),{real}=registerControl("real"),{imag}=registerControl("imag"),{enhance}=registerControl("enhance"),{comb}=registerControl("comb"),{smear:smear$1}=registerControl("smear"),{scram}=registerControl("scram"),{binshift}=registerControl("binshift"),{hbrick}=registerControl("hbrick"),{lbrick}=registerControl("lbrick"),{frameRate}=registerControl("frameRate"),{frames}=registerControl("frames"),{hours}=registerControl("hours"),{minutes}=registerControl("minutes"),{seconds}=registerControl("seconds"),{songPtr}=registerControl("songPtr"),{uid}=registerControl("uid"),{val}=registerControl("val"),{cps}=registerControl("cps"),{clip,legato}=registerControl("clip","legato"),{duration,dur}=registerControl("duration","dur"),{zrand}=registerControl("zrand"),{curve}=registerControl("curve"),{deltaSlide}=registerControl("deltaSlide"),{pitchJump}=registerControl("pitchJump"),{pitchJumpTime}=registerControl("pitchJumpTime"),{lfo,repeatTime}=registerControl("lfo","repeatTime"),{znoise}=registerControl("znoise"),{zmod}=registerControl("zmod"),{zcrush}=registerControl("zcrush"),{zdelay}=registerControl("zdelay"),{zzfx}=registerControl("zzfx"),{color,colour}=registerControl(["color","colour"]);let createParams=(...e)=>e.reduce((t,o)=>Object.assign(t,{[o]:createParam(o)}),{});const adsr=register("adsr",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u,f,p]=e;return t.set({attack:o,decay:u,sustain:f,release:p})}),ad=register("ad",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=o]=e;return t.attack(o).decay(u)}),ds=register("ds",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=0]=e;return t.set({decay:o,sustain:u})}),ar=register("ar",(e,t)=>{e=Array.isArray(e)?e:[e];const[o,u=o]=e;return t.set({attack:o,release:u})}),{midichan}=registerControl("midichan"),{midimap}=registerControl("midimap"),{midiport}=registerControl("midiport"),{midicmd}=registerControl("midicmd"),control=register("control",(e,t)=>{if(!Array.isArray(e))throw new Error("control expects an array of [ccn, ccv]");const[o,u]=e;return t.ccn(o).ccv(u)}),{ccn}=registerControl("ccn"),{ccv}=registerControl("ccv"),{ctlNum}=registerControl("ctlNum"),{nrpnn}=registerControl("nrpnn"),{nrpv}=registerControl("nrpv"),{progNum}=registerControl("progNum"),sysex=register("sysex",(e,t)=>{if(!Array.isArray(e))throw new Error("sysex expects an array of [id, data]");const[o,u]=e;return t.sysexid(o).sysexdata(u)}),{sysexid}=registerControl("sysexid"),{sysexdata}=registerControl("sysexdata"),{midibend}=registerControl("midibend"),{miditouch}=registerControl("miditouch"),{polyTouch}=registerControl("polyTouch"),{oschost}=registerControl("oschost"),{oscport}=registerControl("oscport"),getControlName=e=>controlAlias.has(e)?controlAlias.get(e):e,as=register("as",(e,t)=>(e=Array.isArray(e)?e:[e],t.fmap(o=>(o=Array.isArray(o)?o:[o],o=Object.fromEntries(e.map((u,f)=>[getControlName(u),o[f]])),o)))),scrub=register("scrub",(e,t)=>e.outerBind(o=>{Array.isArray(o)||(o=[o]);const[u,f=1]=o;return t.begin(u).mul(speed(f)).clip(1)}),!1),controls=Object.freeze(Object.defineProperty({__proto__:null,accelerate,activeLabel,ad,adsr,amp,analyze,anchor,ar,as,att,attack,bandf,bandq,bank,bbexpr,bbst,begin,binshift,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,byteBeatExpression,byteBeatStartTime,ccn,ccv,ch,channel,channels,chord:chord$1,chorus,clip,coarse,color,colour,comb,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,control,cps,createParam,createParams,crush,ctf,ctlNum,ctranspose,curve,cut,cutoff,dec,decay,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,density,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,djf,drive,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,end,enhance,expression,fadeInTime,fadeOutTime,fadeTime,fanchor,fft,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,frameRate,frames,freeze,freq:freq$1,fshift,fshiftnote,fshiftphase,ftype,gain,gat,gate,getControlName,harmonic,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,imag,ir,irbegin,iresponse,irspeed,isControlName,kcutoff,krush,label,lbrick,legato,leslie,lfo,lock,loop,loopBegin,loopEnd,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mode:mode$1,mtranspose,n,noise,note:note$2,nrpnn,nrpv,nudge,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,offset,orbit,oschost,oscport,overgain,overshape,pan,panchor,panorient,panspan,pansplay,panwidth,patt,pattack,pcurve,pdec,pdecay,penv,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phc,phd,phs,pitchJump,pitchJumpTime,polyTouch,postgain,prel,prelease,progNum,psus,psustain,pw,pwrate,pwsweep,rate,rdim,real,registerControl,rel,release,repeatTime,resonance,rfade,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rsize,s,scram,scrub,seconds,semitone,shape,size,slide,smear:smear$1,songPtr,sound,source,speed,spread,squiz,src,stepsPerOctave,stretch,sus,sustain,sustainpedal,sysex,sysexdata,sysexid,sz,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,triode,tsdelay,uid,unison,unit,v,val,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xsdelay,zcrush,zdelay,zmod,znoise,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),left=function(e,t){const[o,u]=e,[f,p]=t,[g,M]=splitAt(u,f);return[[u,o-u],[zipWith((F,S)=>F.concat(S),g,p),M]]},right=function(e,t){const[o,u]=e,[f,p]=t,[g,M]=splitAt(o,p);return[[o,u-o],[zipWith((S,k)=>S.concat(k),f,g),M]]},_bjorklund=function(e,t){const[o,u]=e;return Math.min(o,u)<=1?[e,t]:_bjorklund(...o>u?left(e,t):right(e,t))},bjorklund=function(e,t){const o=e<0,u=Math.abs(e),f=t-u,p=Array(u).fill([1]),g=Array(f).fill([0]),M=_bjorklund([u,f],[p,g]),F=flatten(M[1][0]).concat(flatten(M[1][1]));return o?F.map(S=>1-S):F},_euclidRot=function(e,t,o){const u=bjorklund(e,t);return o?rotate$2(u,-o):u},euclid=register("euclid",function(e,t,o){return o.struct(_euclidRot(e,t,0))}),bjork=register("bjork",function(e,t){Array.isArray(e)||(e=[e]);const[o,u=o,f=0]=e;return t.struct(_euclidRot(o,u,f))}),{euclidrot,euclidRot}=register(["euclidrot","euclidRot"],function(e,t,o,u){return u.struct(_euclidRot(e,t,o))}),_euclidLegato=function(e,t,o,u){if(e<1)return silence;const p=_euclidRot(e,t,0).join("").split("1").slice(1).map(g=>[g.length+1,!0]);return u.struct(timeCat(...p)).late(Fraction(o).div(t))},euclidLegato=register(["euclidLegato"],function(e,t,o){return _euclidLegato(e,t,0,o)}),euclidLegatoRot=register(["euclidLegatoRot"],function(e,t,o,u){return _euclidLegato(e,t,o,u)}),{euclidish,eish}=register(["euclidish","eish"],function(e,t,o,u){const f=_morph(bjorklund(e,t),new Array(e).fill(1),o);return u.struct(f).setSteps(t)});function createClock(e,t,o=.05,u=.1,f=.1,p=globalThis.setInterval,g=globalThis.clearInterval,M=!0){let F=0,S=0,k=10**4,N=.01;const $=te=>o=te(o);f=f||u/2;const R=()=>{const te=e(),re=te+u+f;for(S===0&&(S=te+N);S<re;)S=M?Math.round(S*k)/k:S,t(S,o,F,te),S+=o,F++};let U;const O=()=>{Z(),R(),U=p(R,u*1e3)},Z=()=>{U!==void 0&&g(U),U=void 0};return{setDuration:$,start:O,stop:()=>{F=0,S=0,Z()},pause:()=>Z(),duration:o,interval:u,getPhase:()=>S,minLatency:N}}function steady(e){return new Pattern$1(t=>[new Hap(void 0,t.span,e)])}const signal=e=>{const t=o=>[new Hap(void 0,o.span,e(o.span.begin))];return new Pattern$1(t)},saw=signal(e=>e%1),saw2=saw.toBipolar(),isaw=signal(e=>1-e%1),isaw2=isaw.toBipolar(),sine2=signal(e=>Math.sin(Math.PI*2*e)),sine=sine2.fromBipolar(),cosine=sine._early(Fraction(1).div(4)),cosine2=sine2._early(Fraction(1).div(4)),square=signal(e=>Math.floor(e*2%2)),square2=square.toBipolar(),tri=fastcat(saw,isaw),tri2=fastcat(saw2,isaw2),itri=fastcat(isaw,saw),itri2=fastcat(isaw2,saw2),time$1=signal(id);let _mouseY=0,_mouseX=0;typeof window<"u"&&document.addEventListener("mousemove",e=>{_mouseY=e.clientY/document.body.clientHeight,_mouseX=e.clientX/document.body.clientWidth});const mousey=signal(()=>_mouseY),mouseY=signal(()=>_mouseY),mousex=signal(()=>_mouseX),mouseX=signal(()=>_mouseX),xorwise=e=>{const t=e<<13^e,o=t>>17^t;return o<<5^o},_frac=e=>e-Math.trunc(e),timeToIntSeed=e=>xorwise(Math.trunc(_frac(e/300)*536870912)),intSeedToRand=e=>e%536870912/536870912,timeToRand=e=>Math.abs(intSeedToRand(timeToIntSeed(e))),timeToRandsPrime=(e,t)=>{const o=[];for(let u=0;u<t;++u)o.push(intSeedToRand(e)),e=xorwise(e);return o},timeToRands=(e,t)=>timeToRandsPrime(timeToIntSeed(e),t),run=e=>saw.range(0,e).round().segment(e),binary=e=>{const t=reify(e).log2(0).floor().add(1);return binaryN(e,t)},binaryN=(e,t=16)=>{t=reify(t);const o=run(t).mul(-1).add(t.sub(1));return reify(e).segment(t).brshift(o).band(pure(1))},binaryL=e=>{const t=reify(e).log2(0).floor().add(1);return binaryNL(e,t)},binaryNL=(e,t=16)=>reify(e).withValue(o=>u=>{const f=[];for(let p=u-1;p>=0;p--)f.push(o>>p&1);return f}).appLeft(reify(t)),randL=e=>signal(t=>o=>timeToRands(t,o).map(Math.abs)).appLeft(reify(e)),randrun=e=>signal(t=>{const u=timeToRands(t.floor().add(.5),e).map((p,g)=>[p,g]).sort((p,g)=>(p[0]>g[0])-(p[0]<g[0])).map(p=>p[1]),f=t.cyclePos().mul(e).floor()%e;return u[f]})._segment(e),_rearrangeWith=(e,t,o)=>{const u=[...Array(t).keys()].map(f=>o.zoom(Fraction(f).div(t),Fraction(f+1).div(t)));return e.fmap(f=>u[f].repeatCycles(t)._fast(t)).innerJoin()},shuffle$2=register("shuffle",(e,t)=>_rearrangeWith(randrun(e),e,t)),scramble=register("scramble",(e,t)=>_rearrangeWith(_irand(e)._segment(e),e,t)),rand=signal(timeToRand),rand2=rand.toBipolar(),_brandBy=e=>rand.fmap(t=>t<e),brandBy=e=>reify(e).fmap(_brandBy).innerJoin(),brand=_brandBy(.5),_irand=e=>rand.fmap(t=>Math.trunc(t*e)),irand=e=>reify(e).fmap(_irand).innerJoin(),__chooseWith=(e,t)=>(t=t.map(reify),t.length==0?silence:e.range(0,t.length).fmap(o=>{const u=Math.min(Math.max(Math.floor(o),0),t.length-1);return t[u]})),chooseWith=(e,t)=>__chooseWith(e,t).outerJoin(),chooseInWith=(e,t)=>__chooseWith(e,t).innerJoin(),choose=(...e)=>chooseWith(rand,e),chooseIn=(...e)=>chooseInWith(rand,e),chooseOut=choose;Pattern$1.prototype.choose=function(...e){return chooseWith(this,e)},Pattern$1.prototype.choose2=function(...e){return chooseWith(this.fromBipolar(),e)};const chooseCycles=(...e)=>chooseInWith(rand.segment(1),e),randcat=chooseCycles,_wchooseWith=function(e,...t){const o=t.map(M=>reify(M[0])),u=[];let f=pure(0);for(const M of t)f=f.add(M[1]),u.push(f);const p=sequenceP(u),g=function(M){const F=f.mul(M);return p.fmap(S=>k=>o[S.findIndex(N=>N>k,S)]).appLeft(F)};return e.bind(g)},wchooseWith=(...e)=>_wchooseWith(...e).outerJoin(),wchoose=(...e)=>wchooseWith(rand,...e),wchooseCycles=(...e)=>_wchooseWith(rand.segment(1),...e).innerJoin(),wrandcat=wchooseCycles;function _perlin(e){let t=Math.floor(e),o=t+1;const u=g=>6*g**5-15*g**4+10*g**3;return(g=>M=>F=>M+u(g)*(F-M))(e-t)(timeToRand(t))(timeToRand(o))}const perlinWith=e=>e.fmap(_perlin);function _berlin(e){const t=Math.floor(e),o=t+1,u=timeToRand(t),f=timeToRand(o)+u,p=(e-t)/(o-t);return((M,F,S)=>M+(F-M)*S)(u,f,p)/2}const berlinWith=e=>e.fmap(_berlin),perlin=perlinWith(time$1.fmap(e=>Number(e))),berlin=berlinWith(time$1.fmap(e=>Number(e))),degradeByWith=register("degradeByWith",(e,t,o)=>o.fmap(u=>f=>u).appLeft(e.filterValues(u=>u>t)),!0,!0),degradeBy=register("degradeBy",function(e,t){return t._degradeByWith(rand,e)},!0,!0),degrade=register("degrade",e=>e._degradeBy(.5),!0,!0),undegradeBy=register("undegradeBy",function(e,t){return t._degradeByWith(rand.fmap(o=>1-o),e)},!0,!0),undegrade=register("undegrade",e=>e._undegradeBy(.5),!0,!0),sometimesBy=register("sometimesBy",function(e,t,o){return reify(e).fmap(u=>stack(o._degradeBy(u),t(o._undegradeBy(1-u)))).innerJoin()}),sometimes=register("sometimes",function(e,t){return t._sometimesBy(.5,e)}),someCyclesBy=register("someCyclesBy",function(e,t,o){return reify(e).fmap(u=>stack(o._degradeByWith(rand._segment(1),u),t(o._degradeByWith(rand.fmap(f=>1-f)._segment(1),1-u)))).innerJoin()}),someCycles=register("someCycles",function(e,t){return t._someCyclesBy(.5,e)}),often=register("often",function(e,t){return t.sometimesBy(.75,e)}),rarely=register("rarely",function(e,t){return t.sometimesBy(.25,e)}),almostNever=register("almostNever",function(e,t){return t.sometimesBy(.1,e)}),almostAlways=register("almostAlways",function(e,t){return t.sometimesBy(.9,e)}),never=register("never",function(e,t){return t}),always=register("always",function(e,t){return e(t)});function _keyDown(e){Array.isArray(e)===!1&&(e=[e]);const t=getCurrentKeyboardState();return e.every(o=>{const u=keyAlias.get(o)??o;return t[u]})}const whenKey=register("whenKey",function(e,t,o){return o.when(_keyDown(e),t)}),keyDown=register("keyDown",function(e){return e.fmap(_keyDown)}),_pick=function(e,t,o=!0){const u=Array.isArray(e),f=Object.keys(e).length;return e=objectMap(e,reify),f===0?silence:t.fmap(p=>{let g=p;return u&&(g=o?Math.round(g)%f:clamp$1(Math.round(g),0,e.length-1)),e[g]})},pick=function(e,t){return Array.isArray(t)&&([t,e]=[e,t]),__pick(e,t)},__pick=register("pick",function(e,t){return _pick(e,t,!1).innerJoin()}),pickmod=register("pickmod",function(e,t){return _pick(e,t,!0).innerJoin()}),pickF=register("pickF",function(e,t,o){return o.apply(pick(e,t))}),pickmodF=register("pickmodF",function(e,t,o){return o.apply(pickmod(e,t))}),pickOut=register("pickOut",function(e,t){return _pick(e,t,!1).outerJoin()}),pickmodOut=register("pickmodOut",function(e,t){return _pick(e,t,!0).outerJoin()}),pickRestart=register("pickRestart",function(e,t){return _pick(e,t,!1).restartJoin()}),pickmodRestart=register("pickmodRestart",function(e,t){return _pick(e,t,!0).restartJoin()}),pickReset=register("pickReset",function(e,t){return _pick(e,t,!1).resetJoin()}),pickmodReset=register("pickmodReset",function(e,t){return _pick(e,t,!0).resetJoin()}),{inhabit,pickSqueeze}=register(["inhabit","pickSqueeze"],function(e,t){return _pick(e,t,!1).squeezeJoin()}),{inhabitmod,pickmodSqueeze}=register(["inhabitmod","pickmodSqueeze"],function(e,t){return _pick(e,t,!0).squeezeJoin()}),squeeze=(e,t)=>(t=t.map(reify),t.length==0?silence:e.fmap(o=>{const u=_mod$2(Math.round(o),t.length);return t[u]}).squeezeJoin());let synth;try{synth=window?.speechSynthesis}catch(e){console.warn("cannot use window: not in browser?")}let allVoices=synth?.getVoices();function triggerSpeech(e,t,o){synth.cancel();const u=new SpeechSynthesisUtterance(e);u.lang=t,allVoices=synth.getVoices();const f=allVoices.filter(p=>p.lang.includes(t));typeof o=="number"?u.voice=f[o%f.length]:typeof o=="string"&&(u.voice=f.find(p=>p.name===p)),speechSynthesis.speak(u)}const speak=register("speak",function(e,t,o){return o.onTrigger(u=>{triggerSpeech(u.value,e,t)})}),strudelScope={},evalScope$1=async(...e)=>{const t=await Promise.allSettled(e),o=t.filter(u=>u.status==="fulfilled").map(u=>u.value);return t.forEach((u,f)=>{u.status==="rejected"&&console.warn(`evalScope: module with index ${f} could not be loaded:`,u.reason)}),o.forEach(u=>{Object.entries(u).forEach(([f,p])=>{globalThis[f]=p,strudelScope[f]=p})}),o};function safeEval(e,t={}){const{wrapExpression:o=!0,wrapAsync:u=!0}=t;o&&(e=`{${e}}`),u&&(e=`(async ()=>${e})()`);const f=`"use strict";return (${e})`;return Function(f)()}const evaluate$1=async(e,t,o)=>{let u={};if(t){const g=t(e,o);e=g.output,u=g}return{mode:"javascript",pattern:await safeEval(e,{wrapExpression:!!t}),meta:u}},jsContent=`(function(){"use strict";function L(){return performance.now()*.001}let _=0,r=0,o=.5;const h=new Map,m=.1,M=new BroadcastChannel("strudeltick"),b=(s,e)=>{M.postMessage({type:s,payload:e})},C=E(L,(s,e,t,n)=>{const i=r*e,d=s-n,c=n+d,u=i*o,l=_+u,g=n-c-e,f=e*o,p=l+f,y=l+g*o;b("tick",{begin:l,end:p,cps:o,time:n,cycle:y}),r++},m);let k=!1;const I=s=>{h.set(s,{started:!0}),!k&&(C.start(),k=!0)},A=async s=>{h.set(s,{started:!1});const e=Array.from(h.values()).some(t=>t.started);!k||e||(C.stop(),w(0),k=!1)},w=s=>{r=0,_=s},D=s=>{const{type:e,payload:t}=s;switch(e){case"cpschange":{if(t.cps!==o){const n=r*m;_=_+n*o,o=t.cps,r=0}break}case"setcycle":{w(t.cycle);break}case"toggle":{t.started?I(s.id):A(s.id);break}}};self.onconnect=function(s){const e=s.ports[0];e.addEventListener("message",function(t){D(t.data)}),e.start()};function E(s,e,t=.05,n=.1,i=.1){let d=0,c=0,u=10**4,l=.01;const g=a=>t=a(t);i=i||n/2;const f=()=>{const a=s(),O=a+n+i;for(c===0&&(c=a+l);c<O;)c=Math.round(c*u)/u,c>=a&&e(c,t,d,a),c<a&&console.log("TOO LATE",c),c+=t,d++};let p;const y=()=>{T(),f(),p=setInterval(f,n*1e3)},T=()=>p!==void 0&&clearInterval(p);return{setDuration:g,start:y,stop:()=>{d=0,c=0,T()},pause:()=>T(),duration:t,interval:n,getPhase:()=>c,minLatency:l}}})();
`,blob=typeof self<"u"&&self.Blob&&new Blob(["(self.URL || self.webkitURL).revokeObjectURL(self.location.href);",jsContent],{type:"text/javascript;charset=utf-8"});function WorkerWrapper(e){let t;try{if(t=blob&&(self.URL||self.webkitURL).createObjectURL(blob),!t)throw"";const o=new Worker(t,{name:e?.name});return o.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),o}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(jsContent),{name:e?.name})}}class NeoCyclist{constructor({onTrigger:t,onToggle:o,getTime:u}){this.started=!1,this.cps=.5,this.getTime=u,this.time_at_last_tick_message=0,this.collator=new ClockCollator({getTargetClockTime:u}),this.onToggle=o,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(WorkerWrapper),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const f=g=>{const{cps:M,begin:F,end:S,cycle:k,time:N}=g;this.cps=M,this.cycle=k;const $=this.collator.calculateOffset(N)+N;p(F,S,$),this.time_at_last_tick_message=$},p=(g,M,F)=>{if(this.started===!1)return;this.pattern.queryArc(g,M,{_cps:this.cps,cyclist:"neocyclist"}).forEach(k=>{if(k.hasOnset()){const $=cycleToSeconds$1(k.whole.begin-this.cycle,this.cps)+F+this.latency,R=cycleToSeconds$1(k.duration,this.cps);t?.(k,0,R,this.cps,$)}})};this.channel.onmessage=g=>{if(!this.started)return;const{payload:M,type:F}=g.data;switch(F){case"tick":f(M)}}}sendMessage(t,o){this.worker.port.postMessage({type:t,payload:o,id:this.id})}now(){const t=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+t}setCps(t=1){this.sendMessage("cpschange",{cps:t})}setCycle(t){this.sendMessage("setcycle",{cycle:t})}setStarted(t){this.sendMessage("toggle",{started:t}),this.started=t,this.onToggle?.(t)}start(){logger$2("[cyclist] start"),this.setStarted(!0)}stop(){logger$2("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(t,o=!1){this.pattern=t,o&&!this.started&&this.start()}log(t,o,u){const f=u.filter(p=>p.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(f.length).fill("I").join("")}`)}}class Cyclist{constructor({interval:t,onTrigger:o,onToggle:u,onError:f,getTime:p,latency:g=.1,setInterval:M,clearInterval:F,beforeStart:S}){this.started=!1,this.beforeStart=S,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=p,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=u,this.latency=g,this.clock=createClock(p,(k,N,$,R)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=k),this.num_ticks_since_cps_change++;const O=this.num_ticks_since_cps_change*N*this.cps;try{const Z=this.lastEnd;this.lastBegin=Z;const K=this.num_cycles_at_cps_change+O;if(this.lastEnd=K,this.lastTick=k,k<R){console.log("skip query: too late");return}this.pattern.queryArc(Z,K,{_cps:this.cps,cyclist:"cyclist"}).forEach(de=>{if(de.hasOnset()){const te=(de.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+g,re=de.duration/this.cps,ue=te-k;o?.(de,ue,re,this.cps,te),de.value.cps!==void 0&&this.cps!=de.value.cps&&(this.cps=de.value.cps,this.num_ticks_since_cps_change=0)}})}catch(Z){errorLogger$1(Z),f?.(Z)}},t,.1,.1,M,F)}now(){if(!this.started)return 0;const t=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+t*this.cps}setStarted(t){this.started=t,this.onToggle?.(t)}async start(){if(await this.beforeStart?.(),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");logger$2("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){logger$2("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){logger$2("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(t,o=!1){this.pattern=t,o&&!this.started&&await this.start()}setCps(t=.5){this.cps!==t&&(this.cps=t,this.num_ticks_since_cps_change=0)}log(t,o,u){const f=u.filter(p=>p.hasOnset());console.log(`${t.toFixed(4)} - ${o.toFixed(4)} ${Array(f.length).fill("I").join("")}`)}}let time;function getTime(){if(!time)throw new Error("no time set! use setTime to define a time source");return time()}function setTime(e){time=e}function repl$1({defaultOutput:e,onEvalError:t,beforeEval:o,beforeStart:u,afterEval:f,getTime:p,transpiler:g,onToggle:M,editPattern:F,onUpdateState:S,sync:k=!1,setInterval:N,clearInterval:$,id:R,mondo:U=!1}){const O={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},Z={id:R},K=ke=>{Object.assign(O,ke),O.isDirty=O.code!==O.activeCode,O.error=O.evalError||O.schedulerError,S?.(O)},ie={onTrigger:getTrigger({defaultOutput:e,getTime:p}),getTime:p,onToggle:ke=>{K({started:ke}),M?.(ke)},setInterval:N,clearInterval:$,beforeStart:u},de=k&&typeof SharedWorker<"u"?new NeoCyclist(ie):new Cyclist(ie);let te={},re=0,ue;const ve=function(){return te={},re=0,ue=void 0,silence};function Ae(ke){return ke._Pattern?ke.__pure:ke}const Fe=async(ke,at=!0)=>(ke=F?.(ke)||ke,await de.setPattern(ke,at),ke);setTime(()=>de.now());const we=()=>de.stop(),Ce=()=>de.start(),be=()=>de.pause(),le=()=>de.toggle(),Ze=ke=>(de.setCps(Ae(ke)),silence),Je=ke=>(de.setCps(Ae(ke)/60),silence);let Qe=[];const rt=function(ke){return Qe.push(ke),silence},tt=function(ke){return ue=ke,silence},kt=()=>{Pattern$1.prototype.p=function(at){return typeof at=="string"&&(at.startsWith("_")||at.endsWith("_"))?silence:(at.includes("$")&&(at=`${at}${re}`,re++),te[at]=this,this)},Pattern$1.prototype.q=function(at){return silence};try{for(let at=1;at<10;++at)Object.defineProperty(Pattern$1.prototype,`d${at}`,{get(){return this.p(at)},configurable:!0}),Object.defineProperty(Pattern$1.prototype,`p${at}`,{get(){return this.p(at)},configurable:!0}),Pattern$1.prototype[`q${at}`]=silence}catch(at){console.warn("injectPatternMethods: error:",at)}const ke=register("cpm",function(at,je){return je._fast(at/60/de.cps)});return evalScope$1({all:rt,each:tt,hush:ve,cpm:ke,setCps:Ze,setcps:Ze,setCpm:Je,setcpm:Je})};return{scheduler:de,evaluate:async(ke,at=!0,je=!0)=>{if(!ke)throw new Error("no code to evaluate");try{K({code:ke,pending:!0}),await kt(),setTime(()=>de.now()),await o?.({code:ke}),Qe=[],je&&ve(),U&&(ke=`mondolang\`${ke}\``);let{pattern:Ie,meta:nt}=await evaluate$1(ke,g,Z);if(Object.keys(te).length){let pt=[],Ft=!1;for(const[ht,Zt]of Object.entries(te)){const Qt=ht.length>1&&ht.startsWith("S");if(Qt&&Ft===!1&&(pt=[],Ft=!0),!Ft||Ft&&Qt){const Bt=Zt.withState(_t=>_t.setControls({id:ht}));pt.push(Bt)}}ue&&(pt=pt.map(ht=>ue(ht))),Ie=stack(...pt)}else ue&&(Ie=ue(Ie));if(Qe.length)for(const pt of Qe)Ie=pt(Ie);return isPattern(Ie)||(Ie=silence),logger$2("[eval] code updated"),Ie=await Fe(Ie,at),K({miniLocations:nt?.miniLocations||[],widgets:nt?.widgets||[],activeCode:ke,pattern:Ie,evalError:void 0,schedulerError:void 0,pending:!1}),f?.({code:ke,pattern:Ie,meta:nt}),Ie}catch(Ie){logger$2(`[eval] error: ${Ie.message}`,"error"),console.error(Ie),K({evalError:Ie,pending:!1}),t?.(Ie)}},start:Ce,stop:we,pause:be,setCps:Ze,setPattern:Fe,setCode:ke=>K({code:ke}),toggle:le,state:O}}const getTrigger=({getTime:e,defaultOutput:t})=>async(o,u,f,p,g)=>{try{(!o.context.onTrigger||!o.context.dominantTrigger)&&await t(o,u,f,p,g),o.context.onTrigger&&await o.context.onTrigger(o,e(),p,g)}catch(M){errorLogger$1(M,"getTrigger")}},backgroundImage=function(e,t={}){const o=document.getElementById("code"),u="background-image:url("+e+");background-size:contain;";o.style=u;const{className:f}=o,p=(F,S)=>{({style:()=>o.style=u+";"+S,className:()=>o.className=S+" "+f})[F]()},g=Object.entries(t).filter(([F,S])=>typeof S=="function");Object.entries(t).filter(([F,S])=>typeof S=="string").forEach(([F,S])=>p(F,S)),g.length},cleanupUi=()=>{const e=document.getElementById("code");e&&(e.style="")};logger$2("🌀 @strudel/core loaded 🌀"),globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`),globalThis._strudelLoaded=!0;const strudelCore=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator,Cyclist,Fraction,Hap,Pattern:Pattern$1,State,TimeSpan,__chooseWith,_brandBy,_fitslice,_irand,_keyDown,_match,_mod:_mod$2,_morph,_polymeterListSteps,_retime,_slices,accelerate,activeLabel,ad,add:add$7,adsr,almostAlways,almostNever,always,amp,analyze,anchor,and,apply,applyN,ar,arp,arpWith,arrange,as,att,attack,averageArray,backgroundImage,band,bandf,bandq,bank,base64ToUnicode,bbexpr,bbst,beat,begin,berlin,berlinWith,binary,binaryL,binaryN,binaryNL,bind,binshift,bite,bjork,bjorklund,blshift,bor,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,brak,brand,brandBy,brshift,bxor,bypass,byteBeatExpression,byteBeatStartTime,calculateSteps,cat,ccn,ccv,ceil,ch,channel,channels,choose,chooseCycles,chooseIn,chooseInWith,chooseOut,chooseWith,chop,chord:chord$1,chorus,chunk,chunkBack,chunkBackInto,chunkInto,chunkback,chunkbackinto,chunkinto,clamp:clamp$1,cleanupUi,clip,coarse,code2hash,color,colour,comb,compose,compress,compressSpan,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,compressspan,constant,contract,control,controls,cosine,cosine2,cpm,cps,createClock,createParam,createParams,crush,ctf,ctlNum,ctranspose,curry,curve,cut,cutoff,cycleToSeconds:cycleToSeconds$1,dec,decay,degrade,degradeBy,degradeByWith,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,det,detune,dfb,dict,dictionary:dictionary$5,dist:dist$2,distort,distorttype,distortvol,div,djf,drawLine,drive,drop,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,early,echo,echoWith,echowith,eish,end,enhance,eq,eqt,errorLogger:errorLogger$1,euclid,euclidLegato,euclidLegatoRot,euclidRot,euclidish,euclidrot,evalScope:evalScope$1,evaluate:evaluate$1,every,expand,expression,extend,fadeInTime,fadeOutTime,fadeTime,fanchor,fast,fastChunk,fastGap,fastcat,fastchunk,fastgap,fft,filter:filter$1,filterWhen,firstOf,fit,flatten,floor,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,focus,focusSpan,focusspan,fractionalArgs,frameRate,frames,freeze,freq:freq$1,freqToMidi:freqToMidi$2,fromBipolar,fshift,fshiftnote,fshiftphase,ftype,func,gain,gap,gat,gate,getAccidentalsOffset:getAccidentalsOffset$1,getControlName,getCurrentKeyboardState,getEventOffsetMs,getFreq,getFrequency,getPerformanceTimeSeconds,getPlayableNoteValue,getSoundIndex:getSoundIndex$1,getTime,getTrigger,grow,gt,gte,harmonic,hash2code,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,hsl,hsla,hurry,id,imag,inhabit,inhabitmod,innerBind,inside,inv,invert:invert$1,ir,irand,irbegin,iresponse,irspeed,isControlName,isNote,isNoteWithOctave,isPattern,isaw,isaw2,iter,iterBack,iterback,itri,itri2,jux,juxBy,juxby,kcutoff,keep,keepif,keyAlias,keyDown,krush,label,lastOf,late,lbrick,legato,leslie,lfo,linger,listRange,lock,logKey,logger:logger$2,loop,loopAt,loopAtCps,loopBegin,loopEnd,loopat,loopatcps,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,lt,lte,mapArgs,mask,midi2note:midi2note$1,midiToFreq:midiToFreq$2,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mod:mod$3,mode:mode$1,morph,mouseX,mouseY,mousex,mousey,mtranspose,mul,n,nanFallback:nanFallback$1,ne,net,never,noise,note:note$2,noteToMidi:noteToMidi$1,nothing,nrpnn,nrpv,nudge,numeralArgs,objectMap,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,off,offset,often,or,orbit,oschost,oscport,outerBind,outside,overgain,overshape,pace,pairs,palindrome,pan,panchor,panorient,panspan,pansplay,panwidth,parray,parseFractional,parseNumeral,partials,patt,pattack,pcurve,pdec,pdecay,penv,perlin,perlinWith,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phases,phc,phd,phs,pick,pickF,pickOut,pickReset,pickRestart,pickSqueeze,pickmod,pickmodF,pickmodOut,pickmodReset,pickmodRestart,pickmodSqueeze,pipe,pitchJump,pitchJumpTime,ply,plyForEach,plyWith,pm,polyBind,polyTouch,polymeter,polyrhythm,postgain,pow,pr,prel,prelease,press,pressBy,progNum,psus,psustain,pure,pw,pwrate,pwsweep,rand,rand2,randL,randcat,randrun,range:range$2,range2,rangex,rarely,rate,ratio,rdim,real,ref:ref$1,register,registerControl,reify,rel,release,removeUndefineds,repeatCycles,repeatTime,repl:repl$1,replicate,resonance,rev,revv,rfade,rib,ribbon,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rotate:rotate$2,round,rsize,run,s,s_add,s_alt,s_cat,s_contract,s_expand,s_extend,s_polymeter,s_sub,s_taper,s_taperlist,s_tour,s_zip,saw,saw2,scram,scramble,scrub,seconds,seg,segment,semitone,seq,seqPLoop,sequence,sequenceP,set,setStringParser,setTime,shape,shrink,shrinklist,shuffle:shuffle$2,signal,silence,sine,sine2,size,slice,slide,slow,slowChunk,slowcat,slowcatPrime,slowchunk,smear:smear$1,sol2note,someCycles,someCyclesBy,sometimes,sometimesBy,songPtr,sound,source,sparsity,speak,speed,splice,splitAt,spread,square,square2,squeeze,squeezeBind,squiz,src,stack,stackBy,stackCentre,stackLeft,stackRight,steady,stepBind,stepalt,stepcat,steps:steps$2,stepsPerOctave,stretch,striate,stringifyValues,struct,strudelScope,stut,stutWith,stutwith,sub,superimpose,sus,sustain,sustainpedal,swing,swingBy,sysex,sysexdata,sysexid,sz,take,time:time$1,timeCat,timecat,toBipolar,tokenizeNote:tokenizeNote$3,tour,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,tri,tri2,triode,tsdelay,uid,undegrade,undegradeBy,unicodeToBase64,uniq,uniqsort,uniqsortr,unison,unit,v,val,valueToMidi:valueToMidi$1,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wchoose,wchooseCycles,when,whenKey,withValue,within,wrandcat,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xfade,xsdelay,zcrush,zdelay,zip,zipWith,zmod,znoise,zoom,zoomArc,zoomarc,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),randOffset=3e-4,applyOptions=(e,t)=>(o,u)=>{const g=e.source_[u].options_?.ops,M=o.__steps_source;if(g)for(const F of g)switch(F.type_){case"stretch":{const S=["fast","slow"],{type:k,amount:N}=F.arguments_;if(!S.includes(k))throw new Error(`mini: stretch: type must be one of ${S.join("|")} but got ${k}`);o=reify(o)[k](t(N));break}case"replicate":{const{amount:S}=F.arguments_;o=reify(o),o=o._repeatCycles(S)._fast(S);break}case"bjorklund":{F.arguments_.rotation?o=o.euclidRot(t(F.arguments_.pulse),t(F.arguments_.step),t(F.arguments_.rotation)):o=o.euclid(t(F.arguments_.pulse),t(F.arguments_.step));break}case"degradeBy":{o=reify(o)._degradeByWith(rand.early(randOffset*F.arguments_.seed),F.arguments_.amount??.5);break}case"tail":{const S=t(F.arguments_.element);o=o.fmap(k=>N=>Array.isArray(k)?[...k,N]:[k,N]).appLeft(S);break}case"range":{const S=t(F.arguments_.element);o=reify(o);const k=($,R,U=1)=>Array.from({length:Math.abs(R-$)/U+1},(O,Z)=>$<R?$+Z*U:$-Z*U);o=(($,R)=>$.squeezeBind(U=>R.bind(O=>fastcat(...k(U,O)))))(o,S);break}default:console.warn(`operator "${F.type_}" not implemented`)}return o.__steps_source=o.__steps_source||M,o};function patternifyAST(e,t,o,u=0){o?.(e);const f=p=>patternifyAST(p,t,o,u);switch(e.type_){case"pattern":{const p=e.source_.map(S=>f(S)).map(applyOptions(e,f)),g=e.arguments_.alignment,M=p.filter(S=>S.__steps_source);let F;switch(g){case"stack":{F=stack(...p),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"polymeter_slowcat":{F=stack(...p.map(S=>S._slow(S.__weight))),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"polymeter":{const S=e.arguments_.stepsPerCycle?f(e.arguments_.stepsPerCycle).fmap(N=>Fraction(N)):pure(Fraction(p.length>0?p[0].__weight:1)),k=p.map(N=>N.fast(S.fmap($=>$.div(N.__weight))));F=stack(...k);break}case"rand":{F=chooseInWith(rand.early(randOffset*e.arguments_.seed).segment(1),p),M.length&&(F._steps=lcm(...M.map(S=>Fraction(S._steps))));break}case"feet":{F=fastcat(...p);break}default:{if(e.source_.some(k=>!!k.options_?.weight)){const k=e.source_.reduce((N,$)=>N.add($.options_?.weight||Fraction(1)),Fraction(0));F=timeCat(...e.source_.map((N,$)=>[N.options_?.weight||Fraction(1),p[$]])),F.__weight=k,F._steps=k,M.length&&(F._steps=F._steps.mul(lcm(...M.map(N=>Fraction(N._steps)))))}else F=sequence(...p),F._steps=p.length;e.arguments_._steps&&(F.__steps_source=!0)}}return M.length&&(F.__steps_source=!0),F}case"element":return f(e.source_);case"atom":{if(e.source_==="~"||e.source_==="-")return silence;if(!e.location_)return console.warn("no location for",e),e.source_;const p=isNaN(Number(e.source_))?e.source_:Number(e.source_);if(u===-1)return pure(p);const[g,M]=getLeafLocation(t,e,u);return pure(p).withLoc(g,M)}case"stretch":return f(e.source_).slow(f(e.arguments_.amount));default:return console.warn(`node type "${e.type_}" not implemented -> returning silence`),silence}}const getLeafLocation=(e,t,o=0)=>{const{start:u,end:f}=t.location_,p=e?.split("").slice(u.offset,f.offset).join(""),[g=0,M=0]=p?p.split(t.source_).map(F=>F.split("").filter(S=>S===" ").length):[];return[u.offset+g+o,f.offset-M+o]},mini2ast=(e,t=0,o=e)=>{try{return peg$parse(e)}catch(u){const f=[u.location.start.offset+t,u.location.end.offset+t],p=o.slice(0,f[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${p}: ${u.message}`)}},getLeaves=(e,t,o)=>{const u=mini2ast(e,t,o);let f=[];return patternifyAST(u,e,p=>{p.type_==="atom"&&f.push(p)},-1),f},getLeafLocations=(e,t=0,o)=>getLeaves(e,t,o).map(u=>getLeafLocation(e,u,t)),mini=(...e)=>{const t=e.map(o=>{const u=`"${o}"`,f=mini2ast(u);return patternifyAST(f,u)});return sequence(...t)},m$1=(e,t)=>{const o=`"${e}"`,u=mini2ast(o);return patternifyAST(u,o,null,t)},h$1=e=>{const t=mini2ast(e);return patternifyAST(t,e)};function minify(e){return typeof e=="string"?mini(e):reify(e)}function miniAllStrings(){setStringParser(mini)}const strudelMini=Object.freeze(Object.defineProperty({__proto__:null,StartRules:peg$allowedStartRules,SyntaxError:peg$SyntaxError,getLeafLocation,getLeafLocations,getLeaves,h:h$1,m:m$1,mini,mini2ast,miniAllStrings,minify,parse:peg$parse,patternifyAST},Symbol.toStringTag,{value:"Module"}));if(typeof DelayNode<"u"){class e extends DelayNode{constructor(o,u,f,p){super(o),u=Math.abs(u),this.delayTime.value=f;const g=o.createGain();g.gain.value=Math.min(Math.abs(p),.995),this.feedback=g.gain;const M=o.createGain();return M.gain.value=u,this.delayGain=M,this.connect(g),this.connect(M),g.connect(this),this.connect=F=>M.connect(F),this}start(o){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,o+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(t,o,u){return new e(this,t,o,u)}}var reverbGen={};reverbGen.generateReverb=function(e,t){for(var o=e.audioContext||new AudioContext,u=o.sampleRate,f=e.numChannels||2,p=e.decayTime*1.5,g=Math.round(e.decayTime*u),M=Math.round(p*u),F=Math.round((e.fadeInTime||0)*u),S=Math.pow(1/1e3,1/g),k=o.createBuffer(f,M,u),N=0;N<f;N++){for(var $=k.getChannelData(N),R=0;R<M;R++)$[R]=randomSample()*Math.pow(S,R);for(var R=0;R<F;R++)$[R]*=R/F}applyGradualLowpass(k,e.lpFreqStart||0,e.lpFreqEnd||0,e.decayTime,t)},reverbGen.generateGraph=function(e,t,o,u,f){var p=document.createElement("canvas");p.width=t,p.height=o;var g=p.getContext("2d");g.fillStyle="#000",g.fillRect(0,0,p.width,p.height),g.fillStyle="#fff";for(var M=t/e.length,F=o/(f-u),S=0;S<e.length;S++)g.fillRect(S*M,o-(e[S]-u)*F,1,1);return p};var applyGradualLowpass=function(e,t,o,u,f){if(t==0){f(e);return}var p=getAllChannelData(e),g=new OfflineAudioContext(e.numberOfChannels,p[0].length,e.sampleRate),M=g.createBufferSource();M.buffer=e;var F=g.createBiquadFilter();t=Math.min(t,e.sampleRate/2),o=Math.min(o,e.sampleRate/2),F.type="lowpass",F.Q.value=1e-4,F.frequency.setValueAtTime(t,0),F.frequency.linearRampToValueAtTime(o,u),M.connect(F),F.connect(g.destination),M.start(),g.oncomplete=function(S){f(S.renderedBuffer),F.disconnect(),M.disconnect()},g.startRendering(),window.filterNode=F},getAllChannelData=function(e){for(var t=[],o=0;o<e.numberOfChannels;o++)t[o]=e.getChannelData(o);return t},randomSample=function(){return Math.random()*2-1};let log=e=>console.log(e);function errorLogger(e,t="superdough"){process.env.NODE_ENV==="development"&&console.error(e),logger$1(`[${t}] error: ${e.message}`)}const logger$1=(...e)=>log(...e),setLogger=e=>{log=e},tokenizeNote$2=e=>{if(typeof e!="string")return[];const[t,o="",u]=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return t?[t,o,u?Number(u):void 0]:[]},chromas$1={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$1={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset=e=>e?.split("").reduce((t,o)=>t+accs$1[o],0)||0,noteToMidi=(e,t=3)=>{const[o,u,f=t]=tokenizeNote$2(e);if(!o)throw new Error('not a note: "'+e+'"');const p=chromas$1[o.toLowerCase()],g=getAccidentalsOffset(u);return(Number(f)+1)*12+p+g},midiToFreq$1=e=>Math.pow(2,(e-69)/12)*440,clamp=(e,t,o)=>Math.min(Math.max(e,t),o),freqToMidi$1=e=>12*Math.log(e/440)/Math.LN2+69,valueToMidi=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:o,note:u}=e;return typeof o=="number"?freqToMidi$1(o):typeof u=="string"?noteToMidi(u):typeof u=="number"?u:t};function nanFallback(e,t=0,o){return isNaN(Number(e))?(!o&&logger$1(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const _mod$1=(e,t)=>(e%t+t)%t,getSoundIndex=(e,t)=>_mod$1(Math.round(nanFallback(e,0)),t);function cycleToSeconds(e,t){return e/t}function getCommonSampleInfo(e,t){const{s:o,n:u=0}=e;let f=valueToMidi(e,36),p=f-36,g,M=0;if(Array.isArray(t))M=getSoundIndex(u,t.length),g=t[M];else{const S=N=>noteToMidi(N)-f,k=Object.keys(t).filter(N=>!N.startsWith("_")).reduce((N,$,R)=>!N||Math.abs(S($))<Math.abs(S(N))?$:N,null);p=-S(k),M=getSoundIndex(u,t[k].length),g=t[k][M]}const F=`${o}:${M}`;return{transpose:p,url:g,index:M,midi:f,label:F}}const pickAndRename=(e,t)=>Object.fromEntries(Object.entries(t).map(([o,u])=>[o,e[u]])),getBaseURL=e=>{try{return new URL(".",new URL(e)).href.replace(/\/$/,"")}catch{return e.split("/").slice(0,-1).join("/")}};typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(e,t,o=1,u=0){const f=Math.floor(clamp(u,0,1)*t.length),p=t.sampleRate*e,g=this.createBuffer(t.numberOfChannels,t.length,t.sampleRate);for(let M=0;M<t.numberOfChannels;M++){let F=t.getChannelData(M),S=g.getChannelData(M);for(let k=0;k<p;k++){let N=(f+k*Math.abs(o))%F.length;o<1&&(N=N*-1),S[k]=F.at(N)||0}}return g},AudioContext.prototype.createReverb=function(e,t,o,u,f,p,g){const M=this.createConvolver();return M.generate=(F=2,S=.1,k=15e3,N=1e3,$,R,U)=>{M.duration=F,M.fade=S,M.lp=k,M.dim=N,M.ir=$,M.irspeed=R,M.irbegin=U,$?M.buffer=this.adjustLength(F,$,R,U):reverbGen.generateReverb({audioContext:this,numChannels:2,decayTime:F,fadeInTime:S,lpFreqStart:k,lpFreqEnd:N},O=>{M.buffer=O})},M.generate(e,t,o,u,f,p,g),M});var vowelFormant={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class e extends GainNode{constructor(o,u){if(super(o),!vowelFormant[u])throw new Error("vowel: unknown vowel "+u);const{gains:f,qs:p,freqs:g}=vowelFormant[u];this.makeupGain=o.createGain(),this.audioNodes=[];for(let M=0;M<5;M++){const F=o.createGain();F.gain.value=f[M];const S=o.createBiquadFilter();S.type="bandpass",S.Q.value=p[M],S.frequency.value=g[M],super.connect(S),S.connect(F),this.audioNodes.push(S),F.connect(this.makeupGain),this.audioNodes.push(F)}return this.makeupGain.gain.value=8,this}connect(o){this.makeupGain.connect(o)}disconnect(){this.makeupGain.disconnect(),this.audioNodes.forEach(o=>o.disconnect()),super.disconnect(),this.makeupGain=null,this.audioNodes=null}}AudioContext.prototype.createVowelFilter=function(t){return new e(this,t)}}const workletsUrl="data:text/javascript;base64,dmFyIF89KGZ1bmN0aW9uKGZ0KXsidXNlIHN0cmljdCI7Y2xhc3Mga3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5zdGFydGVkPSExLHRoaXMubmJJbnB1dHM9dC5udW1iZXJPZklucHV0cyx0aGlzLm5iT3V0cHV0cz10Lm51bWJlck9mT3V0cHV0cyx0aGlzLmJsb2NrU2l6ZT10LnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplLHRoaXMuaG9wU2l6ZT0xMjgsdGhpcy5uYk92ZXJsYXBzPXRoaXMuYmxvY2tTaXplL3RoaXMuaG9wU2l6ZSx0aGlzLmlucHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkPW5ldyBBcnJheSh0aGlzLm5iSW5wdXRzKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iSW5wdXRzO2UrKyl0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhlLDEpO3RoaXMub3V0cHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmU9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTtmb3IobGV0IGU9MDtlPHRoaXMubmJPdXRwdXRzO2UrKyl0aGlzLmFsbG9jYXRlT3V0cHV0Q2hhbm5lbHMoZSwxKX1yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpe2ZvcihsZXQgcz0wO3M8dGhpcy5uYklucHV0cztzKyspe2xldCByPXRbc10ubGVuZ3RoO3IhPXRoaXMuaW5wdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMocyxyKX1mb3IobGV0IHM9MDtzPHRoaXMubmJPdXRwdXRzO3MrKyl7bGV0IHI9ZVtzXS5sZW5ndGg7ciE9dGhpcy5vdXRwdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHMscil9fWFsbG9jYXRlSW5wdXRDaGFubmVscyh0LGUpe3RoaXMuaW5wdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUrMTI4KSx0aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XT1uZXcgQXJyYXkoZSksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW3NdPXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdLnN1YmFycmF5KDAsdGhpcy5ibG9ja1NpemUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpfWFsbG9jYXRlT3V0cHV0Q2hhbm5lbHModCxlKXt0aGlzLm91dHB1dEJ1ZmZlcnNbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW3NdLmZpbGwoMCl9cmVhZElucHV0cyh0KXtpZih0WzBdLmxlbmd0aCYmdFswXVswXS5sZW5ndGg9PTApe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXRoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLmZpbGwoMCx0aGlzLmJsb2NrU2l6ZSk7cmV0dXJufWZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10W2VdW3NdO3RoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLnNldChyLHRoaXMuYmxvY2tTaXplKX19d3JpdGVPdXRwdXRzKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10aGlzLm91dHB1dEJ1ZmZlcnNbZV1bc10uc3ViYXJyYXkoMCwxMjgpO3RbZV1bc10uc2V0KHIpfX1zaGlmdElucHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpfXNoaWZ0T3V0cHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5zdWJhcnJheSh0aGlzLmJsb2NrU2l6ZS0xMjgpLmZpbGwoMCl9cHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW2VdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF1bZV0pfWhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCl7Zm9yKGxldCB0PTA7dDx0aGlzLm5iT3V0cHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLm91dHB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuYmxvY2tTaXplO3MrKyl0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV1bc10rPXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bZV1bc10vdGhpcy5uYk92ZXJsYXBzfXByb2Nlc3ModCxlLHMpe2NvbnN0IGk9dFswXVswXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5zdGFydGVkJiYhaT8hMToodGhpcy5zdGFydGVkPWksdGhpcy5yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpLHRoaXMucmVhZElucHV0cyh0KSx0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCksdGhpcy5wcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCksdGhpcy5wcm9jZXNzT0xBKHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUscyksdGhpcy5oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpLHRoaXMud3JpdGVPdXRwdXRzKGUpLHRoaXMuc2hpZnRPdXRwdXRCdWZmZXJzKCksITApfXByb2Nlc3NPTEEodCxlLHMpe2NvbnNvbGUuYXNzZXJ0KCExLCJOb3Qgb3ZlcnJpZGVuIil9fWNsYXNzIEV0e2NvbnN0cnVjdG9yKHQpe2lmKHRoaXMuc2l6ZT10fDAsdGhpcy5zaXplPD0xfHwodGhpcy5zaXplJnRoaXMuc2l6ZS0xKSE9PTApdGhyb3cgbmV3IEVycm9yKCJGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxIik7dGhpcy5fY3NpemU9dDw8MTtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuc2l6ZSoyKSxzPTA7czxlLmxlbmd0aDtzKz0yKXtjb25zdCBjPU1hdGguUEkqcy90aGlzLnNpemU7ZVtzXT1NYXRoLmNvcyhjKSxlW3MrMV09LU1hdGguc2luKGMpfXRoaXMudGFibGU9ZTtmb3IodmFyIHI9MCxpPTE7dGhpcy5zaXplPmk7aTw8PTEpcisrO3RoaXMuX3dpZHRoPXIlMj09PTA/ci0xOnIsdGhpcy5fYml0cmV2PW5ldyBBcnJheSgxPDx0aGlzLl93aWR0aCk7Zm9yKHZhciBvPTA7bzx0aGlzLl9iaXRyZXYubGVuZ3RoO28rKyl7dGhpcy5fYml0cmV2W29dPTA7Zm9yKHZhciBhPTA7YTx0aGlzLl93aWR0aDthKz0yKXt2YXIgdT10aGlzLl93aWR0aC1hLTI7dGhpcy5fYml0cmV2W29dfD0obz4+PmEmMyk8PHV9fXRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbCx0aGlzLl9pbnY9MH1mcm9tQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fG5ldyBBcnJheSh0Lmxlbmd0aD4+PjEpLHI9MDtyPHQubGVuZ3RoO3IrPTIpc1tyPj4+MV09dFtyXTtyZXR1cm4gc31jcmVhdGVDb21wbGV4QXJyYXkoKXtjb25zdCB0PW5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXT0wO3JldHVybiB0fXRvQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fHRoaXMuY3JlYXRlQ29tcGxleEFycmF5KCkscj0wO3I8cy5sZW5ndGg7cis9MilzW3JdPXRbcj4+PjFdLHNbcisxXT0wO3JldHVybiBzfWNvbXBsZXRlU3BlY3RydW0odCl7Zm9yKHZhciBlPXRoaXMuX2NzaXplLHM9ZT4+PjEscj0yO3I8cztyKz0yKXRbZS1yXT10W3JdLHRbZS1yKzFdPS10W3IrMV19dHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fdHJhbnNmb3JtNCgpLHRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1yZWFsVHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fcmVhbFRyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9aW52ZXJzZVRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0xLHRoaXMuX3RyYW5zZm9ybTQoKTtmb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl0W3NdLz10aGlzLnNpemU7dGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfV90cmFuc2Zvcm00KCl7dmFyIHQ9dGhpcy5fb3V0LGU9dGhpcy5fY3NpemUscz10aGlzLl93aWR0aCxyPTE8PHMsaT1lL3I8PDEsbyxhLHU9dGhpcy5fYml0cmV2O2lmKGk9PT00KWZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgbT11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTIobyxtLHIpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBtPXVbYV07dGhpcy5fc2luZ2xlVHJhbnNmb3JtNChvLG0scil9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+Mjtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgZD1vK2YsbD1vLHA9MDtsPGQ7bCs9MixwKz1yKXtjb25zdCBtPWwsST1tK2YsZz1JK2Ysdj1nK2Ysdz10W21dLFA9dFttKzFdLFM9dFtJXSxWPXRbSSsxXSxNPXRbZ10seD10W2crMV0seT10W3ZdLEE9dFt2KzFdLFc9dyxOPVAsRT1oW3BdLE89YypoW3ArMV0sRj1TKkUtVipPLEQ9UypPK1YqRSxMPWhbMipwXSxDPWMqaFsyKnArMV0sZXQ9TSpMLXgqQyxzdD1NKkMreCpMLHJ0PWhbMypwXSxudD1jKmhbMypwKzFdLGl0PXkqcnQtQSpudCxvdD15Km50K0EqcnQsYXQ9VytldCwkPU4rc3QsRz1XLWV0LGN0PU4tc3QsdXQ9RitpdCxRPUQrb3QsSj1jKihGLWl0KSxodD1jKihELW90KSxsdD1hdCt1dCxidD0kK1EsSXQ9YXQtdXQsX3Q9JC1RLEJ0PUcraHQsd3Q9Y3QtSixUdD1HLWh0LFB0PWN0K0o7dFttXT1sdCx0W20rMV09YnQsdFtJXT1CdCx0W0krMV09d3QsdFtnXT1JdCx0W2crMV09X3QsdFt2XT1UdCx0W3YrMV09UHR9fX1fc2luZ2xlVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZSsxXSx1PWlbZStzXSxjPWlbZStzKzFdLGg9byt1LGY9YStjLGQ9by11LGw9YS1jO3JbdF09aCxyW3QrMV09ZixyW3QrMl09ZCxyW3QrM109bH1fc2luZ2xlVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlKzFdLGY9aVtlK3NdLGQ9aVtlK3MrMV0sbD1pW2UrYV0scD1pW2UrYSsxXSxtPWlbZSt1XSxJPWlbZSt1KzFdLGc9YytsLHY9aCtwLHc9Yy1sLFA9aC1wLFM9ZittLFY9ZCtJLE09byooZi1tKSx4PW8qKGQtSSkseT1nK1MsQT12K1YsVz13K3gsTj1QLU0sRT1nLVMsTz12LVYsRj13LXgsRD1QK007clt0XT15LHJbdCsxXT1BLHJbdCsyXT1XLHJbdCszXT1OLHJbdCs0XT1FLHJbdCs1XT1PLHJbdCs2XT1GLHJbdCs3XT1EfV9yZWFsVHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IE10PXVbYV07dGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIobyxNdD4+PjEscj4+PjEpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBNdD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG8sTXQ+Pj4xLHI+Pj4xKX12YXIgYz10aGlzLl9pbnY/LTE6MSxoPXRoaXMudGFibGU7Zm9yKHI+Pj0yO3I+PTI7cj4+PTIpe2k9ZS9yPDwxO3ZhciBmPWk+Pj4xLGQ9Zj4+PjEsbD1kPj4+MTtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgcD0wLG09MDtwPD1sO3ArPTIsbSs9cil7dmFyIEk9bytwLGc9SStkLHY9ZytkLHc9ditkLFA9dFtJXSxTPXRbSSsxXSxWPXRbZ10sTT10W2crMV0seD10W3ZdLHk9dFt2KzFdLEE9dFt3XSxXPXRbdysxXSxOPVAsRT1TLE89aFttXSxGPWMqaFttKzFdLEQ9VipPLU0qRixMPVYqRitNKk8sQz1oWzIqbV0sZXQ9YypoWzIqbSsxXSxzdD14KkMteSpldCxydD14KmV0K3kqQyxudD1oWzMqbV0saXQ9YypoWzMqbSsxXSxvdD1BKm50LVcqaXQsYXQ9QSppdCtXKm50LCQ9TitzdCxHPUUrcnQsY3Q9Ti1zdCx1dD1FLXJ0LFE9RCtvdCxKPUwrYXQsaHQ9YyooRC1vdCksbHQ9YyooTC1hdCksYnQ9JCtRLEl0PUcrSixfdD1jdCtsdCxCdD11dC1odDtpZih0W0ldPWJ0LHRbSSsxXT1JdCx0W2ddPV90LHRbZysxXT1CdCxwPT09MCl7dmFyIHd0PSQtUSxUdD1HLUo7dFt2XT13dCx0W3YrMV09VHQ7Y29udGludWV9aWYocCE9PWwpe3ZhciBQdD1jdCxnZT0tdXQsYmU9JCxJZT0tRyxfZT0tYypsdCxCZT0tYypodCx3ZT0tYypKLFRlPS1jKlEsUGU9UHQrX2UsTWU9Z2UrQmUsU2U9YmUrVGUsVmU9SWUtd2UsQ3Q9bytkLXAsUnQ9bytmLXA7dFtDdF09UGUsdFtDdCsxXT1NZSx0W1J0XT1TZSx0W1J0KzFdPVZlfX19fV9zaW5nbGVSZWFsVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZStzXSx1PW8rYSxjPW8tYTtyW3RdPXUsclt0KzFdPTAsclt0KzJdPWMsclt0KzNdPTB9X3NpbmdsZVJlYWxUcmFuc2Zvcm00KHQsZSxzKXtjb25zdCByPXRoaXMuX291dCxpPXRoaXMuX2RhdGEsbz10aGlzLl9pbnY/LTE6MSxhPXMqMix1PXMqMyxjPWlbZV0saD1pW2Urc10sZj1pW2UrYV0sZD1pW2UrdV0sbD1jK2YscD1jLWYsbT1oK2QsST1vKihoLWQpLGc9bCttLHY9cCx3PS1JLFA9bC1tLFM9cCxWPUk7clt0XT1nLHJbdCsxXT0wLHJbdCsyXT12LHJbdCszXT13LHJbdCs0XT1QLHJbdCs1XT0wLHJbdCs2XT1TLHJbdCs3XT1WfX1sZXQgRHQ9bj0+Y29uc29sZS5sb2cobik7Y29uc3QgenQ9KC4uLm4pPT5EdCguLi5uKSxXdD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFN0PW49Pm4vKDErbikscXQ9KG4sdCk9PihuJXQrdCkldCxMdD0obix0KT0+KDErdCkqbi8oMSt0Kk1hdGguYWJzKG4pKSxZPShuLHQpPT5NYXRoLnRhbmgobiooMSt0KSksWXQ9KG4sdCk9Pld0KCgxK3QpKm4sLTEsMSksVnQ9KG4sdCk9PntsZXQgZT0oMSsuNSp0KSpuO2NvbnN0IHM9cXQoZSsxLDQpO3JldHVybiAxLU1hdGguYWJzKHMtMil9LGp0PShuLHQpPT5NYXRoLnNpbihNYXRoLlBJLzIqVnQobix0KSksSHQ9KG4sdCk9Pntjb25zdCBlPVN0KE1hdGgubG9nMXAodCkpLHM9KG4tZS8zKm4qbipuKS8oMS1lLzMpO3JldHVybiBZKHMsdCl9LHh0PShuLHQsZT0hMSk9Pntjb25zdCBzPTErMip0LGk9LjA3KlN0KE1hdGgubG9nMXAodCkpLG89WShuK2ksMip0KSxhPVkoZT9pOi1uK2ksMip0KSx1PW8tYSxjPTEvTWF0aC5jb3NoKHMqaSksaD1jKmMsZj1NYXRoLm1heCgxZS04LChlPzE6MikqcypoKTtyZXR1cm4gWSh1L2YsdCl9LHl0PXtzY3VydmU6THQsc29mdDpZLGhhcmQ6WXQsY3ViaWM6SHQsZGlvZGU6eHQsYXN5bToobix0KT0+eHQobix0LCEwKSxmb2xkOlZ0LHNpbmVmb2xkOmp0LGNoZWJ5c2hldjoobix0KT0+e2NvbnN0IGU9MTAqTWF0aC5sb2cxcCh0KTtsZXQgcz0xLHI9bixpLG89MDtmb3IobGV0IGE9MTthPDY0O2ErKyl7aWYoYTwyKXtvKz1hPT0wP3M6cjtjb250aW51ZX1pPTIqbipzLXIscj1zLHM9aSxhJTI9PT0wJiYobys9TWF0aC5taW4oMS4zKmUvYSwyKSppKX1yZXR1cm4gWShvLGUvMjApfX0sWD1PYmplY3QuZnJlZXplKE9iamVjdC5rZXlzKHl0KSksS3Q9bj0+e2xldCB0PW47dHlwZW9mIG49PSJzdHJpbmciJiYodD1YLmluZGV4T2YobiksdD09PS0xJiYoenQoYFtzdXBlcmRvdWdoXSBDb3VsZCBub3QgZmluZCB3YXZlc2hhcGluZyBhbGdvcml0aG0gJHtufS4KICAgICAgICBBdmFpbGFibGUgb3B0aW9ucyBhcmUgJHtYLmpvaW4oIiwgIil9LgogICAgICAgIERlZmF1bHRpbmcgdG8gJHtYWzBdfS5gKSx0PTApKTtjb25zdCBlPVhbdCVYLmxlbmd0aF07cmV0dXJuIHl0W2VdfSxqPTEyOCxSPU1hdGguUEksaz0yKlIscT0xL3NhbXBsZVJhdGUsVD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFV0PShuLHQsZSk9PmUqKHQtbikrbixiPShuLHQpPT5uW3RdPz9uWzBdLEg9bj0+bi1NYXRoLmZsb29yKG4pLEs9bj0+bnwwLFU9bj0+SyhuKy41KSxadD1uPT5LKG4rMSksQXQ9bj0+bi1LKG4pLHo9bj0+e2NvbnN0IHQ9bioqMjtyZXR1cm4gbiooMjcrdCkvKDI3KzkqdCl9LE50PShuLHQpPT57aWYobjwyKXJldHVybiByPT4wO2NvbnN0IGU9dC8obi0xKSxzPXQqLjU7cmV0dXJuIHI9PnIqZS1zfSxaPShuLHQpPT5uKk1hdGgucG93KDIsdC8xMik7ZnVuY3Rpb24gJHQobix0KXt0PU1hdGgubWluKHQsMS10KTtjb25zdCBlPTEvdDtyZXR1cm4gbjx0PyhuKj1lLDIqbi1uKioyLTEpOm4+MS10PyhuPShuLTEpKmUsbioqMisyKm4rMSk6MH1jb25zdCBkdD17dHJpKG4sdD0uNSl7Y29uc3QgZT0xLXQ7cmV0dXJuIG4+PXQ/MS9lLW4vZTpuL3R9LHNpbmUobil7cmV0dXJuIE1hdGguc2luKGsqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPVQodFtzXSwwLDEpLGE9VCh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtJHQobix0KX19LEd0PU9iamVjdC5rZXlzKGR0KTtjbGFzcyBRdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ0aW1lIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6InNrZXciLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6ImRlcHRoIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InBoYXNlb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6InNoYXBlIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImN1cnZlIixkZWZhdWx0VmFsdWU6MX0se25hbWU6ImRjb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1pbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJtYXgiLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucGhhc2V9aW5jcmVtZW50UGhhc2UodCl7dGhpcy5waGFzZSs9dCx0aGlzLnBoYXNlPjEmJih0aGlzLnBoYXNlPXRoaXMucGhhc2UtMSl9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1zLmJlZ2luWzBdO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cilyZXR1cm4hMDtjb25zdCBpPWVbMF0sbz1zLmZyZXF1ZW5jeVswXSxhPXMudGltZVswXSx1PXMuZGVwdGhbMF0sYz1zLnNrZXdbMF0saD1zLnBoYXNlb2Zmc2V0WzBdLGY9cy5jdXJ2ZVswXSxkPXMuZGNvZmZzZXRbMF0sbD1zLm1pblswXSxwPXMubWF4WzBdLG09R3Rbcy5zaGFwZVswXV0sST1pWzBdLmxlbmd0aD8/MDt0aGlzLnBoYXNlPT1udWxsJiYodGhpcy5waGFzZT1BdChhKm8raCkpO2NvbnN0IGc9bypxO2ZvcihsZXQgdj0wO3Y8STt2Kyspe2ZvcihsZXQgdz0wO3c8aS5sZW5ndGg7dysrKXtsZXQgUD0oZHRbbV0odGhpcy5waGFzZSxjKStkKSp1O1A9TWF0aC5wb3coUCxmKSxpW3ddW3ZdPVQoUCxsLHApfXRoaXMuaW5jcmVtZW50UGhhc2UoZyl9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsZm8tcHJvY2Vzc29yIixRdCk7Y2xhc3MgSnQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY29hcnNlIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNvYXJzZVswXT8/MDthPU1hdGgubWF4KDEsYSk7Zm9yKGxldCB1PTA7dTxqO3UrKylmb3IobGV0IGM9MDtjPHIubGVuZ3RoO2MrKylpW2NdW3VdPXUlYT09PTA/cltjXVt1XTppW2NdW3UtMV07cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjb2Fyc2UtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY3J1c2giLGRlZmF1bHRWYWx1ZTowfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuY3J1c2hbMF0/Pzg7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8ajt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspe2NvbnN0IGg9TWF0aC5wb3coMixhLTEpO2lbY11bdV09TWF0aC5yb3VuZChyW2NdW3VdKmgpL2h9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjcnVzaC1wcm9jZXNzb3IiLFh0KTtjbGFzcyB0ZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5zaGFwZVswXTthPWE8MT9hOi45OTk5OTk5OTk2LGE9MiphLygxLWEpO2NvbnN0IHU9TWF0aC5tYXgoLjAwMSxNYXRoLm1pbigxLHMucG9zdGdhaW5bMF0pKTtmb3IobGV0IGM9MDtjPGo7YysrKWZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKWlbaF1bY109KDErYSkqcltoXVtjXS8oMSthKk1hdGguYWJzKHJbaF1bY10pKSp1O3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic2hhcGUtcHJvY2Vzc29yIix0ZSk7Y2xhc3MgT3R7czA9MDtzMT0wO3VwZGF0ZSh0LGUscz0wKXtzPVQocywwLDEpLGU9VChlLDAsc2FtcGxlUmF0ZS8yLTEpO2NvbnN0IHI9VCgyKk1hdGguc2luKGUqUipxKSwwLDEuMTQpLG89MS1NYXRoLnBvdyguNSw4KnMrMSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBPdCxuZXcgT3RdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9VChzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgZD0wO2Q8ajtkKyspdT09Im5vbmUiP2lbZl1bZF09cltmXVtkXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW2RdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW2RdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtkXT1yW2ZdW2RdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW2RdPXJbZl1bZF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsZWUpO2NsYXNzIHNlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjUwMH0se25hbWU6InEiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZHJpdmUiLGRlZmF1bHRWYWx1ZTouNjl9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMucDA9WzAsMF0sdGhpcy5wMT1bMCwwXSx0aGlzLnAyPVswLDBdLHRoaXMucDM9WzAsMF0sdGhpcy5wMzI9WzAsMF0sdGhpcy5wMzM9WzAsMF0sdGhpcy5wMzQ9WzAsMF19cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztjb25zdCBhPXMucVswXSx1PVQoTWF0aC5leHAocy5kcml2ZVswXSksLjEsMmUzKTtsZXQgYz1zLmZyZXF1ZW5jeVswXTtjPWMqaypxLGM9Yz4xPzE6Yztjb25zdCBoPU1hdGgubWluKDgsYSouMTMpO2xldCBmPTEvdSpNYXRoLm1pbigxLjc1LDEraCk7Zm9yKGxldCBkPTA7ZDxqO2QrKylmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKyl7Y29uc3QgcD10aGlzLnAzW2xdKi4zNjA4OTErdGhpcy5wMzJbbF0qLjQxNzI5K3RoaXMucDMzW2xdKi4xNzc4OTYrdGhpcy5wMzRbbF0qLjA0Mzk3MjU7dGhpcy5wMzRbbF09dGhpcy5wMzNbbF0sdGhpcy5wMzNbbF09dGhpcy5wMzJbbF0sdGhpcy5wMzJbbF09dGhpcy5wM1tsXSx0aGlzLnAwW2xdKz0oeihyW2xdW2RdKnUtaCpwKS16KHRoaXMucDBbbF0pKSpjLHRoaXMucDFbbF0rPSh6KHRoaXMucDBbbF0pLXoodGhpcy5wMVtsXSkpKmMsdGhpcy5wMltsXSs9KHoodGhpcy5wMVtsXSkteih0aGlzLnAyW2xdKSkqYyx0aGlzLnAzW2xdKz0oeih0aGlzLnAyW2xdKS16KHRoaXMucDNbbF0pKSpjLGlbbF1bZF09cCpmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGFkZGVyLXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImRpc3RvcnQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3Ioe3Byb2Nlc3Nvck9wdGlvbnM6dH0pe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMuYWxnb3JpdGhtPUt0KHQuYWxnb3JpdGhtKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2ZvcihsZXQgYT0wO2E8ajthKyspe2NvbnN0IHU9VChiKHMucG9zdGdhaW4sYSksLjAwMSwxKSxjPU1hdGguZXhwbTEoYihzLmRpc3RvcnQsYSkpO2ZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKXtjb25zdCBmPXJbaF1bYV07aVtoXVthXT11KnRoaXMuYWxnb3JpdGhtKGYsYyl9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGlzdG9ydC1wcm9jZXNzb3IiLHJlKTtjbGFzcyBuZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZT1bXX1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJwYW5zcHJlYWQiLGRlZmF1bHRWYWx1ZTouNCxtaW46MCxtYXg6MX0se25hbWU6ImZyZXFzcHJlYWQiLGRlZmF1bHRWYWx1ZTouMixtaW46MH0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjAsbWluOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZTo1LG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifV19cHJvY2Vzcyh0LGUscyl7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXSxpPXMudm9pY2VzWzBdO2ZvcihsZXQgbz0wO288clswXS5sZW5ndGg7bysrKXtjb25zdCBhPWIocy5kZXR1bmUsbyksdT1iKHMuZnJlcXNwcmVhZCxvKSxjPWIocy5wYW5zcHJlYWQsbykqLjUrLjU7bGV0IGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyksZD1iKHMuZnJlcXVlbmN5LG8pO2Q9WihkLGEvMTAwKTtjb25zdCBsPU50KGksdSk7Zm9yKGxldCBwPTA7cDxpO3ArKyl7Y29uc3QgbT1aKGQsbChwKSksST1IKG0qcSk7dGhpcy5waGFzZVtwXT10aGlzLnBoYXNlW3BdPz9NYXRoLnJhbmRvbSgpO2NvbnN0IGc9ZHQuc2F3YmxlcCh0aGlzLnBoYXNlW3BdLEkpO3JbMF1bb10rPWcqaCxyWzFdW29dKz1nKmY7bGV0IHY9dGhpcy5waGFzZVtwXStJO3Y+PTEmJih2LT0xKSx0aGlzLnBoYXNlW3BdPXY7Y29uc3Qgdz1oO2g9ZixmPXd9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic3VwZXJzYXctb3NjaWxsYXRvciIsbmUpO2NvbnN0IGllPTIwNDgscHQ9bmV3IE1hcDtmdW5jdGlvbiBvZShuKXtpZighcHQuaGFzKG4pKXtjb25zdCB0PW5ldyBGbG9hdDMyQXJyYXkobik7Zm9yKGxldCBlPTA7ZTxuO2UrKyl0W2VdPS41KigxLU1hdGguY29zKGsqZS9uKSk7cHQuc2V0KG4sdCl9cmV0dXJuIHB0LmdldChuKX1jbGFzcyBhZSBleHRlbmRzIGt0e3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOmllfSxzdXBlcih0KSx0aGlzLnRpbWVDdXJzb3I9MCx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy5pbnZmZnRTaXplPTEvdGhpcy5mZnRTaXplLHRoaXMuaGFubldpbmRvdz1vZSh0aGlzLmZmdFNpemUpLHRoaXMuZmZ0PW5ldyBFdCh0aGlzLmZmdFNpemUpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy50aW1lQ29tcGxleEJ1ZmZlcj10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLm1hZ25pdHVkZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLmZmdFNpemUvMisxKSx0aGlzLnBlYWtJbmRleGVzPW5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpLHRoaXMubmJQZWFrcz0wfXByb2Nlc3NPTEEodCxlLHMpe2xldCByPXMucGl0Y2hGYWN0b3Jbcy5waXRjaEZhY3Rvci5sZW5ndGgtMV07cjwwJiYocj1yKi4yNSkscj1NYXRoLm1heCgwLHIrMSk7Zm9yKGxldCBpPTA7aTx0aGlzLm5iSW5wdXRzO2krKylmb3IobGV0IG89MDtvPHRbaV0ubGVuZ3RoO28rKyl7Y29uc3QgYT10W2ldW29dLHU9ZVtpXVtvXTt0aGlzLmFwcGx5SGFubldpbmRvdyhhKSx0aGlzLmZmdC5yZWFsVHJhbnNmb3JtKHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIsYSksdGhpcy5jb21wdXRlTWFnbml0dWRlcygpLHRoaXMuZmluZFBlYWtzKCksdGhpcy5zaGlmdFBlYWtzKHIpLHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpLHRoaXMuZmZ0LmludmVyc2VUcmFuc2Zvcm0odGhpcy50aW1lQ29tcGxleEJ1ZmZlcix0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHUpLHRoaXMuYXBwbHlIYW5uV2luZG93KHUpfXRoaXMudGltZUN1cnNvcis9dGhpcy5ob3BTaXplfWFwcGx5SGFubldpbmRvdyh0KXtmb3IobGV0IGU9MDtlPHRoaXMuYmxvY2tTaXplO2UrKyl0W2VdKj10aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2xldCB0PTAsZT0wO2Zvcig7dDx0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyl7Y29uc3Qgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDtsZXQgdD0yO2NvbnN0IGU9dGhpcy5tYWduaXR1ZGVzLmxlbmd0aC0yO2Zvcig7dDxlOyl7Y29uc3Qgcz10aGlzLm1hZ25pdHVkZXNbdF07aWYodGhpcy5tYWduaXR1ZGVzW3QtMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0LTJdPj1zKXt0Kys7Y29udGludWV9aWYodGhpcy5tYWduaXR1ZGVzW3QrMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0KzJdPj1zKXt0Kys7Y29udGludWV9dGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3NdPXQsdGhpcy5uYlBlYWtzKyssdCs9Mn19c2hpZnRQZWFrcyh0KXt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZC5maWxsKDApO2ZvcihsZXQgZT0wO2U8dGhpcy5uYlBlYWtzO2UrKyl7Y29uc3Qgcz10aGlzLnBlYWtJbmRleGVzW2VdLHI9VShzKnQpO2lmKHI+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgaT0wLG89dGhpcy5mZnRTaXplO2U+MCYmKGk9cy1VKChzLXRoaXMucGVha0luZGV4ZXNbZS0xXSkvMikpLGU8dGhpcy5uYlBlYWtzLTEmJihvPXMrWnQoKHRoaXMucGVha0luZGV4ZXNbZSsxXS1zKS8yKSk7Y29uc3QgYT1pLXMsdT1vLXMsYz1rKnRoaXMuaW52ZmZ0U2l6ZSooci1zKSxoPU1hdGguY29zKGMqdGhpcy50aW1lQ3Vyc29yKSxmPU1hdGguc2luKGMqdGhpcy50aW1lQ3Vyc29yKTtmb3IobGV0IGQ9YTtkPHU7ZCsrKXtjb25zdCBsPXMrZCxwPXIrZDtpZihwPj10aGlzLm1hZ25pdHVkZXMubGVuZ3RoKWJyZWFrO2NvbnN0IG09MipsLEk9bSsxLGc9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlclttXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbSV0sdz1nKmgtdipmLFA9ZypmK3YqaCxTPTIqcCxWPVMrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtTXSs9dyx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtWXSs9UH19fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLGFlKTtjbGFzcyBjZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGk9LVIsdGhpcy5ZMD0wLHRoaXMuWTE9MCx0aGlzLlBXPVIsdGhpcy5CPTIuMyx0aGlzLmRwaGlmPTAsdGhpcy5lbnZmPTB9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJwdWxzZXdpZHRoIixkZWZhdWx0VmFsdWU6MSxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXTtsZXQgaT0xLG87Zm9yKGxldCBhPTA7YTwoclswXS5sZW5ndGg/PzApO2ErKyl7Y29uc3QgdT0oMS1UKGIocy5wdWxzZXdpZHRoLGEpLC0uOTksLjk5KSkqUixjPWIocy5kZXR1bmUsYSksaD1aKGIocy5mcmVxdWVuY3ksYSksYy8xMDApO289aCprKnEsdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49UiYmKHRoaXMucGhpLT1rKTtsZXQgZj1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMCk7dGhpcy5ZMD0uNSooZit0aGlzLlkwKTtsZXQgZD1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMSt1KTt0aGlzLlkxPS41KihkK3RoaXMuWTEpO2ZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXJbbF1bYV09LjE1KihmLWQpKnRoaXMuZW52Zn1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInB1bHNlLW9zY2lsbGF0b3IiLGNlKTtjb25zdCBtdD17Yml0QzpmdW5jdGlvbihuLHQsZSl7cmV0dXJuIG4mdD9lOjB9LGJyOmZ1bmN0aW9uKG4sdD04KXtpZih0PjMyKXRocm93IG5ldyBFcnJvcigiYnIoKSBTaXplIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gMzIiKTtsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dDtzKyspZXw9bXQuYml0QyhuLDE8PHMsMTw8dC0ocysxKSk7cmV0dXJuIGV9LHNpbmY6ZnVuY3Rpb24obil7cmV0dXJuIE1hdGguc2luKG4qUi8xMjgpfSxjb3NmOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLmNvcyhuKlIvMTI4KX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obipSLzEyOCl9LHJlZ0c6ZnVuY3Rpb24obix0KXtyZXR1cm4gdC50ZXN0KG4udG9TdHJpbmcoMikpfX07bGV0IHR0LHZ0O2Z1bmN0aW9uIHVlKG4pe2lmKHR0PT1udWxsKXt0dD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhNYXRoKSx2dD10dC5tYXAocz0+TWF0aFtzXSk7Y29uc3QgdD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhtdCksZT10Lm1hcChzPT5tdFtzXSk7dHQucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSx2dC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLnR0LCJ0IixgcmV0dXJuIDAsCiR7bnx8MH07YCkuYmluZChnbG9iYWxUaGlzLC4uLnZ0KX1jbGFzcyBoZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5wb3J0Lm9ubWVzc2FnZT10PT57bGV0e2NvZGVUZXh0OmV9PXQuZGF0YTtjb25zdHtieXRlQmVhdFN0YXJ0VGltZTpzfT10LmRhdGE7cyE9bnVsbCYmKHRoaXMudD0wLHRoaXMuaW5pdGlhbE9mZnNldD1NYXRoLmZsb29yKHMpKSxlPWUudHJpbSgpLnJlcGxhY2UoL15ldmFsXCh1bmVzY2FwZVwoZXNjYXBlKD86YHxcKCd8XCgifFwoYCkoLio/KSg/OmB8J1wpfCJcKXxgXCkpLnJlcGxhY2VcKFwvdVwoXC5cLlwpXC9nLFsiJ2BdXCQxJVsiJ2BdXClcKVwpJC8sKHIsaSk9PnVuZXNjYXBlKGVzY2FwZShpKS5yZXBsYWNlKC91KC4uKS9nLCIkMSUiKSkpLHRoaXMuZnVuYz11ZShlKX0sdGhpcy5pbml0aWFsT2Zmc2V0PTAsdGhpcy50PW51bGwsdGhpcy5mdW5jPW51bGx9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7dGhpcy50PT1udWxsJiYodGhpcy50PXMuYmVnaW5bMF0qc2FtcGxlUmF0ZSk7Y29uc3Qgcj1lWzBdLGk9MjU2KnE7Zm9yKGxldCBvPTA7bzxyWzBdLmxlbmd0aDtvKyspe2NvbnN0IGE9YihzLmRldHVuZSxvKSx1PVooYihzLmZyZXF1ZW5jeSxvKSxhLzEwMCksYz1pKnUqdGhpcy50K3RoaXMuaW5pdGlhbE9mZnNldCxmPSh0aGlzLmZ1bmMoYykmMjU1KS8xMjcuNS0xLGQ9VChmKi4yLC0uNCwuNCk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVtvXT1kO3RoaXMudCsrfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsaGUpO2NsYXNzIGxlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJhdHRhY2siLGRlZmF1bHRWYWx1ZTouMDA1LG1pblZhbHVlOjB9LHtuYW1lOiJkZWNheSIsZGVmYXVsdFZhbHVlOi4xNCxtaW5WYWx1ZTowfSx7bmFtZToic3VzdGFpbiIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6MCxtYXhWYWx1ZToxfSx7bmFtZToicmVsZWFzZSIsZGVmYXVsdFZhbHVlOi4xLG1pblZhbHVlOjB9LHtuYW1lOiJhdHRhY2tDdXJ2ZSIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6LTEsbWF4VmFsdWU6MX0se25hbWU6ImRlY2F5Q3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJyZWxlYXNlQ3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJwZWFrIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InJldHJpZ2dlciIsZGVmYXVsdFZhbHVlOjEsbWluVmFsdWU6MCxtYXhWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMudmFsPTAsdGhpcy5zZWdJZHg9MCx0aGlzLnN0YXRlPTAsdGhpcy5iZWdpblRpbWU9MCx0aGlzLmVuZFRpbWU9MCx0aGlzLmF0dGFja1N0YXJ0PTB9X3dhcnAodCxlLHM9OCl7aWYodD09PTB8fHQ9PT0xKXJldHVybiB0O2lmKGU+MCl7Y29uc3Qgcj0xK3MqZTtyZXR1cm4gMS1NYXRoLnBvdygxLXQscil9ZWxzZXtjb25zdCByPTEtcyplO3JldHVybiBNYXRoLnBvdyh0LHIpfX1fYWR2YW5jZSh0LGUscyxyKXtpZihzPT09MHx8dD09PWUpdGhpcy52YWw9ZTtlbHNle2NvbnN0IGk9TWF0aC5taW4oMSwoY3VycmVudFRpbWUtdGhpcy5iZWdpblRpbWUpL3MpLG89dGhpcy5fd2FycChpLHIpO3RoaXMudmFsPXQrKGUtdCkqb319cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1lWzBdWzBdO2lmKCFyKXJldHVybiEwO2NvbnN0IGk9YihzLmJlZ2luLDApLG89YihzLnJldHJpZ2dlciwwKT49LjU7aSE9PXRoaXMuYmVnaW5UaW1lJiYodGhpcy5zdGF0ZT09PTB8fG8pJiYodGhpcy5iZWdpblRpbWU9aSx0aGlzLnN0YXRlPTEsdGhpcy5lbmRUaW1lPWIocy5lbmQsMCksdGhpcy5hdHRhY2tTdGFydD10aGlzLnZhbCk7Y29uc3QgYT10aGlzLmVuZFRpbWUtdGhpcy5iZWdpblRpbWU7Zm9yKGxldCB1PTA7dTxyLmxlbmd0aDt1Kyspe2NvbnN0IGM9YihzLmF0dGFjayx1KSxoPWIocy5kZWNheSx1KSxmPWIocy5zdXN0YWluLHUpLGQ9YihzLnJlbGVhc2UsdSksbD1iKHMuYXR0YWNrQ3VydmUsdSkscD1iKHMuZGVjYXlDdXJ2ZSx1KSxtPWIocy5yZWxlYXNlQ3VydmUsdSksST1iKHMucGVhayx1KSxnPVt7dGltZTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksc3RhcnQ6MCx0YXJnZXQ6MH0se3RpbWU6YyxzdGFydDp0aGlzLmF0dGFja1N0YXJ0LHRhcmdldDoxLGN1cnZlOmx9LHt0aW1lOmMraCxzdGFydDoxLHRhcmdldDpmLGN1cnZlOnB9LHt0aW1lOmEsc3RhcnQ6Zix0YXJnZXQ6Zn0se3RpbWU6YStkLHN0YXJ0OmYsdGFyZ2V0OjAsY3VydmU6bX1dO2xldHt0aW1lOnYsc3RhcnQ6dyx0YXJnZXQ6UCxjdXJ2ZTpTfT1nW3RoaXMuc3RhdGVdO2Zvcih0aGlzLl9hZHZhbmNlKHcsUCx2LFMpO2N1cnJlbnRUaW1lLXRoaXMuYmVnaW5UaW1lPj12Oyl0aGlzLnN0YXRlPSh0aGlzLnN0YXRlKzEpJWcubGVuZ3RoLHY9Z1t0aGlzLnN0YXRlXS50aW1lO3JbdV09dGhpcy52YWwqSX1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoImVudmVsb3BlLXByb2Nlc3NvciIsbGUpO2NvbnN0IEI9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gZmUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBGdD1uPT4oZmUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBkZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBwZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1GdCh0KSxyPUZ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBtZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKnBlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IGd0PXt9O2NsYXNzIHZlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhZ3RbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgZD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspZFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBkfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha31ndFtpXT1vfXRoaXMudGFibGVzPWd0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOlUoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIEIuTk9ORTpyZXR1cm4gdDtjYXNlIEIuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBCLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsQi5BU1lNKSk7Y2FzZSBCLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIEIuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIEIuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgQi5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqKjIpO3JldHVybiB0KnIlMX1jYXNlIEIuUVVBTlQ6e2NvbnN0e246cn09dGhpcy5fdG9CaXRzKGUpO3JldHVybiBLKHQqcikvcn1jYXNlIEIuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsVSg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoQXQoaSp0KS0uNSkqMn1jYXNlIEIuUFdNOntjb25zdCByPVQoLjUrLjQ5KigyKmUtMSksMCwxKTtyZXR1cm4gdDxyP3QvciouNTouNSsodC1yKS8oMS1yKSouNX1jYXNlIEIuT1JCSVQ6e2NvbnN0IHI9LjUqZTtyZXR1cm4gSCh0K3IqTWF0aC5zaW4oayozKnQpKX1jYXNlIEIuU1BJTjp7Y29uc3Qgcj0uNSplLHtuOml9PXRoaXMuX3RvQml0cyhlLDEsNik7cmV0dXJuIEgodCtyKk1hdGguc2luKGsqaSp0KSl9Y2FzZSBCLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gVCgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgQi5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKioyPD1vO2ErPTIpaWYobyVhPT09MClyZXR1cm4hMTtyZXR1cm4hMH07bGV0e246aX09dGhpcy5fdG9CaXRzKGUsMyk7Zm9yKDshcihpKTspaSsrO3JldHVybiBLKHQqaSkvaX1jYXNlIEIuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPVUocik7Y29uc3QgaT0xPDxyLG89Syh0KmkpO3JldHVybiBkZShvLHIpL2l9Y2FzZSBCLkJST1dOSUFOOntjb25zdCByPS4yNSplKm1lKDY0KnQsNCk7cmV0dXJuIEgodCtyKX1jYXNlIEIuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIFQoYSwwLDEpfWNhc2UgQi5XT1JNSE9MRTp7Y29uc3Qgcj1UKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIEIuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErVSgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIFQociwwLDEpfWNhc2UgQi5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgQi5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKGsqdCkqZTtyZXR1cm4gSCh0K3IpfWNhc2UgQi5GTElQOnJldHVybiB0O2RlZmF1bHQ6cmV0dXJuIHR9fV9zYW1wbGVGcmFtZSh0LGUpe2NvbnN0IHM9dC5sZW5ndGgscj1lKnM7bGV0IGk9cnwwO2k+PXMmJihpPTApO2NvbnN0IG89ci1pLGE9dFtpXTtsZXQgdT1pKzE7dT49cyYmKHU9MCk7Y29uc3QgYz10W3VdO3JldHVybiBhKyhjLWEpKm99X2Nob29zZU1pcCh0KXtjb25zdCBlPVQodCwxZS02LDY0KTtsZXQgcz0wO2Zvcig7cysxPCh0aGlzLnRhYmxlcz8ubGVuZ3RofHwxKSYmZTx0aGlzLnRhYmxlc1tzXVswXS5sZW5ndGgvODspcysrO3JldHVybiBzfXByb2Nlc3ModCxlLHMpe2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtjb25zdCByPWVbMF1bMF0saT1lWzBdWzFdfHxlWzBdWzBdO2lmKCF0aGlzLnRhYmxlcylyZXR1cm4gci5maWxsKDApLGkhPT1yJiZpLnNldChyKSwhMDtjb25zdCBvPXMudm9pY2VzWzBdO2ZvcihsZXQgYT0wO2E8ci5sZW5ndGg7YSsrKXtjb25zdCB1PWIocy5kZXR1bmUsYSksYz1iKHMuZnJlcXNwcmVhZCxhKSxmPVQoYihzLnBvc2l0aW9uLGEpLDAsMSkqKHRoaXMubnVtRnJhbWVzLTEpLGQ9ZnwwLGw9Zi1kLHA9VChiKHMud2FycCxhKSwwLDEpLG09YihzLndhcnBNb2RlLGEpLEk9VChiKHMucGhhc2VyYW5kLGEpLDAsMSksZz1vPjE/VChiKHMucGFuc3ByZWFkLGEpLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpnKSx3PU1hdGguc3FydCguNSsuNSpnKTtsZXQgUD1iKHMuZnJlcXVlbmN5LGEpO1A9WihQLHUvMTAwKTtjb25zdCBTPTEvTWF0aC5zcXJ0KG8pLFY9TnQobyxjKTtmb3IobGV0IE09MDtNPG87TSsrKXtjb25zdCB4PShNJjEpPT0xO2xldCB5PXYsQT13O3gmJih5PXcsQT12KTtjb25zdCBOPVooUCxWKE0pKSpxLEU9dGhpcy5fY2hvb3NlTWlwKE4pLE89dGhpcy50YWJsZXNbRV07dGhpcy5waGFzZVtNXT10aGlzLnBoYXNlW01dPz9NYXRoLnJhbmRvbSgpKkk7Y29uc3QgRj10aGlzLl93YXJwUGhhc2UodGhpcy5waGFzZVtNXSxwLG0pLEQ9dGhpcy5fc2FtcGxlRnJhbWUoT1tkXSxGKSxMPXRoaXMuX3NhbXBsZUZyYW1lKE9bTWF0aC5taW4odGhpcy5udW1GcmFtZXMtMSxkKzEpXSxGKTtsZXQgQz1VdChELEwsbCk7bT09PUIuRkxJUCYmdGhpcy5waGFzZVtNXTxwJiYoQz0tQyksclthXSs9Qyp5KlMsaVthXSs9QypBKlMsdGhpcy5waGFzZVtNXT1IKHRoaXMucGhhc2VbTV0rTil9fXJldHVybiEwfX1yZXR1cm4gcmVnaXN0ZXJQcm9jZXNzb3IoIndhdmV0YWJsZS1vc2NpbGxhdG9yLXByb2Nlc3NvciIsdmUpLGZ0LldhcnBNb2RlPUIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGZ0LFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxmdH0pKHt9KTsK";let audioContext;const setDefaultAudioContext=()=>(audioContext=new AudioContext,audioContext),getAudioContext=()=>audioContext||setDefaultAudioContext();function getAudioContextCurrentTime(){return getAudioContext().currentTime}let noiseCache={};function getNoiseBuffer(e,t){const o=getAudioContext();if(noiseCache[e])return noiseCache[e];const u=2*o.sampleRate,f=o.createBuffer(1,u,o.sampleRate),p=f.getChannelData(0);let g=0,M,F,S,k,N,$,R;M=F=S=k=N=$=R=0;for(let U=0;U<u;U++)if(e==="white")p[U]=Math.random()*2-1;else if(e==="brown"){let O=Math.random()*2-1;p[U]=(g+.02*O)/1.02,g=p[U]}else if(e==="pink"){let O=Math.random()*2-1;M=.99886*M+O*.0555179,F=.99332*F+O*.0750759,S=.969*S+O*.153852,k=.8665*k+O*.3104856,N=.55*N+O*.5329522,$=-.7616*$-O*.016898,p[U]=M+F+S+k+N+$+R+O*.5362,p[U]*=.11,R=O*.115926}else if(e==="crackle"){const O=t*.01;Math.random()<O?p[U]=Math.random()*2-1:p[U]=0}return e!=="crackle"&&(noiseCache[e]=f),f}function getNoiseOscillator(e="white",t,o=.02){const f=getAudioContext().createBufferSource();return f.buffer=getNoiseBuffer(e,o),f.loop=!0,f.start(t),{node:f,stop:p=>f.stop(p)}}function getNoiseMix(e,t,o){const u=getNoiseOscillator("pink",o),f=drywet(e,u.node,t);return u.node.onended=()=>f.onended(),{node:f.node,stop:p=>u?.stop(p)}}const noises=["pink","white","brown","crackle"];function gainNode(e){const t=getAudioContext().createGain();return t.gain.value=e,t}function effectSend(e,t,o){const u=gainNode(o);return e.connect(u),u.connect(t),u}const getSlope=(e,t,o,u)=>u-o===0?0:(t-e)/(u-o);function getWorklet(e,t,o,u){const f=new AudioWorkletNode(e,t,u);return Object.entries(o).forEach(([p,g])=>{g!==void 0&&(f.parameters.get(p).value=g)}),f}const getParamADSR=(e,t,o,u,f,p,g,M,F,S="exponential")=>{t=nanFallback(t),o=nanFallback(o),u=nanFallback(u),f=nanFallback(f);const k=S==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";S==="exponential"&&(p=p===0?.001:p,g=g===0?.001:g);const N=g-p,$=g,R=p+u*N,U=F-M,O=Z=>{let K;if(t>Z){let ie=getSlope(p,$,0,t);K=Z*ie+(p>$?p:0)}else K=(Z-t)*getSlope($,R,0,o)+$;return S==="exponential"&&(K=K||.001),K};e.setValueAtTime(p,M),t>U?e[k](O(U),F):t+o>U?(e[k](O(t),M+t),e[k](O(U),F)):(e[k](O(t),M+t),e[k](O(t+o),M+t+o),e.setValueAtTime(R,F)),e[k](p,F+f)};function getModulationShapeInput(e){return typeof e=="number"?e%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[e]??0}function getLfo(e,t,o,u={}){const{shape:f=0,...p}=u,{dcoffset:g=-.5,depth:M=1}=u,F={frequency:1,depth:M,skew:.5,phaseoffset:0,time:t,begin:t,end:o,shape:getModulationShapeInput(f),dcoffset:g,min:g*M,max:g*M+M,curve:1,...p};return getWorklet(e,"lfo-processor",F)}function getCompressor(e,t,o,u,f,p){const g={threshold:t??-3,ratio:o??10,knee:u??10,attack:f??.005,release:p??.05};return new DynamicsCompressorNode(e,g)}const getADSRValues=(e,t="linear",o)=>{const[g,M,F,S]=e;if(g==null&&M==null&&F==null&&S==null)return o??[.001,.001,1,.01];const k=F??(g!=null&&M==null||g==null&&M==null?1:.001);return[Math.max(g??0,.001),Math.max(M??0,.001),Math.min(k,1),Math.max(S??0,.01)]};function getParamLfo(e,t,o,u,f){let{defaultDepth:p=1,depth:g,dcoffset:M,...F}=f;g==null&&(g=Object.values(F).some(N=>N!=null)?p:0);let S;return g&&(S=getLfo(e,o,u,{depth:g,dcoffset:M,...F}),S.connect(t)),S}function applyParameterModulators(e,t,o,u,f,p){let{amount:g,offset:M,defaultAmount:F=1,curve:S="linear",values:k,holdEnd:N,defaultValues:$}=f;g==null&&(g=k.some(ie=>ie!=null)?F:0);const R=M??0,U=g+R;if(Math.abs(U-R)){const[K,ie,de,te]=getADSRValues(k,S,$);getParamADSR(t,K,ie,de,te,R,U,o,N,S)}const Z=getParamLfo(e,t,o,u,p);return{lfo:Z,disconnect:()=>Z?.disconnect()}}function createFilter(e,t,o,u,f,p){let{frequency:g,anchor:M,env:F,type:S,model:k,q:N=1,drive:$=.69,depth:R,depthfrequency:U,dcoffset:O=-.5,skew:Z,shape:K,rate:ie,sync:de}=u,te,re;k==="ladder"?(re=getWorklet(e,"ladder-processor",{frequency:g,q:N,drive:$}),te=re.parameters.get("frequency")):(re=e.createBiquadFilter(),re.type=S,re.Q.value=N,re.frequency.value=g,te=re.frequency);const ue=[u.attack,u.decay,u.sustain,u.release],[ve,Ae,Fe,we]=getADSRValues(ue,"exponential",[.005,.14,0,.1]);if([...ue,F].some(Ze=>Ze!==void 0)){F=nanFallback(F,1,!0),M=nanFallback(M,0,!0);const Ze=Math.abs(F),Je=Ze*M;let Qe=clamp(2**-Je*g,0,2e4),rt=clamp(2**(Ze-Je)*g,0,2e4);F<0&&([Qe,rt]=[rt,Qe]),getParamADSR(te,ve,Ae,Fe,we,Qe,rt,t,o,"exponential")}de!=null&&(ie=f*de);const be=[R,U,Z,K,ie].some(Ze=>Ze!==void 0);let le;if(be){R=R??1;const Ze=p/f,Qe={depth:U??(R??1)*g,dcoffset:O,skew:Z,shape:K,frequency:ie??f,min:-g+30,max:2e4-g,time:Ze,curve:1};le=getParamLfo(e,te,t,o,Qe)}return{filter:re,lfo:le}}let wetfade=e=>e<.5?1:1-(e-.5)/.5;function drywet(e,t,o=0){const u=getAudioContext();if(!o)return e;let f=u.createGain(),p=u.createGain();e.connect(f),t.connect(p),f.gain.value=wetfade(o),p.gain.value=wetfade(1-o);let g=u.createGain();return f.connect(g),p.connect(g),{node:g,onended:()=>{f.disconnect(g),p.disconnect(g),e.disconnect(f),t.disconnect(p)}}}let curves=["linear","exponential"];function getPitchEnvelope(e,t,o,u){if((t.pattack??t.pdecay??t.psustain??t.prelease??t.penv)===void 0)return;const p=nanFallback(t.penv,1,!0),g=curves[t.pcurve??0];let[M,F,S,k]=getADSRValues([t.pattack,t.pdecay,t.psustain,t.prelease],g,[.2,.001,1,.001]),N=t.panchor??S;const $=p*100,R=0-$*N,U=$-$*N;getParamADSR(e,M,F,S,k,R,U,o,u,g)}function getVibratoOscillator(e,t,o){const{vibmod:u=.5,vib:f}=t;let p;if(f>0){p=getAudioContext().createOscillator(),p.frequency.value=f;const g=getAudioContext().createGain();return g.gain.value=u*100,p.connect(g),g.connect(e),p.onended=()=>{g.disconnect(e),p.disconnect(g)},p.start(o),p}}function scheduleAtTime(e,t,o=getAudioContext()){const u=o.currentTime;webAudioTimeout(o,e,u,t)}function webAudioTimeout(e,t,o,u){const f=new ConstantSourceNode(e),p=gainNode(0);return p.connect(e.destination),f.connect(p),f.onended=()=>{try{p.disconnect()}catch{}try{f.disconnect()}catch{}t()},f.start(o),f.stop(u),f}const mod$2=(e,t=1,o="sine")=>{const u=getAudioContext();let f;noises.includes(o)?(f=u.createBufferSource(),f.buffer=getNoiseBuffer(o,2),f.loop=!0):(f=u.createOscillator(),f.type=o,f.frequency.value=e),f.start();const p=gainNode(t);return f.connect(p),{node:p,stop:g=>f.stop(g),osc:f}},fm=(e,t,o,u="sine")=>{const p=e.value*t,g=p*o;return mod$2(p,g,u)};function applyFM(e,t,o){const{fmh:u=1,fmi:f,fmenv:p="exp",fmattack:g,fmdecay:M,fmsustain:F,fmrelease:S,fmvelocity:k,fmwave:N="sine",duration:$}=t;let R,U=()=>{};if(f){const Z=getAudioContext().createGain(),K=fm(e,u,f,N);if(R=K.node,U=K.stop,![g,M,F,S,k].some(ie=>ie!==void 0))R.connect(e);else{const[ie,de,te,re]=getADSRValues([g,M,F,S]),ue=o+$;getParamADSR(Z.gain,ie,de,te,re,0,1,o,ue,p==="exp"?"exponential":"linear"),R.connect(Z),Z.connect(e)}K.osc.onended=()=>{Z.disconnect(),R.disconnect(),K.osc.disconnect()}}return{stop:U}}const __squash=e=>e/(1+e),_mod=(e,t)=>(e%t+t)%t,_scurve=(e,t)=>(1+t)*e/(1+t*Math.abs(e)),_soft=(e,t)=>Math.tanh(e*(1+t)),_hard=(e,t)=>clamp((1+t)*e,-1,1),_fold=(e,t)=>{let o=(1+.5*t)*e;const u=_mod(o+1,4);return 1-Math.abs(u-2)},_sineFold=(e,t)=>Math.sin(Math.PI/2*_fold(e,t)),_cubic=(e,t)=>{const o=__squash(Math.log1p(t)),u=(e-o/3*e*e*e)/(1-o/3);return _soft(u,t)},_diode=(e,t,o=!1)=>{const u=1+2*t,p=.07*__squash(Math.log1p(t)),g=_soft(e+p,2*t),M=_soft(o?p:-e+p,2*t),F=g-M,S=1/Math.cosh(u*p),k=S*S,N=Math.max(1e-8,(o?1:2)*u*k);return _soft(F/N,t)},_asym=(e,t)=>_diode(e,t,!0),_chebyshev=(e,t)=>{const o=10*Math.log1p(t);let u=1,f=e,p,g=0;for(let M=1;M<64;M++){if(M<2){g+=M==0?u:f;continue}p=2*e*u-f,f=u,u=p,M%2===0&&(g+=Math.min(1.3*o/M,2)*p)}return _soft(g,o/20)},distortionAlgorithms={scurve:_scurve,soft:_soft,hard:_hard,cubic:_cubic,diode:_diode,asym:_asym,fold:_fold,sinefold:_sineFold,chebyshev:_chebyshev},_algoNames=Object.freeze(Object.keys(distortionAlgorithms)),getDistortionAlgorithm=e=>{let t=e;typeof e=="string"&&(t=_algoNames.indexOf(e),t===-1&&(logger$1(`[superdough] Could not find waveshaping algorithm ${e}.
        Available options are ${_algoNames.join(", ")}.
        Defaulting to ${_algoNames[0]}.`),t=0));const o=_algoNames[t%_algoNames.length];return distortionAlgorithms[o]},getDistortion=(e,t,o)=>getWorklet(getAudioContext(),"distort-processor",{distort:e,postgain:t},{processorOptions:{algorithm:o}}),getFrequencyFromValue=(e,t=36)=>{let{note:o,freq:u,octave:f=0}=e;return o=o||t,typeof o=="string"&&(o=noteToMidi(o)),!u&&typeof o=="number"&&(u=midiToFreq$1(o)),u*=Math.pow(2,f),Number(u)},destroyAudioWorkletNode=e=>{e!=null&&(e.disconnect(),e.parameters.get("end")?.setValueAtTime(0,0))};let clean=Symbol("clean"),listenerQueue=[],lqIndex=0;const QUEUE_ITEMS_PER_LISTENER=4;let atom=e=>{let t=[],o={get(){return o.lc||o.listen(()=>{})(),o.value},lc:0,listen(u){return o.lc=t.push(u),()=>{for(let p=lqIndex+QUEUE_ITEMS_PER_LISTENER;p<listenerQueue.length;)listenerQueue[p]===u?listenerQueue.splice(p,QUEUE_ITEMS_PER_LISTENER):p+=QUEUE_ITEMS_PER_LISTENER;let f=t.indexOf(u);~f&&(t.splice(f,1),--o.lc||o.off())}},notify(u,f){let p=!listenerQueue.length;for(let g of t)listenerQueue.push(g,o.value,u,f);if(p){for(lqIndex=0;lqIndex<listenerQueue.length;lqIndex+=QUEUE_ITEMS_PER_LISTENER)listenerQueue[lqIndex](listenerQueue[lqIndex+1],listenerQueue[lqIndex+2],listenerQueue[lqIndex+3]);listenerQueue.length=0}},off(){},set(u){let f=o.value;f!==u&&(o.value=u,o.notify(f))},subscribe(u){let f=o.listen(u);return u(o.value),f},value:e};return process.env.NODE_ENV!=="production"&&(o[clean]=()=>{t=[],o.lc=0,o.off()}),o},map=(e={})=>{let t=atom(e);return t.setKey=function(o,u){let f=t.value;typeof u>"u"&&o in t.value?(t.value={...t.value},delete t.value[o],t.notify(f,o)):t.value[o]!==u&&(t.value={...t.value,[o]:u},t.notify(f,o))},t};const bufferCache$1={},loadCache$2={},getCachedBuffer=e=>bufferCache$1[e];function humanFileSize$1(e,t){var o=1024;if(e<o)return e+" B";var u=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],f=-1;do e/=o,++f;while(e>=o);return e.toFixed(1)+" "+u[f]}function getSampleInfo(e,t){const{speed:o=1}=e,{transpose:u,url:f,index:p,midi:g,label:M}=getCommonSampleInfo(e,t);let F=Math.abs(o)*Math.pow(2,u/12);return{transpose:u,url:f,index:p,midi:g,label:M,playbackRate:F}}const getSampleBuffer=async(e,t,o)=>{let{url:u,label:f,playbackRate:p}=getSampleInfo(e,t);o&&(u=await o(u));const g=getAudioContext(),M=await loadBuffer$1(u,g,f);return e.unit==="c"&&(p=p*M.duration),{buffer:M,playbackRate:p}},getSampleBufferSource=async(e,t,o)=>{let{buffer:u,playbackRate:f}=await getSampleBuffer(e,t,o);e.speed<0&&(u=reverseBuffer(u));const g=getAudioContext().createBufferSource();g.buffer=u,g.playbackRate.value=f;const{loopBegin:M=0,loopEnd:F=1,begin:S=0,end:k=1}=e,N=S*g.buffer.duration;e.loop&&(g.loop=!0,g.loopStart=M*g.buffer.duration-N,g.loopEnd=F*g.buffer.duration-N);const R=g.buffer.duration/g.playbackRate.value,U=(k-S)*R;return{bufferSource:g,offset:N,bufferDuration:R,sliceDuration:U}},loadBuffer$1=(e,t,o,u=0)=>{const f=o?`sound "${o}:${u}"`:"sample";if(e=e.replace("#","%23"),!loadCache$2[e]){logger$1(`[sampler] load ${f}..`,"load-sample",{url:e});const p=Date.now();loadCache$2[e]=fetch(e).then(g=>g.arrayBuffer()).then(async g=>{const M=Date.now()-p,F=humanFileSize$1(g.byteLength);logger$1(`[sampler] load ${f}... done! loaded ${F} in ${M}ms`,"loaded-sample",{url:e});const S=await t.decodeAudioData(g);return bufferCache$1[e]=S,S})}return loadCache$2[e]};function reverseBuffer(e){const t=getAudioContext(),o=t.createBuffer(e.numberOfChannels,e.length,t.sampleRate);for(let u=0;u<e.numberOfChannels;u++)o.copyToChannel(e.getChannelData(u).slice().reverse(),u,u);return o}const getLoadedBuffer=e=>bufferCache$1[e];function resolveSpecialPaths(e){if(e.startsWith("bubo:")){const[t,o]=e.split(":");e=`github:Bubobubobubobubo/dough-${o}`}return e}function githubPath$2(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let o=e.slice(7);o=o.endsWith("/")?o.slice(0,-1):o;let u=o.split("/"),f=u[0],p=u.length>=2?u[1]:"samples",g=u.length>=3?u[2]:"main",M=u.slice(3);return M.push(t||""),M=M.join("/"),`https://raw.githubusercontent.com/${f}/${p}/${g}/${M}`}const processSampleMap=(e,t,o=e._base||"")=>Object.entries(e).forEach(([u,f])=>{if(typeof f=="string"&&(f=[f]),typeof f!="object")throw new Error("wrong sample map format for "+u);o=f._base||o,o=resolveSpecialPaths(o),o.startsWith("github:")&&(o=githubPath$2(o,""));const p=g=>o+g;Array.isArray(f)?f=f.map(p):f=Object.fromEntries(Object.entries(f).map(([g,M])=>[g,(typeof M=="string"?[M]:M).map(p)])),t(u,f)});let resourcePrefixHandlers={};function registerSamplesPrefix(e,t){resourcePrefixHandlers[e]=t}function getSamplesPrefixHandler(e){const t=Object.entries(resourcePrefixHandlers).find(([o])=>e.startsWith(o));if(t)return t[1]}async function fetchSampleMap$1(e){const t=getSamplesPrefixHandler(e);if(t)return t(e);if(e=resolveSpecialPaths(e),e.startsWith("github:")&&(e=githubPath$2(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[f,p]=e.split("shabda:");e=`https://shabda.ndre.gr/${p}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[f,p]=e.split("shabda/speech");p=p.startsWith("/")?p.substring(1):p;let[g,M]=p.split(":"),F="f",S="en-GB";g&&([S,F]=g.split("/")),e=`https://shabda.ndre.gr/speech/${M}.json?gender=${F}&language=${S}&strudel=1'`}if(typeof fetch!="function")return;const o=getBaseURL(e);if(typeof fetch>"u")return;const u=await fetch(e).then(f=>f.json()).catch(f=>{throw console.error(f),new Error(`error loading "${e}"`)});return[u,u._base||o]}const samples=async(e,t=e._base||"",o={})=>{if(typeof e=="string"){const[p,g]=await fetchSampleMap$1(e);return samples(p,t||g,o)}const{prebake:u,tag:f}=o;processSampleMap(e,(p,g)=>{registerSampleSource(p,g,{baseUrl:t,prebake:u,tag:f})},t)},cutGroups=[];async function onTriggerSample(e,t,o,u,f){let{s:p,nudge:g=0,cut:M,loop:F,clip:S=void 0,n:k=0,speed:N=1,duration:$}=t;if(N===0)return;const R=getAudioContext();let[U,O,Z,K]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);const{bufferSource:ie,sliceDuration:de,offset:te}=await getSampleBufferSource(t,u,f);if(R.currentTime>e){logger$1(`[sampler] still loading sound "${p}:${k}"`,"highlight");return}if(!ie){logger$1(`[sampler] could not load "${p}:${k}"`,"error");return}let re=getVibratoOscillator(ie.detune,t,e);const ue=e+g;ie.start(ue,te);const ve=R.createGain(),Ae=ie.connect(ve);S==null&&F==null&&t.release==null&&($=de);let Fe=e+$;getParamADSR(Ae.gain,U,O,Z,K,0,1,e,Fe,"linear"),getPitchEnvelope(ie.detune,t,e,Fe);const we=R.createGain();Ae.connect(we),ie.onended=function(){ie.disconnect(),re?.stop(),Ae.disconnect(),we.disconnect(),o()};let Ce=Fe+K+.01;ie.stop(Ce);const le={node:we,bufferSource:ie,stop:Ze=>{ie.stop(Ze)}};if(M!==void 0){const Ze=cutGroups[M];Ze&&(Ze.node.gain.setValueAtTime(1,ue),Ze.node.gain.linearRampToValueAtTime(0,ue+.01)),cutGroups[M]=le}return le}function registerSample(e,t,o){registerSound(e,(u,f,p)=>onTriggerSample(u,f,p,t),{type:"sample",samples:t,...o})}function registerSampleSource(e,t,o){e.startsWith("wt_")?registerWaveTable(e,t,o):registerSample(e,t,o)}let hasChanged=(e,t)=>e!==void 0&&e!==t;class Orbit{reverbNode;delayNode;output;summingNode;djfNode;audioContext;constructor(t){this.audioContext=t,this.output=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode=new GainNode(t,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode.connect(this.output)}disconnect(){this.output.disconnect(),this.summingNode.disconnect(),this.delayNode?.disconnect(),this.reverbNode?.disconnect()}getDjf(t,o=0){this.djfNode==null&&(this.djfNode=getWorklet(this.audioContext,"djf-processor",{value:t}),this.summingNode.disconnect(),this.summingNode.connect(this.djfNode),this.djfNode.connect(this.output)),this.djfNode.parameters.get("value").setValueAtTime(t,o)}getDelay(t=0,o=.5,u){return o=clamp(o,0,.98),this.delayNode==null&&(this.delayNode=this.audioContext.createFeedbackDelay(1,t,o),this.delayNode.connect(this.summingNode),this.delayNode.start?.(u)),this.delayNode.delayTime.value!==t&&this.delayNode.delayTime.setValueAtTime(t,u),this.delayNode.feedback.value!==o&&this.delayNode.feedback.setValueAtTime(o,u),this.delayNode}getReverb(t,o,u,f,p,g,M){return this.reverbNode==null&&(this.reverbNode=this.audioContext.createReverb(t,o,u,f,p,g,M),this.reverbNode.connect(this.summingNode)),(hasChanged(t,this.reverbNode.duration)||hasChanged(o,this.reverbNode.fade)||hasChanged(u,this.reverbNode.lp)||hasChanged(f,this.reverbNode.dim)||hasChanged(g,this.reverbNode.irspeed)||hasChanged(M,this.reverbNode.irbegin)||this.reverbNode.ir!==p)&&this.reverbNode.generate(t,o,u,f,p,g,M),this.reverbNode}sendReverb(t,o){return effectSend(t,this.reverbNode,o)}sendDelay(t,o){return effectSend(t,this.delayNode,o)}duck(t,o=0,u=.1,f=1){const p=o,g=Math.max(u,.002),M=this.output.gain;webAudioTimeout(this.audioContext,()=>{const F=this.audioContext.currentTime,S=M.value;M.cancelScheduledValues(F),M.setValueAtTime(S,F);const k=Math.max(t,F),N=clamp(1-Math.sqrt(f),.01,S);M.exponentialRampToValueAtTime(N,k+p),M.exponentialRampToValueAtTime(1,k+p+g)},0,t-.01)}connectToOutput(t){t.connect(this.summingNode)}}class SuperdoughOutput{channelMerger;destinationGain;constructor(t){this.audioContext=t,this.initializeAudio()}initializeAudio(){const t=this.audioContext,o=t.destination.maxChannelCount;this.audioContext.destination.channelCount=o,this.channelMerger=new ChannelMergerNode(t,{numberOfInputs:t.destination.channelCount}),this.destinationGain=new GainNode(t),this.channelMerger.connect(this.destinationGain),this.destinationGain.connect(t.destination)}reset(){this.disconnect(),this.initializeAudio()}disconnect(){this.channelMerger.disconnect(),this.destinationGain.disconnect(),this.destinationGain=null,this.channelMerger=null}connectToDestination=(t,o=[0,1])=>{const u=new StereoPannerNode(this.audioContext);t.connect(u);const f=new ChannelSplitterNode(this.audioContext,{numberOfOutputs:u.channelCount});u.connect(f),o.forEach((p,g)=>{f.connect(this.channelMerger,g%u.channelCount,p%this.audioContext.destination.channelCount)})}}class SuperdoughAudioController{audioContext;output;nodes={};constructor(t){this.audioContext=t,this.output=new SuperdoughOutput(t)}reset(){Array.from(this.nodes).forEach(t=>{t.disconnect()}),this.nodes={},this.output.reset()}duck(t,o,u=0,f=.1,p=1){const g=[t].flat(),M=[u].flat(),F=[f].flat(),S=[p].flat();g.forEach((k,N)=>{const $=this.nodes[k];if($==null){errorLogger(new Error(`duck target orbit ${k} does not exist`),"superdough");return}const R=M[N]??M[0],U=Math.max(F[N]??F[0],.002),O=S[N]??S[0];$.duck(o,R,U,O)})}getOrbit(t,o){return this.nodes[t]==null&&(this.nodes[t]=new Orbit(this.audioContext),this.output.connectToDestination(this.nodes[t].output,o)),this.nodes[t]}}const DEFAULT_MAX_POLYPHONY=128,DEFAULT_AUDIO_DEVICE_NAME="System Standard";let maxPolyphony=DEFAULT_MAX_POLYPHONY;function setMaxPolyphony(e){maxPolyphony=parseInt(e)??DEFAULT_MAX_POLYPHONY}let multiChannelOrbits=!1;function setMultiChannelOrbits(e){multiChannelOrbits=e==!0}const soundMap$1=map();function registerSound(e,t,o={}){e=e.toLowerCase().replace(/\s+/g,"_"),soundMap$1.setKey(e,{onTrigger:t,data:o})}let gainCurveFunc=e=>e;function applyGainCurve(e){return gainCurveFunc(e)}function setGainCurve(e){gainCurveFunc=e}function aliasBankMap(e){for(const o in e)e[o.toLowerCase()]=e[o];const t=soundMap$1.get();for(const o in t){const[u,f]=o.split("_");if(!f)continue;const p=e[u];if(p){if(typeof p=="string")t[`${p}_${f}`.toLowerCase()]=t[o];else if(Array.isArray(p))for(const g of p)t[`${g}_${f}`.toLowerCase()]=t[o]}}soundMap$1.set({...t})}async function aliasBankPath(e){const o=await(await fetch(e)).json();aliasBankMap(o)}async function aliasBank(...e){switch(e.length){case 1:return typeof e[0]=="string"?aliasBankPath(e[0]):aliasBankMap(e[0]);case 2:return aliasBankMap({[e[0]]:e[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+e.length)}}function soundAlias(e,t){if(getSound(e)==null){logger$1("soundAlias: original sound not found");return}soundMap$1.setKey(t,getSound(e))}function getSound(e){return typeof e!="string"?(console.warn(`getSound: expected string got "${e}". fall back to triangle`),soundMap$1.get().triangle):soundMap$1.get()[e.toLowerCase()]}const getAudioDevices=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let e=await navigator.mediaDevices.enumerateDevices();e=e.filter(o=>o.kind==="audiooutput"&&o.deviceId!=="default");const t=new Map;return t.set(DEFAULT_AUDIO_DEVICE_NAME,""),e.forEach(o=>{t.set(o.label,o.deviceId)}),t};let defaultDefaultValues={s:"triangle",gain:.8,postgain:1,density:".03",channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const defaultDefaultDefaultValues=Object.freeze({...defaultDefaultValues});function setDefault(e,t){defaultDefaultValues[e]=t}function resetDefaults(){defaultDefaultValues={...defaultDefaultDefaultValues}}let defaultControls=new Map(Object.entries(defaultDefaultValues));function setDefaultValue(e,t){defaultControls.set(e,t)}function getDefaultValue(e){return defaultControls.get(e)}function setDefaultValues(e){Object.keys(e).forEach(t=>{setDefaultValue(t,e[t])})}function resetDefaultValues(){defaultControls=new Map(Object.entries(defaultDefaultValues))}function setVersionDefaults(e){resetDefaultValues(),e==="1.0"&&setDefaultValue("fanchor",.5)}const resetLoadedSounds=()=>soundMap$1.set({});let externalWorklets=[];function registerWorklet(e){externalWorklets.push(e)}let workletsLoading;function loadWorklets(){if(!workletsLoading){const e=getAudioContext(),t=externalWorklets.concat([workletsUrl]);workletsLoading=Promise.all(t.map(o=>e.audioWorklet.addModule(o)))}return workletsLoading}async function initAudio(e={}){const{disableWorklets:t=!1,maxPolyphony:o,audioDeviceName:u=DEFAULT_AUDIO_DEVICE_NAME,multiChannelOrbits:f=!1}=e;if(setMaxPolyphony(o),setMultiChannelOrbits(f),typeof window>"u")return;const p=getAudioContext();if(u!=null&&u!=DEFAULT_AUDIO_DEVICE_NAME)try{const M=(await getAudioDevices()).get(u),F=(M??"").length>0;p.sinkId!==M&&F&&await p.setSinkId(M),logger$1(`[superdough] Audio Device set to ${u}, it might take a few seconds before audio plays on all output channels`)}catch{logger$1("[superdough] failed to set audio interface","warning")}if(await p.resume(),t){logger$1("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await loadWorklets(),logger$1("[superdough] AudioWorklets loaded")}catch(g){console.warn("could not load AudioWorklet effects",g)}logger$1("[superdough] ready")}let audioReady;async function initAudioOnFirstClick(e){return audioReady||(audioReady=new Promise(t=>{document.addEventListener("mousedown",async function o(){document.removeEventListener("mousedown",o),await initAudio(e),t()})})),audioReady}let controller;function getSuperdoughAudioController(){return controller==null&&(controller=new SuperdoughAudioController(getAudioContext())),controller}function connectToDestination(e,t){getSuperdoughAudioController().output.connectToDestination(e,t)}function getPhaser(e,t,o=1,u=.5,f=1e3,p=2e3){const g=getAudioContext(),M=getLfo(g,e,t,{frequency:o,depth:p*2}),F=2;let S=0;const k=[];for(let N=0;N<F;N++){const $=g.createBiquadFilter();$.type="notch",$.gain.value=1,$.frequency.value=f+S,$.Q.value=2-Math.min(Math.max(u*2,0),1.9),M.connect($.detune),S+=282,N>0&&k[N-1].connect($),k.push($)}return{phaser:k[k.length-1],lfo:M}}function getFilterType(e){e=e??0;const t=["12db","ladder","24db"];return typeof e=="number"?t[Math.floor(_mod$1(e,t.length))]:e}let analysers={},analysersData={};function getAnalyserById(e,t=1024,o=.5){if(!analysers[e]){const u=getAudioContext().createAnalyser();u.fftSize=t,u.smoothingTimeConstant=o,analysers[e]=u,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)}return analysers[e].fftSize!==t&&(analysers[e].fftSize=t,analysersData[e]=new Float32Array(analysers[e].frequencyBinCount)),analysers[e]}function getAnalyzerData(e="time",t=1){const o={time:()=>analysers[t]?.getFloatTimeDomainData(analysersData[t]),frequency:()=>analysers[t]?.getFloatFrequencyData(analysersData[t])}[e];if(!o)throw new Error(`getAnalyzerData: ${e} not supported. use one of ${Object.keys(o).join(", ")}`);return o(),analysersData[t]}function resetGlobalEffects(){controller?.reset(),analysers={},analysersData={}}let activeSoundSources=new Map;function mapChannelNumbers(e){return(Array.isArray(e)?e:[e]).map(t=>t-1)}const superdough=async(e,t,o,u=.5,f=.5)=>{const p=getAudioContext(),g=getSuperdoughAudioController();let{stretch:M}=e;if(M!=null&&(t=t-.04),typeof e!="object")throw new Error(`expected hap.value to be an object, but got "${e}". Hint: append .note() or .s() to the end`,"error");if(e.duration=o,t<p.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${t.toFixed(2)}, now: ${p.currentTime.toFixed(2)})`);return}let{tremolo:F,tremolosync:S,tremolodepth:k=1,tremoloskew:N,tremolophase:$=0,tremoloshape:R,s:U=getDefaultValue("s"),bank:O,source:Z,gain:K=getDefaultValue("gain"),postgain:ie=getDefaultValue("postgain"),density:de=getDefaultValue("density"),duckorbit:te,duckonset:re,duckattack:ue,duckdepth:ve,djf:Ae,fanchor:Fe=getDefaultValue("fanchor"),release:we=0,phaserrate:Ce,phaserdepth:be=getDefaultValue("phaserdepth"),phasersweep:le,phasercenter:Ze,coarse:Je,crush:Qe,dry:rt,shape:tt,shapevol:kt=getDefaultValue("shapevol"),distort:Lt,distortvol:Tt=getDefaultValue("distortvol"),distorttype:ke=getDefaultValue("distorttype"),pan:at,vowel:je,delay:Ie=getDefaultValue("delay"),delayfeedback:nt=getDefaultValue("delayfeedback"),delaysync:pt=getDefaultValue("delaysync"),delaytime:Ft,orbit:ht=getDefaultValue("orbit"),room:Zt,roomfade:Qt,roomlp:Bt,roomdim:_t,roomsize:$t,ir:rn,irspeed:Gt,irbegin:Yt,i:yn=getDefaultValue("i"),velocity:xe=getDefaultValue("velocity"),analyze:Pe,fft:ye=getDefaultValue("fft"),compressor:Te,compressorRatio:He,compressorKnee:et,compressorAttack:We,compressorRelease:yt}=e;Ft=Ft??cycleToSeconds(pt,u);const $e=mapChannelNumbers(multiChannelOrbits&&ht>0?[ht*2-1,ht*2]:getDefaultValue("channels")),Ye=e.channels!=null?mapChannelNumbers(e.channels):$e,mt=g.getOrbit(ht,Ye);te!=null&&g.duck(te,t,re,ue,ve),K=applyGainCurve(nanFallback(K,1)),ie=applyGainCurve(ie),kt=applyGainCurve(kt),Tt=applyGainCurve(Tt),Ie=applyGainCurve(Ie),xe=applyGainCurve(xe),k=applyGainCurve(k),K*=xe;const It=t+o,zt=It+we,Ue=Math.round(Math.random()*1e6);for(let ot=0;ot<=activeSoundSources.size-maxPolyphony;ot++){const Pt=activeSoundSources.entries().next(),Dt=Pt.value[1].deref(),Ut=Pt.value[0],Kt=t+.25;Dt?.node?.gain?.linearRampToValueAtTime(0,Kt),Dt?.stop?.(Kt),activeSoundSources.delete(Ut)}let Et=[];if(["-","~","_"].includes(U))return;O&&U&&(U=`${O}_${U}`,e.s=U);let Ht;if(Z)Ht=Z(t,e,o,u);else if(getSound(U)){const{onTrigger:ot}=getSound(U),Dt=await ot(t,e,()=>{Et.forEach(Ut=>Ut?.disconnect()),activeSoundSources.delete(Ue)},u);Dt&&(Ht=Dt.node,activeSoundSources.set(Ue,new WeakRef(Dt)))}else throw new Error(`sound ${U} not found! Is it loaded?`);if(!Ht)return;if(p.currentTime>t){logger$1("[webaudio] skip hap: still loading",p.currentTime-t);return}const Oe=[];Oe.push(Ht),M!==void 0&&Oe.push(getWorklet(p,"phase-vocoder-processor",{pitchFactor:M})),Oe.push(gainNode(K));const Wt=getFilterType(e.ftype);if(e.cutoff!==void 0){const Pt=pickAndRename(e,{frequency:"cutoff",q:"resonance",attack:"lpattack",decay:"lpdecay",sustain:"lpsustain",release:"lprelease",env:"lpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"lprate",sync:"lpsync",depth:"lpdepth",depthfrequency:"lpdepthfrequency",shape:"lpshape",dcoffset:"lpdc",skew:"lpskew"});Pt.type="lowpass";const Dt=()=>createFilter(p,t,It,Pt,u,f),{filter:Ut,lfo:Kt}=Dt();if(Oe.push(Ut),Kt&&Et.push(Kt),Wt==="24db"){const{filter:ln,lfo:hn}=Dt();Oe.push(ln),hn&&Et.push(hn)}}if(e.hcutoff!==void 0){const Pt=pickAndRename(e,{frequency:"hcutoff",q:"hresonance",attack:"hpattack",decay:"hpdecay",sustain:"hpsustain",release:"hprelease",env:"hpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"hprate",sync:"hpsync",depth:"hpdepth",depthfrequency:"hpdepthfrequency",shape:"hpshape",dcoffset:"hpdc",skew:"hpskew"});Pt.type="highpass";const Dt=()=>createFilter(p,t,It,Pt,u,f),{filter:Ut,lfo:Kt}=Dt();if(Oe.push(Ut),Kt&&Et.push(Kt),Wt==="24db"){const{filter:ln,lfo:hn}=Dt();Oe.push(ln),hn&&Et.push(hn)}}if(e.bandf!==void 0){const Pt=pickAndRename(e,{frequency:"bandf",q:"bandq",attack:"bpattack",decay:"bpdecay",sustain:"bpsustain",release:"bprelease",env:"bpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"bprate",sync:"bpsync",depth:"bpdepth",depthfrequency:"bpdepthfrequency",shape:"bpshape",dcoffset:"bpdc",skew:"bpskew"});Pt.type="bandpass";const Dt=()=>createFilter(p,t,It,Pt,u,f),{filter:Ut,lfo:Kt}=Dt();if(Oe.push(Ut),Kt&&Et.push(Kt),Wt==="24db"){const{filter:ln,lfo:hn}=Dt();Oe.push(ln),hn&&Et.push(hn)}}if(je!==void 0){const ot=p.createVowelFilter(je);Oe.push(ot)}if(Je!==void 0&&Oe.push(getWorklet(p,"coarse-processor",{coarse:Je})),Qe!==void 0&&Oe.push(getWorklet(p,"crush-processor",{crush:Qe})),tt!==void 0&&Oe.push(getWorklet(p,"shape-processor",{shape:tt,postgain:kt})),Lt!==void 0&&Oe.push(getDistortion(Lt,Tt,ke)),S!=null&&(F=u*S),e.wtPosSynced!=null&&(e.wtPosRate/=u),e.wtWarpSynced!=null&&(e.wtWarpRate/=u),F!==void 0){const ot=Math.max(1-k,0),Pt=new GainNode(p,{gain:ot}),Dt=f/u,Ut=getLfo(p,t,zt,{skew:N??(R!=null?.5:1),frequency:F,depth:k,time:Dt,dcoffset:0,shape:R,phaseoffset:$,min:0,max:1,curve:1.5});Ut.connect(Pt.gain),Et.push(Ut),Oe.push(Pt)}if(Te!==void 0&&Oe.push(getCompressor(p,Te,He,et,We,yt)),at!==void 0){const ot=p.createStereoPanner();ot.pan.value=2*at-1,Oe.push(ot)}if(Ce!==void 0&&be>0){const{phaser:ot,lfo:Pt}=getPhaser(t,zt,Ce,be,Ze,le);Et.push(Pt),Oe.push(ot)}const sn=new GainNode(p,{gain:ie});if(Oe.push(sn),Ie>0&&Ft>0&&nt>0){mt.getDelay(Ft,nt,t);const ot=mt.sendDelay(sn,Ie);Et.push(ot)}if(Zt>0){let ot;if(rn!==void 0){let Dt,Ut=getSound(rn);Array.isArray(Ut)?Dt=Ut.data.samples[yn%Ut.data.samples.length]:typeof Ut=="object"&&(Dt=Object.values(Ut.data.samples).flat()[yn%Object.values(Ut.data.samples).length]),ot=await loadBuffer$1(Dt,p,rn,0)}mt.getReverb($t,Qt,Bt,_t,ot,Gt,Yt);const Pt=mt.sendReverb(sn,Zt);Et.push(Pt)}if(Ae!=null&&mt.getDjf(Ae,t),Pe){const ot=getAnalyserById(Pe,2**(ye+5)),Pt=effectSend(sn,ot,1);Et.push(Pt)}if(rt!=null){rt=applyGainCurve(rt);const ot=new GainNode(p,{gain:rt});Oe.push(ot),mt.connectToOutput(ot)}else mt.connectToOutput(sn);Oe.slice(1).reduce((ot,Pt)=>ot.connect(Pt),Oe[0]),Et=Et.concat(Oe)},superdoughTrigger=(e,t,o,u)=>{superdough(t,e-o,t.duration/u,u)},waveforms=["triangle","square","sawtooth","sine","user"],waveformAliases=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function makeSaturationCurve(e,t){const o=e,u=new Float32Array(t);for(let f=0;f<t;f++){const p=f*2/t-1;u[f]=Math.tanh(p*o)}return u}function registerSynthSounds(){[...waveforms].forEach(e=>{registerSound(e,(t,o,u)=>{const[f,p,g,M]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]),F=gainNode(.3);let S=getOscillator(e,t,o,()=>{F.disconnect(),u()}),{node:k,stop:N,triggerRelease:$}=S;const{duration:R}=o,U=gainNode(1);let O=k.connect(F).connect(U);const Z=t+R;getParamADSR(O.gain,f,p,g,M,0,1,t,Z,"linear");const K=Z+M+.01;return $?.(K),N(K),{node:O,stop:ie=>{N(ie)}}},{type:"synth",prebake:!0})}),registerSound("sbd",(e,t,o)=>{const{duration:u,decay:f=.5,pdecay:p=.5,penv:g=36,clip:M}=t,F=getAudioContext(),S=.02,k=1.2,N=.025,$=1,R=F.createOscillator();R.type="triangle",R.frequency.value=getFrequencyFromValue(t,29),R.detune.setValueAtTime(g*100,0),R.detune.setValueAtTime(g*100,e),R.detune.exponentialRampToValueAtTime(.001,e+p);const U=gainNode(1);U.gain.setValueAtTime(1,e+S),U.gain.exponentialRampToValueAtTime(.001,e+S+f),R.start(e);const O=getNoiseOscillator("brown",e,2),Z=gainNode(1);Z.gain.setValueAtTime(k,e),Z.gain.exponentialRampToValueAtTime(.001,e+N);const K=new WaveShaperNode(F);K.curve=makeSaturationCurve(2,F.sampleRate);const ie=gainNode($);R.onended=()=>{R.disconnect(),U.disconnect(),K.disconnect(),O.node.disconnect(),Z.disconnect(),ie.disconnect(),o()};const de=R.connect(K).connect(U).connect(ie);O.node.connect(Z).connect(ie);let re=e+f+.01;return M!=null&&(re=Math.min(e+M*u,re)),ie.gain.setValueAtTime($,re-.01),ie.gain.linearRampToValueAtTime(0,re),R.stop(re),O.stop(re),{node:de,stop:ue=>{R.stop(ue)}}},{type:"synth",prebake:!0}),registerSound("supersaw",(e,t,o)=>{const u=getAudioContext();let{duration:f,n:p,unison:g=5,spread:M=.6,detune:F}=t;F=F??p??.18;const S=getFrequencyFromValue(t),[k,N,$,R]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),U=e+f,O=U+R+.01,Z=clamp(g,1,100);let K=Z>1?clamp(M,0,1):0,ie=getWorklet(u,"supersaw-oscillator",{frequency:S,begin:e,end:O,freqspread:F,voices:Z,panspread:K},{outputChannelCount:[2]});const de=1/Math.sqrt(Z);getPitchEnvelope(ie.parameters.get("detune"),t,e,U);const te=getVibratoOscillator(ie.parameters.get("detune"),t,e),re=applyFM(ie.parameters.get("frequency"),t,e);let ue=gainNode(1);ue=ie.connect(ue),getParamADSR(ue.gain,k,N,$,R,0,.3*de,e,U,"linear");let ve=webAudioTimeout(u,()=>{destroyAudioWorkletNode(ie),ue.disconnect(),o(),re?.stop(),te?.stop()},e,O);return{node:ue,stop:Ae=>{ve.stop(Ae)}}},{prebake:!0,type:"synth"}),registerSound("bytebeat",(e,t,o)=>{const u=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:f=0}=t,p=getFrequencyFromValue(t),{byteBeatExpression:g=u[f%u.length],byteBeatStartTime:M}=t,F=getAudioContext();let{duration:S}=t;const[k,N,$,R]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),U=e+S,O=U+R+.01;let Z=getWorklet(F,"byte-beat-processor",{frequency:p,begin:e,end:O},{outputChannelCount:[2]});Z.port.postMessage({codeText:g,byteBeatStartTime:M,frequency:p});let K=gainNode(1);K=Z.connect(K),getParamADSR(K.gain,k,N,$,R,0,1,e,U,"linear");let ie=webAudioTimeout(F,()=>{destroyAudioWorkletNode(Z),K.disconnect(),o()},e,O);return{node:K,stop:de=>{ie.stop(de)}}},{prebake:!0,type:"synth"}),registerSound("pulse",(e,t,o)=>{const u=getAudioContext();let{pwrate:f,pwsweep:p}=t;p==null&&(f!=null?p=.3:p=0),f==null&&p!=null&&(f=1);let{duration:g,pw:M=.5}=t;const F=getFrequencyFromValue(t),[S,k,N,$]=getADSRValues([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]),R=e+g,U=R+$+.01;let O=getWorklet(u,"pulse-oscillator",{frequency:F,begin:e,end:U,pulsewidth:M},{outputChannelCount:[2]});getPitchEnvelope(O.parameters.get("detune"),t,e,R);const Z=getVibratoOscillator(O.parameters.get("detune"),t,e),K=applyFM(O.parameters.get("frequency"),t,e);let ie=gainNode(1);ie=O.connect(ie),getParamADSR(ie.gain,S,k,N,$,0,1,e,R,"linear");let de;p!=0&&(de=getLfo(u,e,U,{frequency:f,depth:p}),de.connect(O.parameters.get("pulsewidth")));let te=webAudioTimeout(u,()=>{destroyAudioWorkletNode(O),destroyAudioWorkletNode(de),ie.disconnect(),o(),K?.stop(),Z?.stop()},e,U);return{node:ie,stop:re=>{te.stop(re)}}},{prebake:!0,type:"synth"}),[...noises].forEach(e=>{registerSound(e,(t,o,u)=>{const[f,p,g,M]=getADSRValues([o.attack,o.decay,o.sustain,o.release],"linear",[.001,.05,.6,.01]);let F,{density:S}=o;F=getNoiseOscillator(e,t,S);let{node:k,stop:N,triggerRelease:$}=F;const R=gainNode(.3),{duration:U}=o;k.onended=()=>{k.disconnect(),R.disconnect(),u()};const O=gainNode(1);let Z=k.connect(R).connect(O);const K=t+U;getParamADSR(Z.gain,f,p,g,M,0,1,t,K,"linear");const ie=K+M+.01;return $?.(ie),N(ie),{node:Z,stop:de=>{N(de)}}},{type:"synth",prebake:!0})}),waveformAliases.forEach(([e,t])=>soundMap$1.set({...soundMap$1.get(),[e]:soundMap$1.get()[t]}))}const PI2=2*Math.PI;function waveformN(e,t,o){e=typeof e=="object"?e:new Float32Array(e).fill(1);const f=e.length,p=new Float32Array(f+1),g=new Float32Array(f+1),M=getAudioContext(),F=M.createOscillator(),S={sawtooth:N=>[0,-1/N],square:N=>[0,N%2===0?0:1/N],triangle:N=>[N%2===0?0:1/(N*N),0],user:N=>[0,1]};if(!S[o])throw new Error(`unknown wave type ${o}`);for(let N=0;N<f;N++){const $=e[N],[R,U]=S[o](N+1),O=t?.[N]??0;let Z=R*$,K=U*$;if(O!==0){const ie=Math.cos(PI2*O),de=Math.sin(PI2*O);Z=ie*Z-de*K,K=de*Z+ie*K}p[N+1]=Z,g[N+1]=K}const k=M.createPeriodicWave(p,g);return F.setPeriodicWave(k),F}function getOscillator(e,t,o,u){const{duration:f,noise:p=0}=o,g=o.partials??o.n;let M;e==="user"&&!g&&(logger$1("[superdough] Synth 'user' was selected, but partials not specified. Defaulting to triangle. Use pat.partials to setup custom waveform"),e="triangle"),e=e==="user"&&!g?"triangle":e,!g||g?.length===0||e==="sine"?(M=getAudioContext().createOscillator(),M.type=e||"triangle"):M=waveformN(g,o.phases,e),M.frequency.value=getFrequencyFromValue(o);let F=getVibratoOscillator(M.detune,o,t);getPitchEnvelope(M.detune,o,t,t+f);const S=applyFM(M.frequency,o,t);let k;return p&&(k=getNoiseMix(M,p,t)),M.onended=()=>{k||M.disconnect(),k?.node.disconnect(),u()},M.start(t),{node:k?.node||M,stop:N=>{S.stop(N),F?.stop(N),k?.stop(N),M.stop(N)},triggerRelease:N=>{}}}function buildSamples(e=1,t=.05,o=220,u=0,f=0,p=.1,g=0,M=1,F=0,S=0,k=0,N=0,$=0,R=0,U=0,O=0,Z=0,K=1,ie=0,de=0){let te=Math.PI*2,re=getAudioContext().sampleRate,ue=kt=>kt>0?1:-1,ve=F*=500*te/re/re,Ae=o*=(1+t*2*Math.random()-t)*te/re,Fe=[],we=0,Ce=0,be=0,le=1,Ze=0,Je=0,Qe=0,rt,tt;for(u=u*re+9,ie*=re,f*=re,p*=re,Z*=re,S*=500*te/re**3,U*=te/re,k*=te/re,N*=re,$=$*re|0,tt=u+ie+f+p+Z|0;be<tt;Fe[be++]=Qe)++Je%(O*100|0)||(Qe=g?g>1?g>2?g>3?Math.sin((we%te)**3):Math.max(Math.min(Math.tan(we),1),-1):1-(2*we/te%2+2)%2:1-4*Math.abs(Math.round(we/te)-we/te):Math.sin(we),Qe=($?1-de+de*Math.sin(te*be/$):1)*ue(Qe)*Math.abs(Qe)**M*e*1*(be<u?be/u:be<u+ie?1-(be-u)/ie*(1-K):be<u+ie+f?K:be<tt-Z?(tt-be-Z)/p*K:0),Qe=Z?Qe/2+(Z>be?0:(be<tt-Z?1:(tt-be)/Z)*Fe[be-Z|0]/2):Qe),rt=(o+=F+=S)*Math.cos(U*Ce++),we+=rt-rt*R*(1-(Math.sin(be)+1)*1e9%2),le&&++le>N&&(o+=k,Ae+=k,le=0),$&&!(++Ze%$)&&(o=Ae,F=ve,le||=1);return Fe}const getZZFX=(e,t)=>{let{s:o,note:u=36,freq:f,zrand:p=0,attack:g=0,decay:M=0,sustain:F=.8,release:S=.1,curve:k=1,slide:N=0,deltaSlide:$=0,pitchJump:R=0,pitchJumpTime:U=0,lfo:O=0,znoise:Z=0,zmod:K=0,zcrush:ie=0,zdelay:de=0,tremolo:te=0,duration:re=.2,zzfx:ue}=e;const ve=Math.max(re-g-M,0);typeof u=="string"&&(u=noteToMidi(u)),!f&&typeof u=="number"&&(f=midiToFreq$1(u)),o=o.replace("z_","");const Ae=["sine","triangle","sawtooth","tan","noise"].indexOf(o)||0;k=o==="square"?0:k;const we=buildSamples(...ue||[.25,p,f,g,ve,S,Ae,k,N,$,R,U,O,Z,K,ie,de,F,M,te]),Ce=getAudioContext(),be=Ce.createBuffer(1,we.length,Ce.sampleRate);be.getChannelData(0).set(we);const le=getAudioContext().createBufferSource();return le.buffer=be,le.start(t),{node:le}};function registerZZFXSounds(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(e=>{registerSound(e,(t,o,u)=>{const{node:f}=getZZFX({s:e,...o},t);return f.onended=()=>{f.disconnect(),u()},{node:f,stop:()=>{}}},{type:"synth",prebake:!0})})}let worklet;async function dspWorklet(e,t){const o=`dsp-worklet-${Date.now()}`,u=`${t}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${o}', MyProcessor);
`,p=`data:text/javascript;base64,${btoa(u)}`;await e.audioWorklet.addModule(p);const g=new AudioWorkletNode(e,o);return{node:g,stop:()=>g.port.postMessage("stop")}}const stop=()=>{worklet&&(worklet?.stop(),worklet?.node?.disconnect())};typeof window<"u"&&window.addEventListener("message",e=>{e.data==="strudel-stop"?stop():e.data?.dough&&worklet?.node.port.postMessage(e.data)});const dough=async e=>{const t=getAudioContext();stop(),worklet=await dspWorklet(t,e),worklet.node.connect(t.destination)};function doughTrigger(e,t,o,u){window.postMessage({time:u,dough:e.value,currentTime:t,duration:e.duration,cps:o})}const Warpmode=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),seenKeys=new Set;async function getPayload(e,t,o=2048){const u=`${e},${o}`;if(!seenKeys.has(u)){const p=(await loadBuffer(e,t)).getChannelData(0),g=p.length,M=Math.max(1,Math.floor(g/o)),F=new Array(M);for(let S=0;S<M;S++){const k=S*o;F[S]=p.subarray(k,k+o)}return seenKeys.add(u),{frames:F,frameLen:o,numFrames:M,key:u}}return{frameLen:o,key:u}}function humanFileSize(e,t){var o=1024;if(e<o)return e+" B";var u=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],f=-1;do e/=o,++f;while(e>=o);return e.toFixed(1)+" "+u[f]}function parseWavSampleRate(e){const t=new DataView(e);let o=12;for(;o+8<=t.byteLength;){const u=String.fromCharCode(t.getUint8(o),t.getUint8(o+1),t.getUint8(o+2),t.getUint8(o+3)),f=t.getUint32(o+4,!0);if(u==="fmt ")return t.getUint32(o+12,!0);o+=8+f+(f&1)}return null}async function decodeAtNativeRate(e){const t=parseWavSampleRate(e)||44100;return await new OfflineAudioContext(1,1,t).decodeAudioData(e)}const loadCache$1={},loadBuffer=(e,t)=>{if(e=e.replace("#","%23"),!loadCache$1[e]){logger$1(`[wavetable] load table ${t}..`,"load-table",{url:e});const o=Date.now();loadCache$1[e]=fetch(e).then(u=>u.arrayBuffer()).then(async u=>{const f=Date.now()-o,p=humanFileSize(u.byteLength);return logger$1(`[wavetable] load table ${t}... done! loaded ${p} in ${f}ms`,"loaded-table",{url:e}),await decodeAtNativeRate(u)})}return loadCache$1[e]};function githubPath$1(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,u]=e.split("github:");return u=u.endsWith("/")?u.slice(0,-1):u,u.split("/").length===2&&(u+="/main"),`https://raw.githubusercontent.com/${u}/${t}`}const _processTables=(e,t,o,u={})=>(t=e._base||t,Object.entries(e).forEach(([f,p])=>{if(f==="_base")return!1;if(typeof p=="string"&&(p=[p]),typeof p!="object")throw new Error("wrong json format for "+f);let g=t;g.startsWith("github:")&&(g=githubPath$1(g,"")),p=p.map(M=>g+M).filter(M=>M.toLowerCase().endsWith(".wav")?!0:(logger$1(`[wavetable] skipping ${M} -- wavetables must be ".wav" format`),!1)),p.length&&registerWaveTable(f,p,{baseUrl:t,frameLen:o})}));function registerWaveTable(e,t,o){registerSound(e,(u,f,p,g)=>onTriggerSynth(u,f,p,t,g,o?.frameLen??2048),{type:"wavetable",tables:t,...o})}const tables=async(e,t,o,u={})=>{if(o!==void 0)return _processTables(o,e,t);e.startsWith("github:")&&(e=githubPath$1(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432");const f=getBaseURL(e);if(typeof fetch=="function"&&!(typeof fetch>"u"))return fetch(e).then(p=>p.json()).then(p=>_processTables(p,f,t,u)).catch(p=>{throw console.error(p),new Error(`error loading "${e}"`)})};async function onTriggerSynth(e,t,o,u,f,p){const{s:g,n:M=0,duration:F,clip:S}=t,k=getAudioContext(),[N,$,R,U]=getADSRValues([t.attack,t.decay,t.sustain,t.release]);let{warpmode:O}=t;typeof O=="string"&&(O=Warpmode[O.toUpperCase()]??Warpmode.NONE);const Z=getFrequencyFromValue(t),{url:K,label:ie}=getCommonSampleInfo(t,u),de=await getPayload(K,ie,p);let te=e+F;S!==void 0&&(te=Math.min(e+S*F,te));const re=te+U,ue=re+.01,ve=getWorklet(k,"wavetable-oscillator-processor",{begin:e,end:ue,frequency:Z,freqspread:t.detune,position:t.wt,warp:t.warp,warpMode:O,voices:Math.max(t.unison??1,1),panspread:t.spread,phaserand:t.wtphaserand??t.unison>1?1:0},{outputChannelCount:[2]});if(ve.port.postMessage({type:"table",payload:de}),k.currentTime>e){logger$1(`[wavetable] still loading sound "${g}:${M}"`,"highlight");return}const Ae=[t.wtattack,t.wtdecay,t.wtsustain,t.wtrelease],Fe=[t.warpattack,t.warpdecay,t.warpsustain,t.warprelease],we=ve.parameters,Ce=we.get("position"),be=we.get("warp");let le=t.wtrate;t.wtsync!=null&&(le=f*t.wtsync);const Ze=applyParameterModulators(k,Ce,e,re,{offset:t.wt,amount:t.wtenv,defaultAmount:.5,values:Ae,holdEnd:te,defaultValues:[0,.5,0,.1]},{frequency:le,depth:t.wtdepth,defaultDepth:.5,shape:t.wtshape,skew:t.wtskew,dcoffset:t.wtdc??0});let Je=t.warprate;t.warpsync!=null&&(Je=Je=f*t.warpsync);const Qe=applyParameterModulators(k,be,e,re,{offset:t.warp,amount:t.warpenv,defaultAmount:.5,values:Fe,holdEnd:te,defaultValues:[0,.5,0,.1]},{frequency:Je,depth:t.warpdepth,defaultDepth:.5,shape:t.warpshape,skew:t.warpskew,dcoffset:t.warpdc??0}),rt=getVibratoOscillator(ve.parameters.get("detune"),t,e),tt=applyFM(ve.parameters.get("frequency"),t,e),kt=k.createGain(),Lt=ve.connect(kt);getParamADSR(Lt.gain,N,$,R,U,0,.3,e,te,"linear"),getPitchEnvelope(ve.parameters.get("detune"),t,e,te);const Tt={node:Lt,source:ve},ke=webAudioTimeout(k,()=>{destroyAudioWorkletNode(ve),rt?.stop(),tt?.stop(),Lt.disconnect(),Ze?.disconnect(),Qe?.disconnect(),o()},e,ue);return Tt.stop=at=>{ke.stop(at)},Tt}let doughWorklet;function initDoughWorklet(){const e=getAudioContext();doughWorklet=getWorklet(e,"dough-processor",{},{outputChannelCount:[2]}),connectToDestination(doughWorklet)}const soundMap=new Map,loadedSounds=new Map;Pattern$1.prototype.supradough=function(){return this.onTrigger((e,t,o,u)=>{e.value._begin=u,e.value._duration=e.duration/o,!doughWorklet&&initDoughWorklet();const f=(e.value.bank?e.value.bank+"_":"")+e.value.s,p=e.value.n??0,g=`${f}:${p}`;if(soundMap.has(f)&&(e.value.s=g),soundMap.has(f)&&!loadedSounds.has(g)){const M=soundMap.get(f),F=M[p%M.length];console.log(`load ${g} from ${F}`);const S=fetchSample(F);loadedSounds.set(g,S),S.then(({channels:k,sampleRate:N})=>doughWorklet.port.postMessage({sample:g,channels:k,sampleRate:N}))}doughWorklet.port.postMessage({spawn:e.value})},1)};function githubPath(e,t=""){if(!e.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[o,u]=e.split("github:");return u=u.endsWith("/")?u.slice(0,-1):u,u.split("/").length===2&&(u+="/main"),`https://raw.githubusercontent.com/${u}/${t}`}async function fetchSampleMap(e){if(e.startsWith("github:")&&(e=githubPath(e,"strudel.json")),e.startsWith("local:")&&(e="http://localhost:5432"),e.startsWith("shabda:")){let[u,f]=e.split("shabda:");e=`https://shabda.ndre.gr/${f}.json?strudel=1`}if(e.startsWith("shabda/speech")){let[u,f]=e.split("shabda/speech");f=f.startsWith("/")?f.substring(1):f;let[p,g]=f.split(":"),M="f",F="en-GB";p&&([F,M]=p.split("/")),e=`https://shabda.ndre.gr/speech/${g}.json?gender=${M}&language=${F}&strudel=1'`}if(typeof fetch!="function")return;const t=e.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const o=await fetch(e).then(u=>u.json()).catch(u=>{throw console.error(u),new Error(`error loading "${e}"`)});return[o,o._base||t]}async function fetchSample(e){const t=await fetch(e).then(u=>u.arrayBuffer()).then(u=>getAudioContext().decodeAudioData(u));let o=[];for(let u=0;u<t.numberOfChannels;u++)o.push(t.getChannelData(u));return{channels:o,sampleRate:t.sampleRate}}async function doughsamples(e,t){if(typeof e=="string"){const[o,u]=await fetchSampleMap(e);return doughsamples(o,u)}Object.entries(e).map(async([o,u])=>{o!=="_base"&&(u=u.map(f=>t+f),soundMap.set(o,u))})}const _workletUrl="data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IGQ9dHlwZW9mIHNhbXBsZVJhdGU8InUiP3NhbXBsZVJhdGU6NDhlMyxBPU1hdGguUEkvZCxiPTEvZDtsZXQgRT1pPT5NYXRoLnBvdyhpLDIpO2NvbnN0IFY9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtmdW5jdGlvbiBjKGkpe3JldHVybiBFKGkpfWZ1bmN0aW9uIE8oaSxzLHQpe2NvbnN0IGU9TWF0aC5zaW4oKDEtdCkqLjUqTWF0aC5QSSksaD1NYXRoLnNpbih0Ki41Kk1hdGguUEkpO3JldHVybiBpKmUrcypofWNsYXNzIHZ7cGhhc2U9MDt1cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNpbih0aGlzLnBoYXNlKjIqTWF0aC5QSSk7cmV0dXJuIHRoaXMucGhhc2U9KHRoaXMucGhhc2Urcy9kKSUxLHR9fWNsYXNzIHh7cGhhc2U9MDt1cGRhdGUocyl7cmV0dXJuIHRoaXMucGhhc2UrPWIqcyx0aGlzLnBoYXNlJTEqMi0xfX1mdW5jdGlvbiB5KGkscyl7cmV0dXJuIGk8cz8oaS89cyxpK2ktaSppLTEpOmk+MS1zPyhpPShpLTEpL3MsaSppK2kraSsxKTowfWNsYXNzIFJ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy5waGFzZT1zLnBoYXNlPz8wfXVwZGF0ZShzKXtjb25zdCB0PXMvZDtsZXQgZT15KHRoaXMucGhhc2UsdCksaD0yKnRoaXMucGhhc2UtMS1lO3JldHVybiB0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2UtPTEpLGh9fWZ1bmN0aW9uIFQoaSxzLHQpe3JldHVybiBpPDI/MDooKGgsbyxuKT0+biooby1oKStoKSgtcyouNSxzKi41LHQvKGktMSkpfWZ1bmN0aW9uIHooaSxzKXtyZXR1cm4gaSpNYXRoLnBvdygyLHMvMTIpfWNsYXNzIEZ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy52b2ljZXM9cy52b2ljZXM/PzUsdGhpcy5mcmVxc3ByZWFkPXMuZnJlcXNwcmVhZD8/LjIsdGhpcy5wYW5zcHJlYWQ9cy5wYW5zcHJlYWQ/Py40LHRoaXMucGhhc2U9bmV3IEZsb2F0MzJBcnJheSh0aGlzLnZvaWNlcykubWFwKCgpPT5NYXRoLnJhbmRvbSgpKX11cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNxcnQoMS10aGlzLnBhbnNwcmVhZCksZT1NYXRoLnNxcnQodGhpcy5wYW5zcHJlYWQpO2xldCBoPTAsbz0wO2ZvcihsZXQgbj0wO248dGhpcy52b2ljZXM7bisrKXtjb25zdCBhPXoocyxUKHRoaXMudm9pY2VzLHRoaXMuZnJlcXNwcmVhZCxuKSkvZCxwPShuJjEpPT0xO2xldCB1PXQ7cCYmKHU9ZSk7bGV0IHE9eSh0aGlzLnBoYXNlW25dLGEpLEQ9Mip0aGlzLnBoYXNlW25dLTEtcTtoPWgrRCp1LG89bytEKnUsdGhpcy5waGFzZVtuXSs9YSx0aGlzLnBoYXNlW25dPjEmJih0aGlzLnBoYXNlW25dLT0xKX1yZXR1cm4gaCtvfX1jbGFzcyB3e3BoYXNlPTA7dXBkYXRlKHMpe3RoaXMucGhhc2UrPWIqcztsZXQgdD10aGlzLnBoYXNlJTE7cmV0dXJuKHQ8LjU/Mip0OjEtMioodC0uNSkpKjItMX19Y2xhc3MgZ3tzMD0wO3MxPTA7dXBkYXRlKHMsdCxlPTApe2U9TWF0aC5tYXgoZSwwKSx0PU1hdGgubWluKHQsMmU0KTtsZXQgaD0yKk1hdGguc2luKHQqQSk7aD1WKGgsMCwxLjE0KTtjb25zdCBuPTEtTWF0aC5wb3coLjUsKGUrLjEyNSkvLjEyNSkqaDtyZXR1cm4gdGhpcy5zMD1uKnRoaXMuczAtaCp0aGlzLnMxK2gqcyx0aGlzLnMxPW4qdGhpcy5zMStoKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgSXtjb25zdHJ1Y3RvcihzPTApe3RoaXMucGhhc2U9c31zYXcocyx0KXtsZXQgZT0odGhpcy5waGFzZStzKSUxLGg9eShlLHQpO3JldHVybiAyKmUtMS1ofXVwZGF0ZShzLHQ9LjUpe2NvbnN0IGU9cy9kO2xldCBoPXRoaXMuc2F3KDAsZSktdGhpcy5zYXcodCxlKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStlKSUxLGgrdCoyLTF9fWNsYXNzIEx7cGhhc2U9MDt1cGRhdGUocyx0PS41KXtyZXR1cm4gdGhpcy5waGFzZSs9YipzLHRoaXMucGhhc2UlMTx0PzE6LTF9fWNsYXNzIFN7dXBkYXRlPXM9Pk1hdGgucmFuZG9tKCk8cypiP01hdGgucmFuZG9tKCk6MH1jbGFzcyBOe3VwZGF0ZSgpe3JldHVybiBNYXRoLnJhbmRvbSgpKjItMX19Y2xhc3MgQntjb25zdHJ1Y3Rvcigpe3RoaXMub3V0PTB9dXBkYXRlKCl7bGV0IHM9TWF0aC5yYW5kb20oKSoyLTE7cmV0dXJuIHRoaXMub3V0PSh0aGlzLm91dCsuMDIqcykvMS4wMix0aGlzLm91dH19Y2xhc3MgR3tjb25zdHJ1Y3Rvcigpe3RoaXMuYjA9MCx0aGlzLmIxPTAsdGhpcy5iMj0wLHRoaXMuYjM9MCx0aGlzLmI0PTAsdGhpcy5iNT0wLHRoaXMuYjY9MH11cGRhdGUoKXtjb25zdCBzPU1hdGgucmFuZG9tKCkqMi0xO3RoaXMuYjA9Ljk5ODg2KnRoaXMuYjArcyouMDU1NTE3OSx0aGlzLmIxPS45OTMzMip0aGlzLmIxK3MqLjA3NTA3NTksdGhpcy5iMj0uOTY5KnRoaXMuYjIrcyouMTUzODUyLHRoaXMuYjM9Ljg2NjUqdGhpcy5iMytzKi4zMTA0ODU2LHRoaXMuYjQ9LjU1KnRoaXMuYjQrcyouNTMyOTUyMix0aGlzLmI1PS0uNzYxNip0aGlzLmI1LXMqLjAxNjg5ODtjb25zdCB0PXRoaXMuYjArdGhpcy5iMSt0aGlzLmIyK3RoaXMuYjMrdGhpcy5iNCt0aGlzLmI1K3RoaXMuYjYrcyouNTM2MjtyZXR1cm4gdGhpcy5iNj1zKi4xMTU5MjYsdCouMTF9fWNsYXNzIGp7cGhhc2U9MTt1cGRhdGUocyl7dGhpcy5waGFzZSs9YipzO2xldCB0PXRoaXMucGhhc2U+PTE/MTowO3JldHVybiB0aGlzLnBoYXNlPXRoaXMucGhhc2UlMSx0fX1mdW5jdGlvbiBNKGkscyx0LGU9MSl7aWYoaTw9MClyZXR1cm4gcztpZihpPj0xKXJldHVybiB0O2xldCBoO3JldHVybiBlPT09MD9oPWk6ZT4wP2g9TWF0aC5wb3coaSxlKTpoPTEtTWF0aC5wb3coMS1pLC1lKSxzKyh0LXMpKmh9Y2xhc3MgZntjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnN0YXRlPSJvZmYiLHRoaXMuc3RhcnRUaW1lPTAsdGhpcy5zdGFydFZhbD0wLHRoaXMuZGVjYXlDdXJ2ZT1zLmRlY2F5Q3VydmU/PzF9dXBkYXRlKHMsdCxlLGgsbyxuKXtzd2l0Y2godGhpcy5zdGF0ZSl7Y2FzZSJvZmYiOnJldHVybiB0PjAmJih0aGlzLnN0YXRlPSJhdHRhY2siLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD0wKSwwO2Nhc2UiYXR0YWNrIjp7bGV0IGw9cy10aGlzLnN0YXJ0VGltZTtyZXR1cm4gbD5lPyh0aGlzLnN0YXRlPSJkZWNheSIsdGhpcy5zdGFydFRpbWU9cywxKTpNKGwvZSx0aGlzLnN0YXJ0VmFsLDEsMSl9Y2FzZSJkZWNheSI6e2xldCBsPXMtdGhpcy5zdGFydFRpbWUsYT1NKGwvaCwxLG8sLXRoaXMuZGVjYXlDdXJ2ZSk7cmV0dXJuIHQ8PTA/KHRoaXMuc3RhdGU9InJlbGVhc2UiLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD1hLGEpOmw+aD8odGhpcy5zdGF0ZT0ic3VzdGFpbiIsdGhpcy5zdGFydFRpbWU9cyxvKTphfWNhc2Uic3VzdGFpbiI6cmV0dXJuIHQ8PTAmJih0aGlzLnN0YXRlPSJyZWxlYXNlIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9byksbztjYXNlInJlbGVhc2UiOntsZXQgbD1zLXRoaXMuc3RhcnRUaW1lO2lmKGw+bilyZXR1cm4gdGhpcy5zdGF0ZT0ib2ZmIiwwO2xldCBhPU0obC9uLHRoaXMuc3RhcnRWYWwsMCwtdGhpcy5kZWNheUN1cnZlKTtyZXR1cm4gdD4wJiYodGhpcy5zdGF0ZT0iYXR0YWNrIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9YSksYX19dGhyb3ciaW52YWxpZCBlbnZlbG9wZSBzdGF0ZSJ9fWNvbnN0ICQ9MTA7Y2xhc3Mga3t3cml0ZUlkeD0wO3JlYWRJZHg9MDtidWZmZXI9bmV3IEZsb2F0MzJBcnJheSgkKmQpO3dyaXRlKHMsdCl7dGhpcy53cml0ZUlkeD0odGhpcy53cml0ZUlkeCsxKSV0aGlzLmJ1ZmZlci5sZW5ndGgsdGhpcy5idWZmZXJbdGhpcy53cml0ZUlkeF09cztsZXQgZT1NYXRoLm1pbihNYXRoLmZsb29yKGQqdCksdGhpcy5idWZmZXIubGVuZ3RoLTEpO3RoaXMucmVhZElkeD10aGlzLndyaXRlSWR4LWUsdGhpcy5yZWFkSWR4PDAmJih0aGlzLnJlYWRJZHgrPXRoaXMuYnVmZmVyLmxlbmd0aCl9dXBkYXRlKHMsdCl7cmV0dXJuIHRoaXMud3JpdGUocyx0KSx0aGlzLmJ1ZmZlclt0aGlzLnJlYWRJZHhdfX1jbGFzcyBXe2RlbGF5PW5ldyBrO21vZHVsYXRvcj1uZXcgdzt1cGRhdGUocyx0LGUsaCxvKXtjb25zdCBuPXRoaXMubW9kdWxhdG9yLnVwZGF0ZShoKSpvLGw9dGhpcy5kZWxheS51cGRhdGUocyxlKigxK24pKTtyZXR1cm4gTyhzLGwsdCl9fWNsYXNzIFh7aG9sZD0wO3Q9MDt1cGRhdGUocyx0KXtyZXR1cm4gdGhpcy50KysldD09PTAmJih0aGlzLnQ9MCx0aGlzLmhvbGQ9cyksdGhpcy5ob2xkfX1jbGFzcyBVe3VwZGF0ZShzLHQpe3Q9TWF0aC5tYXgoMSx0KTtjb25zdCBlPU1hdGgucG93KDIsdC0xKTtyZXR1cm4gTWF0aC5yb3VuZChzKmUpL2V9fWNsYXNzIFl7dXBkYXRlKHMsdD0wLGU9MSl7ZT1NYXRoLm1heCguMDAxLE1hdGgubWluKDEsZSkpO2NvbnN0IGg9TWF0aC5leHBtMSh0KTtyZXR1cm4oMStoKSpzLygxK2gqTWF0aC5hYnMocykpKmV9fWNsYXNzIF97c3RhdGljIHNhbXBsZXM9bmV3IE1hcDtidWZmZXI7c2FtcGxlUmF0ZTtwb3M9MDtzYW1wbGVGcmVxPVAoKTtjb25zdHJ1Y3RvcihzLHQsZSl7dGhpcy5idWZmZXI9cyx0aGlzLnNhbXBsZVJhdGU9dCx0aGlzLmR1cmF0aW9uPXRoaXMuYnVmZmVyLmxlbmd0aC90aGlzLnNhbXBsZVJhdGUsdGhpcy5zcGVlZD1kL3RoaXMuc2FtcGxlUmF0ZSxlJiYodGhpcy5zcGVlZCo9dGhpcy5kdXJhdGlvbil9dXBkYXRlKHMpe2lmKHRoaXMucG9zPj10aGlzLmJ1ZmZlci5sZW5ndGgpcmV0dXJuIDA7Y29uc3QgdD1zL3RoaXMuc2FtcGxlRnJlcSp0aGlzLnNwZWVkO2xldCBlPXRoaXMuYnVmZmVyW01hdGguZmxvb3IodGhpcy5wb3MpXTtyZXR1cm4gdGhpcy5wb3M9dGhpcy5wb3MrdCxlfX1jb25zdCBtPShpLHM9ImxpbmVhciIsdCk9Pntjb25zdFtuLGwsYSxwXT1pO2lmKG49PW51bGwmJmw9PW51bGwmJmE9PW51bGwmJnA9PW51bGwpcmV0dXJuIHQ/P1suMDAxLC4wMDEsMSwuMDFdO2NvbnN0IHU9YT8/KG4hPW51bGwmJmw9PW51bGx8fG49PW51bGwmJmw9PW51bGw/MTouMDAxKTtyZXR1cm5bTWF0aC5tYXgobj8/MCwuMDAxKSxNYXRoLm1heChsPz8wLC4wMDEpLE1hdGgubWluKHUsMSksTWF0aC5tYXgocD8/MCwuMDEpXX07bGV0IEM9e3NpbmU6dixzYXc6Uix6YXc6eCxzYXd0b290aDpSLHphd3Rvb3RoOngsc3VwZXJzYXc6Rix0cmk6dyx0cmlhbmdsZTp3LHB1bHNlOkksc3F1YXJlOkkscHVsemU6TCxkdXN0OlMsY3JhY2tsZTpTLGltcHVsc2U6aix3aGl0ZTpOLGJyb3duOkIscGluazpHfTtjb25zdCBaPXtjaG9ydXM6MCxub3RlOjQ4LHM6InRyaWFuZ2xlIixiYW5rOiIiLGdhaW46MSxwb3N0Z2FpbjoxLHZlbG9jaXR5OjEsZGVuc2l0eToiLjAzIixmdHlwZToiMTJkYiIsZmFuY2hvcjowLHJlc29uYW5jZTowLGhyZXNvbmFuY2U6MCxiYW5kcTowLGNoYW5uZWxzOlsxLDJdLHBoYXNlcmRlcHRoOi43NSxzaGFwZXZvbDoxLGRpc3RvcnR2b2w6MSxkZWxheTowLGJ5dGVCZWF0RXhwcmVzc2lvbjoiMCIsZGVsYXlmZWVkYmFjazouNSxkZWxheXNwZWVkOjEsZGVsYXl0aW1lOi4yNSxvcmJpdDoxLGk6MSxmZnQ6OCx6OiJ0cmlhbmdsZSIscGFuOi41LGZtaDoxLGZtZW52OjAsc3BlZWQ6MSxwdzouNX07bGV0IHI9aT0+WltpXTtjb25zdCBIPXtjOjAsZDoyLGU6NCxmOjUsZzo3LGE6OSxiOjExfSxKPXsiIyI6MSxiOi0xLHM6MSxmOi0xfSxLPShpLHM9Myk9PntsZXRbdCxlPSIiLGg9IiJdPVN0cmluZyhpKS5tYXRjaCgvXihbYS1nQS1HXSkoWyNic2ZdKikoWzAtOV0qKSQvKT8uc2xpY2UoMSl8fFtdO2lmKCF0KXRocm93IG5ldyBFcnJvcignbm90IGEgbm90ZTogIicraSsnIicpO2NvbnN0IG89SFt0LnRvTG93ZXJDYXNlKCldLG49ZT8uc3BsaXQoIiIpLnJlZHVjZSgoYSxwKT0+YStKW3BdLDApfHwwO3JldHVybihOdW1iZXIoaHx8cykrMSkqMTIrbytufSxRPWk9Pk1hdGgucG93KDIsKGktNjkpLzEyKSo0NDAsUD1pPT4oaT1pfHxyKCJub3RlIiksdHlwZW9mIGk9PSJzdHJpbmciJiYoaT1LKGksMykpLFEoaSkpO2NsYXNzIHR0e2lkPTA7b3V0PVswLDBdO2F0dGFjaztkZWNheTtzdXN0YWluO3JlbGVhc2U7X2JlZ2luO19kdXJhdGlvbjtfc291bmQ7X2NoYW5uZWxzPTE7X2J1ZmZlcnM7dW5pdDtfcGVudjtwZW52O3BhdHRhY2s7cGRlY2F5O3BzdXN0YWluO3ByZWxlYXNlO3ZpYjtfdmliO3ZpYm1vZDtfZm07Zm1oO2ZtaTtfZm1lbnY7Zm1hdHRhY2s7Zm1kZWNheTtmbXN1c3RhaW47Zm1yZWxlYXNlO19scGVudjtscGVudjtscGF0dGFjaztscGRlY2F5O2xwc3VzdGFpbjtscHJlbGVhc2U7X2hwZW52O2hwZW52O2hwYXR0YWNrO2hwZGVjYXk7aHBzdXN0YWluO2hwcmVsZWFzZTtfYnBlbnY7YnBlbnY7YnBhdHRhY2s7YnBkZWNheTticHN1c3RhaW47YnByZWxlYXNlO2N1dG9mZjtoY3V0b2ZmO2JhbmRmO2NvYXJzZTtjcnVzaDtkaXN0b3J0O2ZyZXE7bm90ZTtfbHBmO19ocGY7X2JwZjtfY2hvcnVzO19jb2Fyc2U7X2NydXNoO19kaXN0b3J0O2NvbnN0cnVjdG9yKHMpe3RoaXMuZnJlcT8/PVAocy5ub3RlKSx0aGlzLl9iZWdpbj1zLl9iZWdpbix0aGlzLl9kdXJhdGlvbj1zLl9kdXJhdGlvbix0aGlzLnJlbGVhc2U9cy5yZWxlYXNlPz8wO2xldCB0PXRoaXM7aWYoT2JqZWN0LmFzc2lnbih0LHMpLHQucz10LnM/P3IoInMiKSx0LmdhaW49Yyh0LmdhaW4/P3IoImdhaW4iKSksdC52ZWxvY2l0eT1jKHQudmVsb2NpdHk/P3IoInZlbG9jaXR5IikpLHQucG9zdGdhaW49Yyh0LnBvc3RnYWluPz9yKCJwb3N0Z2FpbiIpKSx0LmRlbnNpdHk9dC5kZW5zaXR5Pz9yKCJkZW5zaXR5IiksdC5mYW5jaG9yPXQuZmFuY2hvcj8/cigiZmFuY2hvciIpLHQuZHJpdmU9dC5kcml2ZT8/LjY5LHQucGhhc2VyZGVwdGg9dC5waGFzZXJkZXB0aD8/cigicGhhc2VyZGVwdGgiKSx0LnNoYXBldm9sPWModC5zaGFwZXZvbD8/cigic2hhcGV2b2wiKSksdC5kaXN0b3J0dm9sPWModC5kaXN0b3J0dm9sPz9yKCJkaXN0b3J0dm9sIikpLHQuaT10Lmk/P3IoImkiKSx0LmNob3J1cz10LmNob3J1cz8/cigiY2hvcnVzIiksdC5mZnQ9dC5mZnQ/P3IoImZmdCIpLHQucGFuPXQucGFuPz9yKCJwYW4iKSx0Lm9yYml0PXQub3JiaXQ/P3IoIm9yYml0IiksdC5mbWVudj10LmZtZW52Pz9yKCJmbWVudiIpLHQucmVzb25hbmNlPXQucmVzb25hbmNlPz9yKCJyZXNvbmFuY2UiKSx0LmhyZXNvbmFuY2U9dC5ocmVzb25hbmNlPz9yKCJocmVzb25hbmNlIiksdC5iYW5kcT10LmJhbmRxPz9yKCJiYW5kcSIpLHQuc3BlZWQ9dC5zcGVlZD8/cigic3BlZWQiKSx0LnB3PXQucHc/P3IoInB3IiksW3QuYXR0YWNrLHQuZGVjYXksdC5zdXN0YWluLHQucmVsZWFzZV09bShbdC5hdHRhY2ssdC5kZWNheSx0LnN1c3RhaW4sdC5yZWxlYXNlXSksdC5faG9sZEVuZD10Ll9iZWdpbit0Ll9kdXJhdGlvbix0Ll9lbmQ9dC5faG9sZEVuZCt0LnJlbGVhc2UrLjAxLHQuZm1pJiYodC5zPT09InNhdyJ8fHQucz09PSJzYXd0b290aCIpJiYodC5zPSJ6YXciKSxDW3Quc10pe2NvbnN0IGU9Q1t0LnNdO3QuX3NvdW5kPW5ldyBlLHQuX2NoYW5uZWxzPTF9ZWxzZSBpZihfLnNhbXBsZXMuaGFzKHQucykpe2NvbnN0IGU9Xy5zYW1wbGVzLmdldCh0LnMpO3QuX2J1ZmZlcnM9W10sdC5fY2hhbm5lbHM9ZS5jaGFubmVscy5sZW5ndGg7Zm9yKGxldCBoPTA7aDx0Ll9jaGFubmVscztoKyspdC5fYnVmZmVycy5wdXNoKG5ldyBfKGUuY2hhbm5lbHNbaF0sZS5zYW1wbGVSYXRlLHQudW5pdD09PSJjIikpfWVsc2UgY29uc29sZS53YXJuKCJzb3VuZCBub3QgbG9hZGVkIix0LnMpO3QucGVudiYmKHQuX3BlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXT1tKFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXSkpLHQudmliJiYodC5fdmliPW5ldyB2LHQudmlibW9kPXQudmlibW9kPz9yKCJ2aWJtb2QiKSksdC5mbWkmJih0Ll9mbT1uZXcgdix0LmZtaD10LmZtaD8/cigiZm1oIiksdC5mbWVudiYmKHQuX2ZtZW52PW5ldyBmKHtkZWNheUN1cnZlOjJ9KSxbdC5mbWF0dGFjayx0LmZtZGVjYXksdC5mbXN1c3RhaW4sdC5mbXJlbGVhc2VdPW0oW3QuZm1hdHRhY2ssdC5mbWRlY2F5LHQuZm1zdXN0YWluLHQuZm1yZWxlYXNlXSkpKSx0Ll9hZHNyPW5ldyBmKHtkZWNheUN1cnZlOjJ9KSx0LmRlbGF5PWModC5kZWxheT8/cigiZGVsYXkiKSksdC5kZWxheWZlZWRiYWNrPXQuZGVsYXlmZWVkYmFjaz8/cigiZGVsYXlmZWVkYmFjayIpLHQuZGVsYXlzcGVlZD10LmRlbGF5c3BlZWQ/P3IoImRlbGF5c3BlZWQiKSx0LmRlbGF5dGltZT10LmRlbGF5dGltZT8/cigiZGVsYXl0aW1lIiksdC5scGVudiYmKHQuX2xwZW52PW5ldyBmKHtkZWNheUN1cnZlOjR9KSxbdC5scGF0dGFjayx0LmxwZGVjYXksdC5scHN1c3RhaW4sdC5scHJlbGVhc2VdPW0oW3QubHBhdHRhY2ssdC5scGRlY2F5LHQubHBzdXN0YWluLHQubHByZWxlYXNlXSkpLHQuaHBlbnYmJih0Ll9ocGVudj1uZXcgZih7ZGVjYXlDdXJ2ZTo0fSksW3QuaHBhdHRhY2ssdC5ocGRlY2F5LHQuaHBzdXN0YWluLHQuaHByZWxlYXNlXT1tKFt0LmhwYXR0YWNrLHQuaHBkZWNheSx0Lmhwc3VzdGFpbix0LmhwcmVsZWFzZV0pKSx0LmJwZW52JiYodC5fYnBlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LmJwYXR0YWNrLHQuYnBkZWNheSx0LmJwc3VzdGFpbix0LmJwcmVsZWFzZV09bShbdC5icGF0dGFjayx0LmJwZGVjYXksdC5icHN1c3RhaW4sdC5icHJlbGVhc2VdKSksdC5fY2hvcnVzPXQuY2hvcnVzP1tdOm51bGwsdC5fbHBmPXQuY3V0b2ZmP1tdOm51bGwsdC5faHBmPXQuaGN1dG9mZj9bXTpudWxsLHQuX2JwZj10LmJhbmRmP1tdOm51bGwsdC5fY29hcnNlPXQuY29hcnNlP1tdOm51bGwsdC5fY3J1c2g9dC5jcnVzaD9bXTpudWxsLHQuX2Rpc3RvcnQ9dC5kaXN0b3J0P1tdOm51bGw7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jaGFubmVscztlKyspdC5fbHBmPy5wdXNoKG5ldyBnKSx0Ll9ocGY/LnB1c2gobmV3IGcpLHQuX2JwZj8ucHVzaChuZXcgZyksdC5fY2hvcnVzPy5wdXNoKG5ldyBXKSx0Ll9jb2Fyc2U/LnB1c2gobmV3IFgpLHQuX2NydXNoPy5wdXNoKG5ldyBVKSx0Ll9kaXN0b3J0Py5wdXNoKG5ldyBZKX11cGRhdGUocyl7aWYoIXRoaXMuX3NvdW5kJiYhdGhpcy5fYnVmZmVycylyZXR1cm4gMDtsZXQgdD0rKHM+PXRoaXMuX2JlZ2luJiZzPD10aGlzLl9ob2xkRW5kKSxlPXRoaXMuZnJlcSp0aGlzLnNwZWVkO2lmKHRoaXMuX2ZtJiZ0aGlzLmZtaCE9PXZvaWQgMCYmdGhpcy5mbWkhPT12b2lkIDApe2xldCBhPXRoaXMuZm1pO2lmKHRoaXMuX2ZtZW52KXtjb25zdCBxPXRoaXMuX2ZtZW52LnVwZGF0ZShzLHQsdGhpcy5mbWF0dGFjayx0aGlzLmZtZGVjYXksdGhpcy5mbXN1c3RhaW4sdGhpcy5mbXJlbGVhc2UpO2E9dGhpcy5mbWVudipxKmF9Y29uc3QgcD1lKnRoaXMuZm1oLHU9cCphO2U9ZSt0aGlzLl9mbS51cGRhdGUocCkqdX1pZih0aGlzLl92aWImJnRoaXMudmlibW9kIT09dm9pZCAwJiYoZT1lKjIqKih0aGlzLl92aWIudXBkYXRlKHRoaXMudmliKSp0aGlzLnZpYm1vZC8xMikpLHRoaXMuX3BlbnYmJnRoaXMucGVudiE9PXZvaWQgMCl7Y29uc3QgYT10aGlzLl9wZW52LnVwZGF0ZShzLHQsdGhpcy5wYXR0YWNrLHRoaXMucGRlY2F5LHRoaXMucHN1c3RhaW4sdGhpcy5wcmVsZWFzZSk7ZT1lK2EqdGhpcy5wZW52fWxldCBoPXRoaXMuY3V0b2ZmO2lmKGghPT12b2lkIDAmJnRoaXMuX2xwZW52KXtjb25zdCBhPXRoaXMuX2xwZW52LnVwZGF0ZShzLHQsdGhpcy5scGF0dGFjayx0aGlzLmxwZGVjYXksdGhpcy5scHN1c3RhaW4sdGhpcy5scHJlbGVhc2UpO2g9dGhpcy5scGVudiphKmgraH1sZXQgbz10aGlzLmhjdXRvZmY7aWYobyE9PXZvaWQgMCYmdGhpcy5faHBlbnYmJnRoaXMuaHBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5faHBlbnYudXBkYXRlKHMsdCx0aGlzLmhwYXR0YWNrLHRoaXMuaHBkZWNheSx0aGlzLmhwc3VzdGFpbix0aGlzLmhwcmVsZWFzZSk7bz0yKip0aGlzLmhwZW52KmEqbytvfWxldCBuPXRoaXMuYmFuZGY7aWYobiE9PXZvaWQgMCYmdGhpcy5fYnBlbnYmJnRoaXMuYnBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5fYnBlbnYudXBkYXRlKHMsdCx0aGlzLmJwYXR0YWNrLHRoaXMuYnBkZWNheSx0aGlzLmJwc3VzdGFpbix0aGlzLmJwcmVsZWFzZSk7bj0yKip0aGlzLmJwZW52KmEqbitufWNvbnN0IGw9dGhpcy5fYWRzci51cGRhdGUocyx0LHRoaXMuYXR0YWNrLHRoaXMuZGVjYXksdGhpcy5zdXN0YWluLHRoaXMucmVsZWFzZSk7Zm9yKGxldCBhPTA7YTx0aGlzLl9jaGFubmVsczthKyspe2lmKHRoaXMuX3NvdW5kJiZ0aGlzLnM9PT0icHVsc2UiP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlLHRoaXMucHcpOnRoaXMuX3NvdW5kP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlKTp0aGlzLl9idWZmZXJzJiYodGhpcy5vdXRbYV09dGhpcy5fYnVmZmVyc1thXS51cGRhdGUoZSkpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdKnRoaXMuZ2Fpbip0aGlzLnZlbG9jaXR5LHRoaXMuX2Nob3J1cyl7Y29uc3QgcD10aGlzLl9jaG9ydXNbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY2hvcnVzLC4wMysuMDUqYSwxLC4xMSk7dGhpcy5vdXRbYV09cCt0aGlzLm91dFthXX10aGlzLl9scGYmJih0aGlzLl9scGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLGgsdGhpcy5yZXNvbmFuY2UpLHRoaXMub3V0W2FdPXRoaXMuX2xwZlthXS5zMSksdGhpcy5faHBmJiYodGhpcy5faHBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxvLHRoaXMuaHJlc29uYW5jZSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0tdGhpcy5faHBmW2FdLnMxKSx0aGlzLl9icGYmJih0aGlzLl9icGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLG4sdGhpcy5iYW5kcSksdGhpcy5vdXRbYV09dGhpcy5fYnBmW2FdLnMwKSx0aGlzLl9jb2Fyc2UmJih0aGlzLm91dFthXT10aGlzLl9jb2Fyc2VbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY29hcnNlKSksdGhpcy5fY3J1c2gmJih0aGlzLm91dFthXT10aGlzLl9jcnVzaFthXS51cGRhdGUodGhpcy5vdXRbYV0sdGhpcy5jcnVzaCkpLHRoaXMuX2Rpc3RvcnQmJih0aGlzLm91dFthXT10aGlzLl9kaXN0b3J0W2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmRpc3RvcnQsdGhpcy5kaXN0b3J0dm9sKSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qbCx0aGlzLm91dFthXT10aGlzLm91dFthXSp0aGlzLnBvc3RnYWluLHRoaXMuX2J1ZmZlcnN8fCh0aGlzLm91dFthXT10aGlzLm91dFthXSouMil9aWYodGhpcy5fY2hhbm5lbHM9PT0xJiYodGhpcy5vdXRbMV09dGhpcy5vdXRbMF0pLHRoaXMucGFuIT09LjUpe2NvbnN0IGE9dGhpcy5wYW4qTWF0aC5QSS8yO3RoaXMub3V0WzBdPXRoaXMub3V0WzBdKk1hdGguY29zKGEpLHRoaXMub3V0WzFdPXRoaXMub3V0WzFdKk1hdGguc2luKGEpfX19Y2xhc3Mgc3R7dm9pY2VzPVtdO3ZpZD0wO3E9W107b3V0PVswLDBdO2RlbGF5c2VuZD1bMCwwXTtkZWxheXRpbWU9cigiZGVsYXl0aW1lIik7ZGVsYXlmZWVkYmFjaz1yKCJkZWxheWZlZWRiYWNrIik7ZGVsYXlzcGVlZD1yKCJkZWxheXNwZWVkIik7dD0wO2NvbnN0cnVjdG9yKHM9NDhlMyx0PTApe3RoaXMuc2FtcGxlUmF0ZT1zLHRoaXMudD1NYXRoLmZsb29yKHQqcyksdGhpcy5fZGVsYXlMPW5ldyBrLHRoaXMuX2RlbGF5Uj1uZXcga31sb2FkU2FtcGxlKHMsdCxlKXtfLnNhbXBsZXMuc2V0KHMse2NoYW5uZWxzOnQsc2FtcGxlUmF0ZTplfSl9c2NoZWR1bGVTcGF3bihzKXtpZihzLl9iZWdpbj09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoIltkb3VnaF06IHNjaGVkdWxlU3Bhd24gZXhwZWN0ZWQgX2JlZ2luIHRvIGJlIHNldCIpO2lmKHMuX2R1cmF0aW9uPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcigiW2RvdWdoXTogc2NoZWR1bGVTcGF3biBleHBlY3RlZCBfZHVyYXRpb24gdG8gYmUgc2V0Iik7cy5zYW1wbGVSYXRlPXRoaXMuc2FtcGxlUmF0ZTtjb25zdCB0PU1hdGguZmxvb3Iocy5fYmVnaW4qdGhpcy5zYW1wbGVSYXRlKTt0aGlzLnNjaGVkdWxlKHt0aW1lOnQsdHlwZToic3Bhd24iLGFyZzpzfSl9c3Bhd24ocyl7cy5pZD10aGlzLnZpZCsrO2NvbnN0IHQ9bmV3IHR0KHMpO3RoaXMudm9pY2VzLnB1c2godCk7Y29uc3QgZT1NYXRoLmNlaWwodC5fZW5kKnRoaXMuc2FtcGxlUmF0ZSk7dGhpcy5zY2hlZHVsZSh7dGltZTplLHR5cGU6ImRlc3Bhd24iLGFyZzp0LmlkfSl9ZGVzcGF3bihzKXt0aGlzLnZvaWNlcz10aGlzLnZvaWNlcy5maWx0ZXIodD0+dC5pZCE9PXMpfXNjaGVkdWxlKHMpe2lmKCF0aGlzLnEubGVuZ3RoKXt0aGlzLnEucHVzaChzKTtyZXR1cm59bGV0IHQ9MDtmb3IoO3Q8dGhpcy5xLmxlbmd0aCYmdGhpcy5xW3RdLnRpbWU8cy50aW1lOyl0Kys7dGhpcy5xLnNwbGljZSh0LDAscyl9dXBkYXRlKCl7Zm9yKDt0aGlzLnEubGVuZ3RoPjAmJnRoaXMucVswXS50aW1lPD10aGlzLnQ7KXRoaXNbdGhpcy5xWzBdLnR5cGVdKHRoaXMucVswXS5hcmcpLHRoaXMucS5zaGlmdCgpO3RoaXMub3V0WzBdPTAsdGhpcy5vdXRbMV09MDtmb3IobGV0IGU9MDtlPHRoaXMudm9pY2VzLmxlbmd0aDtlKyspdGhpcy52b2ljZXNbZV0udXBkYXRlKHRoaXMudC90aGlzLnNhbXBsZVJhdGUpLHRoaXMub3V0WzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0sdGhpcy5vdXRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSx0aGlzLnZvaWNlc1tlXS5kZWxheSYmKHRoaXMuZGVsYXlzZW5kWzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0qdGhpcy52b2ljZXNbZV0uZGVsYXksdGhpcy5kZWxheXNlbmRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSp0aGlzLnZvaWNlc1tlXS5kZWxheSx0aGlzLmRlbGF5dGltZT10aGlzLnZvaWNlc1tlXS5kZWxheXRpbWUsdGhpcy5kZWxheXNwZWVkPXRoaXMudm9pY2VzW2VdLmRlbGF5c3BlZWQsdGhpcy5kZWxheWZlZWRiYWNrPXRoaXMudm9pY2VzW2VdLmRlbGF5ZmVlZGJhY2spO2NvbnN0IHM9dGhpcy5fZGVsYXlMLnVwZGF0ZSh0aGlzLmRlbGF5c2VuZFswXSx0aGlzLmRlbGF5dGltZSksdD10aGlzLl9kZWxheVIudXBkYXRlKHRoaXMuZGVsYXlzZW5kWzFdLHRoaXMuZGVsYXl0aW1lKTt0aGlzLmRlbGF5c2VuZFswXT1zKnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLmRlbGF5c2VuZFsxXT10KnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLm91dFswXSs9cyx0aGlzLm91dFsxXSs9dCx0aGlzLnQrK319Y29uc3QgZXQ9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtjbGFzcyBpdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5kb3VnaD1uZXcgc3Qoc2FtcGxlUmF0ZSxjdXJyZW50VGltZSksdGhpcy5wb3J0Lm9ubWVzc2FnZT1zPT57cy5kYXRhLnNwYXduP3RoaXMuZG91Z2guc2NoZWR1bGVTcGF3bihzLmRhdGEuc3Bhd24pOnMuZGF0YS5zYW1wbGU/dGhpcy5kb3VnaC5sb2FkU2FtcGxlKHMuZGF0YS5zYW1wbGUscy5kYXRhLmNoYW5uZWxzLHMuZGF0YS5zYW1wbGVSYXRlKTpzLmRhdGEuc2FtcGxlcz9zLmRhdGEuc2FtcGxlcy5mb3JFYWNoKChbdCxlLGhdKT0+e3RoaXMuZG91Z2gubG9hZFNhbXBsZSh0LGUsaCl9KTpjb25zb2xlLmxvZygidW5yZWNvZ25pemVkIGV2ZW50IHR5cGUiLHMuZGF0YSl9fXByb2Nlc3Mocyx0LGUpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2NvbnN0IGg9dFswXTtmb3IobGV0IG89MDtvPGhbMF0ubGVuZ3RoO28rKyl7dGhpcy5kb3VnaC51cGRhdGUoKTtmb3IobGV0IG49MDtuPGgubGVuZ3RoO24rKyloW25dW29dPWV0KHRoaXMuZG91Z2gub3V0W25dLC0xLDEpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZG91Z2gtcHJvY2Vzc29yIixpdCl9KSgpOwo=";typeof sampleRate<"u"&&sampleRate;const workletUrl=_workletUrl;registerWorklet(workletUrl);const{Pattern,logger,repl}=strudelCore;setLogger(logger);const hap2value=e=>(e.ensureObjectValue(),e.value),webaudioOutput=(e,t,o,u,f)=>superdough(hap2value(e),f,o,u,e.whole?.begin.valueOf());function webaudioRepl(e={}){return e={getTime:()=>getAudioContext().currentTime,defaultOutput:webaudioOutput,...e},repl(e)}Pattern.prototype.dough=function(){return this.onTrigger(doughTrigger,1)};const getDrawContext=(e="test-canvas",t)=>{let{contextType:o="2d",pixelated:u=!1,pixelRatio:f=window.devicePixelRatio}=t||{},p=document.querySelector("#"+e);if(!p){p=document.createElement("canvas"),p.id=e,p.width=window.innerWidth*f,p.height=window.innerHeight*f,p.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",u&&(p.style.imageRendering="pixelated"),document.body.prepend(p);let g;window.addEventListener("resize",()=>{g&&clearTimeout(g),g=setTimeout(()=>{p.width=window.innerWidth*f,p.height=window.innerHeight*f},200)})}return p.getContext(o,{willReadFrequently:!0})};let animationFrames={};function stopAnimationFrame(e){animationFrames[e]!==void 0&&(cancelAnimationFrame(animationFrames[e]),delete animationFrames[e])}function stopAllAnimations(e){Object.keys(animationFrames).forEach(t=>stopAnimationFrame(t))}let memory={};Pattern$1.prototype.draw=function(e,t){if(typeof window>"u")return this;let{id:o=1,lookbehind:u=0,lookahead:f=0}=t,p=Math.max(getTime(),0);stopAnimationFrame(o),u=Math.abs(u),memory[o]=(memory[o]||[]).filter(S=>!S.isInFuture(p));let g=this.queryArc(p,p+f).filter(S=>S.hasOnset());memory[o]=memory[o].concat(g);let M;const F=()=>{const S=getTime(),k=S+f;memory[o]=memory[o].filter(R=>R.isInNearPast(u,S));let N=Math.max(M||k,k-1/10);const $=this.queryArc(N,k).filter(R=>R.hasOnset());memory[o]=memory[o].concat($),M=k,e(memory[o],S,k,this),animationFrames[o]=requestAnimationFrame(F)};return animationFrames[o]=requestAnimationFrame(F),this};const cleanupDraw=(e=!0,t)=>{const o=getDrawContext();e&&o.clearRect(0,0,o.canvas.width,o.canvas.height),stopAllAnimations()};Pattern$1.prototype.onPaint=function(e){return this.withState(t=>(t.controls.painters||(t.controls.painters=[]),t.controls.painters.push(e),t))},Pattern$1.prototype.getPainters=function(){let e=[];return this.queryArc(0,0,{painters:e}),e};let theme={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function getTheme(){return theme}let clearColor="#22222210";Pattern$1.prototype.animate=function({callback:e,sync:t=!1,smear:o=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const u=getDrawContext();let{clientWidth:f,clientHeight:p}=u.canvas;f*=window.devicePixelRatio,p*=window.devicePixelRatio;let g=o===0?"99":Number((1-o)*100).toFixed(0);g=g.length===1?`0${g}`:g,clearColor=`#200010${g}`;const M=F=>{let S;F=Math.round(F),S=this.slow(1e3).queryArc(F,F),u.fillStyle=clearColor,u.fillRect(0,0,f,p),S.forEach(k=>{let{x:N,y:$,w:R,h:U,s:O,r:Z,angle:K=0,fill:ie="darkseagreen"}=k.value;if(R*=f,U*=p,Z!==void 0&&K!==void 0){const te=K*2*Math.PI,[re,ue]=[(f-R)/2,(p-U)/2];N=re+Math.cos(te)*Z*re,$=ue+Math.sin(te)*Z*ue}else N*=f-R,$*=p-U;const de={...k.value,x:N,y:$,w:R,h:U};u.fillStyle=ie,O==="rect"?u.fillRect(N,$,R,U):O==="ellipse"&&(u.beginPath(),u.ellipse(N+R/2,$+U/2,R/2,U/2,0,0,2*Math.PI),u.fill()),e&&e(u,de,k)}),window.frame=requestAnimationFrame(M)};return window.frame=requestAnimationFrame(M),silence};const{x:x$1,y,w,h,angle,r,fill,smear}=createParams("x","y","w","h","angle","r","fill","smear");register("rescale",function(e,t){return t.mul(x$1(e).w(e).y(e).h(e))}),register("moveXY",function(e,t,o){return o.add(x$1(e).y(t))}),register("zoomIn",function(e,t){const o=pure(1).sub(e).div(2);return t.rescale(e).move(o,o)});const scale$2=(e,t,o)=>e*(o-t)+t,getValue=e=>{let{value:t}=e;typeof e.value!="object"&&(t={value:t});let{note:o,n:u,freq:f,s:p}=t;if(f)return freqToMidi$2(f);if(o=o??u,typeof o=="string")try{return noteToMidi$1(o)}catch{return 0}return typeof o=="number"?o:p?"_"+p:t};Pattern$1.prototype.pianoroll=function(e={}){let{cycles:t=4,playhead:o=.5,overscan:u=0,hideNegative:f=!1,ctx:p=getDrawContext(),id:g=1}=e,M=-t*o,F=t*(1-o);const S=(k,N)=>(!f||k.whole.begin>=0)&&k.isWithinTime(N+M,N+F);return this.draw((k,N)=>{__pianoroll({...e,time:N,ctx:p,haps:k.filter($=>S($,N))})},{lookbehind:M-u,lookahead:F+u,id:g}),this};function __pianoroll({time:e,haps:t,cycles:o=4,playhead:u=.5,flipTime:f=0,flipValues:p=0,hideNegative:g=!1,inactive:M=getTheme().foreground,active:F=getTheme().foreground,background:S="transparent",smear:k=0,playheadColor:N=getTheme().foreground,minMidi:$=10,maxMidi:R=90,autorange:U=0,timeframe:O,fold:Z=1,vertical:K=0,labels:ie=!1,fill:de=1,fillActive:te=!1,strokeActive:re=!0,stroke:ue,hideInactive:ve=0,colorizeInactive:Ae=1,fontFamily:Fe,ctx:we,id:Ce}={}){const be=we.canvas.width,le=we.canvas.height;let Ze=-o*u,Je=o*(1-u);Ce&&(t=t.filter(Ft=>Ft.hasTag(Ce))),O&&(console.warn("timeframe is deprecated! use from/to instead"),Ze=0,Je=O);const Qe=K?le:be,rt=K?be:le;let tt=K?[Qe,0]:[0,Qe];const kt=Je-Ze,Lt=K?[0,rt]:[rt,0];let Tt=R-$+1,ke=rt/Tt,at=[];f&&tt.reverse(),p&&Lt.reverse();const{min:je,max:Ie,values:nt}=t.reduce(({min:Ft,max:ht,values:Zt},Qt)=>{const Bt=getValue(Qt);return{min:Bt<Ft?Bt:Ft,max:Bt>ht?Bt:ht,values:Zt.includes(Bt)?Zt:[...Zt,Bt]}},{min:1/0,max:-1/0,values:[]});U&&($=je,R=Ie,Tt=R-$+1),at=nt.sort((Ft,ht)=>typeof Ft=="number"&&typeof ht=="number"?Ft-ht:typeof Ft=="number"?1:String(Ft).localeCompare(String(ht))),ke=Z?rt/at.length:rt/Tt,we.fillStyle=S,we.globalAlpha=1,k||(we.clearRect(0,0,be,le),we.fillRect(0,0,be,le)),t.forEach(Ft=>{const ht=Ft.whole.begin<=e&&Ft.endClipped>e;let Zt=ue??(re&&ht),Qt=!ht&&de||ht&&te;if(ve&&!ht)return;let Bt=Ft.value?.color;F=Bt||F,M=Ae&&Bt||M,Bt=ht?F:M,we.fillStyle=Qt?Bt:"transparent",we.strokeStyle=Bt;const{velocity:_t=1,gain:$t=1}=Ft.value||{};we.globalAlpha=_t*$t;const rn=(Ft.whole.begin-(f?Je:Ze))/kt,Gt=scale$2(rn,...tt);let Yt=scale$2(Ft.duration/kt,0,Qe);const yn=getValue(Ft),xe=Z?at.indexOf(yn)/at.length:(Number(yn)-$)/Tt,Pe=scale$2(xe,...Lt);let ye=0;const Te=scale$2(e/kt,...tt);let He;if(K?He=[Pe+1-(p?ke:0),Qe-Te+Gt+ye+1-(f?0:Yt),ke-2,Yt-2]:He=[Gt-Te+ye+1-(f?Yt:0),Pe+1-(p?0:ke),Yt-2,ke-2],Zt&&we.strokeRect(...He),Qt&&we.fillRect(...He),ie){const et=Ft.value.note??Ft.value.s+(Ft.value.n?`:${Ft.value.n}`:""),{label:We,activeLabel:yt}=Ft.value,Ye=(ht&&yt||We)??et;let mt=K?Yt:ke*.75;we.font=`${mt}px ${Fe||"monospace"}`,we.fillStyle=Qt?"black":Bt,we.textBaseline="top",we.fillText(Ye,...He)}}),we.globalAlpha=1;const pt=scale$2(-Ze/kt,...tt);return we.strokeStyle=N,we.beginPath(),K?(we.moveTo(0,pt),we.lineTo(rt,pt)):(we.moveTo(pt,0),we.lineTo(pt,rt)),we.stroke(),this}function getDrawOptions(e,t={}){let[o,u]=e;o=Math.abs(o);const f=u+o,p=f!==0?o/f:0;return{fold:1,...t,cycles:f,playhead:p}}const getPunchcardPainter=(e={})=>(t,o,u,f)=>__pianoroll({ctx:t,time:o,haps:u,...getDrawOptions(f,e)});Pattern$1.prototype.punchcard=function(e){return this.onPaint(getPunchcardPainter(e))},Pattern$1.prototype.wordfall=function(e){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...e})};function fromPolar(e,t,o,u){const f=(e-90)*Math.PI/180;return[o+Math.cos(f)*t,u+Math.sin(f)*t]}const xyOnSpiral=(e,t,o,u,f=0)=>fromPolar((e+f)*360,t*e,o,u);function spiralSegment(e){let{ctx:t,from:o=0,to:u=3,margin:f=50,cx:p=100,cy:g=100,rotate:M=0,thickness:F=f/2,color:S=getTheme().foreground,cap:k="round",stretch:N=1,fromOpacity:$=1,toOpacity:R=1}=e;o*=N,u*=N,M*=N,t.lineWidth=F,t.lineCap=k,t.strokeStyle=S,t.globalAlpha=$,t.beginPath();let[U,O]=xyOnSpiral(o,f,p,g,M);t.moveTo(U,O);const Z=1/60;let K=o;for(;K<=u;){const[ie,de]=xyOnSpiral(K,f,p,g,M);t.globalAlpha=(K-o)/(u-o)*R,t.lineTo(ie,de),K+=Z}t.stroke()}function drawSpiral(e){let{stretch:t=1,size:o=80,thickness:u=o/2,cap:f="butt",inset:p=3,playheadColor:g="#ffffff",playheadLength:M=.02,playheadThickness:F=u,padding:S=0,steady:k=1,activeColor:N=getTheme().foreground,inactiveColor:$=getTheme().gutterForeground,colorizeInactive:R=0,fade:U=!0,ctx:O,time:Z,haps:K,drawTime:ie,id:de}=e;de&&(K=K.filter(be=>be.hasTag(de)));const[te,re]=[O.canvas.width,O.canvas.height];O.clearRect(0,0,te*2,re*2);const[ue,ve]=[te/2,re/2],Ae={margin:o/t,cx:ue,cy:ve,stretch:t,cap:f,thickness:u},Fe={...Ae,thickness:F,from:p-M,to:p,color:g},[we]=ie,Ce=k*Z;K.forEach(be=>{const le=be.whole.begin<=Z&&be.endClipped>Z,Ze=be.whole.begin-Z+p,Je=be.endClipped-Z+p-S,Qe=be.value?.color||N,rt=R||le?Qe:$,tt=U?1-Math.abs((be.whole.begin-Z)/we):1;spiralSegment({ctx:O,...Ae,from:Ze,to:Je,rotate:Ce,color:rt,fromOpacity:tt,toOpacity:tt})}),spiralSegment({ctx:O,...Fe,rotate:Ce})}Pattern$1.prototype.spiral=function(e={}){return this.onPaint((t,o,u,f)=>drawSpiral({ctx:t,time:o,haps:u,drawTime:f,...e}))};const c=midiToFreq$2(36),circlePos=(e,t,o,u)=>{u=u*Math.PI*2;const f=Math.sin(u)*o+e,p=Math.cos(u)*o+t;return[f,p]},freq2angle=(e,t)=>.5-Math.log2(e/t)%1;function pitchwheel({haps:e,ctx:t,id:o,hapcircles:u=1,circle:f=0,edo:p=12,root:g=c,thickness:M=3,hapRadius:F=6,mode:S="flake",margin:k=10}={}){const N=S==="polygon",$=S==="flake",R=t.canvas.width,U=t.canvas.height;t.clearRect(0,0,R,U);const O=getTheme().foreground,K=Math.min(R,U)/2-M/2-F-k,ie=R/2,de=U/2;o&&(e=e.filter(re=>re.hasTag(o))),t.strokeStyle=O,t.fillStyle=O,t.globalAlpha=1,t.lineWidth=M,f&&(t.beginPath(),t.arc(ie,de,K,0,2*Math.PI),t.stroke()),p&&(Array.from({length:p},(re,ue)=>{const ve=freq2angle(g*Math.pow(2,ue/p),g),[Ae,Fe]=circlePos(ie,de,K,ve);t.beginPath(),t.arc(Ae,Fe,F,0,2*Math.PI),t.fill()}),t.stroke());let te=[];t.lineWidth=F,e.forEach(re=>{let ue;try{ue=getFrequency(re)}catch{return}const ve=freq2angle(ue,g),[Ae,Fe]=circlePos(ie,de,K,ve),we=re.value.color||O;t.strokeStyle=we,t.fillStyle=we;const{velocity:Ce=1,gain:be=1}=re.value||{},le=Ce*be;t.globalAlpha=le,te.push([Ae,Fe,ve,we,le]),t.beginPath(),u&&(t.moveTo(Ae+F,Fe),t.arc(Ae,Fe,F,0,2*Math.PI),t.fill()),$&&(t.moveTo(ie,de),t.lineTo(Ae,Fe)),t.stroke()}),t.strokeStyle=O,t.globalAlpha=1,N&&te.length&&(te=te.sort((re,ue)=>re[2]-ue[2]),t.beginPath(),t.moveTo(te[0][0],te[0][1]),te.forEach(([re,ue,ve,Ae,Fe])=>{t.strokeStyle=Ae,t.globalAlpha=Fe,t.lineTo(re,ue)}),t.lineTo(te[0][0],te[0][1]),t.stroke())}Pattern$1.prototype.pitchwheel=function(e={}){let{ctx:t=getDrawContext(),id:o=1}=e;return this.tag(o).onPaint((u,f,p)=>pitchwheel({...e,ctx:t,haps:p.filter(g=>g.isActive(f)),id:o}))};function drawTimeScope(e,{align:t=!0,color:o="white",thickness:u=3,scale:f=.25,pos:p=.75,trigger:g=0,ctx:M=getDrawContext(),id:F=1}={}){M.lineWidth=u,M.strokeStyle=o;let S=M.canvas;if(!e){M.beginPath();let O=p*S.height;M.moveTo(0,O),M.lineTo(S.width,O),M.stroke();return}const k=getAnalyzerData("time",F);M.beginPath();const N=e.frequencyBinCount;let $=t?Array.from(k).findIndex((O,Z,K)=>Z&&K[Z-1]>-g&&O<=-g):0;$=Math.max($,0);const R=S.width*1/N;let U=0;for(let O=$;O<N;O++){const Z=k[O]+1,K=(p-f*(Z-1))*S.height;O===0?M.moveTo(U,K):M.lineTo(U,K),U+=R}M.stroke()}function drawFrequencyScope(e,{color:t="white",scale:o=.25,pos:u=.75,lean:f=.5,min:p=-150,max:g=0,ctx:M=getDrawContext(),id:F=1}={}){if(!e){M.beginPath();let U=u*k.height;M.moveTo(0,U),M.lineTo(k.width,U),M.stroke();return}const S=getAnalyzerData("frequency",F),k=M.canvas;M.fillStyle=t;const N=e.frequencyBinCount,$=k.width*1/N;let R=0;for(let U=0;U<N;U++){const Z=clamp$1((S[U]-p)/(g-p),0,1)*o,K=Z*k.height,ie=(u-Z*f)*k.height;M.fillRect(R,ie,Math.max($,1),K),R+=$}}function clearScreen(e=0,t="0,0,0",o=getDrawContext()){e?(o.fillStyle=`rgba(${t},${1-e})`,o.fillRect(0,0,o.canvas.width,o.canvas.height)):o.clearRect(0,0,o.canvas.width,o.canvas.height)}Pattern$1.prototype.fscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(()=>{clearScreen(e.smear,"0,0,0",e.ctx),analysers[t]&&drawFrequencyScope(analysers[t],e)},{id:t})},Pattern$1.prototype.tscope=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||getTheme().foreground,e.color,clearScreen(e.smear,"0,0,0",e.ctx),drawTimeScope(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;let latestColor={};Pattern$1.prototype.spectrum=function(e={}){let t=e.id??1;return this.analyze(t).draw(o=>{e.color=o[0]?.value?.color||latestColor[t]||getTheme().foreground,latestColor[t]=e.color,drawSpectrum(analysers[t],e)},{id:t})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;const lastFrames=new Map;function drawSpectrum(e,{thickness:t=3,speed:o=1,min:u=-80,max:f=0,ctx:p=getDrawContext(),id:g=1,color:M}={}){if(p.lineWidth=t,p.strokeStyle=M,!e)return;const F=o,S=getAnalyzerData("frequency",g),k=p.canvas;p.fillStyle=M;const N=e.frequencyBinCount;let $=lastFrames.get(g)||p.getImageData(0,0,k.width,k.height);lastFrames.set(g,$),p.clearRect(0,0,p.canvas.width,p.canvas.height),p.putImageData($,-F,0);let R=k.width-o;for(let U=0;U<N;U++){const O=clamp$1((S[U]-u)/(f-u),0,1);p.globalAlpha=O;const Z=Math.log(U+1)/Math.log(N)*k.height;p.fillRect(R,k.height-Z,F,2)}lastFrames.set(g,p.getImageData(0,0,k.width,k.height))}const strudelWebAudio=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY,Warpmode,aliasBank,get analysers(){return analysers},get analysersData(){return analysersData},applyFM,applyGainCurve,applyParameterModulators,connectToDestination,createFilter,destroyAudioWorkletNode,distortionAlgorithms,dough,doughTrigger,doughsamples,drawFrequencyScope,drawTimeScope,drywet,dspWorklet,effectSend,errorLogger,gainNode,getADSRValues,getAnalyserById,getAnalyzerData,getAudioContext,getAudioContextCurrentTime,getAudioDevices,getCachedBuffer,getCompressor,getDefaultValue,getDistortion,getDistortionAlgorithm,getFrequencyFromValue,getLfo,getLoadedBuffer,getOscillator,getParamADSR,getParamLfo,getPitchEnvelope,getSampleBuffer,getSampleBufferSource,getSampleInfo,getSound,getSuperdoughAudioController,getVibratoOscillator,getWorklet,getZZFX,initAudio,initAudioOnFirstClick,loadBuffer:loadBuffer$1,logger:logger$1,noises,onTriggerSample,onTriggerSynth,processSampleMap,registerSampleSource,registerSamplesPrefix,registerSound,registerSynthSounds,registerWaveTable,registerWorklet,registerZZFXSounds,resetDefaultValues,resetDefaults,resetGlobalEffects,resetLoadedSounds,reverseBuffer,samples,scheduleAtTime,setDefault,setDefaultAudioContext,setDefaultValue,setDefaultValues,setGainCurve,setLogger,setMaxPolyphony,setMultiChannelOrbits,setVersionDefaults,soundAlias,soundMap:soundMap$1,superdough,superdoughTrigger,tables,waveformN,webAudioTimeout,webaudioOutput,webaudioRepl},Symbol.toStringTag,{value:"Module"}));var astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],nonASCIIidentifierChars="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",reservedWords={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ecma5AndLessKeywords="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",keywords$1={5:ecma5AndLessKeywords,"5module":ecma5AndLessKeywords+" export import",6:ecma5AndLessKeywords+" const class extends export import super"},keywordRelationalOperator=/^in(stanceof)?$/,nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]"),nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");function isInAstralSet(e,t){for(var o=65536,u=0;u<t.length;u+=2){if(o+=t[u],o>e)return!1;if(o+=t[u+1],o>=e)return!0}return!1}function isIdentifierStart(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifierStart.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)}function isIdentifierChar(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&nonASCIIidentifier.test(String.fromCharCode(e)):t===!1?!1:isInAstralSet(e,astralIdentifierStartCodes)||isInAstralSet(e,astralIdentifierCodes)}var TokenType=function(t,o){o===void 0&&(o={}),this.label=t,this.keyword=o.keyword,this.beforeExpr=!!o.beforeExpr,this.startsExpr=!!o.startsExpr,this.isLoop=!!o.isLoop,this.isAssign=!!o.isAssign,this.prefix=!!o.prefix,this.postfix=!!o.postfix,this.binop=o.binop||null,this.updateContext=null};function binop(e,t){return new TokenType(e,{beforeExpr:!0,binop:t})}var beforeExpr={beforeExpr:!0},startsExpr={startsExpr:!0},keywords={};function kw(e,t){return t===void 0&&(t={}),t.keyword=e,keywords[e]=new TokenType(e,t)}var types$1={num:new TokenType("num",startsExpr),regexp:new TokenType("regexp",startsExpr),string:new TokenType("string",startsExpr),name:new TokenType("name",startsExpr),privateId:new TokenType("privateId",startsExpr),eof:new TokenType("eof"),bracketL:new TokenType("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new TokenType("]"),braceL:new TokenType("{",{beforeExpr:!0,startsExpr:!0}),braceR:new TokenType("}"),parenL:new TokenType("(",{beforeExpr:!0,startsExpr:!0}),parenR:new TokenType(")"),comma:new TokenType(",",beforeExpr),semi:new TokenType(";",beforeExpr),colon:new TokenType(":",beforeExpr),dot:new TokenType("."),question:new TokenType("?",beforeExpr),questionDot:new TokenType("?."),arrow:new TokenType("=>",beforeExpr),template:new TokenType("template"),invalidTemplate:new TokenType("invalidTemplate"),ellipsis:new TokenType("...",beforeExpr),backQuote:new TokenType("`",startsExpr),dollarBraceL:new TokenType("${",{beforeExpr:!0,startsExpr:!0}),eq:new TokenType("=",{beforeExpr:!0,isAssign:!0}),assign:new TokenType("_=",{beforeExpr:!0,isAssign:!0}),incDec:new TokenType("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new TokenType("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:binop("||",1),logicalAND:binop("&&",2),bitwiseOR:binop("|",3),bitwiseXOR:binop("^",4),bitwiseAND:binop("&",5),equality:binop("==/!=/===/!==",6),relational:binop("</>/<=/>=",7),bitShift:binop("<</>>/>>>",8),plusMin:new TokenType("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:binop("%",10),star:binop("*",10),slash:binop("/",10),starstar:new TokenType("**",{beforeExpr:!0}),coalesce:binop("??",1),_break:kw("break"),_case:kw("case",beforeExpr),_catch:kw("catch"),_continue:kw("continue"),_debugger:kw("debugger"),_default:kw("default",beforeExpr),_do:kw("do",{isLoop:!0,beforeExpr:!0}),_else:kw("else",beforeExpr),_finally:kw("finally"),_for:kw("for",{isLoop:!0}),_function:kw("function",startsExpr),_if:kw("if"),_return:kw("return",beforeExpr),_switch:kw("switch"),_throw:kw("throw",beforeExpr),_try:kw("try"),_var:kw("var"),_const:kw("const"),_while:kw("while",{isLoop:!0}),_with:kw("with"),_new:kw("new",{beforeExpr:!0,startsExpr:!0}),_this:kw("this",startsExpr),_super:kw("super",startsExpr),_class:kw("class",startsExpr),_extends:kw("extends",beforeExpr),_export:kw("export"),_import:kw("import",startsExpr),_null:kw("null",startsExpr),_true:kw("true",startsExpr),_false:kw("false",startsExpr),_in:kw("in",{beforeExpr:!0,binop:7}),_instanceof:kw("instanceof",{beforeExpr:!0,binop:7}),_typeof:kw("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:kw("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:kw("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lineBreak=/\r\n?|\n|\u2028|\u2029/,lineBreakG=new RegExp(lineBreak.source,"g");function isNewLine(e){return e===10||e===13||e===8232||e===8233}function nextLineBreak(e,t,o){o===void 0&&(o=e.length);for(var u=t;u<o;u++){var f=e.charCodeAt(u);if(isNewLine(f))return u<o-1&&f===13&&e.charCodeAt(u+1)===10?u+2:u+1}return-1}var nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,skipWhiteSpace=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ref=Object.prototype,hasOwnProperty=ref.hasOwnProperty,toString=ref.toString,hasOwn=Object.hasOwn||(function(e,t){return hasOwnProperty.call(e,t)}),isArray=Array.isArray||(function(e){return toString.call(e)==="[object Array]"}),regexpCache=Object.create(null);function wordsRegexp(e){return regexpCache[e]||(regexpCache[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var loneSurrogate=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Position=function(t,o){this.line=t,this.column=o};Position.prototype.offset=function(t){return new Position(this.line,this.column+t)};var SourceLocation=function(t,o,u){this.start=o,this.end=u,t.sourceFile!==null&&(this.source=t.sourceFile)};function getLineInfo(e,t){for(var o=1,u=0;;){var f=nextLineBreak(e,u,t);if(f<0)return new Position(o,t-u);++o,u=f}}var defaultOptions={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},warnedAboutEcmaVersion=!1;function getOptions(e){var t={};for(var o in defaultOptions)t[o]=e&&hasOwn(e,o)?e[o]:defaultOptions[o];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!warnedAboutEcmaVersion&&typeof console=="object"&&console.warn&&(warnedAboutEcmaVersion=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),isArray(t.onToken)){var u=t.onToken;t.onToken=function(f){return u.push(f)}}return isArray(t.onComment)&&(t.onComment=pushComment(t,t.onComment)),t}function pushComment(e,t){return function(o,u,f,p,g,M){var F={type:o?"Block":"Line",value:u,start:f,end:p};e.locations&&(F.loc=new SourceLocation(this,g,M)),e.ranges&&(F.range=[f,p]),t.push(F)}}var SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_CLASS_FIELD_INIT=512,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(e,t){return SCOPE_FUNCTION|(e?SCOPE_ASYNC:0)|(t?SCOPE_GENERATOR:0)}var BIND_NONE=0,BIND_VAR=1,BIND_LEXICAL=2,BIND_FUNCTION=3,BIND_SIMPLE_CATCH=4,BIND_OUTSIDE=5,Parser=function(t,o,u){this.options=t=getOptions(t),this.sourceFile=t.sourceFile,this.keywords=wordsRegexp(keywords$1[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var f="";t.allowReserved!==!0&&(f=reservedWords[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(f+=" await")),this.reservedWords=wordsRegexp(f);var p=(f?f+" ":"")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(p),this.reservedWordsStrictBind=wordsRegexp(p+" "+reservedWords.strictBind),this.input=String(o),this.containsEsc=!1,u?(this.pos=u,this.lineStart=this.input.lastIndexOf(`
`,u-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=types$1.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(SCOPE_TOP),this.regexpState=null,this.privateNameStack=[]},prototypeAccessors={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Parser.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0},prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0},prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0},prototypeAccessors.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT))return!1;if(o&SCOPE_FUNCTION)return(o&SCOPE_ASYNC)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},prototypeAccessors.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags;return(t&SCOPE_SUPER)>0||this.options.allowSuperOutsideMethod},prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0},prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},prototypeAccessors.allowNewDotTarget.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e],o=t.flags;if(o&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT)||o&SCOPE_FUNCTION&&!(o&SCOPE_ARROW))return!0}return!1},prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0},Parser.extend=function(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];for(var u=this,f=0;f<t.length;f++)u=t[f](u);return u},Parser.parse=function(t,o){return new this(o,t).parse()},Parser.parseExpressionAt=function(t,o,u){var f=new this(u,t,o);return f.nextToken(),f.parseExpression()},Parser.tokenizer=function(t,o){return new this(o,t)},Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype,literal=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;pp$9.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length;var t=literal.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){skipWhiteSpace.lastIndex=e+t[0].length;var o=skipWhiteSpace.exec(this.input),u=o.index+o[0].length,f=this.input.charAt(u);return f===";"||f==="}"||lineBreak.test(o[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(f)||f==="!"&&this.input.charAt(u+1)==="=")}e+=t[0].length,skipWhiteSpace.lastIndex=e,e+=skipWhiteSpace.exec(this.input)[0].length,this.input[e]===";"&&e++}},pp$9.eat=function(e){return this.type===e?(this.next(),!0):!1},pp$9.isContextual=function(e){return this.type===types$1.name&&this.value===e&&!this.containsEsc},pp$9.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1},pp$9.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},pp$9.canInsertSemicolon=function(){return this.type===types$1.eof||this.type===types$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$9.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},pp$9.semicolon=function(){!this.eat(types$1.semi)&&!this.insertSemicolon()&&this.unexpected()},pp$9.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},pp$9.expect=function(e){this.eat(e)||this.unexpected()},pp$9.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var DestructuringErrors=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pp$9.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var o=t?e.parenthesizedAssign:e.parenthesizedBind;o>-1&&this.raiseRecoverable(o,t?"Assigning to rvalue":"Parenthesized pattern")}},pp$9.checkExpressionErrors=function(e,t){if(!e)return!1;var o=e.shorthandAssign,u=e.doubleProto;if(!t)return o>=0||u>=0;o>=0&&this.raise(o,"Shorthand property assignments are valid only in destructuring patterns"),u>=0&&this.raiseRecoverable(u,"Redefinition of __proto__ property")},pp$9.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},pp$9.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var pp$8=Parser.prototype;pp$8.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==types$1.eof;){var o=this.parseStatement(null,!0,t);e.body.push(o)}if(this.inModule)for(var u=0,f=Object.keys(this.undefinedExports);u<f.length;u+=1){var p=f[u];this.raiseRecoverable(this.undefinedExports[p].start,"Export '"+p+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var loopLabel={kind:"loop"},switchLabel={kind:"switch"};pp$8.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;skipWhiteSpace.lastIndex=this.pos;var t=skipWhiteSpace.exec(this.input),o=this.pos+t[0].length,u=this.input.charCodeAt(o);if(u===91||u===92)return!0;if(e)return!1;if(u===123||u>55295&&u<56320)return!0;if(isIdentifierStart(u,!0)){for(var f=o+1;isIdentifierChar(u=this.input.charCodeAt(f),!0);)++f;if(u===92||u>55295&&u<56320)return!0;var p=this.input.slice(o,f);if(!keywordRelationalOperator.test(p))return!0}return!1},pp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;skipWhiteSpace.lastIndex=this.pos;var e=skipWhiteSpace.exec(this.input),t=this.pos+e[0].length,o;return!lineBreak.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(isIdentifierChar(o=this.input.charCodeAt(t+8))||o>55295&&o<56320))},pp$8.isUsingKeyword=function(e,t){if(this.options.ecmaVersion<17||!this.isContextual(e?"await":"using"))return!1;skipWhiteSpace.lastIndex=this.pos;var o=skipWhiteSpace.exec(this.input),u=this.pos+o[0].length;if(lineBreak.test(this.input.slice(this.pos,u)))return!1;if(e){var f=u+5,p;if(this.input.slice(u,f)!=="using"||f===this.input.length||isIdentifierChar(p=this.input.charCodeAt(f))||p>55295&&p<56320)return!1;skipWhiteSpace.lastIndex=f;var g=skipWhiteSpace.exec(this.input);if(g&&lineBreak.test(this.input.slice(f,f+g[0].length)))return!1}if(t){var M=u+2,F;if(this.input.slice(u,M)==="of"&&(M===this.input.length||!isIdentifierChar(F=this.input.charCodeAt(M))&&!(F>55295&&F<56320)))return!1}var S=this.input.charCodeAt(u);return isIdentifierStart(S,!0)||S===92},pp$8.isAwaitUsing=function(e){return this.isUsingKeyword(!0,e)},pp$8.isUsing=function(e){return this.isUsingKeyword(!1,e)},pp$8.parseStatement=function(e,t,o){var u=this.type,f=this.startNode(),p;switch(this.isLet(e)&&(u=types$1._var,p="let"),u){case types$1._break:case types$1._continue:return this.parseBreakContinueStatement(f,u.keyword);case types$1._debugger:return this.parseDebuggerStatement(f);case types$1._do:return this.parseDoStatement(f);case types$1._for:return this.parseForStatement(f);case types$1._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(f,!1,!e);case types$1._class:return e&&this.unexpected(),this.parseClass(f,!0);case types$1._if:return this.parseIfStatement(f);case types$1._return:return this.parseReturnStatement(f);case types$1._switch:return this.parseSwitchStatement(f);case types$1._throw:return this.parseThrowStatement(f);case types$1._try:return this.parseTryStatement(f);case types$1._const:case types$1._var:return p=p||this.value,e&&p!=="var"&&this.unexpected(),this.parseVarStatement(f,p);case types$1._while:return this.parseWhileStatement(f);case types$1._with:return this.parseWithStatement(f);case types$1.braceL:return this.parseBlock(!0,f);case types$1.semi:return this.parseEmptyStatement(f);case types$1._export:case types$1._import:if(this.options.ecmaVersion>10&&u===types$1._import){skipWhiteSpace.lastIndex=this.pos;var g=skipWhiteSpace.exec(this.input),M=this.pos+g[0].length,F=this.input.charCodeAt(M);if(F===40||F===46)return this.parseExpressionStatement(f,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),u===types$1._import?this.parseImport(f):this.parseExport(f,o);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(f,!0,!e);var S=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(S)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),S==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(f,!1,S),this.semicolon(),this.finishNode(f,"VariableDeclaration");var k=this.value,N=this.parseExpression();return u===types$1.name&&N.type==="Identifier"&&this.eat(types$1.colon)?this.parseLabeledStatement(f,k,N,e):this.parseExpressionStatement(f,N)}},pp$8.parseBreakContinueStatement=function(e,t){var o=t==="break";this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.label=null:this.type!==types$1.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var u=0;u<this.labels.length;++u){var f=this.labels[u];if((e.label==null||f.name===e.label.name)&&(f.kind!=null&&(o||f.kind==="loop")||e.label&&o))break}return u===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,o?"BreakStatement":"ContinueStatement")},pp$8.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},pp$8.parseDoStatement=function(e){return this.next(),this.labels.push(loopLabel),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(types$1._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(types$1.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},pp$8.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(loopLabel),this.enterScope(0),this.expect(types$1.parenL),this.type===types$1.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var o=this.isLet();if(this.type===types$1._var||this.type===types$1._const||o){var u=this.startNode(),f=o?"let":this.value;return this.next(),this.parseVar(u,!0,f),this.finishNode(u,"VariableDeclaration"),this.parseForAfterInit(e,u,t)}var p=this.isContextual("let"),g=!1,M=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(M){var F=this.startNode();return this.next(),M==="await using"&&this.next(),this.parseVar(F,!0,M),this.finishNode(F,"VariableDeclaration"),this.parseForAfterInit(e,F,t)}var S=this.containsEsc,k=new DestructuringErrors,N=this.start,$=t>-1?this.parseExprSubscripts(k,"await"):this.parseExpression(!0,k);return this.type===types$1._in||(g=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===types$1._in&&this.unexpected(t),e.await=!0):g&&this.options.ecmaVersion>=8&&($.start===N&&!S&&$.type==="Identifier"&&$.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),p&&g&&this.raise($.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable($,!1,k),this.checkLValPattern($),this.parseForIn(e,$)):(this.checkExpressionErrors(k,!0),t>-1&&this.unexpected(t),this.parseFor(e,$))},pp$8.parseForAfterInit=function(e,t,o){return(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===types$1._in?o>-1&&this.unexpected(o):e.await=o>-1),this.parseForIn(e,t)):(o>-1&&this.unexpected(o),this.parseFor(e,t))},pp$8.parseFunctionStatement=function(e,t,o){return this.next(),this.parseFunction(e,FUNC_STATEMENT|(o?0:FUNC_HANGING_STATEMENT),!1,t)},pp$8.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(types$1._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},pp$8.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(types$1.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},pp$8.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(types$1.braceL),this.labels.push(switchLabel),this.enterScope(0);for(var t,o=!1;this.type!==types$1.braceR;)if(this.type===types$1._case||this.type===types$1._default){var u=this.type===types$1._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),u?t.test=this.parseExpression():(o&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),o=!0,t.test=null),this.expect(types$1.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},pp$8.parseThrowStatement=function(e){return this.next(),lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var empty$1=[];pp$8.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?SCOPE_SIMPLE_CATCH:0),this.checkLValPattern(e,t?BIND_SIMPLE_CATCH:BIND_LEXICAL),this.expect(types$1.parenR),e},pp$8.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===types$1._catch){var t=this.startNode();this.next(),this.eat(types$1.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(types$1._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},pp$8.parseVarStatement=function(e,t,o){return this.next(),this.parseVar(e,!1,t,o),this.semicolon(),this.finishNode(e,"VariableDeclaration")},pp$8.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(loopLabel),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},pp$8.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},pp$8.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},pp$8.parseLabeledStatement=function(e,t,o,u){for(var f=0,p=this.labels;f<p.length;f+=1){var g=p[f];g.name===t&&this.raise(o.start,"Label '"+t+"' is already declared")}for(var M=this.type.isLoop?"loop":this.type===types$1._switch?"switch":null,F=this.labels.length-1;F>=0;F--){var S=this.labels[F];if(S.statementStart===e.start)S.statementStart=this.start,S.kind=M;else break}return this.labels.push({name:t,kind:M,statementStart:this.start}),e.body=this.parseStatement(u?u.indexOf("label")===-1?u+"label":u:"label"),this.labels.pop(),e.label=o,this.finishNode(e,"LabeledStatement")},pp$8.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},pp$8.parseBlock=function(e,t,o){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(types$1.braceL),e&&this.enterScope(0);this.type!==types$1.braceR;){var u=this.parseStatement(null);t.body.push(u)}return o&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")},pp$8.parseFor=function(e,t){return e.init=t,this.expect(types$1.semi),e.test=this.type===types$1.semi?null:this.parseExpression(),this.expect(types$1.semi),e.update=this.type===types$1.parenR?null:this.parseExpression(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},pp$8.parseForIn=function(e,t){var o=this.type===types$1._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!o||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(o?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=o?this.parseExpression():this.parseMaybeAssign(),this.expect(types$1.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,o?"ForInStatement":"ForOfStatement")},pp$8.parseVar=function(e,t,o,u){for(e.declarations=[],e.kind=o;;){var f=this.startNode();if(this.parseVarId(f,o),this.eat(types$1.eq)?f.init=this.parseMaybeAssign(t):!u&&o==="const"&&!(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!u&&(o==="using"||o==="await using")&&this.options.ecmaVersion>=17&&this.type!==types$1._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+o+" declaration"):!u&&f.id.type!=="Identifier"&&!(t&&(this.type===types$1._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):f.init=null,e.declarations.push(this.finishNode(f,"VariableDeclarator")),!this.eat(types$1.comma))break}return e},pp$8.parseVarId=function(e,t){e.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?BIND_VAR:BIND_LEXICAL,!1)};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;pp$8.parseFunction=function(e,t,o,u,f){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!u)&&(this.type===types$1.star&&t&FUNC_HANGING_STATEMENT&&this.unexpected(),e.generator=this.eat(types$1.star)),this.options.ecmaVersion>=8&&(e.async=!!u),t&FUNC_STATEMENT&&(e.id=t&FUNC_NULLABLE_ID&&this.type!==types$1.name?null:this.parseIdent(),e.id&&!(t&FUNC_HANGING_STATEMENT)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION));var p=this.yieldPos,g=this.awaitPos,M=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(e.async,e.generator)),t&FUNC_STATEMENT||(e.id=this.type===types$1.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,o,!1,f),this.yieldPos=p,this.awaitPos=g,this.awaitIdentPos=M,this.finishNode(e,t&FUNC_STATEMENT?"FunctionDeclaration":"FunctionExpression")},pp$8.parseFunctionParams=function(e){this.expect(types$1.parenL),e.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},pp$8.parseClass=function(e,t){this.next();var o=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var u=this.enterClassBody(),f=this.startNode(),p=!1;for(f.body=[],this.expect(types$1.braceL);this.type!==types$1.braceR;){var g=this.parseClassElement(e.superClass!==null);g&&(f.body.push(g),g.type==="MethodDefinition"&&g.kind==="constructor"?(p&&this.raiseRecoverable(g.start,"Duplicate constructor in the same class"),p=!0):g.key&&g.key.type==="PrivateIdentifier"&&isPrivateNameConflicted(u,g)&&this.raiseRecoverable(g.key.start,"Identifier '#"+g.key.name+"' has already been declared"))}return this.strict=o,this.next(),e.body=this.finishNode(f,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},pp$8.parseClassElement=function(e){if(this.eat(types$1.semi))return null;var t=this.options.ecmaVersion,o=this.startNode(),u="",f=!1,p=!1,g="method",M=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(types$1.braceL))return this.parseClassStaticBlock(o),o;this.isClassElementNameStart()||this.type===types$1.star?M=!0:u="static"}if(o.static=M,!u&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===types$1.star)&&!this.canInsertSemicolon()?p=!0:u="async"),!u&&(t>=9||!p)&&this.eat(types$1.star)&&(f=!0),!u&&!p&&!f){var F=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?g=F:u=F)}if(u?(o.computed=!1,o.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),o.key.name=u,this.finishNode(o.key,"Identifier")):this.parseClassElementName(o),t<13||this.type===types$1.parenL||g!=="method"||f||p){var S=!o.static&&checkKeyName(o,"constructor"),k=S&&e;S&&g!=="method"&&this.raise(o.key.start,"Constructor can't have get/set modifier"),o.kind=S?"constructor":g,this.parseClassMethod(o,f,p,k)}else this.parseClassField(o);return o},pp$8.isClassElementNameStart=function(){return this.type===types$1.name||this.type===types$1.privateId||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword},pp$8.parseClassElementName=function(e){this.type===types$1.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},pp$8.parseClassMethod=function(e,t,o,u){var f=e.key;e.kind==="constructor"?(t&&this.raise(f.start,"Constructor can't be a generator"),o&&this.raise(f.start,"Constructor can't be an async method")):e.static&&checkKeyName(e,"prototype")&&this.raise(f.start,"Classes may not have a static property named prototype");var p=e.value=this.parseMethod(t,o,u);return e.kind==="get"&&p.params.length!==0&&this.raiseRecoverable(p.start,"getter should have no params"),e.kind==="set"&&p.params.length!==1&&this.raiseRecoverable(p.start,"setter should have exactly one param"),e.kind==="set"&&p.params[0].type==="RestElement"&&this.raiseRecoverable(p.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")},pp$8.parseClassField=function(e){return checkKeyName(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&checkKeyName(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(types$1.eq)?(this.enterScope(SCOPE_CLASS_FIELD_INIT|SCOPE_SUPER),e.value=this.parseMaybeAssign(),this.exitScope()):e.value=null,this.semicolon(),this.finishNode(e,"PropertyDefinition")},pp$8.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);this.type!==types$1.braceR;){var o=this.parseStatement(null);e.body.push(o)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")},pp$8.parseClassId=function(e,t){this.type===types$1.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,BIND_LEXICAL,!1)):(t===!0&&this.unexpected(),e.id=null)},pp$8.parseClassSuper=function(e){e.superClass=this.eat(types$1._extends)?this.parseExprSubscripts(null,!1):null},pp$8.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared},pp$8.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,o=e.used;if(this.options.checkPrivateFields)for(var u=this.privateNameStack.length,f=u===0?null:this.privateNameStack[u-1],p=0;p<o.length;++p){var g=o[p];hasOwn(t,g.name)||(f?f.used.push(g):this.raiseRecoverable(g.start,"Private field '#"+g.name+"' must be declared in an enclosing class"))}};function isPrivateNameConflicted(e,t){var o=t.key.name,u=e[o],f="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(f=(t.static?"s":"i")+t.kind),u==="iget"&&f==="iset"||u==="iset"&&f==="iget"||u==="sget"&&f==="sset"||u==="sset"&&f==="sget"?(e[o]="true",!1):u?!0:(e[o]=f,!1)}function checkKeyName(e,t){var o=e.computed,u=e.key;return!o&&(u.type==="Identifier"&&u.name===t||u.type==="Literal"&&u.value===t)}pp$8.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")},pp$8.parseExport=function(e,t){if(this.next(),this.eat(types$1.star))return this.parseExportAllDeclaration(e,t);if(this.eat(types$1._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[]);else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==types$1.string&&this.unexpected(),e.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause());else{for(var o=0,u=e.specifiers;o<u.length;o+=1){var f=u[o];this.checkUnreserved(f.local),this.checkLocalExport(f.local),f.local.type==="Literal"&&this.raise(f.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null,this.options.ecmaVersion>=16&&(e.attributes=[])}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},pp$8.parseExportDeclaration=function(e){return this.parseStatement(null)},pp$8.parseExportDefaultDeclaration=function(){var e;if(this.type===types$1._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,FUNC_STATEMENT|FUNC_NULLABLE_ID,!1,e)}else if(this.type===types$1._class){var o=this.startNode();return this.parseClass(o,"nullableID")}else{var u=this.parseMaybeAssign();return this.semicolon(),u}},pp$8.checkExport=function(e,t,o){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),hasOwn(e,t)&&this.raiseRecoverable(o,"Duplicate export '"+t+"'"),e[t]=!0)},pp$8.checkPatternExport=function(e,t){var o=t.type;if(o==="Identifier")this.checkExport(e,t,t.start);else if(o==="ObjectPattern")for(var u=0,f=t.properties;u<f.length;u+=1){var p=f[u];this.checkPatternExport(e,p)}else if(o==="ArrayPattern")for(var g=0,M=t.elements;g<M.length;g+=1){var F=M[g];F&&this.checkPatternExport(e,F)}else o==="Property"?this.checkPatternExport(e,t.value):o==="AssignmentPattern"?this.checkPatternExport(e,t.left):o==="RestElement"&&this.checkPatternExport(e,t.argument)},pp$8.checkVariableExport=function(e,t){if(e)for(var o=0,u=t;o<u.length;o+=1){var f=u[o];this.checkPatternExport(e,f.id)}},pp$8.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},pp$8.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")},pp$8.parseExportSpecifiers=function(e){var t=[],o=!0;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;t.push(this.parseExportSpecifier(e))}return t},pp$8.parseImport=function(e){return this.next(),this.type===types$1.string?(e.specifiers=empty$1,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===types$1.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(e.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},pp$8.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportSpecifier")},pp$8.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportDefaultSpecifier")},pp$8.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,BIND_LEXICAL),this.finishNode(e,"ImportNamespaceSpecifier")},pp$8.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===types$1.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(types$1.comma)))return e;if(this.type===types$1.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(t)t=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;e.push(this.parseImportSpecifier())}return e},pp$8.parseWithClause=function(){var e=[];if(!this.eat(types$1._with))return e;this.expect(types$1.braceL);for(var t={},o=!0;!this.eat(types$1.braceR);){if(o)o=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;var u=this.parseImportAttribute(),f=u.key.type==="Identifier"?u.key.name:u.key.value;hasOwn(t,f)&&this.raiseRecoverable(u.key.start,"Duplicate attribute key '"+f+"'"),t[f]=!0,e.push(u)}return e},pp$8.parseImportAttribute=function(){var e=this.startNode();return e.key=this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(types$1.colon),this.type!==types$1.string&&this.unexpected(),e.value=this.parseExprAtom(),this.finishNode(e,"ImportAttribute")},pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1.string){var e=this.parseLiteral(this.value);return loneSurrogate.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)},pp$8.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},pp$8.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var pp$7=Parser.prototype;pp$7.toAssignable=function(e,t,o){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",o&&this.checkPatternErrors(o,!0);for(var u=0,f=e.properties;u<f.length;u+=1){var p=f[u];this.toAssignable(p,t),p.type==="RestElement"&&(p.argument.type==="ArrayPattern"||p.argument.type==="ObjectPattern")&&this.raise(p.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",o&&this.checkPatternErrors(o,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,o);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else o&&this.checkPatternErrors(o,!0);return e},pp$7.toAssignableList=function(e,t){for(var o=e.length,u=0;u<o;u++){var f=e[u];f&&this.toAssignable(f,t)}if(o){var p=e[o-1];this.options.ecmaVersion===6&&t&&p&&p.type==="RestElement"&&p.argument.type!=="Identifier"&&this.unexpected(p.argument.start)}return e},pp$7.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},pp$7.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==types$1.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},pp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case types$1.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(types$1.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case types$1.braceL:return this.parseObj(!0)}return this.parseIdent()},pp$7.parseBindingList=function(e,t,o,u){for(var f=[],p=!0;!this.eat(e);)if(p?p=!1:this.expect(types$1.comma),t&&this.type===types$1.comma)f.push(null);else{if(o&&this.afterTrailingComma(e))break;if(this.type===types$1.ellipsis){var g=this.parseRestBinding();this.parseBindingListItem(g),f.push(g),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else f.push(this.parseAssignableListItem(u))}return f},pp$7.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t},pp$7.parseBindingListItem=function(e){return e},pp$7.parseMaybeDefault=function(e,t,o){if(o=o||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(types$1.eq))return o;var u=this.startNodeAt(e,t);return u.left=o,u.right=this.parseMaybeAssign(),this.finishNode(u,"AssignmentPattern")},pp$7.checkLValSimple=function(e,t,o){t===void 0&&(t=BIND_NONE);var u=t!==BIND_NONE;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(u?"Binding ":"Assigning to ")+e.name+" in strict mode"),u&&(t===BIND_LEXICAL&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),o&&(hasOwn(o,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),o[e.name]=!0),t!==BIND_OUTSIDE&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":u&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return u&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,o);default:this.raise(e.start,(u?"Binding":"Assigning to")+" rvalue")}},pp$7.checkLValPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"ObjectPattern":for(var u=0,f=e.properties;u<f.length;u+=1){var p=f[u];this.checkLValInnerPattern(p,t,o)}break;case"ArrayPattern":for(var g=0,M=e.elements;g<M.length;g+=1){var F=M[g];F&&this.checkLValInnerPattern(F,t,o)}break;default:this.checkLValSimple(e,t,o)}},pp$7.checkLValInnerPattern=function(e,t,o){switch(t===void 0&&(t=BIND_NONE),e.type){case"Property":this.checkLValInnerPattern(e.value,t,o);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,o);break;case"RestElement":this.checkLValPattern(e.argument,t,o);break;default:this.checkLValPattern(e,t,o)}};var TokContext=function(t,o,u,f,p){this.token=t,this.isExpr=!!o,this.preserveSpace=!!u,this.override=f,this.generator=!!p},types={b_stat:new TokContext("{",!1),b_expr:new TokContext("{",!0),b_tmpl:new TokContext("${",!1),p_stat:new TokContext("(",!1),p_expr:new TokContext("(",!0),q_tmpl:new TokContext("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new TokContext("function",!1),f_expr:new TokContext("function",!0),f_expr_gen:new TokContext("function",!0,!1,null,!0),f_gen:new TokContext("function",!1,!1,null,!0)},pp$6=Parser.prototype;pp$6.initialContext=function(){return[types.b_stat]},pp$6.curContext=function(){return this.context[this.context.length-1]},pp$6.braceIsBlock=function(e){var t=this.curContext();return t===types.f_expr||t===types.f_stat?!0:e===types$1.colon&&(t===types.b_stat||t===types.b_expr)?!t.isExpr:e===types$1._return||e===types$1.name&&this.exprAllowed?lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):e===types$1._else||e===types$1.semi||e===types$1.eof||e===types$1.parenR||e===types$1.arrow?!0:e===types$1.braceL?t===types.b_stat:e===types$1._var||e===types$1._const||e===types$1.name?!1:!this.exprAllowed},pp$6.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1},pp$6.updateContext=function(e){var t,o=this.type;o.keyword&&e===types$1.dot?this.exprAllowed=!1:(t=o.updateContext)?t.call(this,e):this.exprAllowed=o.beforeExpr},pp$6.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)},types$1.parenR.updateContext=types$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===types.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr},types$1.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?types.b_stat:types.b_expr),this.exprAllowed=!0},types$1.dollarBraceL.updateContext=function(){this.context.push(types.b_tmpl),this.exprAllowed=!0},types$1.parenL.updateContext=function(e){var t=e===types$1._if||e===types$1._for||e===types$1._with||e===types$1._while;this.context.push(t?types.p_stat:types.p_expr),this.exprAllowed=!0},types$1.incDec.updateContext=function(){},types$1._function.updateContext=types$1._class.updateContext=function(e){e.beforeExpr&&e!==types$1._else&&!(e===types$1.semi&&this.curContext()!==types.p_stat)&&!(e===types$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===types$1.colon||e===types$1.braceL)&&this.curContext()===types.b_stat)?this.context.push(types.f_expr):this.context.push(types.f_stat),this.exprAllowed=!1},types$1.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},types$1.backQuote.updateContext=function(){this.curContext()===types.q_tmpl?this.context.pop():this.context.push(types.q_tmpl),this.exprAllowed=!1},types$1.star.updateContext=function(e){if(e===types$1._function){var t=this.context.length-1;this.context[t]===types.f_expr?this.context[t]=types.f_expr_gen:this.context[t]=types.f_gen}this.exprAllowed=!0},types$1.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==types$1.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var pp$5=Parser.prototype;pp$5.checkPropClash=function(e,t,o){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var u=e.key,f;switch(u.type){case"Identifier":f=u.name;break;case"Literal":f=String(u.value);break;default:return}var p=e.kind;if(this.options.ecmaVersion>=6){f==="__proto__"&&p==="init"&&(t.proto&&(o?o.doubleProto<0&&(o.doubleProto=u.start):this.raiseRecoverable(u.start,"Redefinition of __proto__ property")),t.proto=!0);return}f="$"+f;var g=t[f];if(g){var M;p==="init"?M=this.strict&&g.init||g.get||g.set:M=g.init||g[p],M&&this.raiseRecoverable(u.start,"Redefinition of property")}else g=t[f]={init:!1,get:!1,set:!1};g[p]=!0}},pp$5.parseExpression=function(e,t){var o=this.start,u=this.startLoc,f=this.parseMaybeAssign(e,t);if(this.type===types$1.comma){var p=this.startNodeAt(o,u);for(p.expressions=[f];this.eat(types$1.comma);)p.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(p,"SequenceExpression")}return f},pp$5.parseMaybeAssign=function(e,t,o){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var u=!1,f=-1,p=-1,g=-1;t?(f=t.parenthesizedAssign,p=t.trailingComma,g=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new DestructuringErrors,u=!0);var M=this.start,F=this.startLoc;(this.type===types$1.parenL||this.type===types$1.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var S=this.parseMaybeConditional(e,t);if(o&&(S=o.call(this,S,M,F)),this.type.isAssign){var k=this.startNodeAt(M,F);return k.operator=this.value,this.type===types$1.eq&&(S=this.toAssignable(S,!1,t)),u||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=S.start&&(t.shorthandAssign=-1),this.type===types$1.eq?this.checkLValPattern(S):this.checkLValSimple(S),k.left=S,this.next(),k.right=this.parseMaybeAssign(e),g>-1&&(t.doubleProto=g),this.finishNode(k,"AssignmentExpression")}else u&&this.checkExpressionErrors(t,!0);return f>-1&&(t.parenthesizedAssign=f),p>-1&&(t.trailingComma=p),S},pp$5.parseMaybeConditional=function(e,t){var o=this.start,u=this.startLoc,f=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return f;if(this.eat(types$1.question)){var p=this.startNodeAt(o,u);return p.test=f,p.consequent=this.parseMaybeAssign(),this.expect(types$1.colon),p.alternate=this.parseMaybeAssign(e),this.finishNode(p,"ConditionalExpression")}return f},pp$5.parseExprOps=function(e,t){var o=this.start,u=this.startLoc,f=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||f.start===o&&f.type==="ArrowFunctionExpression"?f:this.parseExprOp(f,o,u,-1,e)},pp$5.parseExprOp=function(e,t,o,u,f){var p=this.type.binop;if(p!=null&&(!f||this.type!==types$1._in)&&p>u){var g=this.type===types$1.logicalOR||this.type===types$1.logicalAND,M=this.type===types$1.coalesce;M&&(p=types$1.logicalAND.binop);var F=this.value;this.next();var S=this.start,k=this.startLoc,N=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,f),S,k,p,f),$=this.buildBinary(t,o,e,N,F,g||M);return(g&&this.type===types$1.coalesce||M&&(this.type===types$1.logicalOR||this.type===types$1.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp($,t,o,u,f)}return e},pp$5.buildBinary=function(e,t,o,u,f,p){u.type==="PrivateIdentifier"&&this.raise(u.start,"Private identifier can only be left side of binary expression");var g=this.startNodeAt(e,t);return g.left=o,g.operator=f,g.right=u,this.finishNode(g,p?"LogicalExpression":"BinaryExpression")},pp$5.parseMaybeUnary=function(e,t,o,u){var f=this.start,p=this.startLoc,g;if(this.isContextual("await")&&this.canAwait)g=this.parseAwait(u),t=!0;else if(this.type.prefix){var M=this.startNode(),F=this.type===types$1.incDec;M.operator=this.value,M.prefix=!0,this.next(),M.argument=this.parseMaybeUnary(null,!0,F,u),this.checkExpressionErrors(e,!0),F?this.checkLValSimple(M.argument):this.strict&&M.operator==="delete"&&isLocalVariableAccess(M.argument)?this.raiseRecoverable(M.start,"Deleting local variable in strict mode"):M.operator==="delete"&&isPrivateFieldAccess(M.argument)?this.raiseRecoverable(M.start,"Private fields can not be deleted"):t=!0,g=this.finishNode(M,F?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===types$1.privateId)(u||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),g=this.parsePrivateIdent(),this.type!==types$1._in&&this.unexpected();else{if(g=this.parseExprSubscripts(e,u),this.checkExpressionErrors(e))return g;for(;this.type.postfix&&!this.canInsertSemicolon();){var S=this.startNodeAt(f,p);S.operator=this.value,S.prefix=!1,S.argument=g,this.checkLValSimple(g),this.next(),g=this.finishNode(S,"UpdateExpression")}}if(!o&&this.eat(types$1.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(f,p,g,this.parseMaybeUnary(null,!1,!1,u),"**",!1);else return g};function isLocalVariableAccess(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&isLocalVariableAccess(e.expression)}function isPrivateFieldAccess(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&isPrivateFieldAccess(e.expression)||e.type==="ParenthesizedExpression"&&isPrivateFieldAccess(e.expression)}pp$5.parseExprSubscripts=function(e,t){var o=this.start,u=this.startLoc,f=this.parseExprAtom(e,t);if(f.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return f;var p=this.parseSubscripts(f,o,u,!1,t);return e&&p.type==="MemberExpression"&&(e.parenthesizedAssign>=p.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=p.start&&(e.parenthesizedBind=-1),e.trailingComma>=p.start&&(e.trailingComma=-1)),p},pp$5.parseSubscripts=function(e,t,o,u,f){for(var p=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,g=!1;;){var M=this.parseSubscript(e,t,o,u,p,g,f);if(M.optional&&(g=!0),M===e||M.type==="ArrowFunctionExpression"){if(g){var F=this.startNodeAt(t,o);F.expression=M,M=this.finishNode(F,"ChainExpression")}return M}e=M}},pp$5.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(types$1.arrow)},pp$5.parseSubscriptAsyncArrow=function(e,t,o,u){return this.parseArrowExpression(this.startNodeAt(e,t),o,!0,u)},pp$5.parseSubscript=function(e,t,o,u,f,p,g){var M=this.options.ecmaVersion>=11,F=M&&this.eat(types$1.questionDot);u&&F&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var S=this.eat(types$1.bracketL);if(S||F&&this.type!==types$1.parenL&&this.type!==types$1.backQuote||this.eat(types$1.dot)){var k=this.startNodeAt(t,o);k.object=e,S?(k.property=this.parseExpression(),this.expect(types$1.bracketR)):this.type===types$1.privateId&&e.type!=="Super"?k.property=this.parsePrivateIdent():k.property=this.parseIdent(this.options.allowReserved!=="never"),k.computed=!!S,M&&(k.optional=F),e=this.finishNode(k,"MemberExpression")}else if(!u&&this.eat(types$1.parenL)){var N=new DestructuringErrors,$=this.yieldPos,R=this.awaitPos,U=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var O=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1,N);if(f&&!F&&this.shouldParseAsyncArrow())return this.checkPatternErrors(N,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=$,this.awaitPos=R,this.awaitIdentPos=U,this.parseSubscriptAsyncArrow(t,o,O,g);this.checkExpressionErrors(N,!0),this.yieldPos=$||this.yieldPos,this.awaitPos=R||this.awaitPos,this.awaitIdentPos=U||this.awaitIdentPos;var Z=this.startNodeAt(t,o);Z.callee=e,Z.arguments=O,M&&(Z.optional=F),e=this.finishNode(Z,"CallExpression")}else if(this.type===types$1.backQuote){(F||p)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var K=this.startNodeAt(t,o);K.tag=e,K.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(K,"TaggedTemplateExpression")}return e},pp$5.parseExprAtom=function(e,t,o){this.type===types$1.slash&&this.readRegexp();var u,f=this.potentialArrowAt===this.start;switch(this.type){case types$1._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),u=this.startNode(),this.next(),this.type===types$1.parenL&&!this.allowDirectSuper&&this.raise(u.start,"super() call outside constructor of a subclass"),this.type!==types$1.dot&&this.type!==types$1.bracketL&&this.type!==types$1.parenL&&this.unexpected(),this.finishNode(u,"Super");case types$1._this:return u=this.startNode(),this.next(),this.finishNode(u,"ThisExpression");case types$1.name:var p=this.start,g=this.startLoc,M=this.containsEsc,F=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!M&&F.name==="async"&&!this.canInsertSemicolon()&&this.eat(types$1._function))return this.overrideContext(types.f_expr),this.parseFunction(this.startNodeAt(p,g),0,!1,!0,t);if(f&&!this.canInsertSemicolon()){if(this.eat(types$1.arrow))return this.parseArrowExpression(this.startNodeAt(p,g),[F],!1,t);if(this.options.ecmaVersion>=8&&F.name==="async"&&this.type===types$1.name&&!M&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return F=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(types$1.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(p,g),[F],!0,t)}return F;case types$1.regexp:var S=this.value;return u=this.parseLiteral(S.value),u.regex={pattern:S.pattern,flags:S.flags},u;case types$1.num:case types$1.string:return this.parseLiteral(this.value);case types$1._null:case types$1._true:case types$1._false:return u=this.startNode(),u.value=this.type===types$1._null?null:this.type===types$1._true,u.raw=this.type.keyword,this.next(),this.finishNode(u,"Literal");case types$1.parenL:var k=this.start,N=this.parseParenAndDistinguishExpression(f,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(N)&&(e.parenthesizedAssign=k),e.parenthesizedBind<0&&(e.parenthesizedBind=k)),N;case types$1.bracketL:return u=this.startNode(),this.next(),u.elements=this.parseExprList(types$1.bracketR,!0,!0,e),this.finishNode(u,"ArrayExpression");case types$1.braceL:return this.overrideContext(types.b_expr),this.parseObj(!1,e);case types$1._function:return u=this.startNode(),this.next(),this.parseFunction(u,0);case types$1._class:return this.parseClass(this.startNode(),!1);case types$1._new:return this.parseNew();case types$1.backQuote:return this.parseTemplate();case types$1._import:return this.options.ecmaVersion>=11?this.parseExprImport(o):this.unexpected();default:return this.parseExprAtomDefault()}},pp$5.parseExprAtomDefault=function(){this.unexpected()},pp$5.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===types$1.parenL&&!e)return this.parseDynamicImport(t);if(this.type===types$1.dot){var o=this.startNodeAt(t.start,t.loc&&t.loc.start);return o.name="import",t.meta=this.finishNode(o,"Identifier"),this.parseImportMeta(t)}else this.unexpected()},pp$5.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(types$1.parenR)?e.options=null:(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)?e.options=null:(e.options=this.parseMaybeAssign(),this.eat(types$1.parenR)||(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)||this.unexpected())));else if(!this.eat(types$1.parenR)){var t=this.start;this.eat(types$1.comma)&&this.eat(types$1.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},pp$5.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")},pp$5.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")},pp$5.parseParenExpression=function(){this.expect(types$1.parenL);var e=this.parseExpression();return this.expect(types$1.parenR),e},pp$5.shouldParseArrow=function(e){return!this.canInsertSemicolon()},pp$5.parseParenAndDistinguishExpression=function(e,t){var o=this.start,u=this.startLoc,f,p=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var g=this.start,M=this.startLoc,F=[],S=!0,k=!1,N=new DestructuringErrors,$=this.yieldPos,R=this.awaitPos,U;for(this.yieldPos=0,this.awaitPos=0;this.type!==types$1.parenR;)if(S?S=!1:this.expect(types$1.comma),p&&this.afterTrailingComma(types$1.parenR,!0)){k=!0;break}else if(this.type===types$1.ellipsis){U=this.start,F.push(this.parseParenItem(this.parseRestBinding())),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else F.push(this.parseMaybeAssign(!1,N,this.parseParenItem));var O=this.lastTokEnd,Z=this.lastTokEndLoc;if(this.expect(types$1.parenR),e&&this.shouldParseArrow(F)&&this.eat(types$1.arrow))return this.checkPatternErrors(N,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=$,this.awaitPos=R,this.parseParenArrowList(o,u,F,t);(!F.length||k)&&this.unexpected(this.lastTokStart),U&&this.unexpected(U),this.checkExpressionErrors(N,!0),this.yieldPos=$||this.yieldPos,this.awaitPos=R||this.awaitPos,F.length>1?(f=this.startNodeAt(g,M),f.expressions=F,this.finishNodeAt(f,"SequenceExpression",O,Z)):f=F[0]}else f=this.parseParenExpression();if(this.options.preserveParens){var K=this.startNodeAt(o,u);return K.expression=f,this.finishNode(K,"ParenthesizedExpression")}else return f},pp$5.parseParenItem=function(e){return e},pp$5.parseParenArrowList=function(e,t,o,u){return this.parseArrowExpression(this.startNodeAt(e,t),o,!1,u)};var empty=[];pp$5.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===types$1.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var o=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),o&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var u=this.start,f=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),u,f,!0,!1),this.eat(types$1.parenL)?e.arguments=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1):e.arguments=empty,this.finishNode(e,"NewExpression")},pp$5.parseTemplateElement=function(e){var t=e.isTagged,o=this.startNode();return this.type===types$1.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),o.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):o.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),o.tail=this.type===types$1.backQuote,this.finishNode(o,"TemplateElement")},pp$5.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var o=this.startNode();this.next(),o.expressions=[];var u=this.parseTemplateElement({isTagged:t});for(o.quasis=[u];!u.tail;)this.type===types$1.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(types$1.dollarBraceL),o.expressions.push(this.parseExpression()),this.expect(types$1.braceR),o.quasis.push(u=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(o,"TemplateLiteral")},pp$5.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===types$1.name||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$5.parseObj=function(e,t){var o=this.startNode(),u=!0,f={};for(o.properties=[],this.next();!this.eat(types$1.braceR);){if(u)u=!1;else if(this.expect(types$1.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1.braceR))break;var p=this.parseProperty(e,t);e||this.checkPropClash(p,f,t),o.properties.push(p)}return this.finishNode(o,e?"ObjectPattern":"ObjectExpression")},pp$5.parseProperty=function(e,t){var o=this.startNode(),u,f,p,g;if(this.options.ecmaVersion>=9&&this.eat(types$1.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(o.argument=this.parseMaybeAssign(!1,t),this.type===types$1.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(p=this.start,g=this.startLoc),e||(u=this.eat(types$1.star)));var M=this.containsEsc;return this.parsePropertyName(o),!e&&!M&&this.options.ecmaVersion>=8&&!u&&this.isAsyncProp(o)?(f=!0,u=this.options.ecmaVersion>=9&&this.eat(types$1.star),this.parsePropertyName(o)):f=!1,this.parsePropertyValue(o,e,u,f,p,g,t,M),this.finishNode(o,"Property")},pp$5.parseGetterSetter=function(e){var t=e.key.name;this.parsePropertyName(e),e.value=this.parseMethod(!1),e.kind=t;var o=e.kind==="get"?0:1;if(e.value.params.length!==o){var u=e.value.start;e.kind==="get"?this.raiseRecoverable(u,"getter should have no params"):this.raiseRecoverable(u,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")},pp$5.parsePropertyValue=function(e,t,o,u,f,p,g,M){(o||u)&&this.type===types$1.colon&&this.unexpected(),this.eat(types$1.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,g),e.kind="init"):this.options.ecmaVersion>=6&&this.type===types$1.parenL?(t&&this.unexpected(),e.method=!0,e.value=this.parseMethod(o,u),e.kind="init"):!t&&!M&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==types$1.comma&&this.type!==types$1.braceR&&this.type!==types$1.eq?((o||u)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((o||u)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=f),t?e.value=this.parseMaybeDefault(f,p,this.copyNode(e.key)):this.type===types$1.eq&&g?(g.shorthandAssign<0&&(g.shorthandAssign=this.start),e.value=this.parseMaybeDefault(f,p,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.kind="init",e.shorthand=!0):this.unexpected()},pp$5.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(types$1.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(types$1.bracketR),e.key;e.computed=!1}return e.key=this.type===types$1.num||this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},pp$5.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},pp$5.parseMethod=function(e,t,o){var u=this.startNode(),f=this.yieldPos,p=this.awaitPos,g=this.awaitIdentPos;return this.initFunction(u),this.options.ecmaVersion>=6&&(u.generator=e),this.options.ecmaVersion>=8&&(u.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(t,u.generator)|SCOPE_SUPER|(o?SCOPE_DIRECT_SUPER:0)),this.expect(types$1.parenL),u.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(u,!1,!0,!1),this.yieldPos=f,this.awaitPos=p,this.awaitIdentPos=g,this.finishNode(u,"FunctionExpression")},pp$5.parseArrowExpression=function(e,t,o,u){var f=this.yieldPos,p=this.awaitPos,g=this.awaitIdentPos;return this.enterScope(functionFlags(o,!1)|SCOPE_ARROW),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!o),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,u),this.yieldPos=f,this.awaitPos=p,this.awaitIdentPos=g,this.finishNode(e,"ArrowFunctionExpression")},pp$5.parseFunctionBody=function(e,t,o,u){var f=t&&this.type!==types$1.braceL,p=this.strict,g=!1;if(f)e.body=this.parseMaybeAssign(u),e.expression=!0,this.checkParams(e,!1);else{var M=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!p||M)&&(g=this.strictDirective(this.end),g&&M&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var F=this.labels;this.labels=[],g&&(this.strict=!0),this.checkParams(e,!p&&!g&&!t&&!o&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,BIND_OUTSIDE),e.body=this.parseBlock(!1,void 0,g&&!p),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=F}this.exitScope()},pp$5.isSimpleParamList=function(e){for(var t=0,o=e;t<o.length;t+=1){var u=o[t];if(u.type!=="Identifier")return!1}return!0},pp$5.checkParams=function(e,t){for(var o=Object.create(null),u=0,f=e.params;u<f.length;u+=1){var p=f[u];this.checkLValInnerPattern(p,BIND_VAR,t?null:o)}},pp$5.parseExprList=function(e,t,o,u){for(var f=[],p=!0;!this.eat(e);){if(p)p=!1;else if(this.expect(types$1.comma),t&&this.afterTrailingComma(e))break;var g=void 0;o&&this.type===types$1.comma?g=null:this.type===types$1.ellipsis?(g=this.parseSpread(u),u&&this.type===types$1.comma&&u.trailingComma<0&&(u.trailingComma=this.start)):g=this.parseMaybeAssign(!1,u),f.push(g)}return f},pp$5.checkUnreserved=function(e){var t=e.start,o=e.end,u=e.name;if(this.inGenerator&&u==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&u==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&SCOPE_VAR)&&u==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(u==="arguments"||u==="await")&&this.raise(t,"Cannot use "+u+" in class static initialization block"),this.keywords.test(u)&&this.raise(t,"Unexpected keyword '"+u+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,o).indexOf("\\")!==-1)){var f=this.strict?this.reservedWordsStrict:this.reservedWords;f.test(u)&&(!this.inAsync&&u==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+u+"' is reserved"))}},pp$5.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t},pp$5.parseIdentNode=function(){var e=this.startNode();return this.type===types$1.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=types$1.name):this.unexpected(),e},pp$5.parsePrivateIdent=function(){var e=this.startNode();return this.type===types$1.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e},pp$5.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===types$1.semi||this.canInsertSemicolon()||this.type!==types$1.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(types$1.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},pp$5.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var pp$4=Parser.prototype;pp$4.raise=function(e,t){var o=getLineInfo(this.input,e);t+=" ("+o.line+":"+o.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var u=new SyntaxError(t);throw u.pos=e,u.loc=o,u.raisedAt=this.pos,u},pp$4.raiseRecoverable=pp$4.raise,pp$4.curPosition=function(){if(this.options.locations)return new Position(this.curLine,this.pos-this.lineStart)};var pp$3=Parser.prototype,Scope=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};pp$3.enterScope=function(e){this.scopeStack.push(new Scope(e))},pp$3.exitScope=function(){this.scopeStack.pop()},pp$3.treatFunctionsAsVarInScope=function(e){return e.flags&SCOPE_FUNCTION||!this.inModule&&e.flags&SCOPE_TOP},pp$3.declareName=function(e,t,o){var u=!1;if(t===BIND_LEXICAL){var f=this.currentScope();u=f.lexical.indexOf(e)>-1||f.functions.indexOf(e)>-1||f.var.indexOf(e)>-1,f.lexical.push(e),this.inModule&&f.flags&SCOPE_TOP&&delete this.undefinedExports[e]}else if(t===BIND_SIMPLE_CATCH){var p=this.currentScope();p.lexical.push(e)}else if(t===BIND_FUNCTION){var g=this.currentScope();this.treatFunctionsAsVar?u=g.lexical.indexOf(e)>-1:u=g.lexical.indexOf(e)>-1||g.var.indexOf(e)>-1,g.functions.push(e)}else for(var M=this.scopeStack.length-1;M>=0;--M){var F=this.scopeStack[M];if(F.lexical.indexOf(e)>-1&&!(F.flags&SCOPE_SIMPLE_CATCH&&F.lexical[0]===e)||!this.treatFunctionsAsVarInScope(F)&&F.functions.indexOf(e)>-1){u=!0;break}if(F.var.push(e),this.inModule&&F.flags&SCOPE_TOP&&delete this.undefinedExports[e],F.flags&SCOPE_VAR)break}u&&this.raiseRecoverable(o,"Identifier '"+e+"' has already been declared")},pp$3.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)},pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},pp$3.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK))return t}},pp$3.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK)&&!(t.flags&SCOPE_ARROW))return t}};var Node=function(t,o,u){this.type="",this.start=o,this.end=0,t.options.locations&&(this.loc=new SourceLocation(t,u)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[o,0])},pp$2=Parser.prototype;pp$2.startNode=function(){return new Node(this,this.start,this.startLoc)},pp$2.startNodeAt=function(e,t){return new Node(this,e,t)};function finishNodeAt(e,t,o,u){return e.type=t,e.end=o,this.options.locations&&(e.loc.end=u),this.options.ranges&&(e.range[1]=o),e}pp$2.finishNode=function(e,t){return finishNodeAt.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},pp$2.finishNodeAt=function(e,t,o,u){return finishNodeAt.call(this,e,t,o,u)},pp$2.copyNode=function(e){var t=new Node(this,e.start,this.startLoc);for(var o in e)t[o]=e[o];return t};var scriptValuesAddedInUnicode="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",ecma9BinaryProperties="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ecma10BinaryProperties=ecma9BinaryProperties+" Extended_Pictographic",ecma11BinaryProperties=ecma10BinaryProperties,ecma12BinaryProperties=ecma11BinaryProperties+" EBase EComp EMod EPres ExtPict",ecma13BinaryProperties=ecma12BinaryProperties,ecma14BinaryProperties=ecma13BinaryProperties,unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties,14:ecma14BinaryProperties},ecma14BinaryPropertiesOfStrings="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",unicodeBinaryPropertiesOfStrings={9:"",10:"",11:"",12:"",13:"",14:ecma14BinaryPropertiesOfStrings},unicodeGeneralCategoryValues="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ecma9ScriptValues="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ecma10ScriptValues=ecma9ScriptValues+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ecma11ScriptValues=ecma10ScriptValues+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ecma12ScriptValues=ecma11ScriptValues+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ecma13ScriptValues=ecma12ScriptValues+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ecma14ScriptValues=ecma13ScriptValues+" "+scriptValuesAddedInUnicode,unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues,14:ecma14ScriptValues},data={};function buildUnicodeData(e){var t=data[e]={binary:wordsRegexp(unicodeBinaryProperties[e]+" "+unicodeGeneralCategoryValues),binaryOfStrings:wordsRegexp(unicodeBinaryPropertiesOfStrings[e]),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var i=0,list=[9,10,11,12,13,14];i<list.length;i+=1){var ecmaVersion=list[i];buildUnicodeData(ecmaVersion)}var pp$1=Parser.prototype,BranchID=function(t,o){this.parent=t,this.base=o||this};BranchID.prototype.separatedFrom=function(t){for(var o=this;o;o=o.parent)for(var u=t;u;u=u.parent)if(o.base===u.base&&o!==u)return!0;return!1},BranchID.prototype.sibling=function(){return new BranchID(this.parent,this.base)};var RegExpValidationState=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=data[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};RegExpValidationState.prototype.reset=function(t,o,u){var f=u.indexOf("v")!==-1,p=u.indexOf("u")!==-1;this.start=t|0,this.source=o+"",this.flags=u,f&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=p&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=p&&this.parser.options.ecmaVersion>=9)},RegExpValidationState.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},RegExpValidationState.prototype.at=function(t,o){o===void 0&&(o=!1);var u=this.source,f=u.length;if(t>=f)return-1;var p=u.charCodeAt(t);if(!(o||this.switchU)||p<=55295||p>=57344||t+1>=f)return p;var g=u.charCodeAt(t+1);return g>=56320&&g<=57343?(p<<10)+g-56613888:p},RegExpValidationState.prototype.nextIndex=function(t,o){o===void 0&&(o=!1);var u=this.source,f=u.length;if(t>=f)return f;var p=u.charCodeAt(t),g;return!(o||this.switchU)||p<=55295||p>=57344||t+1>=f||(g=u.charCodeAt(t+1))<56320||g>57343?t+1:t+2},RegExpValidationState.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)},RegExpValidationState.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},RegExpValidationState.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)},RegExpValidationState.prototype.eat=function(t,o){return o===void 0&&(o=!1),this.current(o)===t?(this.advance(o),!0):!1},RegExpValidationState.prototype.eatChars=function(t,o){o===void 0&&(o=!1);for(var u=this.pos,f=0,p=t;f<p.length;f+=1){var g=p[f],M=this.at(u,o);if(M===-1||M!==g)return!1;u=this.nextIndex(u,o)}return this.pos=u,!0},pp$1.validateRegExpFlags=function(e){for(var t=e.validFlags,o=e.flags,u=!1,f=!1,p=0;p<o.length;p++){var g=o.charAt(p);t.indexOf(g)===-1&&this.raise(e.start,"Invalid regular expression flag"),o.indexOf(g,p+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),g==="u"&&(u=!0),g==="v"&&(f=!0)}this.options.ecmaVersion>=15&&u&&f&&this.raise(e.start,"Invalid regular expression flag")};function hasProp(e){for(var t in e)return!0;return!1}pp$1.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&hasProp(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))},pp$1.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,o=e.backReferenceNames;t<o.length;t+=1){var u=o[t];e.groupNames[u]||e.raise("Invalid named capture referenced")}},pp$1.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new BranchID(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},pp$1.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},pp$1.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1},pp$1.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var o=!1;if(this.options.ecmaVersion>=9&&(o=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!o,!0}return e.pos=t,!1},pp$1.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1},pp$1.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},pp$1.regexp_eatBracedQuantifier=function(e,t){var o=e.pos;if(e.eat(123)){var u=0,f=-1;if(this.regexp_eatDecimalDigits(e)&&(u=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(f=e.lastIntValue),e.eat(125)))return f!==-1&&f<u&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=o}return!1},pp$1.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},pp$1.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},pp$1.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)){if(this.options.ecmaVersion>=16){var o=this.regexp_eatModifiers(e),u=e.eat(45);if(o||u){for(var f=0;f<o.length;f++){var p=o.charAt(f);o.indexOf(p,f+1)>-1&&e.raise("Duplicate regular expression modifiers")}if(u){var g=this.regexp_eatModifiers(e);!o&&!g&&e.current()===58&&e.raise("Invalid regular expression modifiers");for(var M=0;M<g.length;M++){var F=g.charAt(M);(g.indexOf(F,M+1)>-1||o.indexOf(F)>-1)&&e.raise("Duplicate regular expression modifiers")}}}}if(e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}}e.pos=t}return!1},pp$1.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},pp$1.regexp_eatModifiers=function(e){for(var t="",o=0;(o=e.current())!==-1&&isRegularExpressionModifier(o);)t+=codePointToString(o),e.advance();return t};function isRegularExpressionModifier(e){return e===105||e===109||e===115}pp$1.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},pp$1.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},pp$1.regexp_eatSyntaxCharacter=function(e){var t=e.current();return isSyntaxCharacter(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isSyntaxCharacter(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}pp$1.regexp_eatPatternCharacters=function(e){for(var t=e.pos,o=0;(o=e.current())!==-1&&!isSyntaxCharacter(o);)e.advance();return e.pos!==t},pp$1.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1},pp$1.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,o=e.groupNames[e.lastStringValue];if(o)if(t)for(var u=0,f=o;u<f.length;u+=1){var p=f[u];p.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(o||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}},pp$1.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},pp$1.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=codePointToString(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=codePointToString(e.lastIntValue);return!0}return!1},pp$1.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,u=e.current(o);return e.advance(o),u===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(u=e.lastIntValue),isRegExpIdentifierStart(u)?(e.lastIntValue=u,!0):(e.pos=t,!1)};function isRegExpIdentifierStart(e){return isIdentifierStart(e,!0)||e===36||e===95}pp$1.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,o=this.options.ecmaVersion>=11,u=e.current(o);return e.advance(o),u===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,o)&&(u=e.lastIntValue),isRegExpIdentifierPart(u)?(e.lastIntValue=u,!0):(e.pos=t,!1)};function isRegExpIdentifierPart(e){return isIdentifierChar(e,!0)||e===36||e===95||e===8204||e===8205}pp$1.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},pp$1.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var o=e.lastIntValue;if(e.switchU)return o>e.maxBackReference&&(e.maxBackReference=o),!0;if(o<=e.numCapturingParens)return!0;e.pos=t}return!1},pp$1.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},pp$1.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},pp$1.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},pp$1.regexp_eatZero=function(e){return e.current()===48&&!isDecimalDigit(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1},pp$1.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1},pp$1.regexp_eatControlLetter=function(e){var t=e.current();return isControlLetter(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function isControlLetter(e){return e>=65&&e<=90||e>=97&&e<=122}pp$1.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var o=e.pos,u=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var f=e.lastIntValue;if(u&&f>=55296&&f<=56319){var p=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var g=e.lastIntValue;if(g>=56320&&g<=57343)return e.lastIntValue=(f-55296)*1024+(g-56320)+65536,!0}e.pos=p,e.lastIntValue=f}return!0}if(u&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&isValidUnicode(e.lastIntValue))return!0;u&&e.raise("Invalid unicode escape"),e.pos=o}return!1};function isValidUnicode(e){return e>=0&&e<=1114111}pp$1.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1},pp$1.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var CharSetNone=0,CharSetOk=1,CharSetString=2;pp$1.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(isCharacterClassEscape(t))return e.lastIntValue=-1,e.advance(),CharSetOk;var o=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((o=t===80)||t===112)){e.lastIntValue=-1,e.advance();var u;if(e.eat(123)&&(u=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return o&&u===CharSetString&&e.raise("Invalid property name"),u;e.raise("Invalid property name")}return CharSetNone};function isCharacterClassEscape(e){return e===100||e===68||e===115||e===83||e===119||e===87}pp$1.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var o=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var u=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,o,u),CharSetOk}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var f=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,f)}return CharSetNone},pp$1.regexp_validateUnicodePropertyNameAndValue=function(e,t,o){hasOwn(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(o)||e.raise("Invalid property value")},pp$1.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return CharSetOk;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return CharSetString;e.raise("Invalid property name")},pp$1.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyNameCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyNameCharacter(e){return isControlLetter(e)||e===95}pp$1.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";isUnicodePropertyValueCharacter(t=e.current());)e.lastStringValue+=codePointToString(t),e.advance();return e.lastStringValue!==""};function isUnicodePropertyValueCharacter(e){return isUnicodePropertyNameCharacter(e)||isDecimalDigit(e)}pp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},pp$1.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),o=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&o===CharSetString&&e.raise("Negated character class may contain strings"),!0}return!1},pp$1.regexp_classContents=function(e){return e.current()===93?CharSetOk:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),CharSetOk)},pp$1.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var o=e.lastIntValue;e.switchU&&(t===-1||o===-1)&&e.raise("Invalid character class"),t!==-1&&o!==-1&&t>o&&e.raise("Range out of order in character class")}}},pp$1.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var o=e.current();(o===99||isOctalDigit(o))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var u=e.current();return u!==93?(e.lastIntValue=u,e.advance(),!0):!1},pp$1.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},pp$1.regexp_classSetExpression=function(e){var t=CharSetOk,o;if(!this.regexp_eatClassSetRange(e))if(o=this.regexp_eatClassSetOperand(e)){o===CharSetString&&(t=CharSetString);for(var u=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(o=this.regexp_eatClassSetOperand(e))){o!==CharSetString&&(t=CharSetOk);continue}e.raise("Invalid character in character class")}if(u!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(u!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(o=this.regexp_eatClassSetOperand(e),!o)return t;o===CharSetString&&(t=CharSetString)}},pp$1.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var o=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var u=e.lastIntValue;return o!==-1&&u!==-1&&o>u&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1},pp$1.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?CharSetOk:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)},pp$1.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var o=e.eat(94),u=this.regexp_classContents(e);if(e.eat(93))return o&&u===CharSetString&&e.raise("Negated character class may contain strings"),u;e.pos=t}if(e.eat(92)){var f=this.regexp_eatCharacterClassEscape(e);if(f)return f;e.pos=t}return null},pp$1.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var o=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return o}else e.raise("Invalid escape");e.pos=t}return null},pp$1.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===CharSetString&&(t=CharSetString);return t},pp$1.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?CharSetOk:CharSetString},pp$1.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var o=e.current();return o<0||o===e.lookahead()&&isClassSetReservedDoublePunctuatorCharacter(o)||isClassSetSyntaxCharacter(o)?!1:(e.advance(),e.lastIntValue=o,!0)};function isClassSetReservedDoublePunctuatorCharacter(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function isClassSetSyntaxCharacter(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}pp$1.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return isClassSetReservedPunctuator(t)?(e.lastIntValue=t,e.advance(),!0):!1};function isClassSetReservedPunctuator(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}pp$1.regexp_eatClassControlLetter=function(e){var t=e.current();return isDecimalDigit(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1},pp$1.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},pp$1.regexp_eatDecimalDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isDecimalDigit(o=e.current());)e.lastIntValue=10*e.lastIntValue+(o-48),e.advance();return e.pos!==t};function isDecimalDigit(e){return e>=48&&e<=57}pp$1.regexp_eatHexDigits=function(e){var t=e.pos,o=0;for(e.lastIntValue=0;isHexDigit(o=e.current());)e.lastIntValue=16*e.lastIntValue+hexToInt(o),e.advance();return e.pos!==t};function isHexDigit(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function hexToInt(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}pp$1.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var o=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+o*8+e.lastIntValue:e.lastIntValue=t*8+o}else e.lastIntValue=t;return!0}return!1},pp$1.regexp_eatOctalDigit=function(e){var t=e.current();return isOctalDigit(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function isOctalDigit(e){return e>=48&&e<=55}pp$1.regexp_eatFixedHexDigits=function(e,t){var o=e.pos;e.lastIntValue=0;for(var u=0;u<t;++u){var f=e.current();if(!isHexDigit(f))return e.pos=o,!1;e.lastIntValue=16*e.lastIntValue+hexToInt(f),e.advance()}return!0};var Token=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new SourceLocation(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},pp=Parser.prototype;pp.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Token(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},pp.getToken=function(){return this.next(),new Token(this)},typeof Symbol<"u"&&(pp[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===types$1.eof,value:t}}}}),pp.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(types$1.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())},pp.readToken=function(e){return isIdentifierStart(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)},pp.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888},pp.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,o=this.input.indexOf("*/",this.pos+=2);if(o===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=o+2,this.options.locations)for(var u=void 0,f=t;(u=nextLineBreak(this.input,f,this.pos))>-1;)++this.curLine,f=this.lineStart=u;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,o),t,this.pos,e,this.curPosition())},pp.skipLineComment=function(e){for(var t=this.pos,o=this.options.onComment&&this.curPosition(),u=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!isNewLine(u);)u=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,o,this.curPosition())},pp.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(e>8&&e<14||e>=5760&&nonASCIIwhitespace.test(String.fromCharCode(e)))++this.pos;else break e}}},pp.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var o=this.type;this.type=e,this.value=t,this.updateContext(o)},pp.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(types$1.ellipsis)):(++this.pos,this.finishToken(types$1.dot))},pp.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.slash,1)},pp.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),o=1,u=e===42?types$1.star:types$1.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++o,u=types$1.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(types$1.assign,o+1):this.finishOp(u,o)},pp.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var o=this.input.charCodeAt(this.pos+2);if(o===61)return this.finishOp(types$1.assign,3)}return this.finishOp(e===124?types$1.logicalOR:types$1.logicalAND,2)}return t===61?this.finishOp(types$1.assign,2):this.finishOp(e===124?types$1.bitwiseOR:types$1.bitwiseAND,1)},pp.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.bitwiseXOR,1)},pp.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(types$1.incDec,2):t===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.plusMin,1)},pp.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),o=1;return t===e?(o=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+o)===61?this.finishOp(types$1.assign,o+1):this.finishOp(types$1.bitShift,o)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(o=2),this.finishOp(types$1.relational,o))},pp.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(types$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(types$1.arrow)):this.finishOp(e===61?types$1.eq:types$1.prefix,1)},pp.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var o=this.input.charCodeAt(this.pos+2);if(o<48||o>57)return this.finishOp(types$1.questionDot,2)}if(t===63){if(e>=12){var u=this.input.charCodeAt(this.pos+2);if(u===61)return this.finishOp(types$1.assign,3)}return this.finishOp(types$1.coalesce,2)}}return this.finishOp(types$1.question,1)},pp.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),isIdentifierStart(t,!0)||t===92))return this.finishToken(types$1.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+codePointToString(t)+"'")},pp.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(types$1.parenL);case 41:return++this.pos,this.finishToken(types$1.parenR);case 59:return++this.pos,this.finishToken(types$1.semi);case 44:return++this.pos,this.finishToken(types$1.comma);case 91:return++this.pos,this.finishToken(types$1.bracketL);case 93:return++this.pos,this.finishToken(types$1.bracketR);case 123:return++this.pos,this.finishToken(types$1.braceL);case 125:return++this.pos,this.finishToken(types$1.braceR);case 58:return++this.pos,this.finishToken(types$1.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(types$1.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(types$1.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+codePointToString(e)+"'")},pp.finishOp=function(e,t){var o=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,o)},pp.readRegexp=function(){for(var e,t,o=this.pos;;){this.pos>=this.input.length&&this.raise(o,"Unterminated regular expression");var u=this.input.charAt(this.pos);if(lineBreak.test(u)&&this.raise(o,"Unterminated regular expression"),e)e=!1;else{if(u==="[")t=!0;else if(u==="]"&&t)t=!1;else if(u==="/"&&!t)break;e=u==="\\"}++this.pos}var f=this.input.slice(o,this.pos);++this.pos;var p=this.pos,g=this.readWord1();this.containsEsc&&this.unexpected(p);var M=this.regexpState||(this.regexpState=new RegExpValidationState(this));M.reset(o,f,g),this.validateRegExpFlags(M),this.validateRegExpPattern(M);var F=null;try{F=new RegExp(f,g)}catch{}return this.finishToken(types$1.regexp,{pattern:f,flags:g,value:F})},pp.readInt=function(e,t,o){for(var u=this.options.ecmaVersion>=12&&t===void 0,f=o&&this.input.charCodeAt(this.pos)===48,p=this.pos,g=0,M=0,F=0,S=t??1/0;F<S;++F,++this.pos){var k=this.input.charCodeAt(this.pos),N=void 0;if(u&&k===95){f&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),M===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),F===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),M=k;continue}if(k>=97?N=k-97+10:k>=65?N=k-65+10:k>=48&&k<=57?N=k-48:N=1/0,N>=e)break;M=k,g=g*e+N}return u&&M===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===p||t!=null&&this.pos-p!==t?null:g};function stringToNumber(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function stringToBigInt(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}pp.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var o=this.readInt(e);return o==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(o=stringToBigInt(this.input.slice(t,this.pos)),++this.pos):isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,o)},pp.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var o=this.pos-t>=2&&this.input.charCodeAt(t)===48;o&&this.strict&&this.raise(t,"Invalid number");var u=this.input.charCodeAt(this.pos);if(!o&&!e&&this.options.ecmaVersion>=11&&u===110){var f=stringToBigInt(this.input.slice(t,this.pos));return++this.pos,isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,f)}o&&/[89]/.test(this.input.slice(t,this.pos))&&(o=!1),u===46&&!o&&(++this.pos,this.readInt(10),u=this.input.charCodeAt(this.pos)),(u===69||u===101)&&!o&&(u=this.input.charCodeAt(++this.pos),(u===43||u===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var p=stringToNumber(this.input.slice(t,this.pos),o);return this.finishToken(types$1.num,p)},pp.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var o=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(o,"Code point out of bounds")}else t=this.readHexChar(4);return t},pp.readString=function(e){for(var t="",o=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var u=this.input.charCodeAt(this.pos);if(u===e)break;u===92?(t+=this.input.slice(o,this.pos),t+=this.readEscapedChar(!1),o=this.pos):u===8232||u===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(isNewLine(u)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(o,this.pos++),this.finishToken(types$1.string,t)};var INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===INVALID_TEMPLATE_ESCAPE_ERROR)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1},pp.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw INVALID_TEMPLATE_ESCAPE_ERROR;this.raise(e,t)},pp.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var o=this.input.charCodeAt(this.pos);if(o===96||o===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===types$1.template||this.type===types$1.invalidTemplate)?o===36?(this.pos+=2,this.finishToken(types$1.dollarBraceL)):(++this.pos,this.finishToken(types$1.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(types$1.template,e));if(o===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(isNewLine(o)){switch(e+=this.input.slice(t,this.pos),++this.pos,o){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(o);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},pp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(types$1.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},pp.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return codePointToString(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var o=this.pos-1;this.invalidStringToken(o,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var u=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],f=parseInt(u,8);return f>255&&(u=u.slice(0,-1),f=parseInt(u,8)),this.pos+=u.length-1,t=this.input.charCodeAt(this.pos),(u!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-u.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(f)}return isNewLine(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}},pp.readHexChar=function(e){var t=this.pos,o=this.readInt(16,e);return o===null&&this.invalidStringToken(t,"Bad character escape sequence"),o},pp.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,o=this.pos,u=this.options.ecmaVersion>=6;this.pos<this.input.length;){var f=this.fullCharCodeAtPos();if(isIdentifierChar(f,u))this.pos+=f<=65535?1:2;else if(f===92){this.containsEsc=!0,e+=this.input.slice(o,this.pos);var p=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var g=this.readCodePoint();(t?isIdentifierStart:isIdentifierChar)(g,u)||this.invalidStringToken(p,"Invalid Unicode escape"),e+=codePointToString(g),o=this.pos}else break;t=!1}return e+this.input.slice(o,this.pos)},pp.readWord=function(){var e=this.readWord1(),t=types$1.name;return this.keywords.test(e)&&(t=keywords[e]),this.finishToken(t,e)};var version$1="8.15.0";Parser.acorn={Parser,version:version$1,defaultOptions,Position,SourceLocation,getLineInfo,Node,TokenType,tokTypes:types$1,keywordTypes:keywords,TokContext,tokContexts:types,isIdentifierChar,isIdentifierStart,Token,isNewLine,lineBreak,lineBreakG,nonASCIIwhitespace};function parse$a(e,t){return Parser.parse(e,t)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var o=function u(){var f=!1;try{f=this instanceof u}catch{}return f?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var f=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(o,u,f.get?f:{enumerable:!0,get:function(){return e[u]}})}),o}var escodegen$1={},estraverse={},hasRequiredEstraverse;function requireEstraverse(){return hasRequiredEstraverse||(hasRequiredEstraverse=1,(function(e){(function t(o){var u,f,p,g,M,F;function S(re){var ue={},ve,Ae;for(ve in re)re.hasOwnProperty(ve)&&(Ae=re[ve],typeof Ae=="object"&&Ae!==null?ue[ve]=S(Ae):ue[ve]=Ae);return ue}function k(re,ue){var ve,Ae,Fe,we;for(Ae=re.length,Fe=0;Ae;)ve=Ae>>>1,we=Fe+ve,ue(re[we])?Ae=ve:(Fe=we+1,Ae-=ve+1);return Fe}u={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},p={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},g={},M={},F={},f={Break:g,Skip:M,Remove:F};function N(re,ue){this.parent=re,this.key=ue}N.prototype.replace=function(ue){this.parent[this.key]=ue},N.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function $(re,ue,ve,Ae){this.node=re,this.path=ue,this.wrap=ve,this.ref=Ae}function R(){}R.prototype.path=function(){var ue,ve,Ae,Fe,we,Ce;function be(le,Ze){if(Array.isArray(Ze))for(Ae=0,Fe=Ze.length;Ae<Fe;++Ae)le.push(Ze[Ae]);else le.push(Ze)}if(!this.__current.path)return null;for(we=[],ue=2,ve=this.__leavelist.length;ue<ve;++ue)Ce=this.__leavelist[ue],be(we,Ce.path);return be(we,this.__current.path),we},R.prototype.type=function(){var re=this.current();return re.type||this.__current.wrap},R.prototype.parents=function(){var ue,ve,Ae;for(Ae=[],ue=1,ve=this.__leavelist.length;ue<ve;++ue)Ae.push(this.__leavelist[ue].node);return Ae},R.prototype.current=function(){return this.__current.node},R.prototype.__execute=function(ue,ve){var Ae,Fe;return Fe=void 0,Ae=this.__current,this.__current=ve,this.__state=null,ue&&(Fe=ue.call(this,ve.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=Ae,Fe},R.prototype.notify=function(ue){this.__state=ue},R.prototype.skip=function(){this.notify(M)},R.prototype.break=function(){this.notify(g)},R.prototype.remove=function(){this.notify(F)},R.prototype.__initialize=function(re,ue){this.visitor=ue,this.root=re,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,ue.fallback==="iteration"?this.__fallback=Object.keys:typeof ue.fallback=="function"&&(this.__fallback=ue.fallback),this.__keys=p,ue.keys&&(this.__keys=Object.assign(Object.create(this.__keys),ue.keys))};function U(re){return re==null?!1:typeof re=="object"&&typeof re.type=="string"}function O(re,ue){return(re===u.ObjectExpression||re===u.ObjectPattern)&&ue==="properties"}function Z(re,ue){for(var ve=re.length-1;ve>=0;--ve)if(re[ve].node===ue)return!0;return!1}R.prototype.traverse=function(ue,ve){var Ae,Fe,we,Ce,be,le,Ze,Je,Qe,rt,tt,kt;for(this.__initialize(ue,ve),kt={},Ae=this.__worklist,Fe=this.__leavelist,Ae.push(new $(ue,null,null,null)),Fe.push(new $(null,null,null,null));Ae.length;){if(we=Ae.pop(),we===kt){if(we=Fe.pop(),le=this.__execute(ve.leave,we),this.__state===g||le===g)return;continue}if(we.node){if(le=this.__execute(ve.enter,we),this.__state===g||le===g)return;if(Ae.push(kt),Fe.push(we),this.__state===M||le===M)continue;if(Ce=we.node,be=Ce.type||we.wrap,rt=this.__keys[be],!rt)if(this.__fallback)rt=this.__fallback(Ce);else throw new Error("Unknown node type "+be+".");for(Je=rt.length;(Je-=1)>=0;)if(Ze=rt[Je],tt=Ce[Ze],!!tt){if(Array.isArray(tt)){for(Qe=tt.length;(Qe-=1)>=0;)if(tt[Qe]&&!Z(Fe,tt[Qe])){if(O(be,rt[Je]))we=new $(tt[Qe],[Ze,Qe],"Property",null);else if(U(tt[Qe]))we=new $(tt[Qe],[Ze,Qe],null,null);else continue;Ae.push(we)}}else if(U(tt)){if(Z(Fe,tt))continue;Ae.push(new $(tt,Ze,null,null))}}}}},R.prototype.replace=function(ue,ve){var Ae,Fe,we,Ce,be,le,Ze,Je,Qe,rt,tt,kt,Lt;function Tt(ke){var at,je,Ie,nt;if(ke.ref.remove()){for(je=ke.ref.key,nt=ke.ref.parent,at=Ae.length;at--;)if(Ie=Ae[at],Ie.ref&&Ie.ref.parent===nt){if(Ie.ref.key<je)break;--Ie.ref.key}}}for(this.__initialize(ue,ve),tt={},Ae=this.__worklist,Fe=this.__leavelist,kt={root:ue},le=new $(ue,null,null,new N(kt,"root")),Ae.push(le),Fe.push(le);Ae.length;){if(le=Ae.pop(),le===tt){if(le=Fe.pop(),be=this.__execute(ve.leave,le),be!==void 0&&be!==g&&be!==M&&be!==F&&le.ref.replace(be),(this.__state===F||be===F)&&Tt(le),this.__state===g||be===g)return kt.root;continue}if(be=this.__execute(ve.enter,le),be!==void 0&&be!==g&&be!==M&&be!==F&&(le.ref.replace(be),le.node=be),(this.__state===F||be===F)&&(Tt(le),le.node=null),this.__state===g||be===g)return kt.root;if(we=le.node,!!we&&(Ae.push(tt),Fe.push(le),!(this.__state===M||be===M))){if(Ce=we.type||le.wrap,Qe=this.__keys[Ce],!Qe)if(this.__fallback)Qe=this.__fallback(we);else throw new Error("Unknown node type "+Ce+".");for(Ze=Qe.length;(Ze-=1)>=0;)if(Lt=Qe[Ze],rt=we[Lt],!!rt)if(Array.isArray(rt)){for(Je=rt.length;(Je-=1)>=0;)if(rt[Je]){if(O(Ce,Qe[Ze]))le=new $(rt[Je],[Lt,Je],"Property",new N(rt,Je));else if(U(rt[Je]))le=new $(rt[Je],[Lt,Je],null,new N(rt,Je));else continue;Ae.push(le)}}else U(rt)&&Ae.push(new $(rt,Lt,null,new N(we,Lt)))}}return kt.root};function K(re,ue){var ve=new R;return ve.traverse(re,ue)}function ie(re,ue){var ve=new R;return ve.replace(re,ue)}function de(re,ue){var ve;return ve=k(ue,function(Fe){return Fe.range[0]>re.range[0]}),re.extendedRange=[re.range[0],re.range[1]],ve!==ue.length&&(re.extendedRange[1]=ue[ve].range[0]),ve-=1,ve>=0&&(re.extendedRange[0]=ue[ve].range[1]),re}function te(re,ue,ve){var Ae=[],Fe,we,Ce,be;if(!re.range)throw new Error("attachComments needs range information");if(!ve.length){if(ue.length){for(Ce=0,we=ue.length;Ce<we;Ce+=1)Fe=S(ue[Ce]),Fe.extendedRange=[0,re.range[0]],Ae.push(Fe);re.leadingComments=Ae}return re}for(Ce=0,we=ue.length;Ce<we;Ce+=1)Ae.push(de(S(ue[Ce]),ve));return be=0,K(re,{enter:function(le){for(var Ze;be<Ae.length&&(Ze=Ae[be],!(Ze.extendedRange[1]>le.range[0]));)Ze.extendedRange[1]===le.range[0]?(le.leadingComments||(le.leadingComments=[]),le.leadingComments.push(Ze),Ae.splice(be,1)):be+=1;if(be===Ae.length)return f.Break;if(Ae[be].extendedRange[0]>le.range[1])return f.Skip}}),be=0,K(re,{leave:function(le){for(var Ze;be<Ae.length&&(Ze=Ae[be],!(le.range[1]<Ze.extendedRange[0]));)le.range[1]===Ze.extendedRange[0]?(le.trailingComments||(le.trailingComments=[]),le.trailingComments.push(Ze),Ae.splice(be,1)):be+=1;if(be===Ae.length)return f.Break;if(Ae[be].extendedRange[0]>le.range[1])return f.Skip}}),re}return o.Syntax=u,o.traverse=K,o.replace=ie,o.attachComments=te,o.VisitorKeys=p,o.VisitorOption=f,o.Controller=R,o.cloneEnvironment=function(){return t({})},o})(e)})(estraverse)),estraverse}var utils={},ast={exports:{}},hasRequiredAst;function requireAst(){return hasRequiredAst||(hasRequiredAst=1,(function(){function e(g){if(g==null)return!1;switch(g.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(g){if(g==null)return!1;switch(g.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function o(g){if(g==null)return!1;switch(g.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function u(g){return o(g)||g!=null&&g.type==="FunctionDeclaration"}function f(g){switch(g.type){case"IfStatement":return g.alternate!=null?g.alternate:g.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return g.body}return null}function p(g){var M;if(g.type!=="IfStatement"||g.alternate==null)return!1;M=g.consequent;do{if(M.type==="IfStatement"&&M.alternate==null)return!0;M=f(M)}while(M);return!1}ast.exports={isExpression:e,isStatement:o,isIterationStatement:t,isSourceElement:u,isProblematicIfStatement:p,trailingStatement:f}})()),ast.exports}var code={exports:{}},hasRequiredCode;function requireCode(){return hasRequiredCode||(hasRequiredCode=1,(function(){var e,t,o,u,f,p;t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function g(Z){return 48<=Z&&Z<=57}function M(Z){return 48<=Z&&Z<=57||97<=Z&&Z<=102||65<=Z&&Z<=70}function F(Z){return Z>=48&&Z<=55}o=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function S(Z){return Z===32||Z===9||Z===11||Z===12||Z===160||Z>=5760&&o.indexOf(Z)>=0}function k(Z){return Z===10||Z===13||Z===8232||Z===8233}function N(Z){if(Z<=65535)return String.fromCharCode(Z);var K=String.fromCharCode(Math.floor((Z-65536)/1024)+55296),ie=String.fromCharCode((Z-65536)%1024+56320);return K+ie}for(u=new Array(128),p=0;p<128;++p)u[p]=p>=97&&p<=122||p>=65&&p<=90||p===36||p===95;for(f=new Array(128),p=0;p<128;++p)f[p]=p>=97&&p<=122||p>=65&&p<=90||p>=48&&p<=57||p===36||p===95;function $(Z){return Z<128?u[Z]:t.NonAsciiIdentifierStart.test(N(Z))}function R(Z){return Z<128?f[Z]:t.NonAsciiIdentifierPart.test(N(Z))}function U(Z){return Z<128?u[Z]:e.NonAsciiIdentifierStart.test(N(Z))}function O(Z){return Z<128?f[Z]:e.NonAsciiIdentifierPart.test(N(Z))}code.exports={isDecimalDigit:g,isHexDigit:M,isOctalDigit:F,isWhiteSpace:S,isLineTerminator:k,isIdentifierStartES5:$,isIdentifierPartES5:R,isIdentifierStartES6:U,isIdentifierPartES6:O}})()),code.exports}var keyword={exports:{}},hasRequiredKeyword;function requireKeyword(){return hasRequiredKeyword||(hasRequiredKeyword=1,(function(){var e=requireCode();function t($){switch($){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function o($,R){return!R&&$==="yield"?!1:u($,R)}function u($,R){if(R&&t($))return!0;switch($.length){case 2:return $==="if"||$==="in"||$==="do";case 3:return $==="var"||$==="for"||$==="new"||$==="try";case 4:return $==="this"||$==="else"||$==="case"||$==="void"||$==="with"||$==="enum";case 5:return $==="while"||$==="break"||$==="catch"||$==="throw"||$==="const"||$==="yield"||$==="class"||$==="super";case 6:return $==="return"||$==="typeof"||$==="delete"||$==="switch"||$==="export"||$==="import";case 7:return $==="default"||$==="finally"||$==="extends";case 8:return $==="function"||$==="continue"||$==="debugger";case 10:return $==="instanceof";default:return!1}}function f($,R){return $==="null"||$==="true"||$==="false"||o($,R)}function p($,R){return $==="null"||$==="true"||$==="false"||u($,R)}function g($){return $==="eval"||$==="arguments"}function M($){var R,U,O;if($.length===0||(O=$.charCodeAt(0),!e.isIdentifierStartES5(O)))return!1;for(R=1,U=$.length;R<U;++R)if(O=$.charCodeAt(R),!e.isIdentifierPartES5(O))return!1;return!0}function F($,R){return($-55296)*1024+(R-56320)+65536}function S($){var R,U,O,Z,K;if($.length===0)return!1;for(K=e.isIdentifierStartES6,R=0,U=$.length;R<U;++R){if(O=$.charCodeAt(R),55296<=O&&O<=56319){if(++R,R>=U||(Z=$.charCodeAt(R),!(56320<=Z&&Z<=57343)))return!1;O=F(O,Z)}if(!K(O))return!1;K=e.isIdentifierPartES6}return!0}function k($,R){return M($)&&!f($,R)}function N($,R){return S($)&&!p($,R)}keyword.exports={isKeywordES5:o,isKeywordES6:u,isReservedWordES5:f,isReservedWordES6:p,isRestrictedWord:g,isIdentifierNameES5:M,isIdentifierNameES6:S,isIdentifierES5:k,isIdentifierES6:N}})()),keyword.exports}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(){utils.ast=requireAst(),utils.code=requireCode(),utils.keyword=requireKeyword()})()),utils}var sourceMap={},sourceMapGenerator={},base64Vlq={},base64={},hasRequiredBase64;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},base64.decode=function(t){var o=65,u=90,f=97,p=122,g=48,M=57,F=43,S=47,k=26,N=52;return o<=t&&t<=u?t-o:f<=t&&t<=p?t-f+k:g<=t&&t<=M?t-g+N:t==F?62:t==S?63:-1},base64}var hasRequiredBase64Vlq;function requireBase64Vlq(){if(hasRequiredBase64Vlq)return base64Vlq;hasRequiredBase64Vlq=1;var e=requireBase64(),t=5,o=1<<t,u=o-1,f=o;function p(M){return M<0?(-M<<1)+1:(M<<1)+0}function g(M){var F=(M&1)===1,S=M>>1;return F?-S:S}return base64Vlq.encode=function(F){var S="",k,N=p(F);do k=N&u,N>>>=t,N>0&&(k|=f),S+=e.encode(k);while(N>0);return S},base64Vlq.decode=function(F,S,k){var N=F.length,$=0,R=0,U,O;do{if(S>=N)throw new Error("Expected more digits in base 64 VLQ value.");if(O=e.decode(F.charCodeAt(S++)),O===-1)throw new Error("Invalid base64 digit: "+F.charAt(S-1));U=!!(O&f),O&=u,$=$+(O<<R),R+=t}while(U);k.value=g($),k.rest=S},base64Vlq}var util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(e){function t(te,re,ue){if(re in te)return te[re];if(arguments.length===3)return ue;throw new Error('"'+re+'" is a required argument.')}e.getArg=t;var o=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,u=/^data:.+\,.+$/;function f(te){var re=te.match(o);return re?{scheme:re[1],auth:re[2],host:re[3],port:re[4],path:re[5]}:null}e.urlParse=f;function p(te){var re="";return te.scheme&&(re+=te.scheme+":"),re+="//",te.auth&&(re+=te.auth+"@"),te.host&&(re+=te.host),te.port&&(re+=":"+te.port),te.path&&(re+=te.path),re}e.urlGenerate=p;function g(te){var re=te,ue=f(te);if(ue){if(!ue.path)return te;re=ue.path}for(var ve=e.isAbsolute(re),Ae=re.split(/\/+/),Fe,we=0,Ce=Ae.length-1;Ce>=0;Ce--)Fe=Ae[Ce],Fe==="."?Ae.splice(Ce,1):Fe===".."?we++:we>0&&(Fe===""?(Ae.splice(Ce+1,we),we=0):(Ae.splice(Ce,2),we--));return re=Ae.join("/"),re===""&&(re=ve?"/":"."),ue?(ue.path=re,p(ue)):re}e.normalize=g;function M(te,re){te===""&&(te="."),re===""&&(re=".");var ue=f(re),ve=f(te);if(ve&&(te=ve.path||"/"),ue&&!ue.scheme)return ve&&(ue.scheme=ve.scheme),p(ue);if(ue||re.match(u))return re;if(ve&&!ve.host&&!ve.path)return ve.host=re,p(ve);var Ae=re.charAt(0)==="/"?re:g(te.replace(/\/+$/,"")+"/"+re);return ve?(ve.path=Ae,p(ve)):Ae}e.join=M,e.isAbsolute=function(te){return te.charAt(0)==="/"||o.test(te)};function F(te,re){te===""&&(te="."),te=te.replace(/\/$/,"");for(var ue=0;re.indexOf(te+"/")!==0;){var ve=te.lastIndexOf("/");if(ve<0||(te=te.slice(0,ve),te.match(/^([^\/]+:\/)?\/*$/)))return re;++ue}return Array(ue+1).join("../")+re.substr(te.length+1)}e.relative=F;var S=(function(){var te=Object.create(null);return!("__proto__"in te)})();function k(te){return te}function N(te){return R(te)?"$"+te:te}e.toSetString=S?k:N;function $(te){return R(te)?te.slice(1):te}e.fromSetString=S?k:$;function R(te){if(!te)return!1;var re=te.length;if(re<9||te.charCodeAt(re-1)!==95||te.charCodeAt(re-2)!==95||te.charCodeAt(re-3)!==111||te.charCodeAt(re-4)!==116||te.charCodeAt(re-5)!==111||te.charCodeAt(re-6)!==114||te.charCodeAt(re-7)!==112||te.charCodeAt(re-8)!==95||te.charCodeAt(re-9)!==95)return!1;for(var ue=re-10;ue>=0;ue--)if(te.charCodeAt(ue)!==36)return!1;return!0}function U(te,re,ue){var ve=Z(te.source,re.source);return ve!==0||(ve=te.originalLine-re.originalLine,ve!==0)||(ve=te.originalColumn-re.originalColumn,ve!==0||ue)||(ve=te.generatedColumn-re.generatedColumn,ve!==0)||(ve=te.generatedLine-re.generatedLine,ve!==0)?ve:Z(te.name,re.name)}e.compareByOriginalPositions=U;function O(te,re,ue){var ve=te.generatedLine-re.generatedLine;return ve!==0||(ve=te.generatedColumn-re.generatedColumn,ve!==0||ue)||(ve=Z(te.source,re.source),ve!==0)||(ve=te.originalLine-re.originalLine,ve!==0)||(ve=te.originalColumn-re.originalColumn,ve!==0)?ve:Z(te.name,re.name)}e.compareByGeneratedPositionsDeflated=O;function Z(te,re){return te===re?0:te===null?1:re===null?-1:te>re?1:-1}function K(te,re){var ue=te.generatedLine-re.generatedLine;return ue!==0||(ue=te.generatedColumn-re.generatedColumn,ue!==0)||(ue=Z(te.source,re.source),ue!==0)||(ue=te.originalLine-re.originalLine,ue!==0)||(ue=te.originalColumn-re.originalColumn,ue!==0)?ue:Z(te.name,re.name)}e.compareByGeneratedPositionsInflated=K;function ie(te){return JSON.parse(te.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=ie;function de(te,re,ue){if(re=re||"",te&&(te[te.length-1]!=="/"&&re[0]!=="/"&&(te+="/"),re=te+re),ue){var ve=f(ue);if(!ve)throw new Error("sourceMapURL could not be parsed");if(ve.path){var Ae=ve.path.lastIndexOf("/");Ae>=0&&(ve.path=ve.path.substring(0,Ae+1))}re=M(p(ve),re)}return g(re)}e.computeSourceURL=de})(util)),util}var arraySet={},hasRequiredArraySet;function requireArraySet(){if(hasRequiredArraySet)return arraySet;hasRequiredArraySet=1;var e=requireUtil(),t=Object.prototype.hasOwnProperty,o=typeof Map<"u";function u(){this._array=[],this._set=o?new Map:Object.create(null)}return u.fromArray=function(p,g){for(var M=new u,F=0,S=p.length;F<S;F++)M.add(p[F],g);return M},u.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},u.prototype.add=function(p,g){var M=o?p:e.toSetString(p),F=o?this.has(p):t.call(this._set,M),S=this._array.length;(!F||g)&&this._array.push(p),F||(o?this._set.set(p,S):this._set[M]=S)},u.prototype.has=function(p){if(o)return this._set.has(p);var g=e.toSetString(p);return t.call(this._set,g)},u.prototype.indexOf=function(p){if(o){var g=this._set.get(p);if(g>=0)return g}else{var M=e.toSetString(p);if(t.call(this._set,M))return this._set[M]}throw new Error('"'+p+'" is not in the set.')},u.prototype.at=function(p){if(p>=0&&p<this._array.length)return this._array[p];throw new Error("No element indexed by "+p)},u.prototype.toArray=function(){return this._array.slice()},arraySet.ArraySet=u,arraySet}var mappingList={},hasRequiredMappingList;function requireMappingList(){if(hasRequiredMappingList)return mappingList;hasRequiredMappingList=1;var e=requireUtil();function t(u,f){var p=u.generatedLine,g=f.generatedLine,M=u.generatedColumn,F=f.generatedColumn;return g>p||g==p&&F>=M||e.compareByGeneratedPositionsInflated(u,f)<=0}function o(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return o.prototype.unsortedForEach=function(f,p){this._array.forEach(f,p)},o.prototype.add=function(f){t(this._last,f)?(this._last=f,this._array.push(f)):(this._sorted=!1,this._array.push(f))},o.prototype.toArray=function(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},mappingList.MappingList=o,mappingList}var hasRequiredSourceMapGenerator;function requireSourceMapGenerator(){if(hasRequiredSourceMapGenerator)return sourceMapGenerator;hasRequiredSourceMapGenerator=1;var e=requireBase64Vlq(),t=requireUtil(),o=requireArraySet().ArraySet,u=requireMappingList().MappingList;function f(p){p||(p={}),this._file=t.getArg(p,"file",null),this._sourceRoot=t.getArg(p,"sourceRoot",null),this._skipValidation=t.getArg(p,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new u,this._sourcesContents=null}return f.prototype._version=3,f.fromSourceMap=function(g){var M=g.sourceRoot,F=new f({file:g.file,sourceRoot:M});return g.eachMapping(function(S){var k={generated:{line:S.generatedLine,column:S.generatedColumn}};S.source!=null&&(k.source=S.source,M!=null&&(k.source=t.relative(M,k.source)),k.original={line:S.originalLine,column:S.originalColumn},S.name!=null&&(k.name=S.name)),F.addMapping(k)}),g.sources.forEach(function(S){var k=S;M!==null&&(k=t.relative(M,S)),F._sources.has(k)||F._sources.add(k);var N=g.sourceContentFor(S);N!=null&&F.setSourceContent(S,N)}),F},f.prototype.addMapping=function(g){var M=t.getArg(g,"generated"),F=t.getArg(g,"original",null),S=t.getArg(g,"source",null),k=t.getArg(g,"name",null);this._skipValidation||this._validateMapping(M,F,S,k),S!=null&&(S=String(S),this._sources.has(S)||this._sources.add(S)),k!=null&&(k=String(k),this._names.has(k)||this._names.add(k)),this._mappings.add({generatedLine:M.line,generatedColumn:M.column,originalLine:F!=null&&F.line,originalColumn:F!=null&&F.column,source:S,name:k})},f.prototype.setSourceContent=function(g,M){var F=g;this._sourceRoot!=null&&(F=t.relative(this._sourceRoot,F)),M!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(F)]=M):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(F)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},f.prototype.applySourceMap=function(g,M,F){var S=M;if(M==null){if(g.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);S=g.file}var k=this._sourceRoot;k!=null&&(S=t.relative(k,S));var N=new o,$=new o;this._mappings.unsortedForEach(function(R){if(R.source===S&&R.originalLine!=null){var U=g.originalPositionFor({line:R.originalLine,column:R.originalColumn});U.source!=null&&(R.source=U.source,F!=null&&(R.source=t.join(F,R.source)),k!=null&&(R.source=t.relative(k,R.source)),R.originalLine=U.line,R.originalColumn=U.column,U.name!=null&&(R.name=U.name))}var O=R.source;O!=null&&!N.has(O)&&N.add(O);var Z=R.name;Z!=null&&!$.has(Z)&&$.add(Z)},this),this._sources=N,this._names=$,g.sources.forEach(function(R){var U=g.sourceContentFor(R);U!=null&&(F!=null&&(R=t.join(F,R)),k!=null&&(R=t.relative(k,R)),this.setSourceContent(R,U))},this)},f.prototype._validateMapping=function(g,M,F,S){if(M&&typeof M.line!="number"&&typeof M.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(g&&"line"in g&&"column"in g&&g.line>0&&g.column>=0&&!M&&!F&&!S)){if(g&&"line"in g&&"column"in g&&M&&"line"in M&&"column"in M&&g.line>0&&g.column>=0&&M.line>0&&M.column>=0&&F)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:g,source:F,original:M,name:S}))}},f.prototype._serializeMappings=function(){for(var g=0,M=1,F=0,S=0,k=0,N=0,$="",R,U,O,Z,K=this._mappings.toArray(),ie=0,de=K.length;ie<de;ie++){if(U=K[ie],R="",U.generatedLine!==M)for(g=0;U.generatedLine!==M;)R+=";",M++;else if(ie>0){if(!t.compareByGeneratedPositionsInflated(U,K[ie-1]))continue;R+=","}R+=e.encode(U.generatedColumn-g),g=U.generatedColumn,U.source!=null&&(Z=this._sources.indexOf(U.source),R+=e.encode(Z-N),N=Z,R+=e.encode(U.originalLine-1-S),S=U.originalLine-1,R+=e.encode(U.originalColumn-F),F=U.originalColumn,U.name!=null&&(O=this._names.indexOf(U.name),R+=e.encode(O-k),k=O)),$+=R}return $},f.prototype._generateSourcesContent=function(g,M){return g.map(function(F){if(!this._sourcesContents)return null;M!=null&&(F=t.relative(M,F));var S=t.toSetString(F);return Object.prototype.hasOwnProperty.call(this._sourcesContents,S)?this._sourcesContents[S]:null},this)},f.prototype.toJSON=function(){var g={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(g.file=this._file),this._sourceRoot!=null&&(g.sourceRoot=this._sourceRoot),this._sourcesContents&&(g.sourcesContent=this._generateSourcesContent(g.sources,g.sourceRoot)),g},f.prototype.toString=function(){return JSON.stringify(this.toJSON())},sourceMapGenerator.SourceMapGenerator=f,sourceMapGenerator}var sourceMapConsumer={},binarySearch={},hasRequiredBinarySearch;function requireBinarySearch(){return hasRequiredBinarySearch||(hasRequiredBinarySearch=1,(function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(o,u,f,p,g,M){var F=Math.floor((u-o)/2)+o,S=g(f,p[F],!0);return S===0?F:S>0?u-F>1?t(F,u,f,p,g,M):M==e.LEAST_UPPER_BOUND?u<p.length?u:-1:F:F-o>1?t(o,F,f,p,g,M):M==e.LEAST_UPPER_BOUND?F:o<0?-1:o}e.search=function(u,f,p,g){if(f.length===0)return-1;var M=t(-1,f.length,u,f,p,g||e.GREATEST_LOWER_BOUND);if(M<0)return-1;for(;M-1>=0&&p(f[M],f[M-1],!0)===0;)--M;return M}})(binarySearch)),binarySearch}var quickSort={},hasRequiredQuickSort;function requireQuickSort(){if(hasRequiredQuickSort)return quickSort;hasRequiredQuickSort=1;function e(u,f,p){var g=u[f];u[f]=u[p],u[p]=g}function t(u,f){return Math.round(u+Math.random()*(f-u))}function o(u,f,p,g){if(p<g){var M=t(p,g),F=p-1;e(u,M,g);for(var S=u[g],k=p;k<g;k++)f(u[k],S)<=0&&(F+=1,e(u,F,k));e(u,F+1,k);var N=F+1;o(u,f,p,N-1),o(u,f,N+1,g)}}return quickSort.quickSort=function(u,f){o(u,f,0,u.length-1)},quickSort}var hasRequiredSourceMapConsumer;function requireSourceMapConsumer(){if(hasRequiredSourceMapConsumer)return sourceMapConsumer;hasRequiredSourceMapConsumer=1;var e=requireUtil(),t=requireBinarySearch(),o=requireArraySet().ArraySet,u=requireBase64Vlq(),f=requireQuickSort().quickSort;function p(S,k){var N=S;return typeof S=="string"&&(N=e.parseSourceMapInput(S)),N.sections!=null?new F(N,k):new g(N,k)}p.fromSourceMap=function(S,k){return g.fromSourceMap(S,k)},p.prototype._version=3,p.prototype.__generatedMappings=null,Object.defineProperty(p.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),p.prototype.__originalMappings=null,Object.defineProperty(p.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),p.prototype._charIsMappingSeparator=function(k,N){var $=k.charAt(N);return $===";"||$===","},p.prototype._parseMappings=function(k,N){throw new Error("Subclasses must implement _parseMappings")},p.GENERATED_ORDER=1,p.ORIGINAL_ORDER=2,p.GREATEST_LOWER_BOUND=1,p.LEAST_UPPER_BOUND=2,p.prototype.eachMapping=function(k,N,$){var R=N||null,U=$||p.GENERATED_ORDER,O;switch(U){case p.GENERATED_ORDER:O=this._generatedMappings;break;case p.ORIGINAL_ORDER:O=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var Z=this.sourceRoot;O.map(function(K){var ie=K.source===null?null:this._sources.at(K.source);return ie=e.computeSourceURL(Z,ie,this._sourceMapURL),{source:ie,generatedLine:K.generatedLine,generatedColumn:K.generatedColumn,originalLine:K.originalLine,originalColumn:K.originalColumn,name:K.name===null?null:this._names.at(K.name)}},this).forEach(k,R)},p.prototype.allGeneratedPositionsFor=function(k){var N=e.getArg(k,"line"),$={source:e.getArg(k,"source"),originalLine:N,originalColumn:e.getArg(k,"column",0)};if($.source=this._findSourceIndex($.source),$.source<0)return[];var R=[],U=this._findMapping($,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(U>=0){var O=this._originalMappings[U];if(k.column===void 0)for(var Z=O.originalLine;O&&O.originalLine===Z;)R.push({line:e.getArg(O,"generatedLine",null),column:e.getArg(O,"generatedColumn",null),lastColumn:e.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++U];else for(var K=O.originalColumn;O&&O.originalLine===N&&O.originalColumn==K;)R.push({line:e.getArg(O,"generatedLine",null),column:e.getArg(O,"generatedColumn",null),lastColumn:e.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++U]}return R},sourceMapConsumer.SourceMapConsumer=p;function g(S,k){var N=S;typeof S=="string"&&(N=e.parseSourceMapInput(S));var $=e.getArg(N,"version"),R=e.getArg(N,"sources"),U=e.getArg(N,"names",[]),O=e.getArg(N,"sourceRoot",null),Z=e.getArg(N,"sourcesContent",null),K=e.getArg(N,"mappings"),ie=e.getArg(N,"file",null);if($!=this._version)throw new Error("Unsupported version: "+$);O&&(O=e.normalize(O)),R=R.map(String).map(e.normalize).map(function(de){return O&&e.isAbsolute(O)&&e.isAbsolute(de)?e.relative(O,de):de}),this._names=o.fromArray(U.map(String),!0),this._sources=o.fromArray(R,!0),this._absoluteSources=this._sources.toArray().map(function(de){return e.computeSourceURL(O,de,k)}),this.sourceRoot=O,this.sourcesContent=Z,this._mappings=K,this._sourceMapURL=k,this.file=ie}g.prototype=Object.create(p.prototype),g.prototype.consumer=p,g.prototype._findSourceIndex=function(S){var k=S;if(this.sourceRoot!=null&&(k=e.relative(this.sourceRoot,k)),this._sources.has(k))return this._sources.indexOf(k);var N;for(N=0;N<this._absoluteSources.length;++N)if(this._absoluteSources[N]==S)return N;return-1},g.fromSourceMap=function(k,N){var $=Object.create(g.prototype),R=$._names=o.fromArray(k._names.toArray(),!0),U=$._sources=o.fromArray(k._sources.toArray(),!0);$.sourceRoot=k._sourceRoot,$.sourcesContent=k._generateSourcesContent($._sources.toArray(),$.sourceRoot),$.file=k._file,$._sourceMapURL=N,$._absoluteSources=$._sources.toArray().map(function(ue){return e.computeSourceURL($.sourceRoot,ue,N)});for(var O=k._mappings.toArray().slice(),Z=$.__generatedMappings=[],K=$.__originalMappings=[],ie=0,de=O.length;ie<de;ie++){var te=O[ie],re=new M;re.generatedLine=te.generatedLine,re.generatedColumn=te.generatedColumn,te.source&&(re.source=U.indexOf(te.source),re.originalLine=te.originalLine,re.originalColumn=te.originalColumn,te.name&&(re.name=R.indexOf(te.name)),K.push(re)),Z.push(re)}return f($.__originalMappings,e.compareByOriginalPositions),$},g.prototype._version=3,Object.defineProperty(g.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function M(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}g.prototype._parseMappings=function(k,N){for(var $=1,R=0,U=0,O=0,Z=0,K=0,ie=k.length,de=0,te={},re={},ue=[],ve=[],Ae,Fe,we,Ce,be;de<ie;)if(k.charAt(de)===";")$++,de++,R=0;else if(k.charAt(de)===",")de++;else{for(Ae=new M,Ae.generatedLine=$,Ce=de;Ce<ie&&!this._charIsMappingSeparator(k,Ce);Ce++);if(Fe=k.slice(de,Ce),we=te[Fe],we)de+=Fe.length;else{for(we=[];de<Ce;)u.decode(k,de,re),be=re.value,de=re.rest,we.push(be);if(we.length===2)throw new Error("Found a source, but no line and column");if(we.length===3)throw new Error("Found a source and line, but no column");te[Fe]=we}Ae.generatedColumn=R+we[0],R=Ae.generatedColumn,we.length>1&&(Ae.source=Z+we[1],Z+=we[1],Ae.originalLine=U+we[2],U=Ae.originalLine,Ae.originalLine+=1,Ae.originalColumn=O+we[3],O=Ae.originalColumn,we.length>4&&(Ae.name=K+we[4],K+=we[4])),ve.push(Ae),typeof Ae.originalLine=="number"&&ue.push(Ae)}f(ve,e.compareByGeneratedPositionsDeflated),this.__generatedMappings=ve,f(ue,e.compareByOriginalPositions),this.__originalMappings=ue},g.prototype._findMapping=function(k,N,$,R,U,O){if(k[$]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+k[$]);if(k[R]<0)throw new TypeError("Column must be greater than or equal to 0, got "+k[R]);return t.search(k,N,U,O)},g.prototype.computeColumnSpans=function(){for(var k=0;k<this._generatedMappings.length;++k){var N=this._generatedMappings[k];if(k+1<this._generatedMappings.length){var $=this._generatedMappings[k+1];if(N.generatedLine===$.generatedLine){N.lastGeneratedColumn=$.generatedColumn-1;continue}}N.lastGeneratedColumn=1/0}},g.prototype.originalPositionFor=function(k){var N={generatedLine:e.getArg(k,"line"),generatedColumn:e.getArg(k,"column")},$=this._findMapping(N,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositionsDeflated,e.getArg(k,"bias",p.GREATEST_LOWER_BOUND));if($>=0){var R=this._generatedMappings[$];if(R.generatedLine===N.generatedLine){var U=e.getArg(R,"source",null);U!==null&&(U=this._sources.at(U),U=e.computeSourceURL(this.sourceRoot,U,this._sourceMapURL));var O=e.getArg(R,"name",null);return O!==null&&(O=this._names.at(O)),{source:U,line:e.getArg(R,"originalLine",null),column:e.getArg(R,"originalColumn",null),name:O}}}return{source:null,line:null,column:null,name:null}},g.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(k){return k==null}):!1},g.prototype.sourceContentFor=function(k,N){if(!this.sourcesContent)return null;var $=this._findSourceIndex(k);if($>=0)return this.sourcesContent[$];var R=k;this.sourceRoot!=null&&(R=e.relative(this.sourceRoot,R));var U;if(this.sourceRoot!=null&&(U=e.urlParse(this.sourceRoot))){var O=R.replace(/^file:\/\//,"");if(U.scheme=="file"&&this._sources.has(O))return this.sourcesContent[this._sources.indexOf(O)];if((!U.path||U.path=="/")&&this._sources.has("/"+R))return this.sourcesContent[this._sources.indexOf("/"+R)]}if(N)return null;throw new Error('"'+R+'" is not in the SourceMap.')},g.prototype.generatedPositionFor=function(k){var N=e.getArg(k,"source");if(N=this._findSourceIndex(N),N<0)return{line:null,column:null,lastColumn:null};var $={source:N,originalLine:e.getArg(k,"line"),originalColumn:e.getArg(k,"column")},R=this._findMapping($,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,e.getArg(k,"bias",p.GREATEST_LOWER_BOUND));if(R>=0){var U=this._originalMappings[R];if(U.source===$.source)return{line:e.getArg(U,"generatedLine",null),column:e.getArg(U,"generatedColumn",null),lastColumn:e.getArg(U,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},sourceMapConsumer.BasicSourceMapConsumer=g;function F(S,k){var N=S;typeof S=="string"&&(N=e.parseSourceMapInput(S));var $=e.getArg(N,"version"),R=e.getArg(N,"sections");if($!=this._version)throw new Error("Unsupported version: "+$);this._sources=new o,this._names=new o;var U={line:-1,column:0};this._sections=R.map(function(O){if(O.url)throw new Error("Support for url field in sections not implemented.");var Z=e.getArg(O,"offset"),K=e.getArg(Z,"line"),ie=e.getArg(Z,"column");if(K<U.line||K===U.line&&ie<U.column)throw new Error("Section offsets must be ordered and non-overlapping.");return U=Z,{generatedOffset:{generatedLine:K+1,generatedColumn:ie+1},consumer:new p(e.getArg(O,"map"),k)}})}return F.prototype=Object.create(p.prototype),F.prototype.constructor=p,F.prototype._version=3,Object.defineProperty(F.prototype,"sources",{get:function(){for(var S=[],k=0;k<this._sections.length;k++)for(var N=0;N<this._sections[k].consumer.sources.length;N++)S.push(this._sections[k].consumer.sources[N]);return S}}),F.prototype.originalPositionFor=function(k){var N={generatedLine:e.getArg(k,"line"),generatedColumn:e.getArg(k,"column")},$=t.search(N,this._sections,function(U,O){var Z=U.generatedLine-O.generatedOffset.generatedLine;return Z||U.generatedColumn-O.generatedOffset.generatedColumn}),R=this._sections[$];return R?R.consumer.originalPositionFor({line:N.generatedLine-(R.generatedOffset.generatedLine-1),column:N.generatedColumn-(R.generatedOffset.generatedLine===N.generatedLine?R.generatedOffset.generatedColumn-1:0),bias:k.bias}):{source:null,line:null,column:null,name:null}},F.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(k){return k.consumer.hasContentsOfAllSources()})},F.prototype.sourceContentFor=function(k,N){for(var $=0;$<this._sections.length;$++){var R=this._sections[$],U=R.consumer.sourceContentFor(k,!0);if(U)return U}if(N)return null;throw new Error('"'+k+'" is not in the SourceMap.')},F.prototype.generatedPositionFor=function(k){for(var N=0;N<this._sections.length;N++){var $=this._sections[N];if($.consumer._findSourceIndex(e.getArg(k,"source"))!==-1){var R=$.consumer.generatedPositionFor(k);if(R){var U={line:R.line+($.generatedOffset.generatedLine-1),column:R.column+($.generatedOffset.generatedLine===R.line?$.generatedOffset.generatedColumn-1:0)};return U}}}return{line:null,column:null}},F.prototype._parseMappings=function(k,N){this.__generatedMappings=[],this.__originalMappings=[];for(var $=0;$<this._sections.length;$++)for(var R=this._sections[$],U=R.consumer._generatedMappings,O=0;O<U.length;O++){var Z=U[O],K=R.consumer._sources.at(Z.source);K=e.computeSourceURL(R.consumer.sourceRoot,K,this._sourceMapURL),this._sources.add(K),K=this._sources.indexOf(K);var ie=null;Z.name&&(ie=R.consumer._names.at(Z.name),this._names.add(ie),ie=this._names.indexOf(ie));var de={source:K,generatedLine:Z.generatedLine+(R.generatedOffset.generatedLine-1),generatedColumn:Z.generatedColumn+(R.generatedOffset.generatedLine===Z.generatedLine?R.generatedOffset.generatedColumn-1:0),originalLine:Z.originalLine,originalColumn:Z.originalColumn,name:ie};this.__generatedMappings.push(de),typeof de.originalLine=="number"&&this.__originalMappings.push(de)}f(this.__generatedMappings,e.compareByGeneratedPositionsDeflated),f(this.__originalMappings,e.compareByOriginalPositions)},sourceMapConsumer.IndexedSourceMapConsumer=F,sourceMapConsumer}var sourceNode={},hasRequiredSourceNode;function requireSourceNode(){if(hasRequiredSourceNode)return sourceNode;hasRequiredSourceNode=1;var e=requireSourceMapGenerator().SourceMapGenerator,t=requireUtil(),o=/(\r?\n)/,u=10,f="$$$isSourceNode$$$";function p(g,M,F,S,k){this.children=[],this.sourceContents={},this.line=g??null,this.column=M??null,this.source=F??null,this.name=k??null,this[f]=!0,S!=null&&this.add(S)}return p.fromStringWithSourceMap=function(M,F,S){var k=new p,N=M.split(o),$=0,R=function(){var ie=te(),de=te()||"";return ie+de;function te(){return $<N.length?N[$++]:void 0}},U=1,O=0,Z=null;return F.eachMapping(function(ie){if(Z!==null)if(U<ie.generatedLine)K(Z,R()),U++,O=0;else{var de=N[$]||"",te=de.substr(0,ie.generatedColumn-O);N[$]=de.substr(ie.generatedColumn-O),O=ie.generatedColumn,K(Z,te),Z=ie;return}for(;U<ie.generatedLine;)k.add(R()),U++;if(O<ie.generatedColumn){var de=N[$]||"";k.add(de.substr(0,ie.generatedColumn)),N[$]=de.substr(ie.generatedColumn),O=ie.generatedColumn}Z=ie},this),$<N.length&&(Z&&K(Z,R()),k.add(N.splice($).join(""))),F.sources.forEach(function(ie){var de=F.sourceContentFor(ie);de!=null&&(S!=null&&(ie=t.join(S,ie)),k.setSourceContent(ie,de))}),k;function K(ie,de){if(ie===null||ie.source===void 0)k.add(de);else{var te=S?t.join(S,ie.source):ie.source;k.add(new p(ie.originalLine,ie.originalColumn,te,de,ie.name))}}},p.prototype.add=function(M){if(Array.isArray(M))M.forEach(function(F){this.add(F)},this);else if(M[f]||typeof M=="string")M&&this.children.push(M);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+M);return this},p.prototype.prepend=function(M){if(Array.isArray(M))for(var F=M.length-1;F>=0;F--)this.prepend(M[F]);else if(M[f]||typeof M=="string")this.children.unshift(M);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+M);return this},p.prototype.walk=function(M){for(var F,S=0,k=this.children.length;S<k;S++)F=this.children[S],F[f]?F.walk(M):F!==""&&M(F,{source:this.source,line:this.line,column:this.column,name:this.name})},p.prototype.join=function(M){var F,S,k=this.children.length;if(k>0){for(F=[],S=0;S<k-1;S++)F.push(this.children[S]),F.push(M);F.push(this.children[S]),this.children=F}return this},p.prototype.replaceRight=function(M,F){var S=this.children[this.children.length-1];return S[f]?S.replaceRight(M,F):typeof S=="string"?this.children[this.children.length-1]=S.replace(M,F):this.children.push("".replace(M,F)),this},p.prototype.setSourceContent=function(M,F){this.sourceContents[t.toSetString(M)]=F},p.prototype.walkSourceContents=function(M){for(var F=0,S=this.children.length;F<S;F++)this.children[F][f]&&this.children[F].walkSourceContents(M);for(var k=Object.keys(this.sourceContents),F=0,S=k.length;F<S;F++)M(t.fromSetString(k[F]),this.sourceContents[k[F]])},p.prototype.toString=function(){var M="";return this.walk(function(F){M+=F}),M},p.prototype.toStringWithSourceMap=function(M){var F={code:"",line:1,column:0},S=new e(M),k=!1,N=null,$=null,R=null,U=null;return this.walk(function(O,Z){F.code+=O,Z.source!==null&&Z.line!==null&&Z.column!==null?((N!==Z.source||$!==Z.line||R!==Z.column||U!==Z.name)&&S.addMapping({source:Z.source,original:{line:Z.line,column:Z.column},generated:{line:F.line,column:F.column},name:Z.name}),N=Z.source,$=Z.line,R=Z.column,U=Z.name,k=!0):k&&(S.addMapping({generated:{line:F.line,column:F.column}}),N=null,k=!1);for(var K=0,ie=O.length;K<ie;K++)O.charCodeAt(K)===u?(F.line++,F.column=0,K+1===ie?(N=null,k=!1):k&&S.addMapping({source:Z.source,original:{line:Z.line,column:Z.column},generated:{line:F.line,column:F.column},name:Z.name})):F.column++}),this.walkSourceContents(function(O,Z){S.setSourceContent(O,Z)}),{code:F.code,map:S}},sourceNode.SourceNode=p,sourceNode}var hasRequiredSourceMap;function requireSourceMap(){return hasRequiredSourceMap||(hasRequiredSourceMap=1,sourceMap.SourceMapGenerator=requireSourceMapGenerator().SourceMapGenerator,sourceMap.SourceMapConsumer=requireSourceMapConsumer().SourceMapConsumer,sourceMap.SourceNode=requireSourceNode().SourceNode),sourceMap}const version="2.1.0",require$$3={version};var hasRequiredEscodegen;function requireEscodegen(){return hasRequiredEscodegen||(hasRequiredEscodegen=1,(function(e){(function(){var t,o,u,f,p,g,M,F,S,k,N,$,R,U,O,Z,K,ie,de,te,re,ue,ve,Ae,Fe,we;p=requireEstraverse(),g=requireUtils(),t=p.Syntax;function Ce(B){return ot.Expression.hasOwnProperty(B.type)}function be(B){return ot.Statement.hasOwnProperty(B.type)}o={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},u={"??":o.Coalesce,"||":o.LogicalOR,"&&":o.LogicalAND,"|":o.BitwiseOR,"^":o.BitwiseXOR,"&":o.BitwiseAND,"==":o.Equality,"!=":o.Equality,"===":o.Equality,"!==":o.Equality,is:o.Equality,isnt:o.Equality,"<":o.Relational,">":o.Relational,"<=":o.Relational,">=":o.Relational,in:o.Relational,instanceof:o.Relational,"<<":o.BitwiseSHIFT,">>":o.BitwiseSHIFT,">>>":o.BitwiseSHIFT,"+":o.Additive,"-":o.Additive,"*":o.Multiplicative,"%":o.Multiplicative,"/":o.Multiplicative,"**":o.Exponentiation};var le=1,Ze=2,Je=4,Qe=8,rt=16,tt=32,kt=64,Lt=Ze|Je,Tt=le|Ze,ke=le|Ze|Je,at=le,je=Je,Ie=le|Je,nt=le,pt=le|tt,Ft=0,ht=le|rt,Zt=le|Qe;function Qt(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Bt(B,se){var ee="";for(se|=0;se>0;se>>>=1,B+=B)se&1&&(ee+=B);return ee}function _t(B){return/[\r\n]/g.test(B)}function $t(B){var se=B.length;return se&&g.code.isLineTerminator(B.charCodeAt(se-1))}function rn(B,se){var ee;for(ee in se)se.hasOwnProperty(ee)&&(B[ee]=se[ee]);return B}function Gt(B,se){var ee,oe;function pe(De){return typeof De=="object"&&De instanceof Object&&!(De instanceof RegExp)}for(ee in se)se.hasOwnProperty(ee)&&(oe=se[ee],pe(oe)?pe(B[ee])?Gt(B[ee],oe):B[ee]=Gt({},oe):B[ee]=oe);return B}function Yt(B){var se,ee,oe,pe,De;if(B!==B)throw new Error("Numeric literal whose value is NaN");if(B<0||B===0&&1/B<0)throw new Error("Numeric literal whose value is negative");if(B===1/0)return S?"null":k?"1e400":"1e+400";if(se=""+B,!k||se.length<3)return se;for(ee=se.indexOf("."),!S&&se.charCodeAt(0)===48&&ee===1&&(ee=0,se=se.slice(1)),oe=se,se=se.replace("e+","e"),pe=0,(De=oe.indexOf("e"))>0&&(pe=+oe.slice(De+1),oe=oe.slice(0,De)),ee>=0&&(pe-=oe.length-ee-1,oe=+(oe.slice(0,ee)+oe.slice(ee+1))+""),De=0;oe.charCodeAt(oe.length+De-1)===48;)--De;return De!==0&&(pe-=De,oe=oe.slice(0,De)),pe!==0&&(oe+="e"+pe),(oe.length<se.length||N&&B>1e12&&Math.floor(B)===B&&(oe="0x"+B.toString(16)).length<se.length)&&+oe===B&&(se=oe),se}function yn(B,se){return(B&-2)===8232?(se?"u":"\\u")+(B===8232?"2028":"2029"):B===10||B===13?(se?"":"\\")+(B===10?"n":"r"):String.fromCharCode(B)}function xe(B){var se,ee,oe,pe,De,Ge,Ve,ut;if(ee=B.toString(),B.source){if(se=ee.match(/\/([^/]*)$/),!se)return ee;for(oe=se[1],ee="",Ve=!1,ut=!1,pe=0,De=B.source.length;pe<De;++pe)Ge=B.source.charCodeAt(pe),ut?(ee+=yn(Ge,ut),ut=!1):(Ve?Ge===93&&(Ve=!1):Ge===47?ee+="\\":Ge===91&&(Ve=!0),ee+=yn(Ge,ut),ut=Ge===92);return"/"+ee+"/"+oe}return ee}function Pe(B,se){var ee;return B===8?"\\b":B===12?"\\f":B===9?"\\t":(ee=B.toString(16).toUpperCase(),S||B>255?"\\u"+"0000".slice(ee.length)+ee:B===0&&!g.code.isDecimalDigit(se)?"\\0":B===11?"\\x0B":"\\x"+"00".slice(ee.length)+ee)}function ye(B){if(B===92)return"\\\\";if(B===10)return"\\n";if(B===13)return"\\r";if(B===8232)return"\\u2028";if(B===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Te(B){var se,ee,oe,pe;for(pe=$==="double"?'"':"'",se=0,ee=B.length;se<ee;++se)if(oe=B.charCodeAt(se),oe===39){pe='"';break}else if(oe===34){pe="'";break}else oe===92&&++se;return pe+B+pe}function He(B){var se="",ee,oe,pe,De=0,Ge=0,Ve,ut;for(ee=0,oe=B.length;ee<oe;++ee){if(pe=B.charCodeAt(ee),pe===39)++De;else if(pe===34)++Ge;else if(pe===47&&S)se+="\\";else if(g.code.isLineTerminator(pe)||pe===92){se+=ye(pe);continue}else if(!g.code.isIdentifierPartES5(pe)&&(S&&pe<32||!S&&!R&&(pe<32||pe>126))){se+=Pe(pe,B.charCodeAt(ee+1));continue}se+=String.fromCharCode(pe)}if(Ve=!($==="double"||$==="auto"&&Ge<De),ut=Ve?"'":'"',!(Ve?De:Ge))return ut+se+ut;for(B=se,se=ut,ee=0,oe=B.length;ee<oe;++ee)pe=B.charCodeAt(ee),(pe===39&&Ve||pe===34&&!Ve)&&(se+="\\"),se+=String.fromCharCode(pe);return se+ut}function et(B){var se,ee,oe,pe="";for(se=0,ee=B.length;se<ee;++se)oe=B[se],pe+=Array.isArray(oe)?et(oe):oe;return pe}function We(B,se){if(!ue)return Array.isArray(B)?et(B):B;if(se==null){if(B instanceof f)return B;se={}}return se.loc==null?new f(null,null,ue,B,se.name||null):new f(se.loc.start.line,se.loc.start.column,ue===!0?se.loc.source||null:ue,B,se.name||null)}function yt(){return O||" "}function $e(B,se){var ee,oe,pe,De;return ee=We(B).toString(),ee.length===0?[se]:(oe=We(se).toString(),oe.length===0?[B]:(pe=ee.charCodeAt(ee.length-1),De=oe.charCodeAt(0),(pe===43||pe===45)&&pe===De||g.code.isIdentifierPartES5(pe)&&g.code.isIdentifierPartES5(De)||pe===47&&De===105?[B,yt(),se]:g.code.isWhiteSpace(pe)||g.code.isLineTerminator(pe)||g.code.isWhiteSpace(De)||g.code.isLineTerminator(De)?[B,se]:[B,O,se]))}function Ye(B){return[M,B]}function mt(B){var se;se=M,M+=F,B(M),M=se}function It(B){var se;for(se=B.length-1;se>=0&&!g.code.isLineTerminator(B.charCodeAt(se));--se);return B.length-1-se}function zt(B,se){var ee,oe,pe,De,Ge,Ve,ut,Rt;for(ee=B.split(/\r\n|[\r\n]/),Ve=Number.MAX_VALUE,oe=1,pe=ee.length;oe<pe;++oe){for(De=ee[oe],Ge=0;Ge<De.length&&g.code.isWhiteSpace(De.charCodeAt(Ge));)++Ge;Ve>Ge&&(Ve=Ge)}for(typeof se<"u"?(ut=M,ee[1][Ve]==="*"&&(se+=" "),M=se):(Ve&1&&--Ve,ut=M),oe=1,pe=ee.length;oe<pe;++oe)Rt=We(Ye(ee[oe].slice(Ve))),ee[oe]=ue?Rt.join(""):Rt;return M=ut,ee.join(`
`)}function Ue(B,se){if(B.type==="Line"){if($t(B.value))return"//"+B.value;var ee="//"+B.value;return Ae||(ee+=`
`),ee}return te.format.indent.adjustMultilineComment&&/[\n\r]/.test(B.value)?zt("/*"+B.value+"*/",se):"/*"+B.value+"*/"}function Et(B,se){var ee,oe,pe,De,Ge,Ve,ut,Rt,Jt,fn,pn,yr,Vn,bn;if(B.leadingComments&&B.leadingComments.length>0){if(De=se,Ae){for(pe=B.leadingComments[0],se=[],Rt=pe.extendedRange,Jt=pe.range,pn=ve.substring(Rt[0],Jt[0]),bn=(pn.match(/\n/g)||[]).length,bn>0?(se.push(Bt(`
`,bn)),se.push(Ye(Ue(pe)))):(se.push(pn),se.push(Ue(pe))),fn=Jt,ee=1,oe=B.leadingComments.length;ee<oe;ee++)pe=B.leadingComments[ee],Jt=pe.range,yr=ve.substring(fn[1],Jt[0]),bn=(yr.match(/\n/g)||[]).length,se.push(Bt(`
`,bn)),se.push(Ye(Ue(pe))),fn=Jt;Vn=ve.substring(Jt[1],Rt[1]),bn=(Vn.match(/\n/g)||[]).length,se.push(Bt(`
`,bn))}else for(pe=B.leadingComments[0],se=[],ie&&B.type===t.Program&&B.body.length===0&&se.push(`
`),se.push(Ue(pe)),$t(We(se).toString())||se.push(`
`),ee=1,oe=B.leadingComments.length;ee<oe;++ee)pe=B.leadingComments[ee],ut=[Ue(pe)],$t(We(ut).toString())||ut.push(`
`),se.push(Ye(ut));se.push(Ye(De))}if(B.trailingComments)if(Ae)pe=B.trailingComments[0],Rt=pe.extendedRange,Jt=pe.range,pn=ve.substring(Rt[0],Jt[0]),bn=(pn.match(/\n/g)||[]).length,bn>0?(se.push(Bt(`
`,bn)),se.push(Ye(Ue(pe)))):(se.push(pn),se.push(Ue(pe)));else for(Ge=!$t(We(se).toString()),Ve=Bt(" ",It(We([M,se,F]).toString())),ee=0,oe=B.trailingComments.length;ee<oe;++ee)pe=B.trailingComments[ee],Ge?(ee===0?se=[se,F]:se=[se,Ve],se.push(Ue(pe,Ve))):se=[se,Ye(Ue(pe))],ee!==oe-1&&!$t(We(se).toString())&&(se=[se,`
`]);return se}function Ht(B,se,ee){var oe,pe=0;for(oe=B;oe<se;oe++)ve[oe]===`
`&&pe++;for(oe=1;oe<pe;oe++)ee.push(U)}function Oe(B,se,ee){return se<ee?["(",B,")"]:B}function Wt(B){var se,ee,oe;for(oe=B.split(/\r\n|\n/),se=1,ee=oe.length;se<ee;se++)oe[se]=U+M+oe[se];return oe}function sn(B,se){var ee,oe,pe;return ee=B[te.verbatim],typeof ee=="string"?oe=Oe(Wt(ee),o.Sequence,se):(oe=Wt(ee.content),pe=ee.precedence!=null?ee.precedence:o.Sequence,oe=Oe(oe,pe,se)),We(oe,B)}function ot(){}ot.prototype.maybeBlock=function(B,se){var ee,oe,pe=this;return oe=!te.comment||!B.leadingComments,B.type===t.BlockStatement&&oe?[O,this.generateStatement(B,se)]:B.type===t.EmptyStatement&&oe?";":(mt(function(){ee=[U,Ye(pe.generateStatement(B,se))]}),ee)},ot.prototype.maybeBlockSuffix=function(B,se){var ee=$t(We(se).toString());return B.type===t.BlockStatement&&(!te.comment||!B.leadingComments)&&!ee?[se,O]:ee?[se,M]:[se,U,M]};function Pt(B){return We(B.name,B)}function Dt(B,se){return B.async?"async"+(se?yt():O):""}function Ut(B){var se=B.generator&&!te.moz.starlessGenerator;return se?"*"+O:""}function Kt(B){var se=B.value,ee="";return se.async&&(ee+=Dt(se,!B.computed)),se.generator&&(ee+=Ut(se)?"*":""),ee}ot.prototype.generatePattern=function(B,se,ee){return B.type===t.Identifier?Pt(B):this.generateExpression(B,se,ee)},ot.prototype.generateFunctionParams=function(B){var se,ee,oe,pe;if(pe=!1,B.type===t.ArrowFunctionExpression&&!B.rest&&(!B.defaults||B.defaults.length===0)&&B.params.length===1&&B.params[0].type===t.Identifier)oe=[Dt(B,!0),Pt(B.params[0])];else{for(oe=B.type===t.ArrowFunctionExpression?[Dt(B,!1)]:[],oe.push("("),B.defaults&&(pe=!0),se=0,ee=B.params.length;se<ee;++se)pe&&B.defaults[se]?oe.push(this.generateAssignment(B.params[se],B.defaults[se],"=",o.Assignment,ke)):oe.push(this.generatePattern(B.params[se],o.Assignment,ke)),se+1<ee&&oe.push(","+O);B.rest&&(B.params.length&&oe.push(","+O),oe.push("..."),oe.push(Pt(B.rest))),oe.push(")")}return oe},ot.prototype.generateFunctionBody=function(B){var se,ee;return se=this.generateFunctionParams(B),B.type===t.ArrowFunctionExpression&&(se.push(O),se.push("=>")),B.expression?(se.push(O),ee=this.generateExpression(B.body,o.Assignment,ke),ee.toString().charAt(0)==="{"&&(ee=["(",ee,")"]),se.push(ee)):se.push(this.maybeBlock(B.body,Zt)),se},ot.prototype.generateIterationForStatement=function(B,se,ee){var oe=["for"+(se.await?yt()+"await":"")+O+"("],pe=this;return mt(function(){se.left.type===t.VariableDeclaration?mt(function(){oe.push(se.left.kind+yt()),oe.push(pe.generateStatement(se.left.declarations[0],Ft))}):oe.push(pe.generateExpression(se.left,o.Call,ke)),oe=$e(oe,B),oe=[$e(oe,pe.generateExpression(se.right,o.Assignment,ke)),")"]}),oe.push(this.maybeBlock(se.body,ee)),oe},ot.prototype.generatePropertyKey=function(B,se){var ee=[];return se&&ee.push("["),ee.push(this.generateExpression(B,o.Assignment,ke)),se&&ee.push("]"),ee},ot.prototype.generateAssignment=function(B,se,ee,oe,pe){return o.Assignment<oe&&(pe|=le),Oe([this.generateExpression(B,o.Call,pe),O+ee+O,this.generateExpression(se,o.Assignment,pe)],o.Assignment,oe)},ot.prototype.semicolon=function(B){return!K&&B&tt?"":";"},ot.Statement={BlockStatement:function(B,se){var ee,oe,pe=["{",U],De=this;return mt(function(){B.body.length===0&&Ae&&(ee=B.range,ee[1]-ee[0]>2&&(oe=ve.substring(ee[0]+1,ee[1]-1),oe[0]===`
`&&(pe=["{"]),pe.push(oe)));var Ge,Ve,ut,Rt;for(Rt=nt,se&Qe&&(Rt|=rt),Ge=0,Ve=B.body.length;Ge<Ve;++Ge)Ae&&(Ge===0&&(B.body[0].leadingComments&&(ee=B.body[0].leadingComments[0].extendedRange,oe=ve.substring(ee[0],ee[1]),oe[0]===`
`&&(pe=["{"])),B.body[0].leadingComments||Ht(B.range[0],B.body[0].range[0],pe)),Ge>0&&!B.body[Ge-1].trailingComments&&!B.body[Ge].leadingComments&&Ht(B.body[Ge-1].range[1],B.body[Ge].range[0],pe)),Ge===Ve-1&&(Rt|=tt),B.body[Ge].leadingComments&&Ae?ut=De.generateStatement(B.body[Ge],Rt):ut=Ye(De.generateStatement(B.body[Ge],Rt)),pe.push(ut),$t(We(ut).toString())||Ae&&Ge<Ve-1&&B.body[Ge+1].leadingComments||pe.push(U),Ae&&Ge===Ve-1&&(B.body[Ge].trailingComments||Ht(B.body[Ge].range[1],B.range[1],pe))}),pe.push(Ye("}")),pe},BreakStatement:function(B,se){return B.label?"break "+B.label.name+this.semicolon(se):"break"+this.semicolon(se)},ContinueStatement:function(B,se){return B.label?"continue "+B.label.name+this.semicolon(se):"continue"+this.semicolon(se)},ClassBody:function(B,se){var ee=["{",U],oe=this;return mt(function(pe){var De,Ge;for(De=0,Ge=B.body.length;De<Ge;++De)ee.push(pe),ee.push(oe.generateExpression(B.body[De],o.Sequence,ke)),De+1<Ge&&ee.push(U)}),$t(We(ee).toString())||ee.push(U),ee.push(M),ee.push("}"),ee},ClassDeclaration:function(B,se){var ee,oe;return ee=["class"],B.id&&(ee=$e(ee,this.generateExpression(B.id,o.Sequence,ke))),B.superClass&&(oe=$e("extends",this.generateExpression(B.superClass,o.Unary,ke)),ee=$e(ee,oe)),ee.push(O),ee.push(this.generateStatement(B.body,pt)),ee},DirectiveStatement:function(B,se){return te.raw&&B.raw?B.raw+this.semicolon(se):Te(B.directive)+this.semicolon(se)},DoWhileStatement:function(B,se){var ee=$e("do",this.maybeBlock(B.body,nt));return ee=this.maybeBlockSuffix(B.body,ee),$e(ee,["while"+O+"(",this.generateExpression(B.test,o.Sequence,ke),")"+this.semicolon(se)])},CatchClause:function(B,se){var ee,oe=this;return mt(function(){var pe;B.param?(ee=["catch"+O+"(",oe.generateExpression(B.param,o.Sequence,ke),")"],B.guard&&(pe=oe.generateExpression(B.guard,o.Sequence,ke),ee.splice(2,0," if ",pe))):ee=["catch"]}),ee.push(this.maybeBlock(B.body,nt)),ee},DebuggerStatement:function(B,se){return"debugger"+this.semicolon(se)},EmptyStatement:function(B,se){return";"},ExportDefaultDeclaration:function(B,se){var ee=["export"],oe;return oe=se&tt?pt:nt,ee=$e(ee,"default"),be(B.declaration)?ee=$e(ee,this.generateStatement(B.declaration,oe)):ee=$e(ee,this.generateExpression(B.declaration,o.Assignment,ke)+this.semicolon(se)),ee},ExportNamedDeclaration:function(B,se){var ee=["export"],oe,pe=this;return oe=se&tt?pt:nt,B.declaration?$e(ee,this.generateStatement(B.declaration,oe)):(B.specifiers&&(B.specifiers.length===0?ee=$e(ee,"{"+O+"}"):B.specifiers[0].type===t.ExportBatchSpecifier?ee=$e(ee,this.generateExpression(B.specifiers[0],o.Sequence,ke)):(ee=$e(ee,"{"),mt(function(De){var Ge,Ve;for(ee.push(U),Ge=0,Ve=B.specifiers.length;Ge<Ve;++Ge)ee.push(De),ee.push(pe.generateExpression(B.specifiers[Ge],o.Sequence,ke)),Ge+1<Ve&&ee.push(","+U)}),$t(We(ee).toString())||ee.push(U),ee.push(M+"}")),B.source?ee=$e(ee,["from"+O,this.generateExpression(B.source,o.Sequence,ke),this.semicolon(se)]):ee.push(this.semicolon(se))),ee)},ExportAllDeclaration:function(B,se){return["export"+O,"*"+O,"from"+O,this.generateExpression(B.source,o.Sequence,ke),this.semicolon(se)]},ExpressionStatement:function(B,se){var ee,oe;function pe(Ve){var ut;return Ve.slice(0,5)!=="class"?!1:(ut=Ve.charCodeAt(5),ut===123||g.code.isWhiteSpace(ut)||g.code.isLineTerminator(ut))}function De(Ve){var ut;return Ve.slice(0,8)!=="function"?!1:(ut=Ve.charCodeAt(8),ut===40||g.code.isWhiteSpace(ut)||ut===42||g.code.isLineTerminator(ut))}function Ge(Ve){var ut,Rt,Jt;if(Ve.slice(0,5)!=="async"||!g.code.isWhiteSpace(Ve.charCodeAt(5)))return!1;for(Rt=6,Jt=Ve.length;Rt<Jt&&g.code.isWhiteSpace(Ve.charCodeAt(Rt));++Rt);return Rt===Jt||Ve.slice(Rt,Rt+8)!=="function"?!1:(ut=Ve.charCodeAt(Rt+8),ut===40||g.code.isWhiteSpace(ut)||ut===42||g.code.isLineTerminator(ut))}return ee=[this.generateExpression(B.expression,o.Sequence,ke)],oe=We(ee).toString(),oe.charCodeAt(0)===123||pe(oe)||De(oe)||Ge(oe)||de&&se&rt&&B.expression.type===t.Literal&&typeof B.expression.value=="string"?ee=["(",ee,")"+this.semicolon(se)]:ee.push(this.semicolon(se)),ee},ImportDeclaration:function(B,se){var ee,oe,pe=this;return B.specifiers.length===0?["import",O,this.generateExpression(B.source,o.Sequence,ke),this.semicolon(se)]:(ee=["import"],oe=0,B.specifiers[oe].type===t.ImportDefaultSpecifier&&(ee=$e(ee,[this.generateExpression(B.specifiers[oe],o.Sequence,ke)]),++oe),B.specifiers[oe]&&(oe!==0&&ee.push(","),B.specifiers[oe].type===t.ImportNamespaceSpecifier?ee=$e(ee,[O,this.generateExpression(B.specifiers[oe],o.Sequence,ke)]):(ee.push(O+"{"),B.specifiers.length-oe===1?(ee.push(O),ee.push(this.generateExpression(B.specifiers[oe],o.Sequence,ke)),ee.push(O+"}"+O)):(mt(function(De){var Ge,Ve;for(ee.push(U),Ge=oe,Ve=B.specifiers.length;Ge<Ve;++Ge)ee.push(De),ee.push(pe.generateExpression(B.specifiers[Ge],o.Sequence,ke)),Ge+1<Ve&&ee.push(","+U)}),$t(We(ee).toString())||ee.push(U),ee.push(M+"}"+O)))),ee=$e(ee,["from"+O,this.generateExpression(B.source,o.Sequence,ke),this.semicolon(se)]),ee)},VariableDeclarator:function(B,se){var ee=se&le?ke:Lt;return B.init?[this.generateExpression(B.id,o.Assignment,ee),O,"=",O,this.generateExpression(B.init,o.Assignment,ee)]:this.generatePattern(B.id,o.Assignment,ee)},VariableDeclaration:function(B,se){var ee,oe,pe,De,Ge,Ve=this;ee=[B.kind],Ge=se&le?nt:Ft;function ut(){for(De=B.declarations[0],te.comment&&De.leadingComments?(ee.push(`
`),ee.push(Ye(Ve.generateStatement(De,Ge)))):(ee.push(yt()),ee.push(Ve.generateStatement(De,Ge))),oe=1,pe=B.declarations.length;oe<pe;++oe)De=B.declarations[oe],te.comment&&De.leadingComments?(ee.push(","+U),ee.push(Ye(Ve.generateStatement(De,Ge)))):(ee.push(","+O),ee.push(Ve.generateStatement(De,Ge)))}return B.declarations.length>1?mt(ut):ut(),ee.push(this.semicolon(se)),ee},ThrowStatement:function(B,se){return[$e("throw",this.generateExpression(B.argument,o.Sequence,ke)),this.semicolon(se)]},TryStatement:function(B,se){var ee,oe,pe,De;if(ee=["try",this.maybeBlock(B.block,nt)],ee=this.maybeBlockSuffix(B.block,ee),B.handlers)for(oe=0,pe=B.handlers.length;oe<pe;++oe)ee=$e(ee,this.generateStatement(B.handlers[oe],nt)),(B.finalizer||oe+1!==pe)&&(ee=this.maybeBlockSuffix(B.handlers[oe].body,ee));else{for(De=B.guardedHandlers||[],oe=0,pe=De.length;oe<pe;++oe)ee=$e(ee,this.generateStatement(De[oe],nt)),(B.finalizer||oe+1!==pe)&&(ee=this.maybeBlockSuffix(De[oe].body,ee));if(B.handler)if(Array.isArray(B.handler))for(oe=0,pe=B.handler.length;oe<pe;++oe)ee=$e(ee,this.generateStatement(B.handler[oe],nt)),(B.finalizer||oe+1!==pe)&&(ee=this.maybeBlockSuffix(B.handler[oe].body,ee));else ee=$e(ee,this.generateStatement(B.handler,nt)),B.finalizer&&(ee=this.maybeBlockSuffix(B.handler.body,ee))}return B.finalizer&&(ee=$e(ee,["finally",this.maybeBlock(B.finalizer,nt)])),ee},SwitchStatement:function(B,se){var ee,oe,pe,De,Ge,Ve=this;if(mt(function(){ee=["switch"+O+"(",Ve.generateExpression(B.discriminant,o.Sequence,ke),")"+O+"{"+U]}),B.cases)for(Ge=nt,pe=0,De=B.cases.length;pe<De;++pe)pe===De-1&&(Ge|=tt),oe=Ye(this.generateStatement(B.cases[pe],Ge)),ee.push(oe),$t(We(oe).toString())||ee.push(U);return ee.push(Ye("}")),ee},SwitchCase:function(B,se){var ee,oe,pe,De,Ge,Ve=this;return mt(function(){for(B.test?ee=[$e("case",Ve.generateExpression(B.test,o.Sequence,ke)),":"]:ee=["default:"],pe=0,De=B.consequent.length,De&&B.consequent[0].type===t.BlockStatement&&(oe=Ve.maybeBlock(B.consequent[0],nt),ee.push(oe),pe=1),pe!==De&&!$t(We(ee).toString())&&ee.push(U),Ge=nt;pe<De;++pe)pe===De-1&&se&tt&&(Ge|=tt),oe=Ye(Ve.generateStatement(B.consequent[pe],Ge)),ee.push(oe),pe+1!==De&&!$t(We(oe).toString())&&ee.push(U)}),ee},IfStatement:function(B,se){var ee,oe,pe,De=this;return mt(function(){ee=["if"+O+"(",De.generateExpression(B.test,o.Sequence,ke),")"]}),pe=se&tt,oe=nt,pe&&(oe|=tt),B.alternate?(ee.push(this.maybeBlock(B.consequent,nt)),ee=this.maybeBlockSuffix(B.consequent,ee),B.alternate.type===t.IfStatement?ee=$e(ee,["else ",this.generateStatement(B.alternate,oe)]):ee=$e(ee,$e("else",this.maybeBlock(B.alternate,oe)))):ee.push(this.maybeBlock(B.consequent,oe)),ee},ForStatement:function(B,se){var ee,oe=this;return mt(function(){ee=["for"+O+"("],B.init?B.init.type===t.VariableDeclaration?ee.push(oe.generateStatement(B.init,Ft)):(ee.push(oe.generateExpression(B.init,o.Sequence,Lt)),ee.push(";")):ee.push(";"),B.test&&(ee.push(O),ee.push(oe.generateExpression(B.test,o.Sequence,ke))),ee.push(";"),B.update&&(ee.push(O),ee.push(oe.generateExpression(B.update,o.Sequence,ke))),ee.push(")")}),ee.push(this.maybeBlock(B.body,se&tt?pt:nt)),ee},ForInStatement:function(B,se){return this.generateIterationForStatement("in",B,se&tt?pt:nt)},ForOfStatement:function(B,se){return this.generateIterationForStatement("of",B,se&tt?pt:nt)},LabeledStatement:function(B,se){return[B.label.name+":",this.maybeBlock(B.body,se&tt?pt:nt)]},Program:function(B,se){var ee,oe,pe,De,Ge;for(De=B.body.length,ee=[ie&&De>0?`
`:""],Ge=ht,pe=0;pe<De;++pe)!ie&&pe===De-1&&(Ge|=tt),Ae&&(pe===0&&(B.body[0].leadingComments||Ht(B.range[0],B.body[pe].range[0],ee)),pe>0&&!B.body[pe-1].trailingComments&&!B.body[pe].leadingComments&&Ht(B.body[pe-1].range[1],B.body[pe].range[0],ee)),oe=Ye(this.generateStatement(B.body[pe],Ge)),ee.push(oe),pe+1<De&&!$t(We(oe).toString())&&(Ae&&B.body[pe+1].leadingComments||ee.push(U)),Ae&&pe===De-1&&(B.body[pe].trailingComments||Ht(B.body[pe].range[1],B.range[1],ee));return ee},FunctionDeclaration:function(B,se){return[Dt(B,!0),"function",Ut(B)||yt(),B.id?Pt(B.id):"",this.generateFunctionBody(B)]},ReturnStatement:function(B,se){return B.argument?[$e("return",this.generateExpression(B.argument,o.Sequence,ke)),this.semicolon(se)]:["return"+this.semicolon(se)]},WhileStatement:function(B,se){var ee,oe=this;return mt(function(){ee=["while"+O+"(",oe.generateExpression(B.test,o.Sequence,ke),")"]}),ee.push(this.maybeBlock(B.body,se&tt?pt:nt)),ee},WithStatement:function(B,se){var ee,oe=this;return mt(function(){ee=["with"+O+"(",oe.generateExpression(B.object,o.Sequence,ke),")"]}),ee.push(this.maybeBlock(B.body,se&tt?pt:nt)),ee}},rn(ot.prototype,ot.Statement),ot.Expression={SequenceExpression:function(B,se,ee){var oe,pe,De;for(o.Sequence<se&&(ee|=le),oe=[],pe=0,De=B.expressions.length;pe<De;++pe)oe.push(this.generateExpression(B.expressions[pe],o.Assignment,ee)),pe+1<De&&oe.push(","+O);return Oe(oe,o.Sequence,se)},AssignmentExpression:function(B,se,ee){return this.generateAssignment(B.left,B.right,B.operator,se,ee)},ArrowFunctionExpression:function(B,se,ee){return Oe(this.generateFunctionBody(B),o.ArrowFunction,se)},ConditionalExpression:function(B,se,ee){return o.Conditional<se&&(ee|=le),Oe([this.generateExpression(B.test,o.Coalesce,ee),O+"?"+O,this.generateExpression(B.consequent,o.Assignment,ee),O+":"+O,this.generateExpression(B.alternate,o.Assignment,ee)],o.Conditional,se)},LogicalExpression:function(B,se,ee){return B.operator==="??"&&(ee|=kt),this.BinaryExpression(B,se,ee)},BinaryExpression:function(B,se,ee){var oe,pe,De,Ge,Ve,ut;return Ge=u[B.operator],pe=B.operator==="**"?o.Postfix:Ge,De=B.operator==="**"?Ge:Ge+1,Ge<se&&(ee|=le),Ve=this.generateExpression(B.left,pe,ee),ut=Ve.toString(),ut.charCodeAt(ut.length-1)===47&&g.code.isIdentifierPartES5(B.operator.charCodeAt(0))?oe=[Ve,yt(),B.operator]:oe=$e(Ve,B.operator),Ve=this.generateExpression(B.right,De,ee),B.operator==="/"&&Ve.toString().charAt(0)==="/"||B.operator.slice(-1)==="<"&&Ve.toString().slice(0,3)==="!--"?(oe.push(yt()),oe.push(Ve)):oe=$e(oe,Ve),B.operator==="in"&&!(ee&le)?["(",oe,")"]:(B.operator==="||"||B.operator==="&&")&&ee&kt?["(",oe,")"]:Oe(oe,Ge,se)},CallExpression:function(B,se,ee){var oe,pe,De;for(oe=[this.generateExpression(B.callee,o.Call,Tt)],B.optional&&oe.push("?."),oe.push("("),pe=0,De=B.arguments.length;pe<De;++pe)oe.push(this.generateExpression(B.arguments[pe],o.Assignment,ke)),pe+1<De&&oe.push(","+O);return oe.push(")"),ee&Ze?Oe(oe,o.Call,se):["(",oe,")"]},ChainExpression:function(B,se,ee){o.OptionalChaining<se&&(ee|=Ze);var oe=this.generateExpression(B.expression,o.OptionalChaining,ee);return Oe(oe,o.OptionalChaining,se)},NewExpression:function(B,se,ee){var oe,pe,De,Ge,Ve;if(pe=B.arguments.length,Ve=ee&Je&&!Z&&pe===0?Ie:at,oe=$e("new",this.generateExpression(B.callee,o.New,Ve)),!(ee&Je)||Z||pe>0){for(oe.push("("),De=0,Ge=pe;De<Ge;++De)oe.push(this.generateExpression(B.arguments[De],o.Assignment,ke)),De+1<Ge&&oe.push(","+O);oe.push(")")}return Oe(oe,o.New,se)},MemberExpression:function(B,se,ee){var oe,pe;return oe=[this.generateExpression(B.object,o.Call,ee&Ze?Tt:at)],B.computed?(B.optional&&oe.push("?."),oe.push("["),oe.push(this.generateExpression(B.property,o.Sequence,ee&Ze?ke:Ie)),oe.push("]")):(!B.optional&&B.object.type===t.Literal&&typeof B.object.value=="number"&&(pe=We(oe).toString(),pe.indexOf(".")<0&&!/[eExX]/.test(pe)&&g.code.isDecimalDigit(pe.charCodeAt(pe.length-1))&&!(pe.length>=2&&pe.charCodeAt(0)===48)&&oe.push(" ")),oe.push(B.optional?"?.":"."),oe.push(Pt(B.property))),Oe(oe,o.Member,se)},MetaProperty:function(B,se,ee){var oe;return oe=[],oe.push(typeof B.meta=="string"?B.meta:Pt(B.meta)),oe.push("."),oe.push(typeof B.property=="string"?B.property:Pt(B.property)),Oe(oe,o.Member,se)},UnaryExpression:function(B,se,ee){var oe,pe,De,Ge,Ve;return pe=this.generateExpression(B.argument,o.Unary,ke),O===""?oe=$e(B.operator,pe):(oe=[B.operator],B.operator.length>2?oe=$e(oe,pe):(Ge=We(oe).toString(),Ve=Ge.charCodeAt(Ge.length-1),De=pe.toString().charCodeAt(0),((Ve===43||Ve===45)&&Ve===De||g.code.isIdentifierPartES5(Ve)&&g.code.isIdentifierPartES5(De))&&oe.push(yt()),oe.push(pe))),Oe(oe,o.Unary,se)},YieldExpression:function(B,se,ee){var oe;return B.delegate?oe="yield*":oe="yield",B.argument&&(oe=$e(oe,this.generateExpression(B.argument,o.Yield,ke))),Oe(oe,o.Yield,se)},AwaitExpression:function(B,se,ee){var oe=$e(B.all?"await*":"await",this.generateExpression(B.argument,o.Await,ke));return Oe(oe,o.Await,se)},UpdateExpression:function(B,se,ee){return B.prefix?Oe([B.operator,this.generateExpression(B.argument,o.Unary,ke)],o.Unary,se):Oe([this.generateExpression(B.argument,o.Postfix,ke),B.operator],o.Postfix,se)},FunctionExpression:function(B,se,ee){var oe=[Dt(B,!0),"function"];return B.id?(oe.push(Ut(B)||yt()),oe.push(Pt(B.id))):oe.push(Ut(B)||O),oe.push(this.generateFunctionBody(B)),oe},ArrayPattern:function(B,se,ee){return this.ArrayExpression(B,se,ee,!0)},ArrayExpression:function(B,se,ee,oe){var pe,De,Ge=this;return B.elements.length?(De=oe?!1:B.elements.length>1,pe=["[",De?U:""],mt(function(Ve){var ut,Rt;for(ut=0,Rt=B.elements.length;ut<Rt;++ut)B.elements[ut]?(pe.push(De?Ve:""),pe.push(Ge.generateExpression(B.elements[ut],o.Assignment,ke))):(De&&pe.push(Ve),ut+1===Rt&&pe.push(",")),ut+1<Rt&&pe.push(","+(De?U:O))}),De&&!$t(We(pe).toString())&&pe.push(U),pe.push(De?M:""),pe.push("]"),pe):"[]"},RestElement:function(B,se,ee){return"..."+this.generatePattern(B.argument)},ClassExpression:function(B,se,ee){var oe,pe;return oe=["class"],B.id&&(oe=$e(oe,this.generateExpression(B.id,o.Sequence,ke))),B.superClass&&(pe=$e("extends",this.generateExpression(B.superClass,o.Unary,ke)),oe=$e(oe,pe)),oe.push(O),oe.push(this.generateStatement(B.body,pt)),oe},MethodDefinition:function(B,se,ee){var oe,pe;return B.static?oe=["static"+O]:oe=[],B.kind==="get"||B.kind==="set"?pe=[$e(B.kind,this.generatePropertyKey(B.key,B.computed)),this.generateFunctionBody(B.value)]:pe=[Kt(B),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)],$e(oe,pe)},Property:function(B,se,ee){return B.kind==="get"||B.kind==="set"?[B.kind,yt(),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)]:B.shorthand?B.value.type==="AssignmentPattern"?this.AssignmentPattern(B.value,o.Sequence,ke):this.generatePropertyKey(B.key,B.computed):B.method?[Kt(B),this.generatePropertyKey(B.key,B.computed),this.generateFunctionBody(B.value)]:[this.generatePropertyKey(B.key,B.computed),":"+O,this.generateExpression(B.value,o.Assignment,ke)]},ObjectExpression:function(B,se,ee){var oe,pe,De,Ge=this;return B.properties.length?(oe=B.properties.length>1,mt(function(){De=Ge.generateExpression(B.properties[0],o.Sequence,ke)}),!oe&&!_t(We(De).toString())?["{",O,De,O,"}"]:(mt(function(Ve){var ut,Rt;if(pe=["{",U,Ve,De],oe)for(pe.push(","+U),ut=1,Rt=B.properties.length;ut<Rt;++ut)pe.push(Ve),pe.push(Ge.generateExpression(B.properties[ut],o.Sequence,ke)),ut+1<Rt&&pe.push(","+U)}),$t(We(pe).toString())||pe.push(U),pe.push(M),pe.push("}"),pe)):"{}"},AssignmentPattern:function(B,se,ee){return this.generateAssignment(B.left,B.right,"=",se,ee)},ObjectPattern:function(B,se,ee){var oe,pe,De,Ge,Ve,ut=this;if(!B.properties.length)return"{}";if(Ge=!1,B.properties.length===1)Ve=B.properties[0],Ve.type===t.Property&&Ve.value.type!==t.Identifier&&(Ge=!0);else for(pe=0,De=B.properties.length;pe<De;++pe)if(Ve=B.properties[pe],Ve.type===t.Property&&!Ve.shorthand){Ge=!0;break}return oe=["{",Ge?U:""],mt(function(Rt){var Jt,fn;for(Jt=0,fn=B.properties.length;Jt<fn;++Jt)oe.push(Ge?Rt:""),oe.push(ut.generateExpression(B.properties[Jt],o.Sequence,ke)),Jt+1<fn&&oe.push(","+(Ge?U:O))}),Ge&&!$t(We(oe).toString())&&oe.push(U),oe.push(Ge?M:""),oe.push("}"),oe},ThisExpression:function(B,se,ee){return"this"},Super:function(B,se,ee){return"super"},Identifier:function(B,se,ee){return Pt(B)},ImportDefaultSpecifier:function(B,se,ee){return Pt(B.id||B.local)},ImportNamespaceSpecifier:function(B,se,ee){var oe=["*"],pe=B.id||B.local;return pe&&oe.push(O+"as"+yt()+Pt(pe)),oe},ImportSpecifier:function(B,se,ee){var oe=B.imported,pe=[oe.name],De=B.local;return De&&De.name!==oe.name&&pe.push(yt()+"as"+yt()+Pt(De)),pe},ExportSpecifier:function(B,se,ee){var oe=B.local,pe=[oe.name],De=B.exported;return De&&De.name!==oe.name&&pe.push(yt()+"as"+yt()+Pt(De)),pe},Literal:function(B,se,ee){var oe;if(B.hasOwnProperty("raw")&&re&&te.raw)try{if(oe=re(B.raw).body[0].expression,oe.type===t.Literal&&oe.value===B.value)return B.raw}catch{}return B.regex?"/"+B.regex.pattern+"/"+B.regex.flags:typeof B.value=="bigint"?B.value.toString()+"n":B.bigint?B.bigint+"n":B.value===null?"null":typeof B.value=="string"?He(B.value):typeof B.value=="number"?Yt(B.value):typeof B.value=="boolean"?B.value?"true":"false":xe(B.value)},GeneratorExpression:function(B,se,ee){return this.ComprehensionExpression(B,se,ee)},ComprehensionExpression:function(B,se,ee){var oe,pe,De,Ge,Ve=this;return oe=B.type===t.GeneratorExpression?["("]:["["],te.moz.comprehensionExpressionStartsWithAssignment&&(Ge=this.generateExpression(B.body,o.Assignment,ke),oe.push(Ge)),B.blocks&&mt(function(){for(pe=0,De=B.blocks.length;pe<De;++pe)Ge=Ve.generateExpression(B.blocks[pe],o.Sequence,ke),pe>0||te.moz.comprehensionExpressionStartsWithAssignment?oe=$e(oe,Ge):oe.push(Ge)}),B.filter&&(oe=$e(oe,"if"+O),Ge=this.generateExpression(B.filter,o.Sequence,ke),oe=$e(oe,["(",Ge,")"])),te.moz.comprehensionExpressionStartsWithAssignment||(Ge=this.generateExpression(B.body,o.Assignment,ke),oe=$e(oe,Ge)),oe.push(B.type===t.GeneratorExpression?")":"]"),oe},ComprehensionBlock:function(B,se,ee){var oe;return B.left.type===t.VariableDeclaration?oe=[B.left.kind,yt(),this.generateStatement(B.left.declarations[0],Ft)]:oe=this.generateExpression(B.left,o.Call,ke),oe=$e(oe,B.of?"of":"in"),oe=$e(oe,this.generateExpression(B.right,o.Sequence,ke)),["for"+O+"(",oe,")"]},SpreadElement:function(B,se,ee){return["...",this.generateExpression(B.argument,o.Assignment,ke)]},TaggedTemplateExpression:function(B,se,ee){var oe=Tt;ee&Ze||(oe=at);var pe=[this.generateExpression(B.tag,o.Call,oe),this.generateExpression(B.quasi,o.Primary,je)];return Oe(pe,o.TaggedTemplate,se)},TemplateElement:function(B,se,ee){return B.value.raw},TemplateLiteral:function(B,se,ee){var oe,pe,De;for(oe=["`"],pe=0,De=B.quasis.length;pe<De;++pe)oe.push(this.generateExpression(B.quasis[pe],o.Primary,ke)),pe+1<De&&(oe.push("${"+O),oe.push(this.generateExpression(B.expressions[pe],o.Sequence,ke)),oe.push(O+"}"));return oe.push("`"),oe},ModuleSpecifier:function(B,se,ee){return this.Literal(B,se,ee)},ImportExpression:function(B,se,ee){return Oe(["import(",this.generateExpression(B.source,o.Assignment,ke),")"],o.Call,se)}},rn(ot.prototype,ot.Expression),ot.prototype.generateExpression=function(B,se,ee){var oe,pe;return pe=B.type||t.Property,te.verbatim&&B.hasOwnProperty(te.verbatim)?sn(B,se):(oe=this[pe](B,se,ee),te.comment&&(oe=Et(B,oe)),We(oe,B))},ot.prototype.generateStatement=function(B,se){var ee,oe;return ee=this[B.type](B,se),te.comment&&(ee=Et(B,ee)),oe=We(ee).toString(),B.type===t.Program&&!ie&&U===""&&oe.charAt(oe.length-1)===`
`&&(ee=ue?We(ee).replaceRight(/\s+$/,""):oe.replace(/\s+$/,"")),We(ee,B)};function ln(B){var se;if(se=new ot,be(B))return se.generateStatement(B,nt);if(Ce(B))return se.generateExpression(B,o.Sequence,ke);throw new Error("Unknown node type: "+B.type)}function hn(B,se){var ee=Qt(),oe,pe;return se!=null?(typeof se.indent=="string"&&(ee.format.indent.style=se.indent),typeof se.base=="number"&&(ee.format.indent.base=se.base),se=Gt(ee,se),F=se.format.indent.style,typeof se.base=="string"?M=se.base:M=Bt(F,se.format.indent.base)):(se=ee,F=se.format.indent.style,M=Bt(F,se.format.indent.base)),S=se.format.json,k=se.format.renumber,N=S?!1:se.format.hexadecimal,$=S?"double":se.format.quotes,R=se.format.escapeless,U=se.format.newline,O=se.format.space,se.format.compact&&(U=O=F=M=""),Z=se.format.parentheses,K=se.format.semicolons,ie=se.format.safeConcatenation,de=se.directive,re=S?null:se.parse,ue=se.sourceMap,ve=se.sourceCode,Ae=se.format.preserveBlankLines&&ve!==null,te=se,ue&&(e.browser?f=commonjsGlobal.sourceMap.SourceNode:f=requireSourceMap().SourceNode),oe=ln(B),ue?(pe=oe.toStringWithSourceMap({file:se.file,sourceRoot:se.sourceMapRoot}),se.sourceContent&&pe.map.setSourceContent(se.sourceMap,se.sourceContent),se.sourceMapWithCode?pe:pe.map.toString()):(pe={code:oe.toString(),map:null},se.sourceMapWithCode?pe:pe.code)}Fe={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},we=Qt().format,e.version=require$$3.version,e.generate=hn,e.attachComments=p.attachComments,e.Precedence=Gt({},o),e.browser=!1,e.FORMAT_MINIFY=Fe,e.FORMAT_DEFAULTS=we})()})(escodegen$1)),escodegen$1}var escodegenExports=requireEscodegen();const escodegen=getDefaultExportFromCjs(escodegenExports);class WalkerBase{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:t=>this.replacement=t}}replace(t,o,u,f){t&&o&&(u!=null?t[o][u]=f:t[o]=f)}remove(t,o,u){t&&o&&(u!=null?t[o].splice(u,1):delete t[o])}}class SyncWalker extends WalkerBase{constructor(t,o){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:u=>this.replacement=u},this.enter=t,this.leave=o}visit(t,o,u,f){if(t){if(this.enter){const g=this.should_skip,M=this.should_remove,F=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,t,o,u,f),this.replacement&&(t=this.replacement,this.replace(o,u,f,t)),this.should_remove&&this.remove(o,u,f);const S=this.should_skip,k=this.should_remove;if(this.should_skip=g,this.should_remove=M,this.replacement=F,S)return t;if(k)return null}let p;for(p in t){const g=t[p];if(g&&typeof g=="object")if(Array.isArray(g)){const M=g;for(let F=0;F<M.length;F+=1){const S=M[F];isNode(S)&&(this.visit(S,t,p,F)||F--)}}else isNode(g)&&this.visit(g,t,p,null)}if(this.leave){const g=this.replacement,M=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,t,o,u,f),this.replacement&&(t=this.replacement,this.replace(o,u,f,t)),this.should_remove&&this.remove(o,u,f);const F=this.should_remove;if(this.replacement=g,this.should_remove=M,F)return null}}return t}}function isNode(e){return e!==null&&typeof e=="object"&&"type"in e&&typeof e.type=="string"}function walk(e,{enter:t,leave:o}){return new SyncWalker(t,o).visit(e,null)}let widgetMethods=[],languages=new Map;function transpiler(e,t={}){const{wrapAsync:o=!1,addReturn:u=!0,emitMiniLocations:f=!0,emitWidgets:p=!0}=t;let g=parse$a(e,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),M=[];const F=($,R)=>{const U=languages.get("minilang");if(U){const O=`[${$}]`,Z=U.getLocations(O,R.start);M=M.concat(Z)}else{const O=getLeafLocations(`"${$}"`,R.start,e);M=M.concat(O)}};let S=[];walk(g,{enter($,R){if(isLanguageLiteral($)){const{name:U}=$.tag,O=languages.get(U),Z=$.quasi.quasis[0].value.raw,K=$.quasi.start+1;if(f){const ie=O.getLocations(Z,K);M=M.concat(ie)}return this.skip(),this.replace(languageWithLocation(U,Z,K))}if(isTemplateLiteral($,"tidal")){const U=$.quasi.quasis[0].value.raw,O=$.quasi.start+1;if(f){const Z=collectHaskellMiniLocations(U,O);M=M.concat(Z)}return this.skip(),this.replace(tidalWithLocation(U,O))}if(isBackTickString($,R)){const{quasis:U}=$,{raw:O}=U[0].value;return this.skip(),f&&F(O,$),this.replace(miniWithLocation(O,$))}if(isStringWithDoubleQuotes($)){const{value:U}=$;return this.skip(),f&&F(U,$),this.replace(miniWithLocation(U,$))}if(isSliderFunction($))return p&&S.push({from:$.arguments[0].start,to:$.arguments[0].end,value:$.arguments[0].raw,min:$.arguments[1]?.value??0,max:$.arguments[2]?.value??1,step:$.arguments[3]?.value,type:"slider"}),this.replace(sliderWithLocation($));if(isWidgetMethod($)){const U=$.callee.property.name,O=S.filter(K=>K.type===U).length,Z={to:$.end,index:O,type:U,id:t.id};return p&&S.push(Z),this.replace(widgetWithLocation($,Z))}if(isBareSamplesCall($,R))return this.replace(withAwait($));if(isLabelStatement($))return this.replace(labelToP($))},leave($,R,U,O){}});let{body:k}=g;if(!k.length)console.warn("empty body -> fallback to silence"),k.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!k?.[k.length-1]?.expression)throw new Error("unexpected ast format without body expression");if(u){const{expression:$}=k[k.length-1];k[k.length-1]={type:"ReturnStatement",argument:$}}let N=escodegen.generate(g);return o&&(N=`(async ()=>{${N}})()`),f?{output:N,miniLocations:M,widgets:S}:{output:N}}function isStringWithDoubleQuotes(e,t,o){return e.type!=="Literal"?!1:e.raw[0]==='"'}function isBackTickString(e,t){return e.type==="TemplateLiteral"&&t.type!=="TaggedTemplateExpression"}function miniWithLocation(e,t){const{start:o}=t,u=languages.get("minilang");let f="m";return u&&u.name&&(f=u.name),{type:"CallExpression",callee:{type:"Identifier",name:f},arguments:[{type:"Literal",value:e},{type:"Literal",value:o}],optional:!1}}function isSliderFunction(e){return e.type==="CallExpression"&&e.callee.name==="slider"}function isWidgetMethod(e){return e.type==="CallExpression"&&widgetMethods.includes(e.callee.property?.name)}function sliderWithLocation(e){const t="slider_"+e.arguments[0].start;return e.arguments.unshift({type:"Literal",value:t,raw:t}),e.callee.name="sliderWithID",e}function getWidgetID(e){return`${e.id||""}_widget_${e.type}_${e.index}`}function widgetWithLocation(e,t){const o=getWidgetID(t);return e.arguments.unshift({type:"Literal",value:o,raw:o}),e}function isBareSamplesCall(e,t){return e.type==="CallExpression"&&e.callee.name==="samples"&&t.type!=="AwaitExpression"}function withAwait(e){return{type:"AwaitExpression",argument:e}}function isLabelStatement(e){return e.type==="LabeledStatement"}function labelToP(e){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:e.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:e.label.name,raw:`'${e.label.name}'`}]}}}function isLanguageLiteral(e){return e.type==="TaggedTemplateExpression"&&languages.has(e.tag.name)}function isTemplateLiteral(e,t){return e.type==="TaggedTemplateExpression"&&e.tag.name===t}function collectHaskellMiniLocations(e,t){return e.split("").reduce((o,u,f)=>(u!=='"'||(!o.length||o[o.length-1].length>1?o.push([f+1]):o[o.length-1].push(f)),o),[]).map(([o,u])=>{const f=e.slice(o,u);return getLeafLocations(`"${f}"`,t+o-1)}).flat()}function tidalWithLocation(e,t){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}function languageWithLocation(e,t,o){return{type:"CallExpression",callee:{type:"Identifier",name:e},arguments:[{type:"Literal",value:t},{type:"Literal",value:o}],optional:!1}}const gm={gm_piano:["0000_JCLive_sf2_file","0000_FluidR3_GM_sf2_file","0000_Aspirin_sf2_file","0000_Chaos_sf2_file","0000_GeneralUserGS_sf2_file","0001_FluidR3_GM_sf2_file","0001_GeneralUserGS_sf2_file","0010_Aspirin_sf2_file","0010_Chaos_sf2_file","0010_FluidR3_GM_sf2_file","0010_GeneralUserGS_sf2_file","0010_JCLive_sf2_file","0011_Aspirin_sf2_file","0011_FluidR3_GM_sf2_file","0011_GeneralUserGS_sf2_file","0012_GeneralUserGS_sf2_file","0020_Aspirin_sf2_file","0020_Chaos_sf2_file","0020_FluidR3_GM_sf2_file","0020_GeneralUserGS_sf2_file","0020_JCLive_sf2_file","0021_Aspirin_sf2_file","0021_GeneralUserGS_sf2_file","0022_Aspirin_sf2_file","0030_Aspirin_sf2_file","0030_Chaos_sf2_file","0030_FluidR3_GM_sf2_file","0030_GeneralUserGS_sf2_file","0030_JCLive_sf2_file","0031_Aspirin_sf2_file","0031_FluidR3_GM_sf2_file","0031_GeneralUserGS_sf2_file"],gm_epiano1:["0040_JCLive_sf2_file","0040_FluidR3_GM_sf2_file","0040_Aspirin_sf2_file","0040_Chaos_sf2_file","0040_GeneralUserGS_sf2_file","0041_FluidR3_GM_sf2_file","0041_GeneralUserGS_sf2_file","0042_GeneralUserGS_sf2_file","0043_GeneralUserGS_sf2_file","0044_GeneralUserGS_sf2_file","0046_GeneralUserGS_sf2_file"],gm_epiano2:["0050_JCLive_sf2_file","0050_FluidR3_GM_sf2_file","0050_Aspirin_sf2_file","0050_Chaos_sf2_file","0050_GeneralUserGS_sf2_file","0051_FluidR3_GM_sf2_file","0051_GeneralUserGS_sf2_file","0053_GeneralUserGS_sf2_file","0054_GeneralUserGS_sf2_file"],gm_harpsichord:["0060_JCLive_sf2_file","0060_FluidR3_GM_sf2_file","0060_Aspirin_sf2_file","0060_Chaos_sf2_file","0060_GeneralUserGS_sf2_file","0061_Aspirin_sf2_file","0061_GeneralUserGS_sf2_file","0062_GeneralUserGS_sf2_file"],gm_clavinet:["0070_JCLive_sf2_file","0070_FluidR3_GM_sf2_file","0070_Aspirin_sf2_file","0070_Chaos_sf2_file"],gm_celesta:["0080_JCLive_sf2_file","0080_Aspirin_sf2_file","0080_Chaos_sf2_file","0080_FluidR3_GM_sf2_file","0080_GeneralUserGS_sf2_file","0081_FluidR3_GM_sf2_file"],gm_glockenspiel:["0090_JCLive_sf2_file","0090_Aspirin_sf2_file","0090_Chaos_sf2_file","0090_FluidR3_GM_sf2_file","0090_GeneralUserGS_sf2_file"],gm_music_box:["0100_JCLive_sf2_file","0100_Aspirin_sf2_file","0100_Chaos_sf2_file","0100_FluidR3_GM_sf2_file","0100_GeneralUserGS_sf2_file"],gm_vibraphone:["0110_JCLive_sf2_file","0110_Aspirin_sf2_file","0110_Chaos_sf2_file","0110_FluidR3_GM_sf2_file","0110_GeneralUserGS_sf2_file","0111_FluidR3_GM_sf2_file"],gm_marimba:["0120_JCLive_sf2_file","0120_Aspirin_sf2_file","0120_Chaos_sf2_file","0120_FluidR3_GM_sf2_file","0120_GeneralUserGS_sf2_file","0121_FluidR3_GM_sf2_file","0121_GeneralUserGS_sf2_file"],gm_xylophone:["0130_JCLive_sf2_file","0130_Aspirin_sf2_file","0130_Chaos_sf2_file","0130_FluidR3_GM_sf2_file","0130_GeneralUserGS_sf2_file","0131_FluidR3_GM_sf2_file"],gm_tubular_bells:["0140_JCLive_sf2_file","0140_Aspirin_sf2_file","0140_FluidR3_GM_sf2_file","0140_GeneralUserGS_sf2_file","0141_FluidR3_GM_sf2_file","0142_GeneralUserGS_sf2_file"],gm_dulcimer:["0150_Aspirin_sf2_file","0150_Chaos_sf2_file","0150_FluidR3_GM_sf2_file","0150_GeneralUserGS_sf2_file","0151_FluidR3_GM_sf2_file"],gm_drawbar_organ:["0160_JCLive_sf2_file","0160_Aspirin_sf2_file","0160_Chaos_sf2_file","0160_FluidR3_GM_sf2_file","0160_GeneralUserGS_sf2_file","0161_Aspirin_sf2_file","0161_FluidR3_GM_sf2_file"],gm_percussive_organ:["0170_JCLive_sf2_file","0170_Aspirin_sf2_file","0170_Chaos_sf2_file","0170_FluidR3_GM_sf2_file","0171_FluidR3_GM_sf2_file","0172_FluidR3_GM_sf2_file"],gm_rock_organ:["0180_JCLive_sf2_file","0180_Aspirin_sf2_file","0180_Chaos_sf2_file","0180_FluidR3_GM_sf2_file","0180_GeneralUserGS_sf2_file"],gm_church_organ:["0190_JCLive_sf2_file","0190_Aspirin_sf2_file","0190_Chaos_sf2_file","0190_FluidR3_GM_sf2_file","0190_GeneralUserGS_sf2_file"],gm_reed_organ:["0200_JCLive_sf2_file","0200_Aspirin_sf2_file","0200_Chaos_sf2_file","0200_FluidR3_GM_sf2_file","0200_GeneralUserGS_sf2_file","0201_Aspirin_sf2_file","0201_FluidR3_GM_sf2_file","0201_GeneralUserGS_sf2_file"],gm_accordion:["0210_JCLive_sf2_file","0210_FluidR3_GM_sf2_file","0210_GeneralUserGS_sf2_file","0211_Aspirin_sf2_file","0211_FluidR3_GM_sf2_file","0211_GeneralUserGS_sf2_file","0212_GeneralUserGS_sf2_file"],gm_harmonica:["0220_FluidR3_GM_sf2_file","0220_JCLive_sf2_file","0220_Aspirin_sf2_file","0220_Chaos_sf2_file","0220_GeneralUserGS_sf2_file","0221_FluidR3_GM_sf2_file"],gm_bandoneon:["0230_Aspirin_sf2_file","0230_JCLive_sf2_file","0230_Chaos_sf2_file","0230_FluidR3_GM_sf2_file","0230_GeneralUserGS_sf2_file","0231_FluidR3_GM_sf2_file","0231_GeneralUserGS_sf2_file","0231_JCLive_sf2_file","0232_FluidR3_GM_sf2_file","0233_FluidR3_GM_sf2_file"],gm_acoustic_guitar_nylon:["0240_JCLive_sf2_file","0240_Aspirin_sf2_file","0240_Chaos_sf2_file","0240_FluidR3_GM_sf2_file","0240_GeneralUserGS_sf2_file","0240_LK_Godin_Nylon_SF2_file","0241_JCLive_sf2_file","0242_JCLive_sf2_file","0243_JCLive_sf2_file"],gm_acoustic_guitar_steel:["0253_Acoustic_Guitar_sf2_file","0250_Aspirin_sf2_file","0250_Chaos_sf2_file","0250_FluidR3_GM_sf2_file","0250_GeneralUserGS_sf2_file","0250_LK_AcousticSteel_SF2_file","0253_Acoustic_Guitar_sf2_file","0253_GeneralUserGS_sf2_file","0254_Acoustic_Guitar_sf2_file","0254_GeneralUserGS_sf2_file"],gm_electric_guitar_jazz:["0260_JCLive_sf2_file","0260_Aspirin_sf2_file","0260_Chaos_sf2_file","0260_FluidR3_GM_sf2_file","0260_GeneralUserGS_sf2_file","0260_Stratocaster_sf2_file","0261_GeneralUserGS_sf2_file","0261_Stratocaster_sf2_file","0262_Stratocaster_sf2_file"],gm_electric_guitar_clean:["0270_Aspirin_sf2_file","0270_Chaos_sf2_file","0270_FluidR3_GM_sf2_file","0270_GeneralUserGS_sf2_file","0270_SBAWE32_sf2_file","0270_Stratocaster_sf2_file","0271_GeneralUserGS_sf2_file","0271_Stratocaster_sf2_file","0272_Stratocaster_sf2_file"],gm_electric_guitar_muted:["0280_Aspirin_sf2_file","0280_Chaos_sf2_file","0280_GeneralUserGS_sf2_file","0280_JCLive_sf2_file","0280_LesPaul_sf2_file","0280_SBAWE32_sf2_file","0281_Aspirin_sf2_file","0281_FluidR3_GM_sf2_file","0281_GeneralUserGS_sf2_file","0282_FluidR3_GM_sf2_file"],gm_overdriven_guitar:["0290_FluidR3_GM_sf2_file","0290_Aspirin_sf2_file","0290_Chaos_sf2_file","0290_GeneralUserGS_sf2_file","0290_LesPaul_sf2_file","0290_SBAWE32_sf2_file","0291_LesPaul_sf2_file","0291_SBAWE32_sf2_file","0292_Aspirin_sf2_file","0292_LesPaul_sf2_file"],gm_distortion_guitar:["0300_FluidR3_GM_sf2_file","0300_Aspirin_sf2_file","0300_Chaos_sf2_file","0300_GeneralUserGS_sf2_file","0300_LesPaul_sf2_file","0302_Aspirin_sf2_file","0304_Aspirin_sf2_file"],gm_guitar_harmonics:["0310_Aspirin_sf2_file","0310_FluidR3_GM_sf2_file","0310_Chaos_sf2_file"],gm_acoustic_bass:["0320_JCLive_sf2_file","0320_FluidR3_GM_sf2_file","0320_Aspirin_sf2_file","0320_Chaos_sf2_file"],gm_electric_bass_finger:["0330_JCLive_sf2_file","0330_FluidR3_GM_sf2_fible","0330_Aspirin_sf2_file","0330_GeneralUserGS_sf2_file"],gm_electric_bass_pick:["0340_JCLive_sf2_file","0340_FluidR3_GM_sf2_file","0340_Aspirin_sf2_file","0340_GeneralUserGS_sf2_file","0341_Aspirin_sf2_file"],gm_fretless_bass:["0350_Aspirin_sf2_file","0350_JCLive_sf2_file"],gm_slap_bass_1:["0360_Aspirin_sf2_file","0360_JCLive_sf2_file","0360_FluidR3_GM_sf2_file","0360_Chaos_sf2_file"],gm_slap_bass_2:["0370_Aspirin_sf2_file","0370_FluidR3_GM_sf2_file","0370_GeneralUserGS_sf2_fil e","0370_JCLive_sf2_file"],gm_synth_bass_1:["0380_Chaos_sf2_file","0380_FluidR3_GM_sf2_file","0380_JCLive_sf2_file","0381_FluidR3_GM_sf2_file","0381_GeneralUserGS_sf2_file","0382_GeneralUserGS_sf2_file","0383_GeneralUserGS_sf2_file","0384_GeneralUserGS_sf2_file","0387_GeneralUserGS_sf2_file"],gm_synth_bass_2:["0390_Aspirin_sf2_file","0390_FluidR3_GM_sf2_file","0390_GeneralUserGS_sf2_file","0390_JCLive_sf2_file","0391_FluidR3_GM_sf2_file","0392_FluidR3_GM_sf2_file","0393_GeneralUserGS_sf2_file"],gm_violin:["0400_Aspirin_sf2_file","0400_Chaos_sf2_file","0400_JCLive_sf2_file","0400_FluidR3_GM_sf2_file","0400_GeneralUserGS_sf2_file","0401_Aspirin_sf2_file","0401_FluidR3_GM_sf2_file","0401_GeneralUserGS_sf2_file","0402_GeneralUserGS_sf2_file"],gm_viola:["0410_Aspirin_sf2_file","0410_FluidR3_GM_sf2_file","0410_GeneralUserGS_sf2_file","0410_JCLive_sf2_file","0411_FluidR3_GM_sf2_file"],gm_cello:["0420_Aspirin_sf2_file","0420_FluidR3_GM_sf2_file","0420_GeneralUserGS_sf2_file","0420_JCLive_sf2_file","0421_FluidR3_GM_sf2_file","0421_GeneralUserGS_sf2_file"],gm_contrabass:["0430_Aspirin_sf2_file","0430_Chaos_sf2_file","0430_GeneralUserGS_sf2_file"],gm_tremolo_strings:["0440_Aspirin_sf2_file","0440_Chaos_sf2_file","0440_GeneralUserGS_sf2_file","0440_JCLive_sf2_file","0441_GeneralUserGS_sf2_file","0442_GeneralUserGS_sf2_file"],gm_pizzicato_strings:["0450_Aspirin_sf2_file","0450_Chaos_sf2_file","0450_FluidR3_GM_sf2_file","0450_GeneralUserGS_sf2_file","0450_JCLive_sf2_file","0451_FluidR3_GM_sf2_file"],gm_orchestral_harp:["0460_Aspirin_sf2_file","0460_FluidR3_GM_sf2_file","0460_GeneralUserGS_sf2_file","0460_JCLive_sf2_file","0461_FluidR3_GM_sf2_file"],gm_timpani:["0470_Aspirin_sf2_file","0470_Chaos_sf2_file","0470_FluidR3_GM_sf2_file","0470_GeneralUserGS_sf2_file","0471_FluidR3_GM_sf2_file","0471_GeneralUserGS_sf2_file"],gm_string_ensemble_1:["0480_Aspirin_sf2_file","0480_Chaos_sf2_file","0480_FluidR3_GM_sf2_file","0480_GeneralUserGS_sf2_file","0480_JCLive_sf2_file","0481_Aspirin_sf2_file","0481_FluidR3_GM_sf2_file","0481_GeneralUserGS_sf2_file","0482_Aspirin_sf2_file","0482_GeneralUserGS_sf2_file","0483_GeneralUserGS_sf2_file"],gm_string_ensemble_2:["0490_Aspirin_sf2_file","0490_Chaos_sf2_file","0490_FluidR3_GM_sf2_file","0490_GeneralUserGS_sf2_file","0490_JCLive_sf2_file","0491_GeneralUserGS_sf2_file","0492_GeneralUserGS_sf2_file"],gm_synth_strings_1:["0500_Aspirin_sf2_file","0500_GeneralUserGS_sf2_file","0500_JCLive_sf2_file","0501_FluidR3_GM_sf2_file","0502_GeneralUserGS_sf2_file","0503_FluidR3_GM_sf2_file","0505_FluidR3_GM_sf2_file"],gm_synth_strings_2:["0510_Aspirin_sf2_file","0510_Chaos_sf2_file","0510_GeneralUserGS_sf2_file","0511_GeneralUserGS_sf2_file"],gm_choir_aahs:["0520_Aspirin_sf2_file","0520_Chaos_sf2_file","0520_FluidR3_GM_sf2_file","0520_GeneralUserGS_sf2_file","0520_JCLive_sf2_file","0520_Soul_Ahhs_sf2_file","0521_FluidR3_GM_sf2_file","0521_Soul_Ahhs_sf2_file","0522_Soul_Ahhs_sf2_file"],gm_voice_oohs:["0530_Aspirin_sf2_file","0530_Chaos_sf2_file","0530_FluidR3_GM_sf2_file","0530_GeneralUserGS_sf2_file","0531_FluidR3_GM_sf2_file","0531_JCLive_sf2_file"],gm_synth_choir:["0540_Aspirin_sf2_file","0540_Chaos_sf2_file","0540_FluidR3_GM_sf2_file","0540_GeneralUserGS_sf2_file","0541_FluidR3_GM_sf2_file"],gm_orchestra_hit:["0550_Aspirin_sf2_file","0550_Chaos_sf2_file","0550_FluidR3_GM_sf2_file","0550_GeneralUserGS_sf2_file","0551_FluidR3_GM_sf2_file"],gm_trumpet:["0560_FluidR3_GM_sf2_file","0560_JCLive_sf2_file","0560_Aspirin_sf2_file","0560_Chaos_sf2_file"],gm_trombone:["0570_Aspirin_sf2_file","0570_Chaos_sf2_file","0570_FluidR3_GM_sf2_file","0570_GeneralUserGS_sf2_file","0571_GeneralUserGS_sf2_file"],gm_tuba:["0580_FluidR3_GM_sf2_file","0580_Aspirin_sf2_file","0580_Chaos_sf2_file","0580_GeneralUserGS_sf2_file"],gm_muted_trumpet:["0590_JCLive_sf2_file","0590_Aspirin_sf2_file","0590_Chaos_sf2_file","0590_FluidR3_GM_sf2_file","0590_GeneralUserGS_sf2_file"],gm_french_horn:["0600_Aspirin_sf2_file","0600_FluidR3_GM_sf2_file","0600_GeneralUserGS_sf2_file","0600_JCLive_sf2_file","0601_FluidR3_GM_sf2_file"],gm_brass_section:["0610_JCLive_sf2_file","0610_Aspirin_sf2_file","0610_Chaos_sf2_file","0610_FluidR3_GM_sf2_file","0610_GeneralUserGS_sf2_file"],gm_synth_brass_1:["0620_Aspirin_sf2_file","0620_FluidR3_GM_sf2_file","0621_Aspirin_sf2_file","0621_FluidR3_GM_sf2_file"],gm_synth_brass_2:["0630_Aspirin_sf2_file","0630_Chaos_sf2_file","0630_FluidR3_GM_sf2_file","0630_JCLive_sf2_file","0631_FluidR3_GM_sf2_file","0632_FluidR3_GM_sf2_file","0633_FluidR3_GM_sf2_file"],gm_soprano_sax:["0640_JCLive_sf2_file","0640_Aspirin_sf2_file","0640_Chaos_sf2_file","0640_FluidR3_GM_sf2_file","0641_FluidR3_GM_sf2_file"],gm_alto_sax:["0650_JCLive_sf2_file","0650_Chaos_sf2_file","0650_FluidR3_GM_sf2_file","0650_GeneralUserGS_sf2_file","0651_Aspirin_sf2_file","0651_FluidR3_GM_sf2_file"],gm_tenor_sax:["0660_JCLive_sf2_file","0660_Aspirin_sf2_file","0660_Chaos_sf2_file","0660_GeneralUserGS_sf2_file"],gm_baritone_sax:["0670_JCLive_sf2_file","0670_Aspirin_sf2_file","0670_Chaos_sf2_file","0670_FluidR3_GM_sf2_file","0670_GeneralUserGS_sf2_file","0671_FluidR3_GM_sf2_file"],gm_oboe:["0680_JCLive_sf2_file","0680_Chaos_sf2_file","0680_FluidR3_GM_sf2_file","0680_GeneralUserGS_sf2_file","0681_FluidR3_GM_sf2_file"],gm_english_horn:["0690_JCLive_sf2_file","0690_Aspirin_sf2_file","0690_FluidR3_GM_sf2_file","0691_FluidR3_GM_sf2_file"],gm_bassoon:["0700_JCLive_sf2_file","0700_FluidR3_GM_sf2_file","0700_GeneralUserGS_sf2_file","0701_FluidR3_GM_sf2_file"],gm_clarinet:["0710_JCLive_sf2_file","0710_Aspirin_sf2_file","0710_Chaos_sf2_file","0710_FluidR3_GM_sf2_file","0710_GeneralUserGS_sf2_file","0711_FluidR3_GM_sf2_file"],gm_piccolo:["0720_JCLive_sf2_file","0720_Aspirin_sf2_file","0720_FluidR3_GM_sf2_file","0720_GeneralUserGS_sf2_file","0721_FluidR3_GM_sf2_file"],gm_flute:["0730_JCLive_sf2_file","0730_Aspirin_sf2_file","0730_FluidR3_GM_sf2_file","0730_GeneralUserGS_sf2_file","0731_FluidR3_GM_sf2_file"],gm_recorder:["0740_JCLive_sf2_file","0740_Aspirin_sf2_file","0740_Chaos_sf2_file","0740_FluidR3_GM_sf2_file","0740_GeneralUserGS_sf2_file"],gm_pan_flute:["0750_JCLive_sf2_file","0750_FluidR3_GM_sf2_file","0750_Aspirin_sf2_file","0750_Chaos_sf2_file","0750_GeneralUserGS_sf2_file","0751_Aspirin_sf2_file","0751_FluidR3_GM_sf2_file","0751_GeneralUserGS_sf2_file"],gm_blown_bottle:["0760_FluidR3_GM_sf2_file","0760_JCLive_sf2_file","0760_Chaos_sf2_file","0760_GeneralUserGS_sf2_file","0761_FluidR3_GM_sf2_file"],gm_shakuhachi:["0770_JCLive_sf2_file","0771_FluidR3_GM_sf2_file","0770_Aspirin_sf2_file","0770_FluidR3_GM_sf2_file","0770_GeneralUserGS_sf2_file"],gm_whistle:["0780_FluidR3_GM_sf2_file","0780_JCLive_sf2_file","0780_Aspirin_sf2_file","0780_Chaos_sf2_file"],gm_ocarina:["0790_FluidR3_GM_sf2_file","0790_JCLive_sf2_file","0790_Aspirin_sf2_file","0790_GeneralUserGS_sf2_file"],gm_lead_1_square:["0800_Aspirin_sf2_file","0800_Chaos_sf2_file","0800_FluidR3_GM_sf2_file"],gm_lead_2_sawtooth:["0810_JCLive_sf2_file","0810_Aspirin_sf2_file","0810_Chaos_sf2_file","0810_FluidR3_GM_sf2_file","0810_GeneralUserGS_sf2_file","0811_Aspirin_sf2_file","0811_GeneralUserGS_sf2_file"],gm_lead_3_calliope:["0820_JCLive_sf2_file","0820_Aspirin_sf2_file","0820_Chaos_sf2_file","0820_FluidR3_GM_sf2_file","0820_GeneralUserGS_sf2_file","0821_FluidR3_GM_sf2_file","0821_GeneralUserGS_sf2_file"],gm_lead_4_chiff:["0830_JCLive_sf2_file","0830_Aspirin_sf2_file","0830_FluidR3_GM_sf2_file","0830_GeneralUserGS_sf2_file","0831_FluidR3_GM_sf2_file","0831_GeneralUserGS_sf2_file"],gm_lead_5_charang:["0840_JCLive_sf2_file","0840_FluidR3_GM_sf2_file","0840_Aspirin_sf2_file","0840_Chaos_sf2_file","0840_GeneralUserGS_sf2_file","0841_Aspirin_sf2_file","0841_Chaos_sf2_file","0841_FluidR3_GM_sf2_file","0841_GeneralUserGS_sf2_file","0842_FluidR3_GM_sf2_file"],gm_lead_6_voice:["0850_JCLive_sf2_file","0850_Aspirin_sf2_file","0850_FluidR3_GM_sf2_file","0851_FluidR3_GM_sf2_file","0851_GeneralUserGS_sf2_file","0851_JCLive_sf2_file"],gm_lead_7_fifths:["0860_JCLive_sf2_file","0860_Aspirin_sf2_file","0860_Chaos_sf2_file","0860_GeneralUserGS_sf2_file","0861_Aspirin_sf2_file"],gm_lead_8_bass_lead:["0870_JCLive_sf2_file","0870_Aspirin_sf2_file","0870_Chaos_sf2_file","0870_FluidR3_GM_sf2_file","0870_GeneralUserGS_sf2_file"],gm_pad_new_age:["0880_JCLive_sf2_file","0880_Aspirin_sf2_file","0880_Chaos_sf2_file","0880_FluidR3_GM_sf2_file","0880_GeneralUserGS_sf2_file","0881_Aspirin_sf2_file","0881_FluidR3_GM_sf2_file","0881_GeneralUserGS_sf2_file","0882_Aspirin_sf2_file","0882_GeneralUserGS_sf2_file","0885_GeneralUserGS_sf2_file","0887_GeneralUserGS_sf2_file"],gm_pad_warm:["0890_JCLive_sf2_file","0890_Aspirin_sf2_file","0890_Chaos_sf2_file","0890_FluidR3_GM_sf2_file","0890_GeneralUserGS_sf2_file","0891_Aspirin_sf2_file","0891_FluidR3_GM_sf2_file"],gm_pad_poly:["0900_JCLive_sf2_file","0900_Chaos_sf2_file","0900_FluidR3_GM_sf2_file","0900_GeneralUserGS_sf2_file","0901_Aspirin_sf2_file","0901_FluidR3_GM_sf2_file","0901_GeneralUserGS_sf2_file"],gm_pad_choir:["0910_FluidR3_GM_sf2_file","0910_JCLive_sf2_file","0910_Aspirin_sf2_file","0910_GeneralUserGS_sf2_file","0911_GeneralUserGS_sf2_file","0911_JCLive_sf2_file"],gm_pad_bowed:["0920_JCLive_sf2_file","0920_Aspirin_sf2_file","0920_GeneralUserGS_sf2_file","0921_Aspirin_sf2_file","0921_GeneralUserGS_sf2_file"],gm_pad_metallic:["0930_Aspirin_sf2_file","0930_Chaos_sf2_file","0930_FluidR3_GM_sf2_file","0930_GeneralUserGS_sf2_file","0931_Aspirin_sf2_file","0931_FluidR3_GM_sf2_file","0931_GeneralUserGS_sf2_file"],gm_pad_halo:["0940_Chaos_sf2_file","0940_FluidR3_GM_sf2_file","0940_GeneralUserGS_sf2_file","0940_JCLive_sf2_file","0941_Aspirin_sf2_file","0941_FluidR3_GM_sf2_file","0941_GeneralUserGS_sf2_file","0941_JCLive_sf2_file"],gm_pad_sweep:["0950_Aspirin_sf2_file","0950_Chaos_sf2_file","0950_FluidR3_GM_sf2_file","0950_GeneralUserGS_sf2_file","0950_JCLive_sf2_file","0951_FluidR3_GM_sf2_file","0951_GeneralUserGS_sf2_file"],gm_fx_rain:["0960_FluidR3_GM_sf2_file","0960_Chaos_sf2_file","0960_GeneralUserGS_sf2_file","0961_Aspirin_sf2_file","0961_FluidR3_GM_sf2_file","0962_GeneralUserGS_sf2_file"],gm_fx_soundtrack:["0970_FluidR3_GM_sf2_file","0970_Aspirin_sf2_file","0970_GeneralUserGS_sf2_file","0971_FluidR3_GM_sf2_file","0971_GeneralUserGS_sf2_file"],gm_fx_crystal:["0980_Aspirin_sf2_file","0980_JCLive_sf2_file","0980_Chaos_sf2_file","0980_GeneralUserGS_sf2_file","0981_FluidR3_GM_sf2_file","0981_Aspirin_sf2_file","0981_GeneralUserGS_sf2_file","0982_GeneralUserGS_sf2_file","0983_GeneralUserGS_sf2_file","0984_GeneralUserGS_sf2_file"],gm_fx_atmosphere:["0990_JCLive_sf2_file","0990_Aspirin_sf2_file","0990_Chaos_sf2_file","0990_FluidR3_GM_sf2_file","0990_GeneralUserGS_sf2_file","0991_Aspirin_sf2_file","0991_FluidR3_GM_sf2_file","0991_GeneralUserGS_sf2_file","0991_JCLive_sf2_file","0992_FluidR3_GM_sf2_file","0992_JCLive_sf2_file","0993_JCLive_sf2_file","0994_JCLive_sf2_file"],gm_fx_brightness:["1000_JCLive_sf2_file","1000_Aspirin_sf2_file","1000_Chaos_sf2_file","1000_FluidR3_GM_sf2_file","1000_GeneralUserGS_sf2_file","1001_Aspirin_sf2_file","1001_FluidR3_GM_sf2_file","1001_GeneralUserGS_sf2_file","1001_JCLive_sf2_file","1002_Aspirin_sf2_file","1002_FluidR3_GM_sf2_file","1002_GeneralUserGS_sf2_file"],gm_fx_goblins:["1010_FluidR3_GM_sf2_file","1010_JCLive_sf2_file","1010_Aspirin_sf2_file","1010_Chaos_sf2_file","1010_GeneralUserGS_sf2_file","1011_Aspirin_sf2_file","1011_FluidR3_GM_sf2_file","1011_JCLive_sf2_file","1012_Aspirin_sf2_file"],gm_fx_echoes:["1020_FluidR3_GM_sf2_file","1020_JCLive_sf2_file","1020_Aspirin_sf2_file","1020_Chaos_sf2_file","1020_GeneralUserGS_sf2_file","1021_Aspirin_sf2_file","1021_FluidR3_GM_sf2_file","1021_GeneralUserGS_sf2_file","1021_JCLive_sf2_file","1022_GeneralUserGS_sf2_file"],gm_fx_sci_fi:["1030_FluidR3_GM_sf2_file","1030_Aspirin_sf2_file","1030_Chaos_sf2_file","1030_GeneralUserGS_sf2_file","1030_JCLive_sf2_file","1031_Aspirin_sf2_file","1031_FluidR3_GM_sf2_file","1031_GeneralUserGS_sf2_file","1032_FluidR3_GM_sf2_file"],gm_sitar:["1040_Aspirin_sf2_file","1040_FluidR3_GM_sf2_file","1040_JCLive_sf2_file","1040_Chaos_sf2_file","1040_GeneralUserGS_sf2_file","1041_FluidR3_GM_sf2_file","1041_GeneralUserGS_sf2_file"],gm_banjo:["1050_FluidR3_GM_sf2_file","1050_JCLive_sf2_file","1050_Aspirin_sf2_file","1050_Chaos_sf2_file","1050_GeneralUserGS_sf2_file","1051_GeneralUserGS_sf2_file"],gm_shamisen:["1060_JCLive_sf2_file","1060_FluidR3_GM_sf2_file","1060_Aspirin_sf2_file","1060_Chaos_sf2_file","1060_GeneralUserGS_sf2_file","1061_FluidR3_GM_sf2_file","1061_GeneralUserGS_sf2_file"],gm_koto:["1070_FluidR3_GM_sf2_file","1070_JCLive_sf2_file","1070_Aspirin_sf2_file","1070_Chaos_sf2_file","1070_GeneralUserGS_sf2_file","1071_FluidR3_GM_sf2_file","1071_GeneralUserGS_sf2_file","1072_GeneralUserGS_sf2_file","1073_GeneralUserGS_sf2_file"],gm_kalimba:["1080_JCLive_sf2_file","1080_FluidR3_GM_sf2_file","1080_Aspirin_sf2_file","1080_Chaos_sf2_file","1080_GeneralUserGS_sf2_file"],gm_bagpipe:["1090_Aspirin_sf2_file"],gm_fiddle:["1100_JCLive_sf2_file","1100_Aspirin_sf2_file","1100_Chaos_sf2_file","1100_FluidR3_GM_sf2_file","1100_GeneralUserGS_sf2_file","1101_Aspirin_sf2_file","1101_FluidR3_GM_sf2_file","1101_GeneralUserGS_sf2_file","1102_GeneralUserGS_sf2_file"],gm_shanai:["1110_Aspirin_sf2_file","1110_FluidR3_GM_sf2_file","1110_JCLive_sf2_file","1110_Chaos_sf2_file","1110_GeneralUserGS_sf2_file"],gm_tinkle_bell:["1120_Aspirin_sf2_file"],gm_agogo:["1130_JCLive_sf2_file","1130_Aspirin_sf2_file","1130_Chaos_sf2_file","1130_FluidR3_GM_sf2_file","1130_GeneralUserGS_sf2_file","1131_FluidR3_GM_sf2_file"],gm_steel_drums:["1140_FluidR3_GM_sf2_file","1140_Aspirin_sf2_file","1140_JCLive_sf2_file","1140_Chaos_sf2_file","1140_GeneralUserGS_sf2_file","1141_FluidR3_GM_sf2_file"],gm_woodblock:["1150_JCLive_sf2_file","1150_Aspirin_sf2_file","1150_Chaos_sf2_file","1150_FluidR3_GM_sf2_file","1150_GeneralUserGS_sf2_file","1151_FluidR3_GM_sf2_file","1151_GeneralUserGS_sf2_file","1152_FluidR3_GM_sf2_file","1152_GeneralUserGS_sf2_file"],gm_taiko_drum:["1160_JCLive_sf2_file","1160_FluidR3_GM_sf2_file","1160_Aspirin_sf2_file","1160_Chaos_sf2_file","1160_GeneralUserGS_sf2_file","1161_FluidR3_GM_sf2_file","1161_GeneralUserGS_sf2_file","1162_FluidR3_GM_sf2_file","1162_GeneralUserGS_sf2_file","1163_FluidR3_GM_sf2_file"],gm_melodic_tom:["1170_JCLive_sf2_file","1170_Aspirin_sf2_file","1170_Chaos_sf2_file","1170_FluidR3_GM_sf2_file","1170_GeneralUserGS_sf2_file","1171_FluidR3_GM_sf2_file","1171_GeneralUserGS_sf2_file","1172_FluidR3_GM_sf2_file","1173_FluidR3_GM_sf2_file"],gm_synth_drum:["1180_JCLive_sf2_file","1180_Aspirin_sf2_file","1180_Chaos_sf2_file","1180_FluidR3_GM_sf2_file","1180_GeneralUserGS_sf2_file","1181_FluidR3_GM_sf2_file","1181_GeneralUserGS_sf2_file"],gm_reverse_cymbal:["1190_JCLive_sf2_file","1190_Aspirin_sf2_file","1190_Chaos_sf2_file","1190_FluidR3_GM_sf2_file","1190_GeneralUserGS_sf2_file","1191_GeneralUserGS_sf2_file","1192_GeneralUserGS_sf2_file","1193_GeneralUserGS_sf2_file","1194_GeneralUserGS_sf2_file"],gm_guitar_fret_noise:["1200_JCLive_sf2_file","1200_Aspirin_sf2_file","1200_Chaos_sf2_file","1200_FluidR3_GM_sf2_file","1200_GeneralUserGS_sf2_file","1201_Aspirin_sf2_file","1201_GeneralUserGS_sf2_file","1202_GeneralUserGS_sf2_file"],gm_breath_noise:["1210_FluidR3_GM_sf2_file","1210_JCLive_sf2_file","1210_Aspirin_sf2_file","1210_Chaos_sf2_file","1210_GeneralUserGS_sf2_file","1211_Aspirin_sf2_file","1211_GeneralUserGS_sf2_file","1212_GeneralUserGS_sf2_file"],gm_seashore:["1220_JCLive_sf2_file","1220_Aspirin_sf2_file","1220_Chaos_sf2_file","1220_FluidR3_GM_sf2_file","1220_GeneralUserGS_sf2_file","1221_Aspirin_sf2_file","1221_GeneralUserGS_sf2_file","1221_JCLive_sf2_file","1222_Aspirin_sf2_file","1222_GeneralUserGS_sf2_file","1223_Aspirin_sf2_file","1223_GeneralUserGS_sf2_file","1224_Aspirin_sf2_file","1224_GeneralUserGS_sf2_file","1225_GeneralUserGS_sf2_file","1226_GeneralUserGS_sf2_file"],gm_bird_tweet:["1230_FluidR3_GM_sf2_file","1230_JCLive_sf2_file","1230_Aspirin_sf2_file","1230_GeneralUserGS_sf2_file","1231_GeneralUserGS_sf2_file","1232_GeneralUserGS_sf2_file","1234_GeneralUserGS_sf2_file"],gm_telephone:["1240_JCLive_sf2_file","1240_Aspirin_sf2_file","1240_Chaos_sf2_file","1240_FluidR3_GM_sf2_file","1241_Aspirin_sf2_file","1242_GeneralUserGS_sf2_file","1243_Aspirin_sf2_file","1243_GeneralUserGS_sf2_file","1244_Aspirin_sf2_file","1244_GeneralUserGS_sf2_file"],gm_helicopter:["1250_JCLive_sf2_file","1250_Aspirin_sf2_file","1250_FluidR3_GM_sf2_file","1250_GeneralUserGS_sf2_file","1251_FluidR3_GM_sf2_file","1251_GeneralUserGS_sf2_file","1252_Aspirin_sf2_file","1252_FluidR3_GM_sf2_file","1252_GeneralUserGS_sf2_file","1253_GeneralUserGS_sf2_file","1254_GeneralUserGS_sf2_file","1255_GeneralUserGS_sf2_file","1256_GeneralUserGS_sf2_file","1257_GeneralUserGS_sf2_file","1258_GeneralUserGS_sf2_file","1259_GeneralUserGS_sf2_file"],gm_applause:["1260_JCLive_sf2_file","1260_Aspirin_sf2_file","1260_Chaos_sf2_file","1260_FluidR3_GM_sf2_file","1260_GeneralUserGS_sf2_file","1261_Aspirin_sf2_file","1261_GeneralUserGS_sf2_file","1262_Aspirin_sf2_file","1262_GeneralUserGS_sf2_file","1263_Aspirin_sf2_file","1263_GeneralUserGS_sf2_file","1264_Aspirin_sf2_file","1264_GeneralUserGS_sf2_file","1265_Aspirin_sf2_file","1265_GeneralUserGS_sf2_file"],gm_gunshot:["1270_JCLive_sf2_file","1270_Aspirin_sf2_file","1270_Chaos_sf2_file","1270_FluidR3_GM_sf2_file","1270_GeneralUserGS_sf2_file","1271_Aspirin_sf2_file","1271_GeneralUserGS_sf2_file","1272_Aspirin_sf2_file","1272_GeneralUserGS_sf2_file","1273_GeneralUserGS_sf2_file","1274_GeneralUserGS_sf2_file",""]};let defaultSoundfontUrl="https://felixroos.github.io/webaudiofontdata/sound",soundfontUrl=defaultSoundfontUrl,loadCache={};async function loadFont(name){if(loadCache[name])return loadCache[name];const load=async()=>{const url=`${soundfontUrl}/${name}.js`,preset=await fetch(url).then(e=>e.text());let[_,data]=preset.split("={");return eval("{"+data)};return loadCache[name]=load(),loadCache[name]}async function getFontBufferSource(e,t,o){let{note:u="c3",freq:f}=t,p;if(f)p=freqToMidi$2(f);else if(typeof u=="string")p=noteToMidi$1(u);else if(typeof u=="number")p=u;else throw new Error(`unexpected "note" type "${typeof u}"`);const{buffer:g,zone:M}=await getFontPitch(e,p,o),F=o.createBufferSource();F.buffer=g;const S=M.originalPitch-100*M.coarseTune-M.fineTune,k=1*Math.pow(2,(100*p-S)/1200);return F.playbackRate.value=k,M.loopStart>1&&M.loopStart<M.loopEnd&&(F.loop=!0,F.loopStart=M.loopStart/M.sampleRate,F.loopEnd=M.loopEnd/M.sampleRate),F}let bufferCache={};async function getFontPitch(e,t,o){const u=`${e}:::${t}`;if(bufferCache[u])return bufferCache[u];const f=async()=>{const p=await loadFont(e);if(!p)throw new Error(`Could not load soundfont ${e}`);const g=findZone(p,t);if(!g)throw new Error("no soundfont zone found for preset ",e,"pitch",t);const M=await getBuffer(g,o);if(!M)throw new Error(`no soundfont buffer found for preset ${e}, pitch: ${t}`);return{buffer:M,zone:g}};return bufferCache[u]=f(),bufferCache[u]}function findZone(e,t){return e.find(o=>o.keyRangeLow<=t&&o.keyRangeHigh+1>=t)}async function getBuffer(e,t){if(e.sample){console.warn("zone.sample untested!");const u=atob(e.sample);e.buffer=t.createBuffer(1,u.length/2,e.sampleRate);const f=e.buffer.getChannelData(0);let p,g,M;for(var o=0;o<u.length/2;o++)p=u.charCodeAt(o*2),g=u.charCodeAt(o*2+1),p<0&&(p=256+p),g<0&&(g=256+g),M=g*256+p,M>=65536/2&&(M=M-65536),f[o]=M/65536}else if(e.file){const u=e.file.length,f=new ArrayBuffer(u),p=new Uint8Array(f),g=atob(e.file);let M;for(let F=0;F<g.length;F++)M=g.charCodeAt(F),p[F]=M;return new Promise(F=>t.decodeAudioData(f,F))}}function registerSoundfonts(){Object.entries(gm).forEach(([e,t])=>{registerSound(e,async(o,u,f)=>{const[p,g,M,F]=getADSRValues([u.attack,u.decay,u.sustain,u.release]),{duration:S}=u,k=getSoundIndex$1(u.n,t.length),N=t[k],$=getAudioContext(),R=await getFontBufferSource(N,u,$);R.start(o);const U=$.createGain(),O=R.connect(U),Z=o+S;getParamADSR(O.gain,p,g,M,F,0,.3,o,Z,"linear");let K=Z+F+.01,ie=getVibratoOscillator(R.detune,u,o);getPitchEnvelope(R.detune,u,o,Z),R.stop(K);const de=te=>{};return R.onended=()=>{R.disconnect(),ie?.stop(),O.disconnect(),f()},{node:O,stop:de}},{type:"soundfont",prebake:!0,fonts:t})})}var SoundFont2={exports:{}},hasRequiredSoundFont2;function requireSoundFont2(){return hasRequiredSoundFont2||(hasRequiredSoundFont2=1,(function(e,t){(function(o,u){e.exports=u()})(window,function(){return(function(o){var u={};function f(p){if(u[p])return u[p].exports;var g=u[p]={i:p,l:!1,exports:{}};return o[p].call(g.exports,g,g.exports,f),g.l=!0,g.exports}return f.m=o,f.c=u,f.d=function(p,g,M){f.o(p,g)||Object.defineProperty(p,g,{enumerable:!0,get:M})},f.r=function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},f.t=function(p,g){if(1&g&&(p=f(p)),8&g||4&g&&typeof p=="object"&&p&&p.__esModule)return p;var M=Object.create(null);if(f.r(M),Object.defineProperty(M,"default",{enumerable:!0,value:p}),2&g&&typeof p!="string")for(var F in p)f.d(M,F,function(S){return p[S]}.bind(null,F));return M},f.n=function(p){var g=p&&p.__esModule?function(){return p.default}:function(){return p};return f.d(g,"a",g),g},f.o=function(p,g){return Object.prototype.hasOwnProperty.call(p,g)},f.p="",f(f.s="./src/index.ts")})({"./src/chunk.ts":function(o,u,f){f.r(u),f.d(u,"SF2Chunk",function(){return R});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=f("./src/chunks/index.ts");function F(U){return(F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})(U)}function S(U,O){for(var Z=0;Z<O.length;Z++){var K=O[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(U,K.key,K)}}function k(U){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(O){return O.__proto__||Object.getPrototypeOf(O)})(U)}function N(U,O){return(N=Object.setPrototypeOf||function(Z,K){return Z.__proto__=K,Z})(U,O)}function $(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}var R=(function(U){function O(ie){var de,te,re,ue,ve,Ae;return(function(Fe,we){if(!(Fe instanceof we))throw new TypeError("Cannot call a class as a function")})(this,O),te=this,de=!(re=k(O).call(this,ie.id,ie.length,ie.buffer,ie.subChunks))||F(re)!=="object"&&typeof re!="function"?$(te):re,ue=$($(de)),Ae=void 0,(ve="subChunks")in ue?Object.defineProperty(ue,ve,{value:Ae,enumerable:!0,configurable:!0,writable:!0}):ue[ve]=Ae,de.subChunks=ie.subChunks.map(function(Fe){return new O(Fe)}),de}var Z,K;return(function(ie,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function");ie.prototype=Object.create(de&&de.prototype,{constructor:{value:ie,writable:!0,configurable:!0}}),de&&N(ie,de)})(O,p.RIFFChunk),Z=O,(K=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var ie=this.subChunks.reduce(function(de,te){if(te.id==="ifil"||te.id==="iver"){if(te.length!==g.SF_VERSION_LENGTH)throw new p.ParseError("Invalid size for the '".concat(te.id,"' sub-chunk"));de[te.id]="".concat(te.getInt16(),".").concat(te.getInt16(2))}else de[te.id]=te.getString();return de},{});if(!ie.ifil)throw new p.ParseError("Missing required 'ifil' sub-chunk");if(!ie.INAM)throw new p.ParseError("Missing required 'INAM' sub-chunk");return{version:ie.ifil,soundEngine:ie.isng||"EMU8000",name:ie.INAM,rom:ie.irom,romVersion:ie.iver,creationDate:ie.ICRD,author:ie.IENG,product:ie.IPRD,copyright:ie.ICOP,comments:ie.ICMT,createdBy:ie.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var ie=this.subChunks[0];if(ie.id!=="smpl")throw new p.ParseError("Invalid chunk signature","'smpl'","'".concat(ie.id,"'"));return ie.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(M.getPresetHeaders)(this.subChunks[0]),presetZones:Object(M.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(M.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(M.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(M.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(M.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(M.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(M.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(M.getSampleHeaders)(this.subChunks[8])}}}])&&S(Z.prototype,K),O})()},"./src/chunks/generators.ts":function(o,u,f){f.r(u),f.d(u,"getGenerators",function(){return N});var p=f("./src/riff/index.ts"),g=f("./src/types/index.ts"),M=f("./src/constants.ts"),F=[g.GeneratorType.StartAddrsOffset,g.GeneratorType.EndAddrsOffset,g.GeneratorType.StartLoopAddrsOffset,g.GeneratorType.EndLoopAddrsOffset,g.GeneratorType.StartAddrsCoarseOffset,g.GeneratorType.EndAddrsCoarseOffset,g.GeneratorType.StartLoopAddrsCoarseOffset,g.GeneratorType.KeyNum,g.GeneratorType.Velocity,g.GeneratorType.EndLoopAddrsCoarseOffset,g.GeneratorType.SampleModes,g.GeneratorType.ExclusiveClass,g.GeneratorType.OverridingRootKey],S=[g.GeneratorType.Unused1,g.GeneratorType.Unused2,g.GeneratorType.Unused3,g.GeneratorType.Unused4,g.GeneratorType.Reserved1,g.GeneratorType.Reserved2,g.GeneratorType.Reserved3],k=[g.GeneratorType.KeyRange,g.GeneratorType.VelRange],N=function($,R){if($.id!==R)throw new p.ParseError("Unexpected chunk ID","'".concat(R,"'"),"'".concat($.id,"'"));if($.length%M.SF_GENERATOR_SIZE)throw new p.ParseError("Invalid size for the '".concat(R,"' sub-chunk"));return $.iterate(function(U){var O=U.getInt16();return g.GeneratorType[O]?R==="pgen"&&F.includes(O)||R==="igen"&&S.includes(O)?null:k.includes(O)?{id:O,range:{lo:U.getByte(),hi:U.getByte()}}:{id:O,value:U.getInt16BE()}:null})}},"./src/chunks/index.ts":function(o,u,f){f.r(u);var p=f("./src/chunks/instruments/index.ts");f.d(u,"getInstrumentHeaders",function(){return p.getInstrumentHeaders});var g=f("./src/chunks/presets/index.ts");f.d(u,"getPresetHeaders",function(){return g.getPresetHeaders});var M=f("./src/chunks/samples/index.ts");f.d(u,"getSampleHeaders",function(){return M.getSampleHeaders});var F=f("./src/chunks/generators.ts");f.d(u,"getGenerators",function(){return F.getGenerators});var S=f("./src/chunks/modulators.ts");f.d(u,"getModulators",function(){return S.getModulators});var k=f("./src/chunks/zones.ts");f.d(u,"getZones",function(){return k.getZones}),f.d(u,"getItemsInZone",function(){return k.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(o,u,f){f.r(u),f.d(u,"getInstrumentHeaders",function(){return M});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=function(F){if(F.id!=="inst")throw new p.ParseError("Unexpected chunk ID","'inst'","'".concat(F.id,"'"));if(F.length%g.SF_INSTRUMENT_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'inst' sub-chunk");return F.iterate(function(S){return{name:S.getString(),bagIndex:S.getInt16()}})}},"./src/chunks/instruments/index.ts":function(o,u,f){f.r(u);var p=f("./src/chunks/instruments/headers.ts");f.d(u,"getInstrumentHeaders",function(){return p.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(o,u,f){f.r(u),f.d(u,"getModulators",function(){return F});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=function(S){return{type:S>>10&63,polarity:S>>9&1,direction:S>>8&1,palette:S>>7&1,index:127&S}},F=function(S,k){if(S.id!==k)throw new p.ParseError("Unexpected chunk ID","'".concat(k,"'"),"'".concat(S.id,"'"));if(S.length%g.SF_MODULATOR_SIZE)throw new p.ParseError("Invalid size for the '".concat(k,"' sub-chunk"));return S.iterate(function(N){return{source:M(N.getInt16BE()),id:N.getInt16BE(),value:N.getInt16BE(),valueSource:M(N.getInt16BE()),transform:N.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(o,u,f){f.r(u),f.d(u,"getPresetHeaders",function(){return M});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=function(F){if(F.id!=="phdr")throw new p.ParseError("Invalid chunk ID","'phdr'","'".concat(F.id,"'"));if(F.length%g.SF_PRESET_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'phdr' sub-chunk");return F.iterate(function(S){return{name:S.getString(),preset:S.getInt16(),bank:S.getInt16(),bagIndex:S.getInt16(),library:S.getUInt32(),genre:S.getUInt32(),morphology:S.getUInt32()}})}},"./src/chunks/presets/index.ts":function(o,u,f){f.r(u);var p=f("./src/chunks/presets/headers.ts");f.d(u,"getPresetHeaders",function(){return p.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(o,u,f){f.r(u),f.d(u,"getSampleHeaders",function(){return M});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=function(F){if(F.id!=="shdr")throw new p.ParseError("Unexpected chunk ID","'shdr'","'".concat(F.id,"'"));if(F.length%g.SF_SAMPLE_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'shdr' sub-chunk");return F.iterate(function(S){return{name:S.getString(),start:S.getUInt32(),end:S.getUInt32(),startLoop:S.getUInt32(),endLoop:S.getUInt32(),sampleRate:S.getUInt32(),originalPitch:S.getByte(),pitchCorrection:S.getChar(),link:S.getInt16(),type:S.getInt16()}})}},"./src/chunks/samples/index.ts":function(o,u,f){f.r(u);var p=f("./src/chunks/samples/headers.ts");f.d(u,"getSampleHeaders",function(){return p.getSampleHeaders})},"./src/chunks/zones.ts":function(o,u,f){f.r(u),f.d(u,"getZones",function(){return F}),f.d(u,"getItemsInZone",function(){return S});var p=f("./src/riff/index.ts"),g=f("./src/constants.ts"),M=f("./src/types/index.ts"),F=function(R,U){if(R.id!==U)throw new p.ParseError("Unexpected chunk ID","'".concat(U,"'"),"'".concat(R.id,"'"));if(R.length%g.SF_BAG_SIZE)throw new p.ParseError("Invalid size for the '".concat(U,"' sub-chunk"));return R.iterate(function(O){return{generatorIndex:O.getInt16(),modulatorIndex:O.getInt16()}})},S=function(R,U,O,Z,K,ie){for(var de=[],te=0;te<R.length;te++){for(var re=R[te],ue=R[te+1],ve=re.bagIndex,Ae=ue?ue.bagIndex:U.length,Fe=[],we=void 0,Ce=ve;Ce<Ae;Ce++){var be=k(Ce,U,O),le=N(Ce,U,Z),Ze=le[M.GeneratorType.KeyRange]&&le[M.GeneratorType.KeyRange].range,Je=le[ie];if(Je){var Qe=K[Je.value];Qe&&Fe.push({keyRange:Ze,modulators:be,generators:le,reference:Qe})}else Ce-ve==0&&(we={keyRange:Ze,modulators:be,generators:le})}de.push({header:re,globalZone:we,zones:Fe})}return de},k=function(R,U,O){var Z=U[R],K=U[R+1],ie=Z.modulatorIndex,de=K?K.modulatorIndex:U.length;return $(ie,de,O)},N=function(R,U,O){var Z=U[R],K=U[R+1],ie=Z.generatorIndex,de=K?K.generatorIndex:U.length;return $(ie,de,O)},$=function(R,U,O){for(var Z={},K=R;K<U;K++){var ie=O[K];ie&&(Z[ie.id]=ie)}return Z}},"./src/constants.ts":function(o,u,f){f.r(u),f.d(u,"SF_VERSION_LENGTH",function(){return p}),f.d(u,"SF_PRESET_HEADER_SIZE",function(){return g}),f.d(u,"SF_BAG_SIZE",function(){return M}),f.d(u,"SF_MODULATOR_SIZE",function(){return F}),f.d(u,"SF_GENERATOR_SIZE",function(){return S}),f.d(u,"SF_INSTRUMENT_HEADER_SIZE",function(){return k}),f.d(u,"SF_SAMPLE_HEADER_SIZE",function(){return N}),f.d(u,"DEFAULT_SAMPLE_RATE",function(){return $});var p=4,g=38,M=4,F=10,S=4,k=22,N=46,$=22050},"./src/index.ts":function(o,u,f){f.r(u);var p=f("./src/types/index.ts");for(var g in p)g!=="default"&&(function(k){f.d(u,k,function(){return p[k]})})(g);var M=f("./src/chunk.ts");f.d(u,"SF2Chunk",function(){return M.SF2Chunk});var F=f("./src/constants.ts");f.d(u,"SF_VERSION_LENGTH",function(){return F.SF_VERSION_LENGTH}),f.d(u,"SF_PRESET_HEADER_SIZE",function(){return F.SF_PRESET_HEADER_SIZE}),f.d(u,"SF_BAG_SIZE",function(){return F.SF_BAG_SIZE}),f.d(u,"SF_MODULATOR_SIZE",function(){return F.SF_MODULATOR_SIZE}),f.d(u,"SF_GENERATOR_SIZE",function(){return F.SF_GENERATOR_SIZE}),f.d(u,"SF_INSTRUMENT_HEADER_SIZE",function(){return F.SF_INSTRUMENT_HEADER_SIZE}),f.d(u,"SF_SAMPLE_HEADER_SIZE",function(){return F.SF_SAMPLE_HEADER_SIZE}),f.d(u,"DEFAULT_SAMPLE_RATE",function(){return F.DEFAULT_SAMPLE_RATE});var S=f("./src/soundFont2.ts");f.d(u,"SoundFont2",function(){return S.SoundFont2})},"./src/riff/chunkIterator.ts":function(o,u,f){f.r(u),f.d(u,"ChunkIterator",function(){return F});var p=f("./src/utils/index.ts");function g(S,k){for(var N=0;N<k.length;N++){var $=k[N];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(S,$.key,$)}}function M(S,k,N){return k in S?Object.defineProperty(S,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):S[k]=N,S}var F=(function(){function S($){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(function(U,O){if(!(U instanceof O))throw new TypeError("Cannot call a class as a function")})(this,S),M(this,"target",[]),M(this,"chunk",void 0),M(this,"position",0),this.chunk=$,this.position=R}var k,N;return k=S,(N=[{key:"iterate",value:function($){for(;this.position<this.chunk.length;){var R=$(this);R&&this.target.push(R)}}},{key:"getString",value:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,R=Object(p.getStringFromBuffer)(this.getBuffer(this.position,$));return this.position+=$,R}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function($){this.position+=$}},{key:"getBuffer",value:function($,R){return this.chunk.buffer.subarray($,$+R)}},{key:"currentPosition",get:function(){return this.position}}])&&g(k.prototype,N),S})()},"./src/riff/index.ts":function(o,u,f){f.r(u);var p=f("./src/riff/chunkIterator.ts");f.d(u,"ChunkIterator",function(){return p.ChunkIterator});var g=f("./src/riff/parseError.ts");f.d(u,"ParseError",function(){return g.ParseError});var M=f("./src/riff/parser.ts");f.d(u,"parseBuffer",function(){return M.parseBuffer}),f.d(u,"getChunk",function(){return M.getChunk}),f.d(u,"getChunkLength",function(){return M.getChunkLength}),f.d(u,"getSubChunks",function(){return M.getSubChunks}),f.d(u,"getChunkId",function(){return M.getChunkId});var F=f("./src/riff/riffChunk.ts");f.d(u,"RIFFChunk",function(){return F.RIFFChunk})},"./src/riff/parseError.ts":function(o,u,f){function p($){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R})($)}function g($,R){return!R||p(R)!=="object"&&typeof R!="function"?(function(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U})($):R}function M($){var R=typeof Map=="function"?new Map:void 0;return(M=function(U){if(U===null||(O=U,Function.toString.call(O).indexOf("[native code]")===-1))return U;var O;if(typeof U!="function")throw new TypeError("Super expression must either be null or a function");if(R!==void 0){if(R.has(U))return R.get(U);R.set(U,Z)}function Z(){return F(U,arguments,k(this).constructor)}return Z.prototype=Object.create(U.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),S(Z,U)})($)}function F($,R,U){return(F=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}})()?Reflect.construct:function(O,Z,K){var ie=[null];ie.push.apply(ie,Z);var de=new(Function.bind.apply(O,ie));return K&&S(de,K.prototype),de}).apply(null,arguments)}function S($,R){return(S=Object.setPrototypeOf||function(U,O){return U.__proto__=O,U})($,R)}function k($){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)})($)}f.r(u),f.d(u,"ParseError",function(){return N});var N=(function($){function R(U,O,Z){return(function(K,ie){if(!(K instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,R),g(this,k(R).call(this,"".concat(U).concat(O&&Z?", expected ".concat(O,", received ").concat(Z):"")))}return(function(U,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(O&&O.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),O&&S(U,O)})(R,M(Error)),R})()},"./src/riff/parser.ts":function(o,u,f){f.r(u),f.d(u,"parseBuffer",function(){return F}),f.d(u,"getChunk",function(){return S}),f.d(u,"getChunkLength",function(){return k}),f.d(u,"getSubChunks",function(){return N}),f.d(u,"getChunkId",function(){return $});var p=f("./src/riff/parseError.ts"),g=f("./src/utils/buffer.ts"),M=f("./src/riff/riffChunk.ts"),F=function(R){var U=$(R);if(U!=="RIFF")throw new p.ParseError("Invalid file format","RIFF",U);var O=$(R,8);if(O!=="sfbk")throw new p.ParseError("Invalid signature","sfbk",O);var Z=R.subarray(8),K=N(Z.subarray(4));return new M.RIFFChunk(U,Z.length,Z,K)},S=function(R,U){var O=$(R,U),Z=k(R,U+4),K=[];return O!=="RIFF"&&O!=="LIST"||(K=N(R.subarray(U+12))),new M.RIFFChunk(O,Z,R.subarray(U+8),K)},k=function(R,U){return((R=R.subarray(U,U+4))[0]|R[1]<<8|R[2]<<16|R[3]<<24)>>>0},N=function(R){for(var U=[],O=0;O<=R.length-8;){var Z=S(R,O);U.push(Z),O=(O+=8+Z.length)%2?O+1:O}return U},$=function(R){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(g.getStringFromBuffer)(R.subarray(U,U+4))}},"./src/riff/riffChunk.ts":function(o,u,f){f.r(u),f.d(u,"RIFFChunk",function(){return S});var p=f("./src/riff/chunkIterator.ts"),g=f("./src/utils/index.ts");function M(k,N){for(var $=0;$<N.length;$++){var R=N[$];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(k,R.key,R)}}function F(k,N,$){return N in k?Object.defineProperty(k,N,{value:$,enumerable:!0,configurable:!0,writable:!0}):k[N]=$,k}var S=(function(){function k(R,U,O,Z){(function(K,ie){if(!(K instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,k),F(this,"id",void 0),F(this,"length",void 0),F(this,"buffer",void 0),F(this,"subChunks",void 0),this.id=R,this.length=U,this.buffer=O,this.subChunks=Z}var N,$;return N=k,($=[{key:"getString",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1?arguments[1]:void 0;return Object(g.getStringFromBuffer)(this.getBuffer(R,U||this.length-R))}},{key:"getInt16",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R++]|this.buffer[R]<<8}},{key:"getUInt32",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[R++]|this.buffer[R++]<<8|this.buffer[R++]<<16|this.buffer[R]<<24)>>>0}},{key:"getByte",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R]}},{key:"getChar",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[R]<<24>>24}},{key:"iterator",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new p.ChunkIterator(this,R)}},{key:"iterate",value:function(R){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=new p.ChunkIterator(this,U);return O.iterate(R),O.target}},{key:"getBuffer",value:function(R,U){return this.buffer.subarray(R,R+U)}}])&&M(N.prototype,$),k})()},"./src/soundFont2.ts":function(o,u,f){f.r(u),f.d(u,"SoundFont2",function(){return U});var p=f("./src/types/index.ts"),g=f("./src/chunk.ts"),M=f("./src/riff/index.ts"),F=f("./src/chunks/index.ts"),S=f("./src/utils/index.ts");function k(O){for(var Z=1;Z<arguments.length;Z++){var K=arguments[Z]!=null?arguments[Z]:{},ie=Object.keys(K);typeof Object.getOwnPropertySymbols=="function"&&(ie=ie.concat(Object.getOwnPropertySymbols(K).filter(function(de){return Object.getOwnPropertyDescriptor(K,de).enumerable}))),ie.forEach(function(de){R(O,de,K[de])})}return O}function N(O,Z){for(var K=0;K<Z.length;K++){var ie=Z[K];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(O,ie.key,ie)}}function $(O,Z,K){return Z&&N(O.prototype,Z),K&&N(O,K),O}function R(O,Z,K){return Z in O?Object.defineProperty(O,Z,{value:K,enumerable:!0,configurable:!0,writable:!0}):O[Z]=K,O}var U=(function(){function O(Z){if((function(ie,de){if(!(ie instanceof de))throw new TypeError("Cannot call a class as a function")})(this,O),R(this,"chunk",void 0),R(this,"metaData",void 0),R(this,"sampleData",void 0),R(this,"samples",void 0),R(this,"presetData",void 0),R(this,"instruments",void 0),R(this,"presets",void 0),R(this,"banks",void 0),!(Z instanceof g.SF2Chunk)){var K=Object(M.parseBuffer)(Z);Z=new g.SF2Chunk(K)}if(Z.subChunks.length!==3)throw new M.ParseError("Invalid sfbk structure","3 chunks","".concat(Z.subChunks.length," chunks"));this.chunk=Z,this.metaData=Z.subChunks[0].getMetaData(),this.sampleData=Z.subChunks[1].getSampleData(),this.presetData=Z.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return $(O,null,[{key:"from",value:function(Z){return new O(Z)}}]),$(O,[{key:"getKeyData",value:function(Z){var K=this,ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(S.memoize)(function(te,re,ue){var ve=K.banks[re];if(ve){var Ae=ve.presets[ue];if(Ae){var Fe=Ae.zones.find(function(Je){return K.isKeyInRange(Je,te)});if(Fe){var we=Fe.instrument,Ce=we.zones.find(function(Je){return K.isKeyInRange(Je,te)});if(Ce){var be=Ce.sample,le=k({},Fe.generators,Ce.generators),Ze=k({},Fe.modulators,Ce.modulators);return{keyNumber:te,preset:Ae,instrument:we,sample:be,generators:le,modulators:Ze}}}}}return null})(Z,ie,de)}},{key:"isKeyInRange",value:function(Z,K){return Z.keyRange===void 0||Z.keyRange.lo<=K&&Z.keyRange.hi>=K}},{key:"getBanks",value:function(){return this.presets.reduce(function(Z,K){var ie=K.header.bank;return Z[ie]||(Z[ie]={presets:[]}),Z[ie].presets[K.header.preset]=K,Z},[])}},{key:"getPresets",value:function(){var Z=this.presetData,K=Z.presetHeaders,ie=Z.presetZones,de=Z.presetGenerators,te=Z.presetModulators;return Object(F.getItemsInZone)(K,ie,te,de,this.instruments,p.GeneratorType.Instrument).filter(function(re){return re.header.name!=="EOP"}).map(function(re){return{header:re.header,globalZone:re.globalZone,zones:re.zones.map(function(ue){return{keyRange:ue.keyRange,generators:ue.generators,modulators:ue.modulators,instrument:ue.reference}})}})}},{key:"getInstruments",value:function(){var Z=this.presetData,K=Z.instrumentHeaders,ie=Z.instrumentZones,de=Z.instrumentModulators,te=Z.instrumentGenerators;return Object(F.getItemsInZone)(K,ie,de,te,this.samples,p.GeneratorType.SampleId).filter(function(re){return re.header.name!=="EOI"}).map(function(re){return{header:re.header,globalZone:re.globalZone,zones:re.zones.map(function(ue){return{keyRange:ue.keyRange,generators:ue.generators,modulators:ue.modulators,sample:ue.reference}})}})}},{key:"getSamples",value:function(){var Z=this;return this.presetData.sampleHeaders.filter(function(K){return K.name!=="EOS"}).map(function(K){if(K.name!=="EOS"&&K.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(K.sampleRate," hz in sample '").concat(K.name,"'"));return K.originalPitch>=128&&K.originalPitch<=254&&(K.originalPitch=60),K.startLoop-=K.start,K.endLoop-=K.start,{header:K,data:new Int16Array(new Uint8Array(Z.sampleData.subarray(2*K.start,2*K.end)).buffer)}})}}]),O})()},"./src/types/bank.ts":function(o,u){},"./src/types/generator.ts":function(o,u,f){var p,g;function M(S,k,N){return k in S?Object.defineProperty(S,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):S[k]=N,S}f.r(u),f.d(u,"GeneratorType",function(){return g}),f.d(u,"DEFAULT_GENERATOR_VALUES",function(){return F}),(function(S){S[S.StartAddrsOffset=0]="StartAddrsOffset",S[S.EndAddrsOffset=1]="EndAddrsOffset",S[S.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",S[S.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",S[S.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",S[S.ModLFOToPitch=5]="ModLFOToPitch",S[S.VibLFOToPitch=6]="VibLFOToPitch",S[S.ModEnvToPitch=7]="ModEnvToPitch",S[S.InitialFilterFc=8]="InitialFilterFc",S[S.InitialFilterQ=9]="InitialFilterQ",S[S.ModLFOToFilterFc=10]="ModLFOToFilterFc",S[S.ModEnvToFilterFc=11]="ModEnvToFilterFc",S[S.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",S[S.ModLFOToVolume=13]="ModLFOToVolume",S[S.Unused1=14]="Unused1",S[S.ChorusEffectsSend=15]="ChorusEffectsSend",S[S.ReverbEffectsSend=16]="ReverbEffectsSend",S[S.Pan=17]="Pan",S[S.Unused2=18]="Unused2",S[S.Unused3=19]="Unused3",S[S.Unused4=20]="Unused4",S[S.DelayModLFO=21]="DelayModLFO",S[S.FreqModLFO=22]="FreqModLFO",S[S.DelayVibLFO=23]="DelayVibLFO",S[S.FreqVibLFO=24]="FreqVibLFO",S[S.DelayModEnv=25]="DelayModEnv",S[S.AttackModEnv=26]="AttackModEnv",S[S.HoldModEnv=27]="HoldModEnv",S[S.DecayModEnv=28]="DecayModEnv",S[S.SustainModEnv=29]="SustainModEnv",S[S.ReleaseModEnv=30]="ReleaseModEnv",S[S.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",S[S.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",S[S.DelayVolEnv=33]="DelayVolEnv",S[S.AttackVolEnv=34]="AttackVolEnv",S[S.HoldVolEnv=35]="HoldVolEnv",S[S.DecayVolEnv=36]="DecayVolEnv",S[S.SustainVolEnv=37]="SustainVolEnv",S[S.ReleaseVolEnv=38]="ReleaseVolEnv",S[S.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",S[S.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",S[S.Instrument=41]="Instrument",S[S.Reserved1=42]="Reserved1",S[S.KeyRange=43]="KeyRange",S[S.VelRange=44]="VelRange",S[S.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",S[S.KeyNum=46]="KeyNum",S[S.Velocity=47]="Velocity",S[S.InitialAttenuation=48]="InitialAttenuation",S[S.Reserved2=49]="Reserved2",S[S.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",S[S.CoarseTune=51]="CoarseTune",S[S.FineTune=52]="FineTune",S[S.SampleId=53]="SampleId",S[S.SampleModes=54]="SampleModes",S[S.Reserved3=55]="Reserved3",S[S.ScaleTuning=56]="ScaleTuning",S[S.ExclusiveClass=57]="ExclusiveClass",S[S.OverridingRootKey=58]="OverridingRootKey",S[S.Unused5=59]="Unused5",S[S.EndOper=60]="EndOper"})(g||(g={}));var F=(M(p={},g.StartAddrsOffset,0),M(p,g.EndAddrsOffset,0),M(p,g.StartLoopAddrsOffset,0),M(p,g.EndLoopAddrsOffset,0),M(p,g.StartAddrsCoarseOffset,0),M(p,g.ModLFOToPitch,0),M(p,g.VibLFOToPitch,0),M(p,g.ModEnvToPitch,0),M(p,g.InitialFilterFc,13500),M(p,g.InitialFilterQ,0),M(p,g.ModLFOToFilterFc,0),M(p,g.ModEnvToFilterFc,0),M(p,g.EndAddrsCoarseOffset,0),M(p,g.ModLFOToVolume,0),M(p,g.ChorusEffectsSend,0),M(p,g.ReverbEffectsSend,0),M(p,g.Pan,0),M(p,g.DelayModLFO,-12e3),M(p,g.FreqModLFO,0),M(p,g.DelayVibLFO,-12e3),M(p,g.FreqVibLFO,0),M(p,g.DelayModEnv,-12e3),M(p,g.AttackModEnv,-12e3),M(p,g.HoldModEnv,-12e3),M(p,g.DecayModEnv,-12e3),M(p,g.SustainModEnv,0),M(p,g.ReleaseModEnv,-12e3),M(p,g.KeyNumToModEnvHold,0),M(p,g.KeyNumToModEnvDecay,0),M(p,g.DelayVolEnv,-12e3),M(p,g.AttackVolEnv,-12e3),M(p,g.HoldVolEnv,-12e3),M(p,g.DecayVolEnv,-12e3),M(p,g.SustainVolEnv,0),M(p,g.ReleaseVolEnv,-12e3),M(p,g.KeyNumToVolEnvHold,0),M(p,g.KeyNumToVolEnvDecay,0),M(p,g.StartLoopAddrsCoarseOffset,0),M(p,g.KeyNum,-1),M(p,g.Velocity,-1),M(p,g.InitialAttenuation,0),M(p,g.EndLoopAddrsCoarseOffset,0),M(p,g.CoarseTune,0),M(p,g.FineTune,0),M(p,g.SampleModes,0),M(p,g.ScaleTuning,100),M(p,g.ExclusiveClass,0),M(p,g.OverridingRootKey,-1),p)},"./src/types/index.ts":function(o,u,f){f.r(u);var p=f("./src/types/bank.ts");for(var g in p)g!=="default"&&(function(Z){f.d(u,Z,function(){return p[Z]})})(g);var M=f("./src/types/generator.ts");f.d(u,"GeneratorType",function(){return M.GeneratorType}),f.d(u,"DEFAULT_GENERATOR_VALUES",function(){return M.DEFAULT_GENERATOR_VALUES});var F=f("./src/types/instrument.ts");for(var g in F)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return F[K]})})(g);var S=f("./src/types/key.ts");for(var g in S)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return S[K]})})(g);var k=f("./src/types/metaData.ts");for(var g in k)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return k[K]})})(g);var N=f("./src/types/modulator.ts");f.d(u,"ControllerType",function(){return N.ControllerType}),f.d(u,"ControllerPolarity",function(){return N.ControllerPolarity}),f.d(u,"ControllerDirection",function(){return N.ControllerDirection}),f.d(u,"ControllerPalette",function(){return N.ControllerPalette}),f.d(u,"Controller",function(){return N.Controller}),f.d(u,"TransformType",function(){return N.TransformType}),f.d(u,"DEFAULT_INSTRUMENT_MODULATORS",function(){return N.DEFAULT_INSTRUMENT_MODULATORS});var $=f("./src/types/preset.ts");for(var g in $)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return $[K]})})(g);var R=f("./src/types/presetData.ts");for(var g in R)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return R[K]})})(g);var U=f("./src/types/sample.ts");f.d(u,"SampleType",function(){return U.SampleType});var O=f("./src/types/zone.ts");for(var g in O)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType","default"].indexOf(g)<0&&(function(K){f.d(u,K,function(){return O[K]})})(g)},"./src/types/instrument.ts":function(o,u){},"./src/types/key.ts":function(o,u){},"./src/types/metaData.ts":function(o,u){},"./src/types/modulator.ts":function(o,u,f){f.r(u),f.d(u,"ControllerType",function(){return p}),f.d(u,"ControllerPolarity",function(){return g}),f.d(u,"ControllerDirection",function(){return M}),f.d(u,"ControllerPalette",function(){return F}),f.d(u,"Controller",function(){return S}),f.d(u,"TransformType",function(){return k}),f.d(u,"DEFAULT_INSTRUMENT_MODULATORS",function(){return $});var p,g,M,F,S,k,N=f("./src/types/generator.ts");(function(R){R[R.Linear=0]="Linear",R[R.Concave=1]="Concave",R[R.Convex=2]="Convex",R[R.Switch=3]="Switch"})(p||(p={})),(function(R){R[R.Unipolar=0]="Unipolar",R[R.Bipolar=1]="Bipolar"})(g||(g={})),(function(R){R[R.Increasing=0]="Increasing",R[R.Decreasing=1]="Decreasing"})(M||(M={})),(function(R){R[R.GeneralController=0]="GeneralController",R[R.MidiController=1]="MidiController"})(F||(F={})),(function(R){R[R.NoController=0]="NoController",R[R.NoteOnVelocity=2]="NoteOnVelocity",R[R.NoteOnKeyNumber=3]="NoteOnKeyNumber",R[R.PolyPressure=10]="PolyPressure",R[R.ChannelPressure=13]="ChannelPressure",R[R.PitchWheel=14]="PitchWheel",R[R.PitchWheelSensitivity=16]="PitchWheelSensitivity",R[R.Link=127]="Link"})(S||(S={})),(function(R){R[R.Linear=0]="Linear",R[R.Absolute=2]="Absolute"})(k||(k={}));var $=[{id:N.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:g.Unipolar,direction:M.Decreasing,palette:F.GeneralController,index:S.NoteOnVelocity},value:960,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialFilterFc,source:{type:p.Linear,polarity:g.Unipolar,direction:M.Decreasing,palette:F.GeneralController,index:S.NoteOnVelocity},value:-2400,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.VibLFOToPitch,source:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.ChannelPressure},value:50,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.VibLFOToPitch,source:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.MidiController,index:1},value:50,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:g.Unipolar,direction:M.Decreasing,palette:F.MidiController,index:7},value:960,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:p.Linear,polarity:g.Bipolar,direction:M.Increasing,palette:F.MidiController,index:10},value:1e3,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:g.Unipolar,direction:M.Decreasing,palette:F.MidiController,index:11},value:960,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.ReverbEffectsSend,source:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.MidiController,index:91},value:200,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.ChorusEffectsSend,source:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.MidiController,index:93},value:200,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.NoController},transform:k.Linear},{id:N.GeneratorType.CoarseTune,source:{type:p.Linear,polarity:g.Bipolar,direction:M.Increasing,palette:F.GeneralController,index:S.PitchWheel},value:12700,valueSource:{type:p.Linear,polarity:g.Unipolar,direction:M.Increasing,palette:F.GeneralController,index:S.PitchWheelSensitivity},transform:k.Linear}]},"./src/types/preset.ts":function(o,u){},"./src/types/presetData.ts":function(o,u){},"./src/types/sample.ts":function(o,u,f){var p;f.r(u),f.d(u,"SampleType",function(){return p}),(function(g){g[g.EOS=0]="EOS",g[g.Mono=1]="Mono",g[g.Right=2]="Right",g[g.Left=4]="Left",g[g.Linked=8]="Linked",g[g.RomMono=32769]="RomMono",g[g.RomRight=32770]="RomRight",g[g.RomLeft=32772]="RomLeft",g[g.RomLinked=32776]="RomLinked"})(p||(p={}))},"./src/types/zone.ts":function(o,u){},"./src/utils/buffer.ts":function(o,u,f){f.r(u),f.d(u,"getStringFromBuffer",function(){return p});var p=function(g){return new TextDecoder("utf8").decode(g).split(/\0/)[0].trim()}},"./src/utils/index.ts":function(o,u,f){f.r(u);var p=f("./src/utils/buffer.ts");f.d(u,"getStringFromBuffer",function(){return p.getStringFromBuffer});var g=f("./src/utils/memoize.ts");f.d(u,"memoize",function(){return g.memoize})},"./src/utils/memoize.ts":function(o,u,f){f.r(u),f.d(u,"memoize",function(){return p});var p=function(g){var M={};return function(){for(var F=arguments.length,S=new Array(F),k=0;k<F;k++)S[k]=arguments[k];var N=JSON.stringify(S);if(N in M)return M[N];var $=g.apply(void 0,S);return M[N]=$,$}}}})})})(SoundFont2)),SoundFont2.exports}var SoundFont2Exports=requireSoundFont2();const m=e=>Math.pow(2,e/1200),Q=e=>e/1e3,G=(e,t)=>{const o=Math.pow(10,t);return Math.round(e*o)/o};typeof AudioParam<"u"&&(AudioParam.prototype.dahdsr=function(e,t,o,u,f,p,g,M,F){f=Math.max(G(f,4),.001),g=Math.max(G(g,4),.001),F=G(F,4),t=Math.max(t,.001);let S=e;return this.setValueAtTime(t,S),this.setValueAtTime(t,S+=u),this.exponentialRampToValueAtTime(o,S+=f),this.setValueAtTime(o,S+=p),this.exponentialRampToValueAtTime(Math.max(M*o,.001),S+=g),(k,N)=>{this.cancelAndHoldAtTime(k);const $=Math.max(N??t,.001);this.exponentialRampToValueAtTime($,k+F)}});const T={0:"startAddrOffset",1:"endAddrOffset",2:"startloopAddrsOffset",3:"endloopAddrsOffset",4:"startAddrsCoarseOffset",5:"modLfoToPitch",6:"vibLfoToPitch",7:"modEnvToPitch",8:"initialFilterFc",9:"initialFilterQ",10:"modLfoToFilterFc",11:"modEnvToFilterFc",12:"endAddrsCoarseOffset",13:"modLfoToVolume",14:"unused1",15:"chorusEffectsSend",16:"reverbEffectsSend",17:"pan",18:"unused2",19:"unused3",20:"unused4",21:"delayModLFO",22:"freqModLFO",23:"delayVibLFO",24:"freqVibLFO",25:"delayModEnv",26:"attackModEnv",27:"holdModEnv",28:"decayModEnv",29:"sustainModEnv",30:"releaseModEnv",31:"keyNumToModEnvHold",32:"keyNumToModEnvDecay",33:"delayVolEnv",34:"attackVolEnv",35:"holdVolEnv",36:"decayVolEnv",37:"sustainVolEnv",38:"releaseVolEnv",39:"keyNumToVolEnvHold",40:"keyNumToVolEnvDecay",41:"instrument",42:"reserved1",43:"keyRange",44:"velRange",45:"startloopAddrsCoarseOffset",46:"keyNum",47:"velocity",48:"initialAttenuation",49:"reserved2",50:"endloopAddrsCoarseOffset",51:"coarseTune",52:"fineTune",53:"sampleID",54:"sampleModes",55:"reserved3",56:"scaleTuning",57:"exclusiveClass",58:"overridingRootKey",59:"unused5",60:"endOper"};Object.fromEntries(Object.entries(SoundFont2Exports.DEFAULT_GENERATOR_VALUES).map(([e,t])=>[T[e],t]));const D=(e,t,o,u,f)=>{var p,g,M,F,S,k,N;const $=SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e];if(typeof $!="number")throw new Error(`no default value found for generator with index ${e}`);const R=t.generators[e],U=(g=(p=o.globalZone)==null?void 0:p.generators)==null?void 0:g[e],O=(M=u?.generators)==null?void 0:M[e],Z=(S=(F=f.globalZone)==null?void 0:F.generators)==null?void 0:S[e],K=R&&"value"in R?R.value:void 0,ie=U&&"value"in U?U.value:void 0,de=O&&"value"in O?O.value:void 0,te=Z&&"value"in Z?Z.value:void 0,re=(k=K??ie)!=null?k:$,ue=(N=de??te)!=null?N:0;return re+ue},J=e=>SoundFont2Exports.DEFAULT_GENERATOR_VALUES[e]!==void 0,W=(e,t,o)=>{var u,f,p,g;return Object.fromEntries(Array.from(new Set([Object.keys((f=(u=o.globalZone)==null?void 0:u.generators)!=null?f:{}),Object.keys(t.generators),Object.keys((g=(p=t.instrument.globalZone)==null?void 0:p.generators)!=null?g:{}),Object.keys(e.generators)].flat())).filter(J).map(M=>[T[M],D(parseInt(M),e,t.instrument,t,o)]))};function X(e,t,o){let{time:u=e.currentTime}=o;const{midi:f,start:p,velocity:g=.3,startLoop:M,endLoop:F,sampleRate:S,originalPitch:k,pitchCorrection:N,type:$,sampleModes:R=0,overridingRootKey:U,fineTune:O=0,startloopAddrsOffset:Z=0,startloopAddrsCoarseOffset:K=0,endloopAddrsOffset:ie=0,endloopAddrsCoarseOffset:de=0,delayVolEnv:te=-12e3,attackVolEnv:re=-12e3,holdVolEnv:ue=-12e3,decayVolEnv:ve=-12e3,sustainVolEnv:Ae=0,releaseVolEnv:Fe=-12e3,pan:we=0,...Ce}=o,be=100*(U!==void 0&&U!==-1?U:k)+N-O,le=f*100-be,Ze=1*Math.pow(2,le/1200);t.playbackRate.value=Ze;const Je=M+Z+K*32768,Qe=F+ie+de*32768;Qe>Je&&R===1?(t.loopStart=Je/S,t.loopEnd=Qe/S,t.loop=!0):R===3&&console.warn("unimplemented sampleMode 3 (play till end on note off)"),Object.keys(Ce).filter(Tt=>!["name","instrument","keyRange","sampleID","end"].includes(Tt)).length;const rt=e.createGain(),tt=[u,0,g,m(te),m(re),m(ue),m(ve),Ae>=960?0:1-Q(Ae),m(Fe)],kt=rt.gain.dahdsr(...tt),Lt=e.createStereoPanner();return Lt.pan.value=we/1e3,rt.connect(Lt),t.connect(rt),Lt.connect(e.destination),t.start(u),(Tt=e.currentTime)=>{t.stop(Tt+m(Fe)),kt(Tt)}}function Y(e,t,o={}){const{header:u,data:f}=t,p=new Float32Array(f.length);for(let F=0;F<f.length;F++)p[F]=f[F]/32768;const g=e.createBuffer(1,p.length,u.sampleRate);g.getChannelData(0).set(p);const M=e.createBufferSource();return M.buffer=g,o={...u,...o},X(e,M,o)}const C=(e,t)=>!e.keyRange||e.keyRange.lo<=t&&t<=e.keyRange.hi,x=(e,t)=>e.zones.filter(o=>C(o,t)&&o.instrument).map(o=>o.instrument.zones.filter(u=>C(u,t)).map(u=>{const f=W(u,o,e);return{...u,mergedGenerators:f}})).flat(),ce=(e,t,o,u=e.currentTime)=>{const f=x(t,o).map(p=>Y(e,p.sample,{...p.mergedGenerators,midi:o,time:u}));return(p=e.currentTime)=>{f.forEach(g=>g(p))}};Pattern$1.prototype.soundfont=function(e,t=0){return this.onTrigger((o,u,f,p)=>{const g=getAudioContext(),M=getPlayableNoteValue(o),F=e.presets[t%e.presets.length],S=p,k=[g,F,noteToMidi$1(M),S];ce(...k)(S+o.duration)})};let latestOptions,hydra;async function initHydra(e={}){if(latestOptions&&JSON.stringify(latestOptions)!==JSON.stringify(e)&&document.getElementById("hydra-canvas")?.remove(),latestOptions=e,!document.getElementById("hydra-canvas")){const{src:t="https://unpkg.com/hydra-synth",feedStrudel:o=!1,contextType:u="webgl",pixelRatio:f=1,pixelated:p=!0,...g}={detectAudio:!1,...e},{canvas:M}=getDrawContext("hydra-canvas",{contextType:u,pixelRatio:f,pixelated:p});if(g.canvas=M,await import(t),hydra=new Hydra(g),o){const{canvas:F}=getDrawContext();F.style.display="none",hydra.synth.s0.init({src:F})}}return hydra}function clearHydra(){hydra&&hydra.hush(),globalThis.s0?.clear(),document.getElementById("hydra-canvas")?.remove(),globalThis.speed=speed,globalThis.shape=shape}const H=e=>()=>reify(e).queryArc(getTime(),getTime())[0].value;App.last_eval_error="",App.handle_eval_error=e=>{App.has_error=!0,App.last_eval_error=e?.message||`${e}`,App.set_status(App.last_eval_error)};const{evaluate,scheduler}=webaudioRepl({transpiler,onEvalError:e=>{App.handle_eval_error(e)}});App.scheduler=scheduler,App.app_name="Slide",App.code_query_key="code",App.song_query_key="song",App.cpm_query_key="cpm",App.beat_query_key="beat",App.current_song="",App.events_started=!1,App.audio_started=!1,App.fetch_in_flight=!1,App.status_watch_cancelled=!1,App.default_cpm=60,App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.color_index=0,App.color_cycle_timer=void 0,App.do_partial_updates=!1,App.fetch_delay_seconds=5,App.code_url_max=1920,App.border_color="#444",App.default_cpm=30,App.cycle_colors=["#94dd94","rgb(197, 187, 106)","rgb(222, 143, 143)","rgb(127, 155, 210)"],App.on_load=()=>{App.start_events()},App.get_config=async()=>{let e=await fetch("config/config.json");try{App.config=await e.json()}catch(t){console.error("Failed to parse config.json",t),App.config={}}},App.strudel_init=async()=>{if(App.audio_started){console.info("Audio already initialized");return}console.info("Initializing Audio...");try{console.info("Loading scope..."),await App.ensure_scope(),console.info("Scope loaded"),console.info("Initializing audio context..."),await initAudio(),miniAllStrings();let e="https://raw.githubusercontent.com/felixroos/dough-samples/main";console.info("Loading samples and soundfonts..."),await Promise.all([registerSynthSounds(),registerSoundfonts(),samples("github:tidalcycles/dirt-samples"),samples(`${e}/tidal-drum-machines.json`)]),App.audio_started=!0,App.apply_volume(),console.info("Audio Ready."),App.code_to_play&&(App.play_action(App.code_to_play),App.code_to_play="")}catch(e){throw console.error("Audio Failed:",e),e}},App.clear_draw_context=()=>{try{cleanupDraw(!0)}catch(e){console.warn("Failed to clear draw context",e)}},App.reset_eval_state=()=>{App.has_error=!1},App.report_eval_failure=e=>{let t=e?.message||App.last_eval_error||"Failed to evaluate Strudel code";App.last_eval_error=t,App.set_status(t)},App.run_eval=async e=>{App.reset_eval_state(),e=App.filter_code(e),App.set_input(e);try{await evaluate(e)}catch(t){return{ok:!1,error:t}}return App.has_error?{ok:!1,error:new Error(App.last_eval_error||"Evaluation error")}:{ok:!0}},App.normalize_code=(e="")=>e.replace(/\r\n/g,`
`).trim(),App.strip_set_cpm=e=>e.split(`
`).filter(t=>!t.trim().match(/^setCpm\s*\(/)).join(`
`),App.split_by_newlines=e=>{let t="",o=null,u=0,f=0,p=0,g=[],M=()=>{let F=t.trim();F&&g.push(F),t=""};for(let F=0;F<e.length;F+=1){let S=e[F],k=e[F-1];if(t+=S,o){S===o&&k!=="\\"&&(o=null);continue}if(S==='"'||S==="'"||S==="`"){o=S;continue}if(S==="("?u+=1:S===")"?u=Math.max(0,u-1):S==="["?f+=1:S==="]"?f=Math.max(0,f-1):S==="{"?p+=1:S==="}"&&(p=Math.max(0,p-1)),S!==`
`)continue;let N=e[F+1];u===0&&f===0&&p===0&&!(N===" "||N==="	")&&!(N===`
`)&&M()}return M(),g},App.segment_code=e=>{let t=App.normalize_code(e);if(!t)return[];let o=t.split(/\n{2,}/g).map(f=>f.trim()).filter(Boolean),u=[];for(let f of o){if(!f.includes(`
`)){u.push(f);continue}let p=App.split_by_newlines(f);p.length?u.push(...p):u.push(f)}if(u.length<=1&&t.includes(`
`)){let f=t.split(/\n+/g).map(p=>p.trim()).filter(Boolean);if(f.length>1)return f}return u},App.apply_partial_update=async e=>{let t=App.segment_code(e);if(!t.length)return!1;let o=[],u=0;for(let p of t){let g=await App.run_eval(p);if(g.ok){o.push(p);continue}u+=1,console.warn("Skipping segment due to error",g.error)}if(!o.length)return!1;let f=o.join(`

`);return App.set_input(f),u>0?App.playing(`Skipped ${u} segment(s)`):App.playing(),!0},App.ensure_strudel_ready=async()=>App.strudel_init?(await App.strudel_init(),!0):(App.set_status("Bundle not loaded. Check console for errors"),console.error("strudel.bundle.js is missing or failed to load"),!1),App.restart_code_scroll=()=>{App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.start_events=async()=>{if(App.events_started)return;App.events_started=!0,await App.get_config(),App.load_all_storage(),App.create_modals(),App.start_visual(),DOM.ev("#btn-play","click",()=>{let o=App.get_input_value();App.play_action(o,!0)}),DOM.ev("#btn-auto","click",()=>{App.open_auto_modal()}),DOM.ev("#btn-stop","click",()=>{App.stop_action()}),DOM.ev("#btn-new","click",()=>{App.new_beat()}),DOM.ev("#btn-songs","click",()=>{App.open_songs_modal()});let e=DOM.el("#image");e&&DOM.ev(e,"click",()=>{App.open_settings_modal()});let t=DOM.el("#title");t&&DOM.ev(t,"click",()=>{App.open_about_modal()}),App.setup_status(),App.setup_volume(),App.setup_auto(),App.setup_input(),App.setup_scope(),App.init_volume_controls(),App.init_tempo_controls(),App.init_code_input_controls(),App.start_keyboard(),DOM.ev(window,"resize",()=>{App.handle_scope_resize()}),App.make_main_visible(),App.set_cpm_from_query(),App.set_beat_title_from_query(),App.max_input(),await App.load_song_from_query()||App.load_code_from_query()||App.load_last_code()},App.make_main_visible=()=>{DOM.el("#main").classList.remove("invisible")},App.set_title=e=>{if(e){document.title=`${App.app_name} - ${e}`;return}document.title=App.app_name},App.update_url=(e="")=>{let t=new URL(window.location.href),o=App.get_input_value().trim();if(e||(e=App.get_song_name()),e?t.searchParams.set(App.song_query_key,e):t.searchParams.delete(App.song_query_key),e||o?t.searchParams.set(App.cpm_query_key,`${App.tempo}`):t.searchParams.delete(App.cpm_query_key),o&&!e&&o.length<=App.code_url_max){let u=App.compress_string(o);t.searchParams.set(App.code_query_key,u)}else t.searchParams.delete(App.code_query_key);!e&&App.beat_title?t.searchParams.set(App.beat_query_key,App.beat_title):t.searchParams.delete(App.beat_query_key),window.history.replaceState({},document.title,`${t.pathname}${t.search}${t.hash}`)},App.get_query_params=()=>new URLSearchParams(window.location.search),App.update_title=()=>{let e=App.app_name,t=App.get_song_name(!0);t?e=`${e} - ${t}`:App.beat_title&&(e=`${e} - ${App.beat_title}`),document.title=e},App.get_top_height=()=>{let e=DOM.el("#top");return App.get_el_height(e)},App.get_scope_height=()=>{if(App.scope_enabled){let e=DOM.el("#scope-container");return App.get_el_height(e)}return 0},App.get_controls_height=()=>{let e=DOM.el("#controls");return App.get_el_height(e)},App.loading=()=>{App.set_status("Loading...")},App.new_beat=()=>{confirm("Start a new beat?")&&(App.last_code="",App.current_song="",App.set_input(""),App.stop_action(),App.focus_input())},window.H=H,window.initHydra=initHydra,window.clearHydra=clearHydra,window.lz=m$2,App.filter_code=e=>(e=e.replace(/\n\s*\n\s*\n+/g,`

`),e.trim()),App.code_scroll_frame=void 0,App.code_scroll_last_ts=0,App.code_scroll_direction=1,App.code_scroll_active=!1,App.code_scroll_speed_px_per_second=80,App.code_scroll_pause_until=0,App.code_scroll_wheel_pause_ms=1e3,App.code_scroll_song_pause_ms=1.2*1e3,App.code_scroll_pending_delay_ms=0,App.input_mirror_time=2.8*1e3,App.input_grow_time=2.8*1e3,App.lines_enabled=!0,App.setup_input=()=>{App.start_input_resize_observer(),App.create_editor(),App.setup_editor_autocomplete(),App.max_button=App.get_max_button(),App.lines_enabled?App.enable_lines():App.disable_lines()},App.create_editor=()=>{let e=DOM.el("#code-input");App.editor=CodeMirror.fromTextArea(e,{theme:"nord",lineNumbers:!0,indentWithTabs:!0,tabSize:4,lineWrapping:!0,indentUnit:4}),App.editor.getWrapperElement().id="codemirror-wrapper",App.document=App.editor.getDoc(),App.editor.setOption("mode","javascript"),App.editor.refresh(),App.editor.focus()},App.get_input=()=>DOM.el("#codemirror-wrapper"),App.get_input_wrapper=()=>DOM.el("#code-input-wrapper"),App.get_input_value=()=>App.document.getValue(),App.defer_code_scroll=e=>{if(!Number.isFinite(e)||e<=0){App.code_scroll_pending_delay_ms=0;return}App.code_scroll_pending_delay_ms=e},App.reset_code_scroll_for_content=(e={})=>{let t=0,o=e.scroll_delay_ms??App.code_scroll_song_pause_ms,u=e.direction??1;if(App.code_scroll_active&&(Number.isFinite(App.code_scroll_pending_delay_ms)&&App.code_scroll_pending_delay_ms>0?t=App.code_scroll_pending_delay_ms:Number.isFinite(o)&&o>0&&(t=o)),App.code_scroll_pending_delay_ms=0,App.code_scroll_direction=u,App.code_scroll_last_ts=0,t<=0||typeof window>"u"){App.code_scroll_pause_until=0;return}window.performance?.now?App.code_scroll_pause_until=window.performance.now()+t:App.code_scroll_pause_until=t},App.set_input=e=>{App.document.setValue(e),App.scroll_input_to_top(),App.reset_code_scroll_for_content()},App.set_code_scroll_button_active=e=>{let t=DOM.el("#code-input-scroll");if(t){if(e){t.classList.add("active");return}t.classList.remove("active")}},App.code_scroll_tick=e=>{if(!App.code_scroll_active){App.code_scroll_frame=void 0;return}if(!App.editor){App.stop_code_scroll();return}if(App.code_scroll_last_ts||(App.code_scroll_last_ts=e),App.code_scroll_pause_until&&e<App.code_scroll_pause_until){App.code_scroll_last_ts=e,App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick);return}App.code_scroll_pause_until=0;let t=e-App.code_scroll_last_ts;App.code_scroll_last_ts=e;let o=App.code_scroll_speed_px_per_second*t/1e3,u=App.get_input_scroll()+o*App.code_scroll_direction,f=Math.max(0,App.get_input_height()-App.get_input_client_height());if(App.set_input_scroll(u),f<=0){App.stop_code_scroll();return}App.code_scroll_direction>0&&Math.ceil(App.get_input_scroll())+1>=f?(App.set_input_scroll(f),App.reset_code_scroll_for_content({direction:-1})):App.code_scroll_direction<0&&App.get_input_scroll()<=0&&(App.scroll_input_to_top(),App.reset_code_scroll_for_content({direction:1})),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick)},App.start_code_scroll=()=>{App.code_scroll_active||Math.max(0,App.get_input_height()-App.get_input_client_height())<=0||(App.code_scroll_active=!0,App.code_scroll_direction=1,App.code_scroll_last_ts=window.performance.now()-16,App.code_scroll_pause_until=0,App.set_code_scroll_button_active(!0),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick))},App.stop_code_scroll=()=>{!App.code_scroll_active&&!App.code_scroll_frame||(App.code_scroll_active=!1,App.code_scroll_direction=1,App.code_scroll_last_ts=0,App.code_scroll_pause_until=0,App.code_scroll_frame&&(window.cancelAnimationFrame(App.code_scroll_frame),App.code_scroll_frame=void 0),App.set_code_scroll_button_active(!1))},App.init_code_input_controls=()=>{let e=App.get_input_wrapper(),t=DOM.el("#code-input-scroll"),o=App.get_max_button(),u=DOM.el("#code-input-top"),f=DOM.el("#code-input-bottom"),p=DOM.el("#code-input-sounds"),g=DOM.el("#code-input-notes"),M=DOM.el("#code-input-banks");u&&DOM.ev(u,"click",S=>{S.preventDefault(),App.scroll_input_to_top(),App.reset_code_scroll_for_content()}),f&&DOM.ev(f,"click",S=>{S.preventDefault(),App.scroll_input_to_bottom(),App.reset_code_scroll_for_content({direction:-1})}),t&&DOM.ev(t,"click",S=>{if(S.preventDefault(),App.code_scroll_active){App.stop_code_scroll();return}App.start_code_scroll()}),o&&DOM.ev(o,"click",S=>{App.max_input()}),p&&DOM.ev(p,"click",S=>{S.preventDefault(),App.show_sounds_context(S)}),g&&DOM.ev(g,"click",S=>{S.preventDefault(),App.show_notes_context(S)}),M&&DOM.ev(M,"click",S=>{S.preventDefault(),App.show_banks_context(S)});let F=App.get_input();if(DOM.ev(F,"pointerdown",S=>{if(!App.code_scroll_active)return;let N=S.target.getBoundingClientRect();S.clientX>N.right-20&&S.clientY>N.bottom-20||App.stop_code_scroll()}),e){let S=DOM.el("#resize-handle");if(S){let k=!1;DOM.ev(S,"mousedown",N=>{N.preventDefault(),k=!0,document.body.style.userSelect="none",document.body.style.cursor="se-resize",App.activate_top_input_controls(),App.activate_bottom_input_controls(),S.style.opacity="1",S.style.pointerEvents="auto",S.classList.add("active");let $=N.clientX,R=N.clientY,U=e.offsetWidth,O=e.offsetHeight,Z=ie=>{if(!k)return;let de=U+(ie.clientX-$),te=O+(ie.clientY-R),re=getComputedStyle(document.documentElement),ue=parseInt(re.getPropertyValue("--input_min_width")),ve=parseInt(re.getPropertyValue("--input_min_height"));de=Math.max(ue,de),te=Math.max(ve,te),e.style.width=`${de}px`,e.style.height=`${te}px`},K=()=>{k=!1,document.body.style.userSelect="",document.body.style.cursor="",App.deactivate_top_input_controls(),App.deactivate_bottom_input_controls(),S.style.opacity="",S.style.pointerEvents="",S.classList.remove("active"),document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",Z),document.addEventListener("mouseup",K)}),DOM.ev(S,"dblclick",N=>{App.restore_input()})}DOM.ev(e,"mouseover",()=>{App.check_max_button()})}DOM.ev(F,"wheel",S=>{App.code_scroll_active&&(window.performance?.now?App.code_scroll_pause_until=window.performance.now()+App.code_scroll_wheel_pause_ms:App.code_scroll_pause_until=App.code_scroll_wheel_pause_ms,S.deltaY<0?App.code_scroll_direction=-1:S.deltaY>0&&(App.code_scroll_direction=1))},{passive:!0})},App.start_input_resize_observer=()=>{let e=App.get_input_wrapper();if(!e)return;new ResizeObserver(()=>{App.scope_debouncer.call(),App.enable_max_button()}).observe(e)},App.restore_input=()=>{let e=App.get_input_wrapper();if(!e)return;let t=getComputedStyle(document.documentElement),o=parseInt(t.getPropertyValue("--input_height")),u=parseInt(t.getPropertyValue("--input_max_width"));e.style.height=`${o}px`,e.style.width=`${u}%`},App.input_is_maxed=()=>{let e=App.get_input_wrapper(),t=parseInt(e.style.height),o=parseInt(e.style.width),[u,f]=App.max_input(!0);return t===u&&o===f},App.restart_code_scroll=()=>{App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.add_text_to_input=e=>{App.document.replaceSelection(e),App.editor.focus()},App.focus_input=()=>{App.editor.focus()},App.activate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.activate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.add("active"))},App.deactivate_top_input_controls=()=>{let e=DOM.el("#code-input-controls-top");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.deactivate_bottom_input_controls=()=>{let e=DOM.el("#code-input-controls-bottom");e&&(e.style.opacity="1",e.style.pointerEvents="auto",e.classList.remove("active"))},App.mirror_input=()=>{let e=App.get_input();e.classList.add("mirror"),clearTimeout(App.input_mirror_timeout),App.input_mirror_timeout=setTimeout(()=>{e.classList.remove("mirror")},App.input_mirror_time)},App.glow_input=()=>{let e=App.get_input();e.classList.add("glow"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{e.classList.remove("glow")},App.input_grow_time)},App.cursive_input=()=>{let e=App.get_input();e.classList.add("cursive"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{e.classList.remove("cursive")},App.input_grow_time)},App.max_input=(e=!1)=>{let t=App.get_input_wrapper(),o=getComputedStyle(document.documentElement),u=parseInt(o.getPropertyValue("--input_max_width")),f=App.get_input_diff();return e||(t.style.height=`${f}px`,t.style.width=`${u}%`,App.check_max_button(),App.editor.refresh()),[f,u]},App.get_input_diff=()=>{let e=App.get_top_height(),t=App.get_scope_height(),o=App.get_controls_height(),u=e+t+o;return App.viewport_height()-u-33},App.check_max_button=()=>{App.input_is_maxed()?App.disable_max_button():App.enable_max_button()},App.get_max_button=()=>DOM.el("#code-input-max"),App.enable_max_button=()=>{App.max_button.classList.remove("disabled")},App.disable_max_button=()=>{App.max_button.classList.add("disabled")},App.set_input_scroll=e=>{App.editor.scrollTo(null,e)},App.scroll_input_to_top=()=>{App.set_input_scroll(0)},App.scroll_input_to_bottom=()=>{let e=App.editor.getScrollInfo();App.editor.scrollTo(null,e.height)},App.get_input_scroll=()=>App.editor.getScrollInfo().top,App.get_input_height=()=>App.editor.getScrollInfo().height,App.get_input_client_height=()=>App.editor.getScrollInfo().clientHeight,App.set_input_border=e=>{let t=App.get_input();t.style.borderColor=e},App.toggle_lines=()=>{App.lines_enabled=!App.lines_enabled,App.lines_enabled?App.enable_lines():App.disable_lines(),App.stor_save_lines()},App.enable_lines=()=>{App.editor.setOption("lineNumbers",!0)},App.disable_lines=()=>{App.editor.setOption("lineNumbers",!1)},App.volume=100,App.volume_step=1,App.setup_volume=()=>{App.update_volume(App.volume)},App.get_volume_slider=()=>DOM.el("#volume-slider"),App.get_volume_value=()=>DOM.el("#volume-value"),App.read_volume_value=e=>{if(!e)return App.volume;let t=e.valueAsNumber;if(Number.isFinite(t))return t;let o=parseInt(e.value,10);return Number.isFinite(o)?o:App.volume},App.refresh_volume_ui=()=>{let e=App.get_volume_slider(),t=App.get_volume_value();e&&(e.value=`${App.volume}`),t&&(t.innerText=`${App.volume}%`)},App.apply_volume=()=>{if(App.audio_started)try{let t=getSuperdoughAudioController()?.output?.destinationGain;if(!t){console.warn("Destination gain node missing");return}t.gain.value=App.volume/100}catch(e){console.error("Failed to apply volume",e)}},App.update_volume=e=>{let t=Number(e);Number.isFinite(t)||(t=App.volume),t=Math.min(100,Math.max(0,t)),App.volume=t,App.refresh_volume_ui(),App.stor_save_volume(),App.apply_volume()},App.init_volume_controls=()=>{let e=App.get_volume_slider(),t=DOM.el("#volume-control"),o=DOM.el("#volume-decrement"),u=DOM.el("#volume-increment");if(!e)return;App.refresh_volume_ui(),App.stor_save_volume(),DOM.ev(e,"input",p=>{App.update_volume(App.read_volume_value(p.target))});let f=p=>{App.update_volume(App.volume+p*App.volume_step)};o&&DOM.ev(o,"click",()=>{f(-1)}),u&&DOM.ev(u,"click",()=>{f(1)}),DOM.ev(t,"auxclick",p=>{p.button===1&&App.update_volume(50)}),DOM.ev(t,"wheel",p=>{p.preventDefault();let g=parseInt(e.step,10)||App.volume_step,M=parseInt(e.value,10);p.deltaY<0?e.value=M+g:e.value=M-g,App.update_volume(App.read_volume_value(e))},{passive:!1})},App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.tempo_commit_delay_ms=500,App.min_tempo=10,App.max_tempo=100,App.tempo_step=5,App.tempo_wheel_commit_timer=void 0,App.tempo_wheel_commit_delay_ms=150,App.schedule_tempo_commit=e=>{if(typeof window>"u"){e();return}App.tempo_debounce_timer&&window.clearTimeout(App.tempo_debounce_timer),App.tempo_debounce_timer=window.setTimeout(()=>{App.tempo_debounce_timer=void 0,e()},App.tempo_commit_delay_ms)},App.schedule_tempo_wheel_commit=()=>{if(typeof window>"u"){App.on_tempo_change(!0,App.tempo);return}App.tempo_wheel_commit_timer&&window.clearTimeout(App.tempo_wheel_commit_timer),App.tempo_wheel_commit_timer=window.setTimeout(()=>{App.tempo_wheel_commit_timer=void 0,App.on_tempo_change(!0,App.tempo)},App.tempo_wheel_commit_delay_ms)},App.get_tempo_slider=()=>DOM.el("#tempo-slider"),App.get_tempo_value=()=>DOM.el("#tempo-value"),App.refresh_tempo_ui=()=>{let e=App.get_tempo_slider(),t=App.get_tempo_value();e&&(e.value=`${App.tempo}`),t&&(t.textContent=`${App.tempo} cpm`)},App.persist_tempo=()=>{if(!(typeof window>"u"))try{App.stor_save_tempo()}catch(e){console.warn("Failed to persist tempo",e)}},App.update_tempo=e=>{let t=parseInt(e,10);Number.isFinite(t)||(t=App.tempo),t=Math.round(t/App.tempo_step)*App.tempo_step,t=Math.min(App.max_tempo,Math.max(App.min_tempo,t)),App.tempo=t,App.refresh_tempo_ui()},App.on_tempo_change=(e=!1,t=void 0)=>{let o=t;o===null&&(o=App.get_tempo_slider()?.value),App.update_tempo(o),e&&App.schedule_tempo_commit(()=>{App.persist_tempo(),App.set_tempo(),App.update_url()})},App.init_tempo_controls=()=>{let e=App.get_tempo_slider(),t=DOM.el("#tempo-control"),o=DOM.el("#tempo-decrement"),u=DOM.el("#tempo-increment"),f=DOM.el("#tempo-intended");if(!e)return;App.refresh_tempo_ui(),App.persist_tempo(),DOM.ev(e,"input",g=>{App.update_tempo(g.target.value)}),DOM.ev(t,"auxclick",g=>{g.button===1&&(e.value=App.default_cpm,App.update_tempo(App.default_cpm),App.set_tempo(),App.update_url())}),DOM.ev(t,"wheel",g=>{if(g.preventDefault(),!e)return;let M=parseInt(e.step,10);(!Number.isFinite(M)||M<=0)&&(M=App.tempo_step);let F=e.valueAsNumber;if(Number.isFinite(F)||(F=App.tempo),g.deltaY<0)F+=M;else if(g.deltaY>0)F-=M;else return;App.on_tempo_change(!1,F),App.schedule_tempo_wheel_commit()},{passive:!1}),DOM.ev(t,"change",()=>{App.on_tempo_change(!0)});let p=g=>{let M=App.tempo+g*App.tempo_step;App.on_tempo_change(!0,M)};o&&DOM.ev(o,"click",()=>{p(-1)}),u&&DOM.ev(u,"click",()=>{p(1)}),f&&DOM.ev(f,"click",()=>{App.set_song_tempo(App.last_code)})},App.set_tempo=()=>{try{App.scheduler.setCps(App.tempo/60)}catch(e){console.debug("Tempo will be applied when audio starts",e)}},App.intended_cpm=e=>{let t=g=>{try{return Function(`"use strict"; return (${g})`)()}catch{return null}},o=App.default_cpm,u=e.match(/setcpm\(\s*([\d./*+ -]+)\s*\)/),f=e.match(/setcps\(\s*([\d./*+ -]+)\s*\)/),p=e.match(/setbpm\(\s*([\d./*+ -]+)\s*\)/);if(u){let g=t(u[1]);g!==null&&(o=g)}else if(f){let g=t(f[1]);g!==null&&(o=g*60)}else if(p){let g=t(p[1]);g!==null&&(o=g/4)}return o},App.set_song_tempo=e=>{App.tempo=App.intended_cpm(e),App.set_tempo(),App.refresh_tempo_ui()};function isNamedPitch$6(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$6(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$6=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$6=FIFTHS$6.map(e=>Math.floor(e*7/12));function coordinates$6(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$6[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$6[t]-4*o;return[f*p,f*g]}var FIFTHS_TO_STEPS$3=[3,0,4,1,5,2,6];function pitch$3(e){const[t,o,u]=e,f=FIFTHS_TO_STEPS$3[unaltered$3(t)],p=Math.floor((t+1)/7);if(o===void 0)return{step:f,alt:p,dir:u};const g=o+4*p+STEPS_TO_OCTS$6[f];return{step:f,alt:p,oct:g,dir:u}}function unaltered$3(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$9=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$5=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$5="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$5="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$c=new RegExp("^"+INTERVAL_TONAL_REGEX$5+"|"+INTERVAL_SHORTHAND_REGEX$5+"$");function tokenizeInterval$5(e){const t=REGEX$c.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$9={};function interval$5(e){return typeof e=="string"?cache$9[e]||(cache$9[e]=parse$9(e)):isPitch$6(e)?interval$5(pitchName$7(e)):isNamedPitch$6(e)?interval$5(e.name):NoInterval$5}var SIZES$6=[0,2,4,5,7,9,11],TYPES$5="PMMPPMM";function parse$9(e){const t=tokenizeInterval$5(e);if(t[0]==="")return NoInterval$5;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES$5[f];if(p==="M"&&u==="P")return NoInterval$5;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt$5(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$6[f]+k+12*N),R=(F*(SIZES$6[f]+k)%12+12)%12,U=coordinates$6({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval$2(e,t){const[o,u=0]=e,f=o*7+u*12<0,p=t||f?[-o,-u,-1]:[o,u,1];return interval$5(pitch$3(p))}function qToAlt$5(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$7(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES$5[t]==="M"?"majorable":"perfectable";return M+g+altToQ$5(F,o)}function altToQ$5(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$9("A",t):fillStr$9("d",e==="perfectable"?t:t+1)}function isNamedPitch$5(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$5(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$5=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$5=FIFTHS$5.map(e=>Math.floor(e*7/12));function coordinates$5(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$5[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$5[t]-4*o;return[f*p,f*g]}var FIFTHS_TO_STEPS$2=[3,0,4,1,5,2,6];function pitch$2(e){const[t,o,u]=e,f=FIFTHS_TO_STEPS$2[unaltered$2(t)],p=Math.floor((t+1)/7);if(o===void 0)return{step:f,alt:p,dir:u};const g=o+4*p+STEPS_TO_OCTS$5[f];return{step:f,alt:p,oct:g,dir:u}}function unaltered$2(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$8=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote$1=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),cache$8=new Map,stepToLetter$1=e=>"CDEFGAB".charAt(e),altToAcc$1=e=>e<0?fillStr$8("b",-e):fillStr$8("#",e),accToAlt$1=e=>e[0]==="b"?-e.length:e.length;function note$1(e){const t=JSON.stringify(e),o=cache$8.get(t);if(o)return o;const u=typeof e=="string"?parse$8(e):isPitch$5(e)?note$1(pitchName$6(e)):isNamedPitch$5(e)?note$1(e.name):NoNote$1;return cache$8.set(t,u),u}var REGEX$b=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote$1(e){const t=REGEX$b.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote$1(e){return note$1(pitch$2(e))}var mod$1=(e,t)=>(e%t+t)%t,SEMI$1=[0,2,4,5,7,9,11];function parse$8(e){const t=tokenizeNote$1(e);if(t[0]===""||t[3]!=="")return NoNote$1;const o=t[0],u=t[1],f=t[2],p=(o.charCodeAt(0)+3)%7,g=accToAlt$1(u),M=f.length?+f:void 0,F=coordinates$5({step:p,alt:g,oct:M}),S=o+u+f,k=o+u,N=(SEMI$1[p]+g+120)%12,$=M===void 0?mod$1(SEMI$1[p]+g,12)-1188:SEMI$1[p]+g+12*(M+1),R=$>=0&&$<=127?$:null,U=M===void 0?null:Math.pow(2,($-69)/12)*440;return{empty:!1,acc:u,alt:g,chroma:N,coord:F,freq:U,height:$,letter:o,midi:R,name:S,oct:M,pc:k,step:p}}function pitchName$6(e){const{step:t,alt:o,oct:u}=e,f=stepToLetter$1(t);if(!f)return"";const p=f+altToAcc$1(o);return u||u===0?p+u:p}function transpose$5(e,t){const o=note$1(e),u=Array.isArray(t)?t:interval$5(t).coord;if(o.empty||!u||u.length<2)return"";const f=o.coord,p=f.length===1?[f[0]+u[0]]:[f[0]+u[0],f[1]+u[1]];return coordToNote$1(p).name}function tonicIntervalsTransposer$1(e,t){const o=e.length;return u=>{if(!t)return"";const f=u<0?(o- -u%o)%o:u%o,p=Math.floor(u/o),g=transpose$5(t,[0,p]);return transpose$5(g,e[f])}}function distance$5(e,t){const o=note$1(e),u=note$1(t);if(o.empty||u.empty)return"";const f=o.coord,p=u.coord,g=p[0]-f[0],M=f.length===2&&p.length===2?p[1]-f[1]:-Math.floor(g*7/12),F=u.height===o.height&&u.midi!==null&&o.oct===u.oct&&o.step>u.step;return coordToInterval$2([g,M],F).name}var fillStr$7=(e,t)=>Array(t+1).join(e),REGEX$a=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function tokenize$4(e){const t=REGEX$a.exec(e);return t?[t[1],t[2],t[3]]:["","",""]}function abcToScientificNotation(e){const[t,o,u]=tokenize$4(e);if(o==="")return"";let f=4;for(let g=0;g<u.length;g++)f+=u.charAt(g)===","?-1:1;const p=t[0]==="_"?t.replace(/_/g,"b"):t[0]==="^"?t.replace(/\^/g,"#"):"";return o.charCodeAt(0)>96?o.toUpperCase()+p+(f+1):o+p+f}function scientificToAbcNotation(e){const t=note$1(e);if(t.empty||!t.oct&&t.oct!==0)return"";const{letter:o,acc:u,oct:f}=t,p=u[0]==="b"?u.replace(/b/g,"_"):u.replace(/#/g,"^"),g=f>4?o.toLowerCase():o,M=f===5?"":f>4?fillStr$7("'",f-5):fillStr$7(",",4-f);return p+g+M}function transpose$4(e,t){return scientificToAbcNotation(transpose$5(abcToScientificNotation(e),t))}function distance$4(e,t){return distance$5(abcToScientificNotation(e),abcToScientificNotation(t))}var abc_notation_default={abcToScientificNotation,scientificToAbcNotation,tokenize:tokenize$4,transpose:transpose$4,distance:distance$4};function ascR$1(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR$1(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range$1(e,t){return e<t?ascR$1(e,t-e+1):descR$1(e,e-t+1)}function rotate$1(e,t){const o=t.length,u=(e%o+o)%o;return t.slice(u,o).concat(t.slice(0,u))}function compact$1(e){return e.filter(t=>t===0||t)}function sortedNoteNames(e){return e.map(o=>note$1(o)).filter(o=>!o.empty).sort((o,u)=>o.height-u.height).map(o=>o.name)}function sortedUniqNoteNames(e){return sortedNoteNames(e).filter((t,o,u)=>o===0||t!==u[o-1])}function shuffle$1(e,t=Math.random){let o,u,f=e.length;for(;f;)o=Math.floor(t()*f--),u=e[f],e[f]=e[o],e[o]=u;return e}function permutations$1(e){return e.length===0?[[]]:permutations$1(e.slice(1)).reduce((t,o)=>t.concat(e.map((u,f)=>{const p=o.slice();return p.splice(f,0,e[0]),p})),[])}const index$6=Object.freeze(Object.defineProperty({__proto__:null,compact:compact$1,permutations:permutations$1,range:range$1,rotate:rotate$1,shuffle:shuffle$1,sortedNoteNames,sortedUniqNoteNames},Symbol.toStringTag,{value:"Module"}));function ascR(e,t){const o=[];for(;t--;o[t]=t+e);return o}function descR(e,t){const o=[];for(;t--;o[t]=e-t);return o}function range(e,t){return e<t?ascR(e,t-e+1):descR(e,e-t+1)}function rotate(e,t){const o=t.length,u=(e%o+o)%o;return t.slice(u,o).concat(t.slice(0,u))}function compact(e){return e.filter(t=>t===0||t)}function shuffle(e,t=Math.random){let o,u,f=e.length;for(;f;)o=Math.floor(t()*f--),u=e[f],e[f]=e[o],e[o]=u;return e}function permutations(e){return e.length===0?[[]]:permutations(e.slice(1)).reduce((t,o)=>t.concat(e.map((u,f)=>{const p=o.slice();return p.splice(f,0,e[0]),p})),[])}var collection_default={compact,permutations,range,rotate,shuffle};function isNamedPitch$4(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$4(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$4=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$4=FIFTHS$4.map(e=>Math.floor(e*7/12));function coordinates$4(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$4[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$4[t]-4*o;return[f*p,f*g]}var fillStr$6=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$4=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$4="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$4="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$9=new RegExp("^"+INTERVAL_TONAL_REGEX$4+"|"+INTERVAL_SHORTHAND_REGEX$4+"$");function tokenizeInterval$4(e){const t=REGEX$9.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$7={};function interval$4(e){return typeof e=="string"?cache$7[e]||(cache$7[e]=parse$7(e)):isPitch$4(e)?interval$4(pitchName$5(e)):isNamedPitch$4(e)?interval$4(e.name):NoInterval$4}var SIZES$5=[0,2,4,5,7,9,11],TYPES$4="PMMPPMM";function parse$7(e){const t=tokenizeInterval$4(e);if(t[0]==="")return NoInterval$4;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES$4[f];if(p==="M"&&u==="P")return NoInterval$4;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt$4(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$5[f]+k+12*N),R=(F*(SIZES$5[f]+k)%12+12)%12,U=coordinates$4({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt$4(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$5(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES$4[t]==="M"?"majorable":"perfectable";return M+g+altToQ$4(F,o)}function altToQ$4(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$6("A",t):fillStr$6("d",e==="perfectable"?t:t+1)}var EmptyPcset={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},setNumToChroma=e=>Number(e).toString(2).padStart(12,"0"),chromaToNumber=e=>parseInt(e,2),REGEX$8=/^[01]{12}$/;function isChroma(e){return REGEX$8.test(e)}var isPcsetNum=e=>typeof e=="number"&&e>=0&&e<=4095,isPcset=e=>e&&isChroma(e.chroma),cache$6={[EmptyPcset.chroma]:EmptyPcset};function get$b(e){const t=isChroma(e)?e:isPcsetNum(e)?setNumToChroma(e):Array.isArray(e)?listToChroma(e):isPcset(e)?e.chroma:EmptyPcset.chroma;return cache$6[t]=cache$6[t]||chromaToPcset(t)}var pcset$1=get$b,chroma$3=e=>get$b(e).chroma,intervals=e=>get$b(e).intervals,num$1=e=>get$b(e).setNum,IVLS=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function chromaToIntervals(e){const t=[];for(let o=0;o<12;o++)e.charAt(o)==="1"&&t.push(IVLS[o]);return t}function notes$1(e){return get$b(e).intervals.map(t=>transpose$5("C",t))}function chromas(){return range(2048,4095).map(setNumToChroma)}function modes$1(e,t=!0){const u=get$b(e).chroma.split("");return compact(u.map((f,p)=>{const g=rotate(p,u);return t&&g[0]==="0"?null:g.join("")}))}function isEqual(e,t){return get$b(e).setNum===get$b(t).setNum}function isSubsetOf(e){const t=get$b(e).setNum;return o=>{const u=get$b(o).setNum;return t&&t!==u&&(u&t)===u}}function isSupersetOf(e){const t=get$b(e).setNum;return o=>{const u=get$b(o).setNum;return t&&t!==u&&(u|t)===u}}function isNoteIncludedIn(e){const t=get$b(e);return o=>{const u=note$1(o);return t&&!u.empty&&t.chroma.charAt(u.chroma)==="1"}}function filter(e){const t=isNoteIncludedIn(e);return o=>o.filter(t)}var pcset_default={get:get$b,chroma:chroma$3,num:num$1,intervals,chromas,isSupersetOf,isSubsetOf,isNoteIncludedIn,isEqual,filter,modes:modes$1,notes:notes$1,pcset:pcset$1};function chromaRotations(e){const t=e.split("");return t.map((o,u)=>rotate(u,t).join(""))}function chromaToPcset(e){const t=chromaToNumber(e),o=chromaRotations(e).map(chromaToNumber).filter(p=>p>=2048).sort()[0],u=setNumToChroma(o),f=chromaToIntervals(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:u,intervals:f}}function listToChroma(e){if(e.length===0)return EmptyPcset.chroma;let t;const o=[0,0,0,0,0,0,0,0,0,0,0,0];for(let u=0;u<e.length;u++)t=note$1(e[u]),t.empty&&(t=interval$4(e[u])),t.empty||(o[t.chroma]=1);return o.join("")}var CHORDS$3=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$5=CHORDS$3;({...EmptyPcset});var dictionary$4=[],index$5={};function all$4(){return dictionary$4.slice()}function add$6(e,t,o){const u=getQuality$3(e),f={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$4.push(f),f.name&&(index$5[f.name]=f),index$5[f.setNum]=f,index$5[f.chroma]=f,f.aliases.forEach(p=>addAlias$4(f,p))}function addAlias$4(e,t){index$5[t]=e}function getQuality$3(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$5.forEach(([e,t,o])=>add$6(e.split(" "),o.split(" "),t)),dictionary$4.sort((e,t)=>e.setNum-t.setNum);var namedSet=e=>{const t=e.reduce((o,u)=>{const f=note$1(u).chroma;return f!==void 0&&(o[f]=o[f]||note$1(u).name),o},{});return o=>t[o]};function detect$1(e,t={}){const o=e.map(f=>note$1(f).pc).filter(f=>f);return note$1.length===0?[]:findMatches(o,1,t).filter(f=>f.weight).sort((f,p)=>p.weight-f.weight).map(f=>f.name)}var BITMASK={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},testChromaNumber=e=>t=>!!(t&e),hasAnyThird=testChromaNumber(BITMASK.anyThirds),hasPerfectFifth=testChromaNumber(BITMASK.perfectFifth),hasAnySeventh=testChromaNumber(BITMASK.anySeventh),hasNonPerfectFifth=testChromaNumber(BITMASK.nonPerfectFifths);function hasAnyThirdAndPerfectFifthAndAnySeventh(e){const t=parseInt(e.chroma,2);return hasAnyThird(t)&&hasPerfectFifth(t)&&hasAnySeventh(t)}function withPerfectFifth(e){const t=parseInt(e,2);return hasNonPerfectFifth(t)?e:(t|16).toString(2)}function findMatches(e,t,o){const u=e[0],f=note$1(u).chroma,p=namedSet(e),g=modes$1(e,!1),M=[];return g.forEach((F,S)=>{const k=o.assumePerfectFifth&&withPerfectFifth(F);all$4().filter($=>o.assumePerfectFifth&&hasAnyThirdAndPerfectFifthAndAnySeventh($)?$.chroma===k:$.chroma===F).forEach($=>{const R=$.aliases[0],U=p(S);S!==f?M.push({weight:.5*t,name:`${U}${R}/${u}`}):M.push({weight:1*t,name:`${U}${R}`})})}),M}function isNamedPitch$3(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}var SIZES$4=[0,2,4,5,7,9,11],chroma$2=({step:e,alt:t})=>(SIZES$4[e]+t+120)%12,height=({step:e,alt:t,oct:o,dir:u=1})=>u*(SIZES$4[e]+t+12*(o===void 0?-100:o)),midi$1=e=>{const t=height(e);return e.oct!==void 0&&t>=-12&&t<=115?t+12:null};function isPitch$3(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var FIFTHS$3=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$3=FIFTHS$3.map(e=>Math.floor(e*7/12));function coordinates$3(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$3[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$3[t]-4*o;return[f*p,f*g]}var FIFTHS_TO_STEPS$1=[3,0,4,1,5,2,6];function pitch$1(e){const[t,o,u]=e,f=FIFTHS_TO_STEPS$1[unaltered$1(t)],p=Math.floor((t+1)/7);if(o===void 0)return{step:f,alt:p,dir:u};const g=o+4*p+STEPS_TO_OCTS$3[f];return{step:f,alt:p,oct:g,dir:u}}function unaltered$1(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$5=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$3={empty:!0,name:"",acc:""},INTERVAL_TONAL_REGEX$3="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$3="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$7=new RegExp("^"+INTERVAL_TONAL_REGEX$3+"|"+INTERVAL_SHORTHAND_REGEX$3+"$");function tokenizeInterval$3(e){const t=REGEX$7.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$5={};function interval$3(e){return typeof e=="string"?cache$5[e]||(cache$5[e]=parse$6(e)):isPitch$3(e)?interval$3(pitchName$4(e)):isNamedPitch$3(e)?interval$3(e.name):NoInterval$3}var SIZES$3=[0,2,4,5,7,9,11],TYPES$3="PMMPPMM";function parse$6(e){const t=tokenizeInterval$3(e);if(t[0]==="")return NoInterval$3;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES$3[f];if(p==="M"&&u==="P")return NoInterval$3;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt$3(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$3[f]+k+12*N),R=(F*(SIZES$3[f]+k)%12+12)%12,U=coordinates$3({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval$1(e,t){const[o,u=0]=e,f=o*7+u*12<0,p=t||f?[-o,-u,-1]:[o,u,1];return interval$3(pitch$1(p))}function qToAlt$3(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$4(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES$3[t]==="M"?"majorable":"perfectable";return M+g+altToQ$3(F,o)}function altToQ$3(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$5("A",t):fillStr$5("d",e==="perfectable"?t:t+1)}var fillStr$4=(e,t)=>Array(Math.abs(t)+1).join(e),NoNote={empty:!0,name:"",pc:"",acc:""},cache$4=new Map,stepToLetter=e=>"CDEFGAB".charAt(e),altToAcc=e=>e<0?fillStr$4("b",-e):fillStr$4("#",e),accToAlt=e=>e[0]==="b"?-e.length:e.length;function note(e){const t=JSON.stringify(e),o=cache$4.get(t);if(o)return o;const u=typeof e=="string"?parse$5(e):isPitch$3(e)?note(pitchName$3(e)):isNamedPitch$3(e)?note(e.name):NoNote;return cache$4.set(t,u),u}var REGEX$6=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote(e){const t=REGEX$6.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function coordToNote(e){return note(pitch$1(e))}var mod=(e,t)=>(e%t+t)%t,SEMI=[0,2,4,5,7,9,11];function parse$5(e){const t=tokenizeNote(e);if(t[0]===""||t[3]!=="")return NoNote;const o=t[0],u=t[1],f=t[2],p=(o.charCodeAt(0)+3)%7,g=accToAlt(u),M=f.length?+f:void 0,F=coordinates$3({step:p,alt:g,oct:M}),S=o+u+f,k=o+u,N=(SEMI[p]+g+120)%12,$=M===void 0?mod(SEMI[p]+g,12)-1188:SEMI[p]+g+12*(M+1),R=$>=0&&$<=127?$:null,U=M===void 0?null:Math.pow(2,($-69)/12)*440;return{empty:!1,acc:u,alt:g,chroma:N,coord:F,freq:U,height:$,letter:o,midi:R,name:S,oct:M,pc:k,step:p}}function pitchName$3(e){const{step:t,alt:o,oct:u}=e,f=stepToLetter(t);if(!f)return"";const p=f+altToAcc(o);return u||u===0?p+u:p}function transpose$3(e,t){const o=note(e),u=Array.isArray(t)?t:interval$3(t).coord;if(o.empty||!u||u.length<2)return"";const f=o.coord,p=f.length===1?[f[0]+u[0]]:[f[0]+u[0],f[1]+u[1]];return coordToNote(p).name}function tonicIntervalsTransposer(e,t){const o=e.length;return u=>{if(!t)return"";const f=u<0?(o- -u%o)%o:u%o,p=Math.floor(u/o),g=transpose$3(t,[0,p]);return transpose$3(g,e[f])}}function distance$3(e,t){const o=note(e),u=note(t);if(o.empty||u.empty)return"";const f=o.coord,p=u.coord,g=p[0]-f[0],M=f.length===2&&p.length===2?p[1]-f[1]:-Math.floor(g*7/12),F=u.height===o.height&&u.midi!==null&&o.midi!==null&&o.step>u.step;return coordToInterval$1([g,M],F).name}var fillStr$3=(e,t)=>Array(Math.abs(t)+1).join(e);function deprecate(e,t,o){return function(...u){return console.warn(`${e} is deprecated. Use ${t}.`),o.apply(this,u)}}var isNamed=deprecate("isNamed","isNamedPitch",isNamedPitch$3);const Core=Object.freeze(Object.defineProperty({__proto__:null,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"}));var CHORDS$2=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$4=CHORDS$2,NoChordType={...EmptyPcset,name:"",quality:"Unknown",intervals:[],aliases:[]},dictionary$3=[],index$4={};function get$a(e){return index$4[e]||NoChordType}var chordType=deprecate("ChordType.chordType","ChordType.get",get$a);function names$8(){return dictionary$3.map(e=>e.name).filter(e=>e)}function symbols(){return dictionary$3.map(e=>e.aliases[0]).filter(e=>e)}function keys$1(){return Object.keys(index$4)}function all$3(){return dictionary$3.slice()}var entries$2=deprecate("ChordType.entries","ChordType.all",all$3);function removeAll$1(){dictionary$3=[],index$4={}}function add$5(e,t,o){const u=getQuality$2(e),f={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$3.push(f),f.name&&(index$4[f.name]=f),index$4[f.setNum]=f,index$4[f.chroma]=f,f.aliases.forEach(p=>addAlias$3(f,p))}function addAlias$3(e,t){index$4[t]=e}function getQuality$2(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$4.forEach(([e,t,o])=>add$5(e.split(" "),o.split(" "),t)),dictionary$3.sort((e,t)=>e.setNum-t.setNum);var chord_type_default={names:names$8,symbols,get:get$a,all:all$3,add:add$5,removeAll:removeAll$1,keys:keys$1,entries:entries$2,chordType},SCALES=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],data_default$3=SCALES,NoScaleType={...EmptyPcset,intervals:[],aliases:[]},dictionary$2=[],index$3={};function names$7(){return dictionary$2.map(e=>e.name)}function get$9(e){return index$3[e]||NoScaleType}var scaleType=get$9;function all$2(){return dictionary$2.slice()}var entries$1=all$2;function keys(){return Object.keys(index$3)}function removeAll(){dictionary$2=[],index$3={}}function add$4(e,t,o=[]){const u={...get$b(e),name:t,intervals:e,aliases:o};return dictionary$2.push(u),index$3[u.name]=u,index$3[u.setNum]=u,index$3[u.chroma]=u,u.aliases.forEach(f=>addAlias$2(u,f)),u}function addAlias$2(e,t){index$3[t]=e}data_default$3.forEach(([e,t,...o])=>add$4(e.split(" "),t,o));var scale_type_default={names:names$7,get:get$9,all:all$2,add:add$4,removeAll,keys,entries:entries$1,scaleType},NoChord={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize$3(e){const[t,o,u,f]=tokenizeNote(e);return t===""?["",e]:t==="A"&&f==="ug"?["","aug"]:[t+o,u+f]}function get$8(e){if(e==="")return NoChord;if(Array.isArray(e)&&e.length===2)return getChord(e[1],e[0]);{const[t,o]=tokenize$3(e),u=getChord(o,t);return u.empty?getChord(e):u}}function getChord(e,t,o){const u=get$a(e),f=note(t||""),p=note(o||"");if(u.empty||t&&f.empty||o&&p.empty)return NoChord;const g=distance$3(f.pc,p.pc),M=u.intervals.indexOf(g)+1;if(!p.empty&&!M)return NoChord;const F=Array.from(u.intervals);for(let $=1;$<M;$++){const R=F[0][0],U=F[0][1],O=parseInt(R,10)+7;F.push(`${O}${U}`),F.shift()}const S=f.empty?[]:F.map($=>transpose$3(f,$));e=u.aliases.indexOf(e)!==-1?e:u.aliases[0];const k=`${f.empty?"":f.pc}${e}${p.empty||M<=1?"":"/"+p.pc}`,N=`${t?f.pc+" ":""}${u.name}${M>1&&o?" over "+p.pc:""}`;return{...u,name:N,symbol:k,type:u.name,root:p.name,intervals:F,rootDegree:M,tonic:f.name,notes:S}}var chord=deprecate("Chord.chord","Chord.get",get$8);function transpose$2(e,t){const[o,u]=tokenize$3(e);return o?transpose$3(o,t)+u:e}function chordScales(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$2().filter(u=>o(u.chroma)).map(u=>u.name)}function extended$1(e){const t=get$8(e),o=isSupersetOf(t.chroma);return all$3().filter(u=>o(u.chroma)).map(u=>t.tonic+u.aliases[0])}function reduced$1(e){const t=get$8(e),o=isSubsetOf(t.chroma);return all$3().filter(u=>o(u.chroma)).map(u=>t.tonic+u.aliases[0])}function degrees$1(e){const{intervals:t,tonic:o}=get$8(e),u=tonicIntervalsTransposer(t,o);return f=>f?u(f>0?f-1:f):""}function steps$1(e){const{intervals:t,tonic:o}=get$8(e);return tonicIntervalsTransposer(t,o)}var chord_default={getChord,get:get$8,detect:detect$1,chordScales,extended:extended$1,reduced:reduced$1,tokenize:tokenize$3,transpose:transpose$2,degrees:degrees$1,steps:steps$1,chord},DATA=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],data_default$2=DATA,VALUES=[];data_default$2.forEach(([e,t,o])=>add$3(e,t,o));var NoDuration={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function names$6(){return VALUES.reduce((e,t)=>(t.names.forEach(o=>e.push(o)),e),[])}function shorthands(){return VALUES.map(e=>e.shorthand)}var REGEX$5=/^([^.]+)(\.*)$/;function get$7(e){const[t,o,u]=REGEX$5.exec(e)||[],f=VALUES.find(M=>M.shorthand===o||M.names.includes(o));if(!f)return NoDuration;const p=calcDots(f.fraction,u.length),g=p[0]/p[1];return{...f,name:e,dots:u,value:g,fraction:p}}var value=e=>get$7(e).value,fraction=e=>get$7(e).fraction,duration_value_default={names:names$6,shorthands,get:get$7,value,fraction};function add$3(e,t,o){VALUES.push({empty:!1,dots:"",name:"",value:1/e,fraction:e<1?[1/e,1]:[1,e],shorthand:t,names:o})}function calcDots(e,t){const o=Math.pow(2,t);let u=e[0]*o,f=e[1]*o;const p=u;for(let g=0;g<t;g++)u+=p/Math.pow(2,g+1);for(;u%2===0&&f%2===0;)u/=2,f/=2;return[u,f]}function names$5(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var get$6=interval$3,name$1=e=>interval$3(e).name,semitones=e=>interval$3(e).semitones,quality=e=>interval$3(e).q,num=e=>interval$3(e).num;function simplify$2(e){const t=interval$3(e);return t.empty?"":t.simple+t.q}function invert(e){const t=interval$3(e);if(t.empty)return"";const o=(7-t.step)%7,u=t.type==="perfectable"?-t.alt:-(t.alt+1);return interval$3({step:o,alt:u,oct:t.oct,dir:t.dir}).name}var IN=[1,2,2,3,3,4,5,5,6,6,7,7],IQ="P m M m M P d P m M m M".split(" ");function fromSemitones(e){const t=e<0?-1:1,o=Math.abs(e),u=o%12,f=Math.floor(o/12);return t*(IN[u]+7*f)+IQ[u]}var distance$2=distance$5,add$2=combinator((e,t)=>[e[0]+t[0],e[1]+t[1]]),addTo=e=>t=>add$2(e,t),substract=combinator((e,t)=>[e[0]-t[0],e[1]-t[1]]);function transposeFifths$2(e,t){const o=get$6(e);if(o.empty)return"";const[u,f,p]=o.coord;return coordToInterval$1([u+t,f,p]).name}var interval_default={names:names$5,get:get$6,name:name$1,num,semitones,quality,fromSemitones,distance:distance$2,invert,simplify:simplify$2,add:add$2,addTo,substract,transposeFifths:transposeFifths$2};function combinator(e){return(t,o)=>{const u=interval$3(t).coord,f=interval$3(o).coord;if(u&&f){const p=e(u,f);return coordToInterval$1(p).name}}}function isMidi(e){return+e>=0&&+e<=127}function toMidi(e){if(isMidi(e))return+e;const t=note$1(e);return t.empty?null:t.midi}function midiToFreq(e,t=440){return Math.pow(2,(e-69)/12)*t}var L2=Math.log(2),L440=Math.log(440);function freqToMidi(e){const t=12*(Math.log(e)-L440)/L2+69;return Math.round(t*100)/100}var SHARPS="C C# D D# E F F# G G# A A# B".split(" "),FLATS="C Db D Eb E F Gb G Ab A Bb B".split(" ");function midiToNoteName(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const u=(t.sharps===!0?SHARPS:FLATS)[e%12];if(t.pitchClass)return u;const f=Math.floor(e/12)-1;return u+f}function chroma$1(e){return e%12}function pcsetFromChroma(e){return e.split("").reduce((t,o,u)=>(u<12&&o==="1"&&t.push(u),t),[])}function pcsetFromMidi(e){return e.map(chroma$1).sort((t,o)=>t-o).filter((t,o,u)=>o===0||t!==u[o-1])}function pcset(e){return Array.isArray(e)?pcsetFromMidi(e):pcsetFromChroma(e)}function pcsetNearest(e){const t=pcset(e);return o=>{const u=chroma$1(o);for(let f=0;f<12;f++){if(t.includes(u+f))return o+f;if(t.includes(u-f))return o-f}}}function pcsetSteps(e,t){const o=pcset(e),u=o.length;return f=>{const p=f<0?(u- -f%u)%u:f%u,g=Math.floor(f/u);return o[p]+g*12+t}}function pcsetDegrees(e,t){const o=pcsetSteps(e,t);return u=>{if(u!==0)return o(u>0?u-1:u)}}var index_default$4={chroma:chroma$1,freqToMidi,isMidi,midiToFreq,midiToNoteName,pcsetNearest,pcset,pcsetDegrees,pcsetSteps,toMidi},NAMES$2=["C","D","E","F","G","A","B"],toName=e=>e.name,onlyNotes=e=>e.map(note$1).filter(t=>!t.empty);function names$4(e){return e===void 0?NAMES$2.slice():Array.isArray(e)?onlyNotes(e).map(toName):[]}var get$5=note$1,name=e=>get$5(e).name,pitchClass=e=>get$5(e).pc,accidentals=e=>get$5(e).acc,octave=e=>get$5(e).oct,midi=e=>get$5(e).midi,freq=e=>get$5(e).freq,chroma=e=>get$5(e).chroma;function fromMidi(e){return midiToNoteName(e)}function fromFreq(e){return midiToNoteName(freqToMidi(e))}function fromFreqSharps(e){return midiToNoteName(freqToMidi(e),{sharps:!0})}function fromMidiSharps(e){return midiToNoteName(e,{sharps:!0})}var distance$1=distance$5,transpose$1=transpose$5,tr=transpose$5,transposeBy=e=>t=>transpose$1(t,e),trBy=transposeBy,transposeFrom=e=>t=>transpose$1(e,t),trFrom=transposeFrom;function transposeFifths$1(e,t){return transpose$1(e,[t,0])}var trFifths=transposeFifths$1;function transposeOctaves(e,t){return transpose$1(e,[0,t])}var ascending=(e,t)=>e.height-t.height,descending=(e,t)=>t.height-e.height;function sortedNames(e,t){return t=t||ascending,onlyNotes(e).sort(t).map(toName)}function sortedUniqNames(e){return sortedNames(e,ascending).filter((t,o,u)=>o===0||t!==u[o-1])}var simplify$1=e=>{const t=get$5(e);return t.empty?"":midiToNoteName(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function enharmonic(e,t){const o=get$5(e);if(o.empty)return"";const u=get$5(t||midiToNoteName(o.midi||o.chroma,{sharps:o.alt<0,pitchClass:!0}));if(u.empty||u.chroma!==o.chroma)return"";if(o.oct===void 0)return u.pc;const f=o.chroma-o.alt,p=u.chroma-u.alt,g=f>11||p<0?-1:f<0||p>11?1:0,M=o.oct+g;return u.pc+M}var index_default$3={names:names$4,get:get$5,name,pitchClass,accidentals,octave,midi,ascending,descending,distance:distance$1,sortedNames,sortedUniqNames,fromMidi,fromMidiSharps,freq,fromFreq,fromFreqSharps,chroma,transpose:transpose$1,tr,transposeBy,trBy,transposeFrom,trFrom,transposeFifths:transposeFifths$1,transposeOctaves,trFifths,simplify:simplify$1,enharmonic};function isNamedPitch$2(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$2(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$2=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$2=FIFTHS$2.map(e=>Math.floor(e*7/12));function coordinates$2(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$2[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$2[t]-4*o;return[f*p,f*g]}var fillStr$2=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$2=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$2="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$2="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$4=new RegExp("^"+INTERVAL_TONAL_REGEX$2+"|"+INTERVAL_SHORTHAND_REGEX$2+"$");function tokenizeInterval$2(e){const t=REGEX$4.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$3={};function interval$2(e){return typeof e=="string"?cache$3[e]||(cache$3[e]=parse$4(e)):isPitch$2(e)?interval$2(pitchName$2(e)):isNamedPitch$2(e)?interval$2(e.name):NoInterval$2}var SIZES$2=[0,2,4,5,7,9,11],TYPES$2="PMMPPMM";function parse$4(e){const t=tokenizeInterval$2(e);if(t[0]==="")return NoInterval$2;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES$2[f];if(p==="M"&&u==="P")return NoInterval$2;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt$2(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$2[f]+k+12*N),R=(F*(SIZES$2[f]+k)%12+12)%12,U=coordinates$2({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt$2(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$2(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES$2[t]==="M"?"majorable":"perfectable";return M+g+altToQ$2(F,o)}function altToQ$2(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$2("A",t):fillStr$2("d",e==="perfectable"?t:t+1)}var NoRomanNumeral={empty:!0,name:"",chordType:""},cache$2={};function get$4(e){return typeof e=="string"?cache$2[e]||(cache$2[e]=parse$3(e)):typeof e=="number"?get$4(NAMES$1[e]||""):isPitch$2(e)?fromPitch(e):isNamedPitch$2(e)?get$4(e.name):NoRomanNumeral}var romanNumeral=get$4;function names$3(e=!0){return(e?NAMES$1:NAMES_MINOR).slice()}function fromPitch(e){return get$4(altToAcc$1(e.alt)+NAMES$1[e.step])}var REGEX$3=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function tokenize$2(e){return REGEX$3.exec(e)||["","","",""]}var ROMANS="I II III IV V VI VII",NAMES$1=ROMANS.split(" "),NAMES_MINOR=ROMANS.toLowerCase().split(" ");function parse$3(e){const[t,o,u,f]=tokenize$2(e);if(!u)return NoRomanNumeral;const p=u.toUpperCase(),g=NAMES$1.indexOf(p),M=accToAlt$1(o),F=1;return{empty:!1,name:t,roman:u,interval:interval$2({step:g,alt:M,dir:F}).name,acc:o,chordType:f,alt:M,step:g,major:u===p,oct:0,dir:F}}var roman_numeral_default={names:names$3,get:get$4,romanNumeral},Empty=Object.freeze([]),NoKey={type:"major",tonic:"",alteration:0,keySignature:""},NoKeyScale={tonic:"",grades:Empty,intervals:Empty,scale:Empty,triads:Empty,chords:Empty,chordsHarmonicFunction:Empty,chordScales:Empty,secondaryDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty,substituteDominants:Empty,substituteDominantSupertonics:Empty,secondaryDominantsMinorRelative:Empty},NoMajorKey={...NoKey,...NoKeyScale,type:"major",minorRelative:"",scale:Empty,substituteDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty},NoMinorKey={...NoKey,type:"minor",relativeMajor:"",natural:NoKeyScale,harmonic:NoKeyScale,melodic:NoKeyScale},mapScaleToType=(e,t,o="")=>t.map((u,f)=>`${e[f]}${o}${u}`);function keyScale(e,t,o,u,f){return p=>{const g=e.map(R=>get$4(R).interval||""),M=g.map(R=>transpose$1(p,R)),F=mapScaleToType(M,o),S=M.map(R=>transpose$1(R,"5P")).map(R=>M.includes(R)&&!F.includes(R+"7")?R+"7":""),k=supertonics(S,t),N=S.map(R=>{if(!R)return"";const U=R.slice(0,-1);return transpose$1(U,"5d")+"7"}),$=supertonics(N,t);return{tonic:p,grades:e,intervals:g,scale:M,triads:mapScaleToType(M,t),chords:F,chordsHarmonicFunction:u.slice(),chordScales:mapScaleToType(M,f," "),secondaryDominants:S,secondaryDominantSupertonics:k,substituteDominants:N,substituteDominantSupertonics:$,secondaryDominantsMinorRelative:k,substituteDominantsMinorRelative:$}}}var supertonics=(e,t)=>e.map((o,u)=>{if(!o)return"";const f=o.slice(0,-1),p=transpose$1(f,"5P");return t[u].endsWith("m")?p+"m7":p+"m7b5"}),distInFifths=(e,t)=>{const o=note$1(e),u=note$1(t);return o.empty||u.empty?0:u.coord[0]-o.coord[0]},MajorScale=keyScale("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),NaturalScale=keyScale("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),HarmonicScale=keyScale("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),MelodicScale=keyScale("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function majorKey(e){const t=note$1(e).pc;if(!t)return NoMajorKey;const o=MajorScale(t),u=distInFifths("C",t);return{...o,type:"major",minorRelative:transpose$1(t,"-3m"),alteration:u,keySignature:altToAcc$1(u)}}function minorKey(e){const t=note$1(e).pc;if(!t)return NoMinorKey;const o=distInFifths("C",t)-3;return{type:"minor",tonic:t,relativeMajor:transpose$1(t,"3m"),alteration:o,keySignature:altToAcc$1(o),natural:NaturalScale(t),harmonic:HarmonicScale(t),melodic:MelodicScale(t)}}function majorTonicFromKeySignature(e){return typeof e=="number"?transposeFifths$1("C",e):typeof e=="string"&&/^b+|#+$/.test(e)?transposeFifths$1("C",accToAlt$1(e)):null}var index_default$2={majorKey,majorTonicFromKeySignature,minorKey};function isNamedPitch$1(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch$1(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS$1=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$1=FIFTHS$1.map(e=>Math.floor(e*7/12));function coordinates$1(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS$1[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS$1[t]-4*o;return[f*p,f*g]}var FIFTHS_TO_STEPS=[3,0,4,1,5,2,6];function pitch(e){const[t,o,u]=e,f=FIFTHS_TO_STEPS[unaltered(t)],p=Math.floor((t+1)/7);if(o===void 0)return{step:f,alt:p,dir:u};const g=o+4*p+STEPS_TO_OCTS$1[f];return{step:f,alt:p,oct:g,dir:u}}function unaltered(e){const t=(e+1)%7;return t<0?7+t:t}var fillStr$1=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval$1=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$1="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$1="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$2=new RegExp("^"+INTERVAL_TONAL_REGEX$1+"|"+INTERVAL_SHORTHAND_REGEX$1+"$");function tokenizeInterval$1(e){const t=REGEX$2.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache$1={};function interval$1(e){return typeof e=="string"?cache$1[e]||(cache$1[e]=parse$2(e)):isPitch$1(e)?interval$1(pitchName$1(e)):isNamedPitch$1(e)?interval$1(e.name):NoInterval$1}var SIZES$1=[0,2,4,5,7,9,11],TYPES$1="PMMPPMM";function parse$2(e){const t=tokenizeInterval$1(e);if(t[0]==="")return NoInterval$1;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES$1[f];if(p==="M"&&u==="P")return NoInterval$1;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt$1(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES$1[f]+k+12*N),R=(F*(SIZES$1[f]+k)%12+12)%12,U=coordinates$1({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function coordToInterval(e,t){const[o,u=0]=e,p=o*7+u*12<0?[-o,-u,-1]:[o,u,1];return interval$1(pitch(p))}function qToAlt$1(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName$1(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES$1[t]==="M"?"majorable":"perfectable";return M+g+altToQ$1(F,o)}function altToQ$1(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr$1("A",t):fillStr$1("d",e==="perfectable"?t:t+1)}var get$3=interval$1;function simplify(e){const t=interval$1(e);return t.empty?"":t.simple+t.q}function transposeFifths(e,t){const o=get$3(e);if(o.empty)return"";const[u,f,p]=o.coord;return coordToInterval([u+t,f,p]).name}var MODES=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],NoMode={...EmptyPcset,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},modes=MODES.map(toMode),index$2={};modes.forEach(e=>{index$2[e.name]=e,e.aliases.forEach(t=>{index$2[t]=e})});function get$2(e){return typeof e=="string"?index$2[e.toLowerCase()]||NoMode:e&&e.name?get$2(e.name):NoMode}var mode=get$2;function all$1(){return modes.slice()}var entries=all$1;function names$2(){return modes.map(e=>e.name)}function toMode(e){const[t,o,u,f,p,g,M]=e,F=M?[M]:[],S=Number(o).toString(2);return{empty:!1,intervals:get$9(f).intervals,modeNum:t,chroma:S,normalized:S,name:f,setNum:o,alt:u,triad:p,seventh:g,aliases:F}}function notes(e,t){return get$2(e).intervals.map(o=>transpose$5(t,o))}function chords(e){return(t,o)=>{const u=get$2(t);if(u.empty)return[];const f=rotate(u.modeNum,e),p=u.intervals.map(g=>transpose$5(o,g));return f.map((g,M)=>p[M]+g)}}var triads$1=chords(MODES.map(e=>e[4])),seventhChords=chords(MODES.map(e=>e[5]));function distance(e,t){const o=get$2(t),u=get$2(e);return o.empty||u.empty?"":simplify(transposeFifths("1P",u.alt-o.alt))}function relativeTonic(e,t,o){return transpose$5(o,distance(e,t))}var mode_default={get:get$2,names:names$2,all:all$1,distance,relativeTonic,notes,triads:triads$1,seventhChords,entries,mode},CHORDS$1=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$1=CHORDS$1;({...EmptyPcset});var dictionary$1=[],index$1={};function add$1(e,t,o){const u=getQuality$1(e),f={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary$1.push(f),f.name&&(index$1[f.name]=f),index$1[f.setNum]=f,index$1[f.chroma]=f,f.aliases.forEach(p=>addAlias$1(f,p))}function addAlias$1(e,t){index$1[t]=e}function getQuality$1(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default$1.forEach(([e,t,o])=>add$1(e.split(" "),o.split(" "),t)),dictionary$1.sort((e,t)=>e.setNum-t.setNum);function isNamedPitch(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function isPitch(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var FIFTHS=[0,2,4,-1,1,3,5],STEPS_TO_OCTS=FIFTHS.map(e=>Math.floor(e*7/12));function coordinates(e){const{step:t,alt:o,oct:u,dir:f=1}=e,p=FIFTHS[t]+7*o;if(u===void 0)return[f*p];const g=u-STEPS_TO_OCTS[t]-4*o;return[f*p,f*g]}var fillStr=(e,t)=>Array(Math.abs(t)+1).join(e),NoInterval=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$1=new RegExp("^"+INTERVAL_TONAL_REGEX+"|"+INTERVAL_SHORTHAND_REGEX+"$");function tokenizeInterval(e){const t=REGEX$1.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var cache={};function interval(e){return typeof e=="string"?cache[e]||(cache[e]=parse$1(e)):isPitch(e)?interval(pitchName(e)):isNamedPitch(e)?interval(e.name):NoInterval}var SIZES=[0,2,4,5,7,9,11],TYPES="PMMPPMM";function parse$1(e){const t=tokenizeInterval(e);if(t[0]==="")return NoInterval;const o=+t[0],u=t[1],f=(Math.abs(o)-1)%7,p=TYPES[f];if(p==="M"&&u==="P")return NoInterval;const g=p==="M"?"majorable":"perfectable",M=""+o+u,F=o<0?-1:1,S=o===8||o===-8?o:F*(f+1),k=qToAlt(g,u),N=Math.floor((Math.abs(o)-1)/7),$=F*(SIZES[f]+k+12*N),R=(F*(SIZES[f]+k)%12+12)%12,U=coordinates({step:f,alt:k,oct:N,dir:F});return{empty:!1,name:M,num:o,q:u,step:f,alt:k,dir:F,type:g,simple:S,semitones:$,chroma:R,coord:U,oct:N}}function qToAlt(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function pitchName(e){const{step:t,alt:o,oct:u=0,dir:f}=e;if(!f)return"";const p=t+1+7*u,g=p===0?t+1:p,M=f<0?"-":"",F=TYPES[t]==="M"?"majorable":"perfectable";return M+g+altToQ(F,o)}function altToQ(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?fillStr("A",t):fillStr("d",e==="perfectable"?t:t+1)}function tokenize$1(e){const[t,o,u,f]=tokenizeNote$1(e);return t===""?tokenizeBass("",e):t==="A"&&f==="ug"?tokenizeBass("","aug"):tokenizeBass(t+o,u+f)}function tokenizeBass(e,t){const o=t.split("/");if(o.length===1)return[e,o[0],""];const[u,f,p,g]=tokenizeNote$1(o[1]);return u!==""&&p===""&&g===""?[e,o[0],u+f]:[e,t,""]}function fromRomanNumerals(e,t){return t.map(get$4).map(u=>transpose$5(e,interval(u))+u.chordType)}function toRomanNumerals(e,t){return t.map(o=>{const[u,f]=tokenize$1(o),p=distance$5(e,u);return get$4(interval(p)).name+f})}var progression_default={fromRomanNumerals,toRomanNumerals};function numeric(e){const t=compact(e.map(o=>typeof o=="number"?o:toMidi(o)));return!e.length||t.length!==e.length?[]:t.reduce((o,u)=>{const f=o[o.length-1];return o.concat(range(f,u).slice(1))},[t[0]])}function chromatic(e,t){return numeric(e).map(o=>midiToNoteName(o,t))}var index_default$1={numeric,chromatic},CHORDS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default=CHORDS;({...EmptyPcset});var dictionary=[],index={};function all(){return dictionary.slice()}function add(e,t,o){const u=getQuality(e),f={...get$b(e),name:o||"",quality:u,intervals:e,aliases:t};dictionary.push(f),f.name&&(index[f.name]=f),index[f.setNum]=f,index[f.chroma]=f,f.aliases.forEach(p=>addAlias(f,p))}function addAlias(e,t){index[t]=e}function getQuality(e){const t=o=>e.indexOf(o)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}data_default.forEach(([e,t,o])=>add(e.split(" "),o.split(" "),t)),dictionary.sort((e,t)=>e.setNum-t.setNum);var NoScale={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),o=note$1(e.substring(0,t));if(o.empty){const f=note$1(e);return f.empty?["",e.toLowerCase()]:[f.name,""]}const u=e.substring(o.name.length+1).toLowerCase();return[o.name,u.length?u:""]}var names$1=names$7;function get$1(e){const t=Array.isArray(e)?e:tokenize(e),o=note$1(t[0]).name,u=get$9(t[1]);if(u.empty)return NoScale;const f=u.name,p=o?u.intervals.map(M=>transpose$5(o,M)):[],g=o?o+" "+f:f;return{...u,name:g,type:f,tonic:o,notes:p}}var scale$1=get$1;function detect(e,t={}){const o=chroma$3(e),u=note$1(t.tonic??e[0]??""),f=u.chroma;if(f===void 0)return[];const p=o.split("");p[f]="1";const g=rotate(f,p).join(""),M=all$2().find(S=>S.chroma===g),F=[];return M&&F.push(u.name+" "+M.name),t.match==="exact"||extended(g).forEach(S=>{F.push(u.name+" "+S)}),F}function scaleChords(e){const t=get$1(e),o=isSubsetOf(t.chroma);return all().filter(u=>o(u.chroma)).map(u=>u.aliases[0])}function extended(e){const t=isChroma(e)?e:get$1(e).chroma,o=isSupersetOf(t);return all$2().filter(u=>o(u.chroma)).map(u=>u.name)}function reduced(e){const t=isSubsetOf(get$1(e).chroma);return all$2().filter(o=>t(o.chroma)).map(o=>o.name)}function scaleNotes(e){const t=e.map(f=>note$1(f).pc).filter(f=>f),o=t[0],u=sortedUniqNames(t);return rotate(u.indexOf(o),u)}function modeNames(e){const t=get$1(e);if(t.empty)return[];const o=t.tonic?t.notes:t.intervals;return modes$1(t.chroma).map((u,f)=>{const p=get$1(u).name;return p?[o[f],p]:["",""]}).filter(u=>u[0])}function getNoteNameOf(e){const t=Array.isArray(e)?scaleNotes(e):get$1(e).notes,o=t.map(u=>note$1(u).chroma);return u=>{const f=note$1(typeof u=="number"?fromMidi(u):u),p=f.height;if(p===void 0)return;const g=p%12,M=o.indexOf(g);if(M!==-1)return enharmonic(f.name,t[M])}}function rangeOf(e){const t=getNoteNameOf(e);return(o,u)=>{const f=note$1(o).height,p=note$1(u).height;return f===void 0||p===void 0?[]:range(f,p).map(t).filter(g=>g)}}function degrees(e){const{intervals:t,tonic:o}=get$1(e),u=tonicIntervalsTransposer$1(t,o);return f=>f?u(f>0?f-1:f):""}function steps(e){const{intervals:t,tonic:o}=get$1(e);return tonicIntervalsTransposer$1(t,o)}var index_default={degrees,detect,extended,get:get$1,modeNames,names:names$1,rangeOf,reduced,scaleChords,scaleNotes,steps,tokenize,scale:scale$1},NONE={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},NAMES=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function names(){return NAMES.slice()}var REGEX=/^(\d*\d(?:\+\d)*)\/(\d+)$/,CACHE=new Map;function get(e){const t=JSON.stringify(e),o=CACHE.get(t);if(o)return o;const u=build(parse(e));return CACHE.set(t,u),u}function parse(e){if(typeof e=="string"){const[p,g,M]=REGEX.exec(e)||[];return parse([g,M])}const[t,o]=e,u=+o;if(typeof t=="number")return[t,u];const f=t.split("+").map(p=>+p);return f.length===1?[f[0],u]:[f,u]}var time_signature_default={names,parse,get},isPowerOfTwo=e=>Math.log(e)/Math.log(2)%1===0;function build([e,t]){const o=Array.isArray(e)?e.reduce((M,F)=>M+F,0):e,u=t;if(o===0||u===0)return NONE;const f=Array.isArray(e)?`${e.join("+")}/${t}`:`${e}/${t}`,p=Array.isArray(e)?e:[],g=u===4||u===2?"simple":u===8&&o%3===0?"compound":isPowerOfTwo(u)?"irregular":"irrational";return{empty:!1,name:f,type:g,upper:o,lower:u,additive:p}}var Tonal=Core,PcSet=pcset_default,ChordDictionary=chord_type_default,ScaleDictionary=scale_type_default;const dist$1=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:abc_notation_default,Array:index$6,Chord:chord_default,ChordDictionary,ChordType:chord_type_default,Collection:collection_default,Core,DurationValue:duration_value_default,Interval:interval_default,Key:index_default$2,Midi:index_default$4,Mode:mode_default,Note:index_default$3,PcSet,Pcset:pcset_default,Progression:progression_default,Range:index_default$1,RomanNumeral:roman_numeral_default,Scale:index_default,ScaleDictionary,ScaleType:scale_type_default,TimeSignature:time_signature_default,Tonal,accToAlt,altToAcc,chroma:chroma$2,coordToInterval:coordToInterval$1,coordToNote,coordinates:coordinates$3,deprecate,distance:distance$3,fillStr:fillStr$3,height,interval:interval$3,isNamed,isNamedPitch:isNamedPitch$3,isPitch:isPitch$3,midi:midi$1,note,pitch:pitch$1,stepToLetter,tokenizeInterval:tokenizeInterval$3,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"})),flats=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],pcs=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],sharps=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],accs={b:-1,"#":1},pc2chroma=e=>{const[t,...o]=e.split("");return pcs.indexOf(t.toLowerCase())+o.reduce((u,f)=>u+accs[f],0)};function tokenizeChord$1(e){const t=(e||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}const midi2chroma=e=>e%12,step2semitones=e=>{let t=Number(e);return isNaN(t)?interval_default.semitones(e):t},x2midi=(e,t)=>{if(typeof e=="number")return e;if(typeof e=="string")return noteToMidi$1(e,t)},midi2note=(e,t=!1)=>{const o=Math.floor(e/12)-1;return(t?sharps:flats)[e%12]+o};function scaleStep$1(e,t,o=1){e=e.map(f=>typeof f=="string"?noteToMidi$1(f):f);const u=Math.floor(t/e.length)*o*12;return t=_mod$2(t,e.length),e[t]+u}function nearestNumberIndex(e,t,o){let u=0,f=1/0;return t.forEach((p,g)=>{const M=Math.abs(p-e);(!o&&M<f||o&&M<=f)&&(u=g,f=M)}),u}let scaleSteps={};function stepInNamedScale(e,t,o,u){const[f,p]=index_default.tokenize(t),g=x2midi(f),M=midi2chroma(g);if(!scaleSteps[p]){const{intervals:$}=index_default.get(`C ${p}`);scaleSteps[p]=$.map(step2semitones)}const F=scaleSteps[p];if(!F)return null;let S=g;if(o){o=x2midi(o,3);const $=midi2chroma(o),R=_mod$2($-M,12),U=nearestNumberIndex(R,F,u);e=e+U,S=o-R}const k=Math.floor(e/F.length)*12;return e=_mod$2(e,F.length),F[e]+S+k}let modeTarget={below:e=>e.slice(-1)[0],duck:e=>e.slice(-1)[0],above:e=>e[0],root:e=>e[0]};function renderVoicing({chord:e,dictionary:t,offset:o=0,n:u,mode:f="below",anchor:p="c5",octaves:g=1}){const[M,F]=tokenizeChord$1(e),S=pc2chroma(M);p=x2midi(p?.note||p,4);const k=midi2chroma(p),N=t[F].map(ue=>(typeof ue=="string"?ue.split(" "):ue).map(step2semitones));let $,R,U=N.map((ue,ve)=>{const Ae=modeTarget[f](ue),Fe=_mod$2(k-Ae-S,12);return($===void 0||Fe<$)&&($=Fe,R=ve),Fe});f==="root"&&(R=0);const O=Math.ceil(o/N.length)*12,Z=_mod$2(R+o,N.length),K=N[Z],ie=modeTarget[f](K),de=p-U[Z]+O,te=K.map(ue=>de-ie+ue);let re=te.map(ue=>midi2note(ue));return f==="duck"&&(re=re.filter((ue,ve)=>te[ve]!==p)),u!==void 0?[scaleStep$1(re,u,g)]:re}const octavesInterval=e=>(e<=0?-1:1)+e*7+"P";function getScale(e){e=e.replaceAll(":"," ");const t=index_default.get(e),{tonic:o,empty:u}=t;if(u&&isNote(e)||u&&!o)throw new Error(`Scale name ${e} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(u)throw new Error(`Invalid scale name "${e}"`);return t}function scaleStep(e,t){e=Math.ceil(e);let{intervals:o,tonic:u}=getScale(t);u=u||"C";const{pc:f,oct:p=3}=index_default$3.get(u),g=Math.floor(e/o.length),M=_mod$2(e,o.length),F=interval_default.add(o[M],octavesInterval(g));return index_default$3.transpose(f+p,F)}function scaleOffset(e,t,o){let{notes:u}=getScale(e);if(u=u.map(N=>index_default$3.get(N).pc),t=Number(t),isNaN(t))throw new Error(`scale offset "${t}" not a number`);const{pc:f,oct:p=3}=index_default$3.get(o),g=u.indexOf(f);if(g===-1)throw new Error(`note "${o}" is not in scale "${e}"`);let M=g,F=p,S=f;const k=Math.sign(t);for(;Math.abs(M-g)<Math.abs(t);){M+=k;const N=_mod$2(M,u.length);k<0&&S[0]==="C"&&(F+=k),S=u[N],k>0&&S[0]==="C"&&(F+=k)}return S+F}const{transpose,trans}=register(["transpose","trans"],function e(t,o){return o.withHap(u=>{const f=u.value.note??u.value;if(typeof f=="number"){let M;typeof t=="number"?M=t:typeof t=="string"&&(M=interval_default.semitones(t)||0);const F=f+M;return typeof u.value=="object"?u.withValue(()=>({...u.value,note:F})):u.withValue(()=>F)}if(typeof f!="string"||!isNote(f))return logger$2(`[tonal] transpose: not a note "${f}"`,"warning"),u;const p=isNaN(Number(t))?String(t):interval_default.fromSemitones(t),g=index_default$3.transpose(f,p);return typeof u.value=="object"?u.withValue(()=>({...u.value,note:g})):u.withValue(()=>g)})}),{scaleTranspose,scaleTrans,strans}=register(["scaleTranspose","scaleTrans","strans"],function(e,t){return t.withHap(o=>{if(!o.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof o.value=="object")return o.withValue(()=>({...o.value,note:scaleOffset(o.context.scale,Number(e),o.value.note)}));if(typeof o.value!="string")throw new Error("can only use scaleTranspose with notes");return o.withValue(()=>scaleOffset(o.context.scale,Number(e),o.value))})});function _convertStepToNumberAndOffset(e){let t=Number(e),o=0;if(isNaN(t)){e=String(e);const u=/^(-?\d+)([#bsf]*)$/.exec(e);if(!u)throw new Error(`invalid scale step "${e}", expected number or integer with optional # b suffixes`);t=Number(u[1]);const f=u[2]||"";o=getAccidentalsOffset$1(f)}return[t,o]}let scaleToMidisAndNotes={};function _getNearestScaleNote(e,t,o=!0){let u=typeof t=="string"?noteToMidi$1(t):t;if(scaleToMidisAndNotes[e]===void 0){const{intervals:N,tonic:$}=getScale(e),{pc:R}=index_default$3.get($),O=N.concat("8P").map(K=>index_default$3.transpose(R+"0",K)),Z=O.map(noteToMidi$1);scaleToMidisAndNotes[e]=[Z,O]}const[f,p]=scaleToMidisAndNotes[e],g=f[0],M=Math.floor((u-g)/12),F=f.map(N=>N+12*M),S=nearestNumberIndex(u,F,o),k=p[S];return index_default$3.transpose(k,interval_default.fromSemitones(12*M))}const scale=register("scale",function(e,t){return Array.isArray(e)&&(e=e.flat().join(" ")),t.withHaps(o=>(o=o.map(u=>{let f=u.value;const p=typeof f=="object";f=p?f:{n:f};const{note:g,n:M,value:F,...S}=f,k=g??M??F;if(k===void 0)return logger$2(`[tonal] Invalid value format for 'scale'. Value must contain n, note, or value but received keys [${Object.keys(f).join(", ")}]`,"error"),u;let N;if(isNote(k))N=_getNearestScaleNote(e,k),u.value={...S,note:N};else try{const[$,R]=_convertStepToNumberAndOffset(k);S.anchor?N=stepInNamedScale($,e,S.anchor):N=scaleStep($,e),R!=0&&(N=index_default$3.transpose(N,interval_default.fromSemitones(R)))}catch($){errorLogger$1($,"tonal");return}return u.value=p?{...S,note:N}:N,u.setContext({...u.context,scale:e})}),removeUndefineds(o)))},!0,!0);var dist={},dictionaryVoicing$1={},getBestVoicing={},hasRequiredGetBestVoicing;function requireGetBestVoicing(){if(hasRequiredGetBestVoicing)return getBestVoicing;hasRequiredGetBestVoicing=1,getBestVoicing.__esModule=!0,getBestVoicing.getBestVoicing=void 0;function e(t){var o=t.chord,u=t.range,f=t.finder,p=t.picker,g=t.lastVoicing,M=f(o,u);return M.length?p(M,g):[]}return getBestVoicing.getBestVoicing=e,getBestVoicing}var voicingsInRange={};const require$$0=getAugmentedNamespace(dist$1);var tokenizeChord={},hasRequiredTokenizeChord;function requireTokenizeChord(){if(hasRequiredTokenizeChord)return tokenizeChord;hasRequiredTokenizeChord=1,tokenizeChord.__esModule=!0,tokenizeChord.tokenizeChord=void 0;function e(t){var o=(t||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return o?o.slice(1):[]}return tokenizeChord.tokenizeChord=e,tokenizeChord}var hasRequiredVoicingsInRange;function requireVoicingsInRange(){if(hasRequiredVoicingsInRange)return voicingsInRange;hasRequiredVoicingsInRange=1,voicingsInRange.__esModule=!0,voicingsInRange.voicingsInRange=void 0;var e=require$$0,t=requireDictionaryVoicing(),o=requireTokenizeChord();function u(f,p,g){p===void 0&&(p=t.lefthand),g===void 0&&(g=["D3","A4"]);var M=(0,o.tokenizeChord)(f),F=M[0],S=M[1];if(!p[S])return[];var k=p[S].map(function($){return $.split(" ")}),N=e.Range.chromatic(g);return k.reduce(function($,R){var U=R.map(function(ie){return e.Interval.substract(ie,R[0])}),O=e.Note.transpose(F,R[0]),Z=N.filter(function(ie){return e.Note.chroma(ie)===e.Note.chroma(O)}).filter(function(ie){return e.Note.midi(e.Note.transpose(ie,U[U.length-1]))<=e.Note.midi(g[1])}).map(function(ie){return e.Note.enharmonic(ie,O)}),K=Z.map(function(ie){return U.map(function(de){return e.Note.transpose(ie,de)})});return $.concat(K)},[])}return voicingsInRange.voicingsInRange=u,voicingsInRange}var hasRequiredDictionaryVoicing;function requireDictionaryVoicing(){return hasRequiredDictionaryVoicing||(hasRequiredDictionaryVoicing=1,(function(e){var t=dictionaryVoicing$1&&dictionaryVoicing$1.__assign||function(){return t=Object.assign||function(M){for(var F,S=1,k=arguments.length;S<k;S++){F=arguments[S];for(var N in F)Object.prototype.hasOwnProperty.call(F,N)&&(M[N]=F[N])}return M},t.apply(this,arguments)},o=dictionaryVoicing$1&&dictionaryVoicing$1.__rest||function(M,F){var S={};for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&F.indexOf(k)<0&&(S[k]=M[k]);if(M!=null&&typeof Object.getOwnPropertySymbols=="function")for(var N=0,k=Object.getOwnPropertySymbols(M);N<k.length;N++)F.indexOf(k[N])<0&&Object.prototype.propertyIsEnumerable.call(M,k[N])&&(S[k[N]]=M[k[N]]);return S};e.__esModule=!0,e.dictionaryVoicing=e.dictionaryVoicingFinder=e.triads=e.guidetones=e.lefthand=void 0;var u=requireGetBestVoicing(),f=requireVoicingsInRange();e.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},e.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},e.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var p=function(M){return function(F,S){return(0,f.voicingsInRange)(F,M,S)}};e.dictionaryVoicingFinder=p;var g=function(M){var F=M.dictionary,S=M.range,k=o(M,["dictionary","range"]);return(0,u.getBestVoicing)(t(t({},k),{range:S,finder:(0,e.dictionaryVoicingFinder)(F)}))};e.dictionaryVoicing=g})(dictionaryVoicing$1)),dictionaryVoicing$1}var minTopNoteDiff$1={},hasRequiredMinTopNoteDiff;function requireMinTopNoteDiff(){if(hasRequiredMinTopNoteDiff)return minTopNoteDiff$1;hasRequiredMinTopNoteDiff=1,minTopNoteDiff$1.__esModule=!0,minTopNoteDiff$1.minTopNoteDiff=void 0;var e=require$$0;function t(o,u){if(!u)return o[0];var f=function(p){return Math.abs(e.Note.midi(u[u.length-1])-e.Note.midi(p[p.length-1]))};return o.reduce(function(p,g){return f(g)<f(p)?g:p},o[0])}return minTopNoteDiff$1.minTopNoteDiff=t,minTopNoteDiff$1}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(e){e.__esModule=!0;var t=requireDictionaryVoicing(),o=requireMinTopNoteDiff(),u=requireGetBestVoicing(),f=requireTokenizeChord();e.default={tokenizeChord:f.tokenizeChord,getBestVoicing:u.getBestVoicing,dictionaryVoicing:t.dictionaryVoicing,dictionaryVoicingFinder:t.dictionaryVoicingFinder,lefthand:t.lefthand,guidetones:t.guidetones,triads:t.triads,minTopNoteDiff:o.minTopNoteDiff}})(dist)),dist}var distExports=requireDist();const _voicings=getDefaultExportFromCjs(distExports),simple={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},complex={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing,minTopNoteDiff}=_voicings.default||_voicings,lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},triads={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},defaultDictionary={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},voicingRegistry={lefthand:{dictionary:lefthand,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:triads,mode:"below",anchor:"a4"},guidetones:{dictionary:guidetones,mode:"above",anchor:"a4"},legacy:{dictionary:defaultDictionary,mode:"below",anchor:"a4"}};let defaultDict="ireal";const setDefaultVoicings=e=>defaultDict=e,setVoicingRange=(e,t)=>addVoicings(e,voicingRegistry[e].dictionary,t),addVoicings=(e,t,o=["F3","A4"])=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,range:o}})},registerVoicings=(e,t,o={})=>{Object.assign(voicingRegistry,{[e]:{dictionary:t,...o}})},getVoicing=(e,t,o)=>{const{dictionary:u,range:f}=voicingRegistry[t];return dictionaryVoicing({chord:e,dictionary:u,range:f,picker:minTopNoteDiff,lastVoicing:o})};let lastVoicing;const voicings=register("voicings",function(e,t){return t.fmap(o=>(lastVoicing=getVoicing(o,e,lastVoicing),stack(...lastVoicing))).outerJoin()}),rootNotes=register("rootNotes",function(e,t){return t.fmap(o=>{const p=(o.chord||o).match(/^([a-gA-G][b#]?).*$/)[1]+e;return o.chord?{note:p}:p})}),voicing=register("voicing",function(e){return e.fmap(t=>{t=typeof t=="string"?{chord:t}:t;let{dictionary:o=defaultDict,chord:u,anchor:f,offset:p,mode:g,n:M,octaves:F,...S}=t;o=typeof o=="string"?voicingRegistry[o]:{dictionary:o,mode:"below",anchor:"c5"};try{let k=renderVoicing({...o,chord:u,anchor:f,offset:p,mode:g,n:M,octaves:F});return stack(...k).note().set(S)}catch{return logger$2(`[voicing]: unknown chord "${u}"`),silence}}).outerJoin()});function voicingAlias(e,t,o){o=Array.isArray(o)?o:[o],o.forEach(u=>{u[t]=u[e]})}voicingAlias("^","",[simple,complex]),Object.keys(simple).forEach(e=>{if(e.includes("-")){let t=e.replace("-","m");voicingAlias(e,t,[complex,simple])}if(e.includes("^")){let t=e.replace("^","M");voicingAlias(e,t,[complex,simple])}if(e.includes("+")){let t=e.replace("+","aug");voicingAlias(e,t,[complex,simple])}}),registerVoicings("ireal",simple),registerVoicings("ireal-ext",complex);function resetVoicings(){lastVoicing=void 0,setDefaultVoicings("ireal")}const packageName="@strudel/tonal",strudelTonal=Object.freeze(Object.defineProperty({__proto__:null,addVoicings,complex,packageName,registerVoicings,resetVoicings,rootNotes,scale,scaleTrans,scaleTranspose,setDefaultVoicings,setVoicingRange,simple,strans,trans,transpose,voicing,voicingAlias,voicingRegistry,voicings},Symbol.toStringTag,{value:"Module"})),{evalScope}=strudelCore;App.scope_container_el=void 0,App.scope_canvas_el=void 0,App.scope_canvas_ctx=void 0,App.scope_analyser=void 0,App.scope_waveform=void 0,App.scope_animation_id=void 0,App.scope_connected=!1,App.scope_pixel_ratio=1,App.scope_enabled=!0,App.scope_max_y=-1,App.scope_min_y=-1,App.scope_background="#111111da",App.scope_color="rgba(204, 198, 239, 1)",App.scope_click_color_1="rgba(162, 171, 234, 0.5)",App.scope_click_color_2="rgba(255, 137, 204, 1)",App.scope_click_color_3="rgba(222, 242, 92, 1)",App.scope_click_color_4="rgba(91, 163, 240, 1)",App.scope_click_color_5="rgba(255, 255, 255, 1)",App.scope_click_level=1,App.scope_sine_time=0,App.scope_clicks=[],App.scope_click_time=3*1e3,App.scope_click_size=18,App.scope_is_drawing=!1,App.scope_click_distance=120,App.scope_mousedown_date=0,App.scope_beep_delay=300,App.scope_slide_delay=800,App.scope_slide_distance=200,App.scope_panning_zone=100,App.scope_padding_amount=.9,App.scope_enable_date=0,App.scope_click_lock=250,App.scope_debouncer_delay=50,App.max_scope_slide_y_dff=45,App.scope_click_level_time=2.8*1e3,App.many_clicks_amount=100,App.scope_gestures_enabled=!1,App.scope_clicks_min=5,App.setup_scope=()=>{App.scope_debouncer=App.create_debouncer(()=>{App.resize_scope_canvas()},App.scope_debouncer_delay),App.stor_load_scope(),App.init_scope_checkbox(),App.setup_scope_canvas(),App.start_scope_visualizer(),App.scope_enabled?App.enable_scope_visualizer():App.disable_scope_visualizer()},App.get_scope_container=()=>(App.scope_container_el||(App.scope_container_el=DOM.el("#scope-container")),App.scope_container_el),App.get_scope_canvas=()=>(App.scope_canvas_el||(App.scope_canvas_el=DOM.el("#scope-canvas")),App.scope_canvas_el),App.get_scope_dimensions=()=>{if(!App.scope_canvas_el)return{width:0,height:0};let e=App.scope_canvas_el.clientWidth,t=App.scope_canvas_el.clientHeight;return e||(e=App.scope_canvas_el.width/App.scope_pixel_ratio),t||(t=App.scope_canvas_el.height/App.scope_pixel_ratio),{width:Math.max(0,e||0),height:Math.max(0,t||0)}},App.setup_scope_canvas=()=>{let e=App.get_scope_canvas();if(e){if(!App.scope_canvas_ctx){let t=e.getContext("2d");if(!t){console.warn("Scope canvas context unavailable");return}App.scope_canvas_ctx=t}return App.resize_scope_canvas(),e}},App.resize_scope_canvas=()=>{if(!App.scope_enabled||!App.scope_canvas_el||!App.scope_canvas_ctx)return;DOM.show("#scope-container",2);let e=1;typeof window<"u"&&(e=window.devicePixelRatio||1),App.scope_pixel_ratio=e;let t=App.get_input_wrapper(),o=App.get_scope_container(),u=320;if(t&&o){let F=t.getBoundingClientRect().width,S=window.getComputedStyle(o),k=parseFloat(S.borderLeftWidth)||0,N=parseFloat(S.borderRightWidth)||0;u=F-k-N}else u=App.scope_canvas_el.clientWidth||App.scope_canvas_el.width/e;let f=App.scope_canvas_el.clientHeight||App.scope_canvas_el.height/e||80;App.scope_canvas_el.style.width=`${u}px`,App.scope_canvas_el.style.height=`${f}px`;let p=Math.round(u*e),g=Math.round(f*e);(App.scope_canvas_el.width!==p||App.scope_canvas_el.height!==g)&&(App.scope_canvas_el.width=p,App.scope_canvas_el.height=g),App.scope_canvas_ctx.setTransform(1,0,0,1,0,0),App.scope_canvas_ctx.scale(e,e),App.clear_scope_canvas()},App.clear_scope_canvas=()=>{if(!App.scope_canvas_ctx)return;let{width:e,height:t}=App.get_scope_dimensions();!e||!t||(App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(0,0,e,t))},App.ensure_scope_waveform=()=>{if(App.scope_analyser)return(!App.scope_waveform||App.scope_waveform.length!==App.scope_analyser.fftSize)&&(App.scope_waveform=new Uint8Array(App.scope_analyser.fftSize)),App.scope_waveform},App.ensure_scope_analyser=()=>{if(App.scope_analyser)return App.scope_analyser;try{let t=getAudioContext().createAnalyser();t.fftSize=2048,t.minDecibels=-90,t.maxDecibels=-10,t.smoothingTimeConstant=.85,App.scope_analyser=t,App.ensure_scope_waveform()}catch(e){console.error("Failed to create scope analyser",e),App.scope_analyser=void 0,App.scope_waveform=void 0}return App.scope_analyser},App.connect_scope_analyser=()=>{if(App.scope_connected)return!0;let e=App.ensure_scope_analyser();if(!e)return!1;try{let o=getSuperdoughAudioController()?.output?.destinationGain;return o?(o.connect(e),App.scope_connected=!0,!0):(console.warn("Scope destination missing"),!1)}catch(t){return console.warn("Failed to connect scope analyser",t),!1}},App.stop_scope_loop=()=>{App.scope_animation_id&&(cancelAnimationFrame(App.scope_animation_id),App.scope_animation_id=void 0)},App.handle_scope_click=e=>{let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),u=e.clientX-o.left,f=e.clientY-o.top;App.scope_clicks.push({x:u,y:f,timestamp:Date.now()})},App.handle_scope_mouse_down=e=>{App.mouse_down_coords=App.get_scope_coords(e),App.scope_mousedown_date=Date.now(),App.scope_is_drawing=!0,App.scope_clicks.length<=App.scope_clicks_min&&(App.scope_gestures_enabled=!0),App.handle_scope_click(e)},App.handle_scope_mouse_move=e=>{if(App.scope_is_drawing){let t=App.get_scope_canvas();if(!t)return;let o=t.getBoundingClientRect(),u=e.clientX-o.left,f=e.clientY-o.top;if((App.scope_max_y===-1||f>App.scope_max_y)&&(App.scope_max_y=f),(App.scope_min_y===-1||f<App.scope_min_y)&&(App.scope_min_y=f),App.scope_last_point){let p=App.scope_last_point.x,g=App.scope_last_point.y,M=u-p,F=f-g,S=Math.sqrt(M*M+F*F),k=Math.ceil(S/App.scope_click_distance);for(let N=1;N<=k;N++){let $=p+M*N/k,R=g+F*N/k;App.scope_clicks.push({x:$,y:R,timestamp:Date.now()})}}App.scope_clicks.push({x:u,y:f,timestamp:Date.now()}),App.scope_last_point={x:u,y:f}}},App.handle_scope_mouse_up=e=>{if(App.mouse_up_coords=App.get_scope_coords(e),Date.now()-App.scope_mousedown_date<=App.scope_slide_delay&&App.check_scope_slide()){App.scope_gestures_enabled=!1;return}if(App.scope_gestures_enabled){if(App.triangle_gesture()){App.gesture_function(2,()=>{App.glow_input()});return}else if(App.square_gesture()){App.gesture_function(3,()=>{App.glow_input()});return}else if(App.circle_gesture()){App.gesture_function(4,()=>{App.glow_input()});return}else if(App.scope_clicks.length>=App.many_clicks_amount){App.gesture_function(5,()=>{App.glow_input()});return}}Date.now()-App.scope_mousedown_date<=App.scope_beep_delay&&(App.splash_reverb(2),App.check_scope_panning()||App.beep_sound())},App.increase_scope_click_level=e=>{App.scope_click_level=e,clearTimeout(App.scope_click_level_timeout),App.color_interface(e),App.scope_click_level_timeout=setTimeout(()=>{App.scope_click_level=1,App.restore_interface_colors()},App.scope_click_level_time)},App.draw_star=(e,t,o,u,f,p)=>{let g=Math.PI/2*3,M=Math.PI/f;e.beginPath(),e.moveTo(t,o-p);for(let F=0;F<f;F++){let S=t+Math.cos(g)*p,k=o+Math.sin(g)*p;e.lineTo(S,k),g+=M;let N=t+Math.cos(g)*u,$=o+Math.sin(g)*u;e.lineTo(N,$),g+=M}e.lineTo(t,o-p),e.closePath()},App.draw_scope_frame=()=>{if(!App.scope_enabled){App.stop_scope_loop();return}if(!App.scope_canvas_ctx){App.stop_scope_loop();return}let{width:e,height:t}=App.get_scope_dimensions();if(!e||!t){App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame);return}let o=10;App.scope_canvas_ctx.clearRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(-o,-o,e+o*2,t+o*2),App.scope_canvas_ctx.strokeStyle=App.scope_color,App.scope_canvas_ctx.lineWidth=2,App.scope_canvas_ctx.beginPath();let u=App.scope_analyser,f=App.ensure_scope_waveform();if(App.is_playing&&u&&f){u.getByteTimeDomainData(f);let g=e/f.length,M=0;for(let F=0;F<f.length;F+=1){let k=f[F]/128-1,N=t/2+k*(t/2);F===0?App.scope_canvas_ctx.moveTo(M,N):App.scope_canvas_ctx.lineTo(M,N),M+=g}}else{App.scope_sine_time+=.012;let g=f?f.length:2048,M=e/g,F=0;for(let S=0;S<g;S+=1){let k=S/g*(Math.PI*2)*6,$=Math.sin(k+App.scope_sine_time)*.3,R=t/2+$*(t/2);S===0?App.scope_canvas_ctx.moveTo(F,R):App.scope_canvas_ctx.lineTo(F,R),F+=M}}App.scope_canvas_ctx.stroke();let p=Date.now();App.scope_clicks=App.scope_clicks.filter(g=>p-g.timestamp<App.scope_click_time);for(let g of App.scope_clicks)App.scope_canvas_ctx.fillStyle=App[`scope_click_color_${App.scope_click_level}`],App.draw_star(App.scope_canvas_ctx,g.x,g.y,3,5,App.scope_click_size),App.scope_canvas_ctx.fill();App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame)},App.start_scope_loop=()=>{App.scope_animation_id||(App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame))},App.set_scope_visibility=e=>{let t=App.get_scope_container();t&&(e?DOM.show(t):DOM.hide(t))},App.stop_scope_visualizer=()=>{App.stop_scope_loop(),App.set_scope_visibility(!1),App.clear_scope_canvas()},App.start_scope_visualizer=()=>{App.setup_scope_canvas()&&(App.scope_connected||App.connect_scope_analyser())},App.scope_mouse_enabled=()=>Date.now()-App.scope_enable_date>=App.scope_click_lock,App.init_scope_click_handler=()=>{let e=App.get_scope_canvas();e&&(DOM.ev(e,"mousedown",t=>{App.scope_max_y=-1,App.scope_min_y=-1,App.scope_mouse_enabled()&&App.handle_scope_mouse_down(t)}),DOM.ev(e,"mousemove",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_move(t)}),DOM.ev(e,"click",t=>{App.scope_mouse_enabled()&&App.handle_scope_click(t)}),DOM.ev(document,"mouseup",t=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_up(t),App.scope_is_drawing=!1,App.scope_last_point=null}),DOM.ev(e,"contextmenu",t=>{t.preventDefault()}))},App.toggle_scope=()=>{App.scope_enabled?App.disable_scope_visualizer():App.enable_scope_visualizer()},App.enable_scope_visualizer=()=>{App.scope_enabled=!0,App.set_scope_visibility(!0),App.handle_scope_resize(),App.setup_scope_canvas()&&!App.scope_animation_id&&App.start_scope_loop(),App.scope_enable_date=Date.now(),App.start_scope_visualizer(),App.init_scope_click_handler(),App.stor_save_scope()},App.disable_scope_visualizer=()=>{App.scope_enabled=!1,App.stop_scope_visualizer(),App.stor_save_scope()},App.handle_scope_resize=()=>{App.scope_canvas_el&&(App.scope_debouncer.call(),App.scope_enabled||App.clear_scope_canvas())},App.init_scope_checkbox=()=>{let e=DOM.el("#scope-checkbox");e&&(e.checked=App.scope_enabled,App.scope_enabled?App.enable_scope_visualizer():App.set_scope_visibility(!1),DOM.ev(e,"change",t=>{t.target.checked?App.enable_scope_visualizer():App.disable_scope_visualizer()}))},App.ensure_scope=()=>(App.scope_promise||(App.scope_promise=evalScope(strudelCore,strudelMini,strudelWebAudio,strudelTonal).catch(e=>{throw App.scope_promise=void 0,console.error("Strudel scope failed to load",e),e})),App.scope_promise),App.get_scope_coords=e=>{let t=App.get_scope_canvas();if(t){let o=t.getBoundingClientRect(),u=e.clientX-o.left,f=e.clientY-o.top;return{x:u,y:f}}},App.clear_clicks=()=>{setTimeout(()=>{App.scope_clicks=[]},100)},App.song_cache={},App.fetch_songs_list=async()=>{try{let e=await fetch("/songs/list");if(!e.ok)throw new Error("Failed to fetch songs list");let t=await e.json();return Array.isArray(t)?t:(console.error("Songs list payload was not an array"),[])}catch(e){return console.error("Error fetching songs",e),[]}},App.fetch_song_code=async e=>{try{let t=await fetch(`/songs/${e}.js`);if(!t.ok)throw new Error(`Failed to fetch song ${e}`);let o=await t.text(),u=App.clean_song_name(e),f={};return f.name=e,f.clean_name=u,f.raw=o,f.filtered=App.filter_code(o),App.song_cache[e]=f,App.last_code=o,o}catch(t){throw console.error("Error fetching song content",t),t}},App.create_songs_modal=()=>{let e=App.create_list_modal("songs"),t=DOM.el(".modal-title",e);t.textContent="Select Song"},App.open_songs_modal=async()=>{let e=await App.fetch_songs_list(),t=[];for(let o of e)t.push({text:o,title:"Click to load and play this song"});App.show_items_modal("songs",{items:t,action:o=>{App.load_song(o.text)}})},App.load_song=async e=>{App.close_all_modals();try{App.set_status(`Loading ${e}...`);let t=await App.fetch_song_code(e);App.stop_status_watch(),App.stop_color_cycle(),App.clear_draw_context(),App.code_scroll_active&&App.defer_code_scroll(App.code_scroll_song_pause_ms),await App.play_action(t,!0),App.set_song_context(e)}catch(t){App.set_status(`Failed to load song: ${t.message}`),console.error("Failed to load song:",t)}},App.set_song_context=(e="")=>{App.current_song=e||"",App.set_title(App.underspace(App.current_song)),App.update_url(App.current_song),App.update_title()},App.random_song=async()=>{try{let e=await App.fetch_songs_list();if(!e.length){console.error("No songs available to pick from");return}let t=e.filter(f=>f!==App.current_song);if(!t.length){console.error("No songs available after filtering out the current song");return}let o=App.random_int({min:0,max:t.length-1}),u=t[o];await App.load_song(u)}catch(e){console.error("Error selecting a random song",e)}},App.get_matched_song=()=>{for(let e in App.song_cache){let t=App.song_cache[e];if(t.filtered===App.last_code)return t;if(t.raw===App.last_code)return t}},App.get_song_name=(e=!1)=>{let t=App.get_matched_song(),o="";return t&&(e?o=t.clean_name:o=t.name),o},App.clean_song_name=e=>App.capitalize(App.underspace(e)),App.modal_factory=(e,t)=>{let o=DOM.el(`#${t}`),u=DOM.create("div");u.innerHTML=o.innerHTML,DOM.el("#modals").appendChild(u);let f=DOM.el(".modal",u);return f.id=`${e}-modal`,f},App.create_modal=e=>App.modal_factory(e,"template-modal"),App.create_list_modal=e=>{let t=App.modal_factory(e,"template-list-modal"),o=DOM.el(".modal-filter",t);return o.id=`${e}-modal-filter`,t},App.create_modals=()=>{App.create_about_modal(),App.create_songs_modal(),App.create_auto_modal(),App.create_visual_modal(),App.create_settings_modal(),DOM.ev("#main","click",e=>{let t=e.target.closest(".modal-close");if(t){let o=t.closest(".modal");o&&App.do_close_modal(o)}}),DOM.ev("#modal-overlay","click",e=>{App.close_all_modals()})},App.show_items_modal=async(e,t={})=>{let o={loaded:!1,active:-1,capitalize:!0,icons:!0};App.def_args(o,t);let u=t.loaded||!1,f=DOM.el(`#${e}-modal`),p=DOM.el(".modal-body",f),g=DOM.el(".modal-filter",f);if(u&&(p.innerHTML='<div class="loading">Loading items...</div>'),g&&(g.value="",g.disabled=!0,g.oninput=null,g.onkeydown=null),!t.items.length){p.innerHTML='<div class="loading">Nothing found</div>';return}let M=S=>{if(p.innerHTML="",!S.length){p.innerHTML='<div class="loading">No results</div>';return}for(let[k,N]of S.entries()){let $=DOM.create("div"),R=DOM.create("div");$.className="modal-item";let U=N.alt_text||N.text;if(t.icons){let O=DOM.create("canvas","modal-icon");O.width=25,O.height=25,$.appendChild(O),jdenticon.update(O,U)}t.capitalize&&(U=App.capitalize(U)),R.textContent=App.underspace(U),$.title=N.title,DOM.ev($,"click",()=>t.action(N)),t.active===k&&$.classList.add("modal-active-item"),$.appendChild(R),p.appendChild($)}};if(M(t.items),!g)return;let F=()=>{let S=g.value.trim().toLowerCase();if(!S){M(t.items);return}let k=t.items.filter(N=>(N.alt_text||N.text).toLowerCase().includes(S));M(k)};g.disabled=!1,g.focus(),g.oninput=F,g.onkeydown=S=>{if(S.key!=="Enter")return;S.preventDefault();let k=DOM.els(".modal-item",p);for(let N of k){N.click();break}},App.do_open_modal(f),App.focus_modal_filter(e)},App.open_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_open_modal(t)},App.do_open_modal=e=>{let t=DOM.el(".modal-body",e);App.show_overlay(),e.classList.add("active"),t.scrollTop=0},App.close_modal=e=>{let t=DOM.el(`#${e}-modal`);t&&App.do_close_modal(t)},App.do_close_modal=e=>{e.classList.remove("active"),DOM.els(".modal.active").length===0&&App.hide_overlay()},App.close_all_modals=()=>{let e=DOM.els(".modal");for(let t of e)App.do_close_modal(t)},App.close_current_modal=()=>{let e=DOM.els(".modal.active");if(e.length>0){let t=e[e.length-1];App.do_close_modal(t)}},App.modal_open=()=>DOM.els(".modal.active").length>0,App.show_overlay=()=>{DOM.show("#modal-overlay")},App.hide_overlay=()=>{DOM.hide("#modal-overlay")},App.focus_modal_filter=e=>{let t=DOM.el(`#${e}-modal-filter`);t&&t.focus()},App.create_about_modal=()=>{let e=App.create_modal("about"),t=DOM.el(".modal-header",e),o=DOM.create("img","","modal-about-image");o.src="/img/slide.png",t.prepend(o);let u=DOM.el(".modal-title",e),f=`v${App.config.version}`;u.textContent=`Slide | ${f} | Merkoba | 2025 | ${App.commit_hash}`,u.id="modal-title-about",u.title="Name | Version | Company | Year | Commit Hash";let p=DOM.el(".modal-body",e);p.id="modal-body-about",p.innerHTML=`
    <div class="about-item">Slide is a music player that uses <a target=_blank class="popup" href="https://strudel.cc">strudel</a> code.</div>
    <div class="about-item">It's meant to allow automatic & seamless code updates.</div>
    <div class="about-item">There's a song picker to play elaborate tunes.</div>
    <div class="about-item">The code can be edited in real time and applied with Play.</div>
    <div class="about-item">The scope visualizer can be clicked in the left/center/right.</div>
    <div class="about-item">Clicking the scope produces a tone and a reverb affect.</div>
    <div class="about-item">Clicking the scope on the left produces left panning.</div>
    <div class="about-item">Clicking the scope on the right produces right panning.</div>
    <div class="about-item">A straight line to the left on the scope sets the next visual.</div>
    <div class="about-item">A straight line to the right on the scope opens a random song.</div>
    <div class="about-item">Ctrl+s = Starts playback / Updates code.</div>
    <div class="about-item">Escape = Closes top modal or stops playback.</div>
    <div class="about-item">Ctrl+1 = Show the sound context.</div>
    <div class="about-item">Ctrl+2 = Show the note context.</div>
    <div class="about-item">Ctrl+3 = Show the bank context.</div>
    <div class="about-item">Try drawing a triangle on the scope.</div>
    <div class="about-item">Try drawing a rectangle on the scope.</div>
    <div class="about-item">Try drawing a circle on the scope.</div>
    <hr>
    <div class="about-item">Credit: Gemini</div>
    <div class="about-item">Credit: ChatGPT</div>
    <div class="about-item">Credit: Claude</div>
  `},App.open_about_modal=()=>{App.open_modal("about")},App.auto_delay=5,App.auto_endpoint="/status",App.setup_auto=()=>{let e=DOM.el("#auto-start");e&&DOM.ev(e,"click",()=>{let f=DOM.el("#auto-input");f&&App.start_auto(f.value)});let t=DOM.el("#auto-default");t&&DOM.ev(t,"click",()=>{App.start_auto("/status")});let o=DOM.el("#auto-input");o&&DOM.ev(o,"keydown",f=>{if(f.key==="Enter"){f.preventDefault();let p=DOM.el("#auto-input");p&&App.start_auto(p.value)}});let u=DOM.el("#auto-delay");u&&DOM.ev(u,"change",f=>{App.auto_delay=parseInt(f.target.value,10),App.stor_save_auto_delay(),App.fetch_timer&&App.strudel_watch_status()})},App.create_auto_modal=()=>{let e=App.create_modal("auto"),t=DOM.el(".modal-title",e);t.textContent="Auto Mode";let o=DOM.el(".modal-body",e);o.id="modal-body-auto";let u=DOM.create("div","","auto-info");u.textContent="Code will be fetched periodically";let f=DOM.create("select","modal-select","auto-delay");f.innerHTML=`
    <option value="1">1 second</option>
    <option value="5" selected>5 seconds</option>
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300">5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="900">15 minutes</option>
    <option value="1200">20 minutes</option>
    <option value="1800">30 minutes</option>
    <option value="3600">1 hour</option>
  `;let p=DOM.create("input","","auto-input");p.classList.add("modal-input"),p.placeholder="Endpoint URL";let g=DOM.create("div","modal-buttons","auto-buttons");g.innerHTML=`
    <button id="auto-default">Default</button>
    <button id="auto-start">Start</button>
  `,o.appendChild(u),o.appendChild(f),o.appendChild(p),o.appendChild(g)},App.open_auto_modal=()=>{App.open_modal("auto"),DOM.el("#auto-delay").value=App.auto_delay,DOM.el("#auto-input").value=App.auto_endpoint},App.start_auto=async e=>{if(App.close_modal("auto"),!e||!e.trim()){App.set_status("Invalid endpoint");return}if(App.auto_endpoint=e.trim(),App.stor_save_auto_endpoint(),!await App.ensure_strudel_ready())return;App.strudel_watch_status();let o=App.truncate_path(App.auto_endpoint);App.set_status(`Auto mode running (${o})`)},App.fetch_status_code=async()=>{const e=await fetch(App.auto_endpoint,{cache:"no-store"});if(!e.ok)throw new Error(`Status endpoint returned ${e.status}`);return e.text()},App.stop_status_watch=()=>{App.clear_status_watch()},App.strudel_watch_status=()=>{if(!App.strudel_watch_status){console.warn("Polling function missing. Did strudel bundle load?");return}if(!App.auto_delay||App.auto_delay<=0){console.error("Provide a fetch interval in seconds greater than zero");return}App.status_watch_cancelled=!1;const e=App.auto_delay*1e3,t=async()=>{if(console.info("Fetching status..."),!App.fetch_in_flight){App.fetch_in_flight=!0;try{const u=(await App.fetch_status_code()).trim();if(!u)return;if(App.status_watch_cancelled){console.info("Status watch was cancelled, skipping play action");return}App.set_song_context(),App.audio_started?await App.play_action(u):App.code_to_play=u}catch(o){console.error("Failed to update Strudel status",o)}finally{App.fetch_in_flight=!1}}};App.clear_status_watch(!1),t(),App.fetch_timer=setInterval(()=>{t()},e),console.info("Interval started.")},App.clear_status_watch=(e=!0)=>{App.fetch_timer&&(console.info("Interval cleared."),clearInterval(App.fetch_timer),App.fetch_timer=void 0,e&&(App.status_watch_cancelled=!0))},App.animation_frames=0,App.visual_items=[{text:"auto",alt_text:"Auto - The code sets it",title:"Let the code decide. If the code contains animation calls they will be visible, else it will be a solid background"},{text:"none",alt_text:"None - Solid background",title:"Use a solid background. Most performant option"},{text:"flux surface",title:"A shimmering, flowing horizon where colors swirl like a sunset blending into dawn, a landscape in constant motion that feels alive and mysterious, like walking through a translucent, rippling lake of light"},{text:"hyper rose",title:"A surreal garden of glowing petals that pulse with vibrant energy, blossoms blooming in impossible hues, evoking a sense of wonder and infinite growth in a dreamlike meadow"},{text:"bio tunnel",title:"A lush, organic corridor woven with twisting vines and luminous flora, evoking the feeling of wandering through an underground rainforest alive with whispers of nature’s secret life"},{text:"liquid aether",title:"A flowing, translucent river of ethereal substance, shimmering with iridescent waves that pulse softly, inviting you to drift through an otherworldly sea of pure energy and serenity"},{text:"aurora borealis",title:"A celestial dance of shimmering lights in the night sky, ribbons of green, pink, and purple swirling gracefully over icy mountains, evoking awe and the mysterious beauty of the polar skies"},{text:"orb balloons",title:"A whimsical cluster of floating orbs, each glowing softly like lanterns drifting lazily in a gentle breeze, creating a playful, dreamlike atmosphere of floating serenity and joyful levity"}],App.start_visual=()=>{App.visual=App.visual||"auto",App.background_canvas=DOM.el("#background-canvas"),App.background_canvas_ctx=App.background_canvas.getContext("2d"),App.visual_animations=[App.anim_neon_waves],window.addEventListener("resize",()=>{App.background_canvas&&(App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight)}),App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight,App.apply_visual(App.visual)},App.create_visual_modal=()=>{let e=App.create_list_modal("visual"),t=DOM.el(".modal-title",e);t.textContent="Select Visual"},App.open_visual_modal=async()=>{let e=App.visual_items;App.show_items_modal("visual",{items:e,action:t=>{let o=t.text.toLowerCase();App.apply_visual(o),App.close_modal("visual")},active:App.get_active_visual_index()})},App.apply_visual=e=>{App.visual=e,App.stor_save_visual(),["auto"].includes(e)?(App.clear_visual(),App.background_canvas.classList.add("under")):["none"].includes(e)?(App.clear_visual(),App.background_canvas.classList.remove("under")):(App.background_canvas.classList.remove("under"),App.render_animation())},App.anim_bio_tunnel=(e,t,o,u)=>{let f=t/2,p=o/2,g=u*.02;for(let M=0;M<40;M++){let F=(M*20+u*5)%1e3,S=1e3/(F+10);if(S>20)continue;e.beginPath(),e.lineWidth=2*S;let k=(g*50+F*.5)%360;e.strokeStyle=`hsla(${k}, 80%, 60%, ${F/1e3})`;for(let N=0;N<=6;N++){let $=N/6*Math.PI*2,U=(200+Math.sin(g*3+$*4)*50)*S,O=g*.5,Z=f+Math.cos($+O)*U,K=p+Math.sin($+O)*U;N===0?e.moveTo(Z,K):e.lineTo(Z,K)}e.closePath(),e.stroke()}},App.anim_flux_surface=(e,t,o,u)=>{let f=30,p=40,g=u*.03,M=g*2,F=65;e.lineWidth=2;let S=[];for(let k=0;k<=t;k+=p)S.push(Math.sin(k*.005+g)*50);for(let k=-F;k<o+F;k+=f){let N=k*.01,$=(k*.2+u*.5)%360;e.strokeStyle=`hsla(${$}, 60%, 60%, 0.8)`,e.beginPath();let R=0;for(let U=0;U<=t;U+=p){let O=S[R],Z=Math.sin(U*.02-M+N)*15;e.lineTo(U,k+O+Z),R++}e.stroke()}},App.anim_hyper_rose=(e,t,o,u)=>{let f=t/2,p=o/2,g=Math.max(t,o)*.8,M=u*.002,F=Math.PI*2,S=.01;e.lineWidth=2,e.lineJoin="round",e.globalCompositeOperation="lighter";for(let k=0;k<8;k++){let N=k/8,$=g*(1-N),R=(u*.2+k*15)%360;e.strokeStyle=`hsla(${R}, 80%, 50%, 0.6)`,e.beginPath();for(let U=0;U<F;U+=S){let O=Math.sin(U*7+M*5)*Math.cos(U*3-M),Z=$*(.5+.5*O),K=U+M*(k+1),ie=f+Math.cos(K)*Z,de=p+Math.sin(K)*Z;e.lineTo(ie,de)}e.closePath(),e.stroke()}e.globalCompositeOperation="source-over"},App.anim_liquid_aether=(e,t,o,u)=>{let f=80,p=.6,g=4;(!App.flow_particles||App.flow_particles.length!==f)&&(App.flow_particles=Array(f).fill().map(()=>{let S=Math.random()*100;return{x:Math.random()*t,y:Math.random()*o,speed:p,life:S,max_life:S,angle_offset:Math.random()*Math.PI*2,size:Math.random()*4+2}})),(!App.bg_orbs||App.bg_orbs.length!==g)&&(App.bg_orbs=Array(g).fill().map((S,k)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*1,vy:(Math.random()-.5)*1,radius:Math.random()*500+400,hue:k*50}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(15, 10, 30, 0.1)",e.fillRect(0,0,t,o);let M=u*.002;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(S=>{S.x+=S.vx+Math.sin(M)*1,S.y+=S.vy+Math.cos(M)*1,S.x<-S.radius&&(S.x=t+S.radius),S.x>t+S.radius&&(S.x=-S.radius),S.y<-S.radius&&(S.y=o+S.radius),S.y>o+S.radius&&(S.y=-S.radius);let k=e.createRadialGradient(S.x,S.y,0,S.x,S.y,S.radius),N=.4+Math.sin(M*2+S.hue)*.2;k.addColorStop(0,`hsla(${S.hue+u*.1}, 80%, 60%, ${N})`),k.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=k,e.beginPath(),e.arc(S.x,S.y,S.radius,0,Math.PI*2),e.fill()}),e.globalCompositeOperation="source-over";let F=5e-4;App.flow_particles.forEach(S=>{S.life--,S.life<=0&&(S.x=Math.random()*t,S.y=Math.random()*o,S.life=100+Math.random()*100,S.max_life=S.life,S.size=Math.random()*4+2),e.beginPath();let k=(u*.1+S.x*.02+S.y*.02)%360,N=(S.max_life-S.life)/50,$=S.life/50,R=Math.min(N,$,.8);R=Math.max(0,R),e.fillStyle=`hsla(${k}, 90%, 80%, ${R})`,e.arc(S.x,S.y,S.size,0,Math.PI*2),e.fill();let U=Math.cos(S.x*F+M)+Math.sin(S.y*F+M)+S.angle_offset;S.x+=Math.cos(U)*S.speed,S.y+=Math.sin(U)*S.speed,S.x<-10&&(S.x=t+10),S.x>t+10&&(S.x=-10),S.y<-10&&(S.y=o+10),S.y>o+10&&(S.y=-10)})},App.anim_orb_balloons=(e,t,o,u)=>{let f=8;(!App.bg_orbs||App.bg_orbs.length!==f)&&(App.bg_orbs=Array(f).fill().map((g,M)=>({x:Math.random()*t,y:Math.random()*o,vx:(Math.random()-.5)*3,vy:(Math.random()-.5)*3,base_radius:Math.random()*150+100,hue:Math.random()*360,phase:Math.random()*Math.PI*2}))),e.globalCompositeOperation="source-over",e.fillStyle="rgba(15, 5, 25, 0.2)",e.fillRect(0,0,t,o);let p=u*.01;e.globalCompositeOperation="lighter",App.bg_orbs.forEach(g=>{g.x+=g.vx,g.y+=g.vy,g.x<-g.base_radius&&(g.vx*=-1),g.x>t+g.base_radius&&(g.vx*=-1),g.y<-g.base_radius&&(g.vy*=-1),g.y>o+g.base_radius&&(g.vy*=-1);let M=g.base_radius+Math.sin(p+g.phase)*50,F=e.createRadialGradient(g.x,g.y,0,g.x,g.y,M),S=(g.hue+u*.5)%360;F.addColorStop(0,`hsla(${S}, 80%, 60%, 0.6)`),F.addColorStop(1,`hsla(${S}, 80%, 40%, 0)`),e.fillStyle=F,e.beginPath(),e.arc(g.x,g.y,M,0,Math.PI*2),e.fill()}),e.globalCompositeOperation="source-over"},App.anim_aurora_borealis=(e,t,o,u)=>{let f=u*.02;e.lineWidth=2,e.globalCompositeOperation="lighter";for(let p=0;p<5;p++){e.beginPath();let g=o*.8,M=(u*.5+p*50)%360;e.fillStyle=`hsla(${M}, 60%, 50%, 0.3)`,e.moveTo(0,o);for(let F=0;F<=t;F+=20){let S=Math.sin(F*.002+f+p)*100+Math.sin(F*.01-f*2)*50;e.lineTo(F,g+S-p*100)}e.lineTo(t,o),e.closePath(),e.fill()}e.globalCompositeOperation="source-over"},App.render_animation=()=>{if(["auto","none"].includes(App.visual))return;let e=window.innerWidth,t=window.innerHeight,o="rgba(0, 0, 0, 0.12)";if(App.background_canvas_ctx.fillStyle=o,App.background_canvas_ctx.fillRect(0,0,e,t),App.visual==="bio tunnel")App.anim_bio_tunnel(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="flux surface")App.anim_flux_surface(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="hyper rose")App.anim_hyper_rose(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="liquid aether")App.anim_liquid_aether(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="aurora borealis")App.anim_aurora_borealis(App.background_canvas_ctx,e,t,App.animation_frames);else if(App.visual==="orb balloons")App.anim_orb_balloons(App.background_canvas_ctx,e,t,App.animation_frames);else{App.apply_visual("auto");return}App.animation_frames++,requestAnimationFrame(App.render_animation)},App.clear_visual=()=>{let e=window.innerWidth,t=window.innerHeight;App.background_canvas_ctx.clearRect(0,0,e,t)},App.get_active_visual_index=()=>App.visual_items.map(e=>e.text).indexOf(App.visual),App.next_visual=()=>{let e=App.get_active_visual_index();e+=1,e>=App.visual_items.length&&(e=0),e<=1&&(e=2);let t=App.visual_items[e];App.apply_visual(t.text)},App.def_args=(e,t)=>{for(let o in e)t[o]===void 0&&e[o]!==void 0&&(t[o]=e[o])},App.escape_regex=e=>e.replace(/[\^$*+?.()|[\]{}-]/g,"\\$&"),App.underspace=e=>e.replace(/_+/g," ").trim(),App.clean_canvas=()=>{let e=document.body,t=DOM.els("canvas");for(let o of t)["scope-canvas","background-canvas"].includes(o.id)||Array.from(o.classList).some(f=>["modal-icon"].includes(f))||e.removeChild(o)},App.truncate_path=(e,t=20)=>e.length<=t?e:e.substring(0,t)+"...",App.random_int=(e={})=>{let t={exclude:[]};if(App.def_args(t,e),e.exclude.length>0){let o=[];for(let f=e.min;f<=e.max;f++)e.exclude.includes(f)||o.push(f);if(o.length===0)return;let u;return e.rand?u=Math.floor(e.rand()*o.length):u=Math.floor(Math.random()*o.length),o[u]}return e.rand?Math.floor(e.rand()*(e.max-e.min+1)+e.min):Math.floor(Math.random()*(e.max-e.min+1)+e.min)},App.create_debouncer=(e,t)=>{if(typeof e!="function"){App.error("Invalid debouncer function");return}if(typeof t!="number"||t<1){App.error("Invalid debouncer delay");return}let o,u={};function f(){clearTimeout(o),o=void 0}function p(...g){e(...g)}return u.call=(...g)=>{f(),o=setTimeout(()=>{p(...g)},t)},u.call_2=(...g)=>{o||u.call(g)},u.now=(...g)=>{f(),p(...g)},u.cancel=()=>{f()},u},App.boolstring=e=>e&&e==="true",App.capitalize=e=>e.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),App.get_el_height=e=>{if(!e)return 0;let t=window.getComputedStyle(e),o=e.clientHeight,u=parseFloat(t.paddingTop)||0,f=parseFloat(t.paddingBottom)||0,p=parseFloat(t.marginTop)||0,g=parseFloat(t.marginBottom)||0;return o-u-f+u+f+p+g},App.viewport_height=()=>window.innerHeight||document.documentElement.clientHeight,App.compress_string=e=>{try{return lz.compressToEncodedURIComponent(e)}catch{return""}},App.uncompress_string=e=>{try{return lz.decompressFromEncodedURIComponent(e)}catch{return""}},App.tempo_storage_key="slide.tempo",App.auto_endpoint_storage_key="slide.auto_endpoint",App.auto_delay_storage_key="slide.auto_delay",App.volume_storage_key="slide.volume",App.visual_storage_key="slide.visual",App.scope_storage_key="slide.scope",App.colors_storage_key="slide.colors",App.code_storage_key="slide.code",App.lines_storage_key="slide.lines",App.load_storage=(e,t)=>{let o=localStorage.getItem(App[`${e}_storage_key`]);[null,void 0].includes(o)||t(o)},App.save_storage=(e,t)=>{localStorage.setItem(App[`${e}_storage_key`],t)},App.load_all_storage=()=>{App.stor_load_auto_endpoint(),App.stor_load_auto_delay(),App.stor_load_tempo(),App.stor_load_volume(),App.stor_load_visual(),App.stor_load_scope(),App.stor_load_colors(),App.stor_load_code(),App.stor_load_lines()},App.stor_load_auto_endpoint=()=>{App.load_storage("auto_endpoint",e=>{App.auto_endpoint=e})},App.stor_load_auto_delay=()=>{App.load_storage("auto_delay",e=>{App.auto_delay=parseInt(e)})},App.stor_load_tempo=()=>{App.load_storage("tempo",e=>{App.tempo=parseInt(e)})},App.stor_load_volume=()=>{App.load_storage("volume",e=>{App.volume=parseInt(e)})},App.stor_load_visual=()=>{App.load_storage("visual",e=>{App.visual=e})},App.stor_load_scope=()=>{App.load_storage("scope",e=>{App.scope_enabled=App.boolstring(e)})},App.stor_load_colors=()=>{App.load_storage("colors",e=>{App.colors_enabled=App.boolstring(e)})},App.stor_load_lines=()=>{App.load_storage("lines",e=>{App.lines_enabled=App.boolstring(e)})},App.stor_load_code=()=>{App.load_storage("code",e=>{App.last_code=e})},App.stor_save_auto_delay=()=>{App.save_storage("auto_delay",App.auto_delay)},App.stor_save_auto_endpoint=()=>{App.save_storage("auto_endpoint",App.auto_endpoint)},App.stor_save_tempo=()=>{App.save_storage("tempo",App.tempo)},App.stor_save_volume=()=>{App.save_storage("volume",App.volume)},App.stor_save_visual=()=>{App.save_storage("visual",App.visual)},App.stor_save_scope=()=>{App.save_storage("scope",App.scope_enabled)},App.stor_save_colors=()=>{App.save_storage("colors",App.colors_enabled)},App.stor_save_lines=()=>{App.save_storage("lines",App.lines_enabled)},App.stor_save_code=()=>{App.save_storage("code",App.last_code)},App.beep_sound=()=>{try{let e=App.get_audio_context(),t=e.createOscillator(),o=e.createGain();t.type="triangle",t.frequency.setValueAtTime(440,e.currentTime),t.frequency.linearRampToValueAtTime(445,e.currentTime+.1),o.gain.setValueAtTime(.05,e.currentTime),o.gain.exponentialRampToValueAtTime(.001,e.currentTime+.2),t.connect(o),o.connect(e.destination),t.start(),t.stop(e.currentTime+.2)}catch(e){console.error("Failed to play sound",e)}},App.get_audio_context=()=>{if(window.master_fx&&window.master_fx.context)return window.master_fx.context;if(App.audio_context)return App.audio_context;try{return App.audio_context=new(AudioContext||window.webkitAudioContext),App.audio_context}catch{return console.error("Web Audio API is not supported"),null}},App.splash_reverb=e=>{window.master_fx.splash_reverb(e)},App.set_panning=(e,t=0)=>{if(window.master_fx.set_panning(e),t>0){clearInterval(App.panning_interval);let o=e/(t*1e3/50),u=e;App.panning_interval=setInterval(()=>{u-=o,Math.abs(u)<=Math.abs(o)?(window.master_fx.set_panning(0),clearInterval(App.panning_interval)):window.master_fx.set_panning(u)},50)}},App.get_panning=()=>App.panning.pan.value,App.set_gain=e=>{window.master_fx.set_volume(e)},App.set_eq=(e,t,o)=>{window.master_fx.set_eq_freqs(e,t,o)},App.start_auto_pan=(e=2,t=.8)=>{window.master_fx.set_auto_pan(e,t)},App.stop_auto_pan=()=>{window.master_fx.set_auto_pan(0,0)},App.spin_panning=(e=2e3)=>{App.start_auto_pan(4,1),setTimeout(()=>{App.stop_auto_pan()},e)},App.is_playing=!1,App.play_running=!1,App.reset_playing=()=>{App.play_running=!1},App.play_action=async(e="",t=!1)=>{if(console.info("🔮 Play Action"),App.play_running)return;if(App.play_running=!0,App.update_url(),!await App.ensure_strudel_ready()){App.reset_playing();return}if(e||(e=App.get_input_value()),!e){App.last_code="",App.current_song="",App.reset_playing(),App.stop_action();return}if(!t&&e===App.last_code){App.reset_playing();return}App.stop_status_watch(),App.restart_code_scroll(),App.last_code=e,App.stor_save_code(),App.clear_draw_context(),App.start_color_cycle(),App.clean_canvas(),App.update_title(),App.is_playing=!0;try{await App.strudel_update(e)}catch(u){App.set_status(`Error: ${u.message}`)}App.reset_playing()},App.stop_action=()=>{console.info("🔮 Stop Action"),App.stop_status_watch(),App.stop_strudel(),App.stop_code_scroll(),App.clear_draw_context(),App.set_stop_status(),App.set_song_context(""),App.is_playing=!1},App.stop_strudel=()=>{App.stop_color_cycle(),App.clear_draw_context(),App.scheduler.stop(),App.clean_canvas()},App.strudel_update=async e=>{if(!App.audio_started){console.warn("Audio not started yet. Call strudel_init() first.");return}console.info("Updating 💨"),await App.ensure_scope(),App.set_song_tempo(e),App.update_url();let t=await App.run_eval(e);if(t.ok){App.playing();return}App.do_partial_updates&&await App.apply_partial_update(e)||App.report_eval_failure(t.error)},App.playing=e=>{let t="",o=App.get_song_name(!0);o&&(t=`Playing: ${o}`),t||(App.beat_title?t=`Playing: ${App.beat_title}`:t="Playing 🥁"),e&&(t=`${t} - ${e}`.trim()),App.set_status(t)},App.set_stop_status=()=>{let e=App.get_song_name(!0);e?App.set_status(`Stopped: ${e}`):App.set_status("Stopped")},App.load_last_code=()=>{App.last_code&&App.set_input(App.last_code)},App.create_settings_modal=()=>{let e=App.create_modal("settings"),t=DOM.el(".modal-title",e);t.textContent="Settings";let o=DOM.el(".modal-body",e),u=App.register_setting("Select Visual","Change the background animation",()=>{App.open_visual_modal()}),f=App.register_setting("Toggle Scope","Show or hide the scope visualizer",()=>{App.toggle_scope()}),p=App.register_setting("Toggle Colors","Enable or disable the color animation",()=>{App.toggle_colors()}),g=App.register_setting("Toggle Lines","Enable or disable the line numbers",()=>{App.toggle_lines()});o.appendChild(u),o.appendChild(f),o.appendChild(p),o.appendChild(g)},App.register_setting=(e,t,o)=>{let u=DOM.create("button");return u.textContent=e,u.title=t,DOM.ev(u,"click",()=>{o(),App.close_modal("settings")}),u},App.open_settings_modal=()=>{App.open_modal("settings")},App.beat_title="",App.setup_status=()=>{App.status_debouncer=App.create_debouncer(t=>{App.do_set_status(t)},200);let e=App.get_status();DOM.ev(e,"click",()=>{App.ask_for_title()}),DOM.ev(e,"wheel",t=>{t.deltaY<0?e.scrollLeft-=20:t.deltaY>0&&(e.scrollLeft+=20)})},App.get_status=()=>DOM.el("#status"),App.set_status=e=>{App.status_debouncer&&App.status_debouncer.call(e)},App.do_set_status=e=>{let t=App.get_status();t.scrollTop=0,t.scrollLeft=0,t.innerText=e},App.ask_for_title=()=>{if(App.get_matched_song())return;let t=prompt("Title of this beat");t&&(App.beat_title=t.trim(),App.update_url(),App.update_title(),App.is_playing&&App.playing())},App.start_keyboard=()=>{DOM.ev(document,"keydown",e=>{if(e.key==="s")e.ctrlKey&&(e.preventDefault(),App.play_action());else if(e.key==="Escape"){if(e.preventDefault(),NeedContext.open)return;App.modal_open()?App.close_current_modal():App.stop_action()}else e.key==="1"?e.ctrlKey&&App.show_sounds_context():e.key==="2"?e.ctrlKey&&App.show_notes_context():e.key==="3"&&e.ctrlKey&&App.show_banks_context()})},App.generic_hint=(e,t,o)=>{let u=e.getCursor(),f=e.getTokenAt(u),p=f.string.replace(/['"]/g,""),g=o.filter(M=>M.toLowerCase().startsWith(p.toLowerCase()));g.length===0?console.log("⚠️ No matches found for:",p):console.log(`✅ Found ${g.length} matches`),t({list:g,from:{line:u.line,ch:f.start+1},to:{line:u.line,ch:f.end}})},App.sounds_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_sounds)},App.notes_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_notes)},App.banks_hint=(e,t)=>{App.generic_hint(e,t,App.strudel_banks)},App.sounds_hint.async=!0,App.notes_hint.async=!0,App.banks_hint.async=!0,App.sound_hint_func=e=>{let t=e.getCursor();return{list:App.strudel_sounds,from:t,to:t}},App.setup_editor_autocomplete=()=>{App.editor.on("inputRead",(e,t)=>{if(t.text[0]==='"'||t.text[0]==="'"){let o=e.getCursor(),f=e.getLine(o.line).slice(0,o.ch);f.endsWith('note("')||f.endsWith("note('")?e.showHint({hint:App.notes_hint,completeSingle:!1,container:document.body}):f.endsWith('bank("')||f.endsWith("bank('")?e.showHint({hint:App.banks_hint,completeSingle:!1,container:document.body}):(f.endsWith('sound("')||f.endsWith("sound('"))&&e.showHint({hint:App.sounds_hint,completeSingle:!1,container:document.body})}})},NeedContext.init(),NeedContext.after_hide=()=>{App.focus_input()},App.show_generic_context=(e,t,o)=>{let u=e.map(f=>({text:f,action:()=>{App.add_text_to_input(f)}}));App.show_context(u,o,t)},App.show_sounds_context=e=>{App.show_generic_context(App.strudel_sounds,"Sounds",e)},App.show_notes_context=e=>{App.show_generic_context(App.strudel_notes,"Notes",e)},App.show_banks_context=e=>{App.show_generic_context(App.strudel_banks,"Banks",e)},App.show_context=(e,t,o)=>{let u={items:e,title:o};t&&(u.x=t.x,u.y=t.y),NeedContext.show(u)},App.strudel_banks=["AJKPercusyn","AkaiLinn","AkaiMPC60","AkaiXR10","AlesisHR16","AlesisSR16","BossDR110","BossDR220","BossDR55","BossDR550","CasioRZ1","CasioSK1","CasioVL1","DoepferMS404","EmuDrumulator","EmuSP12","KorgDDM110","KorgKPR77","KorgKR55","KorgKRZ","KorgM1","KorgMinipops","KorgPoly800","KorgT3","Linn9000","LinnLM1","LinnLM2","MoogConcertMateMG1","OberheimDMX","RhodesPolaris","RhythmAce","RolandCompurhythm1000","RolandCompurhythm78","RolandCompurhythm8000","RolandD110","RolandD70","RolandDDR30","RolandJD990","RolandMC202","RolandMC303","RolandMT32","RolandR8","RolandS50","RolandSH09","RolandSystem100","RolandTR505","RolandTR606","RolandTR626","RolandTR707","RolandTR727","RolandTR808","RolandTR909","SakataDPM48","SequentialCircuitsDrumtracks","SequentialCircuitsTom","SimmonsSDS400","SimmonsSDS5","SoundmastersR88","UnivoxMicroRhythmer12","ViscoSpaceDrum","XdrumLM8953","YamahaRM50","YamahaRX21","YamahaRX5","YamahaRY30","YamahaTG33"],App.strudel_sounds=["sawtooth","square","triangle","sine","sax","gtr","moog","white","pink","brown","bd","sd","rim","hh","oh","lt","mt","ht","rd","cr"],App.strudel_notes=["c4","e4","g4","a4","f4","d4","b4","c3","e3","g3","a3","f3","d3","b3","f#4","bb4","c#4","eb4","g#4","f#3","bb3","c#3","eb3","g#3","c5","e5","g5","a5","f5","d5","b5","c2","e2","g2","a2","f2","d2","b2","f#5","bb5","c#5","eb5","g#5","f#2","bb2","c#2","eb2","g#2","c6","e6","g6","a6","f6","d6","b6","c1","e1","g1","a1","f1","d1","b1","f#6","bb6","c#6","eb6","g#6","f#1","bb1","c#1","eb1","g#1","c7","e7","g7","c0","e0","g0"],App.colors_enabled=!0,App.apply_color=e=>{let t=DOM.el("#volume-value"),o=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),f=DOM.el("#tempo-slider"),p=DOM.el("#status"),g=DOM.el("#image");t&&(t.style.color=e),o&&(o.style.accentColor=e),u&&(u.style.color=e),f&&(f.style.accentColor=e),p&&(p.style.color=e),g&&(g.style.filter=`drop-shadow(0 0 0.15rem ${e})`)},App.start_color_cycle=()=>{App.colors_enabled&&(App.color_cycle_timer||(App.color_index=0,App.apply_color(App.cycle_colors[0],0),App.color_cycle_timer=setInterval(()=>{App.color_index=(App.color_index+1)%App.cycle_colors.length,App.apply_color(App.cycle_colors[App.color_index],App.color_index)},3*1e3)))},App.stop_color_cycle=()=>{App.color_cycle_timer&&(clearInterval(App.color_cycle_timer),App.color_cycle_timer=void 0),App.color_index=0;let e=App.cycle_colors[0],t=DOM.el("#volume-value"),o=DOM.el("#volume-slider"),u=DOM.el("#tempo-value"),f=DOM.el("#tempo-slider"),p=DOM.el("#status"),g=DOM.el("#image");t&&(t.style.color=e),o&&(o.style.accentColor=e),u&&(u.style.color=e),f&&(f.style.accentColor=e),p&&(p.style.color=e),g&&(g.style.filter="")},App.toggle_colors=()=>{App.colors_enabled=!App.colors_enabled,App.stor_save_colors(),App.is_playing&&(App.colors_enabled?App.start_color_cycle():App.is_playing&&App.stop_color_cycle())},App.color_interface=e=>{let t=App[`scope_click_color_${e}`];App.do_color_interface(t)},App.restore_interface_colors=()=>{App.do_color_interface(App.border_color)},App.do_color_interface=e=>{App.set_input_border(e);let t=App.get_scope_container();t.style.borderColor=e},App.check_scope_slide=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords;if(!(Math.abs(App.scope_max_y-App.scope_min_y)>=App.max_scope_slide_y_dff))return Math.abs(e.x-t.x)>=App.scope_slide_distance?(e.x<t.x?App.random_song():App.next_visual(),App.clear_clicks(),!0):!1},App.check_scope_panning=()=>{let e=App.mouse_down_coords,t=App.mouse_up_coords,{width:o,height:u}=App.get_scope_dimensions(),f=App.scope_panning_zone,p=App.scope_padding_amount;return e.x<=f||t.x<=f?(App.set_panning(-p,3),!0):e.x>=o-f||t.x>=o-f?(App.set_panning(p,3),!0):!1},App.circle_gesture=()=>{let e=App.scope_clicks;if(!e||!Array.isArray(e))return!1;let t=e.length;if(t<8)return!1;let o=1/0,u=-1/0,f=1/0,p=-1/0,g=0,M=0;for(let ve=0;ve<t;ve++){let Ae=e[ve];Ae.x<o&&(o=Ae.x),Ae.x>u&&(u=Ae.x),Ae.y<f&&(f=Ae.y),Ae.y>p&&(p=Ae.y),g+=Ae.x,M+=Ae.y}let F=Math.hypot(u-o,p-f),S=e[0],k=e[t-1];if(Math.hypot(S.x-k.x,S.y-k.y)/F>.35)return!1;let $=u-o,R=p-f,U=$/R;if(U<.4||U>2.5)return!1;let O=g/t,Z=M/t,K=0,ie=[];for(let ve=0;ve<t;ve++){let Ae=e[ve].x-O,Fe=e[ve].y-Z,we=Math.hypot(Ae,Fe);ie.push(we),K+=we}let de=K/t,te=0;for(let ve=0;ve<t;ve++){let Ae=ie[ve]-de;te+=Ae*Ae}return Math.sqrt(te/t)/de<.35},App.triangle_gesture=()=>{let e=(p,g)=>{let M=p.x-g.x,F=p.y-g.y;return M*M+F*F},t=(p,g,M)=>{let F=e(g,M);if(F===0)return e(p,g);let S=((p.x-g.x)*(M.x-g.x)+(p.y-g.y)*(M.y-g.y))/F;return S=Math.max(0,Math.min(1,S)),e(p,{x:g.x+S*(M.x-g.x),y:g.y+S*(M.y-g.y)})},o=(p,g,M)=>{let F={x:p.x-g.x,y:p.y-g.y},S={x:M.x-g.x,y:M.y-g.y},k=F.x*S.x+F.y*S.y,N=Math.sqrt(F.x*F.x+F.y*F.y),$=Math.sqrt(S.x*S.x+S.y*S.y);if(N*$===0)return 0;let R=k/(N*$);return R=Math.max(-1,Math.min(1,R)),Math.acos(R)*(180/Math.PI)},u=(p,g)=>{if(p.length<=2)return p;let M=0,F=0,S=p.length-1;for(let k=1;k<S;k++){let N=t(p[k],p[0],p[S]);N>M&&(M=N,F=k)}if(M>g*g){let k=u(p.slice(0,F+1),g),N=u(p.slice(F),g);return k.slice(0,k.length-1).concat(N)}return[p[0],p[S]]};return(p=>{let g=p.length;if(g<10)return!1;let M=1/0,F=-1/0,S=1/0,k=-1/0;for(let te=0;te<g;te++)M=Math.min(M,p[te].x),F=Math.max(F,p[te].x),S=Math.min(S,p[te].y),k=Math.max(k,p[te].y);let N=Math.hypot(F-M,k-S),$=p[0],R=p[g-1];if(Math.hypot($.x-R.x,$.y-R.y)/N>.2)return!1;let O=N*.15,Z=u(p,O),K=Z.length;if(K<3||K>4)return!1;let ie=Z.slice(0,3),de=[o(ie[2],ie[0],ie[1]),o(ie[0],ie[1],ie[2]),o(ie[1],ie[2],ie[0])];for(let te=0;te<3;te++)if(de[te]<10||de[te]>170)return!1;return!0})(App.scope_clicks)},App.square_gesture=()=>{let e=App.scope_clicks;if(!e||!Array.isArray(e))return!1;let t=e.length;if(t<10)return!1;let o=(te,re)=>{let ue=te.x-re.x,ve=te.y-re.y;return ue*ue+ve*ve},u=(te,re,ue)=>{let ve=o(re,ue);if(ve===0)return o(te,re);let Ae=((te.x-re.x)*(ue.x-re.x)+(te.y-re.y)*(ue.y-re.y))/ve;return Ae=Math.max(0,Math.min(1,Ae)),o(te,{x:re.x+Ae*(ue.x-re.x),y:re.y+Ae*(ue.y-re.y)})},f=(te,re)=>{if(te.length<=2)return te;let ue=0,ve=0,Ae=te.length-1;for(let Fe=1;Fe<Ae;Fe++){let we=u(te[Fe],te[0],te[Ae]);we>ue&&(ue=we,ve=Fe)}if(ue>re*re){let Fe=f(te.slice(0,ve+1),re),we=f(te.slice(ve),re);return Fe.slice(0,Fe.length-1).concat(we)}return[te[0],te[Ae]]},p=1/0,g=-1/0,M=1/0,F=-1/0;for(let te=0;te<t;te++){let re=e[te];p=Math.min(p,re.x),g=Math.max(g,re.x),M=Math.min(M,re.y),F=Math.max(F,re.y)}let S=Math.hypot(g-p,F-M),k=e[0],N=e[t-1];if(Math.hypot(k.x-N.x,k.y-N.y)/S>.4)return!1;let R=g-p,U=F-M,O=R/U;if(O<.15||O>6)return!1;let Z=S*.06,K=f(e,Z),ie=K.length;if(ie<4||ie>6)return!1;let de=0;for(let te=1;te<ie-1;te++){let re=K[te-1],ue=K[te],ve=K[te+1],Ae=ue.x-re.x,Fe=ue.y-re.y,we=ve.x-ue.x,Ce=ve.y-ue.y,be=Ae*we+Fe*Ce,le=Math.hypot(Ae,Fe),Ze=Math.hypot(we,Ce),Je=be/(le*Ze);Math.abs(Je)<.5&&de++}return de>=2},App.gesture_function=(e,t)=>{App.scope_gestures_enabled=!1,App.increase_scope_click_level(e),App.spin_panning(),t()},App.load_code_from_query=()=>{let t=new URLSearchParams(window.location.search).get(App.code_query_key);if(!t)return!1;try{let o=App.uncompress_string(t);return App.last_code=o,App.load_last_code(),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.load_song_from_query=async()=>{let t=App.get_query_params().get(App.song_query_key);if(!t)return!1;try{App.loading();let o=await App.fetch_song_code(t);App.set_input(o),App.set_song_tempo(o),App.set_song_context(t);let u=App.clean_song_name(t);return App.set_status(`Loaded: ${u}`),!0}catch(o){App.set_status(`Failed to load song: ${o.message}`),console.error("Failed to load song:",o)}return!1},App.set_cpm_from_query=()=>{let t=App.get_query_params().get(App.cpm_query_key);if(t){let o=parseInt(t,10);Number.isFinite(o)&&(App.update_tempo(o),App.set_tempo())}},App.set_beat_title_from_query=()=>{let t=App.get_query_params().get(App.beat_query_key);t&&(App.beat_title=t)}})();
