(function(){"use strict";var _documentCurrentScript=typeof document<"u"?document.currentScript:null;const App$1={};window.App=App$1,(function(){let o=window.AudioContext||window.webkitAudioContext;function e(l,u=3,p=2){let d=l.sampleRate,f=d*u,g=l.createBuffer(2,f,d),b=g.getChannelData(0),A=g.getChannelData(1);for(let S=0;S<f;S++){let M=S/f,E=Math.pow(1-M,p);b[S]=(Math.random()*2-1)*E,A[S]=(Math.random()*2-1)*E}return g}class a extends o{constructor(...u){if(window.master_fx&&window.master_fx.context)return window.master_fx.context;super(...u);let p=this,d=!window.master_fx,f=p.createBiquadFilter();f.type="lowpass",f.frequency.value=22050,f.Q.value=0;let g=p.createBiquadFilter();g.type="lowshelf",g.frequency.value=320,g.gain.value=0;let b=p.createBiquadFilter();b.type="peaking",b.frequency.value=1e3,b.Q.value=1,b.gain.value=0;let A=p.createBiquadFilter();A.type="highshelf",A.frequency.value=4e3,A.gain.value=0;let S=p.createStereoPanner();S.pan.value=0;let M=p.createOscillator();M.type="sine",M.frequency.value=0;let E=p.createGain();E.gain.value=0,M.connect(E),E.connect(S.pan),M.start();let F=p.createConvolver();F.buffer=e(p);let $=p.createGain();$.gain.value=0;let Z=p.createDelay(5);Z.delayTime.value=.3;let V=p.createGain();V.gain.value=.4;let K=p.createBiquadFilter();K.type="lowpass",K.frequency.value=3500;let se=p.createGain();se.gain.value=0;let z=p.createGain();z.gain.value=1;let U=p.createAnalyser();U.fftSize=256;let ee=U.frequencyBinCount,ae=new Uint8Array(ee);if(f.connect(g),g.connect(b),b.connect(A),A.connect(S),S.connect(z),z.connect(U),U.connect(super.destination),Z.connect(V),V.connect(K),K.connect(Z),Z.connect(se),se.connect(z),Object.defineProperty(f,"maxChannelCount",{get:()=>super.destination.maxChannelCount}),Object.defineProperty(p,"destination",{get:()=>f,configurable:!0}),d){let de={timer:null,is_connected:!1},ke={is_connected:!1};window.master_fx={context:p,nodes:{filter:f,eq_low:g,eq_mid:b,eq_high:A,panner:S,reverb_gain:$,delay_wet_gain:se,delay_feedback:V,delay_node:Z,master_gain:z,lfo:M,lfo_gain:E,analyser:U},toggle_cutoff:Oe=>{let De=p.currentTime,Ae=.4;f.frequency.cancelScheduledValues(De),f.Q.cancelScheduledValues(De),Oe?(f.frequency.setTargetAtTime(600,De,Ae),f.Q.setTargetAtTime(10,De,Ae)):(f.frequency.setTargetAtTime(22050,De,Ae),f.Q.setTargetAtTime(0,De,Ae),f.frequency.setValueAtTime(22050,De+Ae*5),f.Q.setValueAtTime(0,De+Ae*5))},get_volume:()=>{U.getByteTimeDomainData(ae);let Oe=0;for(let De=0;De<ee;De++){let Ae=(ae[De]-128)/128;Oe+=Ae*Ae}return Math.sqrt(Oe/ee)},set_eq:(Oe,De,Ae)=>{let Pe=p.currentTime,We=.1;Oe!==void 0&&(g.gain.cancelScheduledValues(Pe),g.gain.setTargetAtTime(Oe,Pe,We),Oe===0&&g.gain.setValueAtTime(0,Pe+.5)),De!==void 0&&(b.gain.cancelScheduledValues(Pe),b.gain.setTargetAtTime(De,Pe,We),De===0&&b.gain.setValueAtTime(0,Pe+.5)),Ae!==void 0&&(A.gain.cancelScheduledValues(Pe),A.gain.setTargetAtTime(Ae,Pe,We),Ae===0&&A.gain.setValueAtTime(0,Pe+.5))},set_volume:Oe=>{z.gain.cancelScheduledValues(p.currentTime),z.gain.setTargetAtTime(Oe,p.currentTime,.1)},set_panning:Oe=>{S.pan.cancelScheduledValues(p.currentTime),S.pan.setTargetAtTime(Oe,p.currentTime+.02,.1)},set_auto_pan:(Oe,De)=>{let Ae=p.currentTime;M.frequency.cancelScheduledValues(Ae),E.gain.cancelScheduledValues(Ae),M.frequency.setTargetAtTime(Oe,Ae,.1),E.gain.setTargetAtTime(De,Ae,.1)},toggle_reverb:(Oe,De=.5,Ae=.1)=>{let Pe=p.currentTime;if($.gain.cancelScheduledValues(Pe),Oe)de.is_connected||(S.connect(F),F.connect($),$.connect(z),$.gain.setValueAtTime(0,Pe),de.is_connected=!0),$.gain.setTargetAtTime(De,Pe,Ae);else{$.gain.setTargetAtTime(0,Pe,Ae);let We=Math.max(500,Ae*1e3*5);setTimeout(()=>{$.gain.value<.01&&($.disconnect(),F.disconnect(),de.is_connected=!1,$.gain.setValueAtTime(0,p.currentTime))},We)}},splash_reverb:(Oe=3)=>{de.timer&&(clearTimeout(de.timer),de.timer=null),window.master_fx.toggle_reverb(!0,.5,.2),de.timer=setTimeout(()=>{window.master_fx.toggle_reverb(!1,0,2)},Oe*1e3)},toggle_delay:(Oe,De=.5,Ae=.3,Pe=.4)=>{let We=p.currentTime,qe=.1;se.gain.cancelScheduledValues(We),Z.delayTime.setTargetAtTime(Ae,We,qe),V.gain.setTargetAtTime(Pe,We,qe),Oe?(ke.is_connected||(S.connect(Z),ke.is_connected=!0),se.gain.setTargetAtTime(De,We,qe)):(se.gain.setTargetAtTime(0,We,qe),setTimeout(()=>{if(se.gain.value<.01)try{S.disconnect(Z),ke.is_connected=!1}catch{}},2e3))}}}}}window.AudioContext=a,window.webkitAudioContext&&(window.webkitAudioContext=a)})();const DOM$1={};DOM$1.dataset_obj={},DOM$1.dataset_id=0,DOM$1.el=(o,e=document)=>(typeof e=="string"&&(e=DOM$1.el(e)),e.querySelector(o)),DOM$1.els=(o,e=document)=>(typeof e=="string"&&(e=DOM$1.el(e)),Array.from(e.querySelectorAll(o))),DOM$1.el_or_self=(o,e=document)=>{e=DOM$1.element(e);let a=e.querySelector(o);return a||e.classList.contains(DOM$1.clean_dot(o))&&(a=e),a},DOM$1.els_or_self=(o,e=document)=>{e=DOM$1.element(e);let a=Array.from(e.querySelectorAll(o));return a.length===0&&e.classList.contains(DOM$1.clean_dot(o))&&(a=[e]),a},DOM$1.clone=o=>(o=DOM$1.element(o),o.cloneNode(!0)),DOM$1.clone_children=o=>{o=DOM$1.element(o);let e=Array.from(o.children),a=[];for(let l of e)a.push(DOM$1.clone(l));return a},DOM$1.dataset=(o,e,a)=>{if(o=DOM$1.element(o),!o)return;let l=o.dataset.dataset_id;if(l||(l=DOM$1.dataset_id,DOM$1.dataset_id+=1,o.dataset.dataset_id=l,DOM$1.dataset_obj[l]={}),a!==void 0)DOM$1.dataset_obj[l][e]=a;else return DOM$1.dataset_obj[l][e]},DOM$1.create=(o,e="",a="")=>{let l=document.createElement(o);if(e){let u=e.split(" ").filter(p=>p!=="");for(let p of u)l.classList.add(p)}return a&&(l.id=a),l},DOM$1.ev=(o,e,a,l)=>{o=DOM$1.element(o),o.addEventListener(e,a,l)},DOM$1.evs=(o,e,a,l)=>{o=DOM$1.element(o);for(let u of e)o.addEventListener(u,a,l)},DOM$1.index=o=>(o=DOM$1.element(o),Array.from(o.parentNode.children).indexOf(o)),DOM$1.class=(o,e)=>{o=DOM$1.element(o);for(let a of e)if(o.classList.contains(DOM$1.clean_dot(a)))return!0;return!1},DOM$1.parent=(o,e)=>{o=DOM$1.element(o);for(let a of e){let l=o.closest(a);if(l)return l}},DOM$1.clean_dot=o=>o.replace(".",""),DOM$1.show=(o,e=1)=>{o=DOM$1.element(o),o.classList.remove(DOM$1.hidden(e))},DOM$1.hide=(o,e=1)=>{o=DOM$1.element(o),o.classList.add(DOM$1.hidden(e))},DOM$1.hidden=(o=1)=>{let e="hidden";return o>1&&(e+=`_${o}`),e},DOM$1.element=o=>typeof o=="string"?DOM$1.el(o):o,DOM$1.is_hidden=(o,e=1)=>o.classList.contains(DOM$1.hidden(e)),DOM$1.active=()=>document.activeElement,typeof window<"u"&&(window.DOM=DOM$1),(function(o,e){var a=e(o);typeof module<"u"&&"exports"in module?module.exports=a:typeof define=="function"&&define.amd?define([],function(){return a}):o.jdenticon=a})(typeof self<"u"?self:void 0,function(o){function e(ve,Ce,_e){return parseInt(ve.substr(Ce,_e),16)}function a(ve){return ve|=0,ve<0?"00":ve<16?"0"+ve.toString(16):ve<256?ve.toString(16):"ff"}function l(ve,Ce,_e){return _e=_e<0?_e+6:_e>6?_e-6:_e,a(255*(_e<1?ve+(Ce-ve)*_e:_e<3?Ce:_e<4?ve+(Ce-ve)*(4-_e):ve))}function u(ve){if(/^#[0-9a-f]{3,8}$/i.test(ve)){var Ce,_e=ve.length;if(_e<6){var Ie=ve[1],ot=ve[2],ft=ve[3],tt=ve[4]||"";Ce="#"+Ie+Ie+ot+ot+ft+ft+tt+tt}return(_e==7||_e>8)&&(Ce=ve),Ce}}function p(ve){var Ce=e(ve,7,2),_e;if(isNaN(Ce))_e=ve;else{var Ie=e(ve,1,2),ot=e(ve,3,2),ft=e(ve,5,2);_e="rgba("+Ie+","+ot+","+ft+","+(Ce/255).toFixed(2)+")"}return _e}function d(ve,Ce,_e){var Ie;if(Ce==0){var ot=a(_e*255);Ie=ot+ot+ot}else{var ft=_e<=.5?_e*(Ce+1):_e+Ce-_e*Ce,tt=_e*2-ft;Ie=l(tt,ft,ve*6+2)+l(tt,ft,ve*6)+l(tt,ft,ve*6-2)}return"#"+Ie}function f(ve,Ce,_e){var Ie=[.55,.5,.5,.46,.6,.55,.55],ot=Ie[ve*6+.5|0];return _e=_e<.5?_e*ot*2:ot+(_e-.5)*(1-ot)*2,d(ve,Ce,_e)}var g=o,b={G:"jdenticon_config",n:"config"},A={};function S(ve){A=ve}function M(ve){return arguments.length&&(A[b.n]=ve),A[b.n]}function E(ve,Ce){var _e=typeof ve=="object"&&ve||A[b.n]||g[b.G]||{},Ie=_e.lightness||{},ot=_e.saturation||{},ft="color"in ot?ot.color:ot,tt=ot.grayscale,Mt=_e.backColor,st=_e.padding;function Ot(on,an){var Ut=Ie[on];return Ut&&Ut.length>1||(Ut=an),function(Nt){return Nt=Ut[0]+Nt*(Ut[1]-Ut[0]),Nt<0?0:Nt>1?1:Nt}}function kt(on){var an=_e.hues,Ut;return an&&an.length>0&&(Ut=an[0|.999*on*an.length]),typeof Ut=="number"?(Ut/360%1+1)%1:on}return{X:kt,p:typeof ft=="number"?ft:.5,H:typeof tt=="number"?tt:0,q:Ot("color",[.4,.8]),I:Ot("grayscale",[.3,.9]),J:u(Mt),Y:typeof ve=="number"?ve:typeof st=="number"?st:Ce}}var F=1,$=2,Z={t:"data-jdenticon-hash",o:"data-jdenticon-value"},V="["+Z.t+"],["+Z.o+"]",K=typeof document<"u"&&document.querySelectorAll.bind(document);function se(ve){if(ve){var Ce=ve.tagName;if(/^svg$/i.test(Ce))return F;if(/^canvas$/i.test(Ce)&&"getContext"in ve)return $}}function z(ve){if(typeof MutationObserver<"u"){var Ce=new MutationObserver(function(Ie){for(var ot=0;ot<Ie.length;ot++){for(var ft=Ie[ot],tt=ft.addedNodes,Mt=0;tt&&Mt<tt.length;Mt++){var st=tt[Mt];if(st.nodeType==1)if(se(st))ve(st);else for(var Ot=st.querySelectorAll(V),kt=0;kt<Ot.length;kt++)ve(Ot[kt])}ft.type=="attributes"&&se(ft.target)&&ve(ft.target)}});Ce.observe(document.body,{childList:!0,attributes:!0,attributeFilter:[Z.o,Z.t,"width","height"],subtree:!0})}}function U(ve,Ce){this.x=ve,this.y=Ce}function ee(ve,Ce,_e,Ie){this.u=ve,this.v=Ce,this.K=_e,this.Z=Ie}ee.prototype.L=function(Ce,_e,Ie,ot){var ft=this.u+this.K,tt=this.v+this.K,Mt=this.Z;return Mt===1?new U(ft-_e-(ot||0),this.v+Ce):Mt===2?new U(ft-Ce-(Ie||0),tt-_e-(ot||0)):Mt===3?new U(this.u+_e,tt-Ce-(Ie||0)):new U(this.u+Ce,this.v+_e)};var ae=new ee(0,0,0,0);function de(ve){this.M=ve,this.A=ae}var ke=de.prototype;ke.g=function(Ce,_e){for(var Ie=this,ot=_e?-2:2,ft=[],tt=_e?Ce.length-2:0;tt<Ce.length&&tt>=0;tt+=ot)ft.push(Ie.A.L(Ce[tt],Ce[tt+1]));this.M.g(ft)},ke.h=function(Ce,_e,Ie,ot){var ft=this.A.L(Ce,_e,Ie,Ie);this.M.h(ft,Ie,ot)},ke.i=function(Ce,_e,Ie,ot,ft){this.g([Ce,_e,Ce+Ie,_e,Ce+Ie,_e+ot,Ce,_e+ot],ft)},ke.j=function(Ce,_e,Ie,ot,ft,tt){var Mt=[Ce+Ie,_e,Ce+Ie,_e+ot,Ce,_e+ot,Ce,_e];Mt.splice((ft||0)%4*2,2),this.g(Mt,tt)},ke.N=function(Ce,_e,Ie,ot,ft){this.g([Ce+Ie/2,_e,Ce+Ie,_e+ot/2,Ce+Ie/2,_e+ot,Ce,_e+ot/2],ft)};function Oe(ve,Ce,_e,Ie){ve=ve%14;var ot,ft,tt,Mt,st,Ot;ve?ve==1?(tt=0|_e*.5,Mt=0|_e*.8,Ce.j(_e-tt,0,tt,Mt,2)):ve==2?(tt=0|_e/3,Ce.i(tt,tt,_e-tt,_e-tt)):ve==3?(st=_e*.1,Ot=_e<6?1:_e<8?2:0|_e*.25,st=st>1?0|st:st>.5?1:st,Ce.i(Ot,Ot,_e-st-Ot,_e-st-Ot)):ve==4?(ft=0|_e*.15,tt=0|_e*.5,Ce.h(_e-tt-ft,_e-tt-ft,tt)):ve==5?(st=_e*.1,Ot=st*4,Ot>3&&(Ot=0|Ot),Ce.i(0,0,_e,_e),Ce.g([Ot,Ot,_e-st,Ot,Ot+(_e-Ot-st)/2,_e-st],!0)):ve==6?Ce.g([0,0,_e,0,_e,_e*.7,_e*.4,_e*.4,_e*.7,_e,0,_e]):ve==7?Ce.j(_e/2,_e/2,_e/2,_e/2,3):ve==8?(Ce.i(0,0,_e,_e/2),Ce.i(0,_e/2,_e/2,_e/2),Ce.j(_e/2,_e/2,_e/2,_e/2,1)):ve==9?(st=_e*.14,Ot=_e<4?1:_e<6?2:0|_e*.35,st=_e<8?st:0|st,Ce.i(0,0,_e,_e),Ce.i(Ot,Ot,_e-Ot-st,_e-Ot-st,!0)):ve==10?(st=_e*.12,Ot=st*3,Ce.i(0,0,_e,_e),Ce.h(Ot,Ot,_e-st-Ot,!0)):ve==11?Ce.j(_e/2,_e/2,_e/2,_e/2,3):ve==12?(ft=_e*.25,Ce.i(0,0,_e,_e),Ce.N(ft,ft,_e-ft,_e-ft,!0)):!Ie&&(ft=_e*.4,tt=_e*1.2,Ce.h(ft,ft,tt)):(ot=_e*.42,Ce.g([0,0,_e,0,_e,_e-ot*2,_e-ot,_e,0,_e]))}function De(ve,Ce,_e){ve=ve%4;var Ie;ve?ve==1?Ce.j(0,_e/2,_e,_e/2,0):ve==2?Ce.N(0,0,_e,_e):(Ie=_e/6,Ce.h(Ie,Ie,_e-2*Ie)):Ce.j(0,0,_e,_e,0)}function Ae(ve,Ce){return ve=Ce.X(ve),[f(ve,Ce.H,Ce.I(0)),f(ve,Ce.p,Ce.q(.5)),f(ve,Ce.H,Ce.I(1)),f(ve,Ce.p,Ce.q(1)),f(ve,Ce.p,Ce.q(0))]}function Pe(ve,Ce,_e){var Ie=E(_e,.08);Ie.J&&ve.m(Ie.J);var ot=ve.k,ft=.5+ot*Ie.Y|0;ot-=ft*2;var tt=new de(ve),Mt=0|ot/4,st=0|ft+ot/2-Mt*2,Ot=0|ft+ot/2-Mt*2;function kt(fn,mn,xt,Vt,en){var sn=e(Ce,xt,1),yn=Vt?e(Ce,Vt,1):0;ve.O(an[Ut[fn]]);for(var Xn=0;Xn<en.length;Xn++)tt.A=new ee(st+en[Xn][0]*Mt,Ot+en[Xn][1]*Mt,Mt,yn++%4),mn(sn,tt,Mt,Xn);ve.P()}var on=e(Ce,-7)/268435455,an=Ae(on,Ie),Ut=[],Nt;function hn(fn){if(fn.indexOf(Nt)>=0){for(var mn=0;mn<fn.length;mn++)if(Ut.indexOf(fn[mn])>=0)return!0}}for(var Ft=0;Ft<3;Ft++)Nt=e(Ce,8+Ft,1)%an.length,(hn([0,4])||hn([2,3]))&&(Nt=1),Ut.push(Nt);kt(0,De,2,3,[[1,0],[2,0],[2,3],[1,3],[0,1],[3,1],[3,2],[0,2]]),kt(1,De,4,5,[[0,0],[3,0],[3,3],[0,3]]),kt(2,Oe,1,null,[[1,1],[2,1],[2,2],[1,2]]),ve.finish()}function We(ve){var Ce=40,_e=16,Ie=0,ot=0,ft=encodeURI(ve)+"%80",tt=[],Mt,st=[],Ot=1732584193,kt=4023233417,on=~Ot,an=~kt,Ut=3285377520,Nt=[Ot,kt,on,an,Ut],hn=0,Ft="";function fn(mn,xt){return mn<<xt|mn>>>32-xt}for(;Ie<ft.length;ot++)tt[ot>>2]=tt[ot>>2]|(ft[Ie]=="%"?parseInt(ft.substring(Ie+1,Ie+=3),16):ft.charCodeAt(Ie++))<<(3-(ot&3))*8;for(Mt=((ot+7>>6)+1)*_e,tt[Mt-1]=ot*8-8;hn<Mt;hn+=_e){for(Ie=0;Ie<80;Ie++)ot=fn(Ot,5)+Ut+(Ie<20?(kt&on^~kt&an)+1518500249:Ie<40?(kt^on^an)+1859775393:Ie<60?(kt&on^kt&an^on&an)+2400959708:(kt^on^an)+3395469782)+(st[Ie]=Ie<_e?tt[hn+Ie]|0:fn(st[Ie-3]^st[Ie-8]^st[Ie-14]^st[Ie-16],1)),Ut=an,an=on,on=fn(kt,30),kt=Ot,Ot=ot;Nt[0]=Ot=Nt[0]+Ot|0,Nt[1]=kt=Nt[1]+kt|0,Nt[2]=on=Nt[2]+on|0,Nt[3]=an=Nt[3]+an|0,Nt[4]=Ut=Nt[4]+Ut|0}for(Ie=0;Ie<Ce;Ie++)Ft+=(Nt[Ie>>3]>>>(7-(Ie&7))*4&15).toString(16);return Ft}function qe(ve){return/^[0-9a-f]{11,}$/i.test(ve)&&ve}function at(ve){return We(ve==null?"":""+ve)}function yt(ve,Ce){var _e=ve.canvas,Ie=_e.width,ot=_e.height;ve.save(),Ce||(Ce=Math.min(Ie,ot),ve.translate((Ie-Ce)/2|0,(ot-Ce)/2|0)),this.l=ve,this.k=Ce,ve.clearRect(0,0,Ce,Ce)}var ut=yt.prototype;ut.m=function(Ce){var _e=this.l,Ie=this.k;_e.fillStyle=p(Ce),_e.fillRect(0,0,Ie,Ie)},ut.O=function(Ce){var _e=this.l;_e.fillStyle=p(Ce),_e.beginPath()},ut.P=function(){this.l.fill()},ut.g=function(Ce){var _e=this.l;_e.moveTo(Ce[0].x,Ce[0].y);for(var Ie=1;Ie<Ce.length;Ie++)_e.lineTo(Ce[Ie].x,Ce[Ie].y);_e.closePath()},ut.h=function(Ce,_e,Ie){var ot=this.l,ft=_e/2;ot.moveTo(Ce.x+ft,Ce.y+ft),ot.arc(Ce.x+ft,Ce.y+ft,ft,0,Math.PI*2,Ie),ot.closePath()},ut.finish=function(){this.l.restore()};function Dt(ve,Ce,_e,Ie){if(!ve)throw new Error("No canvas specified.");Pe(new yt(ve,_e),qe(Ce)||at(Ce),Ie)}function $t(ve){return(ve*10+.5|0)/10}function Bt(){this.B=""}var $e=Bt.prototype;$e.g=function(Ce){for(var _e="",Ie=0;Ie<Ce.length;Ie++)_e+=(Ie?"L":"M")+$t(Ce[Ie].x)+" "+$t(Ce[Ie].y);this.B+=_e+"Z"},$e.h=function(Ce,_e,Ie){var ot=Ie?0:1,ft=$t(_e/2),tt=$t(_e),Mt="a"+ft+","+ft+" 0 1,"+ot+" ";this.B+="M"+$t(Ce.x)+" "+$t(Ce.y+_e/2)+Mt+tt+",0"+Mt+-tt+",0"};function bt(ve){this.C,this.D={},this.R=ve,this.k=ve.k}var nn=bt.prototype;nn.m=function(Ce){var _e=/^(#......)(..)?/.exec(Ce),Ie=_e[2]?e(_e[2],0)/255:1;this.R.m(_e[1],Ie)},nn.O=function(Ce){this.C=this.D[Ce]||(this.D[Ce]=new Bt)},nn.P=function(){},nn.g=function(Ce){this.C.g(Ce)},nn.h=function(Ce,_e,Ie){this.C.h(Ce,_e,Ie)},nn.finish=function(){var Ce=this,_e=this.D;for(var Ie in _e)_e.hasOwnProperty(Ie)&&Ce.R.S(Ie,_e[Ie].B)};var Zt={T:"http://www.w3.org/2000/svg",U:"width",V:"height"};function Rt(ve){this.k=ve,this.F='<svg xmlns="'+Zt.T+'" width="'+ve+'" height="'+ve+'" viewBox="0 0 '+ve+" "+ve+'">'}var qt=Rt.prototype;qt.m=function(Ce,_e){_e&&(this.F+='<rect width="100%" height="100%" fill="'+Ce+'" opacity="'+_e.toFixed(2)+'"/>')},qt.S=function(Ce,_e){this.F+='<path fill="'+Ce+'" d="'+_e+'"/>'},qt.toString=function(){return this.F+"</svg>"};function Wt(ve,Ce,_e){var Ie=new Rt(Ce);return Pe(new bt(Ie),qe(ve)||at(ve),_e),Ie.toString()}function tn(ve,Ce){for(var _e=[],Ie=arguments.length-2;Ie-- >0;)_e[Ie]=arguments[Ie+2];for(var ot=document.createElementNS(Zt.T,Ce),ft=0;ft+1<_e.length;ft+=2)ot.setAttribute(_e[ft],_e[ft+1]);ve.appendChild(ot)}function wn(ve){var Ce=this.k=Math.min(Number(ve.getAttribute(Zt.U))||100,Number(ve.getAttribute(Zt.V))||100);for(this.W=ve;ve.firstChild;)ve.removeChild(ve.firstChild);ve.setAttribute("viewBox","0 0 "+Ce+" "+Ce),ve.setAttribute("preserveAspectRatio","xMidYMid meet")}var dn=wn.prototype;dn.m=function(Ce,_e){_e&&tn(this.W,"rect",Zt.U,"100%",Zt.V,"100%","fill",Ce,"opacity",_e)},dn.S=function(Ce,_e){tn(this.W,"path","fill",Ce,"d",_e)};function rn(){K&&Zn(V)}function Zn(ve,Ce,_e){ln(ve,Ce,_e,function(Ie,ot){if(ot)return ot==F?new bt(new wn(Ie)):new yt(Ie.getContext("2d"))})}function ln(ve,Ce,_e,Ie){if(typeof ve=="string"){if(K)for(var ot=K(ve),ft=0;ft<ot.length;ft++)ln(ot[ft],Ce,_e,Ie);return}var tt=qe(Ce)||Ce!=null&&at(Ce)||qe(ve.getAttribute(Z.t))||ve.hasAttribute(Z.o)&&at(ve.getAttribute(Z.o));if(tt){var Mt=Ie(ve,se(ve));Mt&&Pe(Mt,tt,_e)}}function zn(ve,Ce){return this.each(function(_e,Ie){Zn(Ie,ve,Ce)}),this}var cn=rn;S(cn),cn.configure=M,cn.drawIcon=Dt,cn.toSvg=Wt,cn.update=Zn,cn.updateCanvas=Zn,cn.updateSvg=Zn,cn.version="3.1.1",cn.bundle="browser-umd";var Bn=g.jQuery;Bn&&(Bn.fn.jdenticon=zn);function ei(){var ve=(cn[b.n]||g[b.G]||{}).replaceMode;ve!="never"&&(rn(),ve=="observe"&&z(Zn))}return typeof setTimeout=="function"&&setTimeout(ei,0),cn});const m$2=(function(){const o=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",l={};function u(d,f){if(!l[d]){l[d]={};for(let g=0;g<d.length;g++)l[d][d.charAt(g)]=g}return l[d][f]}const p={compressToBase64:function(d){if(d==null)return"";const f=p._compress(d,6,function(g){return e.charAt(g)});switch(f.length%4){default:case 0:return f;case 1:return f+"===";case 2:return f+"==";case 3:return f+"="}},decompressFromBase64:function(d){return d==null?"":d==""?null:p._decompress(d.length,32,function(f){return u(e,d.charAt(f))})},compressToUTF16:function(d){return d==null?"":p._compress(d,15,function(f){return o(f+32)})+" "},decompressFromUTF16:function(d){return d==null?"":d==""?null:p._decompress(d.length,16384,function(f){return d.charCodeAt(f)-32})},compressToUint8Array:function(d){const f=p.compress(d),g=new Uint8Array(f.length*2);for(let b=0,A=f.length;b<A;b++){const S=f.charCodeAt(b);g[b*2]=S>>>8,g[b*2+1]=S%256}return g},decompressFromUint8Array:function(d){if(d==null)return p.decompress(d);{const f=new Array(d.length/2);for(let b=0,A=f.length;b<A;b++)f[b]=d[b*2]*256+d[b*2+1];const g=[];return f.forEach(function(b){g.push(o(b))}),p.decompress(g.join(""))}},compressToEncodedURIComponent:function(d){return d==null?"":p._compress(d,6,function(f){return a.charAt(f)})},decompressFromEncodedURIComponent:function(d){return d==null?"":d==""?null:(d=d.replace(/ /g,"+"),p._decompress(d.length,32,function(f){return u(a,d.charAt(f))}))},compress:function(d){return p._compress(d,16,function(f){return o(f)})},_compress:function(d,f,g){if(d==null)return"";let b,A;const S={},M={};let E="",F="",$="",Z=2,V=3,K=2;const se=[];let z=0,U=0,ee;for(ee=0;ee<d.length;ee+=1)if(E=d.charAt(ee),Object.prototype.hasOwnProperty.call(S,E)||(S[E]=V++,M[E]=!0),F=$+E,Object.prototype.hasOwnProperty.call(S,F))$=F;else{if(Object.prototype.hasOwnProperty.call(M,$)){if($.charCodeAt(0)<256){for(b=0;b<K;b++)z=z<<1,U==f-1?(U=0,se.push(g(z)),z=0):U++;for(A=$.charCodeAt(0),b=0;b<8;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1}else{for(A=1,b=0;b<K;b++)z=z<<1|A,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=0;for(A=$.charCodeAt(0),b=0;b<16;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1}Z--,Z==0&&(Z=Math.pow(2,K),K++),delete M[$]}else for(A=S[$],b=0;b<K;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1;Z--,Z==0&&(Z=Math.pow(2,K),K++),S[F]=V++,$=String(E)}if($!==""){if(Object.prototype.hasOwnProperty.call(M,$)){if($.charCodeAt(0)<256){for(b=0;b<K;b++)z=z<<1,U==f-1?(U=0,se.push(g(z)),z=0):U++;for(A=$.charCodeAt(0),b=0;b<8;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1}else{for(A=1,b=0;b<K;b++)z=z<<1|A,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=0;for(A=$.charCodeAt(0),b=0;b<16;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1}Z--,Z==0&&(Z=Math.pow(2,K),K++),delete M[$]}else for(A=S[$],b=0;b<K;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1;Z--,Z==0&&(Z=Math.pow(2,K),K++)}for(A=2,b=0;b<K;b++)z=z<<1|A&1,U==f-1?(U=0,se.push(g(z)),z=0):U++,A=A>>1;for(;;)if(z=z<<1,U==f-1){se.push(g(z));break}else U++;return se.join("")},decompress:function(d){return d==null?"":d==""?null:p._decompress(d.length,32768,function(f){return d.charCodeAt(f)})},_decompress:function(d,f,g){const b=[];let A=4,S=4,M=3,E="";const F=[];let $,Z,V,K,se,z,U;const ee={val:g(0),position:f,index:1};for($=0;$<3;$+=1)b[$]=String($);for(V=0,se=Math.pow(2,2),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;switch(V){case 0:for(V=0,se=Math.pow(2,8),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;U=o(V);break;case 1:for(V=0,se=Math.pow(2,16),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;U=o(V);break;case 2:return""}for(b[3]=String(U),Z=String(U),F.push(String(U));;){if(ee.index>d)return"";for(V=0,se=Math.pow(2,M),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;switch(U=V){case 0:for(V=0,se=Math.pow(2,8),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;b[S++]=o(V),U=S-1,A--;break;case 1:for(V=0,se=Math.pow(2,16),z=1;z!=se;)K=ee.val&ee.position,ee.position>>=1,ee.position==0&&(ee.position=f,ee.val=g(ee.index++)),V|=(K>0?1:0)*z,z<<=1;b[S++]=o(V),U=S-1,A--;break;case 2:return F.join("")}if(A==0&&(A=Math.pow(2,M),M++),b[U])E=String(b[U]);else if(U===S)E=Z+Z.charAt(0);else return null;F.push(E),b[S++]=Z+E.charAt(0),A--,Z=E,A==0&&(A=Math.pow(2,M),M++)}}};return p})(),NeedContext$1={};NeedContext$1.created=!1,NeedContext$1.after_show=()=>{},NeedContext$1.after_hide=()=>{},NeedContext$1.min_width="25px",NeedContext$1.min_height="25px",NeedContext$1.back_icon="⬅️",NeedContext$1.back_text="Back",NeedContext$1.clear_text="Clear",NeedContext$1.item_sep="4px",NeedContext$1.layers={},NeedContext$1.level=0,NeedContext$1.gap="0.5rem",NeedContext$1.side_padding="0.5rem",NeedContext$1.compact_padding="0.3rem",NeedContext$1.center_top=20,NeedContext$1.dragging=!1,NeedContext$1.autohide_delay=500,NeedContext$1.autoclick_delay=500,NeedContext$1.autohide_threshold=5,NeedContext$1.set_defaults=()=>{NeedContext$1.open=!1,NeedContext$1.mousedown=!1,NeedContext$1.first_mousedown=!1,NeedContext$1.keydown=!1,NeedContext$1.filtered=!1,NeedContext$1.last_x=0,NeedContext$1.last_y=0,NeedContext$1.layers={},NeedContext$1.mouse_activity={},NeedContext$1.autohide_enabled=!1,NeedContext$1.reset_debouncers()},NeedContext$1.clear_filter=()=>{NeedContext$1.filter.value="",NeedContext$1.do_filter(),NeedContext$1.filter.focus()},NeedContext$1.do_filter=()=>{let o=NeedContext$1.filter.value,e=NeedContext$1.remove_spaces_2(o).toLowerCase(),a=e.includes(":"),l=!1;for(let d of document.querySelectorAll(".needcontext-separator"))e?d.classList.add("needcontext-hidden"):d.classList.remove("needcontext-hidden");for(let d of document.querySelectorAll(".needcontext-text")){let f=d.closest(".needcontext-item"),g=d.textContent.toLowerCase();g=NeedContext$1.remove_spaces(g),a||(g=g.replace(/:/g,"")),g.includes(e)?(f.classList.remove("needcontext-hidden"),l||(NeedContext$1.select_item(parseInt(f.dataset.index)),l=!0)):f.classList.add("needcontext-hidden")}let u=document.querySelector("#needcontext-back"),p=document.querySelector("#needcontext-clear");if(NeedContext$1.filtered=e!=="",NeedContext$1.filtered){let d=document.querySelector("#needcontext-clear-text");d.textContent=o.trim(),p.classList.remove("needcontext-hidden"),u&&u.classList.add("needcontext-hidden")}else p.classList.add("needcontext-hidden"),u&&u.classList.remove("needcontext-hidden");NeedContext$1.scroll_to_selected()},NeedContext$1.def_args=(o,e)=>{for(let a in o)e[a]===void 0&&o[a]!==void 0&&(e[a]=o[a])},NeedContext$1.show=(o={})=>{let e={root:!0,expand:!1,picker_mode:!1,margin:0,compact:!1,autohide:!1,autoclick:!1};if(NeedContext$1.def_args(e,o),!o.items.length)return;if(NeedContext$1.reset_debouncers(),NeedContext$1.created||NeedContext$1.create(),o.e&&o.e.clientX!==void 0&&o.e.clientY!==void 0)o.x=o.e.clientX,o.y=o.e.clientY;else if(o.element){let b=o.element.getBoundingClientRect();o.x=b.left,o.y=b.top+o.margin}o.root&&(NeedContext$1.level=0);let a=o.x===void 0||o.y===void 0;if(o.items=o.items.slice(0),o.index===void 0){let b=o.items.filter(A=>!A.separator);for(let[A,S]of b.entries())if(S.selected){o.index=A;break}}o.index===void 0&&(o.index=0),o.index>=o.items.length&&(o.index=o.items.length-1);let l,u=NeedContext$1.get_layer();u?l=u.last_index:l=o.index,l=l||0;for(let[b,A]of o.items.entries())b===l?A.selected=!0:A.selected=!1;let p=0,d=NeedContext$1.container;if(d.innerHTML="",d.style.left="unset",d.style.top="unset",d.style.transform="unset",d.style.minWidth="unset",d.style.minHeight="unset",o.title&&!o.compact){let b=document.createElement("div");b.id="needcontext-title",o.title_icon&&(document.createElement("div").classList.add("needcontext-title-icon"),b.append(o.title_icon));let A=document.createElement("div");if(A.textContent=o.title.trim(),b.append(A),d.append(b),o.title_number){let S=document.createElement("div");S.classList.add("needcontext-title-number"),b.append(S)}d.classList.add("with_title"),d.classList.remove("without_title")}else d.classList.remove("with_title"),d.classList.add("without_title");o.root||d.append(NeedContext$1.back_button()),d.append(NeedContext$1.clear_button());let f=[];o.compact?d.classList.add("needcontext-compact"):d.classList.remove("needcontext-compact");for(let b of o.items){if(o.compact&&!b.icon)continue;let A=document.createElement("div");if(A.classList.add("needcontext-item"),b.separator)A.classList.add("needcontext-separator");else{if(A.classList.add("needcontext-normal"),b.highlight&&A.classList.add("needcontext-highlight"),b.image){let S=document.createElement("img");S.loading="lazy",S.addEventListener("error",M=>{M.target.classList.add("needcontext-hidden")}),S.classList.add("needcontext-image"),S.src=b.image,A.append(S)}if(b.icon){let S=document.createElement("div");S.classList.add("needcontext-icon"),b.icon_action&&S.addEventListener("click",M=>{b.icon_action(M,S)}),S.append(b.icon),A.append(S)}if(b.text){let S=document.createElement("div");S.classList.add("needcontext-text"),S.textContent=b.text.trim(),A.append(S)}if(o.compact){if(o.compact){let S=[b.text,b.info].filter(Boolean);A.title=S.join(" - ")}}else b.info&&(A.title=b.info.trim());b.bold&&A.classList.add("needcontext-bold"),b.direct_action&&A.addEventListener("click",()=>{b.direct_action(),NeedContext$1.hide()}),A.dataset.index=p,b.index=p,A.addEventListener("mousemove",()=>{let S=parseInt(A.dataset.index);NeedContext$1.index!==S&&NeedContext$1.select_item(S)}),p+=1,f.push(b)}o.on_drag&&(A.draggable=!0),b.element=A,b.picked=!1,d.append(A)}NeedContext$1.layers[NeedContext$1.level]={root:o.root,items:o.items,normal_items:f,last_index:l,x:o.x,y:o.y},NeedContext$1.main.classList.remove("needcontext-hidden"),NeedContext$1.update_title(),a&&(d.style.left="50%",d.style.transform="translateX(-50%)",o.y=NeedContext$1.center_top),o.y<5&&(o.y=5),o.x<5&&(o.x=5);let g=5;if(o.y+d.offsetHeight+5>window.innerHeight){let b=Math.abs(o.y+d.offsetHeight-window.innerHeight);o.y-=b+g}if(o.x+d.offsetWidth+5>window.innerWidth){let b=Math.abs(o.x+d.offsetWidth-window.innerWidth);o.x-=b+g}NeedContext$1.last_x=o.x,NeedContext$1.last_y=o.y,o.x=Math.max(o.x,0),o.y=Math.max(o.y,0),d.style.top=`${o.y}px`,a||(d.style.left=`${o.x}px`,d.style.transform="unset"),NeedContext$1.filter.value="",NeedContext$1.filter.focus(),o.expand&&o.element?d.style.minWidth=`${o.element.clientWidth}px`:d.style.minWidth=NeedContext$1.min_width,d.style.minHeight=NeedContext$1.min_height,NeedContext$1.filter.value="",NeedContext$1.filtered=!1,NeedContext$1.select_item(l),NeedContext$1.scroll_to_selected(),NeedContext$1.open=!0,NeedContext$1.after_show(),o.root&&(NeedContext$1.args=o)},NeedContext$1.hide=o=>{NeedContext$1.open&&(NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.set_defaults(),NeedContext$1.after_hide(),NeedContext$1.args.after_hide&&NeedContext$1.args.after_hide(o))},NeedContext$1.select_item=o=>{let e=Array.from(document.querySelectorAll(".needcontext-normal"));for(let a of e)parseInt(a.dataset.index)===o?a.classList.add("needcontext-item-selected"):a.classList.remove("needcontext-item-selected");NeedContext$1.index=o},NeedContext$1.scroll_to_selected=(o="center")=>{let e=document.querySelector(".needcontext-item-selected");e&&e.scrollIntoView({block:o})},NeedContext$1.select_next=(o="down",e=!1)=>{let a=!1,l,u=NeedContext$1.get_layer().normal_items.slice(0);u=u.filter(p=>!p.removed),o==="up"&&u.reverse();for(let p of u)if(NeedContext$1.is_visible(p.element)){if(l===void 0&&(l=p.index),a){NeedContext$1.select_item(p.index),NeedContext$1.scroll_to_selected("nearest");return}p.index===NeedContext$1.index&&(a=!0)}if(!e)return NeedContext$1.select_item(l),NeedContext$1.scroll_to_selected("nearest"),!0;NeedContext$1.select_next("up")},NeedContext$1.select_action=(o,e=NeedContext$1.index,a="mouse")=>{if(a==="mouse"&&!o.target.closest(".needcontext-normal"))return;let l=NeedContext$1.get_layer().normal_items[e];if(!l)return;let u=NeedContext$1.last_x,p=NeedContext$1.last_y,d=b=>{NeedContext$1.get_layer().last_index=e,NeedContext$1.level+=1,o.clientY&&(p=o.clientY),NeedContext$1.show({x:u,y:p,items:b,root:!1})},f=b=>{b.length===1&&b[0].direct?NeedContext$1.action(b[0],o):d(b)};async function g(){if(l.action){o.shiftKey?l.shift_action&&NeedContext$1.shift_action(l,o):o.ctrlKey?l.ctrl_action&&NeedContext$1.ctrl_action(l,o):o.altKey?l.alt_action&&NeedContext$1.alt_action(l,o):NeedContext$1.action(l,o);return}else if(l.items)f(l.items);else if(l.get_items){let b=await l.get_items();f(b)}}if(a==="keyboard"){g();return}o.button===0?o.shiftKey?l.shift_action&&NeedContext$1.shift_action(l,o):o.ctrlKey?l.ctrl_action&&NeedContext$1.ctrl_action(l,o):o.altKey?l.alt_action&&NeedContext$1.alt_action(l,o):g():o.button===1?l.middle_action&&NeedContext$1.middle_action(l,o):o.button===2&&l.context_action&&NeedContext$1.context_action(l,o)},NeedContext$1.is_visible=o=>!o.classList.contains("needcontext-hidden"),NeedContext$1.remove_spaces=o=>o.replace(/[\s-]+/g,""),NeedContext$1.remove_spaces_2=o=>o.replace(/\s+/g,""),NeedContext$1.init=()=>{let o=document.createElement("style"),e=`
    #needcontext-main {
      position: fixed;
      z-index: 999999999;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }

    .needcontext-hidden {
      display: none !important;
    }

    #needcontext-container {
      z-index: 2;
      position: absolute;
      background-color: white;
      color: black;
      font-size: 16px;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      user-select: none;
      border: 1px solid #2B2F39;
      border-radius: 5px;
      padding-bottom: 5px;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: hidden;
      text-align: left;
      max-width: 98%;
    }

    #needcontext-container.needcontext-compact {
      flex-direction: row;
      flex-wrap: wrap;
      padding-left: ${NeedContext$1.compact_padding};
      padding-right: ${NeedContext$1.compact_padding};
    }

    .needcontext-compact .needcontext-text {
      display: none;
    }

    .needcontext-compact .needcontext-separator {
      display: none;
    }

    #needcontext-container.without_title {
      padding-top: 5px;
    }

    #needcontext-title {
      font-weight: bold;
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      background-color: rgba(67, 220, 255, 0.47);
      padding-top: 4px;
      padding-bottom: 4px;
      margin-bottom: 2px;
      display: flex;
      flex-direction: row;
      gap: ${NeedContext$1.gap};
      align-items: center;
      justify-content: flex-start;
    }

    #needcontext-filter {
      opacity: 0;
    }

    .needcontext-item {
      white-space: nowrap;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
    }

    .needcontext-normal {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      cursor: pointer;
    }

    .needcontext-highlight {
      border: 1px solid currentColor !important;
      border-radius: 10px;
    }

    .needcontext-picked .needcontext-text {
      text-decoration: line-through;
      opacity: 0.7;
    }

    .needcontext-button {
      padding-left: ${NeedContext$1.side_padding};
      padding-right: ${NeedContext$1.side_padding};
      padding-top: ${NeedContext$1.item_sep};
      padding-bottom: ${NeedContext$1.item_sep};
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: ${NeedContext$1.gap};
      cursor: pointer;
    }

    .needcontext-button:hover {
      text-shadow: 0 0 1rem currentColor;
    }

    .needcontext-separator {
      border-top: 1px solid currentColor;
      margin-left: ${NeedContext$1.side_padding};
      margin-right: ${NeedContext$1.side_padding};
      margin-top: ${NeedContext$1.item_sep};
      margin-bottom: ${NeedContext$1.item_sep};
      opacity: 0.7;
    }

    .needcontext-item-selected {
      background-color: rgba(0, 0, 0, 0.18);
    }

    .needcontext-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .needcontext-image {
      width: 1.11rem;
      height: 1.11rem;
      object-fit: contain;
      margin-right: 0.1rem;
    }

    .needcontext-bold {
      font-weight: bold;
    }
  `;o.innerText=e,document.head.appendChild(o),document.addEventListener("mousedown",a=>{!NeedContext$1.open||!a.target||(NeedContext$1.first_mousedown=!0,a.target.closest("#needcontext-container")&&(NeedContext$1.mousedown=!0))}),document.addEventListener("mouseup",a=>{!NeedContext$1.open||!a.target||(a.target.closest("#needcontext-container")?a.target.closest(".needcontext-back")?a.button===0&&NeedContext$1.go_back():a.target.closest(".needcontext-clear")?a.button===0&&NeedContext$1.clear_filter():NeedContext$1.mousedown&&NeedContext$1.select_action(a):NeedContext$1.first_mousedown&&NeedContext$1.dismiss(a),NeedContext$1.mousedown=!1)}),document.addEventListener("mousemove",a=>{!NeedContext$1.open||!a.target||(NeedContext$1.check_mouse_range(a),NeedContext$1.check_auto_funcs(a))}),document.addEventListener("mouseover",a=>{!NeedContext$1.open||!a.target||(NeedContext$1.check_mouse_range(a),NeedContext$1.check_auto_funcs(a))}),document.documentElement.addEventListener("mouseleave",a=>{NeedContext$1.open&&NeedContext$1.args.autohide&&NeedContext$1.autohide_debouncer.call_2(a)}),document.addEventListener("keydown",a=>{NeedContext$1.open&&(NeedContext$1.keydown=!0,["ArrowUp","ArrowLeft"].includes(a.key)?(NeedContext$1.select_next("up"),a.preventDefault()):["ArrowDown","ArrowRight"].includes(a.key)?(NeedContext$1.select_next(),a.preventDefault()):a.key==="Backspace"&&(NeedContext$1.filtered||(NeedContext$1.go_back(),a.preventDefault())))}),document.addEventListener("keyup",a=>{NeedContext$1.open&&NeedContext$1.keydown&&(NeedContext$1.keydown=!1,a.key==="Escape"?(NeedContext$1.dismiss(a),a.preventDefault()):a.key==="Enter"&&(NeedContext$1.select_action(a,void 0,"keyboard"),a.preventDefault()))}),NeedContext$1.start_autohide(),NeedContext$1.start_autoclick(),NeedContext$1.set_defaults()},NeedContext$1.create=()=>{NeedContext$1.main=document.createElement("div"),NeedContext$1.main.id="needcontext-main",NeedContext$1.main.classList.add("needcontext-hidden"),NeedContext$1.container=document.createElement("div"),NeedContext$1.container.id="needcontext-container",NeedContext$1.filter=document.createElement("input"),NeedContext$1.filter.id="needcontext-filter",NeedContext$1.filter.type="text",NeedContext$1.filter.autocomplete="off",NeedContext$1.filter.spellcheck=!1,NeedContext$1.filter.placeholder="Filter",NeedContext$1.filter.addEventListener("input",o=>{NeedContext$1.do_filter()}),NeedContext$1.main.addEventListener("contextmenu",o=>{o.preventDefault()}),NeedContext$1.container.addEventListener("dragstart",o=>{NeedContext$1.dragging=!0,NeedContext$1.dragstart_action(o)}),NeedContext$1.container.addEventListener("dragenter",o=>{NeedContext$1.dragenter_action(o)}),NeedContext$1.container.addEventListener("dragend",o=>{NeedContext$1.dragging=!1,NeedContext$1.dragend_action(o)}),NeedContext$1.main.append(NeedContext$1.filter),NeedContext$1.main.append(NeedContext$1.container),document.body.appendChild(NeedContext$1.main),NeedContext$1.created=!0},NeedContext$1.dragstart_action=o=>{NeedContext$1.dragged_item=o.target;let e=NeedContext$1.container,a=Array.from(e.querySelectorAll(".needcontext-item"));NeedContext$1.dragged_index=a.indexOf(o.target)},NeedContext$1.dragenter_action=o=>{let e=NeedContext$1.dragged_item;if(e===o.target)return;let a=NeedContext$1.container,l=Array.from(a.querySelectorAll(".needcontext-item")),u=l.indexOf(e),p=l.indexOf(o.target);if(u<0||p<0)return;u<p?a.insertBefore(e,o.target.nextSibling):a.insertBefore(e,o.target),l=Array.from(a.querySelectorAll(".needcontext-item"));let d=l.indexOf(e),f=l.indexOf(o.target);e.dataset.index=d,o.target.dataset.index=f,NeedContext$1.select_item(d)},NeedContext$1.dragend_action=o=>{let e=NeedContext$1.container,a=NeedContext$1.dragged_item,u=Array.from(e.querySelectorAll(".needcontext-item")).indexOf(a);NeedContext$1.hide(o),NeedContext$1.args.on_drag(NeedContext$1.dragged_index,u)},NeedContext$1.get_layer=()=>NeedContext$1.layers[NeedContext$1.level],NeedContext$1.prev_layer=()=>NeedContext$1.layers[NeedContext$1.level-1],NeedContext$1.go_back=()=>{if(NeedContext$1.level===0)return;let o=NeedContext$1.prev_layer();NeedContext$1.level-=1;let e={x:o.x,y:o.y,items:o.items,root:o.root};e.compact=NeedContext$1.args.compact,e.autohide=NeedContext$1.args.autohide,e.autoclick=NeedContext$1.args.autoclick,NeedContext$1.show(e)},NeedContext$1.back_button=()=>{let o=document.createElement("div");o.id="needcontext-back",o.classList.add("needcontext-back"),o.classList.add("needcontext-button");let e=document.createElement("div");e.append(NeedContext$1.back_icon);let a=document.createElement("div");return a.textContent=NeedContext$1.back_text.trim(),o.append(e),o.append(a),o.title="Shortcut: Backspace",o},NeedContext$1.clear_button=()=>{let o=document.createElement("div");o.id="needcontext-clear",o.classList.add("needcontext-clear"),o.classList.add("needcontext-button"),o.classList.add("needcontext-hidden");let e=document.createElement("div");e.append(NeedContext$1.back_icon);let a=document.createElement("div");return a.id="needcontext-clear-text",a.textContent=NeedContext$1.clear_text.trim(),o.append(e),o.append(a),o.title="Type to filter. Click to clear",o},NeedContext$1.action=(o,e)=>{if(o.element&&(!NeedContext$1.is_visible(o.element)||e.target.closest(".needcontext-icon")&&o.icon_action))return;let a=NeedContext$1.args,l=NeedContext$1.args.after_action;if(a.picker_mode){o.element.classList.add("needcontext-picked"),NeedContext$1.filter.focus(),o.picked=!0;let u=!0;for(let p of a.items)if(!p.picked){u=!1;break}u&&NeedContext$1.hide(e)}else NeedContext$1.hide(e);o.action(e),l&&l(e)},NeedContext$1.dismiss=o=>{NeedContext$1.args.after_dismiss&&NeedContext$1.args.after_dismiss(o),NeedContext$1.hide(o)},NeedContext$1.shift_action=(o,e)=>{o.element&&!NeedContext$1.is_visible(o.element)||(NeedContext$1.args.after_shift_action&&NeedContext$1.args.after_shift_action(e),NeedContext$1.hide(e),o.shift_action(e))},NeedContext$1.ctrl_action=(o,e)=>{o.element&&!NeedContext$1.is_visible(o.element)||(NeedContext$1.args.after_ctrl_action&&NeedContext$1.args.after_ctrl_action(e),NeedContext$1.hide(e),o.ctrl_action(e))},NeedContext$1.alt_action=(o,e)=>{o.element&&!NeedContext$1.is_visible(o.element)||(NeedContext$1.args.after_alt_action&&NeedContext$1.args.after_alt_action(e),NeedContext$1.hide(e),o.alt_action(e))},NeedContext$1.middle_action=(o,e)=>{o.element&&!NeedContext$1.is_visible(o.element)||(NeedContext$1.args.after_middle_action&&NeedContext$1.args.after_middle_action(e),NeedContext$1.args.middle_action_remove?NeedContext$1.remove_item(o):NeedContext$1.hide(e),o.middle_action(e))},NeedContext$1.context_action=(o,e)=>{o.element&&!NeedContext$1.is_visible(o.element)||(NeedContext$1.args.after_context_action&&NeedContext$1.args.after_context_action(e),NeedContext$1.hide(e),o.context_action(e))},NeedContext$1.remove_item=o=>{NeedContext$1.select_next("down",!0),o.removed=!0,o.element.remove(),NeedContext$1.update_title()},NeedContext$1.update_title=()=>{let o=document.querySelector("#needcontext-title");if(!o)return;let e=o.querySelector(".needcontext-title-number");if(!e)return;let a=NeedContext$1.count_items();e.textContent=`(${a})`},NeedContext$1.count_items=()=>{let o=NeedContext$1.get_layer().normal_items;return o=o.filter(e=>!e.removed),o=o.filter(e=>!e.fake),o.length},NeedContext$1.create_debouncer=(o,e)=>{let a,l={};function u(){clearTimeout(a),a=void 0}function p(...d){o(...d)}return l.call=(...d)=>{u(),a=setTimeout(()=>{p(...d)},e)},l.call_2=(...d)=>{a||l.call(d)},l.now=(...d)=>{u(),p(...d)},l.cancel=()=>{u()},l},NeedContext$1.reset_debouncers=()=>{NeedContext$1.autohide_debouncer.cancel(),NeedContext$1.autoclick_debouncer.cancel()},NeedContext$1.check_auto_funcs=o=>{if(!NeedContext$1.open||!o.target)return;let e=o.target.id==="needcontext-main";if(e||NeedContext$1.reset_debouncers(),NeedContext$1.args.autohide&&e&&NeedContext$1.autohide_enabled&&NeedContext$1.autohide_debouncer.call_2(o),NeedContext$1.args.autoclick){let a=o.target.closest(".needcontext-item");a||(a=o.target.closest(".needcontext-back")),a&&NeedContext$1.autoclick_debouncer.call(a,o)}},NeedContext$1.check_mouse_range=o=>{if(NeedContext$1.autohide_enabled||o.target.id!=="needcontext-main")return;let e=o.clientX,a=o.clientY;if(NeedContext$1.mouse_activity.initial_x===void 0){NeedContext$1.mouse_activity.initial_x=e,NeedContext$1.mouse_activity.initial_y=a;return}let l=NeedContext$1.container.getBoundingClientRect();function u(p){let d=p>NeedContext$1.autohide_threshold;return d&&(NeedContext$1.autohide_enabled=!0),d}if(a<l.top&&a<NeedContext$1.mouse_activity.initial_y&&a<l.top){let p=l.top-a;if(u(p))return}if(a>l.bottom&&a>NeedContext$1.mouse_activity.initial_y&&a>l.bottom){let p=a-l.bottom;if(u(p))return}if(e<l.left&&e<NeedContext$1.mouse_activity.initial_x&&e<l.left){let p=l.left-e;if(u(p))return}if(e>l.right&&e>NeedContext$1.mouse_activity.initial_x&&e>l.right){let p=e-l.right;if(u(p))return}},NeedContext$1.start_autohide=o=>{NeedContext$1.autohide_debouncer=NeedContext$1.create_debouncer(e=>{NeedContext$1.hide(e)},o||NeedContext$1.autohide_delay)},NeedContext$1.start_autoclick=o=>{NeedContext$1.autoclick_debouncer=NeedContext$1.create_debouncer((e,a)=>{e.closest(".needcontext-item")?NeedContext$1.select_action(a):e.closest(".needcontext-back")&&NeedContext$1.go_back()},o||NeedContext$1.autoclick_delay)},typeof window<"u"&&(window.NeedContext=NeedContext$1),App.create_about_modal=()=>{let o=App.create_modal("about"),e=DOM.el(".modal-header",o),a=DOM.create("img","","modal-about-image");a.src="/img/slide.png",e.prepend(a);let l=DOM.el(".modal-title",o),u=`v${App.config.version}`;l.textContent=`Slide | ${u} | Merkoba | 2025 | ${App.commit_hash}`,l.id="modal-title-about",l.title="Name | Version | Company | Year | Commit Hash";let p=DOM.el(".modal-body",o);p.id="modal-body-about",p.innerHTML=`
    <div class="about-item">Slide is a music player that uses <a target=_blank class="popup" href="https://strudel.cc">strudel</a> code.</div>
    <div class="about-item">It's meant to allow automatic & seamless code updates.</div>
    <div class="about-item">There's a song picker to play elaborate tunes.</div>
    <div class="about-item">The code can be edited in real time and applied with Play.</div>
    <hr>
    <div class="about-item">The scope visualizer can be clicked in the left/center/right.</div>
    <div class="about-item">Clicking the scope produces a tone and a reverb affect.</div>
    <div class="about-item">Clicking the scope on the left produces left panning.</div>
    <div class="about-item">Clicking the scope on the right produces right panning.</div>
    <div class="about-item">A straight line to the left changes the visual.</div>
    <div class="about-item">A straight line to the right changes the theme.</div>
    <div class="about-item">Try drawing a triangle.</div>
    <div class="about-item">Try drawing a rectangle.</div>
    <div class="about-item">Try drawing a circle.</div>
    <div class="about-item">Try drawing a plus sign.</div>
    <div class="about-item">Try drawing many stars.</div>
    <hr>
    <div class="about-item">Ctrl+s = Starts playback / Updates code.</div>
    <div class="about-item">Ctrl+1 = Show the sound context.</div>
    <div class="about-item">Ctrl+2 = Show the note context.</div>
    <div class="about-item">Ctrl+3 = Show the bank context.</div>
    <div class="about-item">Escape = Closes top modal or stops playback.</div>
  `},App.show_about=()=>{App.open_modal("about")},App.create_alert_modal=()=>{let o=App.create_modal("alert"),e=DOM.el(".modal-title",o);e.id="modal-title-alert";let a=DOM.el(".modal-body",o);a.id="modal-body-alert";let l=DOM.create("div","","modal-message-alert"),u=DOM.create("button");u.textContent="Copy",DOM.ev(u,"click",()=>{App.copy_alert()});let p=DOM.create("div","modal-buttons");p.appendChild(u),a.appendChild(l),a.appendChild(p)},App.show_alert=(o,e="Message")=>{App.check_create_modal("alert"),DOM.el("#modal-title-alert").textContent=e,DOM.el("#modal-message-alert").textContent=o,App.open_modal("alert")},App.copy_alert=()=>{let o=DOM.el("#modal-message-alert").textContent;navigator.clipboard.writeText(o),App.close_modal("alert")},App.beep_sound=()=>{try{let o=App.get_audio_context(),e=o.createOscillator(),a=o.createGain();e.type="triangle",e.frequency.setValueAtTime(440,o.currentTime),e.frequency.linearRampToValueAtTime(445,o.currentTime+.1),a.gain.setValueAtTime(.05,o.currentTime),a.gain.exponentialRampToValueAtTime(.001,o.currentTime+.2),e.connect(a),a.connect(o.destination),e.start(),e.stop(o.currentTime+.2)}catch(o){console.error("Failed to play sound",o)}},App.get_audio_context=()=>{if(window.master_fx&&window.master_fx.context)return window.master_fx.context;if(App.audio_context)return App.audio_context;try{return App.audio_context=new(AudioContext||window.webkitAudioContext),App.audio_context}catch{return console.error("Web Audio API is not supported"),null}},App.splash_reverb=o=>{!window.master_fx||App.reverb_enabled||window.master_fx.splash_reverb(o)},App.set_panning=(o,e=0)=>{if(window.master_fx&&(window.master_fx.set_panning(o),e>0)){clearInterval(App.panning_interval);let a=o/(e*1e3/50),l=o;App.panning_interval=setInterval(()=>{l-=a,Math.abs(l)<=Math.abs(a)?(window.master_fx.set_panning(0),clearInterval(App.panning_interval)):window.master_fx.set_panning(l)},50)}},App.get_panning=()=>App.panning.pan.value,App.set_gain=o=>{window.master_fx&&window.master_fx.set_volume(o)},App.get_gain=()=>{if(window.master_fx)return window.master_fx.get_volume()},App.set_eq=(o,e,a)=>{App.eq={low:o,mid:e,high:a},App.stor_save_eq(),window.master_fx&&window.master_fx.set_eq(o,e,a)},App.update_eq=()=>{App.eq&&window.master_fx&&window.master_fx.set_eq(App.eq.low,App.eq.mid,App.eq.high)},App.start_auto_pan=(o=2,e=.8)=>{window.master_fx&&window.master_fx.set_auto_pan(o,e)},App.stop_auto_pan=()=>{window.master_fx&&window.master_fx.set_auto_pan(0,0)},App.spin_panning=(o=2e3)=>{!window.master_fx||App.panning_enabled||(App.start_auto_pan(4,1),setTimeout(()=>{App.stop_auto_pan()},o))},App.update_reverb=()=>{window.master_fx&&window.master_fx.toggle_reverb(App.reverb_enabled)},App.update_cutoff=()=>{window.master_fx&&window.master_fx.toggle_cutoff(App.cutoff_enabled)},App.update_delay=()=>{window.master_fx&&window.master_fx.toggle_delay(App.delay_enabled)},App.update_panning=()=>{window.master_fx&&(App.panning_enabled?App.start_auto_pan(4,1):App.stop_auto_pan())},App.suspend_audio=async()=>{let o=App.get_audio_context();o&&o.state==="running"&&await o.suspend()},App.resume_audio=async()=>{let o=App.get_audio_context();o&&o.state!=="running"&&await o.resume()},App.auto_delay=5,App.auto_endpoint="/status",App.fetch_cancelled=!1,App.auto_started=!1,App.setup_auto=()=>{let o=DOM.el("#auto-start");o&&DOM.ev(o,"click",()=>{App.auto_endpoint=DOM.el("#auto-input").value,App.start_auto()});let e=DOM.el("#auto-stop");e&&DOM.ev(e,"click",()=>{App.stop_auto()});let a=DOM.el("#auto-default");a&&DOM.ev(a,"click",()=>{App.auto_endpoint="/status",App.start_auto()});let l=DOM.el("#auto-input");l&&DOM.ev(l,"keydown",p=>{p.key==="Enter"&&(p.preventDefault(),App.auto_endpoint=DOM.el("#auto-input").value,App.start_auto())});let u=DOM.el("#auto-delay");u&&DOM.ev(u,"change",p=>{App.auto_delay=parseInt(p.target.value,10),App.stop_auto(),App.start_auto()})},App.create_auto_modal=()=>{let o=App.create_modal("auto"),e=DOM.el(".modal-title",o);e.textContent="Auto Mode";let a=DOM.el(".modal-body",o);a.id="modal-body-auto";let l=DOM.create("div","","auto-info");l.textContent="Code will be fetched periodically";let u=DOM.create("select","modal-select","auto-delay");u.innerHTML=`
    <option value="1">1 second</option>
    <option value="5" selected>5 seconds</option>
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300">5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="1200">20 minutes</option>
  `;let p=DOM.create("input","","auto-input");p.classList.add("modal-input"),p.placeholder="Endpoint URL";let d=DOM.create("div","modal-buttons","auto-buttons");d.innerHTML=`
    <button id="auto-default">Default</button>
    <button id="auto-stop">Stop</button>
    <button id="auto-start">Start</button>
  `,a.appendChild(l),a.appendChild(u),a.appendChild(p),a.appendChild(d),App.setup_auto()},App.show_auto=()=>{App.open_modal("auto"),DOM.el("#auto-delay").value=App.auto_delay,DOM.el("#auto-input").value=App.auto_endpoint,App.fetch_timer?(DOM.hide("#auto-start"),DOM.show("#auto-stop")):(DOM.show("#auto-start"),DOM.hide("#auto-stop"))},App.start_auto=async()=>{App.auto_started||(App.close_modal("auto"),App.first_auto=!0,App.stor_save_auto_endpoint(),App.fetch_status(),App.auto_started=!0,App.check_auto())},App.fetch_status_code=async()=>{const o=await fetch(App.auto_endpoint,{cache:"no-store"});if(!o.ok)throw new Error(`Status endpoint returned ${o.status}`);let e=await o.json();return App.beat_title=e.title,e.code},App.fetch_status=()=>{if(!App.auto_delay||App.auto_delay<=0){console.error("Provide a fetch interval in seconds greater than zero");return}App.fetch_cancelled=!1;let o=App.auto_delay*1e3,e=async()=>{if(console.info("🤖 Fetching auto code"),!App.fetch_in_flight){App.fetch_in_flight=!0;try{let a=await App.fetch_status_code();if(App.fetch_cancelled){console.info("Status watch was cancelled, skipping play action");return}if(!a||(a=a.trim(),!a))return;let l=App.first_auto;App.first_auto=!1,await App.play_action(a,{fresh:l})}catch(a){console.error("Failed to update Strudel status",a)}finally{App.fetch_in_flight=!1}}};App.stop_auto(!1),e(),App.fetch_timer=setInterval(()=>{e()},o),console.info("Interval started.")},App.stop_auto=(o=!0)=>{App.close_modal("auto"),App.auto_started&&(console.info("Interval cleared 🖐"),clearInterval(App.fetch_timer),App.fetch_timer=void 0,o&&(App.fetch_cancelled=!0),App.auto_started=!1,App.check_auto())},App.check_auto=()=>{let o=DOM.el("#btn-auto");App.auto_started?o.classList.add("active"):o.classList.remove("active")},App.toggle_auto=()=>{App.auto_started?App.stop_auto():App.start_auto()},App.strudel_banks=["AJKPercusyn","AkaiLinn","AkaiMPC60","AkaiXR10","AlesisHR16","AlesisSR16","BossDR110","BossDR220","BossDR55","BossDR550","CasioRZ1","CasioSK1","CasioVL1","DoepferMS404","EmuDrumulator","EmuSP12","KorgDDM110","KorgKPR77","KorgKR55","KorgKRZ","KorgM1","KorgMinipops","KorgPoly800","KorgT3","Linn9000","LinnLM1","LinnLM2","MoogConcertMateMG1","OberheimDMX","RhodesPolaris","RhythmAce","RolandCompurhythm1000","RolandCompurhythm78","RolandCompurhythm8000","RolandD110","RolandD70","RolandDDR30","RolandJD990","RolandMC202","RolandMC303","RolandMT32","RolandR8","RolandS50","RolandSH09","RolandSystem100","RolandTR505","RolandTR606","RolandTR626","RolandTR707","RolandTR727","RolandTR808","RolandTR909","SakataDPM48","SequentialCircuitsDrumtracks","SequentialCircuitsTom","SimmonsSDS400","SimmonsSDS5","SoundmastersR88","UnivoxMicroRhythmer12","ViscoSpaceDrum","XdrumLM8953","YamahaRM50","YamahaRX21","YamahaRX5","YamahaRY30","YamahaTG33"],App.new_beat=()=>{App.show_confirm({title:"New Beat",message:"Write a beat from scratch?",ok_action:()=>{App.last_code="",App.current_song="",App.beat_title="",App.set_input(""),App.stop_action(),App.focus_input()}})},App.ask_for_title=()=>{App.show_prompt({title:"Beat Title",placeholder:"Title of the beat",value:App.beat_title,action:o=>{o||(o=""),o=App.remove_multiple_spaces(o).trim(),App.beat_title=o,App.update_url(),App.update_title(),App.playing()}})},App.create_collections_modal=()=>{let o=App.create_list_modal("collections"),e=DOM.el(".modal-title",o);e.textContent="Collections"},App.show_collections=async()=>{let o=[{text:"Songs",action:()=>{App.show_songs()},title:"View the songs collection"},{text:"Snapshots",action:()=>{App.show_snapshots()},title:"View the snapshots collection"}];App.show_items_modal("collections",{items:o,action:e=>{App.close_modal("collections"),e.action()}})},App.colors_enabled=!0,App.border_color="#444",App.apply_color=o=>{App.scope_color=o,App.set_css_var("theme-color",o)},App.color_interface=o=>{let e=App[`scope_click_color_${o}`];App.do_color_interface(e)},App.restore_interface_colors=()=>{App.do_color_interface(App.border_color)},App.do_color_interface=o=>{App.set_css_var("border-color",o)},App.create_confirm_modal=()=>{let o=App.create_modal("confirm"),e=DOM.el(".modal-title",o);e.id="modal-title-confirm";let a=DOM.el(".modal-body",o);a.id="modal-body-confirm";let l=DOM.create("div","","modal-message-confirm"),u=DOM.create("div","modal-buttons"),p=DOM.create("button","modal-button","modal-button-confirm");p.textContent="Cancel";let d=DOM.create("button","modal-button","modal-button-confirm");d.textContent="Ok",DOM.ev(p,"click",()=>{App.do_confirm_cancel_action()}),DOM.ev(d,"click",()=>{App.do_confirm_ok_action()}),u.appendChild(p),u.appendChild(d),a.appendChild(l),a.appendChild(u)},App.show_confirm=(o={})=>{let e={title:"Confirm",message:"",cancel_action:()=>{},ok_action:()=>{}};App.def_args(e,o),App.check_create_modal("confirm");let a=DOM.el("#modal-title-confirm");a.textContent=o.title,App.confirm_ok_action=o.ok_action,App.confirm_cancel_action=o.cancel_action;let l=DOM.el("#modal-message-confirm");l.textContent=o.message,o.message?l.classList.add("modal-text-filled"):l.classList.remove("modal-text-filled"),App.open_modal("confirm")},App.do_confirm_cancel_action=()=>{App.confirm_cancel_action&&(App.close_modal("confirm"),App.confirm_cancel_action())},App.do_confirm_ok_action=()=>{App.confirm_ok_action&&(App.close_modal("confirm"),App.confirm_ok_action())},NeedContext.init(),NeedContext.after_hide=()=>{App.focus_input()},App.show_generic_context=(o,e,a)=>{let l=o.map(u=>({text:u,action:()=>{App.add_text_to_input(u)}}));App.show_context(l,a,e)},App.show_sounds_context=o=>{App.show_generic_context(App.strudel_sounds,"Sounds",o)},App.show_notes_context=o=>{App.show_generic_context(App.strudel_notes,"Notes",o)},App.show_banks_context=o=>{App.show_generic_context(App.strudel_banks,"Banks",o)},App.show_context=(o,e,a)=>{let l={items:o,title:a};e&&(l.x=e.x,l.y=e.y),NeedContext.show(l)},App.eq_range_min=-12,App.eq_range_max=12,App.setup_effects=()=>{App.reset_effects(),App.setup_eq(),App.setup_reverb(),App.setup_cutoff(),App.setup_delay(),App.setup_panning(),App.check_effects(),App.check_effects_container()},App.check_eq_color=o=>{let e=parseInt(o.value);o.classList.remove("eq_negative"),o.classList.remove("eq_positive"),e<0?o.classList.add("eq_negative"):e>0&&o.classList.add("eq_positive")},App.check_eq_colors=()=>{App.check_eq_color(DOM.el("#eq-low")),App.check_eq_color(DOM.el("#eq-mid")),App.check_eq_color(DOM.el("#eq-high"))},App.setup_eq=()=>{let o=DOM.el("#eq-low"),e=DOM.el("#eq-mid"),a=DOM.el("#eq-high");App.eq&&(o.value=App.eq.low||0,e.value=App.eq.mid||0,a.value=App.eq.high||0);function l(){let f=parseInt(o.value),g=parseInt(e.value),b=parseInt(a.value);App.set_eq(f,g,b)}function u(f,g){let b=parseInt(f.value);f.value=Math.min(App.eq_range_max,b+g),App.check_eq_color(f),App.after_effect(),l()}function p(f,g){let b=parseInt(f.value);f.value=Math.max(App.eq_range_min,b-g),App.check_eq_color(f),App.after_effect(),l()}function d(f){let g=f.closest(".custom-number");DOM.ev(f,"change",()=>{let b=parseInt(f.value);b<App.eq_range_min?f.value=App.eq_range_min:b>App.eq_range_max&&(f.value=App.eq_range_max),App.check_eq_color(f),l(),App.after_effect()}),DOM.ev(g,"mousedown",b=>{b.button===1&&(f.value=0,App.check_eq_color(f),l(),f.blur(),b.preventDefault())}),DOM.ev(g,"wheel",b=>{let A=1;b.deltaY<0?(b.shiftKey&&(A=2),u(f,A)):b.deltaY>0&&(b.shiftKey&&(A=2),p(f,A)),b.preventDefault()}),App.check_eq_color(f)}d(o),d(e),d(a)},App.check_eq=()=>{DOM.el("#eq-low").value=App.eq.low,DOM.el("#eq-mid").value=App.eq.mid,DOM.el("#eq-high").value=App.eq.high,App.check_eq_colors()},App.setup_reverb=()=>{let o=DOM.el("#reverb");DOM.ev(o,"click",()=>{App.toggle_reverb()}),App.check_reverb(),App.after_effect()},App.setup_cutoff=()=>{let o=DOM.el("#cutoff");DOM.ev(o,"click",()=>{App.toggle_cutoff()}),App.check_cutoff(),App.after_effect()},App.setup_delay=()=>{let o=DOM.el("#delay");DOM.ev(o,"click",()=>{App.toggle_delay()}),App.check_delay(),App.after_effect()},App.setup_panning=()=>{let o=DOM.el("#panning");DOM.ev(o,"click",()=>{App.toggle_panning()}),App.check_panning(),App.after_effect()},App.enable_effects=()=>{DOM.show(App.get_effects())},App.disable_effects=()=>{DOM.hide(App.get_effects())},App.check_effects_container=()=>{App.effects_enabled?App.enable_effects():App.disable_effects()},App.toggle_effects=()=>{App.effects_enabled=!App.effects_enabled,App.check_effects_container(),App.stor_save_effects()},App.get_effects=()=>DOM.el("#effects"),App.toggle_reverb=()=>{App.reverb_enabled=!App.reverb_enabled,App.check_reverb(),App.stor_save_reverb()},App.check_reverb=()=>{let o=DOM.el("#reverb");App.reverb_enabled?o.classList.add("active"):o.classList.remove("active"),App.update_reverb()},App.toggle_panning=()=>{App.panning_enabled=!App.panning_enabled,App.check_panning(),App.stor_save_panning()},App.check_panning=()=>{let o=DOM.el("#panning");App.panning_enabled?o.classList.add("active"):o.classList.remove("active"),App.update_panning()},App.update_effects=()=>{App.update_eq(),App.update_reverb(),App.update_panning(),App.update_cutoff(),App.update_delay()},App.toggle_cutoff=()=>{App.cutoff_enabled=!App.cutoff_enabled,App.check_cutoff(),App.stor_save_cutoff()},App.check_cutoff=()=>{let o=DOM.el("#cutoff");App.cutoff_enabled?o.classList.add("active"):o.classList.remove("active"),App.update_cutoff()},App.toggle_delay=()=>{App.delay_enabled=!App.delay_enabled,App.check_delay(),App.stor_save_delay()},App.check_delay=()=>{let o=DOM.el("#delay");App.delay_enabled?o.classList.add("active"):o.classList.remove("active"),App.update_delay()},App.save_effects=()=>{App.stor_save_eq(),App.stor_save_reverb(),App.stor_save_panning(),App.stor_save_cutoff(),App.stor_save_delay()},App.check_effects=()=>{App.check_eq(),App.check_reverb(),App.check_panning(),App.check_cutoff(),App.check_delay()},App.after_effect=()=>{},App.reset_effects=()=>{App.eq={low:0,mid:0,high:0},App.reverb_enabled=!1,App.panning_enabled=!1,App.cutoff_enabled=!1,App.delay_enabled=!1},App.filter_code=o=>(o=o.replace(/\n\s*\n\s*\n+/g,`

`),o.trim()),App.max_scope_slide_y_dff=50,App.scope_panning_zone=100,App.scope_panning_amount=.9,App.scope_slide_distance=180,App.scope_slide_delay=800,App.many_clicks_amount=100,App.gesture_actions=()=>{App.canvas_effect_1()},App.get_gesture_clicks=(o=!1)=>{let e=App.get_scope_clicks(o);return App.gesture_scope_clicks=e,e},App.check_gestures=()=>{let o=App.get_gesture_clicks(!0),e=o.length;if(Date.now()-App.scope_mousedown_date<=App.scope_slide_delay&&App.check_scope_slide())return;let a=e>=5;if(a&&App.triangle_gesture(o.slice(0))){App.gesture_function(2,()=>{App.gesture_actions()});return}else if(a&&App.square_gesture(o.slice(0))){App.gesture_function(3,()=>{App.gesture_actions()});return}else if(a&&App.circle_gesture(o.slice(0))){App.gesture_function(4,()=>{App.gesture_actions()});return}else if(a&&App.plus_gesture(o.slice(0))){App.gesture_function(5,()=>{App.gesture_actions()});return}if(o=App.get_gesture_clicks(),e=o.length,e>=App.many_clicks_amount){App.gesture_function(6,()=>{App.gesture_actions()});return}if(Date.now()-App.scope_mousedown_date<=App.scope_beep_delay){if(App.check_scope_panning())return;App.splash_reverb(2)}},App.check_scope_slide=()=>{let o=App.mouse_down_coords,e=App.mouse_up_coords;if(!(Math.abs(App.scope_max_y-App.scope_min_y)>=App.max_scope_slide_y_dff))return Math.abs(o.x-e.x)>=App.scope_slide_distance?(o.x<e.x?App.on_slide_right():App.on_slide_left(),App.clear_scope_clicks(),!0):!1},App.check_scope_panning=()=>{let o=App.mouse_down_coords,e=App.mouse_up_coords,{width:a,height:l}=App.get_scope_dimensions(),u=App.scope_panning_zone,p=App.scope_panning_amount;return o.x<=u||e.x<=u?(App.set_panning(-p,3),!0):o.x>=a-u||e.x>=a-u?(App.set_panning(p,3),!0):!1},App.circle_gesture=o=>{let e=o.length,a=1/0,l=-1/0,u=1/0,p=-1/0,d=0,f=0;for(let ae=0;ae<e;ae++){let de=o[ae];de.x<a&&(a=de.x),de.x>l&&(l=de.x),de.y<u&&(u=de.y),de.y>p&&(p=de.y),d+=de.x,f+=de.y}let g=Math.hypot(l-a,p-u),b=o[0],A=o[e-1];if(Math.hypot(b.x-A.x,b.y-A.y)/g>.35)return!1;let M=l-a,E=p-u,F=M/E;if(F<.4||F>2.5)return!1;let $=d/e,Z=f/e,V=0,K=[];for(let ae=0;ae<e;ae++){let de=o[ae].x-$,ke=o[ae].y-Z,Oe=Math.hypot(de,ke);K.push(Oe),V+=Oe}let se=V/e,z=0;for(let ae=0;ae<e;ae++){let de=K[ae]-se;z+=de*de}return Math.sqrt(z/e)/se<.35},App.triangle_gesture=o=>{let e=(d,f)=>{let g=d.x-f.x,b=d.y-f.y;return g*g+b*b},a=(d,f,g)=>{let b=e(f,g);if(b===0)return e(d,f);let A=((d.x-f.x)*(g.x-f.x)+(d.y-f.y)*(g.y-f.y))/b;return A=Math.max(0,Math.min(1,A)),e(d,{x:f.x+A*(g.x-f.x),y:f.y+A*(g.y-f.y)})},l=(d,f,g)=>{let b={x:d.x-f.x,y:d.y-f.y},A={x:g.x-f.x,y:g.y-f.y},S=b.x*A.x+b.y*A.y,M=Math.sqrt(b.x*b.x+b.y*b.y),E=Math.sqrt(A.x*A.x+A.y*A.y);if(M*E===0)return 0;let F=S/(M*E);return F=Math.max(-1,Math.min(1,F)),Math.acos(F)*(180/Math.PI)},u=(d,f)=>{if(d.length<=2)return d;let g=0,b=0,A=d.length-1;for(let S=1;S<A;S++){let M=a(d[S],d[0],d[A]);M>g&&(g=M,b=S)}if(g>f*f){let S=u(d.slice(0,b+1),f),M=u(d.slice(b),f);return S.slice(0,S.length-1).concat(M)}return[d[0],d[A]]};return(()=>{let d=o.length,f=1/0,g=-1/0,b=1/0,A=-1/0;for(let z=0;z<d;z++)f=Math.min(f,o[z].x),g=Math.max(g,o[z].x),b=Math.min(b,o[z].y),A=Math.max(A,o[z].y);let S=Math.hypot(g-f,A-b),M=o[0],E=o[d-1];if(Math.hypot(M.x-E.x,M.y-E.y)/S>.2)return!1;let $=S*.15,Z=u(o,$),V=Z.length;if(V<3||V>4)return!1;let K=Z.slice(0,3),se=[l(K[2],K[0],K[1]),l(K[0],K[1],K[2]),l(K[1],K[2],K[0])];for(let z=0;z<3;z++)if(se[z]<10||se[z]>170)return!1;return!0})()},App.square_gesture=o=>{let e=o.length,a=(z,U)=>{let ee=z.x-U.x,ae=z.y-U.y;return ee*ee+ae*ae},l=(z,U,ee)=>{let ae=a(U,ee);if(ae===0)return a(z,U);let de=((z.x-U.x)*(ee.x-U.x)+(z.y-U.y)*(ee.y-U.y))/ae;return de=Math.max(0,Math.min(1,de)),a(z,{x:U.x+de*(ee.x-U.x),y:U.y+de*(ee.y-U.y)})},u=(z,U)=>{if(z.length<=2)return z;let ee=0,ae=0,de=z.length-1;for(let ke=1;ke<de;ke++){let Oe=l(z[ke],z[0],z[de]);Oe>ee&&(ee=Oe,ae=ke)}if(ee>U*U){let ke=u(z.slice(0,ae+1),U),Oe=u(z.slice(ae),U);return ke.slice(0,ke.length-1).concat(Oe)}return[z[0],z[de]]},p=1/0,d=-1/0,f=1/0,g=-1/0;for(let z=0;z<e;z++){let U=o[z];p=Math.min(p,U.x),d=Math.max(d,U.x),f=Math.min(f,U.y),g=Math.max(g,U.y)}let b=Math.hypot(d-p,g-f),A=o[0],S=o[e-1];if(Math.hypot(A.x-S.x,A.y-S.y)/b>.4)return!1;let E=d-p,F=g-f,$=E/F;if($<.15||$>6)return!1;let Z=b*.06,V=u(o,Z),K=V.length;if(K<4||K>6)return!1;let se=0;for(let z=1;z<K-1;z++){let U=V[z-1],ee=V[z],ae=V[z+1],de=ee.x-U.x,ke=ee.y-U.y,Oe=ae.x-ee.x,De=ae.y-ee.y,Ae=de*Oe+ke*De,Pe=Math.hypot(de,ke),We=Math.hypot(Oe,De),qe=Ae/(Pe*We);Math.abs(qe)<.5&&se++}return se>=2},App.plus_gesture=o=>{let e=o.length,a=1/0,l=-1/0,u=1/0,p=-1/0;for(let $=0;$<e;$++){let Z=o[$];Z.x<a&&(a=Z.x),Z.x>l&&(l=Z.x),Z.y<u&&(u=Z.y),Z.y>p&&(p=Z.y)}let d=l-a,f=p-u;if(d===0||f===0)return!1;let g=d/f;if(g<.4||g>2.5)return!1;let b=a+d/2,A=u+f/2,S=d*.25,M=f*.25,E=0;for(let $=0;$<e;$++){let Z=o[$],V=Math.abs(Z.x-b)<S,K=Math.abs(Z.y-A)<M;(V||K)&&E++}return E/e>.85},App.gesture_function=(o,e)=>{App.increase_scope_click_level(o),App.set_scope_clicks({locked:!0,level:o}),App.spin_panning(),e()},App.on_slide_left=()=>{App.next_visual()},App.on_slide_right=()=>{App.next_theme()},App.github_login=()=>{let o=600,e=700,a=(window.innerWidth-o)/2,l=(window.innerHeight-e)/2;window.open("/github/login","GitHub Auth",`width=${o},height=${e},top=${l},left=${a}`),window.addEventListener("message",function u(p){p.origin===window.location.origin&&p.data==="github_authorized"&&(console.log("GitHub Auth successful! Retrying save..."),window.removeEventListener("message",u))})},App.save_gist=async(o,e)=>{let l=await fetch("/github/create_gist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:e,content:o})});if(l.ok){let d=(await l.json()).raw_url;return console.log("Gist created:",d),App.show_gist_url(d),d}let u=await l.json();return console.error("Error saving gist:",u),l.status===401&&console.log("User needs to login first"),null},App.show_gist_url=o=>{let e=window.location.origin,a="";App.beat_title&&(a=`&title=${encodeURIComponent(App.beat_title)}`);let l=encodeURIComponent(o);App.show_alert(`${e}?url=${l}${a}`)};let rangeFrom=[],rangeTo=[];(()=>{let o="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,a=0;e<o.length;e++)(e%2?rangeTo:rangeFrom).push(a=a+o[e])})();function isExtendingChar(o){if(o<768)return!1;for(let e=0,a=rangeFrom.length;;){let l=e+a>>1;if(o<rangeFrom[l])a=l;else if(o>=rangeTo[l])e=l+1;else return!0;if(e==a)return!1}}function isRegionalIndicator(o){return o>=127462&&o<=127487}const ZWJ=8205;function findClusterBreak$1(o,e,a=!0,l=!0){return(a?nextClusterBreak:prevClusterBreak)(o,e,l)}function nextClusterBreak(o,e,a){if(e==o.length)return e;e&&surrogateLow$1(o.charCodeAt(e))&&surrogateHigh$1(o.charCodeAt(e-1))&&e--;let l=codePointAt$1(o,e);for(e+=codePointSize$1(l);e<o.length;){let u=codePointAt$1(o,e);if(l==ZWJ||u==ZWJ||a&&isExtendingChar(u))e+=codePointSize$1(u),l=u;else if(isRegionalIndicator(u)){let p=0,d=e-2;for(;d>=0&&isRegionalIndicator(codePointAt$1(o,d));)p++,d-=2;if(p%2==0)break;e+=2}else break}return e}function prevClusterBreak(o,e,a){for(;e>0;){let l=nextClusterBreak(o,e-2,a);if(l<e)return l;e--}return 0}function codePointAt$1(o,e){let a=o.charCodeAt(e);if(!surrogateHigh$1(a)||e+1==o.length)return a;let l=o.charCodeAt(e+1);return surrogateLow$1(l)?(a-55296<<10)+(l-56320)+65536:a}function surrogateLow$1(o){return o>=56320&&o<57344}function surrogateHigh$1(o){return o>=55296&&o<56320}function codePointSize$1(o){return o<65536?1:2}class Text{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,a,l){[e,a]=clip$1(this,e,a);let u=[];return this.decompose(0,e,u,2),l.length&&l.decompose(0,l.length,u,3),this.decompose(a,this.length,u,1),TextNode.from(u,this.length-(a-e)+l.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,a=this.length){[e,a]=clip$1(this,e,a);let l=[];return this.decompose(e,a,l,0),TextNode.from(l,a-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let a=this.scanIdentical(e,1),l=this.length-this.scanIdentical(e,-1),u=new RawTextCursor(this),p=new RawTextCursor(e);for(let d=a,f=a;;){if(u.next(d),p.next(d),d=0,u.lineBreak!=p.lineBreak||u.done!=p.done||u.value!=p.value)return!1;if(f+=u.value.length,u.done||f>=l)return!0}}iter(e=1){return new RawTextCursor(this,e)}iterRange(e,a=this.length){return new PartialTextCursor(this,e,a)}iterLines(e,a){let l;if(e==null)l=this.iter();else{a==null&&(a=this.lines+1);let u=this.line(e).from;l=this.iterRange(u,Math.max(u,a==this.lines+1?this.length:a<=1?0:this.line(a-1).to))}return new LineCursor(l)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Text.empty:e.length<=32?new TextLeaf(e):TextNode.from(TextLeaf.split(e,[]))}}class TextLeaf extends Text{constructor(e,a=textLength(e)){super(),this.text=e,this.length=a}get lines(){return this.text.length}get children(){return null}lineInner(e,a,l,u){for(let p=0;;p++){let d=this.text[p],f=u+d.length;if((a?l:f)>=e)return new Line(u,f,l,d);u=f+1,l++}}decompose(e,a,l,u){let p=e<=0&&a>=this.length?this:new TextLeaf(sliceText(this.text,e,a),Math.min(a,this.length)-Math.max(0,e));if(u&1){let d=l.pop(),f=appendText(p.text,d.text.slice(),0,p.length);if(f.length<=32)l.push(new TextLeaf(f,d.length+p.length));else{let g=f.length>>1;l.push(new TextLeaf(f.slice(0,g)),new TextLeaf(f.slice(g)))}}else l.push(p)}replace(e,a,l){if(!(l instanceof TextLeaf))return super.replace(e,a,l);[e,a]=clip$1(this,e,a);let u=appendText(this.text,appendText(l.text,sliceText(this.text,0,e)),a),p=this.length+l.length-(a-e);return u.length<=32?new TextLeaf(u,p):TextNode.from(TextLeaf.split(u,[]),p)}sliceString(e,a=this.length,l=`
`){[e,a]=clip$1(this,e,a);let u="";for(let p=0,d=0;p<=a&&d<this.text.length;d++){let f=this.text[d],g=p+f.length;p>e&&d&&(u+=l),e<g&&a>p&&(u+=f.slice(Math.max(0,e-p),a-p)),p=g+1}return u}flatten(e){for(let a of this.text)e.push(a)}scanIdentical(){return 0}static split(e,a){let l=[],u=-1;for(let p of e)l.push(p),u+=p.length+1,l.length==32&&(a.push(new TextLeaf(l,u)),l=[],u=-1);return u>-1&&a.push(new TextLeaf(l,u)),a}}class TextNode extends Text{constructor(e,a){super(),this.children=e,this.length=a,this.lines=0;for(let l of e)this.lines+=l.lines}lineInner(e,a,l,u){for(let p=0;;p++){let d=this.children[p],f=u+d.length,g=l+d.lines-1;if((a?g:f)>=e)return d.lineInner(e,a,l,u);u=f+1,l=g+1}}decompose(e,a,l,u){for(let p=0,d=0;d<=a&&p<this.children.length;p++){let f=this.children[p],g=d+f.length;if(e<=g&&a>=d){let b=u&((d<=e?1:0)|(g>=a?2:0));d>=e&&g<=a&&!b?l.push(f):f.decompose(e-d,a-d,l,b)}d=g+1}}replace(e,a,l){if([e,a]=clip$1(this,e,a),l.lines<this.lines)for(let u=0,p=0;u<this.children.length;u++){let d=this.children[u],f=p+d.length;if(e>=p&&a<=f){let g=d.replace(e-p,a-p,l),b=this.lines-d.lines+g.lines;if(g.lines<b>>4&&g.lines>b>>6){let A=this.children.slice();return A[u]=g,new TextNode(A,this.length-(a-e)+l.length)}return super.replace(p,f,g)}p=f+1}return super.replace(e,a,l)}sliceString(e,a=this.length,l=`
`){[e,a]=clip$1(this,e,a);let u="";for(let p=0,d=0;p<this.children.length&&d<=a;p++){let f=this.children[p],g=d+f.length;d>e&&p&&(u+=l),e<g&&a>d&&(u+=f.sliceString(e-d,a-d,l)),d=g+1}return u}flatten(e){for(let a of this.children)a.flatten(e)}scanIdentical(e,a){if(!(e instanceof TextNode))return 0;let l=0,[u,p,d,f]=a>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;u+=a,p+=a){if(u==d||p==f)return l;let g=this.children[u],b=e.children[p];if(g!=b)return l+g.scanIdentical(b,a);l+=g.length+1}}static from(e,a=e.reduce((l,u)=>l+u.length+1,-1)){let l=0;for(let E of e)l+=E.lines;if(l<32){let E=[];for(let F of e)F.flatten(E);return new TextLeaf(E,a)}let u=Math.max(32,l>>5),p=u<<1,d=u>>1,f=[],g=0,b=-1,A=[];function S(E){let F;if(E.lines>p&&E instanceof TextNode)for(let $ of E.children)S($);else E.lines>d&&(g>d||!g)?(M(),f.push(E)):E instanceof TextLeaf&&g&&(F=A[A.length-1])instanceof TextLeaf&&E.lines+F.lines<=32?(g+=E.lines,b+=E.length+1,A[A.length-1]=new TextLeaf(F.text.concat(E.text),F.length+1+E.length)):(g+E.lines>u&&M(),g+=E.lines,b+=E.length+1,A.push(E))}function M(){g!=0&&(f.push(A.length==1?A[0]:TextNode.from(A,b)),b=-1,g=A.length=0)}for(let E of e)S(E);return M(),f.length==1?f[0]:new TextNode(f,a)}}Text.empty=new TextLeaf([""],0);function textLength(o){let e=-1;for(let a of o)e+=a.length+1;return e}function appendText(o,e,a=0,l=1e9){for(let u=0,p=0,d=!0;p<o.length&&u<=l;p++){let f=o[p],g=u+f.length;g>=a&&(g>l&&(f=f.slice(0,l-u)),u<a&&(f=f.slice(a-u)),d?(e[e.length-1]+=f,d=!1):e.push(f)),u=g+1}return e}function sliceText(o,e,a){return appendText(o,[""],e,a)}class RawTextCursor{constructor(e,a=1){this.dir=a,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[a>0?1:(e instanceof TextLeaf?e.text.length:e.children.length)<<1]}nextInner(e,a){for(this.done=this.lineBreak=!1;;){let l=this.nodes.length-1,u=this.nodes[l],p=this.offsets[l],d=p>>1,f=u instanceof TextLeaf?u.text.length:u.children.length;if(d==(a>0?f:0)){if(l==0)return this.done=!0,this.value="",this;a>0&&this.offsets[l-1]++,this.nodes.pop(),this.offsets.pop()}else if((p&1)==(a>0?0:1)){if(this.offsets[l]+=a,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(u instanceof TextLeaf){let g=u.text[d+(a<0?-1:0)];if(this.offsets[l]+=a,g.length>Math.max(0,e))return this.value=e==0?g:a>0?g.slice(e):g.slice(0,g.length-e),this;e-=g.length}else{let g=u.children[d+(a<0?-1:0)];e>g.length?(e-=g.length,this.offsets[l]+=a):(a<0&&this.offsets[l]--,this.nodes.push(g),this.offsets.push(a>0?1:(g instanceof TextLeaf?g.text.length:g.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class PartialTextCursor{constructor(e,a,l){this.value="",this.done=!1,this.cursor=new RawTextCursor(e,a>l?-1:1),this.pos=a>l?e.length:0,this.from=Math.min(a,l),this.to=Math.max(a,l)}nextInner(e,a){if(a<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,a<0?this.pos-this.to:this.from-this.pos);let l=a<0?this.pos-this.from:this.to-this.pos;e>l&&(e=l),l-=e;let{value:u}=this.cursor.next(e);return this.pos+=(u.length+e)*a,this.value=u.length<=l?u:a<0?u.slice(u.length-l):u.slice(0,l),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:a,lineBreak:l,value:u}=this.inner.next(e);return a&&this.afterBreak?(this.value="",this.afterBreak=!1):a?(this.done=!0,this.value=""):l?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=u,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(e,a,l,u){this.from=e,this.to=a,this.number=l,this.text=u}get length(){return this.to-this.from}}function clip$1(o,e,a){return e=Math.max(0,Math.min(o.length,e)),[e,Math.max(e,Math.min(o.length,a))]}function findClusterBreak(o,e,a=!0,l=!0){return findClusterBreak$1(o,e,a,l)}function surrogateLow(o){return o>=56320&&o<57344}function surrogateHigh(o){return o>=55296&&o<56320}function codePointAt(o,e){let a=o.charCodeAt(e);if(!surrogateHigh(a)||e+1==o.length)return a;let l=o.charCodeAt(e+1);return surrogateLow(l)?(a-55296<<10)+(l-56320)+65536:a}function fromCodePoint(o){return o<=65535?String.fromCharCode(o):(o-=65536,String.fromCharCode((o>>10)+55296,(o&1023)+56320))}function codePointSize(o){return o<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=(function(o){return o[o.Simple=0]="Simple",o[o.TrackDel=1]="TrackDel",o[o.TrackBefore=2]="TrackBefore",o[o.TrackAfter=3]="TrackAfter",o})(MapMode||(MapMode={}));class ChangeDesc{constructor(e){this.sections=e}get length(){let e=0;for(let a=0;a<this.sections.length;a+=2)e+=this.sections[a];return e}get newLength(){let e=0;for(let a=0;a<this.sections.length;a+=2){let l=this.sections[a+1];e+=l<0?this.sections[a]:l}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let a=0,l=0,u=0;a<this.sections.length;){let p=this.sections[a++],d=this.sections[a++];d<0?(e(l,u,p),u+=p):u+=d,l+=p}}iterChangedRanges(e,a=!1){iterChanges(this,e,a)}get invertedDesc(){let e=[];for(let a=0;a<this.sections.length;){let l=this.sections[a++],u=this.sections[a++];u<0?e.push(l,u):e.push(u,l)}return new ChangeDesc(e)}composeDesc(e){return this.empty?e:e.empty?this:composeSets(this,e)}mapDesc(e,a=!1){return e.empty?this:mapSet(this,e,a)}mapPos(e,a=-1,l=MapMode.Simple){let u=0,p=0;for(let d=0;d<this.sections.length;){let f=this.sections[d++],g=this.sections[d++],b=u+f;if(g<0){if(b>e)return p+(e-u);p+=f}else{if(l!=MapMode.Simple&&b>=e&&(l==MapMode.TrackDel&&u<e&&b>e||l==MapMode.TrackBefore&&u<e||l==MapMode.TrackAfter&&b>e))return null;if(b>e||b==e&&a<0&&!f)return e==u||a<0?p:p+g;p+=g}u=b}if(e>u)throw new RangeError(`Position ${e} is out of range for changeset of length ${u}`);return p}touchesRange(e,a=e){for(let l=0,u=0;l<this.sections.length&&u<=a;){let p=this.sections[l++],d=this.sections[l++],f=u+p;if(d>=0&&u<=a&&f>=e)return u<e&&f>a?"cover":!0;u=f}return!1}toString(){let e="";for(let a=0;a<this.sections.length;){let l=this.sections[a++],u=this.sections[a++];e+=(e?" ":"")+l+(u>=0?":"+u:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(a=>typeof a!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(e)}static create(e){return new ChangeDesc(e)}}class ChangeSet extends ChangeDesc{constructor(e,a){super(e),this.inserted=a}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(a,l,u,p,d)=>e=e.replace(u,u+(l-a),d),!1),e}mapDesc(e,a=!1){return mapSet(this,e,a,!0)}invert(e){let a=this.sections.slice(),l=[];for(let u=0,p=0;u<a.length;u+=2){let d=a[u],f=a[u+1];if(f>=0){a[u]=f,a[u+1]=d;let g=u>>1;for(;l.length<g;)l.push(Text.empty);l.push(d?e.slice(p,p+d):Text.empty)}p+=d}return new ChangeSet(a,l)}compose(e){return this.empty?e:e.empty?this:composeSets(this,e,!0)}map(e,a=!1){return e.empty?this:mapSet(this,e,a,!0)}iterChanges(e,a=!1){iterChanges(this,e,a)}get desc(){return ChangeDesc.create(this.sections)}filter(e){let a=[],l=[],u=[],p=new SectionIter(this);e:for(let d=0,f=0;;){let g=d==e.length?1e9:e[d++];for(;f<g||f==g&&p.len==0;){if(p.done)break e;let A=Math.min(p.len,g-f);addSection(u,A,-1);let S=p.ins==-1?-1:p.off==0?p.ins:0;addSection(a,A,S),S>0&&addInsert(l,a,p.text),p.forward(A),f+=A}let b=e[d++];for(;f<b;){if(p.done)break e;let A=Math.min(p.len,b-f);addSection(a,A,-1),addSection(u,A,p.ins==-1?-1:p.off==0?p.ins:0),p.forward(A),f+=A}}return{changes:new ChangeSet(a,l),filtered:ChangeDesc.create(u)}}toJSON(){let e=[];for(let a=0;a<this.sections.length;a+=2){let l=this.sections[a],u=this.sections[a+1];u<0?e.push(l):u==0?e.push([l]):e.push([l].concat(this.inserted[a>>1].toJSON()))}return e}static of(e,a,l){let u=[],p=[],d=0,f=null;function g(A=!1){if(!A&&!u.length)return;d<a&&addSection(u,a-d,-1);let S=new ChangeSet(u,p);f=f?f.compose(S.map(f)):S,u=[],p=[],d=0}function b(A){if(Array.isArray(A))for(let S of A)b(S);else if(A instanceof ChangeSet){if(A.length!=a)throw new RangeError(`Mismatched change set length (got ${A.length}, expected ${a})`);g(),f=f?f.compose(A.map(f)):A}else{let{from:S,to:M=S,insert:E}=A;if(S>M||S<0||M>a)throw new RangeError(`Invalid change range ${S} to ${M} (in doc of length ${a})`);let F=E?typeof E=="string"?Text.of(E.split(l||DefaultSplit)):E:Text.empty,$=F.length;if(S==M&&$==0)return;S<d&&g(),S>d&&addSection(u,S-d,-1),addSection(u,M-S,$),addInsert(p,u,F),d=M}}return b(e),g(!f),f}static empty(e){return new ChangeSet(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let a=[],l=[];for(let u=0;u<e.length;u++){let p=e[u];if(typeof p=="number")a.push(p,-1);else{if(!Array.isArray(p)||typeof p[0]!="number"||p.some((d,f)=>f&&typeof d!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(p.length==1)a.push(p[0],0);else{for(;l.length<u;)l.push(Text.empty);l[u]=Text.of(p.slice(1)),a.push(p[0],l[u].length)}}}return new ChangeSet(a,l)}static createSet(e,a){return new ChangeSet(e,a)}}function addSection(o,e,a,l=!1){if(e==0&&a<=0)return;let u=o.length-2;u>=0&&a<=0&&a==o[u+1]?o[u]+=e:u>=0&&e==0&&o[u]==0?o[u+1]+=a:l?(o[u]+=e,o[u+1]+=a):o.push(e,a)}function addInsert(o,e,a){if(a.length==0)return;let l=e.length-2>>1;if(l<o.length)o[o.length-1]=o[o.length-1].append(a);else{for(;o.length<l;)o.push(Text.empty);o.push(a)}}function iterChanges(o,e,a){let l=o.inserted;for(let u=0,p=0,d=0;d<o.sections.length;){let f=o.sections[d++],g=o.sections[d++];if(g<0)u+=f,p+=f;else{let b=u,A=p,S=Text.empty;for(;b+=f,A+=g,g&&l&&(S=S.append(l[d-2>>1])),!(a||d==o.sections.length||o.sections[d+1]<0);)f=o.sections[d++],g=o.sections[d++];e(u,b,p,A,S),u=b,p=A}}}function mapSet(o,e,a,l=!1){let u=[],p=l?[]:null,d=new SectionIter(o),f=new SectionIter(e);for(let g=-1;;){if(d.done&&f.len||f.done&&d.len)throw new Error("Mismatched change set lengths");if(d.ins==-1&&f.ins==-1){let b=Math.min(d.len,f.len);addSection(u,b,-1),d.forward(b),f.forward(b)}else if(f.ins>=0&&(d.ins<0||g==d.i||d.off==0&&(f.len<d.len||f.len==d.len&&!a))){let b=f.len;for(addSection(u,f.ins,-1);b;){let A=Math.min(d.len,b);d.ins>=0&&g<d.i&&d.len<=A&&(addSection(u,0,d.ins),p&&addInsert(p,u,d.text),g=d.i),d.forward(A),b-=A}f.next()}else if(d.ins>=0){let b=0,A=d.len;for(;A;)if(f.ins==-1){let S=Math.min(A,f.len);b+=S,A-=S,f.forward(S)}else if(f.ins==0&&f.len<A)A-=f.len,f.next();else break;addSection(u,b,g<d.i?d.ins:0),p&&g<d.i&&addInsert(p,u,d.text),g=d.i,d.forward(d.len-A)}else{if(d.done&&f.done)return p?ChangeSet.createSet(u,p):ChangeDesc.create(u);throw new Error("Mismatched change set lengths")}}}function composeSets(o,e,a=!1){let l=[],u=a?[]:null,p=new SectionIter(o),d=new SectionIter(e);for(let f=!1;;){if(p.done&&d.done)return u?ChangeSet.createSet(l,u):ChangeDesc.create(l);if(p.ins==0)addSection(l,p.len,0,f),p.next();else if(d.len==0&&!d.done)addSection(l,0,d.ins,f),u&&addInsert(u,l,d.text),d.next();else{if(p.done||d.done)throw new Error("Mismatched change set lengths");{let g=Math.min(p.len2,d.len),b=l.length;if(p.ins==-1){let A=d.ins==-1?-1:d.off?0:d.ins;addSection(l,g,A,f),u&&A&&addInsert(u,l,d.text)}else d.ins==-1?(addSection(l,p.off?0:p.len,g,f),u&&addInsert(u,l,p.textBit(g))):(addSection(l,p.off?0:p.len,d.off?0:d.ins,f),u&&!d.off&&addInsert(u,l,d.text));f=(p.ins>g||d.ins>=0&&d.len>g)&&(f||l.length>b),p.forward2(g),d.forward(g)}}}}class SectionIter{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,a=this.i-2>>1;return a>=e.length?Text.empty:e[a]}textBit(e){let{inserted:a}=this.set,l=this.i-2>>1;return l>=a.length&&!e?Text.empty:a[l].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class SelectionRange{constructor(e,a,l){this.from=e,this.to=a,this.flags=l}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,a=-1){let l,u;return this.empty?l=u=e.mapPos(this.from,a):(l=e.mapPos(this.from,1),u=e.mapPos(this.to,-1)),l==this.from&&u==this.to?this:new SelectionRange(l,u,this.flags)}extend(e,a=e){if(e<=this.anchor&&a>=this.anchor)return EditorSelection.range(e,a);let l=Math.abs(e-this.anchor)>Math.abs(a-this.anchor)?e:a;return EditorSelection.range(this.anchor,l)}eq(e,a=!1){return this.anchor==e.anchor&&this.head==e.head&&(!a||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)}static create(e,a,l){return new SelectionRange(e,a,l)}}class EditorSelection{constructor(e,a){this.ranges=e,this.mainIndex=a}map(e,a=-1){return e.empty?this:EditorSelection.create(this.ranges.map(l=>l.map(e,a)),this.mainIndex)}eq(e,a=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let l=0;l<this.ranges.length;l++)if(!this.ranges[l].eq(e.ranges[l],a))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(e,a=!0){return EditorSelection.create([e].concat(this.ranges),a?0:this.mainIndex+1)}replaceRange(e,a=this.mainIndex){let l=this.ranges.slice();return l[a]=e,EditorSelection.create(l,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(e.ranges.map(a=>SelectionRange.fromJSON(a)),e.main)}static single(e,a=e){return new EditorSelection([EditorSelection.range(e,a)],0)}static create(e,a=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let l=0,u=0;u<e.length;u++){let p=e[u];if(p.empty?p.from<=l:p.from<l)return EditorSelection.normalized(e.slice(),a);l=p.to}return new EditorSelection(e,a)}static cursor(e,a=0,l,u){return SelectionRange.create(e,e,(a==0?0:a<0?8:16)|(l==null?7:Math.min(6,l))|(u??16777215)<<6)}static range(e,a,l,u){let p=(l??16777215)<<6|(u==null?7:Math.min(6,u));return a<e?SelectionRange.create(a,e,48|p):SelectionRange.create(e,a,(a>e?8:0)|p)}static normalized(e,a=0){let l=e[a];e.sort((u,p)=>u.from-p.from),a=e.indexOf(l);for(let u=1;u<e.length;u++){let p=e[u],d=e[u-1];if(p.empty?p.from<=d.to:p.from<d.to){let f=d.from,g=Math.max(p.to,d.to);u<=a&&a--,e.splice(--u,2,p.anchor>p.head?EditorSelection.range(g,f):EditorSelection.range(f,g))}}return new EditorSelection(e,a)}}function checkSelection(o,e){for(let a of o.ranges)if(a.to>e)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(e,a,l,u,p){this.combine=e,this.compareInput=a,this.compare=l,this.isStatic=u,this.id=nextID++,this.default=e([]),this.extensions=typeof p=="function"?p(this):p}get reader(){return this}static define(e={}){return new Facet(e.combine||(a=>a),e.compareInput||((a,l)=>a===l),e.compare||(e.combine?(a,l)=>a===l:sameArray$1),!!e.static,e.enables)}of(e){return new FacetProvider([],this,0,e)}compute(e,a){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,a)}computeN(e,a){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,a)}from(e,a){return a||(a=l=>l),this.compute([e],l=>a(l.field(e)))}}function sameArray$1(o,e){return o==e||o.length==e.length&&o.every((a,l)=>a===e[l])}class FacetProvider{constructor(e,a,l,u){this.dependencies=e,this.facet=a,this.type=l,this.value=u,this.id=nextID++}dynamicSlot(e){var a;let l=this.value,u=this.facet.compareInput,p=this.id,d=e[p]>>1,f=this.type==2,g=!1,b=!1,A=[];for(let S of this.dependencies)S=="doc"?g=!0:S=="selection"?b=!0:(((a=e[S.id])!==null&&a!==void 0?a:1)&1)==0&&A.push(e[S.id]);return{create(S){return S.values[d]=l(S),1},update(S,M){if(g&&M.docChanged||b&&(M.docChanged||M.selection)||ensureAll(S,A)){let E=l(S);if(f?!compareArray(E,S.values[d],u):!u(E,S.values[d]))return S.values[d]=E,1}return 0},reconfigure:(S,M)=>{let E,F=M.config.address[p];if(F!=null){let $=getAddr(M,F);if(this.dependencies.every(Z=>Z instanceof Facet?M.facet(Z)===S.facet(Z):Z instanceof StateField?M.field(Z,!1)==S.field(Z,!1):!0)||(f?compareArray(E=l(S),$,u):u(E=l(S),$)))return S.values[d]=$,0}else E=l(S);return S.values[d]=E,1}}}}function compareArray(o,e,a){if(o.length!=e.length)return!1;for(let l=0;l<o.length;l++)if(!a(o[l],e[l]))return!1;return!0}function ensureAll(o,e){let a=!1;for(let l of e)ensureAddr(o,l)&1&&(a=!0);return a}function dynamicFacetSlot(o,e,a){let l=a.map(g=>o[g.id]),u=a.map(g=>g.type),p=l.filter(g=>!(g&1)),d=o[e.id]>>1;function f(g){let b=[];for(let A=0;A<l.length;A++){let S=getAddr(g,l[A]);if(u[A]==2)for(let M of S)b.push(M);else b.push(S)}return e.combine(b)}return{create(g){for(let b of l)ensureAddr(g,b);return g.values[d]=f(g),1},update(g,b){if(!ensureAll(g,p))return 0;let A=f(g);return e.compare(A,g.values[d])?0:(g.values[d]=A,1)},reconfigure(g,b){let A=ensureAll(g,l),S=b.config.facets[e.id],M=b.facet(e);if(S&&!A&&sameArray$1(a,S))return g.values[d]=M,0;let E=f(g);return e.compare(E,M)?(g.values[d]=M,0):(g.values[d]=E,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(e,a,l,u,p){this.id=e,this.createF=a,this.updateF=l,this.compareF=u,this.spec=p,this.provides=void 0}static define(e){let a=new StateField(nextID++,e.create,e.update,e.compare||((l,u)=>l===u),e);return e.provide&&(a.provides=e.provide(a)),a}create(e){let a=e.facet(initField).find(l=>l.field==this);return(a?.create||this.createF)(e)}slot(e){let a=e[this.id]>>1;return{create:l=>(l.values[a]=this.create(l),1),update:(l,u)=>{let p=l.values[a],d=this.updateF(p,u);return this.compareF(p,d)?0:(l.values[a]=d,1)},reconfigure:(l,u)=>{let p=l.facet(initField),d=u.facet(initField),f;return(f=p.find(g=>g.field==this))&&f!=d.find(g=>g.field==this)?(l.values[a]=f.create(l),1):u.config.address[this.id]!=null?(l.values[a]=u.field(this),0):(l.values[a]=this.create(l),1)}}}init(e){return[this,initField.of({field:this,create:e})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(o){return e=>new PrecExtension(e,o)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(e,a){this.inner=e,this.prec=a}}class Compartment{of(e){return new CompartmentInstance(this,e)}reconfigure(e){return Compartment.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class CompartmentInstance{constructor(e,a){this.compartment=e,this.inner=a}}class Configuration{constructor(e,a,l,u,p,d){for(this.base=e,this.compartments=a,this.dynamicSlots=l,this.address=u,this.staticValues=p,this.facets=d,this.statusTemplate=[];this.statusTemplate.length<l.length;)this.statusTemplate.push(0)}staticFacet(e){let a=this.address[e.id];return a==null?e.default:this.staticValues[a>>1]}static resolve(e,a,l){let u=[],p=Object.create(null),d=new Map;for(let M of flatten$1(e,a,d))M instanceof StateField?u.push(M):(p[M.facet.id]||(p[M.facet.id]=[])).push(M);let f=Object.create(null),g=[],b=[];for(let M of u)f[M.id]=b.length<<1,b.push(E=>M.slot(E));let A=l?.config.facets;for(let M in p){let E=p[M],F=E[0].facet,$=A&&A[M]||[];if(E.every(Z=>Z.type==0))if(f[F.id]=g.length<<1|1,sameArray$1($,E))g.push(l.facet(F));else{let Z=F.combine(E.map(V=>V.value));g.push(l&&F.compare(Z,l.facet(F))?l.facet(F):Z)}else{for(let Z of E)Z.type==0?(f[Z.id]=g.length<<1|1,g.push(Z.value)):(f[Z.id]=b.length<<1,b.push(V=>Z.dynamicSlot(V)));f[F.id]=b.length<<1,b.push(Z=>dynamicFacetSlot(Z,F,E))}}let S=b.map(M=>M(f));return new Configuration(e,d,S,f,g,p)}}function flatten$1(o,e,a){let l=[[],[],[],[],[]],u=new Map;function p(d,f){let g=u.get(d);if(g!=null){if(g<=f)return;let b=l[g].indexOf(d);b>-1&&l[g].splice(b,1),d instanceof CompartmentInstance&&a.delete(d.compartment)}if(u.set(d,f),Array.isArray(d))for(let b of d)p(b,f);else if(d instanceof CompartmentInstance){if(a.has(d.compartment))throw new RangeError("Duplicate use of compartment in extensions");let b=e.get(d.compartment)||d.inner;a.set(d.compartment,b),p(b,f)}else if(d instanceof PrecExtension)p(d.inner,d.prec);else if(d instanceof StateField)l[f].push(d),d.provides&&p(d.provides,f);else if(d instanceof FacetProvider)l[f].push(d),d.facet.extensions&&p(d.facet.extensions,Prec_.default);else{let b=d.extension;if(!b)throw new Error(`Unrecognized extension value in extension set (${d}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);p(b,f)}}return p(o,Prec_.default),l.reduce((d,f)=>d.concat(f))}function ensureAddr(o,e){if(e&1)return 2;let a=e>>1,l=o.status[a];if(l==4)throw new Error("Cyclic dependency between fields and/or facets");if(l&2)return l;o.status[a]=4;let u=o.computeSlot(o,o.config.dynamicSlots[a]);return o.status[a]=2|u}function getAddr(o,e){return e&1?o.config.staticValues[e>>1]:o.values[e>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:o=>o.some(e=>e),static:!0}),lineSeparator=Facet.define({combine:o=>o.length?o[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:o=>o.length?o[0]:!1});class Annotation{constructor(e,a){this.type=e,this.value=a}static define(){return new AnnotationType}}class AnnotationType{of(e){return new Annotation(this,e)}}class StateEffectType{constructor(e){this.map=e}of(e){return new StateEffect(this,e)}}class StateEffect{constructor(e,a){this.type=e,this.value=a}map(e){let a=this.type.map(this.value,e);return a===void 0?void 0:a==this.value?this:new StateEffect(this.type,a)}is(e){return this.type==e}static define(e={}){return new StateEffectType(e.map||(a=>a))}static mapEffects(e,a){if(!e.length)return e;let l=[];for(let u of e){let p=u.map(a);p&&l.push(p)}return l}}StateEffect.reconfigure=StateEffect.define(),StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(e,a,l,u,p,d){this.startState=e,this.changes=a,this.selection=l,this.effects=u,this.annotations=p,this.scrollIntoView=d,this._doc=null,this._state=null,l&&checkSelection(l,a.newLength),p.some(f=>f.type==Transaction.time)||(this.annotations=p.concat(Transaction.time.of(Date.now())))}static create(e,a,l,u,p,d){return new Transaction(e,a,l,u,p,d)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let a of this.annotations)if(a.type==e)return a.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let a=this.annotation(Transaction.userEvent);return!!(a&&(a==e||a.length>e.length&&a.slice(0,e.length)==e&&a[e.length]=="."))}}Transaction.time=Annotation.define(),Transaction.userEvent=Annotation.define(),Transaction.addToHistory=Annotation.define(),Transaction.remote=Annotation.define();function joinRanges(o,e){let a=[];for(let l=0,u=0;;){let p,d;if(l<o.length&&(u==e.length||e[u]>=o[l]))p=o[l++],d=o[l++];else if(u<e.length)p=e[u++],d=e[u++];else return a;!a.length||a[a.length-1]<p?a.push(p,d):a[a.length-1]<d&&(a[a.length-1]=d)}}function mergeTransaction(o,e,a){var l;let u,p,d;return a?(u=e.changes,p=ChangeSet.empty(e.changes.length),d=o.changes.compose(e.changes)):(u=e.changes.map(o.changes),p=o.changes.mapDesc(e.changes,!0),d=o.changes.compose(u)),{changes:d,selection:e.selection?e.selection.map(p):(l=o.selection)===null||l===void 0?void 0:l.map(u),effects:StateEffect.mapEffects(o.effects,u).concat(StateEffect.mapEffects(e.effects,p)),annotations:o.annotations.length?o.annotations.concat(e.annotations):e.annotations,scrollIntoView:o.scrollIntoView||e.scrollIntoView}}function resolveTransactionInner(o,e,a){let l=e.selection,u=asArray$1(e.annotations);return e.userEvent&&(u=u.concat(Transaction.userEvent.of(e.userEvent))),{changes:e.changes instanceof ChangeSet?e.changes:ChangeSet.of(e.changes||[],a,o.facet(lineSeparator)),selection:l&&(l instanceof EditorSelection?l:EditorSelection.single(l.anchor,l.head)),effects:asArray$1(e.effects),annotations:u,scrollIntoView:!!e.scrollIntoView}}function resolveTransaction(o,e,a){let l=resolveTransactionInner(o,e.length?e[0]:{},o.doc.length);e.length&&e[0].filter===!1&&(a=!1);for(let p=1;p<e.length;p++){e[p].filter===!1&&(a=!1);let d=!!e[p].sequential;l=mergeTransaction(l,resolveTransactionInner(o,e[p],d?l.changes.newLength:o.doc.length),d)}let u=Transaction.create(o,l.changes,l.selection,l.effects,l.annotations,l.scrollIntoView);return extendTransaction(a?filterTransaction(u):u)}function filterTransaction(o){let e=o.startState,a=!0;for(let u of e.facet(changeFilter)){let p=u(o);if(p===!1){a=!1;break}Array.isArray(p)&&(a=a===!0?p:joinRanges(a,p))}if(a!==!0){let u,p;if(a===!1)p=o.changes.invertedDesc,u=ChangeSet.empty(e.doc.length);else{let d=o.changes.filter(a);u=d.changes,p=d.filtered.mapDesc(d.changes).invertedDesc}o=Transaction.create(e,u,o.selection&&o.selection.map(p),StateEffect.mapEffects(o.effects,p),o.annotations,o.scrollIntoView)}let l=e.facet(transactionFilter);for(let u=l.length-1;u>=0;u--){let p=l[u](o);p instanceof Transaction?o=p:Array.isArray(p)&&p.length==1&&p[0]instanceof Transaction?o=p[0]:o=resolveTransaction(e,asArray$1(p),!1)}return o}function extendTransaction(o){let e=o.startState,a=e.facet(transactionExtender),l=o;for(let u=a.length-1;u>=0;u--){let p=a[u](o);p&&Object.keys(p).length&&(l=mergeTransaction(l,resolveTransactionInner(e,p,o.changes.newLength),!0))}return l==o?o:Transaction.create(e,o.changes,o.selection,l.effects,l.annotations,l.scrollIntoView)}const none$2=[];function asArray$1(o){return o==null?none$2:Array.isArray(o)?o:[o]}var CharCategory=(function(o){return o[o.Word=0]="Word",o[o.Space=1]="Space",o[o.Other=2]="Other",o})(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(o){}function hasWordChar(o){if(wordChar)return wordChar.test(o);for(let e=0;e<o.length;e++){let a=o[e];if(/\w/.test(a)||a>""&&(a.toUpperCase()!=a.toLowerCase()||nonASCIISingleCaseWordChar.test(a)))return!0}return!1}function makeCategorizer(o){return e=>{if(!/\S/.test(e))return CharCategory.Space;if(hasWordChar(e))return CharCategory.Word;for(let a=0;a<o.length;a++)if(e.indexOf(o[a])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(e,a,l,u,p,d){this.config=e,this.doc=a,this.selection=l,this.values=u,this.status=e.statusTemplate.slice(),this.computeSlot=p,d&&(d._state=this);for(let f=0;f<this.config.dynamicSlots.length;f++)ensureAddr(this,f<<1);this.computeSlot=null}field(e,a=!0){let l=this.config.address[e.id];if(l==null){if(a)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,l),getAddr(this,l)}update(...e){return resolveTransaction(this,e,!0)}applyTransaction(e){let a=this.config,{base:l,compartments:u}=a;for(let f of e.effects)f.is(Compartment.reconfigure)?(a&&(u=new Map,a.compartments.forEach((g,b)=>u.set(b,g)),a=null),u.set(f.value.compartment,f.value.extension)):f.is(StateEffect.reconfigure)?(a=null,l=f.value):f.is(StateEffect.appendConfig)&&(a=null,l=asArray$1(l).concat(f.value));let p;a?p=e.startState.values.slice():(a=Configuration.resolve(l,u,this),p=new EditorState(a,this.doc,this.selection,a.dynamicSlots.map(()=>null),(g,b)=>b.reconfigure(g,this),null).values);let d=e.startState.facet(allowMultipleSelections)?e.newSelection:e.newSelection.asSingle();new EditorState(a,e.newDoc,d,p,(f,g)=>g.update(f,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(a=>({changes:{from:a.from,to:a.to,insert:e},range:EditorSelection.cursor(a.from+e.length)}))}changeByRange(e){let a=this.selection,l=e(a.ranges[0]),u=this.changes(l.changes),p=[l.range],d=asArray$1(l.effects);for(let f=1;f<a.ranges.length;f++){let g=e(a.ranges[f]),b=this.changes(g.changes),A=b.map(u);for(let M=0;M<f;M++)p[M]=p[M].map(A);let S=u.mapDesc(b,!0);p.push(g.range.map(S)),u=u.compose(A),d=StateEffect.mapEffects(d,A).concat(StateEffect.mapEffects(asArray$1(g.effects),S))}return{changes:u,selection:EditorSelection.create(p,a.mainIndex),effects:d}}changes(e=[]){return e instanceof ChangeSet?e:ChangeSet.of(e,this.doc.length,this.facet(EditorState.lineSeparator))}toText(e){return Text.of(e.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(e=0,a=this.doc.length){return this.doc.sliceString(e,a,this.lineBreak)}facet(e){let a=this.config.address[e.id];return a==null?e.default:(ensureAddr(this,a),getAddr(this,a))}toJSON(e){let a={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let l in e){let u=e[l];u instanceof StateField&&this.config.address[u.id]!=null&&(a[l]=u.spec.toJSON(this.field(e[l]),this))}return a}static fromJSON(e,a={},l){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let u=[];if(l){for(let p in l)if(Object.prototype.hasOwnProperty.call(e,p)){let d=l[p],f=e[p];u.push(d.init(g=>d.spec.fromJSON(f,g)))}}return EditorState.create({doc:e.doc,selection:EditorSelection.fromJSON(e.selection),extensions:a.extensions?u.concat([a.extensions]):u})}static create(e={}){let a=Configuration.resolve(e.extensions||[],new Map),l=e.doc instanceof Text?e.doc:Text.of((e.doc||"").split(a.staticFacet(EditorState.lineSeparator)||DefaultSplit)),u=e.selection?e.selection instanceof EditorSelection?e.selection:EditorSelection.single(e.selection.anchor,e.selection.head):EditorSelection.single(0);return checkSelection(u,l.length),a.staticFacet(allowMultipleSelections)||(u=u.asSingle()),new EditorState(a,l,u,a.dynamicSlots.map(()=>null),(p,d)=>d.create(p),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(e,...a){for(let l of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(l,e)){e=l[e];break}return a.length&&(e=e.replace(/\$(\$|\d*)/g,(l,u)=>{if(u=="$")return"$";let p=+(u||1);return!p||p>a.length?l:a[p-1]})),e}languageDataAt(e,a,l=-1){let u=[];for(let p of this.facet(languageData))for(let d of p(this,a,l))Object.prototype.hasOwnProperty.call(d,e)&&u.push(d[e]);return u}charCategorizer(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:a,from:l,length:u}=this.doc.lineAt(e),p=this.charCategorizer(e),d=e-l,f=e-l;for(;d>0;){let g=findClusterBreak(a,d,!1);if(p(a.slice(g,d))!=CharCategory.Word)break;d=g}for(;f<u;){let g=findClusterBreak(a,f);if(p(a.slice(f,g))!=CharCategory.Word)break;f=g}return d==f?null:EditorSelection.range(d+l,f+l)}}EditorState.allowMultipleSelections=allowMultipleSelections,EditorState.tabSize=Facet.define({combine:o=>o.length?o[0]:4}),EditorState.lineSeparator=lineSeparator,EditorState.readOnly=readOnly,EditorState.phrases=Facet.define({compare(o,e){let a=Object.keys(o),l=Object.keys(e);return a.length==l.length&&a.every(u=>o[u]==e[u])}}),EditorState.languageData=languageData,EditorState.changeFilter=changeFilter,EditorState.transactionFilter=transactionFilter,EditorState.transactionExtender=transactionExtender,Compartment.reconfigure=StateEffect.define();function combineConfig(o,e,a={}){let l={};for(let u of o)for(let p of Object.keys(u)){let d=u[p],f=l[p];if(f===void 0)l[p]=d;else if(!(f===d||d===void 0))if(Object.hasOwnProperty.call(a,p))l[p]=a[p](f,d);else throw new Error("Config merge conflict for field "+p)}for(let u in e)l[u]===void 0&&(l[u]=e[u]);return l}class RangeValue{eq(e){return this==e}range(e,a=e){return Range$1.create(e,a,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0,RangeValue.prototype.point=!1,RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class Ni{constructor(e,a,l){this.from=e,this.to=a,this.value=l}static create(e,a,l){return new Ni(e,a,l)}};function cmpRange(o,e){return o.from-e.from||o.value.startSide-e.value.startSide}class Chunk{constructor(e,a,l,u){this.from=e,this.to=a,this.value=l,this.maxPoint=u}get length(){return this.to[this.to.length-1]}findIndex(e,a,l,u=0){let p=l?this.to:this.from;for(let d=u,f=p.length;;){if(d==f)return d;let g=d+f>>1,b=p[g]-e||(l?this.value[g].endSide:this.value[g].startSide)-a;if(g==d)return b>=0?d:f;b>=0?f=g:d=g+1}}between(e,a,l,u){for(let p=this.findIndex(a,-1e9,!0),d=this.findIndex(l,1e9,!1,p);p<d;p++)if(u(this.from[p]+e,this.to[p]+e,this.value[p])===!1)return!1}map(e,a){let l=[],u=[],p=[],d=-1,f=-1;for(let g=0;g<this.value.length;g++){let b=this.value[g],A=this.from[g]+e,S=this.to[g]+e,M,E;if(A==S){let F=a.mapPos(A,b.startSide,b.mapMode);if(F==null||(M=E=F,b.startSide!=b.endSide&&(E=a.mapPos(A,b.endSide),E<M)))continue}else if(M=a.mapPos(A,b.startSide),E=a.mapPos(S,b.endSide),M>E||M==E&&b.startSide>0&&b.endSide<=0)continue;(E-M||b.endSide-b.startSide)<0||(d<0&&(d=M),b.point&&(f=Math.max(f,E-M)),l.push(b),u.push(M-d),p.push(E-d))}return{mapped:l.length?new Chunk(u,p,l,f):null,pos:d}}}class RangeSet{constructor(e,a,l,u){this.chunkPos=e,this.chunk=a,this.nextLayer=l,this.maxPoint=u}static create(e,a,l,u){return new RangeSet(e,a,l,u)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let a of this.chunk)e+=a.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:a=[],sort:l=!1,filterFrom:u=0,filterTo:p=this.length}=e,d=e.filter;if(a.length==0&&!d)return this;if(l&&(a=a.slice().sort(cmpRange)),this.isEmpty)return a.length?RangeSet.of(a):this;let f=new LayerCursor(this,null,-1).goto(0),g=0,b=[],A=new RangeSetBuilder;for(;f.value||g<a.length;)if(g<a.length&&(f.from-a[g].from||f.startSide-a[g].value.startSide)>=0){let S=a[g++];A.addInner(S.from,S.to,S.value)||b.push(S)}else f.rangeIndex==1&&f.chunkIndex<this.chunk.length&&(g==a.length||this.chunkEnd(f.chunkIndex)<a[g].from)&&(!d||u>this.chunkEnd(f.chunkIndex)||p<this.chunkPos[f.chunkIndex])&&A.addChunk(this.chunkPos[f.chunkIndex],this.chunk[f.chunkIndex])?f.nextChunk():((!d||u>f.to||p<f.from||d(f.from,f.to,f.value))&&(A.addInner(f.from,f.to,f.value)||b.push(Range$1.create(f.from,f.to,f.value))),f.next());return A.finishInner(this.nextLayer.isEmpty&&!b.length?RangeSet.empty:this.nextLayer.update({add:b,filter:d,filterFrom:u,filterTo:p}))}map(e){if(e.empty||this.isEmpty)return this;let a=[],l=[],u=-1;for(let d=0;d<this.chunk.length;d++){let f=this.chunkPos[d],g=this.chunk[d],b=e.touchesRange(f,f+g.length);if(b===!1)u=Math.max(u,g.maxPoint),a.push(g),l.push(e.mapPos(f));else if(b===!0){let{mapped:A,pos:S}=g.map(f,e);A&&(u=Math.max(u,A.maxPoint),a.push(A),l.push(S))}}let p=this.nextLayer.map(e);return a.length==0?p:new RangeSet(l,a,p||RangeSet.empty,u)}between(e,a,l){if(!this.isEmpty){for(let u=0;u<this.chunk.length;u++){let p=this.chunkPos[u],d=this.chunk[u];if(a>=p&&e<=p+d.length&&d.between(p,e-p,a-p,l)===!1)return}this.nextLayer.between(e,a,l)}}iter(e=0){return HeapCursor.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,a=0){return HeapCursor.from(e).goto(a)}static compare(e,a,l,u,p=-1){let d=e.filter(S=>S.maxPoint>0||!S.isEmpty&&S.maxPoint>=p),f=a.filter(S=>S.maxPoint>0||!S.isEmpty&&S.maxPoint>=p),g=findSharedChunks(d,f,l),b=new SpanCursor(d,g,p),A=new SpanCursor(f,g,p);l.iterGaps((S,M,E)=>compare(b,S,A,M,E,u)),l.empty&&l.length==0&&compare(b,0,A,0,0,u)}static eq(e,a,l=0,u){u==null&&(u=999999999);let p=e.filter(A=>!A.isEmpty&&a.indexOf(A)<0),d=a.filter(A=>!A.isEmpty&&e.indexOf(A)<0);if(p.length!=d.length)return!1;if(!p.length)return!0;let f=findSharedChunks(p,d),g=new SpanCursor(p,f,0).goto(l),b=new SpanCursor(d,f,0).goto(l);for(;;){if(g.to!=b.to||!sameValues(g.active,b.active)||g.point&&(!b.point||!g.point.eq(b.point)))return!1;if(g.to>u)return!0;g.next(),b.next()}}static spans(e,a,l,u,p=-1){let d=new SpanCursor(e,null,p).goto(a),f=a,g=d.openStart;for(;;){let b=Math.min(d.to,l);if(d.point){let A=d.activeForPoint(d.to),S=d.pointFrom<a?A.length+1:d.point.startSide<0?A.length:Math.min(A.length,g);u.point(f,b,d.point,A,S,d.pointRank),g=Math.min(d.openEnd(b),A.length)}else b>f&&(u.span(f,b,d.active,g),g=d.openEnd(b));if(d.to>l)return g+(d.point&&d.to>l?1:0);f=d.to,d.next()}}static of(e,a=!1){let l=new RangeSetBuilder;for(let u of e instanceof Range$1?[e]:a?lazySort(e):e)l.add(u.from,u.to,u.value);return l.finish()}static join(e){if(!e.length)return RangeSet.empty;let a=e[e.length-1];for(let l=e.length-2;l>=0;l--)for(let u=e[l];u!=RangeSet.empty;u=u.nextLayer)a=new RangeSet(u.chunkPos,u.chunk,a,Math.max(u.maxPoint,a.maxPoint));return a}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(o){if(o.length>1)for(let e=o[0],a=1;a<o.length;a++){let l=o[a];if(cmpRange(e,l)>0)return o.slice().sort(cmpRange);e=l}return o}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,a,l){this.addInner(e,a,l)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(e,a,l)}addInner(e,a,l){let u=e-this.lastTo||l.startSide-this.last.endSide;if(u<=0&&(e-this.lastFrom||l.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return u<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(a-this.chunkStart),this.last=l,this.lastFrom=e,this.lastTo=a,this.value.push(l),l.point&&(this.maxPoint=Math.max(this.maxPoint,a-e)),!0)}addChunk(e,a){if((e-this.lastTo||a.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,a.maxPoint),this.chunks.push(a),this.chunkPos.push(e);let l=a.value.length-1;return this.last=a.value[l],this.lastFrom=a.from[l]+e,this.lastTo=a.to[l]+e,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let a=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,a}}function findSharedChunks(o,e,a){let l=new Map;for(let p of o)for(let d=0;d<p.chunk.length;d++)p.chunk[d].maxPoint<=0&&l.set(p.chunk[d],p.chunkPos[d]);let u=new Set;for(let p of e)for(let d=0;d<p.chunk.length;d++){let f=l.get(p.chunk[d]);f!=null&&(a?a.mapPos(f):f)==p.chunkPos[d]&&!a?.touchesRange(f,f+p.chunk[d].length)&&u.add(p.chunk[d])}return u}class LayerCursor{constructor(e,a,l,u=0){this.layer=e,this.skip=a,this.minPoint=l,this.rank=u}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,a=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,a,!1),this}gotoInner(e,a,l){for(;this.chunkIndex<this.layer.chunk.length;){let u=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(u)||this.layer.chunkEnd(this.chunkIndex)<e||u.maxPoint<this.minPoint))break;this.chunkIndex++,l=!1}if(this.chunkIndex<this.layer.chunk.length){let u=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],a,!0);(!l||this.rangeIndex<u)&&this.setRangeIndex(u)}this.next()}forward(e,a){(this.to-e||this.endSide-a)<0&&this.gotoInner(e,a,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],a=this.layer.chunk[this.chunkIndex],l=e+a.from[this.rangeIndex];if(this.from=l,this.to=e+a.to[this.rangeIndex],this.value=a.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class HeapCursor{constructor(e){this.heap=e}static from(e,a=null,l=-1){let u=[];for(let p=0;p<e.length;p++)for(let d=e[p];!d.isEmpty;d=d.nextLayer)d.maxPoint>=l&&u.push(new LayerCursor(d,a,l,p));return u.length==1?u[0]:new HeapCursor(u)}get startSide(){return this.value?this.value.startSide:0}goto(e,a=-1e9){for(let l of this.heap)l.goto(e,a);for(let l=this.heap.length>>1;l>=0;l--)heapBubble(this.heap,l);return this.next(),this}forward(e,a){for(let l of this.heap)l.forward(e,a);for(let l=this.heap.length>>1;l>=0;l--)heapBubble(this.heap,l);(this.to-e||this.value.endSide-a)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),heapBubble(this.heap,0)}}}function heapBubble(o,e){for(let a=o[e];;){let l=(e<<1)+1;if(l>=o.length)break;let u=o[l];if(l+1<o.length&&u.compare(o[l+1])>=0&&(u=o[l+1],l++),a.compare(u)<0)break;o[l]=a,o[e]=u,e=l}}class SpanCursor{constructor(e,a,l){this.minPoint=l,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(e,a,l)}goto(e,a=-1e9){return this.cursor.goto(e,a),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=a,this.openStart=-1,this.next(),this}forward(e,a){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-a)<0;)this.removeActive(this.minActive);this.cursor.forward(e,a)}removeActive(e){remove(this.active,e),remove(this.activeTo,e),remove(this.activeRank,e),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(e){let a=0,{value:l,to:u,rank:p}=this.cursor;for(;a<this.activeRank.length&&(p-this.activeRank[a]||u-this.activeTo[a])>0;)a++;insert(this.active,a,l),insert(this.activeTo,a,u),insert(this.activeRank,a,p),e&&insert(e,a,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let e=this.to,a=this.point;this.point=null;let l=this.openStart<0?[]:null;for(;;){let u=this.minActive;if(u>-1&&(this.activeTo[u]-this.cursor.from||this.active[u].endSide-this.cursor.startSide)<0){if(this.activeTo[u]>e){this.to=this.activeTo[u],this.endSide=this.active[u].endSide;break}this.removeActive(u),l&&remove(l,u)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let p=this.cursor.value;if(!p.point)this.addActive(l),this.cursor.next();else if(a&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=p,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=p.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(l){this.openStart=0;for(let u=l.length-1;u>=0&&l[u]<e;u--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let a=[];for(let l=this.active.length-1;l>=0&&!(this.activeRank[l]<this.pointRank);l--)(this.activeTo[l]>e||this.activeTo[l]==e&&this.active[l].endSide>=this.point.endSide)&&a.push(this.active[l]);return a.reverse()}openEnd(e){let a=0;for(let l=this.activeTo.length-1;l>=0&&this.activeTo[l]>e;l--)a++;return a}}function compare(o,e,a,l,u,p){o.goto(e),a.goto(l);let d=l+u,f=l,g=l-e;for(;;){let b=o.to+g-a.to,A=b||o.endSide-a.endSide,S=A<0?o.to+g:a.to,M=Math.min(S,d);if(o.point||a.point?o.point&&a.point&&(o.point==a.point||o.point.eq(a.point))&&sameValues(o.activeForPoint(o.to),a.activeForPoint(a.to))||p.comparePoint(f,M,o.point,a.point):M>f&&!sameValues(o.active,a.active)&&p.compareRange(f,M,o.active,a.active),S>d)break;(b||o.openEnd!=a.openEnd)&&p.boundChange&&p.boundChange(S),f=S,A<=0&&o.next(),A>=0&&a.next()}}function sameValues(o,e){if(o.length!=e.length)return!1;for(let a=0;a<o.length;a++)if(o[a]!=e[a]&&!o[a].eq(e[a]))return!1;return!0}function remove(o,e){for(let a=e,l=o.length-1;a<l;a++)o[a]=o[a+1];o.pop()}function insert(o,e,a){for(let l=o.length-1;l>=e;l--)o[l+1]=o[l];o[e]=a}function findMinIndex(o,e){let a=-1,l=1e9;for(let u=0;u<e.length;u++)(e[u]-l||o[u].endSide-o[a].endSide)<0&&(a=u,l=e[u]);return a}function countColumn(o,e,a=o.length){let l=0;for(let u=0;u<a&&u<o.length;)o.charCodeAt(u)==9?(l+=e-l%e,u++):(l++,u=findClusterBreak(o,u));return l}function findColumn(o,e,a,l){for(let u=0,p=0;;){if(p>=e)return u;if(u==o.length)break;p+=o.charCodeAt(u)==9?a-p%a:1,u=findClusterBreak(o,u)}return l===!0?-1:o.length}const C$2="ͼ",COUNT=typeof Symbol>"u"?"__"+C$2:Symbol.for(C$2),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(e,a){this.rules=[];let{finish:l}=a||{};function u(d){return/^@/.test(d)?[d]:d.split(/,\s*/)}function p(d,f,g,b){let A=[],S=/^@(\w+)\b/.exec(d[0]),M=S&&S[1]=="keyframes";if(S&&f==null)return g.push(d[0]+";");for(let E in f){let F=f[E];if(/&/.test(E))p(E.split(/,\s*/).map($=>d.map(Z=>$.replace(/&/,Z))).reduce(($,Z)=>$.concat(Z)),F,g);else if(F&&typeof F=="object"){if(!S)throw new RangeError("The value of a property ("+E+") should be a primitive value.");p(u(E),F,A,M)}else F!=null&&A.push(E.replace(/_.*/,"").replace(/[A-Z]/g,$=>"-"+$.toLowerCase())+": "+F+";")}(A.length||M)&&g.push((l&&!S&&!b?d.map(l):d).join(", ")+" {"+A.join(" ")+"}")}for(let d in e)p(u(d),e[d],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=top[COUNT]||1;return top[COUNT]=e+1,C$2+e.toString(36)}static mount(e,a,l){let u=e[SET],p=l&&l.nonce;u?p&&u.setNonce(p):u=new StyleSet(e,p),u.mount(Array.isArray(a)?a:[a],e)}}let adoptedSet=new Map;class StyleSet{constructor(e,a){let l=e.ownerDocument||e,u=l.defaultView;if(!e.head&&e.adoptedStyleSheets&&u.CSSStyleSheet){let p=adoptedSet.get(l);if(p)return e[SET]=p;this.sheet=new u.CSSStyleSheet,adoptedSet.set(l,this)}else this.styleTag=l.createElement("style"),a&&this.styleTag.setAttribute("nonce",a);this.modules=[],e[SET]=this}mount(e,a){let l=this.sheet,u=0,p=0;for(let d=0;d<e.length;d++){let f=e[d],g=this.modules.indexOf(f);if(g<p&&g>-1&&(this.modules.splice(g,1),p--,g=-1),g==-1){if(this.modules.splice(p++,0,f),l)for(let b=0;b<f.rules.length;b++)l.insertRule(f.rules[b],u++)}else{for(;p<g;)u+=this.modules[p++].rules.length;u+=f.rules.length,p++}}if(l)a.adoptedStyleSheets.indexOf(this.sheet)<0&&(a.adoptedStyleSheets=[this.sheet,...a.adoptedStyleSheets]);else{let d="";for(let g=0;g<this.modules.length;g++)d+=this.modules[g].getRules()+`
`;this.styleTag.textContent=d;let f=a.head||a;this.styleTag.parentNode!=f&&f.insertBefore(this.styleTag,f.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$1=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),i$1=0;i$1<10;i$1++)base[48+i$1]=base[96+i$1]=String(i$1);for(var i$1=1;i$1<=24;i$1++)base[i$1+111]="F"+i$1;for(var i$1=65;i$1<=90;i$1++)base[i$1]=String.fromCharCode(i$1+32),shift[i$1]=String.fromCharCode(i$1);for(var code$1 in base)shift.hasOwnProperty(code$1)||(shift[code$1]=base[code$1]);function keyName(o){var e=mac&&o.metaKey&&o.shiftKey&&!o.ctrlKey&&!o.altKey||ie$1&&o.shiftKey&&o.key&&o.key.length==1||o.key=="Unidentified",a=!e&&o.key||(o.shiftKey?shift:base)[o.keyCode]||o.key||"Unidentified";return a=="Esc"&&(a="Escape"),a=="Del"&&(a="Delete"),a=="Left"&&(a="ArrowLeft"),a=="Up"&&(a="ArrowUp"),a=="Right"&&(a="ArrowRight"),a=="Down"&&(a="ArrowDown"),a}function crelt(){var o=arguments[0];typeof o=="string"&&(o=document.createElement(o));var e=1,a=arguments[1];if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)){var u=a[l];typeof u=="string"?o.setAttribute(l,u):u!=null&&(o[l]=u)}e++}for(;e<arguments.length;e++)add$6(o,arguments[e]);return o}function add$6(o,e){if(typeof e=="string")o.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)o.appendChild(e);else if(Array.isArray(e))for(var a=0;a<e.length;a++)add$6(o,e[a]);else throw new RangeError("Unsupported child node: "+e)}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,safari,safari_version:safari?+(/\bVersion\/(\d+(\.\d+)?)/.exec(nav.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function combineAttrs(o,e){for(let a in o)a=="class"&&e.class?e.class+=" "+o.class:a=="style"&&e.style?e.style+=";"+o.style:e[a]=o[a];return e}const noAttrs$1=Object.create(null);function attrsEq(o,e,a){if(o==e)return!0;o||(o=noAttrs$1),e||(e=noAttrs$1);let l=Object.keys(o),u=Object.keys(e);if(l.length-0!=u.length-0)return!1;for(let p of l)if(p!=a&&(u.indexOf(p)==-1||o[p]!==e[p]))return!1;return!0}function setAttrs(o,e){for(let a=o.attributes.length-1;a>=0;a--){let l=o.attributes[a].name;e[l]==null&&o.removeAttribute(l)}for(let a in e){let l=e[a];a=="style"?o.style.cssText=l:o.getAttribute(a)!=l&&o.setAttribute(a,l)}}function updateAttrs(o,e,a){let l=!1;if(e)for(let u in e)a&&u in a||(l=!0,u=="style"?o.style.cssText="":o.removeAttribute(u));if(a)for(let u in a)e&&e[u]==a[u]||(l=!0,u=="style"?o.style.cssText=a[u]:o.setAttribute(u,a[u]));return l}function getAttrs(o){let e=Object.create(null);for(let a=0;a<o.attributes.length;a++){let l=o.attributes[a];e[l.name]=l.value}return e}class WidgetType{eq(e){return!1}updateDOM(e,a){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,a,l){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var BlockType=(function(o){return o[o.Text=0]="Text",o[o.WidgetBefore=1]="WidgetBefore",o[o.WidgetAfter=2]="WidgetAfter",o[o.WidgetRange=3]="WidgetRange",o})(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(e,a,l,u){super(),this.startSide=e,this.endSide=a,this.widget=l,this.spec=u}get heightRelevant(){return!1}static mark(e){return new MarkDecoration(e)}static widget(e){let a=Math.max(-1e4,Math.min(1e4,e.side||0)),l=!!e.block;return a+=l&&!e.inlineOrder?a>0?3e8:-4e8:a>0?1e8:-1e8,new PointDecoration(e,a,a,l,e.widget||null,!1)}static replace(e){let a=!!e.block,l,u;if(e.isBlockGap)l=-5e8,u=4e8;else{let{start:p,end:d}=getInclusive(e,a);l=(p?a?-3e8:-1:5e8)-1,u=(d?a?2e8:1:-6e8)+1}return new PointDecoration(e,l,u,a,e.widget||null,!0)}static line(e){return new LineDecoration(e)}static set(e,a=!1){return RangeSet.of(e,a)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(e){let{start:a,end:l}=getInclusive(e);super(a?-1:5e8,l?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?combineAttrs(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||noAttrs$1}eq(e){return this==e||e instanceof MarkDecoration&&this.tagName==e.tagName&&attrsEq(this.attrs,e.attrs)}range(e,a=e){if(e>=a)throw new RangeError("Mark decorations may not be empty");return super.range(e,a)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof LineDecoration&&this.spec.class==e.spec.class&&attrsEq(this.spec.attributes,e.spec.attributes)}range(e,a=e){if(a!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,a)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore,LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(e,a,l,u,p,d){super(a,l,p,e),this.block=u,this.isReplace=d,this.mapMode=u?a<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof PointDecoration&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,a=e){if(this.isReplace&&(e>a||e==a&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&a!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,a)}}PointDecoration.prototype.point=!0;function getInclusive(o,e=!1){let{inclusiveStart:a,inclusiveEnd:l}=o;return a==null&&(a=o.inclusive),l==null&&(l=o.inclusive),{start:a??e,end:l??e}}function widgetsEq(o,e){return o==e||!!(o&&e&&o.compare(e))}function addRange(o,e,a,l=0){let u=a.length-1;u>=0&&a[u]+l>=o?a[u]=Math.max(a[u],e):a.push(o,e)}class BlockWrapper extends RangeValue{constructor(e,a){super(),this.tagName=e,this.attributes=a}eq(e){return e==this||e instanceof BlockWrapper&&this.tagName==e.tagName&&attrsEq(this.attributes,e.attributes)}static create(e){return new BlockWrapper(e.tagName,e.attributes||noAttrs$1)}static set(e,a=!1){return RangeSet.of(e,a)}}BlockWrapper.prototype.startSide=BlockWrapper.prototype.endSide=-1;function getSelection(o){let e;return o.nodeType==11?e=o.getSelection?o:o.ownerDocument:e=o,e.getSelection()}function contains(o,e){return e?o==e||o.contains(e.nodeType!=1?e.parentNode:e):!1}function hasSelection(o,e){if(!e.anchorNode)return!1;try{return contains(o,e.anchorNode)}catch{return!1}}function clientRectsFor(o){return o.nodeType==3?textRange(o,0,o.nodeValue.length).getClientRects():o.nodeType==1?o.getClientRects():[]}function isEquivalentPosition(o,e,a,l){return a?scanFor(o,e,a,l,-1)||scanFor(o,e,a,l,1):!1}function domIndex(o){for(var e=0;;e++)if(o=o.previousSibling,!o)return e}function isBlockElement(o){return o.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(o.nodeName)}function scanFor(o,e,a,l,u){for(;;){if(o==a&&e==l)return!0;if(e==(u<0?0:maxOffset(o))){if(o.nodeName=="DIV")return!1;let p=o.parentNode;if(!p||p.nodeType!=1)return!1;e=domIndex(o)+(u<0?0:1),o=p}else if(o.nodeType==1){if(o=o.childNodes[e+(u<0?-1:0)],o.nodeType==1&&o.contentEditable=="false")return!1;e=u<0?maxOffset(o):0}else return!1}}function maxOffset(o){return o.nodeType==3?o.nodeValue.length:o.childNodes.length}function flattenRect(o,e){let a=e?o.left:o.right;return{left:a,right:a,top:o.top,bottom:o.bottom}}function windowRect(o){let e=o.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:o.innerWidth,top:0,bottom:o.innerHeight}}function getScale$1(o,e){let a=e.width/o.offsetWidth,l=e.height/o.offsetHeight;return(a>.995&&a<1.005||!isFinite(a)||Math.abs(e.width-o.offsetWidth)<1)&&(a=1),(l>.995&&l<1.005||!isFinite(l)||Math.abs(e.height-o.offsetHeight)<1)&&(l=1),{scaleX:a,scaleY:l}}function scrollRectIntoView(o,e,a,l,u,p,d,f){let g=o.ownerDocument,b=g.defaultView||window;for(let A=o,S=!1;A&&!S;)if(A.nodeType==1){let M,E=A==g.body,F=1,$=1;if(E)M=windowRect(b);else{if(/^(fixed|sticky)$/.test(getComputedStyle(A).position)&&(S=!0),A.scrollHeight<=A.clientHeight&&A.scrollWidth<=A.clientWidth){A=A.assignedSlot||A.parentNode;continue}let K=A.getBoundingClientRect();({scaleX:F,scaleY:$}=getScale$1(A,K)),M={left:K.left,right:K.left+A.clientWidth*F,top:K.top,bottom:K.top+A.clientHeight*$}}let Z=0,V=0;if(u=="nearest")e.top<M.top?(V=e.top-(M.top+d),a>0&&e.bottom>M.bottom+V&&(V=e.bottom-M.bottom+d)):e.bottom>M.bottom&&(V=e.bottom-M.bottom+d,a<0&&e.top-V<M.top&&(V=e.top-(M.top+d)));else{let K=e.bottom-e.top,se=M.bottom-M.top;V=(u=="center"&&K<=se?e.top+K/2-se/2:u=="start"||u=="center"&&a<0?e.top-d:e.bottom-se+d)-M.top}if(l=="nearest"?e.left<M.left?(Z=e.left-(M.left+p),a>0&&e.right>M.right+Z&&(Z=e.right-M.right+p)):e.right>M.right&&(Z=e.right-M.right+p,a<0&&e.left<M.left+Z&&(Z=e.left-(M.left+p))):Z=(l=="center"?e.left+(e.right-e.left)/2-(M.right-M.left)/2:l=="start"==f?e.left-p:e.right-(M.right-M.left)+p)-M.left,Z||V)if(E)b.scrollBy(Z,V);else{let K=0,se=0;if(V){let z=A.scrollTop;A.scrollTop+=V/$,se=(A.scrollTop-z)*$}if(Z){let z=A.scrollLeft;A.scrollLeft+=Z/F,K=(A.scrollLeft-z)*F}e={left:e.left-K,top:e.top-se,right:e.right-K,bottom:e.bottom-se},K&&Math.abs(K-Z)<1&&(l="nearest"),se&&Math.abs(se-V)<1&&(u="nearest")}if(E)break;(e.top<M.top||e.bottom>M.bottom||e.left<M.left||e.right>M.right)&&(e={left:Math.max(e.left,M.left),right:Math.min(e.right,M.right),top:Math.max(e.top,M.top),bottom:Math.min(e.bottom,M.bottom)}),A=A.assignedSlot||A.parentNode}else if(A.nodeType==11)A=A.host;else break}function scrollableParents(o){let e=o.ownerDocument,a,l;for(let u=o.parentNode;u&&!(u==e.body||a&&l);)if(u.nodeType==1)!l&&u.scrollHeight>u.clientHeight&&(l=u),!a&&u.scrollWidth>u.clientWidth&&(a=u),u=u.assignedSlot||u.parentNode;else if(u.nodeType==11)u=u.host;else break;return{x:a,y:l}}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:a,focusNode:l}=e;this.set(a,Math.min(e.anchorOffset,a?maxOffset(a):0),l,Math.min(e.focusOffset,l?maxOffset(l):0))}set(e,a,l,u){this.anchorNode=e,this.anchorOffset=a,this.focusNode=l,this.focusOffset=u}}let preventScrollSupported=null;browser.safari&&browser.safari_version>=26&&(preventScrollSupported=!1);function focusPreventScroll(o){if(o.setActive)return o.setActive();if(preventScrollSupported)return o.focus(preventScrollSupported);let e=[];for(let a=o;a&&(e.push(a,a.scrollTop,a.scrollLeft),a!=a.ownerDocument);a=a.parentNode);if(o.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let a=0;a<e.length;){let l=e[a++],u=e[a++],p=e[a++];l.scrollTop!=u&&(l.scrollTop=u),l.scrollLeft!=p&&(l.scrollLeft=p)}}}let scratchRange;function textRange(o,e,a=e){let l=scratchRange||(scratchRange=document.createRange());return l.setEnd(o,a),l.setStart(o,e),l}function dispatchKey(o,e,a,l){let u={key:e,code:e,keyCode:a,which:a,cancelable:!0};l&&({altKey:u.altKey,ctrlKey:u.ctrlKey,shiftKey:u.shiftKey,metaKey:u.metaKey}=l);let p=new KeyboardEvent("keydown",u);p.synthetic=!0,o.dispatchEvent(p);let d=new KeyboardEvent("keyup",u);return d.synthetic=!0,o.dispatchEvent(d),p.defaultPrevented||d.defaultPrevented}function getRoot(o){for(;o;){if(o&&(o.nodeType==9||o.nodeType==11&&o.host))return o;o=o.assignedSlot||o.parentNode}return null}function atElementStart(o,e){let a=e.focusNode,l=e.focusOffset;if(!a||e.anchorNode!=a||e.anchorOffset!=l)return!1;for(l=Math.min(l,maxOffset(a));;)if(l){if(a.nodeType!=1)return!1;let u=a.childNodes[l-1];u.contentEditable=="false"?l--:(a=u,l=maxOffset(a))}else{if(a==o)return!0;l=domIndex(a),a=a.parentNode}}function isScrolledToBottom(o){return o.scrollTop>Math.max(1,o.scrollHeight-o.clientHeight-4)}function textNodeBefore(o,e){for(let a=o,l=e;;){if(a.nodeType==3&&l>0)return{node:a,offset:l};if(a.nodeType==1&&l>0){if(a.contentEditable=="false")return null;a=a.childNodes[l-1],l=maxOffset(a)}else if(a.parentNode&&!isBlockElement(a))l=domIndex(a),a=a.parentNode;else return null}}function textNodeAfter(o,e){for(let a=o,l=e;;){if(a.nodeType==3&&l<a.nodeValue.length)return{node:a,offset:l};if(a.nodeType==1&&l<a.childNodes.length){if(a.contentEditable=="false")return null;a=a.childNodes[l],l=0}else if(a.parentNode&&!isBlockElement(a))l=domIndex(a)+1,a=a.parentNode;else return null}}class DOMPos{constructor(e,a,l=!0){this.node=e,this.offset=a,this.precise=l}static before(e,a){return new DOMPos(e.parentNode,domIndex(e),a)}static after(e,a){return new DOMPos(e.parentNode,domIndex(e)+1,a)}}var Direction=(function(o){return o[o.LTR=0]="LTR",o[o.RTL=1]="RTL",o})(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec$1(o){let e=[];for(let a=0;a<o.length;a++)e.push(1<<+o[a]);return e}const LowTypes=dec$1("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec$1("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let o of["()","[]","{}"]){let e=o.charCodeAt(0),a=o.charCodeAt(1);Brackets[e]=a,Brackets[a]=-e}function charType(o){return o<=247?LowTypes[o]:1424<=o&&o<=1524?2:1536<=o&&o<=1785?ArabicTypes[o-1536]:1774<=o&&o<=2220?4:8192<=o&&o<=8204?256:64336<=o&&o<=65023?4:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(e,a,l){this.from=e,this.to=a,this.level=l}side(e,a){return this.dir==a==e?this.to:this.from}forward(e,a){return e==(this.dir==a)}static find(e,a,l,u){let p=-1;for(let d=0;d<e.length;d++){let f=e[d];if(f.from<=a&&f.to>=a){if(f.level==l)return d;(p<0||(u!=0?u<0?f.from<a:f.to>a:e[p].level>f.level))&&(p=d)}}if(p<0)throw new RangeError("Index out of range");return p}}function isolatesEq(o,e){if(o.length!=e.length)return!1;for(let a=0;a<o.length;a++){let l=o[a],u=e[a];if(l.from!=u.from||l.to!=u.to||l.direction!=u.direction||!isolatesEq(l.inner,u.inner))return!1}return!0}const types$2=[];function computeCharTypes(o,e,a,l,u){for(let p=0;p<=l.length;p++){let d=p?l[p-1].to:e,f=p<l.length?l[p].from:a,g=p?256:u;for(let b=d,A=g,S=g;b<f;b++){let M=charType(o.charCodeAt(b));M==512?M=A:M==8&&S==4&&(M=16),types$2[b]=M==4?2:M,M&7&&(S=M),A=M}for(let b=d,A=g,S=g;b<f;b++){let M=types$2[b];if(M==128)b<f-1&&A==types$2[b+1]&&A&24?M=types$2[b]=A:types$2[b]=256;else if(M==64){let E=b+1;for(;E<f&&types$2[E]==64;)E++;let F=b&&A==8||E<a&&types$2[E]==8?S==1?1:8:256;for(let $=b;$<E;$++)types$2[$]=F;b=E-1}else M==8&&S==1&&(types$2[b]=1);A=M,M&7&&(S=M)}}}function processBracketPairs(o,e,a,l,u){let p=u==1?2:1;for(let d=0,f=0,g=0;d<=l.length;d++){let b=d?l[d-1].to:e,A=d<l.length?l[d].from:a;for(let S=b,M,E,F;S<A;S++)if(E=Brackets[M=o.charCodeAt(S)])if(E<0){for(let $=f-3;$>=0;$-=3)if(BracketStack[$+1]==-E){let Z=BracketStack[$+2],V=Z&2?u:Z&4?Z&1?p:u:0;V&&(types$2[S]=types$2[BracketStack[$]]=V),f=$;break}}else{if(BracketStack.length==189)break;BracketStack[f++]=S,BracketStack[f++]=M,BracketStack[f++]=g}else if((F=types$2[S])==2||F==1){let $=F==u;g=$?0:1;for(let Z=f-3;Z>=0;Z-=3){let V=BracketStack[Z+2];if(V&2)break;if($)BracketStack[Z+2]|=2;else{if(V&4)break;BracketStack[Z+2]|=4}}}}}function processNeutrals(o,e,a,l){for(let u=0,p=l;u<=a.length;u++){let d=u?a[u-1].to:o,f=u<a.length?a[u].from:e;for(let g=d;g<f;){let b=types$2[g];if(b==256){let A=g+1;for(;;)if(A==f){if(u==a.length)break;A=a[u++].to,f=u<a.length?a[u].from:e}else if(types$2[A]==256)A++;else break;let S=p==1,M=(A<e?types$2[A]:l)==1,E=S==M?S?1:2:l;for(let F=A,$=u,Z=$?a[$-1].to:o;F>g;)F==Z&&(F=a[--$].from,Z=$?a[$-1].to:o),types$2[--F]=E;g=A}else p=b,g++}}}function emitSpans(o,e,a,l,u,p,d){let f=l%2?2:1;if(l%2==u%2)for(let g=e,b=0;g<a;){let A=!0,S=!1;if(b==p.length||g<p[b].from){let $=types$2[g];$!=f&&(A=!1,S=$==16)}let M=!A&&f==1?[]:null,E=A?l:l+1,F=g;e:for(;;)if(b<p.length&&F==p[b].from){if(S)break e;let $=p[b];if(!A)for(let Z=$.to,V=b+1;;){if(Z==a)break e;if(V<p.length&&p[V].from==Z)Z=p[V++].to;else{if(types$2[Z]==f)break e;break}}if(b++,M)M.push($);else{$.from>g&&d.push(new BidiSpan(g,$.from,E));let Z=$.direction==LTR!=!(E%2);computeSectionOrder(o,Z?l+1:l,u,$.inner,$.from,$.to,d),g=$.to}F=$.to}else{if(F==a||(A?types$2[F]!=f:types$2[F]==f))break;F++}M?emitSpans(o,g,F,l+1,u,M,d):g<F&&d.push(new BidiSpan(g,F,E)),g=F}else for(let g=a,b=p.length;g>e;){let A=!0,S=!1;if(!b||g>p[b-1].to){let $=types$2[g-1];$!=f&&(A=!1,S=$==16)}let M=!A&&f==1?[]:null,E=A?l:l+1,F=g;e:for(;;)if(b&&F==p[b-1].to){if(S)break e;let $=p[--b];if(!A)for(let Z=$.from,V=b;;){if(Z==e)break e;if(V&&p[V-1].to==Z)Z=p[--V].from;else{if(types$2[Z-1]==f)break e;break}}if(M)M.push($);else{$.to<g&&d.push(new BidiSpan($.to,g,E));let Z=$.direction==LTR!=!(E%2);computeSectionOrder(o,Z?l+1:l,u,$.inner,$.from,$.to,d),g=$.from}F=$.from}else{if(F==e||(A?types$2[F-1]!=f:types$2[F-1]==f))break;F--}M?emitSpans(o,F,g,l+1,u,M,d):F<g&&d.push(new BidiSpan(F,g,E)),g=F}}function computeSectionOrder(o,e,a,l,u,p,d){let f=e%2?2:1;computeCharTypes(o,u,p,l,f),processBracketPairs(o,u,p,l,f),processNeutrals(u,p,l,f),emitSpans(o,u,p,e,a,l,d)}function computeOrder(o,e,a){if(!o)return[new BidiSpan(0,0,e==RTL?1:0)];if(e==LTR&&!a.length&&!BidiRE.test(o))return trivialOrder(o.length);if(a.length)for(;o.length>types$2.length;)types$2[types$2.length]=256;let l=[],u=e==LTR?0:1;return computeSectionOrder(o,u,u,a,0,o.length,l),l}function trivialOrder(o){return[new BidiSpan(0,o,0)]}let movedOver="";function moveVisually(o,e,a,l,u){var p;let d=l.head-o.from,f=BidiSpan.find(e,d,(p=l.bidiLevel)!==null&&p!==void 0?p:-1,l.assoc),g=e[f],b=g.side(u,a);if(d==b){let M=f+=u?1:-1;if(M<0||M>=e.length)return null;g=e[f=M],d=g.side(!u,a),b=g.side(u,a)}let A=findClusterBreak(o.text,d,g.forward(u,a));(A<g.from||A>g.to)&&(A=b),movedOver=o.text.slice(Math.min(d,A),Math.max(d,A));let S=f==(u?e.length-1:0)?null:e[f+(u?1:-1)];return S&&A==b&&S.level+(u?0:1)<g.level?EditorSelection.cursor(S.side(!u,a)+o.from,S.forward(u,a)?1:-1,S.level):EditorSelection.cursor(A+o.from,g.forward(u,a)?-1:1,g.level)}function autoDirection(o,e,a){for(let l=e;l<a;l++){let u=charType(o.charCodeAt(l));if(u==1)return LTR;if(u==2||u==4)return RTL}return LTR}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),clipboardInputFilter=Facet.define(),clipboardOutputFilter=Facet.define(),perLineTextDirection=Facet.define({combine:o=>o.some(e=>e)}),nativeSelectionHidden=Facet.define({combine:o=>o.some(e=>e)}),scrollHandler=Facet.define();class ScrollTarget{constructor(e,a="nearest",l="nearest",u=5,p=5,d=!1){this.range=e,this.y=a,this.x=l,this.yMargin=u,this.xMargin=p,this.isSnapshot=d}map(e){return e.empty?this:new ScrollTarget(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ScrollTarget(EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const scrollIntoView$1=StateEffect.define({map:(o,e)=>o.map(e)}),setEditContextFormatting=StateEffect.define();function logException(o,e,a){let l=o.facet(exceptionSink);l.length?l[0](e):window.onerror&&window.onerror(String(e),a,void 0,void 0,e)||(a?console.error(a+":",e):console.error(e))}const editable=Facet.define({combine:o=>o.length?o[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define({combine(o){return o.filter((e,a)=>{for(let l=0;l<a;l++)if(o[l].plugin==e.plugin)return!1;return!0})}});class ViewPlugin{constructor(e,a,l,u,p){this.id=e,this.create=a,this.domEventHandlers=l,this.domEventObservers=u,this.baseExtensions=p(this),this.extension=this.baseExtensions.concat(viewPlugin.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(viewPlugin.of({plugin:this,arg:e}))}static define(e,a){const{eventHandlers:l,eventObservers:u,provide:p,decorations:d}=a||{};return new ViewPlugin(nextPluginID++,e,l,u,f=>{let g=[];return d&&g.push(decorations.of(b=>{let A=b.plugin(f);return A?d(A):Decoration.none})),p&&g.push(p(f)),g})}static fromClass(e,a){return ViewPlugin.define((l,u)=>new e(l,u),a)}}class PluginInstance{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let a=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(a)}catch(l){if(logException(a.state,l,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(a){logException(e.state,a,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var a;if(!((a=this.value)===null||a===void 0)&&a.destroy)try{this.value.destroy()}catch(l){logException(e.state,l,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),blockWrappers=Facet.define(),outerDecorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(o,e){let a=o.state.facet(bidiIsolatedRanges);if(!a.length)return a;let l=a.map(p=>p instanceof Function?p(o):p),u=[];return RangeSet.spans(l,e.from,e.to,{point(){},span(p,d,f,g){let b=p-e.from,A=d-e.from,S=u;for(let M=f.length-1;M>=0;M--,g--){let E=f[M].spec.bidiIsolate,F;if(E==null&&(E=autoDirection(e.text,b,A)),g>0&&S.length&&(F=S[S.length-1]).to==b&&F.direction==E)F.to=A,S=F.inner;else{let $={from:b,to:A,direction:E,inner:[]};S.push($),S=$.inner}}}}),u}const scrollMargins=Facet.define();function getScrollMargins(o){let e=0,a=0,l=0,u=0;for(let p of o.state.facet(scrollMargins)){let d=p(o);d&&(d.left!=null&&(e=Math.max(e,d.left)),d.right!=null&&(a=Math.max(a,d.right)),d.top!=null&&(l=Math.max(l,d.top)),d.bottom!=null&&(u=Math.max(u,d.bottom)))}return{left:e,right:a,top:l,bottom:u}}const styleModule=Facet.define();class ChangedRange{constructor(e,a,l,u){this.fromA=e,this.toA=a,this.fromB=l,this.toB=u}join(e){return new ChangedRange(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let a=e.length,l=this;for(;a>0;a--){let u=e[a-1];if(!(u.fromA>l.toA)){if(u.toA<l.fromA)break;l=l.join(u),e.splice(a-1,1)}}return e.splice(a,0,l),e}static extendWithRanges(e,a){if(a.length==0)return e;let l=[];for(let u=0,p=0,d=0;;){let f=u<e.length?e[u].fromB:1e9,g=p<a.length?a[p]:1e9,b=Math.min(f,g);if(b==1e9)break;let A=b+d,S=b,M=A;for(;;)if(p<a.length&&a[p]<=S){let E=a[p+1];p+=2,S=Math.max(S,E);for(let F=u;F<e.length&&e[F].fromB<=S;F++)d=e[F].toA-e[F].toB;M=Math.max(M,E+d)}else if(u<e.length&&e[u].fromB<=S){let E=e[u++];S=Math.max(S,E.toB),M=Math.max(M,E.toA),d=E.toA-E.toB}else break;l.push(new ChangedRange(A,M,b,S))}return l}}class ViewUpdate{constructor(e,a,l){this.view=e,this.state=a,this.transactions=l,this.flags=0,this.startState=e.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let p of l)this.changes=this.changes.compose(p.changes);let u=[];this.changes.iterChangedRanges((p,d,f,g)=>u.push(new ChangedRange(p,d,f,g))),this.changedRanges=u}static create(e,a,l){return new ViewUpdate(e,a,l)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const noChildren=[];class Tile{constructor(e,a,l=0){this.dom=e,this.length=a,this.flags=l,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return noChildren}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let a=this.domAttrs;a&&setAttrs(this.dom,a)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,a=this.posAtStart){let l=a;for(let u of this.children){if(u==e)return l;l+=u.length+u.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,a){return null}domPosFor(e,a){let l=domIndex(this.dom),u=this.length?e>0:a>0;return new DOMPos(this.parent.dom,l+(u?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof DocTile)return e;return null}static get(e){return e.cmTile}}class CompositeTile extends Tile{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let a=this.dom,l=null,u,p=e?.node==a?e:null,d=0;for(let f of this.children){if(f.sync(e),d+=f.length+f.breakAfter,u=l?l.nextSibling:a.firstChild,p&&u!=f.dom&&(p.written=!0),f.dom.parentNode==a)for(;u&&u!=f.dom;)u=rm$1(u);else a.insertBefore(f.dom,u);l=f.dom}for(u=l?l.nextSibling:a.firstChild,p&&u&&(p.written=!0);u;)u=rm$1(u);this.length=d}}function rm$1(o){let e=o.nextSibling;return o.parentNode.removeChild(o),e}class DocTile extends CompositeTile{constructor(e,a){super(a),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let a=Tile.get(e);if(a&&this.owns(a))return a;e=e.parentNode}}blockTiles(e){for(let a=[],l=this,u=0,p=0;;)if(u==l.children.length){if(!a.length)return;l=l.parent,l.breakAfter&&p++,u=a.pop()}else{let d=l.children[u++];if(d instanceof BlockWrapperTile)a.push(u),l=d,u=0;else{let f=p+d.length,g=e(d,p);if(g!==void 0)return g;p=f+d.breakAfter}}}resolveBlock(e,a){let l,u=-1,p,d=-1;if(this.blockTiles((f,g)=>{let b=g+f.length;if(e>=g&&e<=b){if(f.isWidget()&&a>=-1&&a<=1){if(f.flags&32)return!0;f.flags&16&&(l=void 0)}(g<e||e==b&&(a<-1?f.length:f.covers(1)))&&(!l||!f.isWidget()&&l.isWidget())&&(l=f,u=e-g),(b>e||e==g&&(a>1?f.length:f.covers(-1)))&&(!p||!f.isWidget()&&p.isWidget())&&(p=f,d=e-g)}}),!l&&!p)throw new Error("No tile at position "+e);return l&&a<0||!p?{tile:l,offset:u}:{tile:p,offset:d}}}class BlockWrapperTile extends CompositeTile{constructor(e,a){super(e),this.wrapper=a}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,a){let l=new BlockWrapperTile(a||document.createElement(e.tagName),e);return a||(l.flags|=4),l}}class LineTile extends CompositeTile{constructor(e,a){super(e),this.attrs=a}isLine(){return!0}static start(e,a,l){let u=new LineTile(a||document.createElement("div"),e);return(!a||!l)&&(u.flags|=4),u}get domAttrs(){return this.attrs}resolveInline(e,a,l){let u=null,p=-1,d=null,f=-1;function g(A,S){for(let M=0,E=0;M<A.children.length&&E<=S;M++){let F=A.children[M],$=E+F.length;$>=S&&(F.isComposite()?g(F,S-E):(!d||d.isHidden&&(a>0||l&&onSameLine(d,F)))&&($>S||F.flags&32)?(d=F,f=S-E):(E<S||F.flags&16&&!F.isHidden)&&(u=F,p=S-E)),E=$}}g(this,e);let b=(a<0?u:d)||u||d;return b?{tile:b,offset:b==u?p:f}:null}coordsIn(e,a){let l=this.resolveInline(e,a,!0);return l?l.tile.coordsIn(Math.max(0,l.offset),a):fallbackRect(this)}domIn(e,a){let l=this.resolveInline(e,a);if(l){let{tile:u,offset:p}=l;if(this.dom.contains(u.dom))return u.isText()?new DOMPos(u.dom,Math.min(u.dom.nodeValue.length,p)):u.domPosFor(p,u.flags&16?1:u.flags&32?-1:a);let d=l.tile.parent,f=!1;for(let g of d.children){if(f)return new DOMPos(g.dom,0);g==l.tile&&(f=!0)}}return new DOMPos(this.dom,0)}}function fallbackRect(o){let e=o.dom.lastChild;if(!e)return o.dom.getBoundingClientRect();let a=clientRectsFor(e);return a[a.length-1]||null}function onSameLine(o,e){let a=o.coordsIn(0,1),l=e.coordsIn(0,1);return a&&l&&l.top<a.bottom}class MarkTile extends CompositeTile{constructor(e,a){super(e),this.mark=a}get domAttrs(){return this.mark.attrs}static of(e,a){let l=new MarkTile(a||document.createElement(e.tagName),e);return a||(l.flags|=4),l}}class TextTile extends Tile{constructor(e,a){super(e,a.length),this.text=a}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,a){let l=this.dom.nodeValue.length;e>l&&(e=l);let u=e,p=e,d=0;e==0&&a<0||e==l&&a>=0?browser.chrome||browser.gecko||(e?(u--,d=1):p<l&&(p++,d=-1)):a<0?u--:p<l&&p++;let f=textRange(this.dom,u,p).getClientRects();if(!f.length)return null;let g=f[(d?d<0:a>=0)?0:f.length-1];return browser.safari&&!d&&g.width==0&&(g=Array.prototype.find.call(f,b=>b.width)||g),d?flattenRect(g,d<0):g||null}static of(e,a){let l=new TextTile(a||document.createTextNode(e),e);return a||(l.flags|=2),l}}class WidgetTile extends Tile{constructor(e,a,l,u){super(e,a,u),this.widget=l}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,a){return this.coordsInWidget(e,a,!1)}coordsInWidget(e,a,l){let u=this.widget.coordsAt(this.dom,e,a);if(u)return u;if(l)return flattenRect(this.dom.getBoundingClientRect(),this.length?e==0:a<=0);{let p=this.dom.getClientRects(),d=null;if(!p.length)return null;let f=this.flags&16?!0:this.flags&32?!1:e>0;for(let g=f?p.length-1:0;d=p[g],!(e>0?g==0:g==p.length-1||d.top<d.bottom);g+=f?-1:1);return flattenRect(d,!f)}}get overrideDOMText(){if(!this.length)return Text.empty;let{root:e}=this;if(!e)return Text.empty;let a=this.posAtStart;return e.view.state.doc.slice(a,a+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,a,l,u,p){return p||(p=e.toDOM(a),e.editable||(p.contentEditable="false")),new WidgetTile(p,l,e,u)}}class WidgetBufferTile extends Tile{constructor(e){let a=document.createElement("img");a.className="cm-widgetBuffer",a.setAttribute("aria-hidden","true"),super(a,0,e)}get isHidden(){return!1}get overrideDOMText(){return Text.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class TilePointer{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,a,l){let{tile:u,index:p,beforeBreak:d,parents:f}=this;for(;e||a>0;)if(u.isComposite())if(d){if(!e)break;l&&l.break(),e--,d=!1}else if(p==u.children.length){if(!e&&!f.length)break;l&&l.leave(u),d=!!u.breakAfter,{tile:u,index:p}=f.pop(),p++}else{let g=u.children[p],b=g.breakAfter;(a>0?g.length<=e:g.length<e)&&(!l||l.skip(g,0,g.length)!==!1||!g.isComposite)?(d=!!b,p++,e-=g.length):(f.push({tile:u,index:p}),u=g,p=0,l&&g.isComposite()&&l.enter(g))}else if(p==u.length)d=!!u.breakAfter,{tile:u,index:p}=f.pop(),p++;else if(e){let g=Math.min(e,u.length-p);l&&l.skip(u,p,p+g),e-=g,p+=g}else break;return this.tile=u,this.index=p,this.beforeBreak=d,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class OpenWrapper{constructor(e,a,l,u){this.from=e,this.to=a,this.wrapper=l,this.rank=u}}class TileBuilder{constructor(e,a,l){this.cache=e,this.root=a,this.blockWrappers=l,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,a,l,u){var p;this.flushBuffer();let d=this.ensureMarks(a,l),f=d.lastChild;if(f&&f.isText()&&!(f.flags&8)){this.cache.reused.set(f,2);let g=d.children[d.children.length-1]=new TextTile(f.dom,f.text+e);g.parent=d}else d.append(u||TextTile.of(e,(p=this.cache.find(TextTile))===null||p===void 0?void 0:p.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,a){let l=this.curLine;l.dom!=a.line.dom&&(l.setDOM(this.cache.reused.has(a.line)?freeNode(a.line.dom):a.line.dom),this.cache.reused.set(a.line,2));let u=l;for(let d=a.marks.length-1;d>=0;d--){let f=a.marks[d],g=u.lastChild;if(g instanceof MarkTile&&g.mark.eq(f.mark))g.dom!=f.dom&&g.setDOM(freeNode(f.dom)),u=g;else{if(this.cache.reused.get(f)){let A=Tile.get(f.dom);A&&A.setDOM(freeNode(f.dom))}let b=MarkTile.of(f.mark,f.dom);u.append(b),u=b}this.cache.reused.set(f,2)}let p=new TextTile(e.text,e.text.nodeValue);p.flags|=8,u.append(p)}addInlineWidget(e,a,l){let u=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);u||this.flushBuffer();let p=this.ensureMarks(a,l);!u&&!(e.flags&16)&&p.append(this.getBuffer(1)),p.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,a,l){this.flushBuffer(),this.ensureMarks(a,l).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let a=this.afterWidget||this.lastBlock;a.length+=e,this.pos+=e}addLineStart(e,a){var l;e||(e=lineBaseAttrs);let u=LineTile.start(e,a||((l=this.cache.find(LineTile))===null||l===void 0?void 0:l.dom),!!a);this.getBlockPos().append(this.lastBlock=this.curLine=u)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,a){var l;let u=this.curLine;for(let p=e.length-1;p>=0;p--){let d=e[p],f;if(a>0&&(f=u.lastChild)&&f instanceof MarkTile&&f.mark.eq(d))u=f,a--;else{let g=MarkTile.of(d,(l=this.cache.find(MarkTile,b=>b.mark.eq(d)))===null||l===void 0?void 0:l.dom);u.append(g),u=g,a=0}}return u}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!hasContent(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(browser.ios&&hasContent(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(BreakWidget,0,32)||new WidgetTile(BreakWidget.toDOM(),0,BreakWidget,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let a=new OpenWrapper(e.from,e.to,e.value,e.rank),l=this.wrappers.length;for(;l>0&&(this.wrappers[l-1].rank-a.rank||this.wrappers[l-1].to-a.to)<0;)l--;this.wrappers.splice(l,0,a)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let a=this.root;for(let l of this.wrappers){let u=a.lastChild;if(l.from<this.pos&&u instanceof BlockWrapperTile&&u.wrapper.eq(l.wrapper))a=u;else{let p=BlockWrapperTile.of(l.wrapper,(e=this.cache.find(BlockWrapperTile,d=>d.wrapper.eq(l.wrapper)))===null||e===void 0?void 0:e.dom);a.append(p),a=p}}return a}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let a=2|(e<0?16:32),l=this.cache.find(WidgetBufferTile,void 0,1);return l&&(l.flags=a),l||new WidgetBufferTile(a)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class TextStream{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:u,lineBreak:p,done:d}=this.cursor.next(this.skipCount);if(this.skipCount=0,d)throw new Error("Ran out of text content when drawing inline views");this.text=u;let f=this.textOff=Math.min(e,u.length);return p?null:u.slice(0,f)}let a=Math.min(this.text.length,this.textOff+e),l=this.text.slice(this.textOff,a);return this.textOff=a,l}}const buckets=[WidgetTile,LineTile,TextTile,MarkTile,WidgetBufferTile,BlockWrapperTile,DocTile];for(let o=0;o<buckets.length;o++)buckets[o].bucket=o;class TileCache{constructor(e){this.view=e,this.buckets=buckets.map(()=>[]),this.index=buckets.map(()=>0),this.reused=new Map}add(e){let a=e.constructor.bucket,l=this.buckets[a];l.length<6?l.push(e):l[this.index[a]=(this.index[a]+1)%6]=e}find(e,a,l=2){let u=e.bucket,p=this.buckets[u],d=this.index[u];for(let f=p.length-1;f>=0;f--){let g=(f+d)%p.length,b=p[g];if((!a||a(b))&&!this.reused.has(b))return p.splice(g,1),g<d&&this.index[u]--,this.reused.set(b,l),b}return null}findWidget(e,a,l){let u=this.buckets[0];if(u.length)for(let p=0,d=0;;p++){if(p==u.length){if(d)return null;d=1,p=0}let f=u[p];if(!this.reused.has(f)&&(d==0?f.widget.compare(e):f.widget.constructor==e.constructor&&e.updateDOM(f.dom,this.view)))return u.splice(p,1),p<this.index[0]&&this.index[0]--,this.reused.set(f,1),f.length=a,f.flags=f.flags&-498|l,f}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,a=2){if(!this.reused.has(e))return this.reused.set(e,a),e.dom}}class TileUpdate{constructor(e,a,l,u,p){this.view=e,this.decorations=u,this.disallowBlockEffectsFor=p,this.openWidget=!1,this.openMarks=0,this.cache=new TileCache(e),this.text=new TextStream(e.state.doc),this.builder=new TileBuilder(this.cache,new DocTile(e,e.contentDOM),RangeSet.iter(l)),this.cache.reused.set(a,2),this.old=new TilePointer(a)}run(e,a){let l=a&&this.getCompositionContext(a.text);for(let u=0,p=0,d=0;;){let f=d<e.length?e[d++]:null,g=f?f.fromA:this.old.root.length;if(g>u){let b=g-u;this.preserve(b,!d,!f),u=g,p+=b}if(!f)break;this.forward(f.fromA,f.toA),a&&f.fromA<=a.range.fromA&&f.toA>=a.range.toA?(this.emit(p,a.range.fromB),this.builder.addComposition(a,l),this.emit(a.range.toB,f.toB)):this.emit(p,f.toB),p=f.toB,u=f.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,a,l){let u=getMarks(this.old),p=this.openMarks;this.old.advance(e,l?1:-1,{skip:(d,f,g)=>{if(d.isWidget())if(this.openWidget)this.builder.continueWidget(g-f);else{let b=g>0||f<d.length?WidgetTile.of(d.widget,this.view,g-f,d.flags&496,this.cache.maybeReuse(d)):this.cache.reuse(d);b.flags&256?(b.flags&=-2,this.builder.addBlockWidget(b)):(this.builder.ensureLine(null),this.builder.addInlineWidget(b,u,p),p=u.length)}else if(d.isText())this.builder.ensureLine(null),!f&&g==d.length?this.builder.addText(d.text,u,p,this.cache.reuse(d)):(this.cache.add(d),this.builder.addText(d.text.slice(f,g),u,p)),p=u.length;else if(d.isLine())d.flags&=-2,this.cache.reused.set(d,1),this.builder.addLine(d);else if(d instanceof WidgetBufferTile)this.cache.add(d);else if(d instanceof MarkTile)this.builder.ensureLine(null),this.builder.addMark(d,u,p),this.cache.reused.set(d,1),p=u.length;else return!1;this.openWidget=!1},enter:d=>{d.isLine()?this.builder.addLineStart(d.attrs,this.cache.maybeReuse(d)):(this.cache.add(d),d instanceof MarkTile&&u.unshift(d.mark)),this.openWidget=!1},leave:d=>{d.isLine()?u.length&&(u.length=p=0):d instanceof MarkTile&&(u.shift(),p=Math.min(p,u.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,a){let l=null,u=this.builder,p=0,d=RangeSet.spans(this.decorations,e,a,{point:(f,g,b,A,S,M)=>{if(b instanceof PointDecoration){if(this.disallowBlockEffectsFor[M]){if(b.block)throw new RangeError("Block decorations may not be specified via plugins");if(g>this.view.state.doc.lineAt(f).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(p=A.length,S>A.length)u.continueWidget(g-f);else{let E=b.widget||(b.block?NullWidget.block:NullWidget.inline),F=widgetFlags(b),$=this.cache.findWidget(E,g-f,F)||WidgetTile.of(E,this.view,g-f,F);b.block?(b.startSide>0&&u.addLineStartIfNotCovered(l),u.addBlockWidget($)):(u.ensureLine(l),u.addInlineWidget($,A,S))}l=null}else l=addLineDeco(l,b);g>f&&this.text.skip(g-f)},span:(f,g,b,A)=>{for(let S=f;S<g;){let M=this.text.next(Math.min(512,g-S));M==null?(u.addLineStartIfNotCovered(l),u.addBreak(),S++):(u.ensureLine(l),u.addText(M,b,A),S+=M.length),l=null}}});u.addLineStartIfNotCovered(l),this.openWidget=d>p,this.openMarks=d}forward(e,a){this.old.advance(a-e,1,{skip:(l,u,p)=>{(l.isText()||p==l.length)&&this.cache.add(l)},enter:l=>this.cache.add(l),leave:()=>{},break:()=>{}})}getCompositionContext(e){let a=[],l=null;for(let u=e.parentNode;;u=u.parentNode){let p=Tile.get(u);if(u==this.view.contentDOM)break;p instanceof MarkTile?a.push(p):p?.isLine()?l=p:u.nodeName=="DIV"&&!l&&u!=this.view.contentDOM?l=new LineTile(u,lineBaseAttrs):a.push(MarkTile.of(new MarkDecoration({tagName:u.nodeName.toLowerCase(),attributes:getAttrs(u)}),u))}return{line:l,marks:a}}}function hasContent(o,e){let a=l=>{for(let u of l.children)if((e?u.isText():u.length)||a(u))return!0;return!1};return a(o)}function widgetFlags(o){let e=o.isReplace?(o.startSide<0?64:0)|(o.endSide>0?128:0):o.startSide>0?32:16;return o.block&&(e|=256),e}const lineBaseAttrs={class:"cm-line"};function addLineDeco(o,e){let a=e.spec.attributes,l=e.spec.class;return!a&&!l||(o||(o={class:"cm-line"}),a&&combineAttrs(a,o),l&&(o.class+=" "+l)),o}function getMarks(o){let e=[];for(let a=o.parents.length;a>1;a--){let l=a==o.parents.length?o.tile:o.parents[a].tile;l instanceof MarkTile&&e.push(l.mark)}return e}function freeNode(o){let e=Tile.get(o);return e&&e.setDOM(o.cloneNode()),o}class NullWidget extends WidgetType{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}NullWidget.inline=new NullWidget("span"),NullWidget.block=new NullWidget("div");const BreakWidget=new class extends WidgetType{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class DocView{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=Decoration.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new DocTile(e,e.contentDOM),this.updateInner([new ChangedRange(0,0,0,e.state.doc.length)],null)}update(e){var a;let l=e.changedRanges;this.minWidth>0&&l.length&&(l.every(({fromA:A,toA:S})=>S<this.minWidthFrom||A>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let u=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((a=this.domChanged)===null||a===void 0)&&a.newSel?u=this.domChanged.newSel.head:!touchesComposition(e.changes,this.hasComposition)&&!e.selectionSet&&(u=e.state.selection.main.head));let p=u>-1?findCompositionRange(this.view,e.changes,u):null;if(this.domChanged=null,this.hasComposition){let{from:A,to:S}=this.hasComposition;l=new ChangedRange(A,S,e.changes.mapPos(A,-1),e.changes.mapPos(S,1)).addToSet(l.slice())}this.hasComposition=p?{from:p.range.fromB,to:p.range.toB}:null,(browser.ie||browser.chrome)&&!p&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let d=this.decorations,f=this.blockWrappers;this.updateDeco();let g=findChangedDeco(d,this.decorations,e.changes);g.length&&(l=ChangedRange.extendWithRanges(l,g));let b=findChangedWrappers(f,this.blockWrappers,e.changes);return b.length&&(l=ChangedRange.extendWithRanges(l,b)),p&&!l.some(A=>A.fromA<=p.range.fromA&&A.toA>=p.range.toA)&&(l=p.range.addToSet(l.slice())),this.tile.flags&2&&l.length==0?!1:(this.updateInner(l,p),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,a){this.view.viewState.mustMeasureContent=!0;let{observer:l}=this.view;l.ignore(()=>{if(a||e.length){let d=this.tile,f=new TileUpdate(this.view,d,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=f.run(e,a),destroyDropped(d,f.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let p=browser.chrome||browser.ios?{node:l.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(p),p&&(p.written||l.selectionRange.focusNode!=p.node||!this.tile.dom.contains(p.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let u=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let p of this.tile.children)p.isWidget()&&p.widget instanceof BlockGapWidget&&u.push(p.dom);l.updateGaps(u)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let a of e.transactions)for(let l of a.effects)l.is(setEditContextFormatting)&&(this.editContextFormatting=l.value)}updateSelection(e=!1,a=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:l}=this.tile,u=this.view.root.activeElement,p=u==l,d=!p&&!(this.view.state.facet(editable)||l.tabIndex>-1)&&hasSelection(l,this.view.observer.selectionRange)&&!(u&&l.contains(u));if(!(p||a||d))return;let f=this.forceSelection;this.forceSelection=!1;let g=this.view.state.selection.main,b,A;if(g.empty?A=b=this.inlineDOMNearPos(g.anchor,g.assoc||1):(A=this.inlineDOMNearPos(g.head,g.head==g.from?1:-1),b=this.inlineDOMNearPos(g.anchor,g.anchor==g.from?1:-1)),browser.gecko&&g.empty&&!this.hasComposition&&betweenUneditable(b)){let M=document.createTextNode("");this.view.observer.ignore(()=>b.node.insertBefore(M,b.node.childNodes[b.offset]||null)),b=A=new DOMPos(M,0),f=!0}let S=this.view.observer.selectionRange;(f||!S.focusNode||(!isEquivalentPosition(b.node,b.offset,S.anchorNode,S.anchorOffset)||!isEquivalentPosition(A.node,A.offset,S.focusNode,S.focusOffset))&&!this.suppressWidgetCursorChange(S,g))&&(this.view.observer.ignore(()=>{browser.android&&browser.chrome&&l.contains(S.focusNode)&&inUneditable(S.focusNode,l)&&(l.blur(),l.focus({preventScroll:!0}));let M=getSelection(this.view.root);if(M)if(g.empty){if(browser.gecko){let E=nextToUneditable(b.node,b.offset);if(E&&E!=3){let F=(E==1?textNodeBefore:textNodeAfter)(b.node,b.offset);F&&(b=new DOMPos(F.node,F.offset))}}M.collapse(b.node,b.offset),g.bidiLevel!=null&&M.caretBidiLevel!==void 0&&(M.caretBidiLevel=g.bidiLevel)}else if(M.extend){M.collapse(b.node,b.offset);try{M.extend(A.node,A.offset)}catch{}}else{let E=document.createRange();g.anchor>g.head&&([b,A]=[A,b]),E.setEnd(A.node,A.offset),E.setStart(b.node,b.offset),M.removeAllRanges(),M.addRange(E)}d&&this.view.root.activeElement==l&&(l.blur(),u&&u.focus())}),this.view.observer.setSelectionRange(b,A)),this.impreciseAnchor=b.precise?null:new DOMPos(S.anchorNode,S.anchorOffset),this.impreciseHead=A.precise?null:new DOMPos(S.focusNode,S.focusOffset)}suppressWidgetCursorChange(e,a){return this.hasComposition&&a.empty&&isEquivalentPosition(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==a.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,a=e.state.selection.main,l=getSelection(e.root),{anchorNode:u,anchorOffset:p}=e.observer.selectionRange;if(!l||!a.empty||!a.assoc||!l.modify)return;let d=this.lineAt(a.head,a.assoc);if(!d)return;let f=d.posAtStart;if(a.head==f||a.head==f+d.length)return;let g=this.coordsAt(a.head,-1),b=this.coordsAt(a.head,1);if(!g||!b||g.bottom>b.top)return;let A=this.domAtPos(a.head+a.assoc,a.assoc);l.collapse(A.node,A.offset),l.modify("move",a.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let S=e.observer.selectionRange;e.docView.posFromDOM(S.anchorNode,S.anchorOffset)!=a.from&&l.collapse(u,p)}posFromDOM(e,a){let l=this.tile.nearest(e);if(!l)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let u=l.posAtStart;if(l.isComposite()){let p;if(e==l.dom)p=l.dom.childNodes[a];else{let d=maxOffset(e)==0?0:a==0?-1:1;for(;;){let f=e.parentNode;if(f==l.dom)break;d==0&&f.firstChild!=f.lastChild&&(e==f.firstChild?d=-1:d=1),e=f}d<0?p=e:p=e.nextSibling}if(p==l.dom.firstChild)return u;for(;p&&!Tile.get(p);)p=p.nextSibling;if(!p)return u+l.length;for(let d=0,f=u;;d++){let g=l.children[d];if(g.dom==p)return f;f+=g.length+g.breakAfter}}else return l.isText()?e==l.dom?u+a:u+(a?l.length:0):u}domAtPos(e,a){let{tile:l,offset:u}=this.tile.resolveBlock(e,a);return l.isWidget()?l.domPosFor(e,a):l.domIn(u,a)}inlineDOMNearPos(e,a){let l,u=-1,p=!1,d,f=-1,g=!1;return this.tile.blockTiles((b,A)=>{if(b.isWidget()){if(b.flags&32&&A>=e)return!0;b.flags&16&&(p=!0)}else{let S=A+b.length;if(A<=e&&(l=b,u=e-A,p=S<e),S>=e&&!d&&(d=b,f=e-A,g=A>e),A>e&&d)return!0}}),!l&&!d?this.domAtPos(e,a):(p&&d?l=null:g&&l&&(d=null),l&&a<0||!d?l.domIn(u,a):d.domIn(f,a))}coordsAt(e,a){let{tile:l,offset:u}=this.tile.resolveBlock(e,a);return l.isWidget()?l.widget instanceof BlockGapWidget?null:l.coordsInWidget(u,a,!0):l.coordsIn(u,a)}lineAt(e,a){let{tile:l}=this.tile.resolveBlock(e,a);return l.isLine()?l:null}coordsForChar(e){let{tile:a,offset:l}=this.tile.resolveBlock(e,1);if(!a.isLine())return null;function u(p,d){if(p.isComposite())for(let f of p.children){if(f.length>=d){let g=u(f,d);if(g)return g}if(d-=f.length,d<0)break}else if(p.isText()&&d<p.length){let f=findClusterBreak(p.text,d);if(f==d)return null;let g=textRange(p.dom,d,f).getClientRects();for(let b=0;b<g.length;b++){let A=g[b];if(b==g.length-1||A.top<A.bottom&&A.left<A.right)return A}}return null}return u(a,l)}measureVisibleLineHeights(e){let a=[],{from:l,to:u}=e,p=this.view.contentDOM.clientWidth,d=p>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,f=-1,g=this.view.textDirection==Direction.LTR,b=0,A=(S,M,E)=>{for(let F=0;F<S.children.length&&!(M>u);F++){let $=S.children[F],Z=M+$.length,V=$.dom.getBoundingClientRect(),{height:K}=V;if(E&&!F&&(b+=V.top-E.top),$ instanceof BlockWrapperTile)Z>l&&A($,M,V);else if(M>=l&&(b>0&&a.push(-b),a.push(K+b),b=0,d)){let se=$.dom.lastChild,z=se?clientRectsFor(se):[];if(z.length){let U=z[z.length-1],ee=g?U.right-V.left:V.right-U.left;ee>f&&(f=ee,this.minWidth=p,this.minWidthFrom=M,this.minWidthTo=Z)}}E&&F==S.children.length-1&&(b+=E.bottom-V.bottom),M=Z+$.breakAfter}};return A(this.tile,0,null),a}textDirectionAt(e){let{tile:a}=this.tile.resolveBlock(e,1);return getComputedStyle(a.dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){let e=this.tile.blockTiles(d=>{if(d.isLine()&&d.children.length&&d.length<=20){let f=0,g;for(let b of d.children){if(!b.isText()||/[^ -~]/.test(b.text))return;let A=clientRectsFor(b.dom);if(A.length!=1)return;f+=A[0].width,g=A[0].height}if(f)return{lineHeight:d.dom.getBoundingClientRect().height,charWidth:f/d.length,textHeight:g}}});if(e)return e;let a=document.createElement("div"),l,u,p;return a.className="cm-line",a.style.width="99999px",a.style.position="absolute",a.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(a);let d=clientRectsFor(a.firstChild)[0];l=a.getBoundingClientRect().height,u=d&&d.width?d.width/27:7,p=d&&d.height?d.height:l,a.remove()}),{lineHeight:l,charWidth:u,textHeight:p}}computeBlockGapDeco(){let e=[],a=this.view.viewState;for(let l=0,u=0;;u++){let p=u==a.viewports.length?null:a.viewports[u],d=p?p.from-1:this.view.state.doc.length;if(d>l){let f=(a.lineBlockAt(d).bottom-a.lineBlockAt(l).top)/this.view.scaleY;e.push(Decoration.replace({widget:new BlockGapWidget(f),block:!0,inclusive:!0,isBlockGap:!0}).range(l,d))}if(!p)break;l=p.to+1}return Decoration.set(e)}updateDeco(){let e=1,a=this.view.state.facet(decorations).map(p=>(this.dynamicDecorationMap[e++]=typeof p=="function")?p(this.view):p),l=!1,u=this.view.state.facet(outerDecorations).map((p,d)=>{let f=typeof p=="function";return f&&(l=!0),f?p(this.view):p});for(u.length&&(this.dynamicDecorationMap[e++]=l,a.push(RangeSet.join(u))),this.decorations=[this.editContextFormatting,...a,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(blockWrappers).map(p=>typeof p=="function"?p(this.view):p)}scrollIntoView(e){if(e.isSnapshot){let b=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=b.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let b of this.view.state.facet(scrollHandler))try{if(b(this.view,e.range,e))return!0}catch(A){logException(this.view.state,A,"scroll handler")}let{range:a}=e,l=this.coordsAt(a.head,a.empty?a.assoc:a.head>a.anchor?-1:1),u;if(!l)return;!a.empty&&(u=this.coordsAt(a.anchor,a.anchor>a.head?-1:1))&&(l={left:Math.min(l.left,u.left),top:Math.min(l.top,u.top),right:Math.max(l.right,u.right),bottom:Math.max(l.bottom,u.bottom)});let p=getScrollMargins(this.view),d={left:l.left-p.left,top:l.top-p.top,right:l.right+p.right,bottom:l.bottom+p.bottom},{offsetWidth:f,offsetHeight:g}=this.view.scrollDOM;scrollRectIntoView(this.view.scrollDOM,d,a.head<a.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,f),-f),Math.max(Math.min(e.yMargin,g),-g),this.view.textDirection==Direction.LTR)}lineHasWidget(e){let a=l=>l.isWidget()||l.children.some(a);return a(this.tile.resolveBlock(e,1).tile)}destroy(){destroyDropped(this.tile)}}function destroyDropped(o,e){let a=e?.get(o);if(a!=1){a==null&&o.destroy();for(let l of o.children)destroyDropped(l,e)}}function betweenUneditable(o){return o.node.nodeType==1&&o.node.firstChild&&(o.offset==0||o.node.childNodes[o.offset-1].contentEditable=="false")&&(o.offset==o.node.childNodes.length||o.node.childNodes[o.offset].contentEditable=="false")}function findCompositionNode(o,e){let a=o.observer.selectionRange;if(!a.focusNode)return null;let l=textNodeBefore(a.focusNode,a.focusOffset),u=textNodeAfter(a.focusNode,a.focusOffset),p=l||u;if(u&&l&&u.node!=l.node){let f=Tile.get(u.node);if(!f||f.isText()&&f.text!=u.node.nodeValue)p=u;else if(o.docView.lastCompositionAfterCursor){let g=Tile.get(l.node);!g||g.isText()&&g.text!=l.node.nodeValue||(p=u)}}if(o.docView.lastCompositionAfterCursor=p!=l,!p)return null;let d=e-p.offset;return{from:d,to:d+p.node.nodeValue.length,node:p.node}}function findCompositionRange(o,e,a){let l=findCompositionNode(o,a);if(!l)return null;let{node:u,from:p,to:d}=l,f=u.nodeValue;if(/[\n\r]/.test(f)||o.state.doc.sliceString(l.from,l.to)!=f)return null;let g=e.invertedDesc;return{range:new ChangedRange(g.mapPos(p),g.mapPos(d),p,d),text:u}}function nextToUneditable(o,e){return o.nodeType!=1?0:(e&&o.childNodes[e-1].contentEditable=="false"?1:0)|(e<o.childNodes.length&&o.childNodes[e].contentEditable=="false"?2:0)}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(e,a){addRange(e,a,this.changes)}comparePoint(e,a){addRange(e,a,this.changes)}boundChange(e){addRange(e,e,this.changes)}};function findChangedDeco(o,e,a){let l=new DecorationComparator$1;return RangeSet.compare(o,e,a,l),l.changes}class WrapperComparator{constructor(){this.changes=[]}compareRange(e,a){addRange(e,a,this.changes)}comparePoint(){}boundChange(e){addRange(e,e,this.changes)}}function findChangedWrappers(o,e,a){let l=new WrapperComparator;return RangeSet.compare(o,e,a,l),l.changes}function inUneditable(o,e){for(let a=o;a&&a!=e;a=a.assignedSlot||a.parentNode)if(a.nodeType==1&&a.contentEditable=="false")return!0;return!1}function touchesComposition(o,e){let a=!1;return e&&o.iterChangedRanges((l,u)=>{l<e.to&&u>e.from&&(a=!0)}),a}class BlockGapWidget extends WidgetType{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function groupAt(o,e,a=1){let l=o.charCategorizer(e),u=o.doc.lineAt(e),p=e-u.from;if(u.length==0)return EditorSelection.cursor(e);p==0?a=1:p==u.length&&(a=-1);let d=p,f=p;a<0?d=findClusterBreak(u.text,p,!1):f=findClusterBreak(u.text,p);let g=l(u.text.slice(d,f));for(;d>0;){let b=findClusterBreak(u.text,d,!1);if(l(u.text.slice(b,d))!=g)break;d=b}for(;f<u.length;){let b=findClusterBreak(u.text,f);if(l(u.text.slice(f,b))!=g)break;f=b}return EditorSelection.range(d+u.from,f+u.from)}function posAtCoordsImprecise(o,e,a,l,u){let p=Math.round((l-e.left)*o.defaultCharacterWidth);if(o.lineWrapping&&a.height>o.defaultLineHeight*1.5){let f=o.viewState.heightOracle.textHeight,g=Math.floor((u-a.top-(o.defaultLineHeight-f)*.5)/f);p+=g*o.viewState.heightOracle.lineLength}let d=o.state.sliceDoc(a.from,a.to);return a.from+findColumn(d,p,o.state.tabSize)}function blockAt(o,e,a){let l=o.lineBlockAt(e);if(Array.isArray(l.type)){let u;for(let p of l.type){if(p.from>e)break;if(!(p.to<e)){if(p.from<e&&p.to>e)return p;(!u||p.type==BlockType.Text&&(u.type!=p.type||(a<0?p.from<e:p.to>e)))&&(u=p)}}return u||l}return l}function moveToLineBoundary(o,e,a,l){let u=blockAt(o,e.head,e.assoc||-1),p=!l||u.type!=BlockType.Text||!(o.lineWrapping||u.widgetLineBreaks)?null:o.coordsAtPos(e.assoc<0&&e.head>u.from?e.head-1:e.head);if(p){let d=o.dom.getBoundingClientRect(),f=o.textDirectionAt(u.from),g=o.posAtCoords({x:a==(f==Direction.LTR)?d.right-1:d.left+1,y:(p.top+p.bottom)/2});if(g!=null)return EditorSelection.cursor(g,a?-1:1)}return EditorSelection.cursor(a?u.to:u.from,a?-1:1)}function moveByChar(o,e,a,l){let u=o.state.doc.lineAt(e.head),p=o.bidiSpans(u),d=o.textDirectionAt(u.from);for(let f=e,g=null;;){let b=moveVisually(u,p,d,f,a),A=movedOver;if(!b){if(u.number==(a?o.state.doc.lines:1))return f;A=`
`,u=o.state.doc.line(u.number+(a?1:-1)),p=o.bidiSpans(u),b=o.visualLineSide(u,!a)}if(g){if(!g(A))return f}else{if(!l)return b;g=l(A)}f=b}}function byGroup(o,e,a){let l=o.state.charCategorizer(e),u=l(a);return p=>{let d=l(p);return u==CharCategory.Space&&(u=d),u==d}}function moveVertically(o,e,a,l){let u=e.head,p=a?1:-1;if(u==(a?o.state.doc.length:0))return EditorSelection.cursor(u,e.assoc);let d=e.goalColumn,f,g=o.contentDOM.getBoundingClientRect(),b=o.coordsAtPos(u,e.assoc||-1),A=o.documentTop;if(b)d==null&&(d=b.left-g.left),f=p<0?b.top:b.bottom;else{let E=o.viewState.lineBlockAt(u);d==null&&(d=Math.min(g.right-g.left,o.defaultCharacterWidth*(u-E.from))),f=(p<0?E.top:E.bottom)+A}let S=g.left+d,M=l??o.viewState.heightOracle.textHeight>>1;for(let E=0;;E+=10){let F=f+(M+E)*p,$=posAtCoords(o,{x:S,y:F},!1,p);return EditorSelection.cursor($.pos,$.assoc,void 0,d)}}function skipAtomicRanges(o,e,a){for(;;){let l=0;for(let u of o)u.between(e-1,e+1,(p,d,f)=>{if(e>p&&e<d){let g=l||a||(e-p<d-e?-1:1);e=g<0?p:d,l=g}});if(!l)return e}}function skipAtomsForSelection(o,e){let a=null;for(let l=0;l<e.ranges.length;l++){let u=e.ranges[l],p=null;if(u.empty){let d=skipAtomicRanges(o,u.from,0);d!=u.from&&(p=EditorSelection.cursor(d,-1))}else{let d=skipAtomicRanges(o,u.from,-1),f=skipAtomicRanges(o,u.to,1);(d!=u.from||f!=u.to)&&(p=EditorSelection.range(u.from==u.anchor?d:f,u.from==u.head?d:f))}p&&(a||(a=e.ranges.slice()),a[l]=p)}return a?EditorSelection.create(a,e.mainIndex):e}function skipAtoms(o,e,a){let l=skipAtomicRanges(o.state.facet(atomicRanges).map(u=>u(o)),a.from,e.head>a.from?-1:1);return l==a.from?a:EditorSelection.cursor(l,l<a.from?1:-1)}class PosAssoc{constructor(e,a){this.pos=e,this.assoc=a}}function posAtCoords(o,e,a,l){let u=o.contentDOM.getBoundingClientRect(),p=u.top+o.viewState.paddingTop,{x:d,y:f}=e,g=f-p,b;for(;;){if(g<0)return new PosAssoc(0,1);if(g>o.viewState.docHeight)return new PosAssoc(o.state.doc.length,-1);if(b=o.elementAtHeight(g),l==null)break;if(b.type==BlockType.Text){let M=o.docView.coordsAt(l<0?b.from:b.to,l);if(M&&(l<0?M.top<=g+p:M.bottom>=g+p))break}let S=o.viewState.heightOracle.textHeight/2;g=l>0?b.bottom+S:b.top-S}if(o.viewport.from>=b.to||o.viewport.to<=b.from){if(a)return null;if(b.type==BlockType.Text){let S=posAtCoordsImprecise(o,u,b,d,f);return new PosAssoc(S,S==b.from?1:-1)}}if(b.type!=BlockType.Text)return g<(b.top+b.bottom)/2?new PosAssoc(b.from,1):new PosAssoc(b.to,-1);let A=o.docView.lineAt(b.from,2);return(!A||A.length!=b.length)&&(A=o.docView.lineAt(b.from,-2)),posAtCoordsInline(o,A,b.from,d,f)}function posAtCoordsInline(o,e,a,l,u){let p=-1,d=null,f=1e9,g=1e9,b=u,A=u,S=(M,E)=>{for(let F=0;F<M.length;F++){let $=M[F];if($.top==$.bottom)continue;let Z=$.left>l?$.left-l:$.right<l?l-$.right:0,V=$.top>u?$.top-u:$.bottom<u?u-$.bottom:0;$.top<=A&&$.bottom>=b&&(b=Math.min($.top,b),A=Math.max($.bottom,A),V=0),(p<0||(V-g||Z-f)<0)&&(p>=0&&g&&f<Z&&d.top<=A-2&&d.bottom>=b+2?g=0:(p=E,f=Z,g=V,d=$))}};if(e.isText()){for(let E=0;E<e.length;){let F=findClusterBreak(e.text,E);if(S(textRange(e.dom,E,F).getClientRects(),E),!f&&!g)break;E=F}return l>(d.left+d.right)/2==(dirAt(o,p+a)==Direction.LTR)?new PosAssoc(a+findClusterBreak(e.text,p),-1):new PosAssoc(a+p,1)}else{if(!e.length)return new PosAssoc(a,1);for(let $=0;$<e.children.length;$++){let Z=e.children[$];if(Z.flags&48)continue;let V=(Z.dom.nodeType==1?Z.dom:textRange(Z.dom,0,Z.length)).getClientRects();if(S(V,$),!f&&!g)break}let M=e.children[p],E=e.posBefore(M,a);return M.isComposite()||M.isText()?posAtCoordsInline(o,M,E,Math.max(d.left,Math.min(d.right,l)),u):l>(d.left+d.right)/2==(dirAt(o,p+a)==Direction.LTR)?new PosAssoc(E+M.length,-1):new PosAssoc(E,1)}}function dirAt(o,e){let a=o.state.doc.lineAt(e);return o.bidiSpans(a)[BidiSpan.find(o.bidiSpans(a),e-a.from,-1,1)].dir}const LineBreakPlaceholder="￿";class DOMReader{constructor(e,a){this.points=e,this.text="",this.lineSeparator=a.facet(EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=LineBreakPlaceholder}readRange(e,a){if(!e)return this;let l=e.parentNode;for(let u=e;;){this.findPointBefore(l,u);let p=this.text.length;this.readNode(u);let d=Tile.get(u),f=u.nextSibling;if(f==a){d?.breakAfter&&!f&&this.lineBreak();break}let g=Tile.get(f);(d&&g?d.breakAfter:(d?d.breakAfter:isBlockElement(u))||isBlockElement(f)&&(u.nodeName!="BR"||d?.isWidget())&&this.text.length>p)&&!isEmptyToEnd(f,a)&&this.lineBreak(),u=f}return this.findPointBefore(l,a),this}readTextNode(e){let a=e.nodeValue;for(let l of this.points)l.node==e&&(l.pos=this.text.length+Math.min(l.offset,a.length));for(let l=0,u=this.lineSeparator?null:/\r\n?|\n/g;;){let p=-1,d=1,f;if(this.lineSeparator?(p=a.indexOf(this.lineSeparator,l),d=this.lineSeparator.length):(f=u.exec(a))&&(p=f.index,d=f[0].length),this.append(a.slice(l,p<0?a.length:p)),p<0)break;if(this.lineBreak(),d>1)for(let g of this.points)g.node==e&&g.pos>this.text.length&&(g.pos-=d-1);l=p+d}}readNode(e){let a=Tile.get(e),l=a&&a.overrideDOMText;if(l!=null){this.findPointInside(e,l.length);for(let u=l.iter();!u.next().done;)u.lineBreak?this.lineBreak():this.append(u.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,a){for(let l of this.points)l.node==e&&e.childNodes[l.offset]==a&&(l.pos=this.text.length)}findPointInside(e,a){for(let l of this.points)(e.nodeType==3?l.node==e:e.contains(l.node))&&(l.pos=this.text.length+(isAtEnd(e,l.node,l.offset)?a:0))}}function isAtEnd(o,e,a){for(;;){if(!e||a<maxOffset(e))return!1;if(e==o)return!0;a=domIndex(e)+1,e=e.parentNode}}function isEmptyToEnd(o,e){let a;for(;!(o==e||!o);o=o.nextSibling){let l=Tile.get(o);if(!l?.isWidget())return!1;l&&(a||(a=[])).push(l)}if(a)for(let l of a){let u=l.overrideDOMText;if(u?.length)return!1}return!0}class DOMPoint{constructor(e,a){this.node=e,this.offset=a,this.pos=-1}}class DOMChange{constructor(e,a,l,u){this.typeOver=u,this.bounds=null,this.text="",this.domChanged=a>-1;let{impreciseHead:p,impreciseAnchor:d}=e.docView;if(e.state.readOnly&&a>-1)this.newSel=null;else if(a>-1&&(this.bounds=domBoundsAround(e.docView.tile,a,l,0))){let f=p||d?[]:selectionPoints(e),g=new DOMReader(f,e.state);g.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=g.text,this.newSel=selectionFromPoints(f,this.bounds.from)}else{let f=e.observer.selectionRange,g=p&&p.node==f.focusNode&&p.offset==f.focusOffset||!contains(e.contentDOM,f.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(f.focusNode,f.focusOffset),b=d&&d.node==f.anchorNode&&d.offset==f.anchorOffset||!contains(e.contentDOM,f.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(f.anchorNode,f.anchorOffset),A=e.viewport;if((browser.ios||browser.chrome)&&e.state.selection.main.empty&&g!=b&&(A.from>0||A.to<e.state.doc.length)){let S=Math.min(g,b),M=Math.max(g,b),E=A.from-S,F=A.to-M;(E==0||E==1||S==0)&&(F==0||F==-1||M==e.state.doc.length)&&(g=0,b=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(EditorSelection.range(b,g)):this.newSel=EditorSelection.single(b,g)}}}function domBoundsAround(o,e,a,l){if(o.isComposite()){let u=-1,p=-1,d=-1,f=-1;for(let g=0,b=l,A=l;g<o.children.length;g++){let S=o.children[g],M=b+S.length;if(b<e&&M>a)return domBoundsAround(S,e,a,b);if(M>=e&&u==-1&&(u=g,p=b),b>a&&S.dom.parentNode==o.dom){d=g,f=A;break}A=M,b=M+S.breakAfter}return{from:p,to:f<0?l+o.length:f,startDOM:(u?o.children[u-1].dom.nextSibling:null)||o.dom.firstChild,endDOM:d<o.children.length&&d>=0?o.children[d].dom:null}}else return o.isText()?{from:l,to:l+o.length,startDOM:o.dom,endDOM:o.dom.nextSibling}:null}function applyDOMChange(o,e){let a,{newSel:l}=e,u=o.state.selection.main,p=o.inputState.lastKeyTime>Date.now()-100?o.inputState.lastKeyCode:-1;if(e.bounds){let{from:d,to:f}=e.bounds,g=u.from,b=null;(p===8||browser.android&&e.text.length<f-d)&&(g=u.to,b="end");let A=findDiff(o.state.doc.sliceString(d,f,LineBreakPlaceholder),e.text,g-d,b);A&&(browser.chrome&&p==13&&A.toB==A.from+2&&e.text.slice(A.from,A.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&A.toB--,a={from:d+A.from,to:d+A.toA,insert:Text.of(e.text.slice(A.from,A.toB).split(LineBreakPlaceholder))})}else l&&(!o.hasFocus&&o.state.facet(editable)||l.main.eq(u))&&(l=null);if(!a&&!l)return!1;if(!a&&e.typeOver&&!u.empty&&l&&l.main.empty?a={from:u.from,to:u.to,insert:o.state.doc.slice(u.from,u.to)}:(browser.mac||browser.android)&&a&&a.from==a.to&&a.from==u.head-1&&/^\. ?$/.test(a.insert.toString())&&o.contentDOM.getAttribute("autocorrect")=="off"?(l&&a.insert.length==2&&(l=EditorSelection.single(l.main.anchor-1,l.main.head-1)),a={from:a.from,to:a.to,insert:Text.of([a.insert.toString().replace("."," ")])}):a&&a.from>=u.from&&a.to<=u.to&&(a.from!=u.from||a.to!=u.to)&&u.to-u.from-(a.to-a.from)<=4?a={from:u.from,to:u.to,insert:o.state.doc.slice(u.from,a.from).append(a.insert).append(o.state.doc.slice(a.to,u.to))}:o.state.doc.lineAt(u.from).to<u.to&&o.docView.lineHasWidget(u.to)&&o.inputState.insertingTextAt>Date.now()-50?a={from:u.from,to:u.to,insert:o.state.toText(o.inputState.insertingText)}:browser.chrome&&a&&a.from==a.to&&a.from==u.head&&a.insert.toString()==`
 `&&o.lineWrapping&&(l&&(l=EditorSelection.single(l.main.anchor-1,l.main.head-1)),a={from:u.from,to:u.to,insert:Text.of([" "])}),a)return applyDOMChangeInner(o,a,l,p);if(l&&!l.main.eq(u)){let d=!1,f="select";return o.inputState.lastSelectionTime>Date.now()-50&&(o.inputState.lastSelectionOrigin=="select"&&(d=!0),f=o.inputState.lastSelectionOrigin,f=="select.pointer"&&(l=skipAtomsForSelection(o.state.facet(atomicRanges).map(g=>g(o)),l))),o.dispatch({selection:l,scrollIntoView:d,userEvent:f}),!0}else return!1}function applyDOMChangeInner(o,e,a,l=-1){if(browser.ios&&o.inputState.flushIOSKey(e))return!0;let u=o.state.selection.main;if(browser.android&&(e.to==u.to&&(e.from==u.from||e.from==u.from-1&&o.state.sliceDoc(e.from,u.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&dispatchKey(o.contentDOM,"Enter",13)||(e.from==u.from-1&&e.to==u.to&&e.insert.length==0||l==8&&e.insert.length<e.to-e.from&&e.to>u.head)&&dispatchKey(o.contentDOM,"Backspace",8)||e.from==u.from&&e.to==u.to+1&&e.insert.length==0&&dispatchKey(o.contentDOM,"Delete",46)))return!0;let p=e.insert.toString();o.inputState.composing>=0&&o.inputState.composing++;let d,f=()=>d||(d=applyDefaultInsert(o,e,a));return o.state.facet(inputHandler$1).some(g=>g(o,e.from,e.to,p,f))||o.dispatch(f()),!0}function applyDefaultInsert(o,e,a){let l,u=o.state,p=u.selection.main,d=-1;if(e.from==e.to&&e.from<p.from||e.from>p.to){let g=e.from<p.from?-1:1,b=g<0?p.from:p.to,A=skipAtomicRanges(u.facet(atomicRanges).map(S=>S(o)),b,g);e.from==A&&(d=A)}if(d>-1)l={changes:e,selection:EditorSelection.cursor(e.from+e.insert.length,-1)};else if(e.from>=p.from&&e.to<=p.to&&e.to-e.from>=(p.to-p.from)/3&&(!a||a.main.empty&&a.main.from==e.from+e.insert.length)&&o.inputState.composing<0){let g=p.from<e.from?u.sliceDoc(p.from,e.from):"",b=p.to>e.to?u.sliceDoc(e.to,p.to):"";l=u.replaceSelection(o.state.toText(g+e.insert.sliceString(0,void 0,o.state.lineBreak)+b))}else{let g=u.changes(e),b=a&&a.main.to<=g.newLength?a.main:void 0;if(u.selection.ranges.length>1&&(o.inputState.composing>=0||o.inputState.compositionPendingChange)&&e.to<=p.to+10&&e.to>=p.to-10){let A=o.state.sliceDoc(e.from,e.to),S,M=a&&findCompositionNode(o,a.main.head);if(M){let F=e.insert.length-(e.to-e.from);S={from:M.from,to:M.to-F}}else S=o.state.doc.lineAt(p.head);let E=p.to-e.to;l=u.changeByRange(F=>{if(F.from==p.from&&F.to==p.to)return{changes:g,range:b||F.map(g)};let $=F.to-E,Z=$-A.length;if(o.state.sliceDoc(Z,$)!=A||$>=S.from&&Z<=S.to)return{range:F};let V=u.changes({from:Z,to:$,insert:e.insert}),K=F.to-p.to;return{changes:V,range:b?EditorSelection.range(Math.max(0,b.anchor+K),Math.max(0,b.head+K)):F.map(V)}})}else l={changes:g,selection:b&&u.selection.replaceRange(b)}}let f="input.type";return(o.composing||o.inputState.compositionPendingChange&&o.inputState.compositionEndedAt>Date.now()-50)&&(o.inputState.compositionPendingChange=!1,f+=".compose",o.inputState.compositionFirstChange&&(f+=".start",o.inputState.compositionFirstChange=!1)),u.update(l,{userEvent:f,scrollIntoView:!0})}function findDiff(o,e,a,l){let u=Math.min(o.length,e.length),p=0;for(;p<u&&o.charCodeAt(p)==e.charCodeAt(p);)p++;if(p==u&&o.length==e.length)return null;let d=o.length,f=e.length;for(;d>0&&f>0&&o.charCodeAt(d-1)==e.charCodeAt(f-1);)d--,f--;if(l=="end"){let g=Math.max(0,p-Math.min(d,f));a-=d+g-p}if(d<p&&o.length<e.length){let g=a<=p&&a>=d?p-a:0;p-=g,f=p+(f-d),d=p}else if(f<p){let g=a<=p&&a>=f?p-a:0;p-=g,d=p+(d-f),f=p}return{from:p,toA:d,toB:f}}function selectionPoints(o){let e=[];if(o.root.activeElement!=o.contentDOM)return e;let{anchorNode:a,anchorOffset:l,focusNode:u,focusOffset:p}=o.observer.selectionRange;return a&&(e.push(new DOMPoint(a,l)),(u!=a||p!=l)&&e.push(new DOMPoint(u,p))),e}function selectionFromPoints(o,e){if(o.length==0)return null;let a=o[0].pos,l=o.length==2?o[1].pos:a;return a>-1&&l>-1?EditorSelection.single(a+e,l+e):null}class InputState{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,browser.safari&&e.contentDOM.addEventListener("input",()=>null),browser.gecko&&firefoxCopyCutHack(e.contentDOM.ownerDocument)}handleEvent(e){!eventBelongsToEditor(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,a){let l=this.handlers[e];if(l){for(let u of l.observers)u(this.view,a);for(let u of l.handlers){if(a.defaultPrevented)break;if(u(this.view,a)){a.preventDefault();break}}}}ensureHandlers(e){let a=computeHandlers(e),l=this.handlers,u=this.view.contentDOM;for(let p in a)if(p!="scroll"){let d=!a[p].handlers.length,f=l[p];f&&d!=!f.handlers.length&&(u.removeEventListener(p,this.handleEvent),f=null),f||u.addEventListener(p,this.handleEvent,{passive:d})}for(let p in l)p!="scroll"&&!a[p]&&u.removeEventListener(p,this.handleEvent);this.handlers=a}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&modifierCodes.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),browser.android&&browser.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let a;return browser.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((a=PendingKeys.find(l=>l.keyCode==e.keyCode))&&!e.ctrlKey||EmacsyPendingKeys.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=a||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let a=this.pendingIOSKey;return!a||a.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,dispatchKey(this.view.contentDOM,a.key,a.keyCode,a instanceof KeyboardEvent?a:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function bindHandler(o,e){return(a,l)=>{try{return e.call(o,l,a)}catch(u){logException(a.state,u)}}}function computeHandlers(o){let e=Object.create(null);function a(l){return e[l]||(e[l]={observers:[],handlers:[]})}for(let l of o){let u=l.spec,p=u&&u.plugin.domEventHandlers,d=u&&u.plugin.domEventObservers;if(p)for(let f in p){let g=p[f];g&&a(f).handlers.push(bindHandler(l.value,g))}if(d)for(let f in d){let g=d[f];g&&a(f).observers.push(bindHandler(l.value,g))}}for(let l in handlers)a(l).handlers.push(handlers[l]);for(let l in observers)a(l).observers.push(observers[l]);return e}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(o){return Math.max(0,o)*.7+8}function dist$3(o,e){return Math.max(Math.abs(o.clientX-e.clientX),Math.abs(o.clientY-e.clientY))}class MouseSelection{constructor(e,a,l,u){this.view=e,this.startEvent=a,this.style=l,this.mustSelect=u,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=a,this.scrollParents=scrollableParents(e.contentDOM),this.atoms=e.state.facet(atomicRanges).map(d=>d(e));let p=e.contentDOM.ownerDocument;p.addEventListener("mousemove",this.move=this.move.bind(this)),p.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=a.shiftKey,this.multiple=e.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(e,a),this.dragging=isInPrimarySelection(e,a)&&getClickType(a)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dist$3(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let a=0,l=0,u=0,p=0,d=this.view.win.innerWidth,f=this.view.win.innerHeight;this.scrollParents.x&&({left:u,right:d}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:p,bottom:f}=this.scrollParents.y.getBoundingClientRect());let g=getScrollMargins(this.view);e.clientX-g.left<=u+dragScrollMargin?a=-dragScrollSpeed(u-e.clientX):e.clientX+g.right>=d-dragScrollMargin&&(a=dragScrollSpeed(e.clientX-d)),e.clientY-g.top<=p+dragScrollMargin?l=-dragScrollSpeed(p-e.clientY):e.clientY+g.bottom>=f-dragScrollMargin&&(l=dragScrollSpeed(e.clientY-f)),this.setScrollSpeed(a,l)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,a){this.scrollSpeed={x:e,y:a},e||a?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:a}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),a&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=a,a=0),(e||a)&&this.view.win.scrollBy(e,a),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:a}=this,l=skipAtomsForSelection(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!l.eq(a.state.selection,this.dragging===!1))&&this.view.dispatch({selection:l,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(a=>a.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(o,e){let a=o.state.facet(clickAddsSelectionRange);return a.length?a[0](e):browser.mac?e.metaKey:e.ctrlKey}function dragMovesSelection(o,e){let a=o.state.facet(dragMovesSelection$1);return a.length?a[0](e):browser.mac?!e.altKey:!e.ctrlKey}function isInPrimarySelection(o,e){let{main:a}=o.state.selection;if(a.empty)return!1;let l=getSelection(o.root);if(!l||l.rangeCount==0)return!0;let u=l.getRangeAt(0).getClientRects();for(let p=0;p<u.length;p++){let d=u[p];if(d.left<=e.clientX&&d.right>=e.clientX&&d.top<=e.clientY&&d.bottom>=e.clientY)return!0}return!1}function eventBelongsToEditor(o,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let a=e.target,l;a!=o.contentDOM;a=a.parentNode)if(!a||a.nodeType==11||(l=Tile.get(a))&&l.isWidget()&&!l.isHidden&&l.widget.ignoreEvent(e))return!1;return!0}const handlers=Object.create(null),observers=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(o){let e=o.dom.parentNode;if(!e)return;let a=e.appendChild(document.createElement("textarea"));a.style.cssText="position: fixed; left: -10000px; top: 10px",a.focus(),setTimeout(()=>{o.focus(),a.remove(),doPaste(o,a.value)},50)}function textFilter(o,e,a){for(let l of o.facet(e))a=l(a,o);return a}function doPaste(o,e){e=textFilter(o.state,clipboardInputFilter,e);let{state:a}=o,l,u=1,p=a.toText(e),d=p.lines==a.selection.ranges.length;if(lastLinewiseCopy!=null&&a.selection.ranges.every(g=>g.empty)&&lastLinewiseCopy==p.toString()){let g=-1;l=a.changeByRange(b=>{let A=a.doc.lineAt(b.from);if(A.from==g)return{range:b};g=A.from;let S=a.toText((d?p.line(u++).text:e)+a.lineBreak);return{changes:{from:A.from,insert:S},range:EditorSelection.cursor(b.from+S.length)}})}else d?l=a.changeByRange(g=>{let b=p.line(u++);return{changes:{from:g.from,to:g.to,insert:b.text},range:EditorSelection.cursor(g.from+b.length)}}):l=a.replaceSelection(p);o.dispatch(l,{userEvent:"input.paste",scrollIntoView:!0})}observers.scroll=o=>{o.inputState.lastScrollTop=o.scrollDOM.scrollTop,o.inputState.lastScrollLeft=o.scrollDOM.scrollLeft},handlers.keydown=(o,e)=>(o.inputState.setSelectionOrigin("select"),e.keyCode==27&&o.inputState.tabFocusMode!=0&&(o.inputState.tabFocusMode=Date.now()+2e3),!1),observers.touchstart=(o,e)=>{o.inputState.lastTouchTime=Date.now(),o.inputState.setSelectionOrigin("select.pointer")},observers.touchmove=o=>{o.inputState.setSelectionOrigin("select.pointer")},handlers.mousedown=(o,e)=>{if(o.observer.flush(),o.inputState.lastTouchTime>Date.now()-2e3)return!1;let a=null;for(let l of o.state.facet(mouseSelectionStyle))if(a=l(o,e),a)break;if(!a&&e.button==0&&(a=basicMouseSelection(o,e)),a){let l=!o.hasFocus;o.inputState.startMouseSelection(new MouseSelection(o,e,a,l)),l&&o.observer.ignore(()=>{focusPreventScroll(o.contentDOM);let p=o.root.activeElement;p&&!p.contains(o.contentDOM)&&p.blur()});let u=o.inputState.mouseSelection;if(u)return u.start(e),u.dragging===!1}else o.inputState.setSelectionOrigin("select.pointer");return!1};function rangeForClick(o,e,a,l){if(l==1)return EditorSelection.cursor(e,a);if(l==2)return groupAt(o.state,e,a);{let u=o.docView.lineAt(e,a),p=o.state.doc.lineAt(u?u.posAtEnd:e),d=u?u.posAtStart:p.from,f=u?u.posAtEnd:p.to;return f<o.state.doc.length&&f==p.to&&f++,EditorSelection.range(d,f)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(o){if(!BadMouseDetail)return o.detail;let e=lastMouseDown,a=lastMouseDownTime;return lastMouseDown=o,lastMouseDownTime=Date.now(),lastMouseDownCount=!e||a>Date.now()-400&&Math.abs(e.clientX-o.clientX)<2&&Math.abs(e.clientY-o.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(o,e){let a=o.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),l=getClickType(e),u=o.state.selection;return{update(p){p.docChanged&&(a.pos=p.changes.mapPos(a.pos),u=u.map(p.changes))},get(p,d,f){let g=o.posAndSideAtCoords({x:p.clientX,y:p.clientY},!1),b,A=rangeForClick(o,g.pos,g.assoc,l);if(a.pos!=g.pos&&!d){let S=rangeForClick(o,a.pos,a.assoc,l),M=Math.min(S.from,A.from),E=Math.max(S.to,A.to);A=M<A.from?EditorSelection.range(M,E):EditorSelection.range(E,M)}return d?u.replaceRange(u.main.extend(A.from,A.to)):f&&l==1&&u.ranges.length>1&&(b=removeRangeAround(u,g.pos))?b:f?u.addRange(A):EditorSelection.create([A])}}}function removeRangeAround(o,e){for(let a=0;a<o.ranges.length;a++){let{from:l,to:u}=o.ranges[a];if(l<=e&&u>=e)return EditorSelection.create(o.ranges.slice(0,a).concat(o.ranges.slice(a+1)),o.mainIndex==a?0:o.mainIndex-(o.mainIndex>a?1:0))}return null}handlers.dragstart=(o,e)=>{let{selection:{main:a}}=o.state;if(e.target.draggable){let u=o.docView.tile.nearest(e.target);if(u&&u.isWidget()){let p=u.posAtStart,d=p+u.length;(p>=a.to||d<=a.from)&&(a=EditorSelection.range(p,d))}}let{inputState:l}=o;return l.mouseSelection&&(l.mouseSelection.dragging=!0),l.draggedContent=a,e.dataTransfer&&(e.dataTransfer.setData("Text",textFilter(o.state,clipboardOutputFilter,o.state.sliceDoc(a.from,a.to))),e.dataTransfer.effectAllowed="copyMove"),!1},handlers.dragend=o=>(o.inputState.draggedContent=null,!1);function dropText(o,e,a,l){if(a=textFilter(o.state,clipboardInputFilter,a),!a)return;let u=o.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:p}=o.inputState,d=l&&p&&dragMovesSelection(o,e)?{from:p.from,to:p.to}:null,f={from:u,insert:a},g=o.state.changes(d?[d,f]:f);o.focus(),o.dispatch({changes:g,selection:{anchor:g.mapPos(u,-1),head:g.mapPos(u,1)},userEvent:d?"move.drop":"input.drop"}),o.inputState.draggedContent=null}handlers.drop=(o,e)=>{if(!e.dataTransfer)return!1;if(o.state.readOnly)return!0;let a=e.dataTransfer.files;if(a&&a.length){let l=Array(a.length),u=0,p=()=>{++u==a.length&&dropText(o,e,l.filter(d=>d!=null).join(o.state.lineBreak),!1)};for(let d=0;d<a.length;d++){let f=new FileReader;f.onerror=p,f.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(f.result)||(l[d]=f.result),p()},f.readAsText(a[d])}return!0}else{let l=e.dataTransfer.getData("Text");if(l)return dropText(o,e,l,!0),!0}return!1},handlers.paste=(o,e)=>{if(o.state.readOnly)return!0;o.observer.flush();let a=brokenClipboardAPI?null:e.clipboardData;return a?(doPaste(o,a.getData("text/plain")||a.getData("text/uri-list")),!0):(capturePaste(o),!1)};function captureCopy(o,e){let a=o.dom.parentNode;if(!a)return;let l=a.appendChild(document.createElement("textarea"));l.style.cssText="position: fixed; left: -10000px; top: 10px",l.value=e,l.focus(),l.selectionEnd=e.length,l.selectionStart=0,setTimeout(()=>{l.remove(),o.focus()},50)}function copiedRange(o){let e=[],a=[],l=!1;for(let u of o.selection.ranges)u.empty||(e.push(o.sliceDoc(u.from,u.to)),a.push(u));if(!e.length){let u=-1;for(let{from:p}of o.selection.ranges){let d=o.doc.lineAt(p);d.number>u&&(e.push(d.text),a.push({from:d.from,to:Math.min(o.doc.length,d.to+1)})),u=d.number}l=!0}return{text:textFilter(o,clipboardOutputFilter,e.join(o.lineBreak)),ranges:a,linewise:l}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(o,e)=>{let{text:a,ranges:l,linewise:u}=copiedRange(o.state);if(!a&&!u)return!1;lastLinewiseCopy=u?a:null,e.type=="cut"&&!o.state.readOnly&&o.dispatch({changes:l,scrollIntoView:!0,userEvent:"delete.cut"});let p=brokenClipboardAPI?null:e.clipboardData;return p?(p.clearData(),p.setData("text/plain",a),!0):(captureCopy(o,a),!1)};const isFocusChange=Annotation.define();function focusChangeTransaction(o,e){let a=[];for(let l of o.facet(focusChangeEffect)){let u=l(o,e);u&&a.push(u)}return a.length?o.update({effects:a,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(o){setTimeout(()=>{let e=o.hasFocus;if(e!=o.inputState.notifiedFocused){let a=focusChangeTransaction(o.state,e);a?o.dispatch(a):o.update([])}},10)}observers.focus=o=>{o.inputState.lastFocusTime=Date.now(),!o.scrollDOM.scrollTop&&(o.inputState.lastScrollTop||o.inputState.lastScrollLeft)&&(o.scrollDOM.scrollTop=o.inputState.lastScrollTop,o.scrollDOM.scrollLeft=o.inputState.lastScrollLeft),updateForFocusChange(o)},observers.blur=o=>{o.observer.clearSelectionRange(),updateForFocusChange(o)},observers.compositionstart=observers.compositionupdate=o=>{o.observer.editContext||(o.inputState.compositionFirstChange==null&&(o.inputState.compositionFirstChange=!0),o.inputState.composing<0&&(o.inputState.composing=0))},observers.compositionend=o=>{o.observer.editContext||(o.inputState.composing=-1,o.inputState.compositionEndedAt=Date.now(),o.inputState.compositionPendingKey=!0,o.inputState.compositionPendingChange=o.observer.pendingRecords().length>0,o.inputState.compositionFirstChange=null,browser.chrome&&browser.android?o.observer.flushSoon():o.inputState.compositionPendingChange?Promise.resolve().then(()=>o.observer.flush()):setTimeout(()=>{o.inputState.composing<0&&o.docView.hasComposition&&o.update([])},50))},observers.contextmenu=o=>{o.inputState.lastContextMenu=Date.now()},handlers.beforeinput=(o,e)=>{var a,l;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(o.inputState.insertingText=e.data,o.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&o.observer.editContext){let p=(a=e.dataTransfer)===null||a===void 0?void 0:a.getData("text/plain"),d=e.getTargetRanges();if(p&&d.length){let f=d[0],g=o.posAtDOM(f.startContainer,f.startOffset),b=o.posAtDOM(f.endContainer,f.endOffset);return applyDOMChangeInner(o,{from:g,to:b,insert:o.state.toText(p)},null),!0}}let u;if(browser.chrome&&browser.android&&(u=PendingKeys.find(p=>p.inputType==e.inputType))&&(o.observer.delayAndroidKey(u.key,u.keyCode),u.key=="Backspace"||u.key=="Delete")){let p=((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0;setTimeout(()=>{var d;(((d=window.visualViewport)===null||d===void 0?void 0:d.height)||0)>p+10&&o.hasFocus&&(o.contentDOM.blur(),o.focus())},100)}return browser.ios&&e.inputType=="deleteContentForward"&&o.observer.flushSoon(),browser.safari&&e.inputType=="insertText"&&o.inputState.composing>=0&&setTimeout(()=>observers.compositionend(o,e),20),!1};const appliedFirefoxHack=new Set;function firefoxCopyCutHack(o){appliedFirefoxHack.has(o)||(appliedFirefoxHack.add(o),o.addEventListener("copy",()=>{}),o.addEventListener("cut",()=>{}))}const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];let heightChangeFlag=!1;function clearHeightChangeFlag(){heightChangeFlag=!1}class HeightOracle{constructor(e){this.lineWrapping=e,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,a){let l=this.doc.lineAt(a).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(l+=Math.max(0,Math.ceil((a-e-l*this.lineLength*.5)/this.lineLength))),this.lineHeight*l}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wrappingWhiteSpace.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let a=!1;for(let l=0;l<e.length;l++){let u=e[l];u<0?l++:this.heightSamples[Math.floor(u*10)]||(a=!0,this.heightSamples[Math.floor(u*10)]=!0)}return a}refresh(e,a,l,u,p,d){let f=wrappingWhiteSpace.indexOf(e)>-1,g=Math.round(a)!=Math.round(this.lineHeight)||this.lineWrapping!=f;if(this.lineWrapping=f,this.lineHeight=a,this.charWidth=l,this.textHeight=u,this.lineLength=p,g){this.heightSamples={};for(let b=0;b<d.length;b++){let A=d[b];A<0?b++:this.heightSamples[Math.floor(A*10)]=!0}}return g}}class MeasuredHeights{constructor(e,a){this.from=e,this.heights=a,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(e,a,l,u,p){this.from=e,this.length=a,this.top=l,this.height=u,this._content=p}get type(){return typeof this._content=="number"?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let a=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new BlockInfo(this.from,this.length+e.length,this.top,this.height+e.height,a)}}var QueryType$1=(function(o){return o[o.ByPos=0]="ByPos",o[o.ByHeight=1]="ByHeight",o[o.ByPosNoHeight=2]="ByPosNoHeight",o})(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(e,a,l=2){this.length=e,this.height=a,this.flags=l}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Epsilon&&(heightChangeFlag=!0),this.height=e)}replace(e,a,l){return HeightMap.of(l)}decomposeLeft(e,a){a.push(this)}decomposeRight(e,a){a.push(this)}applyChanges(e,a,l,u){let p=this,d=l.doc;for(let f=u.length-1;f>=0;f--){let{fromA:g,toA:b,fromB:A,toB:S}=u[f],M=p.lineAt(g,QueryType$1.ByPosNoHeight,l.setDoc(a),0,0),E=M.to>=b?M:p.lineAt(b,QueryType$1.ByPosNoHeight,l,0,0);for(S+=E.to-b,b=E.to;f>0&&M.from<=u[f-1].toA;)g=u[f-1].fromA,A=u[f-1].fromB,f--,g<M.from&&(M=p.lineAt(g,QueryType$1.ByPosNoHeight,l,0,0));A+=M.from-g,g=M.from;let F=NodeBuilder.build(l.setDoc(d),e,A,S);p=replace(p,p.replace(g,b,F))}return p.updateHeight(l,0)}static empty(){return new HeightMapText(0,0,0)}static of(e){if(e.length==1)return e[0];let a=0,l=e.length,u=0,p=0;for(;;)if(a==l)if(u>p*2){let f=e[a-1];f.break?e.splice(--a,1,f.left,null,f.right):e.splice(--a,1,f.left,f.right),l+=1+f.break,u-=f.size}else if(p>u*2){let f=e[l];f.break?e.splice(l,1,f.left,null,f.right):e.splice(l,1,f.left,f.right),l+=2+f.break,p-=f.size}else break;else if(u<p){let f=e[a++];f&&(u+=f.size)}else{let f=e[--l];f&&(p+=f.size)}let d=0;return e[a-1]==null?(d=1,a--):e[a]==null&&(d=1,l++),new HeightMapBranch(HeightMap.of(e.slice(0,a)),d,HeightMap.of(e.slice(l)))}}function replace(o,e){return o==e?o:(o.constructor!=e.constructor&&(heightChangeFlag=!0),e)}HeightMap.prototype.size=1;const SpaceDeco=Decoration.replace({});class HeightMapBlock extends HeightMap{constructor(e,a,l){super(e,a),this.deco=l,this.spaceAbove=0}mainBlock(e,a){return new BlockInfo(a,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,a,l,u){return this.spaceAbove&&e<l+this.spaceAbove?new BlockInfo(u,0,l,this.spaceAbove,SpaceDeco):this.mainBlock(l,u)}lineAt(e,a,l,u,p){let d=this.mainBlock(u,p);return this.spaceAbove?this.blockAt(0,l,u,p).join(d):d}forEachLine(e,a,l,u,p,d){e<=p+this.length&&a>=p&&d(this.lineAt(0,QueryType$1.ByPos,l,u,p))}setMeasuredHeight(e){let a=e.heights[e.index++];a<0?(this.spaceAbove=-a,a=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(a)}updateHeight(e,a=0,l=!1,u){return u&&u.from<=a&&u.more&&this.setMeasuredHeight(u),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(e,a,l){super(e,a,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=l}mainBlock(e,a){return new BlockInfo(a,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,a,l){let u=l[0];return l.length==1&&(u instanceof HeightMapText||u instanceof HeightMapGap&&u.flags&4)&&Math.abs(this.length-u.length)<10?(u instanceof HeightMapGap?u=new HeightMapText(u.length,this.height,this.spaceAbove):u.height=this.height,this.outdated||(u.outdated=!1),u):HeightMap.of(l)}updateHeight(e,a=0,l=!1,u){return u&&u.from<=a&&u.more?this.setMeasuredHeight(u):(l||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(e){super(e,0)}heightMetrics(e,a){let l=e.doc.lineAt(a).number,u=e.doc.lineAt(a+this.length).number,p=u-l+1,d,f=0;if(e.lineWrapping){let g=Math.min(this.height,e.lineHeight*p);d=g/p,this.length>p+1&&(f=(this.height-g)/(this.length-p-1))}else d=this.height/p;return{firstLine:l,lastLine:u,perLine:d,perChar:f}}blockAt(e,a,l,u){let{firstLine:p,lastLine:d,perLine:f,perChar:g}=this.heightMetrics(a,u);if(a.lineWrapping){let b=u+(e<a.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-l)/this.height))*this.length)),A=a.doc.lineAt(b),S=f+A.length*g,M=Math.max(l,e-S/2);return new BlockInfo(A.from,A.length,M,S,0)}else{let b=Math.max(0,Math.min(d-p,Math.floor((e-l)/f))),{from:A,length:S}=a.doc.line(p+b);return new BlockInfo(A,S,l+f*b,f,0)}}lineAt(e,a,l,u,p){if(a==QueryType$1.ByHeight)return this.blockAt(e,l,u,p);if(a==QueryType$1.ByPosNoHeight){let{from:E,to:F}=l.doc.lineAt(e);return new BlockInfo(E,F-E,0,0,0)}let{firstLine:d,perLine:f,perChar:g}=this.heightMetrics(l,p),b=l.doc.lineAt(e),A=f+b.length*g,S=b.number-d,M=u+f*S+g*(b.from-p-S);return new BlockInfo(b.from,b.length,Math.max(u,Math.min(M,u+this.height-A)),A,0)}forEachLine(e,a,l,u,p,d){e=Math.max(e,p),a=Math.min(a,p+this.length);let{firstLine:f,perLine:g,perChar:b}=this.heightMetrics(l,p);for(let A=e,S=u;A<=a;){let M=l.doc.lineAt(A);if(A==e){let F=M.number-f;S+=g*F+b*(e-p-F)}let E=g+b*M.length;d(new BlockInfo(M.from,M.length,S,E,0)),S+=E,A=M.to+1}}replace(e,a,l){let u=this.length-a;if(u>0){let p=l[l.length-1];p instanceof HeightMapGap?l[l.length-1]=new HeightMapGap(p.length+u):l.push(null,new HeightMapGap(u-1))}if(e>0){let p=l[0];p instanceof HeightMapGap?l[0]=new HeightMapGap(e+p.length):l.unshift(new HeightMapGap(e-1),null)}return HeightMap.of(l)}decomposeLeft(e,a){a.push(new HeightMapGap(e-1),null)}decomposeRight(e,a){a.push(null,new HeightMapGap(this.length-e-1))}updateHeight(e,a=0,l=!1,u){let p=a+this.length;if(u&&u.from<=a+this.length&&u.more){let d=[],f=Math.max(a,u.from),g=-1;for(u.from>a&&d.push(new HeightMapGap(u.from-a-1).updateHeight(e,a));f<=p&&u.more;){let A=e.doc.lineAt(f).length;d.length&&d.push(null);let S=u.heights[u.index++],M=0;S<0&&(M=-S,S=u.heights[u.index++]),g==-1?g=S:Math.abs(S-g)>=Epsilon&&(g=-2);let E=new HeightMapText(A,S,M);E.outdated=!1,d.push(E),f+=A+1}f<=p&&d.push(null,new HeightMapGap(p-f).updateHeight(e,f));let b=HeightMap.of(d);return(g<0||Math.abs(b.height-this.height)>=Epsilon||Math.abs(g-this.heightMetrics(e,a).perLine)>=Epsilon)&&(heightChangeFlag=!0),replace(this,b)}else(l||this.outdated)&&(this.setHeight(e.heightForGap(a,a+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(e,a,l){super(e.length+a+l.length,e.height+l.height,a|(e.outdated||l.outdated?2:0)),this.left=e,this.right=l,this.size=e.size+l.size}get break(){return this.flags&1}blockAt(e,a,l,u){let p=l+this.left.height;return e<p?this.left.blockAt(e,a,l,u):this.right.blockAt(e,a,p,u+this.left.length+this.break)}lineAt(e,a,l,u,p){let d=u+this.left.height,f=p+this.left.length+this.break,g=a==QueryType$1.ByHeight?e<d:e<f,b=g?this.left.lineAt(e,a,l,u,p):this.right.lineAt(e,a,l,d,f);if(this.break||(g?b.to<f:b.from>f))return b;let A=a==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return g?b.join(this.right.lineAt(f,A,l,d,f)):this.left.lineAt(f,A,l,u,p).join(b)}forEachLine(e,a,l,u,p,d){let f=u+this.left.height,g=p+this.left.length+this.break;if(this.break)e<g&&this.left.forEachLine(e,a,l,u,p,d),a>=g&&this.right.forEachLine(e,a,l,f,g,d);else{let b=this.lineAt(g,QueryType$1.ByPos,l,u,p);e<b.from&&this.left.forEachLine(e,b.from-1,l,u,p,d),b.to>=e&&b.from<=a&&d(b),a>b.to&&this.right.forEachLine(b.to+1,a,l,f,g,d)}}replace(e,a,l){let u=this.left.length+this.break;if(a<u)return this.balanced(this.left.replace(e,a,l),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-u,a-u,l));let p=[];e>0&&this.decomposeLeft(e,p);let d=p.length;for(let f of l)p.push(f);if(e>0&&mergeGaps(p,d-1),a<this.length){let f=p.length;this.decomposeRight(a,p),mergeGaps(p,f)}return HeightMap.of(p)}decomposeLeft(e,a){let l=this.left.length;if(e<=l)return this.left.decomposeLeft(e,a);a.push(this.left),this.break&&(l++,e>=l&&a.push(null)),e>l&&this.right.decomposeLeft(e-l,a)}decomposeRight(e,a){let l=this.left.length,u=l+this.break;if(e>=u)return this.right.decomposeRight(e-u,a);e<l&&this.left.decomposeRight(e,a),this.break&&e<u&&a.push(null),a.push(this.right)}balanced(e,a){return e.size>2*a.size||a.size>2*e.size?HeightMap.of(this.break?[e,null,a]:[e,a]):(this.left=replace(this.left,e),this.right=replace(this.right,a),this.setHeight(e.height+a.height),this.outdated=e.outdated||a.outdated,this.size=e.size+a.size,this.length=e.length+this.break+a.length,this)}updateHeight(e,a=0,l=!1,u){let{left:p,right:d}=this,f=a+p.length+this.break,g=null;return u&&u.from<=a+p.length&&u.more?g=p=p.updateHeight(e,a,l,u):p.updateHeight(e,a,l),u&&u.from<=f+d.length&&u.more?g=d=d.updateHeight(e,f,l,u):d.updateHeight(e,f,l),g?this.balanced(p,d):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(o,e){let a,l;o[e]==null&&(a=o[e-1])instanceof HeightMapGap&&(l=o[e+1])instanceof HeightMapGap&&o.splice(e-1,3,new HeightMapGap(a.length+1+l.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(e,a){this.pos=e,this.oracle=a,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,a){if(this.lineStart>-1){let l=Math.min(a,this.lineEnd),u=this.nodes[this.nodes.length-1];u instanceof HeightMapText?u.length+=l-this.pos:(l>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(l-this.pos,-1,0)),this.writtenTo=l,a>l&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=a}point(e,a,l){if(e<a||l.heightRelevant){let u=l.widget?l.widget.estimatedHeight:0,p=l.widget?l.widget.lineBreaks:0;u<0&&(u=this.oracle.lineHeight);let d=a-e;l.block?this.addBlock(new HeightMapBlock(d,u,l)):(d||p||u>=relevantWidgetHeight)&&this.addLineDeco(u,p,d)}else a>e&&this.span(e,a);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:a}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=a,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new HeightMapText(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,a){let l=new HeightMapGap(a-e);return this.oracle.doc.lineAt(e).to==a&&(l.flags|=4),l}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;let a=new HeightMapText(0,-1,0);return this.nodes.push(a),a}addBlock(e){this.enterLine();let a=e.deco;a&&a.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,a&&a.endSide>0&&(this.covering=e)}addLineDeco(e,a,l){let u=this.ensureLine();u.length+=l,u.collapsed+=l,u.widgetHeight=Math.max(u.widgetHeight,e),u.breaks+=a,this.writtenTo=this.pos=this.pos+l}finish(e){let a=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(a instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1,0)):(this.writtenTo<this.pos||a==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let l=e;for(let u of this.nodes)u instanceof HeightMapText&&u.updateHeight(this.oracle,l),l+=u?u.length:1;return this.nodes}static build(e,a,l,u){let p=new NodeBuilder(l,e);return RangeSet.spans(a,l,u,p,0),p.finish(l)}}function heightRelevantDecoChanges(o,e,a){let l=new DecorationComparator;return RangeSet.compare(o,e,a,l,0),l.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(e,a,l,u){(e<a||l&&l.heightRelevant||u&&u.heightRelevant)&&addRange(e,a,this.changes,5)}}function visiblePixelRange(o,e){let a=o.getBoundingClientRect(),l=o.ownerDocument,u=l.defaultView||window,p=Math.max(0,a.left),d=Math.min(u.innerWidth,a.right),f=Math.max(0,a.top),g=Math.min(u.innerHeight,a.bottom);for(let b=o.parentNode;b&&b!=l.body;)if(b.nodeType==1){let A=b,S=window.getComputedStyle(A);if((A.scrollHeight>A.clientHeight||A.scrollWidth>A.clientWidth)&&S.overflow!="visible"){let M=A.getBoundingClientRect();p=Math.max(p,M.left),d=Math.min(d,M.right),f=Math.max(f,M.top),g=Math.min(b==o.parentNode?u.innerHeight:g,M.bottom)}b=S.position=="absolute"||S.position=="fixed"?A.offsetParent:A.parentNode}else if(b.nodeType==11)b=b.host;else break;return{left:p-a.left,right:Math.max(p,d)-a.left,top:f-(a.top+e),bottom:Math.max(f,g)-(a.top+e)}}function inWindow(o){let e=o.getBoundingClientRect(),a=o.ownerDocument.defaultView||window;return e.left<a.innerWidth&&e.right>0&&e.top<a.innerHeight&&e.bottom>0}function fullPixelRange(o,e){let a=o.getBoundingClientRect();return{left:0,right:a.right-a.left,top:e,bottom:a.bottom-(a.top+e)}}class LineGap{constructor(e,a,l,u){this.from=e,this.to=a,this.size=l,this.displaySize=u}static same(e,a){if(e.length!=a.length)return!1;for(let l=0;l<e.length;l++){let u=e[l],p=a[l];if(u.from!=p.from||u.to!=p.to||u.size!=p.size)return!1}return!0}draw(e,a){return Decoration.replace({widget:new LineGapWidget(this.displaySize*(a?e.scaleY:e.scaleX),a)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(e,a){super(),this.size=e,this.vertical=a}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let a=e.facet(contentAttributes).some(l=>typeof l!="function"&&l.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(a),this.stateDeco=e.facet(decorations).filter(l=>typeof l!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]);for(let l=0;l<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());l++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(l=>l.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:a}=this.state.selection;for(let l=0;l<=1;l++){let u=l?a.head:a.anchor;if(!e.some(({from:p,to:d})=>u>=p&&u<=d)){let{from:p,to:d}=this.lineBlockAt(u);e.push(new Viewport(p,d))}}return this.viewports=e.sort((l,u)=>l.from-u.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(scaleBlock(e,this.scaler))})}update(e,a=null){this.state=e.state;let l=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(A=>typeof A!="function");let u=e.changedRanges,p=ChangedRange.extendWithRanges(u,heightRelevantDecoChanges(l,this.stateDeco,e?e.changes:ChangeSet.empty(this.state.doc.length))),d=this.heightMap.height,f=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);clearHeightChangeFlag(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),p),(this.heightMap.height!=d||heightChangeFlag)&&(e.flags|=2),f?(this.scrollAnchorPos=e.changes.mapPos(f.from,-1),this.scrollAnchorHeight=f.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=d);let g=p.length?this.mapViewport(this.viewport,e.changes):this.viewport;(a&&(a.range.head<g.from||a.range.head>g.to)||!this.viewportIsAppropriate(g))&&(g=this.getViewport(0,a));let b=g.from!=this.viewport.from||g.to!=this.viewport.to;this.viewport=g,e.flags|=this.updateForViewport(),(b||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),a&&(this.scrollTarget=a),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let a=e.contentDOM,l=window.getComputedStyle(a),u=this.heightOracle,p=l.whiteSpace;this.defaultTextDirection=l.direction=="rtl"?Direction.RTL:Direction.LTR;let d=this.heightOracle.mustRefreshForWrapping(p),f=a.getBoundingClientRect(),g=d||this.mustMeasureContent||this.contentDOMHeight!=f.height;this.contentDOMHeight=f.height,this.mustMeasureContent=!1;let b=0,A=0;if(f.width&&f.height){let{scaleX:z,scaleY:U}=getScale$1(a,f);(z>.005&&Math.abs(this.scaleX-z)>.005||U>.005&&Math.abs(this.scaleY-U)>.005)&&(this.scaleX=z,this.scaleY=U,b|=16,d=g=!0)}let S=(parseInt(l.paddingTop)||0)*this.scaleY,M=(parseInt(l.paddingBottom)||0)*this.scaleY;(this.paddingTop!=S||this.paddingBottom!=M)&&(this.paddingTop=S,this.paddingBottom=M,b|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(u.lineWrapping&&(g=!0),this.editorWidth=e.scrollDOM.clientWidth,b|=16);let E=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=E&&(this.scrollAnchorHeight=-1,this.scrollTop=E),this.scrolledToBottom=isScrolledToBottom(e.scrollDOM);let F=(this.printing?fullPixelRange:visiblePixelRange)(a,this.paddingTop),$=F.top-this.pixelViewport.top,Z=F.bottom-this.pixelViewport.bottom;this.pixelViewport=F;let V=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(V!=this.inView&&(this.inView=V,V&&(g=!0)),!this.inView&&!this.scrollTarget&&!inWindow(e.dom))return 0;let K=f.width;if((this.contentDOMWidth!=K||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=f.width,this.editorHeight=e.scrollDOM.clientHeight,b|=16),g){let z=e.docView.measureVisibleLineHeights(this.viewport);if(u.mustRefreshForHeights(z)&&(d=!0),d||u.lineWrapping&&Math.abs(K-this.contentDOMWidth)>u.charWidth){let{lineHeight:U,charWidth:ee,textHeight:ae}=e.docView.measureTextSize();d=U>0&&u.refresh(p,U,ee,ae,Math.max(5,K/ee),z),d&&(e.docView.minWidth=0,b|=16)}$>0&&Z>0?A=Math.max($,Z):$<0&&Z<0&&(A=Math.min($,Z)),clearHeightChangeFlag();for(let U of this.viewports){let ee=U.from==this.viewport.from?z:e.docView.measureVisibleLineHeights(U);this.heightMap=(d?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(u,0,d,new MeasuredHeights(U.from,ee))}heightChangeFlag&&(b|=2)}let se=!this.viewportIsAppropriate(this.viewport,A)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return se&&(b&2&&(b|=this.updateScaler()),this.viewport=this.getViewport(A,this.scrollTarget),b|=this.updateForViewport()),(b&2||se)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(d?[]:this.lineGaps,e)),b|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),b}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,a){let l=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),u=this.heightMap,p=this.heightOracle,{visibleTop:d,visibleBottom:f}=this,g=new Viewport(u.lineAt(d-l*1e3,QueryType$1.ByHeight,p,0,0).from,u.lineAt(f+(1-l)*1e3,QueryType$1.ByHeight,p,0,0).to);if(a){let{head:b}=a.range;if(b<g.from||b>g.to){let A=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),S=u.lineAt(b,QueryType$1.ByPos,p,0,0),M;a.y=="center"?M=(S.top+S.bottom)/2-A/2:a.y=="start"||a.y=="nearest"&&b<g.from?M=S.top:M=S.bottom-A,g=new Viewport(u.lineAt(M-1e3/2,QueryType$1.ByHeight,p,0,0).from,u.lineAt(M+A+1e3/2,QueryType$1.ByHeight,p,0,0).to)}}return g}mapViewport(e,a){let l=a.mapPos(e.from,-1),u=a.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(l,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(u,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:a},l=0){if(!this.inView)return!0;let{top:u}=this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:p}=this.heightMap.lineAt(a,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:d,visibleBottom:f}=this;return(e==0||u<=d-Math.max(10,Math.min(-l,250)))&&(a==this.state.doc.length||p>=f+Math.max(10,Math.min(l,250)))&&u>d-2*1e3&&p<f+2*1e3}mapLineGaps(e,a){if(!e.length||a.empty)return e;let l=[];for(let u of e)a.touchesRange(u.from,u.to)||l.push(new LineGap(a.mapPos(u.from),a.mapPos(u.to),u.size,u.displaySize));return l}ensureLineGaps(e,a){let l=this.heightOracle.lineWrapping,u=l?1e4:2e3,p=u>>1,d=u<<1;if(this.defaultTextDirection!=Direction.LTR&&!l)return[];let f=[],g=(A,S,M,E)=>{if(S-A<p)return;let F=this.state.selection.main,$=[F.from];F.empty||$.push(F.to);for(let V of $)if(V>A&&V<S){g(A,V-10,M,E),g(V+10,S,M,E);return}let Z=find(e,V=>V.from>=M.from&&V.to<=M.to&&Math.abs(V.from-A)<p&&Math.abs(V.to-S)<p&&!$.some(K=>V.from<K&&V.to>K));if(!Z){if(S<M.to&&a&&l&&a.visibleRanges.some(se=>se.from<=S&&se.to>=S)){let se=a.moveToLineBoundary(EditorSelection.cursor(S),!1,!0).head;se>A&&(S=se)}let V=this.gapSize(M,A,S,E),K=l||V<2e6?V:2e6;Z=new LineGap(A,S,V,K)}f.push(Z)},b=A=>{if(A.length<d||A.type!=BlockType.Text)return;let S=lineStructure(A.from,A.to,this.stateDeco);if(S.total<d)return;let M=this.scrollTarget?this.scrollTarget.range.head:null,E,F;if(l){let $=u/this.heightOracle.lineLength*this.heightOracle.lineHeight,Z,V;if(M!=null){let K=findFraction(S,M),se=((this.visibleBottom-this.visibleTop)/2+$)/A.height;Z=K-se,V=K+se}else Z=(this.visibleTop-A.top-$)/A.height,V=(this.visibleBottom-A.top+$)/A.height;E=findPosition(S,Z),F=findPosition(S,V)}else{let $=S.total*this.heightOracle.charWidth,Z=u*this.heightOracle.charWidth,V=0;if($>2e6)for(let ee of e)ee.from>=A.from&&ee.from<A.to&&ee.size!=ee.displaySize&&ee.from*this.heightOracle.charWidth+V<this.pixelViewport.left&&(V=ee.size-ee.displaySize);let K=this.pixelViewport.left+V,se=this.pixelViewport.right+V,z,U;if(M!=null){let ee=findFraction(S,M),ae=((se-K)/2+Z)/$;z=ee-ae,U=ee+ae}else z=(K-Z)/$,U=(se+Z)/$;E=findPosition(S,z),F=findPosition(S,U)}E>A.from&&g(A.from,E,A,S),F<A.to&&g(F,A.to,A,S)};for(let A of this.viewportLines)Array.isArray(A.type)?A.type.forEach(b):b(A);return f}gapSize(e,a,l,u){let p=findFraction(u,l)-findFraction(u,a);return this.heightOracle.lineWrapping?e.height*p:u.total*this.heightOracle.charWidth*p}updateLineGaps(e){LineGap.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Decoration.set(e.map(a=>a.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let a=this.stateDeco;this.lineGaps.length&&(a=a.concat(this.lineGapDeco));let l=[];RangeSet.spans(a,this.viewport.from,this.viewport.to,{span(p,d){l.push({from:p,to:d})},point(){}},20);let u=0;if(l.length!=this.visibleRanges.length)u=12;else for(let p=0;p<l.length&&!(u&8);p++){let d=this.visibleRanges[p],f=l[p];(d.from!=f.from||d.to!=f.to)&&(u|=4,e&&e.mapPos(d.from,-1)==f.from&&e.mapPos(d.to,1)==f.to||(u|=8))}return this.visibleRanges=l,u}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(a=>a.from<=e&&a.to>=e)||scaleBlock(this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(a=>a.top<=e&&a.bottom>=e)||scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(e),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let a=this.lineBlockAtHeight(e+8);return a.from>=this.viewport.from||this.viewportLines[0].top-e>200?a:this.viewportLines[0]}elementAtHeight(e){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(e,a){this.from=e,this.to=a}}function lineStructure(o,e,a){let l=[],u=o,p=0;return RangeSet.spans(a,o,e,{span(){},point(d,f){d>u&&(l.push({from:u,to:d}),p+=d-u),u=f}},20),u<e&&(l.push({from:u,to:e}),p+=e-u),{total:p,ranges:l}}function findPosition({total:o,ranges:e},a){if(a<=0)return e[0].from;if(a>=1)return e[e.length-1].to;let l=Math.floor(o*a);for(let u=0;;u++){let{from:p,to:d}=e[u],f=d-p;if(l<=f)return p+l;l-=f}}function findFraction(o,e){let a=0;for(let{from:l,to:u}of o.ranges){if(e<=u){a+=e-l;break}a+=u-l}return a/o.total}function find(o,e){for(let a of o)if(e(a))return a}const IdScaler={toDOM(o){return o},fromDOM(o){return o},scale:1,eq(o){return o==this}};class BigScaler{constructor(e,a,l){let u=0,p=0,d=0;this.viewports=l.map(({from:f,to:g})=>{let b=a.lineAt(f,QueryType$1.ByPos,e,0,0).top,A=a.lineAt(g,QueryType$1.ByPos,e,0,0).bottom;return u+=A-b,{from:f,to:g,top:b,bottom:A,domTop:0,domBottom:0}}),this.scale=(7e6-u)/(a.height-u);for(let f of this.viewports)f.domTop=d+(f.top-p)*this.scale,d=f.domBottom=f.domTop+(f.bottom-f.top),p=f.bottom}toDOM(e){for(let a=0,l=0,u=0;;a++){let p=a<this.viewports.length?this.viewports[a]:null;if(!p||e<p.top)return u+(e-l)*this.scale;if(e<=p.bottom)return p.domTop+(e-p.top);l=p.bottom,u=p.domBottom}}fromDOM(e){for(let a=0,l=0,u=0;;a++){let p=a<this.viewports.length?this.viewports[a]:null;if(!p||e<p.domTop)return l+(e-u)/this.scale;if(e<=p.domBottom)return p.top+(e-p.domTop);l=p.bottom,u=p.domBottom}}eq(e){return e instanceof BigScaler?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((a,l)=>a.from==e.viewports[l].from&&a.to==e.viewports[l].to):!1}}function scaleBlock(o,e){if(e.scale==1)return o;let a=e.toDOM(o.top),l=e.toDOM(o.bottom);return new BlockInfo(o.from,o.length,a,l-a,Array.isArray(o._content)?o._content.map(u=>scaleBlock(u,e)):o._content)}const theme$1=Facet.define({combine:o=>o.join(" ")}),darkTheme=Facet.define({combine:o=>o.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(o,e,a){return new StyleModule(e,{finish(l){return/&/.test(l)?l.replace(/&\w*/,u=>{if(u=="&")return o;if(!a||!a[u])throw new RangeError(`Unsupported selector: ${u}`);return a[u]}):o+" "+l}})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs),observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(a=>{for(let l of a)this.queue.push(l);(browser.ie&&browser.ie_version<=11||browser.ios&&e.composing)&&a.some(l=>l.type=="childList"&&l.removedNodes.length||l.type=="characterData"&&l.oldValue.length>l.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&browser.android&&e.constructor.EDIT_CONTEXT!==!1&&!(browser.chrome&&browser.chrome_version<126)&&(this.editContext=new EditContextManager(e),e.state.facet(editable)&&(e.contentDOM.editContext=this.editContext.editContext)),useCharData&&(this.onCharData=a=>{this.queue.push({target:a.target,type:"characterData",oldValue:a.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var a;((a=this.view.docView)===null||a===void 0?void 0:a.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(a=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),a.length>0&&a[a.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(a=>{a.length>0&&a[a.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((a,l)=>a!=e[l]))){this.gapIntersection.disconnect();for(let a of e)this.gapIntersection.observe(a);this.gaps=e}}onSelectionChange(e){let a=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:l}=this,u=this.selectionRange;if(l.state.facet(editable)?l.root.activeElement!=this.dom:!hasSelection(this.dom,u))return;let p=u.anchorNode&&l.docView.tile.nearest(u.anchorNode);if(p&&p.isWidget()&&p.widget.ignoreEvent(e)){a||(this.selectionChanged=!1);return}(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!l.state.selection.main.empty&&u.focusNode&&isEquivalentPosition(u.focusNode,u.focusOffset,u.anchorNode,u.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,a=getSelection(e.root);if(!a)return!1;let l=browser.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&safariSelectionRangeHack(this.view,a)||a;if(!l||this.selectionRange.eq(l))return!1;let u=hasSelection(this.dom,l);return u&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,l)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(l),u&&(this.selectionChanged=!0),!0)}setSelectionRange(e,a){this.selectionRange.set(e.node,e.offset,a.node,a.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,a=null;for(let l=this.dom;l;)if(l.nodeType==1)!a&&e<this.scrollTargets.length&&this.scrollTargets[e]==l?e++:a||(a=this.scrollTargets.slice(0,e)),a&&a.push(l),l=l.assignedSlot||l.parentNode;else if(l.nodeType==11)l=l.host;else break;if(e<this.scrollTargets.length&&!a&&(a=this.scrollTargets.slice(0,e)),a){for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);for(let l of this.scrollTargets=a)l.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,a){var l;if(!this.delayedAndroidKey){let u=()=>{let p=this.delayedAndroidKey;p&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=p.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&p.force&&dispatchKey(this.dom,p.key,p.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(u)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:a,force:this.lastChange<Date.now()-50||!!(!((l=this.delayedAndroidKey)===null||l===void 0)&&l.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let a=-1,l=-1,u=!1;for(let p of e){let d=this.readMutation(p);d&&(d.typeOver&&(u=!0),a==-1?{from:a,to:l}=d:(a=Math.min(d.from,a),l=Math.max(d.to,l)))}return{from:a,to:l,typeOver:u}}readChange(){let{from:e,to:a,typeOver:l}=this.processRecords(),u=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(e<0&&!u)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let p=new DOMChange(this.view,e,a,l);return this.view.docView.domChanged={newSel:p.newSel?p.newSel.main:null},p}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let a=this.readChange();if(!a)return this.view.requestMeasure(),!1;let l=this.view.state,u=applyDOMChange(this.view,a);return this.view.state==l&&(a.domChanged||a.newSel&&!a.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),u}readMutation(e){let a=this.view.docView.tile.nearest(e.target);if(!a||a.isWidget())return null;if(a.markDirty(e.type=="attributes"),e.type=="childList"){let l=findChild(a,e.previousSibling||e.target.previousSibling,-1),u=findChild(a,e.nextSibling||e.target.nextSibling,1);return{from:l?a.posAfter(l):a.posAtStart,to:u?a.posBefore(u):a.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:a.posAtStart,to:a.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(editable)!=e.state.facet(editable)&&(e.view.contentDOM.editContext=e.state.facet(editable)?this.editContext.editContext:null))}destroy(){var e,a,l;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(a=this.gapIntersection)===null||a===void 0||a.disconnect(),(l=this.resizeScroll)===null||l===void 0||l.disconnect();for(let u of this.scrollTargets)u.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function findChild(o,e,a){for(;e;){let l=Tile.get(e);if(l&&l.parent==o)return l;let u=e.parentNode;e=u!=o.dom?u:a>0?e.nextSibling:e.previousSibling}return null}function buildSelectionRangeFromRange(o,e){let a=e.startContainer,l=e.startOffset,u=e.endContainer,p=e.endOffset,d=o.docView.domAtPos(o.state.selection.main.anchor,1);return isEquivalentPosition(d.node,d.offset,u,p)&&([a,l,u,p]=[u,p,a,l]),{anchorNode:a,anchorOffset:l,focusNode:u,focusOffset:p}}function safariSelectionRangeHack(o,e){if(e.getComposedRanges){let u=e.getComposedRanges(o.root)[0];if(u)return buildSelectionRangeFromRange(o,u)}let a=null;function l(u){u.preventDefault(),u.stopImmediatePropagation(),a=u.getTargetRanges()[0]}return o.contentDOM.addEventListener("beforeinput",l,!0),o.dom.ownerDocument.execCommand("indent"),o.contentDOM.removeEventListener("beforeinput",l,!0),a?buildSelectionRangeFromRange(o,a):null}class EditContextManager{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let a=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=l=>{let u=e.state.selection.main,{anchor:p,head:d}=u,f=this.toEditorPos(l.updateRangeStart),g=this.toEditorPos(l.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:l.updateRangeStart,editorBase:f,drifted:!1});let b=g-f>l.text.length;f==this.from&&p<this.from?f=p:g==this.to&&p>this.to&&(g=p);let A=findDiff(e.state.sliceDoc(f,g),l.text,(b?u.from:u.to)-f,b?"end":null);if(!A){let M=EditorSelection.single(this.toEditorPos(l.selectionStart),this.toEditorPos(l.selectionEnd));M.main.eq(u)||e.dispatch({selection:M,userEvent:"select"});return}let S={from:A.from+f,to:A.toA+f,insert:Text.of(l.text.slice(A.from,A.toB).split(`
`))};if((browser.mac||browser.android)&&S.from==d-1&&/^\. ?$/.test(l.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(S={from:f,to:g,insert:Text.of([l.text.replace("."," ")])}),this.pendingContextChange=S,!e.state.readOnly){let M=this.to-this.from+(S.to-S.from+S.insert.length);applyDOMChangeInner(e,S,EditorSelection.single(this.toEditorPos(l.selectionStart,M),this.toEditorPos(l.selectionEnd,M)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),S.from<S.to&&!S.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(a.text.slice(Math.max(0,l.updateRangeStart-1),Math.min(a.text.length,l.updateRangeStart+1)))&&this.handlers.compositionend(l)},this.handlers.characterboundsupdate=l=>{let u=[],p=null;for(let d=this.toEditorPos(l.rangeStart),f=this.toEditorPos(l.rangeEnd);d<f;d++){let g=e.coordsForChar(d);p=g&&new DOMRect(g.left,g.top,g.right-g.left,g.bottom-g.top)||p||new DOMRect,u.push(p)}a.updateCharacterBounds(l.rangeStart,u)},this.handlers.textformatupdate=l=>{let u=[];for(let p of l.getTextFormats()){let d=p.underlineStyle,f=p.underlineThickness;if(!/none/i.test(d)&&!/none/i.test(f)){let g=this.toEditorPos(p.rangeStart),b=this.toEditorPos(p.rangeEnd);if(g<b){let A=`text-decoration: underline ${/^[a-z]/.test(d)?d+" ":d=="Dashed"?"dashed ":d=="Squiggle"?"wavy ":""}${/thin/i.test(f)?1:2}px`;u.push(Decoration.mark({attributes:{style:A}}).range(g,b))}}}e.dispatch({effects:setEditContextFormatting.of(Decoration.set(u))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:l}=this.composing;this.composing=null,l&&this.reset(e.state)}};for(let l in this.handlers)a.addEventListener(l,this.handlers[l]);this.measureReq={read:l=>{this.editContext.updateControlBounds(l.contentDOM.getBoundingClientRect());let u=getSelection(l.root);u&&u.rangeCount&&this.editContext.updateSelectionBounds(u.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let a=0,l=!1,u=this.pendingContextChange;return e.changes.iterChanges((p,d,f,g,b)=>{if(l)return;let A=b.length-(d-p);if(u&&d>=u.to)if(u.from==p&&u.to==d&&u.insert.eq(b)){u=this.pendingContextChange=null,a+=A,this.to+=A;return}else u=null,this.revertPending(e.state);if(p+=a,d+=a,d<=this.from)this.from+=A,this.to+=A;else if(p<this.to){if(p<this.from||d>this.to||this.to-this.from+b.length>3e4){l=!0;return}this.editContext.updateText(this.toContextPos(p),this.toContextPos(d),b.toString()),this.to+=A}a+=A}),u&&!l&&this.revertPending(e.state),!l}update(e){let a=this.pendingContextChange,l=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(l.from,l.to)&&e.transactions.some(u=>!u.isUserEvent("input.type")&&u.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||a)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:a}=e.selection.main;this.from=Math.max(0,a-1e4),this.to=Math.min(e.doc.length,a+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let a=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(a.from),this.toContextPos(a.from+a.insert.length),e.doc.sliceString(a.from,a.to))}setSelection(e){let{main:a}=e.selection,l=this.toContextPos(Math.max(this.from,Math.min(this.to,a.anchor))),u=this.toContextPos(a.head);(this.editContext.selectionStart!=l||this.editContext.selectionEnd!=u)&&this.editContext.updateSelection(l,u)}rangeIsValid(e){let{head:a}=e.selection.main;return!(this.from>0&&a-this.from<500||this.to<e.doc.length&&this.to-a<500||this.to-this.from>1e4*3)}toEditorPos(e,a=this.to-this.from){e=Math.min(e,a);let l=this.composing;return l&&l.drifted?l.editorBase+(e-l.contextBase):e+this.from}toContextPos(e){let a=this.composing;return a&&a.drifted?a.contextBase+(e-a.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var a;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:l}=e;this.dispatchTransactions=e.dispatchTransactions||l&&(u=>u.forEach(p=>l(p,this)))||(u=>this.update(u)),this.dispatch=this.dispatch.bind(this),this._root=e.root||getRoot(e.parent)||document,this.viewState=new ViewState(e.state||EditorState.create(e)),e.scrollTo&&e.scrollTo.is(scrollIntoView$1)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(viewPlugin).map(u=>new PluginInstance(u));for(let u of this.plugins)u.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((a=document.fonts)===null||a===void 0)&&a.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let a=e.length==1&&e[0]instanceof Transaction?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(a,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let a=!1,l=!1,u,p=this.state;for(let M of e){if(M.startState!=p)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");p=M.state}if(this.destroyed){this.viewState.state=p;return}let d=this.hasFocus,f=0,g=null;e.some(M=>M.annotation(isFocusChange))?(this.inputState.notifiedFocused=d,f=1):d!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=d,g=focusChangeTransaction(p,d),g||(f=1));let b=this.observer.delayedAndroidKey,A=null;if(b?(this.observer.clearDelayedAndroidKey(),A=this.observer.readChange(),(A&&!this.state.doc.eq(p.doc)||!this.state.selection.eq(p.selection))&&(A=null)):this.observer.clear(),p.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(p);u=ViewUpdate.create(this,p,e),u.flags|=f;let S=this.viewState.scrollTarget;try{this.updateState=2;for(let M of e){if(S&&(S=S.map(M.changes)),M.scrollIntoView){let{main:E}=M.state.selection;S=new ScrollTarget(E.empty?E:EditorSelection.cursor(E.head,E.head>E.anchor?-1:1))}for(let E of M.effects)E.is(scrollIntoView$1)&&(S=E.value.clip(this.state))}this.viewState.update(u,S),this.bidiCache=CachedOrder.update(this.bidiCache,u.changes),u.empty||(this.updatePlugins(u),this.inputState.update(u)),a=this.docView.update(u),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),l=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(a,e.some(M=>M.isUserEvent("select.pointer")))}finally{this.updateState=0}if(u.startState.facet(theme$1)!=u.state.facet(theme$1)&&(this.viewState.mustMeasureContent=!0),(a||l||S||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),a&&this.docViewUpdate(),!u.empty)for(let M of this.state.facet(updateListener))try{M(u)}catch(E){logException(this.state,E,"update listener")}(g||A)&&Promise.resolve().then(()=>{g&&this.state==g.startState&&this.dispatch(g),A&&!applyDOMChange(this,A)&&b.force&&dispatchKey(this.contentDOM,b.key,b.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let a=this.hasFocus;try{for(let l of this.plugins)l.destroy(this);this.viewState=new ViewState(e),this.plugins=e.facet(viewPlugin).map(l=>new PluginInstance(l)),this.pluginMap.clear();for(let l of this.plugins)l.update(this);this.docView.destroy(),this.docView=new DocView(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}a&&this.focus(),this.requestMeasure()}updatePlugins(e){let a=e.startState.facet(viewPlugin),l=e.state.facet(viewPlugin);if(a!=l){let u=[];for(let p of l){let d=a.indexOf(p);if(d<0)u.push(new PluginInstance(p));else{let f=this.plugins[d];f.mustUpdate=e,u.push(f)}}for(let p of this.plugins)p.mustUpdate!=e&&p.destroy(this);this.plugins=u,this.pluginMap.clear()}else for(let u of this.plugins)u.mustUpdate=e;for(let u=0;u<this.plugins.length;u++)this.plugins[u].update(this);a!=l&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let a=e.value;if(a&&a.docViewUpdate)try{a.docViewUpdate(this)}catch(l){logException(this.state,l,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let a=null,l=this.scrollDOM,u=l.scrollTop*this.scaleY,{scrollAnchorPos:p,scrollAnchorHeight:d}=this.viewState;Math.abs(u-this.viewState.scrollTop)>1&&(d=-1),this.viewState.scrollAnchorHeight=-1;try{for(let f=0;;f++){if(d<0)if(isScrolledToBottom(l))p=-1,d=this.viewState.heightMap.height;else{let E=this.viewState.scrollAnchorAt(u);p=E.from,d=E.top}this.updateState=1;let g=this.viewState.measure(this);if(!g&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(f>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let b=[];g&4||([this.measureRequests,b]=[b,this.measureRequests]);let A=b.map(E=>{try{return E.read(this)}catch(F){return logException(this.state,F),BadMeasure}}),S=ViewUpdate.create(this,this.state,[]),M=!1;S.flags|=g,a?a.flags|=g:a=S,this.updateState=2,S.empty||(this.updatePlugins(S),this.inputState.update(S),this.updateAttrs(),M=this.docView.update(S),M&&this.docViewUpdate());for(let E=0;E<b.length;E++)if(A[E]!=BadMeasure)try{let F=b[E];F.write&&F.write(A[E],this)}catch(F){logException(this.state,F)}if(M&&this.docView.updateSelection(!0),!S.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,d=-1;continue}else{let F=(p<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(p).top)-d;if(F>1||F<-1){u=u+F,l.scrollTop=u/this.scaleY,d=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(a&&!a.empty)for(let f of this.state.facet(updateListener))f(a)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme$1)}updateAttrs(){let e=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),a={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(a["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,a);let l=this.observer.ignore(()=>{let u=updateAttrs(this.contentDOM,this.contentAttrs,a),p=updateAttrs(this.dom,this.editorAttrs,e);return u||p});return this.editorAttrs=e,this.contentAttrs=a,l}showAnnouncements(e){let a=!0;for(let l of e)for(let u of l.effects)if(u.is(EditorView.announce)){a&&(this.announceDOM.textContent=""),a=!1;let p=this.announceDOM.appendChild(document.createElement("div"));p.textContent=u.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let e=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let a=0;a<this.measureRequests.length;a++)if(this.measureRequests[a].key===e.key){this.measureRequests[a]=e;return}}this.measureRequests.push(e)}}plugin(e){let a=this.pluginMap.get(e);return(a===void 0||a&&a.plugin!=e)&&this.pluginMap.set(e,a=this.plugins.find(l=>l.plugin==e)||null),a&&a.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,a,l){return skipAtoms(this,e,moveByChar(this,e,a,l))}moveByGroup(e,a){return skipAtoms(this,e,moveByChar(this,e,a,l=>byGroup(this,e.head,l)))}visualLineSide(e,a){let l=this.bidiSpans(e),u=this.textDirectionAt(e.from),p=l[a?l.length-1:0];return EditorSelection.cursor(p.side(a,u)+e.from,p.forward(!a,u)?1:-1)}moveToLineBoundary(e,a,l=!0){return moveToLineBoundary(this,e,a,l)}moveVertically(e,a,l){return skipAtoms(this,e,moveVertically(this,e,a,l))}domAtPos(e,a=1){return this.docView.domAtPos(e,a)}posAtDOM(e,a=0){return this.docView.posFromDOM(e,a)}posAtCoords(e,a=!0){this.readMeasured();let l=posAtCoords(this,e,a);return l&&l.pos}posAndSideAtCoords(e,a=!0){return this.readMeasured(),posAtCoords(this,e,a)}coordsAtPos(e,a=1){this.readMeasured();let l=this.docView.coordsAt(e,a);if(!l||l.left==l.right)return l;let u=this.state.doc.lineAt(e),p=this.bidiSpans(u),d=p[BidiSpan.find(p,e-u.from,-1,a)];return flattenRect(l,d.dir==Direction.LTR==a>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(perLineTextDirection)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);let a=this.textDirectionAt(e.from),l;for(let p of this.bidiCache)if(p.from==e.from&&p.dir==a&&(p.fresh||isolatesEq(p.isolates,l=getIsolatedRanges(this,e))))return p.order;l||(l=getIsolatedRanges(this,e));let u=computeOrder(e.text,a,l);return this.bidiCache.push(new CachedOrder(e.from,e.to,a,l,!0,u)),u}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,a={}){return scrollIntoView$1.of(new ScrollTarget(typeof e=="number"?EditorSelection.cursor(e):e,a.y,a.x,a.yMargin,a.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:a}=this.scrollDOM,l=this.viewState.scrollAnchorAt(e);return scrollIntoView$1.of(new ScrollTarget(EditorSelection.cursor(l.from),"start","start",l.top-e,a,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return ViewPlugin.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return ViewPlugin.define(()=>({}),{eventObservers:e})}static theme(e,a){let l=StyleModule.newName(),u=[theme$1.of(l),styleModule.of(buildTheme(`.${l}`,e))];return a&&a.dark&&u.push(darkTheme.of(!0)),u}static baseTheme(e){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,e,lightDarkIDs)))}static findFromDOM(e){var a;let l=e.querySelector(".cm-content"),u=l&&Tile.get(l)||Tile.get(e);return((a=u?.root)===null||a===void 0?void 0:a.view)||null}}EditorView.styleModule=styleModule,EditorView.inputHandler=inputHandler$1,EditorView.clipboardInputFilter=clipboardInputFilter,EditorView.clipboardOutputFilter=clipboardOutputFilter,EditorView.scrollHandler=scrollHandler,EditorView.focusChangeEffect=focusChangeEffect,EditorView.perLineTextDirection=perLineTextDirection,EditorView.exceptionSink=exceptionSink,EditorView.updateListener=updateListener,EditorView.editable=editable,EditorView.mouseSelectionStyle=mouseSelectionStyle,EditorView.dragMovesSelection=dragMovesSelection$1,EditorView.clickAddsSelectionRange=clickAddsSelectionRange,EditorView.decorations=decorations,EditorView.blockWrappers=blockWrappers,EditorView.outerDecorations=outerDecorations,EditorView.atomicRanges=atomicRanges,EditorView.bidiIsolatedRanges=bidiIsolatedRanges,EditorView.scrollMargins=scrollMargins,EditorView.darkTheme=darkTheme,EditorView.cspNonce=Facet.define({combine:o=>o.length?o[0]:""}),EditorView.contentAttributes=contentAttributes,EditorView.editorAttributes=editorAttributes,EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"}),EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(e,a,l,u,p,d){this.from=e,this.to=a,this.dir=l,this.isolates=u,this.fresh=p,this.order=d}static update(e,a){if(a.empty&&!e.some(p=>p.fresh))return e;let l=[],u=e.length?e[e.length-1].dir:Direction.LTR;for(let p=Math.max(0,e.length-10);p<e.length;p++){let d=e[p];d.dir==u&&!a.touchesRange(d.from,d.to)&&l.push(new CachedOrder(a.mapPos(d.from,1),a.mapPos(d.to,-1),d.dir,d.isolates,!1,d.order))}return l}}function attrsFromFacet(o,e,a){for(let l=o.state.facet(e),u=l.length-1;u>=0;u--){let p=l[u],d=typeof p=="function"?p(o):p;d&&combineAttrs(d,a)}return a}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(o,e){const a=o.split(/-(?!$)/);let l=a[a.length-1];l=="Space"&&(l=" ");let u,p,d,f;for(let g=0;g<a.length-1;++g){const b=a[g];if(/^(cmd|meta|m)$/i.test(b))f=!0;else if(/^a(lt)?$/i.test(b))u=!0;else if(/^(c|ctrl|control)$/i.test(b))p=!0;else if(/^s(hift)?$/i.test(b))d=!0;else if(/^mod$/i.test(b))e=="mac"?f=!0:p=!0;else throw new Error("Unrecognized modifier name: "+b)}return u&&(l="Alt-"+l),p&&(l="Ctrl-"+l),f&&(l="Meta-"+l),d&&(l="Shift-"+l),l}function modifiers(o,e,a){return e.altKey&&(o="Alt-"+o),e.ctrlKey&&(o="Ctrl-"+o),e.metaKey&&(o="Meta-"+o),a!==!1&&e.shiftKey&&(o="Shift-"+o),o}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(o,e){return runHandlers(getKeymap(e.state),o,e,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(o){let e=o.facet(keymap),a=Keymaps.get(e);return a||Keymaps.set(e,a=buildKeymap(e.reduce((l,u)=>l.concat(u),[]))),a}function runScopeHandlers(o,e,a){return runHandlers(getKeymap(o.state),e,o,a)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(o,e=currentPlatform){let a=Object.create(null),l=Object.create(null),u=(d,f)=>{let g=l[d];if(g==null)l[d]=f;else if(g!=f)throw new Error("Key binding "+d+" is used both as a regular binding and as a multi-stroke prefix")},p=(d,f,g,b,A)=>{var S,M;let E=a[d]||(a[d]=Object.create(null)),F=f.split(/ (?!$)/).map(V=>normalizeKeyName(V,e));for(let V=1;V<F.length;V++){let K=F.slice(0,V).join(" ");u(K,!0),E[K]||(E[K]={preventDefault:!0,stopPropagation:!1,run:[se=>{let z=storedPrefix={view:se,prefix:K,scope:d};return setTimeout(()=>{storedPrefix==z&&(storedPrefix=null)},PrefixTimeout),!0}]})}let $=F.join(" ");u($,!1);let Z=E[$]||(E[$]={preventDefault:!1,stopPropagation:!1,run:((M=(S=E._any)===null||S===void 0?void 0:S.run)===null||M===void 0?void 0:M.slice())||[]});g&&Z.run.push(g),b&&(Z.preventDefault=!0),A&&(Z.stopPropagation=!0)};for(let d of o){let f=d.scope?d.scope.split(" "):["editor"];if(d.any)for(let b of f){let A=a[b]||(a[b]=Object.create(null));A._any||(A._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:S}=d;for(let M in A)A[M].run.push(E=>S(E,currentKeyEvent))}let g=d[e]||d.key;if(g)for(let b of f)p(b,g,d.run,d.preventDefault,d.stopPropagation),d.shift&&p(b,"Shift-"+g,d.shift,d.preventDefault,d.stopPropagation)}return a}let currentKeyEvent=null;function runHandlers(o,e,a,l){currentKeyEvent=e;let u=keyName(e),p=codePointAt(u,0),d=codePointSize(p)==u.length&&u!=" ",f="",g=!1,b=!1,A=!1;storedPrefix&&storedPrefix.view==a&&storedPrefix.scope==l&&(f=storedPrefix.prefix+" ",modifierCodes.indexOf(e.keyCode)<0&&(b=!0,storedPrefix=null));let S=new Set,M=Z=>{if(Z){for(let V of Z.run)if(!S.has(V)&&(S.add(V),V(a)))return Z.stopPropagation&&(A=!0),!0;Z.preventDefault&&(Z.stopPropagation&&(A=!0),b=!0)}return!1},E=o[l],F,$;return E&&(M(E[f+modifiers(u,e,!d)])?g=!0:d&&(e.altKey||e.metaKey||e.ctrlKey)&&!(browser.windows&&e.ctrlKey&&e.altKey)&&!(browser.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(F=base[e.keyCode])&&F!=u?(M(E[f+modifiers(F,e,!0)])||e.shiftKey&&($=shift[e.keyCode])!=u&&$!=F&&M(E[f+modifiers($,e,!1)]))&&(g=!0):d&&e.shiftKey&&M(E[f+modifiers(u,e,!0)])&&(g=!0),!g&&M(E._any)&&(g=!0)),b&&(g=!0),g&&A&&e.stopPropagation(),currentKeyEvent=null,g}class RectangleMarker{constructor(e,a,l,u,p){this.className=e,this.left=a,this.top=l,this.width=u,this.height=p}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,a){return a.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,a,l){if(l.empty){let u=e.coordsAtPos(l.head,l.assoc||1);if(!u)return[];let p=getBase(e);return[new RectangleMarker(a,u.left-p.left,u.top-p.top,null,u.bottom-u.top)]}else return rectanglesForRange(e,a,l)}}function getBase(o){let e=o.scrollDOM.getBoundingClientRect();return{left:(o.textDirection==Direction.LTR?e.left:e.right-o.scrollDOM.clientWidth*o.scaleX)-o.scrollDOM.scrollLeft*o.scaleX,top:e.top-o.scrollDOM.scrollTop*o.scaleY}}function wrappedLine(o,e,a,l){let u=o.coordsAtPos(e,a*2);if(!u)return l;let p=o.dom.getBoundingClientRect(),d=(u.top+u.bottom)/2,f=o.posAtCoords({x:p.left+1,y:d}),g=o.posAtCoords({x:p.right-1,y:d});return f==null||g==null?l:{from:Math.max(l.from,Math.min(f,g)),to:Math.min(l.to,Math.max(f,g))}}function rectanglesForRange(o,e,a){if(a.to<=o.viewport.from||a.from>=o.viewport.to)return[];let l=Math.max(a.from,o.viewport.from),u=Math.min(a.to,o.viewport.to),p=o.textDirection==Direction.LTR,d=o.contentDOM,f=d.getBoundingClientRect(),g=getBase(o),b=d.querySelector(".cm-line"),A=b&&window.getComputedStyle(b),S=f.left+(A?parseInt(A.paddingLeft)+Math.min(0,parseInt(A.textIndent)):0),M=f.right-(A?parseInt(A.paddingRight):0),E=blockAt(o,l,1),F=blockAt(o,u,-1),$=E.type==BlockType.Text?E:null,Z=F.type==BlockType.Text?F:null;if($&&(o.lineWrapping||E.widgetLineBreaks)&&($=wrappedLine(o,l,1,$)),Z&&(o.lineWrapping||F.widgetLineBreaks)&&(Z=wrappedLine(o,u,-1,Z)),$&&Z&&$.from==Z.from&&$.to==Z.to)return K(se(a.from,a.to,$));{let U=$?se(a.from,null,$):z(E,!1),ee=Z?se(null,a.to,Z):z(F,!0),ae=[];return($||E).to<(Z||F).from-($&&Z?1:0)||E.widgetLineBreaks>1&&U.bottom+o.defaultLineHeight/2<ee.top?ae.push(V(S,U.bottom,M,ee.top)):U.bottom<ee.top&&o.elementAtHeight((U.bottom+ee.top)/2).type==BlockType.Text&&(U.bottom=ee.top=(U.bottom+ee.top)/2),K(U).concat(ae).concat(K(ee))}function V(U,ee,ae,de){return new RectangleMarker(e,U-g.left,ee-g.top,ae-U,de-ee)}function K({top:U,bottom:ee,horizontal:ae}){let de=[];for(let ke=0;ke<ae.length;ke+=2)de.push(V(ae[ke],U,ae[ke+1],ee));return de}function se(U,ee,ae){let de=1e9,ke=-1e9,Oe=[];function De(We,qe,at,yt,ut){let Dt=o.coordsAtPos(We,We==ae.to?-2:2),$t=o.coordsAtPos(at,at==ae.from?2:-2);!Dt||!$t||(de=Math.min(Dt.top,$t.top,de),ke=Math.max(Dt.bottom,$t.bottom,ke),ut==Direction.LTR?Oe.push(p&&qe?S:Dt.left,p&&yt?M:$t.right):Oe.push(!p&&yt?S:$t.left,!p&&qe?M:Dt.right))}let Ae=U??ae.from,Pe=ee??ae.to;for(let We of o.visibleRanges)if(We.to>Ae&&We.from<Pe)for(let qe=Math.max(We.from,Ae),at=Math.min(We.to,Pe);;){let yt=o.state.doc.lineAt(qe);for(let ut of o.bidiSpans(yt)){let Dt=ut.from+yt.from,$t=ut.to+yt.from;if(Dt>=at)break;$t>qe&&De(Math.max(Dt,qe),U==null&&Dt<=Ae,Math.min($t,at),ee==null&&$t>=Pe,ut.dir)}if(qe=yt.to+1,qe>=at)break}return Oe.length==0&&De(Ae,U==null,Pe,ee==null,o.textDirection),{top:de,bottom:ke,horizontal:Oe}}function z(U,ee){let ae=f.top+(ee?U.top:U.bottom);return{top:ae,bottom:ae,horizontal:[]}}}function sameMarker(o,e){return o.constructor==e.constructor&&o.eq(e)}class LayerView{constructor(e,a){this.view=e,this.layer=a,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),a.above&&this.dom.classList.add("cm-layer-above"),a.class&&this.dom.classList.add(a.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),a.mount&&a.mount(this.dom,e)}update(e){e.startState.facet(layerOrder)!=e.state.facet(layerOrder)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let a=0,l=e.facet(layerOrder);for(;a<l.length&&l[a]!=this.layer;)a++;this.dom.style.zIndex=String((this.layer.above?150:-1)-a)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:a}=this.view;(e!=this.scaleX||a!=this.scaleY)&&(this.scaleX=e,this.scaleY=a,this.dom.style.transform=`scale(${1/e}, ${1/a})`)}draw(e){if(e.length!=this.drawn.length||e.some((a,l)=>!sameMarker(a,this.drawn[l]))){let a=this.dom.firstChild,l=0;for(let u of e)u.update&&a&&u.constructor&&this.drawn[l].constructor&&u.update(a,this.drawn[l])?(a=a.nextSibling,l++):this.dom.insertBefore(u.draw(),a);for(;a;){let u=a.nextSibling;a.remove(),a=u}this.drawn=e,browser.safari&&browser.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(o){return[ViewPlugin.define(e=>new LayerView(e,o)),layerOrder.of(o)]}const selectionConfig=Facet.define({combine(o){return combineConfig(o,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,a)=>Math.min(e,a),drawRangeCursor:(e,a)=>e||a})}});function drawSelection(o={}){return[selectionConfig.of(o),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(o){return o.startState.facet(selectionConfig)!=o.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(o){let{state:e}=o,a=e.facet(selectionConfig),l=[];for(let u of e.selection.ranges){let p=u==e.selection.main;if(u.empty||a.drawRangeCursor){let d=p?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",f=u.empty?u:EditorSelection.cursor(u.head,u.head>u.anchor?-1:1);for(let g of RectangleMarker.forRange(o,d,f))l.push(g)}}return l},update(o,e){o.transactions.some(l=>l.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let a=configChanged(o);return a&&setBlinkRate(o.state,e),o.docChanged||o.selectionSet||a},mount(o,e){setBlinkRate(e.state,o)},class:"cm-cursorLayer"});function setBlinkRate(o,e){e.style.animationDuration=o.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers(o){return o.state.selection.ranges.map(e=>e.empty?[]:RectangleMarker.forRange(o,"cm-selectionBackground",e)).reduce((e,a)=>e.concat(a))},update(o,e){return o.docChanged||o.selectionSet||o.viewportChanged||configChanged(o)},class:"cm-selectionLayer"}),hideNativeSelection=Prec.highest(EditorView.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),setDropCursorPos=StateEffect.define({map(o,e){return o==null?null:e.mapPos(o)}}),dropCursorPos=StateField.define({create(){return null},update(o,e){return o!=null&&(o=e.changes.mapPos(o)),e.effects.reduce((a,l)=>l.is(setDropCursorPos)?l.value:a,o)}}),drawDropCursor=ViewPlugin.fromClass(class{constructor(o){this.view=o,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(o){var e;let a=o.state.field(dropCursorPos);a==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(o.startState.field(dropCursorPos)!=a||o.docChanged||o.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:o}=this,e=o.state.field(dropCursorPos),a=e!=null&&o.coordsAtPos(e);if(!a)return null;let l=o.scrollDOM.getBoundingClientRect();return{left:a.left-l.left+o.scrollDOM.scrollLeft*o.scaleX,top:a.top-l.top+o.scrollDOM.scrollTop*o.scaleY,height:a.bottom-a.top}}drawCursor(o){if(this.cursor){let{scaleX:e,scaleY:a}=this.view;o?(this.cursor.style.left=o.left/e+"px",this.cursor.style.top=o.top/a+"px",this.cursor.style.height=o.height/a+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(o){this.view.state.field(dropCursorPos)!=o&&this.view.dispatch({effects:setDropCursorPos.of(o)})}},{eventObservers:{dragover(o){this.setDropPos(this.view.posAtCoords({x:o.clientX,y:o.clientY}))},dragleave(o){(o.target==this.view.contentDOM||!this.view.contentDOM.contains(o.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dropCursor(){return[dropCursorPos,drawDropCursor]}const MaxOff=2e3;function rectangleFor(o,e,a){let l=Math.min(e.line,a.line),u=Math.max(e.line,a.line),p=[];if(e.off>MaxOff||a.off>MaxOff||e.col<0||a.col<0){let d=Math.min(e.off,a.off),f=Math.max(e.off,a.off);for(let g=l;g<=u;g++){let b=o.doc.line(g);b.length<=f&&p.push(EditorSelection.range(b.from+d,b.to+f))}}else{let d=Math.min(e.col,a.col),f=Math.max(e.col,a.col);for(let g=l;g<=u;g++){let b=o.doc.line(g),A=findColumn(b.text,d,o.tabSize,!0);if(A<0)p.push(EditorSelection.cursor(b.to));else{let S=findColumn(b.text,f,o.tabSize);p.push(EditorSelection.range(b.from+A,b.from+S))}}}return p}function absoluteColumn(o,e){let a=o.coordsAtPos(o.viewport.from);return a?Math.round(Math.abs((a.left-e)/o.defaultCharacterWidth)):-1}function getPos(o,e){let a=o.posAtCoords({x:e.clientX,y:e.clientY},!1),l=o.state.doc.lineAt(a),u=a-l.from,p=u>MaxOff?-1:u==l.length?absoluteColumn(o,e.clientX):countColumn(l.text,o.state.tabSize,a-l.from);return{line:l.number,col:p,off:u}}function rectangleSelectionStyle(o,e){let a=getPos(o,e),l=o.state.selection;return a?{update(u){if(u.docChanged){let p=u.changes.mapPos(u.startState.doc.line(a.line).from),d=u.state.doc.lineAt(p);a={line:d.number,col:a.col,off:Math.min(a.off,d.length)},l=l.map(u.changes)}},get(u,p,d){let f=getPos(o,u);if(!f)return l;let g=rectangleFor(o.state,a,f);return g.length?d?EditorSelection.create(g.concat(l.ranges)):EditorSelection.create(g):l}}:null}function rectangularSelection(o){let e=(a=>a.altKey&&a.button==0);return EditorView.mouseSelectionStyle.of((a,l)=>e(l)?rectangleSelectionStyle(a,l):null)}const keys$2={Alt:[18,o=>!!o.altKey],Control:[17,o=>!!o.ctrlKey],Shift:[16,o=>!!o.shiftKey],Meta:[91,o=>!!o.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(o={}){let[e,a]=keys$2[o.key||"Alt"],l=ViewPlugin.fromClass(class{constructor(u){this.view=u,this.isDown=!1}set(u){this.isDown!=u&&(this.isDown=u,this.view.update([]))}},{eventObservers:{keydown(u){this.set(u.keyCode==e||a(u))},keyup(u){(u.keyCode==e||!a(u))&&this.set(!1)},mousemove(u){this.set(a(u))}}});return[l,EditorView.contentAttributes.of(u=>{var p;return!((p=u.plugin(l))===null||p===void 0)&&p.isDown?showCrosshair:null})]}const Outside="-10000px";class TooltipViewManager{constructor(e,a,l,u){this.facet=a,this.createTooltipView=l,this.removeTooltipView=u,this.input=e.state.facet(a),this.tooltips=this.input.filter(d=>d);let p=null;this.tooltipViews=this.tooltips.map(d=>p=l(d,p))}update(e,a){var l;let u=e.state.facet(this.facet),p=u.filter(g=>g);if(u===this.input){for(let g of this.tooltipViews)g.update&&g.update(e);return!1}let d=[],f=a?[]:null;for(let g=0;g<p.length;g++){let b=p[g],A=-1;if(b){for(let S=0;S<this.tooltips.length;S++){let M=this.tooltips[S];M&&M.create==b.create&&(A=S)}if(A<0)d[g]=this.createTooltipView(b,g?d[g-1]:null),f&&(f[g]=!!b.above);else{let S=d[g]=this.tooltipViews[A];f&&(f[g]=a[A]),S.update&&S.update(e)}}}for(let g of this.tooltipViews)d.indexOf(g)<0&&(this.removeTooltipView(g),(l=g.destroy)===null||l===void 0||l.call(g));return a&&(f.forEach((g,b)=>a[b]=g),a.length=f.length),this.input=u,this.tooltips=p,this.tooltipViews=d,!0}}function windowSpace(o){let e=o.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const tooltipConfig=Facet.define({combine:o=>{var e,a,l;return{position:browser.ios?"absolute":((e=o.find(u=>u.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((a=o.find(u=>u.parent))===null||a===void 0?void 0:a.parent)||null,tooltipSpace:((l=o.find(u=>u.tooltipSpace))===null||l===void 0?void 0:l.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(o){this.view=o,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=o.state.facet(tooltipConfig);this.position=e.position,this.parent=e.parent,this.classes=o.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new TooltipViewManager(o,showTooltip,(a,l)=>this.createTooltip(a,l),a=>{this.resizeObserver&&this.resizeObserver.unobserve(a.dom),a.dom.remove()}),this.above=this.manager.tooltips.map(a=>!!a.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(a=>{Date.now()>this.lastTransaction-50&&a.length>0&&a[a.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),o.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let o of this.manager.tooltipViews)this.intersectionObserver.observe(o.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(o){o.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(o,this.above);e&&this.observeIntersection();let a=e||o.geometryChanged,l=o.state.facet(tooltipConfig);if(l.position!=this.position&&!this.madeAbsolute){this.position=l.position;for(let u of this.manager.tooltipViews)u.dom.style.position=this.position;a=!0}if(l.parent!=this.parent){this.parent&&this.container.remove(),this.parent=l.parent,this.createContainer();for(let u of this.manager.tooltipViews)this.container.appendChild(u.dom);a=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);a&&this.maybeMeasure()}createTooltip(o,e){let a=o.create(this.view),l=e?e.dom:null;if(a.dom.classList.add("cm-tooltip"),o.arrow&&!a.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let u=document.createElement("div");u.className="cm-tooltip-arrow",a.dom.appendChild(u)}return a.dom.style.position=this.position,a.dom.style.top=Outside,a.dom.style.left="0px",this.container.insertBefore(a.dom,l),a.mount&&a.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(a.dom),a}destroy(){var o,e,a;this.view.win.removeEventListener("resize",this.measureSoon);for(let l of this.manager.tooltipViews)l.dom.remove(),(o=l.destroy)===null||o===void 0||o.call(l);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(a=this.intersectionObserver)===null||a===void 0||a.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let o=1,e=1,a=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:p}=this.manager.tooltipViews[0];if(browser.safari){let d=p.getBoundingClientRect();a=Math.abs(d.top+1e4)>1||Math.abs(d.left)>1}else a=!!p.offsetParent&&p.offsetParent!=this.container.ownerDocument.body}if(a||this.position=="absolute")if(this.parent){let p=this.parent.getBoundingClientRect();p.width&&p.height&&(o=p.width/this.parent.offsetWidth,e=p.height/this.parent.offsetHeight)}else({scaleX:o,scaleY:e}=this.view.viewState);let l=this.view.scrollDOM.getBoundingClientRect(),u=getScrollMargins(this.view);return{visible:{left:l.left+u.left,top:l.top+u.top,right:l.right-u.right,bottom:l.bottom-u.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((p,d)=>{let f=this.manager.tooltipViews[d];return f.getCoords?f.getCoords(p.pos):this.view.coordsAtPos(p.pos)}),size:this.manager.tooltipViews.map(({dom:p})=>p.getBoundingClientRect()),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:o,scaleY:e,makeAbsolute:a}}writeMeasure(o){var e;if(o.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let f of this.manager.tooltipViews)f.dom.style.position="absolute"}let{visible:a,space:l,scaleX:u,scaleY:p}=o,d=[];for(let f=0;f<this.manager.tooltips.length;f++){let g=this.manager.tooltips[f],b=this.manager.tooltipViews[f],{dom:A}=b,S=o.pos[f],M=o.size[f];if(!S||g.clip!==!1&&(S.bottom<=Math.max(a.top,l.top)||S.top>=Math.min(a.bottom,l.bottom)||S.right<Math.max(a.left,l.left)-.1||S.left>Math.min(a.right,l.right)+.1)){A.style.top=Outside;continue}let E=g.arrow?b.dom.querySelector(".cm-tooltip-arrow"):null,F=E?7:0,$=M.right-M.left,Z=(e=knownHeight.get(b))!==null&&e!==void 0?e:M.bottom-M.top,V=b.offset||noOffset,K=this.view.textDirection==Direction.LTR,se=M.width>l.right-l.left?K?l.left:l.right-M.width:K?Math.max(l.left,Math.min(S.left-(E?14:0)+V.x,l.right-$)):Math.min(Math.max(l.left,S.left-$+(E?14:0)-V.x),l.right-$),z=this.above[f];!g.strictSide&&(z?S.top-Z-F-V.y<l.top:S.bottom+Z+F+V.y>l.bottom)&&z==l.bottom-S.bottom>S.top-l.top&&(z=this.above[f]=!z);let U=(z?S.top-l.top:l.bottom-S.bottom)-F;if(U<Z&&b.resize!==!1){if(U<this.view.defaultLineHeight){A.style.top=Outside;continue}knownHeight.set(b,Z),A.style.height=(Z=U)/p+"px"}else A.style.height&&(A.style.height="");let ee=z?S.top-Z-F-V.y:S.bottom+F+V.y,ae=se+$;if(b.overlap!==!0)for(let de of d)de.left<ae&&de.right>se&&de.top<ee+Z&&de.bottom>ee&&(ee=z?de.top-Z-2-F:de.bottom+F+2);if(this.position=="absolute"?(A.style.top=(ee-o.parent.top)/p+"px",setLeftStyle(A,(se-o.parent.left)/u)):(A.style.top=ee/p+"px",setLeftStyle(A,se/u)),E){let de=S.left+(K?V.x:-V.x)-(se+14-7);E.style.left=de/u+"px"}b.overlap!==!0&&d.push({left:se,top:ee,right:ae,bottom:ee+Z}),A.classList.toggle("cm-tooltip-above",z),A.classList.toggle("cm-tooltip-below",!z),b.positioned&&b.positioned(o.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let o of this.manager.tooltipViews)o.dom.style.top=Outside}},{eventObservers:{scroll(){this.maybeMeasure()}}});function setLeftStyle(o,e){let a=parseInt(o.style.left,10);(isNaN(a)||Math.abs(e-a)>1)&&(o.style.left=e+"px")}const baseTheme$4=EditorView.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define({combine:o=>o.reduce((e,a)=>e.concat(a),[])});class HoverTooltipHost{static create(e){return new HoverTooltipHost(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(e,showHoverTooltip,(a,l)=>this.createHostedView(a,l),a=>a.dom.remove())}createHostedView(e,a){let l=e.create(this.view);return l.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(l.dom,a?a.dom.nextSibling:this.dom.firstChild),this.mounted&&l.mount&&l.mount(this.view),l}mount(e){for(let a of this.manager.tooltipViews)a.mount&&a.mount(e);this.mounted=!0}positioned(e){for(let a of this.manager.tooltipViews)a.positioned&&a.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let a of this.manager.tooltipViews)(e=a.destroy)===null||e===void 0||e.call(a)}passProp(e){let a;for(let l of this.manager.tooltipViews){let u=l[e];if(u!==void 0){if(a===void 0)a=u;else if(a!==u)return}}return a}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],o=>{let e=o.facet(showHoverTooltip);return e.length===0?null:{pos:Math.min(...e.map(a=>a.pos)),end:Math.max(...e.map(a=>{var l;return(l=a.end)!==null&&l!==void 0?l:a.pos})),create:HoverTooltipHost.create,above:e[0].above,arrow:e.some(a=>a.arrow)}});class HoverPlugin{constructor(e,a,l,u,p){this.view=e,this.source=a,this.field=l,this.setHover=u,this.hoverTime=p,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:a}=this,l=e.docView.tile.nearest(a.target);if(!l)return;let u,p=1;if(l.isWidget())u=l.posAtStart;else{if(u=e.posAtCoords(a),u==null)return;let f=e.coordsAtPos(u);if(!f||a.y<f.top||a.y>f.bottom||a.x<f.left-e.defaultCharacterWidth||a.x>f.right+e.defaultCharacterWidth)return;let g=e.bidiSpans(e.state.doc.lineAt(u)).find(A=>A.from<=u&&A.to>=u),b=g&&g.dir==Direction.RTL?-1:1;p=a.x<f.left?-b:b}let d=this.source(e,u,p);if(d?.then){let f=this.pending={pos:u};d.then(g=>{this.pending==f&&(this.pending=null,g&&!(Array.isArray(g)&&!g.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(g)?g:[g])}))},g=>logException(e.state,g,"hover tooltip"))}else d&&!(Array.isArray(d)&&!d.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(d)?d:[d])})}get tooltip(){let e=this.view.plugin(tooltipPlugin),a=e?e.manager.tooltips.findIndex(l=>l.create==HoverTooltipHost.create):-1;return a>-1?e.manager.tooltipViews[a]:null}mousemove(e){var a,l;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:u,tooltip:p}=this;if(u.length&&p&&!isInTooltip(p.dom,e)||this.pending){let{pos:d}=u[0]||this.pending,f=(l=(a=u[0])===null||a===void 0?void 0:a.end)!==null&&l!==void 0?l:d;(d==f?this.view.posAtCoords(this.lastMove)!=d:!isOverRange(this.view,d,f,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:a}=this;if(a.length){let{tooltip:l}=this;l&&l.dom.contains(e.relatedTarget)?this.watchTooltipLeave(l.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let a=l=>{e.removeEventListener("mouseleave",a),this.active.length&&!this.view.dom.contains(l.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",a)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const tooltipMargin=4;function isInTooltip(o,e){let{left:a,right:l,top:u,bottom:p}=o.getBoundingClientRect(),d;if(d=o.querySelector(".cm-tooltip-arrow")){let f=d.getBoundingClientRect();u=Math.min(f.top,u),p=Math.max(f.bottom,p)}return e.clientX>=a-tooltipMargin&&e.clientX<=l+tooltipMargin&&e.clientY>=u-tooltipMargin&&e.clientY<=p+tooltipMargin}function isOverRange(o,e,a,l,u,p){let d=o.scrollDOM.getBoundingClientRect(),f=o.documentTop+o.documentPadding.top+o.contentHeight;if(d.left>l||d.right<l||d.top>u||Math.min(d.bottom,f)<u)return!1;let g=o.posAtCoords({x:l,y:u},!1);return g>=e&&g<=a}function hoverTooltip(o,e={}){let a=StateEffect.define(),l=StateField.define({create(){return[]},update(u,p){if(u.length&&(e.hideOnChange&&(p.docChanged||p.selection)?u=[]:e.hideOn&&(u=u.filter(d=>!e.hideOn(p,d))),p.docChanged)){let d=[];for(let f of u){let g=p.changes.mapPos(f.pos,-1,MapMode.TrackDel);if(g!=null){let b=Object.assign(Object.create(null),f);b.pos=g,b.end!=null&&(b.end=p.changes.mapPos(b.end)),d.push(b)}}u=d}for(let d of p.effects)d.is(a)&&(u=d.value),d.is(closeHoverTooltipEffect)&&(u=[]);return u},provide:u=>showHoverTooltip.from(u)});return{active:l,extension:[l,ViewPlugin.define(u=>new HoverPlugin(u,o,l,a,e.hoverTime||300)),showHoverTooltipHost]}}function getTooltip(o,e){let a=o.plugin(tooltipPlugin);if(!a)return null;let l=a.manager.tooltips.indexOf(e);return l<0?null:a.manager.tooltipViews[l]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(o){let e,a;for(let l of o)e=e||l.topContainer,a=a||l.bottomContainer;return{topContainer:e,bottomContainer:a}}});function getPanel(o,e){let a=o.plugin(panelPlugin),l=a?a.specs.indexOf(e):-1;return l>-1?a.panels[l]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(o){this.input=o.state.facet(showPanel),this.specs=this.input.filter(a=>a),this.panels=this.specs.map(a=>a(o));let e=o.state.facet(panelConfig);this.top=new PanelGroup(o,!0,e.topContainer),this.bottom=new PanelGroup(o,!1,e.bottomContainer),this.top.sync(this.panels.filter(a=>a.top)),this.bottom.sync(this.panels.filter(a=>!a.top));for(let a of this.panels)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}update(o){let e=o.state.facet(panelConfig);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new PanelGroup(o.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(o.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let a=o.state.facet(showPanel);if(a!=this.input){let l=a.filter(g=>g),u=[],p=[],d=[],f=[];for(let g of l){let b=this.specs.indexOf(g),A;b<0?(A=g(o.view),f.push(A)):(A=this.panels[b],A.update&&A.update(o)),u.push(A),(A.top?p:d).push(A)}this.specs=l,this.panels=u,this.top.sync(p),this.bottom.sync(d);for(let g of f)g.dom.classList.add("cm-panel"),g.mount&&g.mount()}else for(let l of this.panels)l.update&&l.update(o)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:o=>EditorView.scrollMargins.of(e=>{let a=e.plugin(o);return a&&{top:a.top.scrollMargin(),bottom:a.bottom.scrollMargin()}})});class PanelGroup{constructor(e,a,l){this.view=e,this.top=a,this.container=l,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let a of this.panels)a.destroy&&e.indexOf(a)<0&&a.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let a=this.container||this.view.dom;a.insertBefore(this.dom,this.top?a.firstChild:null)}let e=this.dom.firstChild;for(let a of this.panels)if(a.dom.parentNode==this.dom){for(;e!=a.dom;)e=rm(e);e=e.nextSibling}else this.dom.insertBefore(a.dom,e);for(;e;)e=rm(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function rm(o){let e=o.nextSibling;return o.remove(),e}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}GutterMarker.prototype.elementClass="",GutterMarker.prototype.toDOM=void 0,GutterMarker.prototype.mapMode=MapMode.TrackBefore,GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1,GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),gutterWidgetClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},activeGutters=Facet.define();function gutter(o){return[gutters(),activeGutters.of({...defaults$1,...o})]}const unfixGutters=Facet.define({combine:o=>o.some(e=>e)});function gutters(o){return[gutterView]}const gutterView=ViewPlugin.fromClass(class{constructor(o){this.view=o,this.domAfter=null,this.prevViewport=o.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=o.state.facet(activeGutters).map(e=>new SingleGutterView(o,e)),this.fixed=!o.state.facet(unfixGutters);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),o.scrollDOM.insertBefore(this.dom,o.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(o){if(this.updateGutters(o)){let e=this.prevViewport,a=o.view.viewport,l=Math.min(e.to,a.to)-Math.max(e.from,a.from);this.syncGutters(l<(a.to-a.from)*.8)}if(o.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=o.view.viewport}syncGutters(o){let e=this.dom.nextSibling;o&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let a=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),l=[],u=this.gutters.map(p=>new UpdateContext(p,this.view.viewport,-this.view.documentPadding.top));for(let p of this.view.viewportLineBlocks)if(l.length&&(l=[]),Array.isArray(p.type)){let d=!0;for(let f of p.type)if(f.type==BlockType.Text&&d){advanceCursor(a,l,f.from);for(let g of u)g.line(this.view,f,l);d=!1}else if(f.widget)for(let g of u)g.widget(this.view,f)}else if(p.type==BlockType.Text){advanceCursor(a,l,p.from);for(let d of u)d.line(this.view,p,l)}else if(p.widget)for(let d of u)d.widget(this.view,p);for(let p of u)p.finish();o&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(o){let e=o.startState.facet(activeGutters),a=o.state.facet(activeGutters),l=o.docChanged||o.heightChanged||o.viewportChanged||!RangeSet.eq(o.startState.facet(gutterLineClass),o.state.facet(gutterLineClass),o.view.viewport.from,o.view.viewport.to);if(e==a)for(let u of this.gutters)u.update(o)&&(l=!0);else{l=!0;let u=[];for(let p of a){let d=e.indexOf(p);d<0?u.push(new SingleGutterView(this.view,p)):(this.gutters[d].update(o),u.push(this.gutters[d]))}for(let p of this.gutters)p.dom.remove(),u.indexOf(p)<0&&p.destroy();for(let p of u)p.config.side=="after"?this.getDOMAfter().appendChild(p.dom):this.dom.appendChild(p.dom);this.gutters=u}return l}destroy(){for(let o of this.gutters)o.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:o=>EditorView.scrollMargins.of(e=>{let a=e.plugin(o);if(!a||a.gutters.length==0||!a.fixed)return null;let l=a.dom.offsetWidth*e.scaleX,u=a.domAfter?a.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Direction.LTR?{left:l,right:u}:{right:l,left:u}})});function asArray(o){return Array.isArray(o)?o:[o]}function advanceCursor(o,e,a){for(;o.value&&o.from<=a;)o.from==a&&e.push(o.value),o.next()}class UpdateContext{constructor(e,a,l){this.gutter=e,this.height=l,this.i=0,this.cursor=RangeSet.iter(e.markers,a.from)}addElement(e,a,l){let{gutter:u}=this,p=(a.top-this.height)/e.scaleY,d=a.height/e.scaleY;if(this.i==u.elements.length){let f=new GutterElement(e,d,p,l);u.elements.push(f),u.dom.appendChild(f.dom)}else u.elements[this.i].update(e,d,p,l);this.height=a.bottom,this.i++}line(e,a,l){let u=[];advanceCursor(this.cursor,u,a.from),l.length&&(u=u.concat(l));let p=this.gutter.config.lineMarker(e,a,u);p&&u.unshift(p);let d=this.gutter;u.length==0&&!d.config.renderEmptyElements||this.addElement(e,a,u)}widget(e,a){let l=this.gutter.config.widgetMarker(e,a.widget,a),u=l?[l]:null;for(let p of e.state.facet(gutterWidgetClass)){let d=p(e,a.widget,a);d&&(u||(u=[])).push(d)}u&&this.addElement(e,a,u)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let a=e.elements.pop();e.dom.removeChild(a.dom),a.destroy()}}}class SingleGutterView{constructor(e,a){this.view=e,this.config=a,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let l in a.domEventHandlers)this.dom.addEventListener(l,u=>{let p=u.target,d;if(p!=this.dom&&this.dom.contains(p)){for(;p.parentNode!=this.dom;)p=p.parentNode;let g=p.getBoundingClientRect();d=(g.top+g.bottom)/2}else d=u.clientY;let f=e.lineBlockAtHeight(d-e.documentTop);a.domEventHandlers[l](e,f,u)&&u.preventDefault()});this.markers=asArray(a.markers(e)),a.initialSpacer&&(this.spacer=new GutterElement(e,0,0,[a.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let a=this.markers;if(this.markers=asArray(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let u=this.config.updateSpacer(this.spacer.markers[0],e);u!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[u])}let l=e.view.viewport;return!RangeSet.eq(this.markers,a,l.from,l.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class GutterElement{constructor(e,a,l,u){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,a,l,u)}update(e,a,l,u){this.height!=a&&(this.height=a,this.dom.style.height=a+"px"),this.above!=l&&(this.dom.style.marginTop=(this.above=l)?l+"px":""),sameMarkers(this.markers,u)||this.setMarkers(e,u)}setMarkers(e,a){let l="cm-gutterElement",u=this.dom.firstChild;for(let p=0,d=0;;){let f=d,g=p<a.length?a[p++]:null,b=!1;if(g){let A=g.elementClass;A&&(l+=" "+A);for(let S=d;S<this.markers.length;S++)if(this.markers[S].compare(g)){f=S,b=!0;break}}else f=this.markers.length;for(;d<f;){let A=this.markers[d++];if(A.toDOM){A.destroy(u);let S=u.nextSibling;u.remove(),u=S}}if(!g)break;g.toDOM&&(b?u=u.nextSibling:this.dom.insertBefore(g.toDOM(e),u)),b&&d++}this.dom.className=l,this.markers=a}destroy(){this.setMarkers(null,[])}}function sameMarkers(o,e){if(o.length!=e.length)return!1;for(let a=0;a<o.length;a++)if(!o[a].compare(e[a]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberWidgetMarker=Facet.define(),lineNumberConfig=Facet.define({combine(o){return combineConfig(o,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,a){let l=Object.assign({},e);for(let u in a){let p=l[u],d=a[u];l[u]=p?(f,g,b)=>p(f,g,b)||d(f,g,b):d}return l}})}});class NumberMarker extends GutterMarker{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(o,e){return o.state.facet(lineNumberConfig).formatNumber(e,o.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],o=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lineNumberMarkers)},lineMarker(e,a,l){return l.some(u=>u.toDOM)?null:new NumberMarker(formatNumber(e,e.state.doc.lineAt(a.from).number))},widgetMarker:(e,a,l)=>{for(let u of e.state.facet(lineNumberWidgetMarker)){let p=u(e,a,l);if(p)return p}return null},lineMarkerChange:e=>e.startState.facet(lineNumberConfig)!=e.state.facet(lineNumberConfig),initialSpacer(e){return new NumberMarker(formatNumber(e,maxLineNumber(e.state.doc.lines)))},updateSpacer(e,a){let l=formatNumber(a.view,maxLineNumber(a.view.state.doc.lines));return l==e.number?e:new NumberMarker(l)},domEventHandlers:o.facet(lineNumberConfig).domEventHandlers,side:"before"}));function lineNumbers(o={}){return[lineNumberConfig.of(o),gutters(),lineNumberGutter]}function maxLineNumber(o){let e=9;for(;e<o;)e=e*10+9;return e}const activeLineGutterMarker=new class extends GutterMarker{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass.compute(["selection"],o=>{let e=[],a=-1;for(let l of o.selection.ranges){let u=o.doc.lineAt(l.head).from;u>a&&(a=u,e.push(activeLineGutterMarker.range(u)))}return RangeSet.of(e)});function highlightActiveLineGutter(){return activeLineGutterHighlighter}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(e,a){this.from=e,this.to=a}}class NodeProp{constructor(e={}){this.id=nextPropID++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=NodeType.match(e)),a=>{let l=e(a);return l===void 0?null:[this,l]}}}NodeProp.closedBy=new NodeProp({deserialize:o=>o.split(" ")}),NodeProp.openedBy=new NodeProp({deserialize:o=>o.split(" ")}),NodeProp.group=new NodeProp({deserialize:o=>o.split(" ")}),NodeProp.isolate=new NodeProp({deserialize:o=>{if(o&&o!="rtl"&&o!="ltr"&&o!="auto")throw new RangeError("Invalid value for isolate: "+o);return o||"auto"}}),NodeProp.contextHash=new NodeProp({perNode:!0}),NodeProp.lookAhead=new NodeProp({perNode:!0}),NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(e,a,l){this.tree=e,this.overlay=a,this.parser=l}static get(e){return e&&e.props&&e.props[NodeProp.mounted.id]}}const noProps=Object.create(null);class NodeType{constructor(e,a,l,u=0){this.name=e,this.props=a,this.id=l,this.flags=u}static define(e){let a=e.props&&e.props.length?Object.create(null):noProps,l=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),u=new NodeType(e.name||"",a,e.id,l);if(e.props){for(let p of e.props)if(Array.isArray(p)||(p=p(u)),p){if(p[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");a[p[0].id]=p[1]}}return u}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let a=this.prop(NodeProp.group);return a?a.indexOf(e)>-1:!1}return this.id==e}static match(e){let a=Object.create(null);for(let l in e)for(let u of l.split(" "))a[u]=e[l];return l=>{for(let u=l.prop(NodeProp.group),p=-1;p<(u?u.length:0);p++){let d=a[p<0?l.name:u[p]];if(d)return d}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(e){this.types=e;for(let a=0;a<e.length;a++)if(e[a].id!=a)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let a=[];for(let l of this.types){let u=null;for(let p of e){let d=p(l);if(d){u||(u=Object.assign({},l.props));let f=d[1],g=d[0];g.combine&&g.id in u&&(f=g.combine(u[g.id],f)),u[g.id]=f}}a.push(u?new NodeType(l.name,u,l.id,l.flags):l)}return new NodeSet(a)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(o){o[o.ExcludeBuffers=1]="ExcludeBuffers",o[o.IncludeAnonymous=2]="IncludeAnonymous",o[o.IgnoreMounts=4]="IgnoreMounts",o[o.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));class Tree{constructor(e,a,l,u,p){if(this.type=e,this.children=a,this.positions=l,this.length=u,this.props=null,p&&p.length){this.props=Object.create(null);for(let[d,f]of p)this.props[typeof d=="number"?d:d.id]=f}}toString(){let e=MountedTree.get(this);if(e&&!e.overlay)return e.tree.toString();let a="";for(let l of this.children){let u=l.toString();u&&(a&&(a+=","),a+=u)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(a.length?"("+a+")":""):a}cursor(e=0){return new TreeCursor(this.topNode,e)}cursorAt(e,a=0,l=0){let u=CachedNode.get(this)||this.topNode,p=new TreeCursor(u);return p.moveTo(e,a),CachedNode.set(this,p._tree),p}get topNode(){return new TreeNode(this,0,0,null)}resolve(e,a=0){let l=resolveNode(CachedNode.get(this)||this.topNode,e,a,!1);return CachedNode.set(this,l),l}resolveInner(e,a=0){let l=resolveNode(CachedInnerNode.get(this)||this.topNode,e,a,!0);return CachedInnerNode.set(this,l),l}resolveStack(e,a=0){return stackIterator(this,e,a)}iterate(e){let{enter:a,leave:l,from:u=0,to:p=this.length}=e,d=e.mode||0,f=(d&IterMode.IncludeAnonymous)>0;for(let g=this.cursor(d|IterMode.IncludeAnonymous);;){let b=!1;if(g.from<=p&&g.to>=u&&(!f&&g.type.isAnonymous||a(g)!==!1)){if(g.firstChild())continue;b=!0}for(;b&&l&&(f||!g.type.isAnonymous)&&l(g),!g.nextSibling();){if(!g.parent())return;b=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let a in this.props)e.push([+a,this.props[a]]);return e}balance(e={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(a,l,u)=>new Tree(this.type,a,l,u,this.propValues),e.makeTree||((a,l,u)=>new Tree(NodeType.none,a,l,u)))}static build(e){return buildTree(e)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(e,a){this.buffer=e,this.index=a}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(e,a,l){this.buffer=e,this.length=a,this.set=l}get type(){return NodeType.none}toString(){let e=[];for(let a=0;a<this.buffer.length;)e.push(this.childString(a)),a=this.buffer[a+3];return e.join(",")}childString(e){let a=this.buffer[e],l=this.buffer[e+3],u=this.set.types[a],p=u.name;if(/\W/.test(p)&&!u.isError&&(p=JSON.stringify(p)),e+=4,l==e)return p;let d=[];for(;e<l;)d.push(this.childString(e)),e=this.buffer[e+3];return p+"("+d.join(",")+")"}findChild(e,a,l,u,p){let{buffer:d}=this,f=-1;for(let g=e;g!=a&&!(checkSide(p,u,d[g+1],d[g+2])&&(f=g,l>0));g=d[g+3]);return f}slice(e,a,l){let u=this.buffer,p=new Uint16Array(a-e),d=0;for(let f=e,g=0;f<a;){p[g++]=u[f++],p[g++]=u[f++]-l;let b=p[g++]=u[f++]-l;p[g++]=u[f++]-e,d=Math.max(d,b)}return new TreeBuffer(p,d,this.set)}}function checkSide(o,e,a,l){switch(o){case-2:return a<e;case-1:return l>=e&&a<e;case 0:return a<e&&l>e;case 1:return a<=e&&l>e;case 2:return l>e;case 4:return!0}}function resolveNode(o,e,a,l){for(var u;o.from==o.to||(a<1?o.from>=e:o.from>e)||(a>-1?o.to<=e:o.to<e);){let d=!l&&o instanceof TreeNode&&o.index<0?null:o.parent;if(!d)return o;o=d}let p=l?0:IterMode.IgnoreOverlays;if(l)for(let d=o,f=d.parent;f;d=f,f=d.parent)d instanceof TreeNode&&d.index<0&&((u=f.enter(e,a,p))===null||u===void 0?void 0:u.from)!=d.from&&(o=f);for(;;){let d=o.enter(e,a,p);if(!d)return o;o=d}}class BaseNode{cursor(e=0){return new TreeCursor(this,e)}getChild(e,a=null,l=null){let u=getChildren(this,e,a,l);return u.length?u[0]:null}getChildren(e,a=null,l=null){return getChildren(this,e,a,l)}resolve(e,a=0){return resolveNode(this,e,a,!1)}resolveInner(e,a=0){return resolveNode(this,e,a,!0)}matchContext(e){return matchNodeContext(this.parent,e)}enterUnfinishedNodesBefore(e){let a=this.childBefore(e),l=this;for(;a;){let u=a.lastChild;if(!u||u.to!=a.to)break;u.type.isError&&u.from==u.to?(l=a,a=u.prevSibling):a=u}return l}get node(){return this}get next(){return this.parent}}class TreeNode extends BaseNode{constructor(e,a,l,u){super(),this._tree=e,this.from=a,this.index=l,this._parent=u}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,a,l,u,p=0){for(let d=this;;){for(let{children:f,positions:g}=d._tree,b=a>0?f.length:-1;e!=b;e+=a){let A=f[e],S=g[e]+d.from;if(checkSide(u,l,S,S+A.length)){if(A instanceof TreeBuffer){if(p&IterMode.ExcludeBuffers)continue;let M=A.findChild(0,A.buffer.length,a,l-S,u);if(M>-1)return new BufferNode(new BufferContext(d,A,e,S),null,M)}else if(p&IterMode.IncludeAnonymous||!A.type.isAnonymous||hasChild(A)){let M;if(!(p&IterMode.IgnoreMounts)&&(M=MountedTree.get(A))&&!M.overlay)return new TreeNode(M.tree,S,e,d);let E=new TreeNode(A,S,e,d);return p&IterMode.IncludeAnonymous||!E.type.isAnonymous?E:E.nextChild(a<0?A.children.length-1:0,a,l,u)}}}if(p&IterMode.IncludeAnonymous||!d.type.isAnonymous||(d.index>=0?e=d.index+a:e=a<0?-1:d._parent._tree.children.length,d=d._parent,!d))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,a,l=0){let u;if(!(l&IterMode.IgnoreOverlays)&&(u=MountedTree.get(this._tree))&&u.overlay){let p=e-this.from;for(let{from:d,to:f}of u.overlay)if((a>0?d<=p:d<p)&&(a<0?f>=p:f>p))return new TreeNode(u.tree,u.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,a,l)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function getChildren(o,e,a,l){let u=o.cursor(),p=[];if(!u.firstChild())return p;if(a!=null){for(let d=!1;!d;)if(d=u.type.is(a),!u.nextSibling())return p}for(;;){if(l!=null&&u.type.is(l))return p;if(u.type.is(e)&&p.push(u.node),!u.nextSibling())return l==null?p:[]}}function matchNodeContext(o,e,a=e.length-1){for(let l=o;a>=0;l=l.parent){if(!l)return!1;if(!l.type.isAnonymous){if(e[a]&&e[a]!=l.name)return!1;a--}}return!0}class BufferContext{constructor(e,a,l,u){this.parent=e,this.buffer=a,this.index=l,this.start=u}}class BufferNode extends BaseNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,a,l){super(),this.context=e,this._parent=a,this.index=l,this.type=e.buffer.set.types[e.buffer.buffer[l]]}child(e,a,l){let{buffer:u}=this.context,p=u.findChild(this.index+4,u.buffer[this.index+3],e,a-this.context.start,l);return p<0?null:new BufferNode(this.context,this,p)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,a,l=0){if(l&IterMode.ExcludeBuffers)return null;let{buffer:u}=this.context,p=u.findChild(this.index+4,u.buffer[this.index+3],a>0?1:-1,e-this.context.start,a);return p<0?null:new BufferNode(this.context,this,p)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,a=e.buffer[this.index+3];return a<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new BufferNode(this.context,this._parent,a):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,a=this._parent?this._parent.index+4:0;return this.index==a?this.externalSibling(-1):new BufferNode(this.context,this._parent,e.findChild(a,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],a=[],{buffer:l}=this.context,u=this.index+4,p=l.buffer[this.index+3];if(p>u){let d=l.buffer[this.index+1];e.push(l.slice(u,p,d)),a.push(0)}return new Tree(this.type,e,a,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iterStack(o){if(!o.length)return null;let e=0,a=o[0];for(let p=1;p<o.length;p++){let d=o[p];(d.from>a.from||d.to<a.to)&&(a=d,e=p)}let l=a instanceof TreeNode&&a.index<0?null:a.parent,u=o.slice();return l?u[e]=l:u.splice(e,1),new StackIterator(u,a)}class StackIterator{constructor(e,a){this.heads=e,this.node=a}get next(){return iterStack(this.heads)}}function stackIterator(o,e,a){let l=o.resolveInner(e,a),u=null;for(let p=l instanceof TreeNode?l:l.context.parent;p;p=p.parent)if(p.index<0){let d=p.parent;(u||(u=[l])).push(d.resolve(e,a)),p=d}else{let d=MountedTree.get(p.tree);if(d&&d.overlay&&d.overlay[0].from<=e&&d.overlay[d.overlay.length-1].to>=e){let f=new TreeNode(d.tree,d.overlay[0].from+p.from,-1,p);(u||(u=[l])).push(resolveNode(f,e,a,!1))}}return u?iterStack(u):l}class TreeCursor{get name(){return this.type.name}constructor(e,a=0){if(this.mode=a,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof TreeNode)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let l=e._parent;l;l=l._parent)this.stack.unshift(l.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,a){this.index=e;let{start:l,buffer:u}=this.buffer;return this.type=a||u.set.types[u.buffer[e]],this.from=l+u.buffer[e+1],this.to=l+u.buffer[e+2],!0}yield(e){return e?e instanceof TreeNode?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,a,l){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,a,l,this.mode));let{buffer:u}=this.buffer,p=u.findChild(this.index+4,u.buffer[this.index+3],e,a-this.buffer.start,l);return p<0?!1:(this.stack.push(this.index),this.yieldBuf(p))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,a,l=this.mode){return this.buffer?l&IterMode.ExcludeBuffers?!1:this.enterChild(1,e,a):this.yield(this._tree.enter(e,a,l))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:a}=this.buffer,l=this.stack.length-1;if(e<0){let u=l<0?0:this.stack[l]+4;if(this.index!=u)return this.yieldBuf(a.findChild(u,this.index,-1,0,4))}else{let u=a.buffer[this.index+3];if(u<(l<0?a.buffer.length:a.buffer[this.stack[l]+3]))return this.yieldBuf(u)}return l<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let a,l,{buffer:u}=this;if(u){if(e>0){if(this.index<u.buffer.buffer.length)return!1}else for(let p=0;p<this.index;p++)if(u.buffer.buffer[p+3]<this.index)return!1;({index:a,parent:l}=u)}else({index:a,_parent:l}=this._tree);for(;l;{index:a,_parent:l}=l)if(a>-1)for(let p=a+e,d=e<0?-1:l._tree.children.length;p!=d;p+=e){let f=l._tree.children[p];if(this.mode&IterMode.IncludeAnonymous||f instanceof TreeBuffer||!f.type.isAnonymous||hasChild(f))return!1}return!0}move(e,a){if(a&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,a=0){for(;(this.from==this.to||(a<1?this.from>=e:this.from>e)||(a>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,a););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,a=null,l=0;if(e&&e.context==this.buffer)e:for(let u=this.index,p=this.stack.length;p>=0;){for(let d=e;d;d=d._parent)if(d.index==u){if(u==this.index)return d;a=d,l=p+1;break e}u=this.stack[--p]}for(let u=l;u<this.stack.length;u++)a=new BufferNode(this.buffer,a,this.stack[u]);return this.bufferNode=new BufferNode(this.buffer,a,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,a){for(let l=0;;){let u=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){l++;continue}this.type.isAnonymous||(u=!0)}for(;;){if(u&&a&&a(this),u=this.type.isAnonymous,!l)return;if(this.nextSibling())break;this.parent(),l--,u=!0}}}matchContext(e){if(!this.buffer)return matchNodeContext(this.node.parent,e);let{buffer:a}=this.buffer,{types:l}=a.set;for(let u=e.length-1,p=this.stack.length-1;u>=0;p--){if(p<0)return matchNodeContext(this._tree,e,u);let d=l[a.buffer[this.stack[p]]];if(!d.isAnonymous){if(e[u]&&e[u]!=d.name)return!1;u--}}return!0}}function hasChild(o){return o.children.some(e=>e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e))}function buildTree(o){var e;let{buffer:a,nodeSet:l,maxBufferLength:u=DefaultBufferLength,reused:p=[],minRepeatType:d=l.types.length}=o,f=Array.isArray(a)?new FlatBufferCursor(a,a.length):a,g=l.types,b=0,A=0;function S(U,ee,ae,de,ke,Oe){let{id:De,start:Ae,end:Pe,size:We}=f,qe=A,at=b;if(We<0)if(f.next(),We==-1){let Bt=p[De];ae.push(Bt),de.push(Ae-U);return}else if(We==-3){b=De;return}else if(We==-4){A=De;return}else throw new RangeError(`Unrecognized record size: ${We}`);let yt=g[De],ut,Dt,$t=Ae-U;if(Pe-Ae<=u&&(Dt=Z(f.pos-ee,ke))){let Bt=new Uint16Array(Dt.size-Dt.skip),$e=f.pos-Dt.size,bt=Bt.length;for(;f.pos>$e;)bt=V(Dt.start,Bt,bt);ut=new TreeBuffer(Bt,Pe-Dt.start,l),$t=Dt.start-U}else{let Bt=f.pos-We;f.next();let $e=[],bt=[],nn=De>=d?De:-1,Zt=0,Rt=Pe;for(;f.pos>Bt;)nn>=0&&f.id==nn&&f.size>=0?(f.end<=Rt-u&&(F($e,bt,Ae,Zt,f.end,Rt,nn,qe,at),Zt=$e.length,Rt=f.end),f.next()):Oe>2500?M(Ae,Bt,$e,bt):S(Ae,Bt,$e,bt,nn,Oe+1);if(nn>=0&&Zt>0&&Zt<$e.length&&F($e,bt,Ae,Zt,Ae,Rt,nn,qe,at),$e.reverse(),bt.reverse(),nn>-1&&Zt>0){let qt=E(yt,at);ut=balanceRange(yt,$e,bt,0,$e.length,0,Pe-Ae,qt,qt)}else ut=$(yt,$e,bt,Pe-Ae,qe-Pe,at)}ae.push(ut),de.push($t)}function M(U,ee,ae,de){let ke=[],Oe=0,De=-1;for(;f.pos>ee;){let{id:Ae,start:Pe,end:We,size:qe}=f;if(qe>4)f.next();else{if(De>-1&&Pe<De)break;De<0&&(De=We-u),ke.push(Ae,Pe,We),Oe++,f.next()}}if(Oe){let Ae=new Uint16Array(Oe*4),Pe=ke[ke.length-2];for(let We=ke.length-3,qe=0;We>=0;We-=3)Ae[qe++]=ke[We],Ae[qe++]=ke[We+1]-Pe,Ae[qe++]=ke[We+2]-Pe,Ae[qe++]=qe;ae.push(new TreeBuffer(Ae,ke[2]-Pe,l)),de.push(Pe-U)}}function E(U,ee){return(ae,de,ke)=>{let Oe=0,De=ae.length-1,Ae,Pe;if(De>=0&&(Ae=ae[De])instanceof Tree){if(!De&&Ae.type==U&&Ae.length==ke)return Ae;(Pe=Ae.prop(NodeProp.lookAhead))&&(Oe=de[De]+Ae.length+Pe)}return $(U,ae,de,ke,Oe,ee)}}function F(U,ee,ae,de,ke,Oe,De,Ae,Pe){let We=[],qe=[];for(;U.length>de;)We.push(U.pop()),qe.push(ee.pop()+ae-ke);U.push($(l.types[De],We,qe,Oe-ke,Ae-Oe,Pe)),ee.push(ke-ae)}function $(U,ee,ae,de,ke,Oe,De){if(Oe){let Ae=[NodeProp.contextHash,Oe];De=De?[Ae].concat(De):[Ae]}if(ke>25){let Ae=[NodeProp.lookAhead,ke];De=De?[Ae].concat(De):[Ae]}return new Tree(U,ee,ae,de,De)}function Z(U,ee){let ae=f.fork(),de=0,ke=0,Oe=0,De=ae.end-u,Ae={size:0,start:0,skip:0};e:for(let Pe=ae.pos-U;ae.pos>Pe;){let We=ae.size;if(ae.id==ee&&We>=0){Ae.size=de,Ae.start=ke,Ae.skip=Oe,Oe+=4,de+=4,ae.next();continue}let qe=ae.pos-We;if(We<0||qe<Pe||ae.start<De)break;let at=ae.id>=d?4:0,yt=ae.start;for(ae.next();ae.pos>qe;){if(ae.size<0)if(ae.size==-3||ae.size==-4)at+=4;else break e;else ae.id>=d&&(at+=4);ae.next()}ke=yt,de+=We,Oe+=at}return(ee<0||de==U)&&(Ae.size=de,Ae.start=ke,Ae.skip=Oe),Ae.size>4?Ae:void 0}function V(U,ee,ae){let{id:de,start:ke,end:Oe,size:De}=f;if(f.next(),De>=0&&de<d){let Ae=ae;if(De>4){let Pe=f.pos-(De-4);for(;f.pos>Pe;)ae=V(U,ee,ae)}ee[--ae]=Ae,ee[--ae]=Oe-U,ee[--ae]=ke-U,ee[--ae]=de}else De==-3?b=de:De==-4&&(A=de);return ae}let K=[],se=[];for(;f.pos>0;)S(o.start||0,o.bufferStart||0,K,se,-1,0);let z=(e=o.length)!==null&&e!==void 0?e:K.length?se[0]+K[0].length:0;return new Tree(g[o.topID],K.reverse(),se.reverse(),z)}const nodeSizeCache=new WeakMap;function nodeSize(o,e){if(!o.isAnonymous||e instanceof TreeBuffer||e.type!=o)return 1;let a=nodeSizeCache.get(e);if(a==null){a=1;for(let l of e.children){if(l.type!=o||!(l instanceof Tree)){a=1;break}a+=nodeSize(o,l)}nodeSizeCache.set(e,a)}return a}function balanceRange(o,e,a,l,u,p,d,f,g){let b=0;for(let F=l;F<u;F++)b+=nodeSize(o,e[F]);let A=Math.ceil(b*1.5/8),S=[],M=[];function E(F,$,Z,V,K){for(let se=Z;se<V;){let z=se,U=$[se],ee=nodeSize(o,F[se]);for(se++;se<V;se++){let ae=nodeSize(o,F[se]);if(ee+ae>=A)break;ee+=ae}if(se==z+1){if(ee>A){let ae=F[z];E(ae.children,ae.positions,0,ae.children.length,$[z]+K);continue}S.push(F[z])}else{let ae=$[se-1]+F[se-1].length-U;S.push(balanceRange(o,F,$,z,se,U,ae,null,g))}M.push(U+K-p)}}return E(e,a,l,u,0),(f||g)(S,M,d)}class NodeWeakMap{constructor(){this.map=new WeakMap}setBuffer(e,a,l){let u=this.map.get(e);u||this.map.set(e,u=new Map),u.set(a,l)}getBuffer(e,a){let l=this.map.get(e);return l&&l.get(a)}set(e,a){e instanceof BufferNode?this.setBuffer(e.context.buffer,e.index,a):e instanceof TreeNode&&this.map.set(e.tree,a)}get(e){return e instanceof BufferNode?this.getBuffer(e.context.buffer,e.index):e instanceof TreeNode?this.map.get(e.tree):void 0}cursorSet(e,a){e.buffer?this.setBuffer(e.buffer.buffer,e.index,a):this.map.set(e.tree,a)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class TreeFragment{constructor(e,a,l,u,p=!1,d=!1){this.from=e,this.to=a,this.tree=l,this.offset=u,this.open=(p?1:0)|(d?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,a=[],l=!1){let u=[new TreeFragment(0,e.length,e,0,!1,l)];for(let p of a)p.to>e.length&&u.push(p);return u}static applyChanges(e,a,l=128){if(!a.length)return e;let u=[],p=1,d=e.length?e[0]:null;for(let f=0,g=0,b=0;;f++){let A=f<a.length?a[f]:null,S=A?A.fromA:1e9;if(S-g>=l)for(;d&&d.from<S;){let M=d;if(g>=M.from||S<=M.to||b){let E=Math.max(M.from,g)-b,F=Math.min(M.to,S)-b;M=E>=F?null:new TreeFragment(E,F,M.tree,M.offset+b,f>0,!!A)}if(M&&u.push(M),d.to>S)break;d=p<e.length?e[p++]:null}if(!A)break;g=A.toA,b=A.toA-A.toB}return u}}let Parser$1=class{startParse(e,a,l){return typeof e=="string"&&(e=new StringInput(e)),l=l?l.length?l.map(u=>new Range(u.from,u.to)):[new Range(0,0)]:[new Range(0,e.length)],this.createParse(e,a||[],l)}parse(e,a,l){let u=this.startParse(e,a,l);for(;;){let p=u.advance();if(p)return p}}};class StringInput{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,a){return this.string.slice(e,a)}}new NodeProp({perNode:!0});let nextTagID=0;class Tag{constructor(e,a,l,u){this.name=e,this.set=a,this.base=l,this.modified=u,this.id=nextTagID++}toString(){let{name:e}=this;for(let a of this.modified)a.name&&(e=`${a.name}(${e})`);return e}static define(e,a){let l=typeof e=="string"?e:"?";if(e instanceof Tag&&(a=e),a?.base)throw new Error("Can not derive from a modified tag");let u=new Tag(l,[],null,[]);if(u.set.push(u),a)for(let p of a.set)u.set.push(p);return u}static defineModifier(e){let a=new Modifier(e);return l=>l.modified.indexOf(a)>-1?l:Modifier.get(l.base||l,l.modified.concat(a).sort((u,p)=>u.id-p.id))}}let nextModifierID=0;class Modifier{constructor(e){this.name=e,this.instances=[],this.id=nextModifierID++}static get(e,a){if(!a.length)return e;let l=a[0].instances.find(f=>f.base==e&&sameArray(a,f.modified));if(l)return l;let u=[],p=new Tag(e.name,u,e,a);for(let f of a)f.instances.push(p);let d=powerSet(a);for(let f of e.set)if(!f.modified.length)for(let g of d)u.push(Modifier.get(f,g));return p}}function sameArray(o,e){return o.length==e.length&&o.every((a,l)=>a==e[l])}function powerSet(o){let e=[[]];for(let a=0;a<o.length;a++)for(let l=0,u=e.length;l<u;l++)e.push(e[l].concat(o[a]));return e.sort((a,l)=>l.length-a.length)}function styleTags(o){let e=Object.create(null);for(let a in o){let l=o[a];Array.isArray(l)||(l=[l]);for(let u of a.split(" "))if(u){let p=[],d=2,f=u;for(let S=0;;){if(f=="..."&&S>0&&S+3==u.length){d=1;break}let M=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(f);if(!M)throw new RangeError("Invalid path: "+u);if(p.push(M[0]=="*"?"":M[0][0]=='"'?JSON.parse(M[0]):M[0]),S+=M[0].length,S==u.length)break;let E=u[S++];if(S==u.length&&E=="!"){d=0;break}if(E!="/")throw new RangeError("Invalid path: "+u);f=u.slice(S)}let g=p.length-1,b=p[g];if(!b)throw new RangeError("Invalid path: "+u);let A=new Rule(l,d,g>0?p.slice(0,g):null);e[b]=A.sort(e[b])}}return ruleNodeProp.add(e)}const ruleNodeProp=new NodeProp({combine(o,e){let a,l,u;for(;o||e;){if(!o||e&&o.depth>=e.depth?(u=e,e=e.next):(u=o,o=o.next),a&&a.mode==u.mode&&!u.context&&!a.context)continue;let p=new Rule(u.tags,u.mode,u.context);a?a.next=p:l=p,a=p}return l}});class Rule{constructor(e,a,l,u){this.tags=e,this.mode=a,this.context=l,this.next=u}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(o,e){let a=Object.create(null);for(let p of o)if(!Array.isArray(p.tag))a[p.tag.id]=p.class;else for(let d of p.tag)a[d.id]=p.class;let{scope:l,all:u=null}=e||{};return{style:p=>{let d=u;for(let f of p)for(let g of f.set){let b=a[g.id];if(b){d=d?d+" "+b:b;break}}return d},scope:l}}function highlightTags(o,e){let a=null;for(let l of o){let u=l.style(e);u&&(a=a?a+" "+u:u)}return a}function highlightTree(o,e,a,l=0,u=o.length){let p=new HighlightBuilder(l,Array.isArray(e)?e:[e],a);p.highlightRange(o.cursor(),l,u,"",p.highlighters),p.flush(u)}class HighlightBuilder{constructor(e,a,l){this.at=e,this.highlighters=a,this.span=l,this.class=""}startSpan(e,a){a!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=a)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,a,l,u,p){let{type:d,from:f,to:g}=e;if(f>=l||g<=a)return;d.isTop&&(p=this.highlighters.filter(E=>!E.scope||E.scope(d)));let b=u,A=getStyleTags(e)||Rule.empty,S=highlightTags(p,A.tags);if(S&&(b&&(b+=" "),b+=S,A.mode==1&&(u+=(u?" ":"")+S)),this.startSpan(Math.max(a,f),b),A.opaque)return;let M=e.tree&&e.tree.prop(NodeProp.mounted);if(M&&M.overlay){let E=e.node.enter(M.overlay[0].from+f,1),F=this.highlighters.filter(Z=>!Z.scope||Z.scope(M.tree.type)),$=e.firstChild();for(let Z=0,V=f;;Z++){let K=Z<M.overlay.length?M.overlay[Z]:null,se=K?K.from+f:g,z=Math.max(a,V),U=Math.min(l,se);if(z<U&&$)for(;e.from<U&&(this.highlightRange(e,z,U,u,p),this.startSpan(Math.min(U,e.to),b),!(e.to>=se||!e.nextSibling())););if(!K||se>l)break;V=K.to+f,V>a&&(this.highlightRange(E.cursor(),Math.max(a,K.from+f),Math.min(l,V),"",F),this.startSpan(Math.min(l,V),b))}$&&e.parent()}else if(e.firstChild()){M&&(u="");do if(!(e.to<=a)){if(e.from>=l)break;this.highlightRange(e,a,l,u,p),this.startSpan(Math.min(l,e.to),b)}while(e.nextSibling());e.parent()}}}function getStyleTags(o){let e=o.type.prop(ruleNodeProp);for(;e&&e.context&&!o.matchContext(e.context);)e=e.next;return e||null}const t=Tag.define,comment=t(),name$2=t(),typeName=t(name$2),propertyName=t(name$2),literal$1=t(),string=t(literal$1),number=t(literal$1),content=t(),heading=t(content),keyword$1=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags={comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name:name$2,variableName:t(name$2),typeName,tagName:t(typeName),propertyName,attributeName:t(propertyName),className:t(name$2),labelName:t(name$2),namespace:t(name$2),macroName:t(name$2),literal:literal$1,string,docString:t(string),character:t(string),attributeValue:t(string),number,integer:t(number),float:t(number),bool:t(literal$1),regexp:t(literal$1),escape:t(literal$1),color:t(literal$1),url:t(literal$1),keyword:keyword$1,self:t(keyword$1),null:t(keyword$1),atom:t(keyword$1),unit:t(keyword$1),modifier:t(keyword$1),operatorKeyword:t(keyword$1),controlKeyword:t(keyword$1),definitionKeyword:t(keyword$1),moduleKeyword:t(keyword$1),operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation,separator:t(punctuation),bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content,heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier("definition"),constant:Tag.defineModifier("constant"),function:Tag.defineModifier("function"),standard:Tag.defineModifier("standard"),local:Tag.defineModifier("local"),special:Tag.defineModifier("special")};for(let o in tags){let e=tags[o];e instanceof Tag&&(e.name=o)}tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);var _a;const languageDataProp=new NodeProp;function defineLanguageFacet(o){return Facet.define({combine:o?e=>e.concat(o):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(e,a,l=[],u=""){this.data=e,this.name=u,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=a,this.extension=[language.of(this),EditorState.languageData.of((p,d,f)=>{let g=topNodeAt(p,d,f),b=g.type.prop(languageDataProp);if(!b)return[];let A=p.facet(b),S=g.type.prop(sublanguageProp);if(S){let M=g.resolve(d-g.from,f);for(let E of S)if(E.test(M,p)){let F=p.facet(E.facet);return E.type=="replace"?F:F.concat(A)}}return A})].concat(l)}isActiveAt(e,a,l=-1){return topNodeAt(e,a,l).type.prop(languageDataProp)==this.data}findRegions(e){let a=e.facet(language);if(a?.data==this.data)return[{from:0,to:e.doc.length}];if(!a||!a.allowsNesting)return[];let l=[],u=(p,d)=>{if(p.prop(languageDataProp)==this.data){l.push({from:d,to:d+p.length});return}let f=p.prop(NodeProp.mounted);if(f){if(f.tree.prop(languageDataProp)==this.data){if(f.overlay)for(let g of f.overlay)l.push({from:g.from+d,to:g.to+d});else l.push({from:d,to:d+p.length});return}else if(f.overlay){let g=l.length;if(u(f.tree,f.overlay[0].from+d),l.length>g)return}}for(let g=0;g<p.children.length;g++){let b=p.children[g];b instanceof Tree&&u(b,p.positions[g]+d)}};return u(syntaxTree(e),0),l}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(o,e,a){let l=o.facet(language),u=syntaxTree(o).topNode;if(!l||l.allowsNesting)for(let p=u;p;p=p.enter(e,a,IterMode.ExcludeBuffers))p.type.isTop&&(u=p);return u}class LRLanguage extends Language{constructor(e,a,l){super(e,a,[],l),this.parser=a}static define(e){let a=defineLanguageFacet(e.languageData);return new LRLanguage(a,e.parser.configure({props:[languageDataProp.add(l=>l.isTop?a:void 0)]}),e.name)}configure(e,a){return new LRLanguage(this.data,this.parser.configure(e),a||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(o){let e=o.field(Language.state,!1);return e?e.tree:Tree.empty}class DocInput{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,a){let l=this.cursorPos-this.string.length;return e<l||a>=this.cursorPos?this.doc.sliceString(e,a):this.string.slice(e-l,a-l)}}let currentContext=null;class ParseContext{constructor(e,a,l=[],u,p,d,f,g){this.parser=e,this.state=a,this.fragments=l,this.tree=u,this.treeLen=p,this.viewport=d,this.skipped=f,this.scheduleOn=g,this.parse=null,this.tempSkipped=[]}static create(e,a,l){return new ParseContext(e,a,[],Tree.empty,0,l,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(e,a){return a!=null&&a>=this.state.doc.length&&(a=void 0),this.tree!=Tree.empty&&this.isDone(a??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var l;if(typeof e=="number"){let u=Date.now()+e;e=()=>Date.now()>u}for(this.parse||(this.parse=this.startParse()),a!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>a)&&a<this.state.doc.length&&this.parse.stopAt(a);;){let u=this.parse.advance();if(u)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(u,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(l=this.parse.stoppedAt)!==null&&l!==void 0?l:this.state.doc.length,this.tree=u,this.parse=null,this.treeLen<(a??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,a;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(a=this.parse.advance()););}),this.treeLen=e,this.tree=a,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let a=currentContext;currentContext=this;try{return e()}finally{currentContext=a}}withoutTempSkipped(e){for(let a;a=this.tempSkipped.pop();)e=cutFragments(e,a.from,a.to);return e}changes(e,a){let{fragments:l,tree:u,treeLen:p,viewport:d,skipped:f}=this;if(this.takeTree(),!e.empty){let g=[];if(e.iterChangedRanges((b,A,S,M)=>g.push({fromA:b,toA:A,fromB:S,toB:M})),l=TreeFragment.applyChanges(l,g),u=Tree.empty,p=0,d={from:e.mapPos(d.from,-1),to:e.mapPos(d.to,1)},this.skipped.length){f=[];for(let b of this.skipped){let A=e.mapPos(b.from,1),S=e.mapPos(b.to,-1);A<S&&f.push({from:A,to:S})}}}return new ParseContext(this.parser,a,l,u,p,d,f,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let a=this.skipped.length;for(let l=0;l<this.skipped.length;l++){let{from:u,to:p}=this.skipped[l];u<e.to&&p>e.from&&(this.fragments=cutFragments(this.fragments,u,p),this.skipped.splice(l--,1))}return this.skipped.length>=a?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,a){this.skipped.push({from:e,to:a})}static getSkippingParser(e){return new class extends Parser$1{createParse(a,l,u){let p=u[0].from,d=u[u.length-1].to;return{parsedPos:p,advance(){let g=currentContext;if(g){for(let b of u)g.tempSkipped.push(b);e&&(g.scheduleOn=g.scheduleOn?Promise.all([g.scheduleOn,e]):e)}return this.parsedPos=d,new Tree(NodeType.none,[],[],d-p)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let a=this.fragments;return this.treeLen>=e&&a.length&&a[0].from==0&&a[0].to>=e}static get(){return currentContext}}function cutFragments(o,e,a){return TreeFragment.applyChanges(o,[{fromA:e,toA:a,fromB:e,toB:a}])}class LanguageState{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let a=this.context.changes(e.changes,e.state),l=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),a.viewport.to);return a.work(20,l)||a.takeTree(),new LanguageState(a)}static init(e){let a=Math.min(3e3,e.doc.length),l=ParseContext.create(e.facet(language).parser,e,{from:0,to:a});return l.work(20,a)||l.takeTree(),new LanguageState(l)}}Language.state=StateField.define({create:LanguageState.init,update(o,e){for(let a of e.effects)if(a.is(Language.setState))return a.value;return e.startState.facet(language)!=e.state.facet(language)?LanguageState.init(e.state):o.apply(e)}});let requestIdle=o=>{let e=setTimeout(()=>o(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(requestIdle=o=>{let e=-1,a=setTimeout(()=>{e=requestIdleCallback(o,{timeout:400})},100);return()=>e<0?clearTimeout(a):cancelIdleCallback(e)});const isInputPending=typeof navigator<"u"&&(!((_a=navigator.scheduling)===null||_a===void 0)&&_a.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let a=this.view.state.field(Language.state).context;(a.updateViewport(e.view.viewport)||this.view.viewport.to>a.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(a)}scheduleWork(){if(this.working)return;let{state:e}=this.view,a=e.field(Language.state);(a.tree!=a.context.tree||!a.context.isDone(e.doc.length))&&(this.working=requestIdle(this.work))}work(e){this.working=null;let a=Date.now();if(this.chunkEnd<a&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=a+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:l,viewport:{to:u}}=this.view,p=l.field(Language.state);if(p.tree==p.context.tree&&p.context.isDone(u+1e5))return;let d=Date.now()+Math.min(this.chunkBudget,100,e&&!isInputPending?Math.max(25,e.timeRemaining()-5):1e9),f=p.context.treeLen<u&&l.doc.length>u+1e3,g=p.context.work(()=>isInputPending&&isInputPending()||Date.now()>d,u+(f?0:1e5));this.chunkBudget-=Date.now()-a,(g||this.chunkBudget<=0)&&(p.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(p.context))})),this.chunkBudget>0&&!(g&&!f)&&this.scheduleWork(),this.checkAsyncSchedule(p.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(a=>logException(this.view.state,a)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(o){return o.length?o[0]:null},enables:o=>[Language.state,parseWorker,EditorView.contentAttributes.compute([o],e=>{let a=e.facet(o);return a&&a.name?{"data-language":a.name}:{}})]});class LanguageSupport{constructor(e,a=[]){this.language=e,this.support=a,this.extension=[e,a]}}const indentService=Facet.define(),indentUnit=Facet.define({combine:o=>{if(!o.length)return"  ";let e=o[0];if(!e||/\S/.test(e)||Array.from(e).some(a=>a!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(o[0]));return e}});function getIndentUnit(o){let e=o.facet(indentUnit);return e.charCodeAt(0)==9?o.tabSize*e.length:e.length}function indentString(o,e){let a="",l=o.tabSize,u=o.facet(indentUnit)[0];if(u=="	"){for(;e>=l;)a+="	",e-=l;u=" "}for(let p=0;p<e;p++)a+=u;return a}function getIndentation(o,e){o instanceof EditorState&&(o=new IndentContext(o));for(let l of o.state.facet(indentService)){let u=l(o,e);if(u!==void 0)return u}let a=syntaxTree(o.state);return a.length>=e?syntaxIndentation(o,a,e):null}class IndentContext{constructor(e,a={}){this.state=e,this.options=a,this.unit=getIndentUnit(e)}lineAt(e,a=1){let l=this.state.doc.lineAt(e),{simulateBreak:u,simulateDoubleBreak:p}=this.options;return u!=null&&u>=l.from&&u<=l.to?p&&u==e?{text:"",from:e}:(a<0?u<e:u<=e)?{text:l.text.slice(u-l.from),from:u}:{text:l.text.slice(0,u-l.from),from:l.from}:l}textAfterPos(e,a=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:l,from:u}=this.lineAt(e,a);return l.slice(e-u,Math.min(l.length,e+100-u))}column(e,a=1){let{text:l,from:u}=this.lineAt(e,a),p=this.countColumn(l,e-u),d=this.options.overrideIndentation?this.options.overrideIndentation(u):-1;return d>-1&&(p+=d-this.countColumn(l,l.search(/\S|$/))),p}countColumn(e,a=e.length){return countColumn(e,this.state.tabSize,a)}lineIndent(e,a=1){let{text:l,from:u}=this.lineAt(e,a),p=this.options.overrideIndentation;if(p){let d=p(u);if(d>-1)return d}return this.countColumn(l,l.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(o,e,a){let l=e.resolveStack(a),u=e.resolveInner(a,-1).resolve(a,0).enterUnfinishedNodesBefore(a);if(u!=l.node){let p=[];for(let d=u;d&&!(d.from<l.node.from||d.to>l.node.to||d.from==l.node.from&&d.type==l.node.type);d=d.parent)p.push(d);for(let d=p.length-1;d>=0;d--)l={node:p[d],next:l}}return indentFor(l,o,a)}function indentFor(o,e,a){for(let l=o;l;l=l.next){let u=indentStrategy(l.node);if(u)return u(TreeIndentContext.create(e,a,l))}return 0}function ignoreClosed(o){return o.pos==o.options.simulateBreak&&o.options.simulateDoubleBreak}function indentStrategy(o){let e=o.type.prop(indentNodeProp);if(e)return e;let a=o.firstChild,l;if(a&&(l=a.type.prop(NodeProp.closedBy))){let u=o.lastChild,p=u&&l.indexOf(u.name)>-1;return d=>delimitedStrategy(d,!0,1,void 0,p&&!ignoreClosed(d)?u.from:void 0)}return o.parent==null?topIndent:null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(e,a,l){super(e.state,e.options),this.base=e,this.pos=a,this.context=l}get node(){return this.context.node}static create(e,a,l){return new TreeIndentContext(e,a,l)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let a=this.state.doc.lineAt(e.from);for(;;){let l=e.resolve(a.from);for(;l.parent&&l.parent.from==l.from;)l=l.parent;if(isParent(l,e))break;a=this.state.doc.lineAt(l.from)}return this.lineIndent(a.from)}continue(){return indentFor(this.context.next,this.base,this.pos)}}function isParent(o,e){for(let a=e;a;a=a.parent)if(o==a)return!0;return!1}function bracketedAligned(o){let e=o.node,a=e.childAfter(e.from),l=e.lastChild;if(!a)return null;let u=o.options.simulateBreak,p=o.state.doc.lineAt(a.from),d=u==null||u<=p.from?p.to:Math.min(p.to,u);for(let f=a.to;;){let g=e.childAfter(f);if(!g||g==l)return null;if(!g.type.isSkipped){if(g.from>=d)return null;let b=/^ */.exec(p.text.slice(a.to-p.from))[0].length;return{from:a.from,to:a.to+b}}f=g.to}}function delimitedIndent({closing:o,align:e=!0,units:a=1}){return l=>delimitedStrategy(l,e,a,o)}function delimitedStrategy(o,e,a,l,u){let p=o.textAfter,d=p.match(/^\s*/)[0].length,f=l&&p.slice(d,d+l.length)==l||u==o.pos+d,g=e?bracketedAligned(o):null;return g?f?o.column(g.from):o.column(g.to):o.baseIndent+(f?0:o.unit*a)}const flatIndent=o=>o.baseIndent;function continuedIndent({except:o,units:e=1}={}){return a=>{let l=o&&o.test(a.textAfter);return a.baseIndent+(l?0:e*a.unit)}}const DontIndentBeyond=200;function indentOnInput(){return EditorState.transactionFilter.of(o=>{if(!o.docChanged||!o.isUserEvent("input.type")&&!o.isUserEvent("input.complete"))return o;let e=o.startState.languageDataAt("indentOnInput",o.startState.selection.main.head);if(!e.length)return o;let a=o.newDoc,{head:l}=o.newSelection.main,u=a.lineAt(l);if(l>u.from+DontIndentBeyond)return o;let p=a.sliceString(u.from,l);if(!e.some(b=>b.test(p)))return o;let{state:d}=o,f=-1,g=[];for(let{head:b}of d.selection.ranges){let A=d.doc.lineAt(b);if(A.from==f)continue;f=A.from;let S=getIndentation(d,A.from);if(S==null)continue;let M=/^\s*/.exec(A.text)[0],E=indentString(d,S);M!=E&&g.push({from:A.from,to:A.from+M.length,insert:E})}return g.length?[o,{changes:g,sequential:!0}]:o})}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(o){let e=o.firstChild,a=o.lastChild;return e&&e.to<a.from?{from:e.to,to:a.type.isError?o.to:a.from}:null}function syntaxFolding(o,e,a){let l=syntaxTree(o);if(l.length<a)return null;let u=l.resolveStack(a,1),p=null;for(let d=u;d;d=d.next){let f=d.node;if(f.to<=a||f.from>a)continue;if(p&&f.from<e)break;let g=f.type.prop(foldNodeProp);if(g&&(f.to<l.length-50||l.length==o.doc.length||!isUnfinished(f))){let b=g(f,o);b&&b.from<=a&&b.from>=e&&b.to>a&&(p=b)}}return p}function isUnfinished(o){let e=o.lastChild;return e&&e.to==o.to&&e.type.isError}function foldable(o,e,a){for(let l of o.facet(foldService)){let u=l(o,e,a);if(u)return u}return syntaxFolding(o,e,a)}function mapRange(o,e){let a=e.mapPos(o.from,1),l=e.mapPos(o.to,-1);return a>=l?void 0:{from:a,to:l}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(o){let e=[];for(let{head:a}of o.state.selection.ranges)e.some(l=>l.from<=a&&l.to>=a)||e.push(o.lineBlockAt(a));return e}const foldState=StateField.define({create(){return Decoration.none},update(o,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((a,l)=>o=clearTouchedFolds(o,a,l)),o=o.map(e.changes);for(let a of e.effects)if(a.is(foldEffect)&&!foldExists(o,a.value.from,a.value.to)){let{preparePlaceholder:l}=e.state.facet(foldConfig),u=l?Decoration.replace({widget:new PreparedFoldWidget(l(e.state,a.value))}):foldWidget;o=o.update({add:[u.range(a.value.from,a.value.to)]})}else a.is(unfoldEffect)&&(o=o.update({filter:(l,u)=>a.value.from!=l||a.value.to!=u,filterFrom:a.value.from,filterTo:a.value.to}));return e.selection&&(o=clearTouchedFolds(o,e.selection.main.head)),o},provide:o=>EditorView.decorations.from(o),toJSON(o,e){let a=[];return o.between(0,e.doc.length,(l,u)=>{a.push(l,u)}),a},fromJSON(o){if(!Array.isArray(o)||o.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let a=0;a<o.length;){let l=o[a++],u=o[a++];if(typeof l!="number"||typeof u!="number")throw new RangeError("Invalid JSON for fold state");e.push(foldWidget.range(l,u))}return Decoration.set(e,!0)}});function clearTouchedFolds(o,e,a=e){let l=!1;return o.between(e,a,(u,p)=>{u<a&&p>e&&(l=!0)}),l?o.update({filterFrom:e,filterTo:a,filter:(u,p)=>u>=a||p<=e}):o}function findFold(o,e,a){var l;let u=null;return(l=o.field(foldState,!1))===null||l===void 0||l.between(e,a,(p,d)=>{(!u||u.from>p)&&(u={from:p,to:d})}),u}function foldExists(o,e,a){let l=!1;return o.between(e,e,(u,p)=>{u==e&&p==a&&(l=!0)}),l}function maybeEnable(o,e){return o.field(foldState,!1)?e:e.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=o=>{for(let e of selectedLines(o)){let a=foldable(o.state,e.from,e.to);if(a)return o.dispatch({effects:maybeEnable(o.state,[foldEffect.of(a),announceFold(o,a)])}),!0}return!1},unfoldCode=o=>{if(!o.state.field(foldState,!1))return!1;let e=[];for(let a of selectedLines(o)){let l=findFold(o.state,a.from,a.to);l&&e.push(unfoldEffect.of(l),announceFold(o,l,!1))}return e.length&&o.dispatch({effects:e}),e.length>0};function announceFold(o,e,a=!0){let l=o.state.doc.lineAt(e.from).number,u=o.state.doc.lineAt(e.to).number;return EditorView.announce.of(`${o.state.phrase(a?"Folded lines":"Unfolded lines")} ${l} ${o.state.phrase("to")} ${u}.`)}const foldAll=o=>{let{state:e}=o,a=[];for(let l=0;l<e.doc.length;){let u=o.lineBlockAt(l),p=foldable(e,u.from,u.to);p&&a.push(foldEffect.of(p)),l=(p?o.lineBlockAt(p.to):u).to+1}return a.length&&o.dispatch({effects:maybeEnable(o.state,a)}),!!a.length},unfoldAll=o=>{let e=o.state.field(foldState,!1);if(!e||!e.size)return!1;let a=[];return e.between(0,o.state.doc.length,(l,u)=>{a.push(unfoldEffect.of({from:l,to:u}))}),o.dispatch({effects:a}),!0},defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},foldConfig=Facet.define({combine(o){return combineConfig(o,defaultConfig)}});function codeFolding(o){return[foldState,baseTheme$1$2]}function widgetToDOM(o,e){let{state:a}=o,l=a.facet(foldConfig),u=d=>{let f=o.lineBlockAt(o.posAtDOM(d.target)),g=findFold(o.state,f.from,f.to);g&&o.dispatch({effects:unfoldEffect.of(g)}),d.preventDefault()};if(l.placeholderDOM)return l.placeholderDOM(o,u,e);let p=document.createElement("span");return p.textContent=l.placeholderText,p.setAttribute("aria-label",a.phrase("folded code")),p.title=a.phrase("unfold"),p.className="cm-foldPlaceholder",p.onclick=u,p}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(o){return widgetToDOM(o,null)}}});class PreparedFoldWidget extends WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return widgetToDOM(e,this.value)}}const foldGutterDefaults={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(e,a){super(),this.config=e,this.open=a}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let a=document.createElement("span");return a.textContent=this.open?this.config.openText:this.config.closedText,a.title=e.state.phrase(this.open?"Fold line":"Unfold line"),a}}function foldGutter(o={}){let e={...foldGutterDefaults,...o},a=new FoldMarker(e,!0),l=new FoldMarker(e,!1),u=ViewPlugin.fromClass(class{constructor(d){this.from=d.viewport.from,this.markers=this.buildMarkers(d)}update(d){(d.docChanged||d.viewportChanged||d.startState.facet(language)!=d.state.facet(language)||d.startState.field(foldState,!1)!=d.state.field(foldState,!1)||syntaxTree(d.startState)!=syntaxTree(d.state)||e.foldingChanged(d))&&(this.markers=this.buildMarkers(d.view))}buildMarkers(d){let f=new RangeSetBuilder;for(let g of d.viewportLineBlocks){let b=findFold(d.state,g.from,g.to)?l:foldable(d.state,g.from,g.to)?a:null;b&&f.add(g.from,g.from,b)}return f.finish()}}),{domEventHandlers:p}=e;return[u,gutter({class:"cm-foldGutter",markers(d){var f;return((f=d.plugin(u))===null||f===void 0?void 0:f.markers)||RangeSet.empty},initialSpacer(){return new FoldMarker(e,!1)},domEventHandlers:{...p,click:(d,f,g)=>{if(p.click&&p.click(d,f,g))return!0;let b=findFold(d.state,f.from,f.to);if(b)return d.dispatch({effects:unfoldEffect.of(b)}),!0;let A=foldable(d.state,f.from,f.to);return A?(d.dispatch({effects:foldEffect.of(A)}),!0):!1}}}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(e,a){this.specs=e;let l;function u(f){let g=StyleModule.newName();return(l||(l=Object.create(null)))["."+g]=f,g}const p=typeof a.all=="string"?a.all:a.all?u(a.all):void 0,d=a.scope;this.scope=d instanceof Language?f=>f.prop(languageDataProp)==d.data:d?f=>f==d:void 0,this.style=tagHighlighter(e.map(f=>({tag:f.tag,class:f.class||u(Object.assign({},f,{tag:null}))})),{all:p}).style,this.module=l?new StyleModule(l):null,this.themeType=a.themeType}static define(e,a){return new HighlightStyle(e,a||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(o){return o.length?[o[0]]:null}});function getHighlighters(o){let e=o.facet(highlighterFacet);return e.length?e:o.facet(fallbackHighlighter)}function syntaxHighlighting(o,e){let a=[treeHighlighter],l;return o instanceof HighlightStyle&&(o.module&&a.push(EditorView.styleModule.of(o.module)),l=o.themeType),l?a.push(highlighterFacet.computeN([EditorView.darkTheme],u=>u.facet(EditorView.darkTheme)==(l=="dark")?[o]:[])):a.push(highlighterFacet.of(o)),a}class TreeHighlighter{constructor(e){this.markCache=Object.create(null),this.tree=syntaxTree(e.state),this.decorations=this.buildDeco(e,getHighlighters(e.state)),this.decoratedTo=e.viewport.to}update(e){let a=syntaxTree(e.state),l=getHighlighters(e.state),u=l!=getHighlighters(e.startState),{viewport:p}=e.view,d=e.changes.mapPos(this.decoratedTo,1);a.length<p.to&&!u&&a.type==this.tree.type&&d>=p.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=d):(a!=this.tree||e.viewportChanged||u)&&(this.tree=a,this.decorations=this.buildDeco(e.view,l),this.decoratedTo=p.to)}buildDeco(e,a){if(!a||!this.tree.length)return Decoration.none;let l=new RangeSetBuilder;for(let{from:u,to:p}of e.visibleRanges)highlightTree(this.tree,a,(d,f,g)=>{l.add(d,f,this.markCache[g]||(this.markCache[g]=Decoration.mark({class:g})))},u,p);return l.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:o=>o.decorations})),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine(o){return combineConfig(o,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(o){let e=[],a=o.matched?matchingMark:nonmatchingMark;return e.push(a.range(o.start.from,o.start.to)),o.end&&e.push(a.range(o.end.from,o.end.to)),e}const bracketMatchingState=StateField.define({create(){return Decoration.none},update(o,e){if(!e.docChanged&&!e.selection)return o;let a=[],l=e.state.facet(bracketMatchingConfig);for(let u of e.state.selection.ranges){if(!u.empty)continue;let p=matchBrackets(e.state,u.head,-1,l)||u.head>0&&matchBrackets(e.state,u.head-1,1,l)||l.afterCursor&&(matchBrackets(e.state,u.head,1,l)||u.head<e.state.doc.length&&matchBrackets(e.state,u.head+1,-1,l));p&&(a=a.concat(l.renderMatch(p,e.state)))}return Decoration.set(a,!0)},provide:o=>EditorView.decorations.from(o)}),bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(o={}){return[bracketMatchingConfig.of(o),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp;function matchingNodes(o,e,a){let l=o.prop(e<0?NodeProp.openedBy:NodeProp.closedBy);if(l)return l;if(o.name.length==1){let u=a.indexOf(o.name);if(u>-1&&u%2==(e<0?1:0))return[a[u+e]]}return null}function findHandle(o){let e=o.type.prop(bracketMatchingHandle);return e?e(o.node):o}function matchBrackets(o,e,a,l={}){let u=l.maxScanDistance||DefaultScanDist,p=l.brackets||DefaultBrackets,d=syntaxTree(o),f=d.resolveInner(e,a);for(let g=f;g;g=g.parent){let b=matchingNodes(g.type,a,p);if(b&&g.from<g.to){let A=findHandle(g);if(A&&(a>0?e>=A.from&&e<A.to:e>A.from&&e<=A.to))return matchMarkedBrackets(o,e,a,g,A,b,p)}}return matchPlainBrackets(o,e,a,d,f.type,u,p)}function matchMarkedBrackets(o,e,a,l,u,p,d){let f=l.parent,g={from:u.from,to:u.to},b=0,A=f?.cursor();if(A&&(a<0?A.childBefore(l.from):A.childAfter(l.to)))do if(a<0?A.to<=l.from:A.from>=l.to){if(b==0&&p.indexOf(A.type.name)>-1&&A.from<A.to){let S=findHandle(A);return{start:g,end:S?{from:S.from,to:S.to}:void 0,matched:!0}}else if(matchingNodes(A.type,a,d))b++;else if(matchingNodes(A.type,-a,d)){if(b==0){let S=findHandle(A);return{start:g,end:S&&S.from<S.to?{from:S.from,to:S.to}:void 0,matched:!1}}b--}}while(a<0?A.prevSibling():A.nextSibling());return{start:g,matched:!1}}function matchPlainBrackets(o,e,a,l,u,p,d){let f=a<0?o.sliceDoc(e-1,e):o.sliceDoc(e,e+1),g=d.indexOf(f);if(g<0||g%2==0!=a>0)return null;let b={from:a<0?e-1:e,to:a>0?e+1:e},A=o.doc.iterRange(e,a>0?o.doc.length:0),S=0;for(let M=0;!A.next().done&&M<=p;){let E=A.value;a<0&&(M+=E.length);let F=e+M*a;for(let $=a>0?0:E.length-1,Z=a>0?E.length:-1;$!=Z;$+=a){let V=d.indexOf(E[$]);if(!(V<0||l.resolveInner(F+$,1).type!=u))if(V%2==0==a>0)S++;else{if(S==1)return{start:b,end:{from:F+$,to:F+$+1},matched:V>>1==g>>1};S--}}a>0&&(M+=E.length)}return A.done?{start:b,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],byTag=Object.create(null),defaultTable=Object.create(null);for(let[o,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[o]=createTokenType(noTokens,e);function warnForPart(o,e){warned.indexOf(o)>-1||(warned.push(o),console.warn(e))}function createTokenType(o,e){let a=[];for(let f of e.split(" ")){let g=[];for(let b of f.split(".")){let A=o[b]||tags[b];A?typeof A=="function"?g.length?g=g.map(A):warnForPart(b,`Modifier ${b} used at start of tag`):g.length?warnForPart(b,`Tag ${b} used as modifier`):g=Array.isArray(A)?A:[A]:warnForPart(b,`Unknown highlighting tag ${b}`)}for(let b of g)a.push(b)}if(!a.length)return 0;let l=e.replace(/ /g,"_"),u=l+" "+a.map(f=>f.id),p=byTag[u];if(p)return p.id;let d=byTag[u]=NodeType.define({id:typeArray.length,name:l,props:[styleTags({[l]:a})]});return typeArray.push(d),d.id}Direction.RTL,Direction.LTR;const toggleComment=o=>{let{state:e}=o,a=e.doc.lineAt(e.selection.main.from),l=getConfig(o.state,a.from);return l.line?toggleLineComment(o):l.block?toggleBlockCommentByLine(o):!1};function command(o,e){return({state:a,dispatch:l})=>{if(a.readOnly)return!1;let u=o(e,a);return u?(l(a.update(u)),!0):!1}}const toggleLineComment=command(changeLineComment,0),lineComment=command(changeLineComment,1),lineUncomment=command(changeLineComment,2),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((o,e)=>changeBlockComment(o,e,selectedLineRanges(e)),0);function getConfig(o,e){let a=o.languageDataAt("commentTokens",e,1);return a.length?a[0]:{}}const SearchMargin=50;function findBlockComment(o,{open:e,close:a},l,u){let p=o.sliceDoc(l-SearchMargin,l),d=o.sliceDoc(u,u+SearchMargin),f=/\s*$/.exec(p)[0].length,g=/^\s*/.exec(d)[0].length,b=p.length-f;if(p.slice(b-e.length,b)==e&&d.slice(g,g+a.length)==a)return{open:{pos:l-f,margin:f&&1},close:{pos:u+g,margin:g&&1}};let A,S;u-l<=2*SearchMargin?A=S=o.sliceDoc(l,u):(A=o.sliceDoc(l,l+SearchMargin),S=o.sliceDoc(u-SearchMargin,u));let M=/^\s*/.exec(A)[0].length,E=/\s*$/.exec(S)[0].length,F=S.length-E-a.length;return A.slice(M,M+e.length)==e&&S.slice(F,F+a.length)==a?{open:{pos:l+M+e.length,margin:/\s/.test(A.charAt(M+e.length))?1:0},close:{pos:u-E-a.length,margin:/\s/.test(S.charAt(F-1))?1:0}}:null}function selectedLineRanges(o){let e=[];for(let a of o.selection.ranges){let l=o.doc.lineAt(a.from),u=a.to<=l.to?l:o.doc.lineAt(a.to);u.from>l.from&&u.from==a.to&&(u=a.to==l.to+1?l:o.doc.lineAt(a.to-1));let p=e.length-1;p>=0&&e[p].to>l.from?e[p].to=u.to:e.push({from:l.from+/^\s*/.exec(l.text)[0].length,to:u.to})}return e}function changeBlockComment(o,e,a=e.selection.ranges){let l=a.map(p=>getConfig(e,p.from).block);if(!l.every(p=>p))return null;let u=a.map((p,d)=>findBlockComment(e,l[d],p.from,p.to));if(o!=2&&!u.every(p=>p))return{changes:e.changes(a.map((p,d)=>u[d]?[]:[{from:p.from,insert:l[d].open+" "},{from:p.to,insert:" "+l[d].close}]))};if(o!=1&&u.some(p=>p)){let p=[];for(let d=0,f;d<u.length;d++)if(f=u[d]){let g=l[d],{open:b,close:A}=f;p.push({from:b.pos-g.open.length,to:b.pos+b.margin},{from:A.pos-A.margin,to:A.pos+g.close.length})}return{changes:p}}return null}function changeLineComment(o,e,a=e.selection.ranges){let l=[],u=-1;for(let{from:p,to:d}of a){let f=l.length,g=1e9,b=getConfig(e,p).line;if(b){for(let A=p;A<=d;){let S=e.doc.lineAt(A);if(S.from>u&&(p==d||d>S.from)){u=S.from;let M=/^\s*/.exec(S.text)[0].length,E=M==S.length,F=S.text.slice(M,M+b.length)==b?M:-1;M<S.text.length&&M<g&&(g=M),l.push({line:S,comment:F,token:b,indent:M,empty:E,single:!1})}A=S.to+1}if(g<1e9)for(let A=f;A<l.length;A++)l[A].indent<l[A].line.text.length&&(l[A].indent=g);l.length==f+1&&(l[f].single=!0)}}if(o!=2&&l.some(p=>p.comment<0&&(!p.empty||p.single))){let p=[];for(let{line:f,token:g,indent:b,empty:A,single:S}of l)(S||!A)&&p.push({from:f.from+b,insert:g+" "});let d=e.changes(p);return{changes:d,selection:e.selection.map(d,1)}}else if(o!=1&&l.some(p=>p.comment>=0)){let p=[];for(let{line:d,comment:f,token:g}of l)if(f>=0){let b=d.from+f,A=b+g.length;d.text[A-d.from]==" "&&A++,p.push({from:b,to:A})}return{changes:p}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(o){return combineConfig(o,{minDepth:100,newGroupDelay:500,joinToEvent:(e,a)=>a},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,a)=>(l,u)=>e(l,u)||a(l,u)})}}),historyField_=StateField.define({create(){return HistoryState.empty},update(o,e){let a=e.state.facet(historyConfig),l=e.annotation(fromHistory);if(l){let g=HistEvent.fromTransaction(e,l.selection),b=l.side,A=b==0?o.undone:o.done;return g?A=updateBranch(A,A.length,a.minDepth,g):A=addSelection(A,e.startState.selection),new HistoryState(b==0?l.rest:A,b==0?A:l.rest)}let u=e.annotation(isolateHistory);if((u=="full"||u=="before")&&(o=o.isolate()),e.annotation(Transaction.addToHistory)===!1)return e.changes.empty?o:o.addMapping(e.changes.desc);let p=HistEvent.fromTransaction(e),d=e.annotation(Transaction.time),f=e.annotation(Transaction.userEvent);return p?o=o.addChanges(p,d,f,a,e):e.selection&&(o=o.addSelection(e.startState.selection,d,f,a.newGroupDelay)),(u=="full"||u=="after")&&(o=o.isolate()),o},toJSON(o){return{done:o.done.map(e=>e.toJSON()),undone:o.undone.map(e=>e.toJSON())}},fromJSON(o){return new HistoryState(o.done.map(HistEvent.fromJSON),o.undone.map(HistEvent.fromJSON))}});function history(o={}){return[historyField_,historyConfig.of(o),EditorView.domEventHandlers({beforeinput(e,a){let l=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;return l?(e.preventDefault(),l(a)):!1}})]}function cmd(o,e){return function({state:a,dispatch:l}){if(!e&&a.readOnly)return!1;let u=a.field(historyField_,!1);if(!u)return!1;let p=u.pop(o,a,e);return p?(l(p),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(e,a,l,u,p){this.changes=e,this.effects=a,this.mapped=l,this.startSelection=u,this.selectionsAfter=p}setSelAfter(e){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,a,l;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(a=this.mapped)===null||a===void 0?void 0:a.toJSON(),startSelection:(l=this.startSelection)===null||l===void 0?void 0:l.toJSON(),selectionsAfter:this.selectionsAfter.map(u=>u.toJSON())}}static fromJSON(e){return new HistEvent(e.changes&&ChangeSet.fromJSON(e.changes),[],e.mapped&&ChangeDesc.fromJSON(e.mapped),e.startSelection&&EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(e,a){let l=none$1;for(let u of e.startState.facet(invertedEffects)){let p=u(e);p.length&&(l=l.concat(p))}return!l.length&&e.changes.empty?null:new HistEvent(e.changes.invert(e.startState.doc),l,void 0,a||e.startState.selection,none$1)}static selection(e){return new HistEvent(void 0,none$1,void 0,void 0,e)}}function updateBranch(o,e,a,l){let u=e+1>a+20?e-a-1:0,p=o.slice(u,e);return p.push(l),p}function isAdjacent(o,e){let a=[],l=!1;return o.iterChangedRanges((u,p)=>a.push(u,p)),e.iterChangedRanges((u,p,d,f)=>{for(let g=0;g<a.length;){let b=a[g++],A=a[g++];f>=b&&d<=A&&(l=!0)}}),l}function eqSelectionShape(o,e){return o.ranges.length==e.ranges.length&&o.ranges.filter((a,l)=>a.empty!=e.ranges[l].empty).length===0}function conc(o,e){return o.length?e.length?o.concat(e):o:e}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(o,e){if(o.length){let a=o[o.length-1],l=a.selectionsAfter.slice(Math.max(0,a.selectionsAfter.length-MaxSelectionsPerEvent));return l.length&&l[l.length-1].eq(e)?o:(l.push(e),updateBranch(o,o.length-1,1e9,a.setSelAfter(l)))}else return[HistEvent.selection([e])]}function popSelection(o){let e=o[o.length-1],a=o.slice();return a[o.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),a}function addMappingToBranch(o,e){if(!o.length)return o;let a=o.length,l=none$1;for(;a;){let u=mapEvent(o[a-1],e,l);if(u.changes&&!u.changes.empty||u.effects.length){let p=o.slice(0,a);return p[a-1]=u,p}else e=u.mapped,a--,l=u.selectionsAfter}return l.length?[HistEvent.selection(l)]:none$1}function mapEvent(o,e,a){let l=conc(o.selectionsAfter.length?o.selectionsAfter.map(f=>f.map(e)):none$1,a);if(!o.changes)return HistEvent.selection(l);let u=o.changes.map(e),p=e.mapDesc(o.changes,!0),d=o.mapped?o.mapped.composeDesc(p):p;return new HistEvent(u,StateEffect.mapEffects(o.effects,e),d,o.startSelection.map(p),l)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(e,a,l=0,u=void 0){this.done=e,this.undone=a,this.prevTime=l,this.prevUserEvent=u}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(e,a,l,u,p){let d=this.done,f=d[d.length-1];return f&&f.changes&&!f.changes.empty&&e.changes&&(!l||joinableUserEvent.test(l))&&(!f.selectionsAfter.length&&a-this.prevTime<u.newGroupDelay&&u.joinToEvent(p,isAdjacent(f.changes,e.changes))||l=="input.type.compose")?d=updateBranch(d,d.length-1,u.minDepth,new HistEvent(e.changes.compose(f.changes),conc(StateEffect.mapEffects(e.effects,f.changes),f.effects),f.mapped,f.startSelection,none$1)):d=updateBranch(d,d.length,u.minDepth,e),new HistoryState(d,none$1,a,l)}addSelection(e,a,l,u){let p=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return p.length>0&&a-this.prevTime<u&&l==this.prevUserEvent&&l&&/^select($|\.)/.test(l)&&eqSelectionShape(p[p.length-1],e)?this:new HistoryState(addSelection(this.done,e),this.undone,a,l)}addMapping(e){return new HistoryState(addMappingToBranch(this.done,e),addMappingToBranch(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,a,l){let u=e==0?this.done:this.undone;if(u.length==0)return null;let p=u[u.length-1],d=p.selectionsAfter[0]||a.selection;if(l&&p.selectionsAfter.length)return a.update({selection:p.selectionsAfter[p.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(u),selection:d}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(p.changes){let f=u.length==1?none$1:u.slice(0,u.length-1);return p.mapped&&(f=addMappingToBranch(f,p.mapped)),a.update({changes:p.changes,selection:p.startSelection,effects:p.effects,annotations:fromHistory.of({side:e,rest:f,selection:d}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(o,e){return EditorSelection.create(o.ranges.map(e),o.mainIndex)}function setSel(o,e){return o.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:o,dispatch:e},a){let l=updateSel(o.selection,a);return l.eq(o.selection,!0)?!1:(e(setSel(o,l)),!0)}function rangeEnd(o,e){return EditorSelection.cursor(e?o.to:o.from)}function cursorByChar(o,e){return moveSel(o,a=>a.empty?o.moveByChar(a,e):rangeEnd(a,e))}function ltrAtCursor(o){return o.textDirectionAt(o.state.selection.main.head)==Direction.LTR}const cursorCharLeft=o=>cursorByChar(o,!ltrAtCursor(o)),cursorCharRight=o=>cursorByChar(o,ltrAtCursor(o));function cursorByGroup(o,e){return moveSel(o,a=>a.empty?o.moveByGroup(a,e):rangeEnd(a,e))}const cursorGroupLeft=o=>cursorByGroup(o,!ltrAtCursor(o)),cursorGroupRight=o=>cursorByGroup(o,ltrAtCursor(o));function interestingNode(o,e,a){if(e.type.prop(a))return!0;let l=e.to-e.from;return l&&(l>2||/[^\s,.;:]/.test(o.sliceDoc(e.from,e.to)))||e.firstChild}function moveBySyntax(o,e,a){let l=syntaxTree(o).resolveInner(e.head),u=a?NodeProp.closedBy:NodeProp.openedBy;for(let g=e.head;;){let b=a?l.childAfter(g):l.childBefore(g);if(!b)break;interestingNode(o,b,u)?l=b:g=a?b.to:b.from}let p=l.type.prop(u),d,f;return p&&(d=a?matchBrackets(o,l.from,1):matchBrackets(o,l.to,-1))&&d.matched?f=a?d.end.to:d.end.from:f=a?l.to:l.from,EditorSelection.cursor(f,a?-1:1)}const cursorSyntaxLeft=o=>moveSel(o,e=>moveBySyntax(o.state,e,!ltrAtCursor(o))),cursorSyntaxRight=o=>moveSel(o,e=>moveBySyntax(o.state,e,ltrAtCursor(o)));function cursorByLine(o,e){return moveSel(o,a=>{if(!a.empty)return rangeEnd(a,e);let l=o.moveVertically(a,e);return l.head!=a.head?l:o.moveToLineBoundary(a,e)})}const cursorLineUp=o=>cursorByLine(o,!1),cursorLineDown=o=>cursorByLine(o,!0);function pageInfo(o){let e=o.scrollDOM.clientHeight<o.scrollDOM.scrollHeight-2,a=0,l=0,u;if(e){for(let p of o.state.facet(EditorView.scrollMargins)){let d=p(o);d?.top&&(a=Math.max(d?.top,a)),d?.bottom&&(l=Math.max(d?.bottom,l))}u=o.scrollDOM.clientHeight-a-l}else u=(o.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:a,marginBottom:l,selfScroll:e,height:Math.max(o.defaultLineHeight,u-5)}}function cursorByPage(o,e){let a=pageInfo(o),{state:l}=o,u=updateSel(l.selection,d=>d.empty?o.moveVertically(d,e,a.height):rangeEnd(d,e));if(u.eq(l.selection))return!1;let p;if(a.selfScroll){let d=o.coordsAtPos(l.selection.main.head),f=o.scrollDOM.getBoundingClientRect(),g=f.top+a.marginTop,b=f.bottom-a.marginBottom;d&&d.top>g&&d.bottom<b&&(p=EditorView.scrollIntoView(u.main.head,{y:"start",yMargin:d.top-g}))}return o.dispatch(setSel(l,u),{effects:p}),!0}const cursorPageUp=o=>cursorByPage(o,!1),cursorPageDown=o=>cursorByPage(o,!0);function moveByLineBoundary(o,e,a){let l=o.lineBlockAt(e.head),u=o.moveToLineBoundary(e,a);if(u.head==e.head&&u.head!=(a?l.to:l.from)&&(u=o.moveToLineBoundary(e,a,!1)),!a&&u.head==l.from&&l.length){let p=/^\s*/.exec(o.state.sliceDoc(l.from,Math.min(l.from+100,l.to)))[0].length;p&&e.head!=l.from+p&&(u=EditorSelection.cursor(l.from+p))}return u}const cursorLineBoundaryForward=o=>moveSel(o,e=>moveByLineBoundary(o,e,!0)),cursorLineBoundaryBackward=o=>moveSel(o,e=>moveByLineBoundary(o,e,!1)),cursorLineBoundaryLeft=o=>moveSel(o,e=>moveByLineBoundary(o,e,!ltrAtCursor(o))),cursorLineBoundaryRight=o=>moveSel(o,e=>moveByLineBoundary(o,e,ltrAtCursor(o))),cursorLineStart=o=>moveSel(o,e=>EditorSelection.cursor(o.lineBlockAt(e.head).from,1)),cursorLineEnd=o=>moveSel(o,e=>EditorSelection.cursor(o.lineBlockAt(e.head).to,-1));function toMatchingBracket(o,e,a){let l=!1,u=updateSel(o.selection,p=>{let d=matchBrackets(o,p.head,-1)||matchBrackets(o,p.head,1)||p.head>0&&matchBrackets(o,p.head-1,1)||p.head<o.doc.length&&matchBrackets(o,p.head+1,-1);if(!d||!d.end)return p;l=!0;let f=d.start.from==p.head?d.end.to:d.end.from;return EditorSelection.cursor(f)});return l?(e(setSel(o,u)),!0):!1}const cursorMatchingBracket=({state:o,dispatch:e})=>toMatchingBracket(o,e);function extendSel(o,e){let a=updateSel(o.state.selection,l=>{let u=e(l);return EditorSelection.range(l.anchor,u.head,u.goalColumn,u.bidiLevel||void 0)});return a.eq(o.state.selection)?!1:(o.dispatch(setSel(o.state,a)),!0)}function selectByChar(o,e){return extendSel(o,a=>o.moveByChar(a,e))}const selectCharLeft=o=>selectByChar(o,!ltrAtCursor(o)),selectCharRight=o=>selectByChar(o,ltrAtCursor(o));function selectByGroup(o,e){return extendSel(o,a=>o.moveByGroup(a,e))}const selectGroupLeft=o=>selectByGroup(o,!ltrAtCursor(o)),selectGroupRight=o=>selectByGroup(o,ltrAtCursor(o)),selectSyntaxLeft=o=>extendSel(o,e=>moveBySyntax(o.state,e,!ltrAtCursor(o))),selectSyntaxRight=o=>extendSel(o,e=>moveBySyntax(o.state,e,ltrAtCursor(o)));function selectByLine(o,e){return extendSel(o,a=>o.moveVertically(a,e))}const selectLineUp=o=>selectByLine(o,!1),selectLineDown=o=>selectByLine(o,!0);function selectByPage(o,e){return extendSel(o,a=>o.moveVertically(a,e,pageInfo(o).height))}const selectPageUp=o=>selectByPage(o,!1),selectPageDown=o=>selectByPage(o,!0),selectLineBoundaryForward=o=>extendSel(o,e=>moveByLineBoundary(o,e,!0)),selectLineBoundaryBackward=o=>extendSel(o,e=>moveByLineBoundary(o,e,!1)),selectLineBoundaryLeft=o=>extendSel(o,e=>moveByLineBoundary(o,e,!ltrAtCursor(o))),selectLineBoundaryRight=o=>extendSel(o,e=>moveByLineBoundary(o,e,ltrAtCursor(o))),selectLineStart=o=>extendSel(o,e=>EditorSelection.cursor(o.lineBlockAt(e.head).from)),selectLineEnd=o=>extendSel(o,e=>EditorSelection.cursor(o.lineBlockAt(e.head).to)),cursorDocStart=({state:o,dispatch:e})=>(e(setSel(o,{anchor:0})),!0),cursorDocEnd=({state:o,dispatch:e})=>(e(setSel(o,{anchor:o.doc.length})),!0),selectDocStart=({state:o,dispatch:e})=>(e(setSel(o,{anchor:o.selection.main.anchor,head:0})),!0),selectDocEnd=({state:o,dispatch:e})=>(e(setSel(o,{anchor:o.selection.main.anchor,head:o.doc.length})),!0),selectAll=({state:o,dispatch:e})=>(e(o.update({selection:{anchor:0,head:o.doc.length},userEvent:"select"})),!0),selectLine=({state:o,dispatch:e})=>{let a=selectedLineBlocks(o).map(({from:l,to:u})=>EditorSelection.range(l,Math.min(u+1,o.doc.length)));return e(o.update({selection:EditorSelection.create(a),userEvent:"select"})),!0},selectParentSyntax=({state:o,dispatch:e})=>{let a=updateSel(o.selection,l=>{let u=syntaxTree(o),p=u.resolveStack(l.from,1);if(l.empty){let d=u.resolveStack(l.from,-1);d.node.from>=p.node.from&&d.node.to<=p.node.to&&(p=d)}for(let d=p;d;d=d.next){let{node:f}=d;if((f.from<l.from&&f.to>=l.to||f.to>l.to&&f.from<=l.from)&&d.next)return EditorSelection.range(f.to,f.from)}return l});return a.eq(o.selection)?!1:(e(setSel(o,a)),!0)};function addCursorVertically(o,e){let{state:a}=o,l=a.selection,u=a.selection.ranges.slice();for(let p of a.selection.ranges){let d=a.doc.lineAt(p.head);if(e?d.to<o.state.doc.length:d.from>0)for(let f=p;;){let g=o.moveVertically(f,e);if(g.head<d.from||g.head>d.to){u.some(b=>b.head==g.head)||u.push(g);break}else{if(g.head==f.head)break;f=g}}}return u.length==l.ranges.length?!1:(o.dispatch(setSel(a,EditorSelection.create(u,u.length-1))),!0)}const addCursorAbove=o=>addCursorVertically(o,!1),addCursorBelow=o=>addCursorVertically(o,!0),simplifySelection=({state:o,dispatch:e})=>{let a=o.selection,l=null;return a.ranges.length>1?l=EditorSelection.create([a.main]):a.main.empty||(l=EditorSelection.create([EditorSelection.cursor(a.main.head)])),l?(e(setSel(o,l)),!0):!1};function deleteBy(o,e){if(o.state.readOnly)return!1;let a="delete.selection",{state:l}=o,u=l.changeByRange(p=>{let{from:d,to:f}=p;if(d==f){let g=e(p);g<d?(a="delete.backward",g=skipAtomic(o,g,!1)):g>d&&(a="delete.forward",g=skipAtomic(o,g,!0)),d=Math.min(d,g),f=Math.max(f,g)}else d=skipAtomic(o,d,!1),f=skipAtomic(o,f,!0);return d==f?{range:p}:{changes:{from:d,to:f},range:EditorSelection.cursor(d,d<p.head?-1:1)}});return u.changes.empty?!1:(o.dispatch(l.update(u,{scrollIntoView:!0,userEvent:a,effects:a=="delete.selection"?EditorView.announce.of(l.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(o,e,a){if(o instanceof EditorView)for(let l of o.state.facet(EditorView.atomicRanges).map(u=>u(o)))l.between(e,e,(u,p)=>{u<e&&p>e&&(e=a?p:u)});return e}const deleteByChar=(o,e,a)=>deleteBy(o,l=>{let u=l.from,{state:p}=o,d=p.doc.lineAt(u),f,g;if(a&&!e&&u>d.from&&u<d.from+200&&!/[^ \t]/.test(f=d.text.slice(0,u-d.from))){if(f[f.length-1]=="	")return u-1;let b=countColumn(f,p.tabSize),A=b%getIndentUnit(p)||getIndentUnit(p);for(let S=0;S<A&&f[f.length-1-S]==" ";S++)u--;g=u}else g=findClusterBreak(d.text,u-d.from,e,e)+d.from,g==u&&d.number!=(e?p.doc.lines:1)?g+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(d.text.slice(g-d.from,u-d.from))&&(g=findClusterBreak(d.text,g-d.from,!1,!1)+d.from);return g}),deleteCharBackward=o=>deleteByChar(o,!1,!0),deleteCharForward=o=>deleteByChar(o,!0,!1),deleteByGroup=(o,e)=>deleteBy(o,a=>{let l=a.head,{state:u}=o,p=u.doc.lineAt(l),d=u.charCategorizer(l);for(let f=null;;){if(l==(e?p.to:p.from)){l==a.head&&p.number!=(e?u.doc.lines:1)&&(l+=e?1:-1);break}let g=findClusterBreak(p.text,l-p.from,e)+p.from,b=p.text.slice(Math.min(l,g)-p.from,Math.max(l,g)-p.from),A=d(b);if(f!=null&&A!=f)break;(b!=" "||l!=a.head)&&(f=A),l=g}return l}),deleteGroupBackward=o=>deleteByGroup(o,!1),deleteGroupForward=o=>deleteByGroup(o,!0),deleteToLineEnd=o=>deleteBy(o,e=>{let a=o.lineBlockAt(e.head).to;return e.head<a?a:Math.min(o.state.doc.length,e.head+1)}),deleteToLineStart=o=>deleteBy(o,e=>{let a=o.lineBlockAt(e.head).from;return e.head>a?a:Math.max(0,e.head-1)}),deleteLineBoundaryBackward=o=>deleteBy(o,e=>{let a=o.moveToLineBoundary(e,!1).head;return e.head>a?a:Math.max(0,e.head-1)}),deleteLineBoundaryForward=o=>deleteBy(o,e=>{let a=o.moveToLineBoundary(e,!0).head;return e.head<a?a:Math.min(o.state.doc.length,e.head+1)}),splitLine=({state:o,dispatch:e})=>{if(o.readOnly)return!1;let a=o.changeByRange(l=>({changes:{from:l.from,to:l.to,insert:Text.of(["",""])},range:EditorSelection.cursor(l.from)}));return e(o.update(a,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:o,dispatch:e})=>{if(o.readOnly)return!1;let a=o.changeByRange(l=>{if(!l.empty||l.from==0||l.from==o.doc.length)return{range:l};let u=l.from,p=o.doc.lineAt(u),d=u==p.from?u-1:findClusterBreak(p.text,u-p.from,!1)+p.from,f=u==p.to?u+1:findClusterBreak(p.text,u-p.from,!0)+p.from;return{changes:{from:d,to:f,insert:o.doc.slice(u,f).append(o.doc.slice(d,u))},range:EditorSelection.cursor(f)}});return a.changes.empty?!1:(e(o.update(a,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(o){let e=[],a=-1;for(let l of o.selection.ranges){let u=o.doc.lineAt(l.from),p=o.doc.lineAt(l.to);if(!l.empty&&l.to==p.from&&(p=o.doc.lineAt(l.to-1)),a>=u.number){let d=e[e.length-1];d.to=p.to,d.ranges.push(l)}else e.push({from:u.from,to:p.to,ranges:[l]});a=p.number+1}return e}function moveLine(o,e,a){if(o.readOnly)return!1;let l=[],u=[];for(let p of selectedLineBlocks(o)){if(a?p.to==o.doc.length:p.from==0)continue;let d=o.doc.lineAt(a?p.to+1:p.from-1),f=d.length+1;if(a){l.push({from:p.to,to:d.to},{from:p.from,insert:d.text+o.lineBreak});for(let g of p.ranges)u.push(EditorSelection.range(Math.min(o.doc.length,g.anchor+f),Math.min(o.doc.length,g.head+f)))}else{l.push({from:d.from,to:p.from},{from:p.to,insert:o.lineBreak+d.text});for(let g of p.ranges)u.push(EditorSelection.range(g.anchor-f,g.head-f))}}return l.length?(e(o.update({changes:l,scrollIntoView:!0,selection:EditorSelection.create(u,o.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:o,dispatch:e})=>moveLine(o,e,!1),moveLineDown=({state:o,dispatch:e})=>moveLine(o,e,!0);function copyLine(o,e,a){if(o.readOnly)return!1;let l=[];for(let u of selectedLineBlocks(o))a?l.push({from:u.from,insert:o.doc.slice(u.from,u.to)+o.lineBreak}):l.push({from:u.to,insert:o.lineBreak+o.doc.slice(u.from,u.to)});return e(o.update({changes:l,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:o,dispatch:e})=>copyLine(o,e,!1),copyLineDown=({state:o,dispatch:e})=>copyLine(o,e,!0),deleteLine=o=>{if(o.state.readOnly)return!1;let{state:e}=o,a=e.changes(selectedLineBlocks(e).map(({from:u,to:p})=>(u>0?u--:p<e.doc.length&&p++,{from:u,to:p}))),l=updateSel(e.selection,u=>{let p;if(o.lineWrapping){let d=o.lineBlockAt(u.head),f=o.coordsAtPos(u.head,u.assoc||1);f&&(p=d.bottom+o.documentTop-f.bottom+o.defaultLineHeight/2)}return o.moveVertically(u,!0,p)}).map(a);return o.dispatch({changes:a,selection:l,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(o,e){if(/\(\)|\[\]|\{\}/.test(o.sliceDoc(e-1,e+1)))return{from:e,to:e};let a=syntaxTree(o).resolveInner(e),l=a.childBefore(e),u=a.childAfter(e),p;return l&&u&&l.to<=e&&u.from>=e&&(p=l.type.prop(NodeProp.closedBy))&&p.indexOf(u.name)>-1&&o.doc.lineAt(l.to).from==o.doc.lineAt(u.from).from&&!/\S/.test(o.sliceDoc(l.to,u.from))?{from:l.to,to:u.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(o){return({state:e,dispatch:a})=>{if(e.readOnly)return!1;let l=e.changeByRange(u=>{let{from:p,to:d}=u,f=e.doc.lineAt(p),g=!o&&p==d&&isBetweenBrackets(e,p);o&&(p=d=(d<=f.to?f:e.doc.lineAt(d)).to);let b=new IndentContext(e,{simulateBreak:p,simulateDoubleBreak:!!g}),A=getIndentation(b,p);for(A==null&&(A=countColumn(/^\s*/.exec(e.doc.lineAt(p).text)[0],e.tabSize));d<f.to&&/\s/.test(f.text[d-f.from]);)d++;g?{from:p,to:d}=g:p>f.from&&p<f.from+100&&!/\S/.test(f.text.slice(0,p))&&(p=f.from);let S=["",indentString(e,A)];return g&&S.push(indentString(e,b.lineIndent(f.from,-1))),{changes:{from:p,to:d,insert:Text.of(S)},range:EditorSelection.cursor(p+1+S[1].length)}});return a(e.update(l,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(o,e){let a=-1;return o.changeByRange(l=>{let u=[];for(let d=l.from;d<=l.to;){let f=o.doc.lineAt(d);f.number>a&&(l.empty||l.to>f.from)&&(e(f,u,l),a=f.number),d=f.to+1}let p=o.changes(u);return{changes:u,range:EditorSelection.range(p.mapPos(l.anchor,1),p.mapPos(l.head,1))}})}const indentSelection=({state:o,dispatch:e})=>{if(o.readOnly)return!1;let a=Object.create(null),l=new IndentContext(o,{overrideIndentation:p=>{let d=a[p];return d??-1}}),u=changeBySelectedLine(o,(p,d,f)=>{let g=getIndentation(l,p.from);if(g==null)return;/\S/.test(p.text)||(g=0);let b=/^\s*/.exec(p.text)[0],A=indentString(o,g);(b!=A||f.from<p.from+b.length)&&(a[p.from]=g,d.push({from:p.from,to:p.from+b.length,insert:A}))});return u.changes.empty||e(o.update(u,{userEvent:"indent"})),!0},indentMore=({state:o,dispatch:e})=>o.readOnly?!1:(e(o.update(changeBySelectedLine(o,(a,l)=>{l.push({from:a.from,insert:o.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:o,dispatch:e})=>o.readOnly?!1:(e(o.update(changeBySelectedLine(o,(a,l)=>{let u=/^\s*/.exec(a.text)[0];if(!u)return;let p=countColumn(u,o.tabSize),d=0,f=indentString(o,Math.max(0,p-getIndentUnit(o)));for(;d<u.length&&d<f.length&&u.charCodeAt(d)==f.charCodeAt(d);)d++;l.push({from:a.from+d,to:a.from+u.length,insert:f.slice(d)})}),{userEvent:"delete.dedent"})),!0),toggleTabFocusMode=o=>(o.setTabFocusMode(),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent,shift:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward,preventDefault:!0},{key:"Delete",run:deleteCharForward,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward,preventDefault:!0},{mac:"Mod-Backspace",run:deleteLineBoundaryBackward,preventDefault:!0},{mac:"Mod-Delete",run:deleteLineBoundaryForward,preventDefault:!0}].concat(emacsStyleKeymap.map(o=>({mac:o.key,run:o.run,shift:o.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Mod-Alt-ArrowUp",run:addCursorAbove},{key:"Mod-Alt-ArrowDown",run:addCursorBelow},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment},{key:"Ctrl-m",mac:"Shift-Alt-m",run:toggleTabFocusMode}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess},basicNormalize=typeof String.prototype.normalize=="function"?o=>o.normalize("NFKD"):o=>o;class SearchCursor{constructor(e,a,l=0,u=e.length,p,d){this.test=d,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(l,u),this.bufferStart=l,this.normalize=p?f=>p(basicNormalize(f)):basicNormalize,this.query=this.normalize(a)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let a=fromCodePoint(e),l=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(e);let u=this.normalize(a);if(u.length)for(let p=0,d=l;;p++){let f=u.charCodeAt(p),g=this.match(f,d,this.bufferPos+this.bufferStart);if(p==u.length-1){if(g)return this.value=g,this;break}d==l&&p<a.length&&a.charCodeAt(p)==f&&d++}}}match(e,a,l){let u=null;for(let p=0;p<this.matches.length;p+=2){let d=this.matches[p],f=!1;this.query.charCodeAt(d)==e&&(d==this.query.length-1?u={from:this.matches[p+1],to:l}:(this.matches[p]++,f=!0)),f||(this.matches.splice(p,2),p-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?u={from:a,to:l}:this.matches.push(1,a)),u&&this.test&&!this.test(u.from,u.to,this.buffer,this.bufferStart)&&(u=null),u}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty$2={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(e,a,l,u=0,p=e.length){if(this.text=e,this.to=p,this.curLine="",this.done=!1,this.value=empty$2,/\\[sWDnr]|\n|\r|\[\^/.test(a))return new MultilineRegExpCursor(e,a,l,u,p);this.re=new RegExp(a,baseFlags+(l?.ignoreCase?"i":"")),this.test=l?.test,this.iter=e.iter();let d=e.lineAt(u);this.curLineStart=d.from,this.matchPos=toCharEnd(e,u),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let a=this.matchPos<=this.to&&this.re.exec(this.curLine);if(a){let l=this.curLineStart+a.index,u=l+a[0].length;if(this.matchPos=toCharEnd(this.text,u+(l==u?1:0)),l==this.curLineStart+this.curLine.length&&this.nextLine(),(l<u||l>this.value.to)&&(!this.test||this.test(l,u,a)))return this.value={from:l,to:u,match:a},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(e,a){this.from=e,this.text=a}get to(){return this.from+this.text.length}static get(e,a,l){let u=flattened.get(e);if(!u||u.from>=l||u.to<=a){let f=new FlattenedDoc(a,e.sliceString(a,l));return flattened.set(e,f),f}if(u.from==a&&u.to==l)return u;let{text:p,from:d}=u;return d>a&&(p=e.sliceString(a,d)+p,d=a),u.to<l&&(p+=e.sliceString(u.to,l)),flattened.set(e,new FlattenedDoc(d,p)),new FlattenedDoc(a,p.slice(a-d,l-d))}}class MultilineRegExpCursor{constructor(e,a,l,u,p){this.text=e,this.to=p,this.done=!1,this.value=empty$2,this.matchPos=toCharEnd(e,u),this.re=new RegExp(a,baseFlags+(l?.ignoreCase?"i":"")),this.test=l?.test,this.flat=FlattenedDoc.get(e,u,this.chunkEnd(u+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,a=this.re.exec(this.flat.text);if(a&&!a[0]&&a.index==e&&(this.re.lastIndex=e+1,a=this.re.exec(this.flat.text)),a){let l=this.flat.from+a.index,u=l+a[0].length;if((this.flat.to>=this.to||a.index+a[0].length<=this.flat.text.length-10)&&(!this.test||this.test(l,u,a)))return this.value={from:l,to:u,match:a},this.matchPos=toCharEnd(this.text,u+(l==u?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(o){try{return new RegExp(o,baseFlags),!0}catch{return!1}}function toCharEnd(o,e){if(e>=o.length)return e;let a=o.lineAt(e),l;for(;e<a.to&&(l=a.text.charCodeAt(e-a.from))>=56320&&l<57344;)e++;return e}function createLineDialog(o){let e=String(o.state.doc.lineAt(o.state.selection.main.head).number),a=crelt("input",{class:"cm-textfield",name:"line",value:e}),l=crelt("form",{class:"cm-gotoLine",onkeydown:p=>{p.keyCode==27?(p.preventDefault(),o.dispatch({effects:dialogEffect.of(!1)}),o.focus()):p.keyCode==13&&(p.preventDefault(),u())},onsubmit:p=>{p.preventDefault(),u()}},crelt("label",o.state.phrase("Go to line"),": ",a)," ",crelt("button",{class:"cm-button",type:"submit"},o.state.phrase("go")),crelt("button",{name:"close",onclick:()=>{o.dispatch({effects:dialogEffect.of(!1)}),o.focus()},"aria-label":o.state.phrase("close"),type:"button"},["×"]));function u(){let p=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(a.value);if(!p)return;let{state:d}=o,f=d.doc.lineAt(d.selection.main.head),[,g,b,A,S]=p,M=A?+A.slice(1):0,E=b?+b:f.number;if(b&&S){let Z=E/100;g&&(Z=Z*(g=="-"?-1:1)+f.number/d.doc.lines),E=Math.round(d.doc.lines*Z)}else b&&g&&(E=E*(g=="-"?-1:1)+f.number);let F=d.doc.line(Math.max(1,Math.min(d.doc.lines,E))),$=EditorSelection.cursor(F.from+Math.max(0,Math.min(M,F.length)));o.dispatch({effects:[dialogEffect.of(!1),EditorView.scrollIntoView($.from,{y:"center"})],selection:$}),o.focus()}return{dom:l}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(o,e){for(let a of e.effects)a.is(dialogEffect)&&(o=a.value);return o},provide:o=>showPanel.from(o,e=>e?createLineDialog:null)}),gotoLine=o=>{let e=getPanel(o,createLineDialog);if(!e){let a=[dialogEffect.of(!0)];o.state.field(dialogField,!1)==null&&a.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),o.dispatch({effects:a}),e=getPanel(o,createLineDialog)}return e&&e.dom.querySelector("input").select(),!0},baseTheme$1$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine(o){return combineConfig(o,defaultHighlightOptions,{highlightWordAroundCursor:(e,a)=>e||a,minSelectionLength:Math.min,maxMatches:Math.min})}});function highlightSelectionMatches(o){return[defaultTheme,matchHighlighter]}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(o,e,a,l){return(a==0||o(e.sliceDoc(a-1,a))!=CharCategory.Word)&&(l==e.doc.length||o(e.sliceDoc(l,l+1))!=CharCategory.Word)}function insideWord(o,e,a,l){return o(e.sliceDoc(a,a+1))==CharCategory.Word&&o(e.sliceDoc(l-1,l))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.selectionSet||o.docChanged||o.viewportChanged)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let e=o.state.facet(highlightConfig),{state:a}=o,l=a.selection;if(l.ranges.length>1)return Decoration.none;let u=l.main,p,d=null;if(u.empty){if(!e.highlightWordAroundCursor)return Decoration.none;let g=a.wordAt(u.head);if(!g)return Decoration.none;d=a.charCategorizer(u.head),p=a.sliceDoc(g.from,g.to)}else{let g=u.to-u.from;if(g<e.minSelectionLength||g>200)return Decoration.none;if(e.wholeWords){if(p=a.sliceDoc(u.from,u.to),d=a.charCategorizer(u.head),!(insideWordBoundaries(d,a,u.from,u.to)&&insideWord(d,a,u.from,u.to)))return Decoration.none}else if(p=a.sliceDoc(u.from,u.to),!p)return Decoration.none}let f=[];for(let g of o.visibleRanges){let b=new SearchCursor(a.doc,p,g.from,g.to);for(;!b.next().done;){let{from:A,to:S}=b.value;if((!d||insideWordBoundaries(d,a,A,S))&&(u.empty&&A<=u.from&&S>=u.to?f.push(mainMatchDeco.range(A,S)):(A>=u.to||S<=u.from)&&f.push(matchDeco.range(A,S)),f.length>e.maxMatches))return Decoration.none}}return Decoration.set(f)}},{decorations:o=>o.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:o,dispatch:e})=>{let{selection:a}=o,l=EditorSelection.create(a.ranges.map(u=>o.wordAt(u.head)||EditorSelection.cursor(u.head)),a.mainIndex);return l.eq(a)?!1:(e(o.update({selection:l})),!0)};function findNextOccurrence(o,e){let{main:a,ranges:l}=o.selection,u=o.wordAt(a.head),p=u&&u.from==a.from&&u.to==a.to;for(let d=!1,f=new SearchCursor(o.doc,e,l[l.length-1].to);;)if(f.next(),f.done){if(d)return null;f=new SearchCursor(o.doc,e,0,Math.max(0,l[l.length-1].from-1)),d=!0}else{if(d&&l.some(g=>g.from==f.value.from))continue;if(p){let g=o.wordAt(f.value.from);if(!g||g.from!=f.value.from||g.to!=f.value.to)continue}return f.value}}const selectNextOccurrence=({state:o,dispatch:e})=>{let{ranges:a}=o.selection;if(a.some(p=>p.from===p.to))return selectWord({state:o,dispatch:e});let l=o.sliceDoc(a[0].from,a[0].to);if(o.selection.ranges.some(p=>o.sliceDoc(p.from,p.to)!=l))return!1;let u=findNextOccurrence(o,l);return u?(e(o.update({selection:o.selection.addRange(EditorSelection.range(u.from,u.to),!1),effects:EditorView.scrollIntoView(u.to)})),!0):!1},searchConfigFacet=Facet.define({combine(o){return combineConfig(o,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new SearchPanel(e),scrollToMatch:e=>EditorView.scrollIntoView(e)})}});function search(o){return searchExtensions}class SearchQuery{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(a,l)=>l=="n"?`
`:l=="r"?"\r":l=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(e,a=0,l){let u=e.doc?e:EditorState.create({doc:e});return l==null&&(l=u.doc.length),this.regexp?regexpCursor(this,u,a,l):stringCursor(this,u,a,l)}}class QueryType{constructor(e){this.spec=e}}function stringCursor(o,e,a,l){return new SearchCursor(e.doc,o.unquoted,a,l,o.caseSensitive?void 0:u=>u.toLowerCase(),o.wholeWord?stringWordTest(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function stringWordTest(o,e){return(a,l,u,p)=>((p>a||p+u.length<l)&&(p=Math.max(0,a-2),u=o.sliceString(p,Math.min(o.length,l+2))),(e(charBefore(u,a-p))!=CharCategory.Word||e(charAfter(u,a-p))!=CharCategory.Word)&&(e(charAfter(u,l-p))!=CharCategory.Word||e(charBefore(u,l-p))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(e){super(e)}nextMatch(e,a,l){let u=stringCursor(this.spec,e,l,e.doc.length).nextOverlapping();if(u.done){let p=Math.min(e.doc.length,a+this.spec.unquoted.length);u=stringCursor(this.spec,e,0,p).nextOverlapping()}return u.done||u.value.from==a&&u.value.to==l?null:u.value}prevMatchInRange(e,a,l){for(let u=l;;){let p=Math.max(a,u-1e4-this.spec.unquoted.length),d=stringCursor(this.spec,e,p,u),f=null;for(;!d.nextOverlapping().done;)f=d.value;if(f)return f;if(p==a)return null;u-=1e4}}prevMatch(e,a,l){let u=this.prevMatchInRange(e,0,a);return u||(u=this.prevMatchInRange(e,Math.max(0,l-this.spec.unquoted.length),e.doc.length)),u&&(u.from!=a||u.to!=l)?u:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,a){let l=stringCursor(this.spec,e,0,e.doc.length),u=[];for(;!l.next().done;){if(u.length>=a)return null;u.push(l.value)}return u}highlight(e,a,l,u){let p=stringCursor(this.spec,e,Math.max(0,a-this.spec.unquoted.length),Math.min(l+this.spec.unquoted.length,e.doc.length));for(;!p.next().done;)u(p.value.from,p.value.to)}}function regexpCursor(o,e,a,l){return new RegExpCursor(e.doc,o.search,{ignoreCase:!o.caseSensitive,test:o.wholeWord?regexpWordTest(e.charCategorizer(e.selection.main.head)):void 0},a,l)}function charBefore(o,e){return o.slice(findClusterBreak(o,e,!1),e)}function charAfter(o,e){return o.slice(e,findClusterBreak(o,e))}function regexpWordTest(o){return(e,a,l)=>!l[0].length||(o(charBefore(l.input,l.index))!=CharCategory.Word||o(charAfter(l.input,l.index))!=CharCategory.Word)&&(o(charAfter(l.input,l.index+l[0].length))!=CharCategory.Word||o(charBefore(l.input,l.index+l[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(e,a,l){let u=regexpCursor(this.spec,e,l,e.doc.length).next();return u.done&&(u=regexpCursor(this.spec,e,0,a).next()),u.done?null:u.value}prevMatchInRange(e,a,l){for(let u=1;;u++){let p=Math.max(a,l-u*1e4),d=regexpCursor(this.spec,e,p,l),f=null;for(;!d.next().done;)f=d.value;if(f&&(p==a||f.from>p+10))return f;if(p==a)return null}}prevMatch(e,a,l){return this.prevMatchInRange(e,0,a)||this.prevMatchInRange(e,l,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(a,l)=>{if(l=="&")return e.match[0];if(l=="$")return"$";for(let u=l.length;u>0;u--){let p=+l.slice(0,u);if(p>0&&p<e.match.length)return e.match[p]+l.slice(u)}return a})}matchAll(e,a){let l=regexpCursor(this.spec,e,0,e.doc.length),u=[];for(;!l.next().done;){if(u.length>=a)return null;u.push(l.value)}return u}highlight(e,a,l,u){let p=regexpCursor(this.spec,e,Math.max(0,a-250),Math.min(l+250,e.doc.length));for(;!p.next().done;)u(p.value.from,p.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create(o){return new SearchState(defaultQuery(o).create(),null)},update(o,e){for(let a of e.effects)a.is(setSearchQuery)?o=new SearchState(a.value.create(),o.panel):a.is(togglePanel$1)&&(o=new SearchState(o.query,a.value?createSearchPanel:null));return o},provide:o=>showPanel.from(o,e=>e.panel)});class SearchState{constructor(e,a){this.query=e,this.panel=a}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(o){this.view=o,this.decorations=this.highlight(o.state.field(searchState))}update(o){let e=o.state.field(searchState);(e!=o.startState.field(searchState)||o.docChanged||o.selectionSet||o.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:o,panel:e}){if(!e||!o.spec.valid)return Decoration.none;let{view:a}=this,l=new RangeSetBuilder;for(let u=0,p=a.visibleRanges,d=p.length;u<d;u++){let{from:f,to:g}=p[u];for(;u<d-1&&g>p[u+1].from-500;)g=p[++u].to;o.highlight(a.state,f,g,(b,A)=>{let S=a.state.selection.ranges.some(M=>M.from==b&&M.to==A);l.add(b,A,S?selectedMatchMark:matchMark)})}return l.finish()}},{decorations:o=>o.decorations});function searchCommand(o){return e=>{let a=e.state.field(searchState,!1);return a&&a.query.spec.valid?o(e,a):openSearchPanel(e)}}const findNext=searchCommand((o,{query:e})=>{let{to:a}=o.state.selection.main,l=e.nextMatch(o.state,a,a);if(!l)return!1;let u=EditorSelection.single(l.from,l.to),p=o.state.facet(searchConfigFacet);return o.dispatch({selection:u,effects:[announceMatch(o,l),p.scrollToMatch(u.main,o)],userEvent:"select.search"}),selectSearchInput(o),!0}),findPrevious=searchCommand((o,{query:e})=>{let{state:a}=o,{from:l}=a.selection.main,u=e.prevMatch(a,l,l);if(!u)return!1;let p=EditorSelection.single(u.from,u.to),d=o.state.facet(searchConfigFacet);return o.dispatch({selection:p,effects:[announceMatch(o,u),d.scrollToMatch(p.main,o)],userEvent:"select.search"}),selectSearchInput(o),!0}),selectMatches=searchCommand((o,{query:e})=>{let a=e.matchAll(o.state,1e3);return!a||!a.length?!1:(o.dispatch({selection:EditorSelection.create(a.map(l=>EditorSelection.range(l.from,l.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:o,dispatch:e})=>{let a=o.selection;if(a.ranges.length>1||a.main.empty)return!1;let{from:l,to:u}=a.main,p=[],d=0;for(let f=new SearchCursor(o.doc,o.sliceDoc(l,u));!f.next().done;){if(p.length>1e3)return!1;f.value.from==l&&(d=p.length),p.push(EditorSelection.range(f.value.from,f.value.to))}return e(o.update({selection:EditorSelection.create(p,d),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((o,{query:e})=>{let{state:a}=o,{from:l,to:u}=a.selection.main;if(a.readOnly)return!1;let p=e.nextMatch(a,l,l);if(!p)return!1;let d=p,f=[],g,b,A=[];d.from==l&&d.to==u&&(b=a.toText(e.getReplacement(d)),f.push({from:d.from,to:d.to,insert:b}),d=e.nextMatch(a,d.from,d.to),A.push(EditorView.announce.of(a.phrase("replaced match on line $",a.doc.lineAt(l).number)+".")));let S=o.state.changes(f);return d&&(g=EditorSelection.single(d.from,d.to).map(S),A.push(announceMatch(o,d)),A.push(a.facet(searchConfigFacet).scrollToMatch(g.main,o))),o.dispatch({changes:S,selection:g,effects:A,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((o,{query:e})=>{if(o.state.readOnly)return!1;let a=e.matchAll(o.state,1e9).map(u=>{let{from:p,to:d}=u;return{from:p,to:d,insert:e.getReplacement(u)}});if(!a.length)return!1;let l=o.state.phrase("replaced $ matches",a.length)+".";return o.dispatch({changes:a,effects:EditorView.announce.of(l),userEvent:"input.replace.all"}),!0});function createSearchPanel(o){return o.state.facet(searchConfigFacet).createPanel(o)}function defaultQuery(o,e){var a,l,u,p,d;let f=o.selection.main,g=f.empty||f.to>f.from+100?"":o.sliceDoc(f.from,f.to);if(e&&!g)return e;let b=o.facet(searchConfigFacet);return new SearchQuery({search:((a=e?.literal)!==null&&a!==void 0?a:b.literal)?g:g.replace(/\n/g,"\\n"),caseSensitive:(l=e?.caseSensitive)!==null&&l!==void 0?l:b.caseSensitive,literal:(u=e?.literal)!==null&&u!==void 0?u:b.literal,regexp:(p=e?.regexp)!==null&&p!==void 0?p:b.regexp,wholeWord:(d=e?.wholeWord)!==null&&d!==void 0?d:b.wholeWord})}function getSearchInput(o){let e=getPanel(o,createSearchPanel);return e&&e.dom.querySelector("[main-field]")}function selectSearchInput(o){let e=getSearchInput(o);e&&e==o.root.activeElement&&e.select()}const openSearchPanel=o=>{let e=o.state.field(searchState,!1);if(e&&e.panel){let a=getSearchInput(o);if(a&&a!=o.root.activeElement){let l=defaultQuery(o.state,e.query.spec);l.valid&&o.dispatch({effects:setSearchQuery.of(l)}),a.focus(),a.select()}}else o.dispatch({effects:[togglePanel$1.of(!0),e?setSearchQuery.of(defaultQuery(o.state,e.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=o=>{let e=o.state.field(searchState,!1);if(!e||!e.panel)return!1;let a=getPanel(o,createSearchPanel);return a&&a.dom.contains(o.root.activeElement)&&o.focus(),o.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Mod-Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(e){this.view=e;let a=this.query=e.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:a.search,placeholder:phrase(e,"Find"),"aria-label":phrase(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:a.replace,placeholder:phrase(e,"Replace"),"aria-label":phrase(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:a.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:a.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:a.wholeWord,onchange:this.commit});function l(u,p,d){return crelt("button",{class:"cm-button",name:u,onclick:p,type:"button"},d)}this.dom=crelt("div",{onkeydown:u=>this.keydown(u),class:"cm-search"},[this.searchField,l("next",()=>findNext(e),[phrase(e,"next")]),l("prev",()=>findPrevious(e),[phrase(e,"previous")]),l("select",()=>selectMatches(e),[phrase(e,"all")]),crelt("label",null,[this.caseField,phrase(e,"match case")]),crelt("label",null,[this.reField,phrase(e,"regexp")]),crelt("label",null,[this.wordField,phrase(e,"by word")]),...e.state.readOnly?[]:[crelt("br"),this.replaceField,l("replace",()=>replaceNext(e),[phrase(e,"replace")]),l("replaceAll",()=>replaceAll(e),[phrase(e,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(e),"aria-label":phrase(e,"close"),type:"button"},["×"])])}commit(){let e=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:setSearchQuery.of(e)}))}keydown(e){runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(e){for(let a of e.transactions)for(let l of a.effects)l.is(setSearchQuery)&&!l.value.eq(this.query)&&this.setQuery(l.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(o,e){return o.state.phrase(e)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(o,{from:e,to:a}){let l=o.state.doc.lineAt(e),u=o.state.doc.lineAt(a).to,p=Math.max(l.from,e-AnnounceMargin),d=Math.min(u,a+AnnounceMargin),f=o.state.sliceDoc(p,d);if(p!=l.from){for(let g=0;g<AnnounceMargin;g++)if(!Break.test(f[g+1])&&Break.test(f[g])){f=f.slice(g);break}}if(d!=u){for(let g=f.length-1;g>f.length-AnnounceMargin;g--)if(!Break.test(f[g-1])&&Break.test(f[g])){f=f.slice(0,g);break}}return EditorView.announce.of(`${o.state.phrase("current match")}. ${f} ${o.state.phrase("on line")} ${l.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(e,a,l,u){this.state=e,this.pos=a,this.explicit=l,this.view=u,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let a=syntaxTree(this.state).resolveInner(this.pos,-1);for(;a&&e.indexOf(a.name)<0;)a=a.parent;return a?{from:a.from,to:this.pos,text:this.state.sliceDoc(a.from,this.pos),type:a.type}:null}matchBefore(e){let a=this.state.doc.lineAt(this.pos),l=Math.max(a.from,this.pos-250),u=a.text.slice(l-a.from,this.pos-a.from),p=u.search(ensureAnchor(e,!1));return p<0?null:{from:l+p,to:this.pos,text:u.slice(p)}}get aborted(){return this.abortListeners==null}addEventListener(e,a,l){e=="abort"&&this.abortListeners&&(this.abortListeners.push(a),l&&l.onDocChange&&(this.abortOnDocChange=!0))}}function toSet(o){let e=Object.keys(o).join(""),a=/\w/.test(e);return a&&(e=e.replace(/\w/g,"")),`[${a?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(o){let e=Object.create(null),a=Object.create(null);for(let{label:u}of o){e[u[0]]=!0;for(let p=1;p<u.length;p++)a[u[p]]=!0}let l=toSet(e)+toSet(a)+"*$";return[new RegExp("^"+l),new RegExp(l)]}function completeFromList(o){let e=o.map(u=>typeof u=="string"?{label:u}:u),[a,l]=e.every(u=>/^\w+$/.test(u.label))?[/\w*$/,/\w+$/]:prefixMatch(e);return u=>{let p=u.matchBefore(l);return p||u.explicit?{from:p?p.from:u.pos,options:e,validFor:a}:null}}function ifNotIn(o,e){return a=>{for(let l=syntaxTree(a.state).resolveInner(a.pos,-1);l;l=l.parent){if(o.indexOf(l.name)>-1)return null;if(l.type.isTop)break}return e(a)}}class Option{constructor(e,a,l,u){this.completion=e,this.source=a,this.match=l,this.score=u}}function cur(o){return o.selection.main.from}function ensureAnchor(o,e){var a;let{source:l}=o,u=e&&l[0]!="^",p=l[l.length-1]!="$";return!u&&!p?o:new RegExp(`${u?"^":""}(?:${l})${p?"$":""}`,(a=o.flags)!==null&&a!==void 0?a:o.ignoreCase?"i":"")}const pickedCompletion=Annotation.define();function insertCompletionText(o,e,a,l){let{main:u}=o.selection,p=a-u.from,d=l-u.from;return{...o.changeByRange(f=>{if(f!=u&&a!=l&&o.sliceDoc(f.from+p,f.from+d)!=o.sliceDoc(a,l))return{range:f};let g=o.toText(e);return{changes:{from:f.from+p,to:l==u.from?f.to:f.from+d,insert:g},range:EditorSelection.cursor(f.from+p+g.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const SourceCache=new WeakMap;function asSource(o){if(!Array.isArray(o))return o;let e=SourceCache.get(o);return e||SourceCache.set(o,e=completeFromList(o)),e}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let a=0;a<e.length;){let l=codePointAt(e,a),u=codePointSize(l);this.chars.push(l);let p=e.slice(a,a+u),d=p.toUpperCase();this.folded.push(codePointAt(d==p?p.toLowerCase():d,0)),a+=u}this.astral=e.length!=this.chars.length}ret(e,a){return this.score=e,this.matched=a,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:a,folded:l,any:u,precise:p,byWord:d}=this;if(a.length==1){let K=codePointAt(e,0),se=codePointSize(K),z=se==e.length?0:-100;if(K!=a[0])if(K==l[0])z+=-200;else return null;return this.ret(z,[0,se])}let f=e.indexOf(this.pattern);if(f==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let g=a.length,b=0;if(f<0){for(let K=0,se=Math.min(e.length,200);K<se&&b<g;){let z=codePointAt(e,K);(z==a[b]||z==l[b])&&(u[b++]=K),K+=codePointSize(z)}if(b<g)return null}let A=0,S=0,M=!1,E=0,F=-1,$=-1,Z=/[a-z]/.test(e),V=!0;for(let K=0,se=Math.min(e.length,200),z=0;K<se&&S<g;){let U=codePointAt(e,K);f<0&&(A<g&&U==a[A]&&(p[A++]=K),E<g&&(U==a[E]||U==l[E]?(E==0&&(F=K),$=K+1,E++):E=0));let ee,ae=U<255?U>=48&&U<=57||U>=97&&U<=122?2:U>=65&&U<=90?1:0:(ee=fromCodePoint(U))!=ee.toLowerCase()?1:ee!=ee.toUpperCase()?2:0;(!K||ae==1&&Z||z==0&&ae!=0)&&(a[S]==U||l[S]==U&&(M=!0)?d[S++]=K:d.length&&(V=!1)),z=ae,K+=codePointSize(U)}return S==g&&d[0]==0&&V?this.result(-100+(M?-200:0),d,e):E==g&&F==0?this.ret(-200-e.length+($==e.length?0:-100),[0,$]):f>-1?this.ret(-700-e.length,[f,f+this.pattern.length]):E==g?this.ret(-900-e.length,[F,$]):S==g?this.result(-100+(M?-200:0)+-700+(V?0:-1100),d,e):a.length==2?null:this.result((u[0]?-700:0)+-200+-1100,u,e)}result(e,a,l){let u=[],p=0;for(let d of a){let f=d+(this.astral?codePointSize(codePointAt(l,d)):1);p&&u[p-1]==d?u[p-1]=f:(u[p++]=d,u[p++]=f)}return this.ret(e-l.length,u)}}class StrictMatcher{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let a=e.slice(0,this.pattern.length),l=a==this.pattern?0:a.toLowerCase()==this.folded?-200:null;return l==null?null:(this.matched=[0,a.length],this.score=l+(e.length==this.pattern.length?0:-100),this)}}const completionConfig=Facet.define({combine(o){return combineConfig(o,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,filterStrict:!1,compareCompletions:(e,a)=>(e.sortText||e.label).localeCompare(a.sortText||a.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,a)=>e&&a,closeOnBlur:(e,a)=>e&&a,icons:(e,a)=>e&&a,tooltipClass:(e,a)=>l=>joinClass(e(l),a(l)),optionClass:(e,a)=>l=>joinClass(e(l),a(l)),addToOptions:(e,a)=>e.concat(a),filterStrict:(e,a)=>e||a})}});function joinClass(o,e){return o?e?o+" "+e:o:e}function defaultPositionInfo(o,e,a,l,u,p){let d=o.textDirection==Direction.RTL,f=d,g=!1,b="top",A,S,M=e.left-u.left,E=u.right-e.right,F=l.right-l.left,$=l.bottom-l.top;if(f&&M<Math.min(F,E)?f=!1:!f&&E<Math.min(F,M)&&(f=!0),F<=(f?M:E))A=Math.max(u.top,Math.min(a.top,u.bottom-$))-e.top,S=Math.min(400,f?M:E);else{g=!0,S=Math.min(400,(d?e.right:u.right-e.left)-30);let K=u.bottom-e.bottom;K>=$||K>e.top?A=a.bottom-e.top:(b="bottom",A=e.bottom-a.top)}let Z=(e.bottom-e.top)/p.offsetHeight,V=(e.right-e.left)/p.offsetWidth;return{style:`${b}: ${A/Z}px; max-width: ${S/V}px`,class:"cm-completionInfo-"+(g?d?"left-narrow":"right-narrow":f?"left":"right")}}function optionContent(o){let e=o.addToOptions.slice();return o.icons&&e.push({render(a){let l=document.createElement("div");return l.classList.add("cm-completionIcon"),a.type&&l.classList.add(...a.type.split(/\s+/g).map(u=>"cm-completionIcon-"+u)),l.setAttribute("aria-hidden","true"),l},position:20}),e.push({render(a,l,u,p){let d=document.createElement("span");d.className="cm-completionLabel";let f=a.displayLabel||a.label,g=0;for(let b=0;b<p.length;){let A=p[b++],S=p[b++];A>g&&d.appendChild(document.createTextNode(f.slice(g,A)));let M=d.appendChild(document.createElement("span"));M.appendChild(document.createTextNode(f.slice(A,S))),M.className="cm-completionMatchedText",g=S}return g<f.length&&d.appendChild(document.createTextNode(f.slice(g))),d},position:50},{render(a){if(!a.detail)return null;let l=document.createElement("span");return l.className="cm-completionDetail",l.textContent=a.detail,l},position:80}),e.sort((a,l)=>a.position-l.position).map(a=>a.render)}function rangeAroundSelected(o,e,a){if(o<=a)return{from:0,to:o};if(e<0&&(e=0),e<=o>>1){let u=Math.floor(e/a);return{from:u*a,to:(u+1)*a}}let l=Math.floor((o-e)/a);return{from:o-(l+1)*a,to:o-l*a}}class CompletionTooltip{constructor(e,a,l){this.view=e,this.stateField=a,this.applyCompletion=l,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:g=>this.placeInfo(g),key:this},this.space=null,this.currentClass="";let u=e.state.field(a),{options:p,selected:d}=u.open,f=e.state.facet(completionConfig);this.optionContent=optionContent(f),this.optionClass=f.optionClass,this.tooltipClass=f.tooltipClass,this.range=rangeAroundSelected(p.length,d,f.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",g=>{let{options:b}=e.state.field(a).open;for(let A=g.target,S;A&&A!=this.dom;A=A.parentNode)if(A.nodeName=="LI"&&(S=/-(\d+)$/.exec(A.id))&&+S[1]<b.length){this.applyCompletion(e,b[+S[1]]),g.preventDefault();return}}),this.dom.addEventListener("focusout",g=>{let b=e.state.field(this.stateField,!1);b&&b.tooltip&&e.state.facet(completionConfig).closeOnBlur&&g.relatedTarget!=e.contentDOM&&e.dispatch({effects:closeCompletionEffect.of(null)})}),this.showOptions(p,u.id)}mount(){this.updateSel()}showOptions(e,a){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,a,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var a;let l=e.state.field(this.stateField),u=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),l!=u){let{options:p,selected:d,disabled:f}=l.open;(!u.open||u.open.options!=p)&&(this.range=rangeAroundSelected(p.length,d,e.state.facet(completionConfig).maxRenderedOptions),this.showOptions(p,l.id)),this.updateSel(),f!=((a=u.open)===null||a===void 0?void 0:a.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!f)}}updateTooltipClass(e){let a=this.tooltipClass(e);if(a!=this.currentClass){for(let l of this.currentClass.split(" "))l&&this.dom.classList.remove(l);for(let l of a.split(" "))l&&this.dom.classList.add(l);this.currentClass=a}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),a=e.open;(a.selected>-1&&a.selected<this.range.from||a.selected>=this.range.to)&&(this.range=rangeAroundSelected(a.options.length,a.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.showOptions(a.options,e.id));let l=this.updateSelectedOption(a.selected);if(l){this.destroyInfo();let{completion:u}=a.options[a.selected],{info:p}=u;if(!p)return;let d=typeof p=="string"?document.createTextNode(p):p(u);if(!d)return;"then"in d?d.then(f=>{f&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(f,u)}).catch(f=>logException(this.view.state,f,"completion info")):(this.addInfoPane(d,u),l.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,a){this.destroyInfo();let l=this.info=document.createElement("div");if(l.className="cm-tooltip cm-completionInfo",l.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)l.appendChild(e),this.infoDestroy=null;else{let{dom:u,destroy:p}=e;l.appendChild(u),this.infoDestroy=p||null}this.dom.appendChild(l),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let a=null;for(let l=this.list.firstChild,u=this.range.from;l;l=l.nextSibling,u++)l.nodeName!="LI"||!l.id?u--:u==e?l.hasAttribute("aria-selected")||(l.setAttribute("aria-selected","true"),a=l):l.hasAttribute("aria-selected")&&(l.removeAttribute("aria-selected"),l.removeAttribute("aria-describedby"));return a&&scrollIntoView(this.list,a),a}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let a=this.dom.getBoundingClientRect(),l=this.info.getBoundingClientRect(),u=e.getBoundingClientRect(),p=this.space;if(!p){let d=this.dom.ownerDocument.documentElement;p={left:0,top:0,right:d.clientWidth,bottom:d.clientHeight}}return u.top>Math.min(p.bottom,a.bottom)-10||u.bottom<Math.max(p.top,a.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,a,u,l,p,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,a,l){const u=document.createElement("ul");u.id=a,u.setAttribute("role","listbox"),u.setAttribute("aria-expanded","true"),u.setAttribute("aria-label",this.view.state.phrase("Completions")),u.addEventListener("mousedown",d=>{d.target==u&&d.preventDefault()});let p=null;for(let d=l.from;d<l.to;d++){let{completion:f,match:g}=e[d],{section:b}=f;if(b){let M=typeof b=="string"?b:b.name;if(M!=p&&(d>l.from||l.from==0))if(p=M,typeof b!="string"&&b.header)u.appendChild(b.header(b));else{let E=u.appendChild(document.createElement("completion-section"));E.textContent=M}}const A=u.appendChild(document.createElement("li"));A.id=a+"-"+d,A.setAttribute("role","option");let S=this.optionClass(f);S&&(A.className=S);for(let M of this.optionContent){let E=M(f,this.view.state,this.view,g);E&&A.appendChild(E)}}return l.from&&u.classList.add("cm-completionListIncompleteTop"),l.to<e.length&&u.classList.add("cm-completionListIncompleteBottom"),u}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function completionTooltip(o,e){return a=>new CompletionTooltip(a,o,e)}function scrollIntoView(o,e){let a=o.getBoundingClientRect(),l=e.getBoundingClientRect(),u=a.height/o.offsetHeight;l.top<a.top?o.scrollTop-=(a.top-l.top)/u:l.bottom>a.bottom&&(o.scrollTop+=(l.bottom-a.bottom)/u)}function score(o){return(o.boost||0)*100+(o.apply?10:0)+(o.info?5:0)+(o.type?1:0)}function sortOptions(o,e){let a=[],l=null,u=null,p=A=>{a.push(A);let{section:S}=A.completion;if(S){l||(l=[]);let M=typeof S=="string"?S:S.name;l.some(E=>E.name==M)||l.push(typeof S=="string"?{name:M}:S)}},d=e.facet(completionConfig);for(let A of o)if(A.hasResult()){let S=A.result.getMatch;if(A.result.filter===!1)for(let M of A.result.options)p(new Option(M,A.source,S?S(M):[],1e9-a.length));else{let M=e.sliceDoc(A.from,A.to),E,F=d.filterStrict?new StrictMatcher(M):new FuzzyMatcher(M);for(let $ of A.result.options)if(E=F.match($.label)){let Z=$.displayLabel?S?S($,E.matched):[]:E.matched,V=E.score+($.boost||0);if(p(new Option($,A.source,Z,V)),typeof $.section=="object"&&$.section.rank==="dynamic"){let{name:K}=$.section;u||(u=Object.create(null)),u[K]=Math.max(V,u[K]||-1e9)}}}}if(l){let A=Object.create(null),S=0,M=(E,F)=>(E.rank==="dynamic"&&F.rank==="dynamic"?u[F.name]-u[E.name]:0)||(typeof E.rank=="number"?E.rank:1e9)-(typeof F.rank=="number"?F.rank:1e9)||(E.name<F.name?-1:1);for(let E of l.sort(M))S-=1e5,A[E.name]=S;for(let E of a){let{section:F}=E.completion;F&&(E.score+=A[typeof F=="string"?F:F.name])}}let f=[],g=null,b=d.compareCompletions;for(let A of a.sort((S,M)=>M.score-S.score||b(S.completion,M.completion))){let S=A.completion;!g||g.label!=S.label||g.detail!=S.detail||g.type!=null&&S.type!=null&&g.type!=S.type||g.apply!=S.apply||g.boost!=S.boost?f.push(A):score(A.completion)>score(g)&&(f[f.length-1]=A),g=A.completion}return f}class CompletionDialog{constructor(e,a,l,u,p,d){this.options=e,this.attrs=a,this.tooltip=l,this.timestamp=u,this.selected=p,this.disabled=d}setSelected(e,a){return e==this.selected||e>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(a,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,a,l,u,p,d){if(u&&!d&&e.some(b=>b.isPending))return u.setDisabled();let f=sortOptions(e,a);if(!f.length)return u&&e.some(b=>b.isPending)?u.setDisabled():null;let g=a.facet(completionConfig).selectOnOpen?0:-1;if(u&&u.selected!=g&&u.selected!=-1){let b=u.options[u.selected].completion;for(let A=0;A<f.length;A++)if(f[A].completion==b){g=A;break}}return new CompletionDialog(f,makeAttrs(l,g),{pos:e.reduce((b,A)=>A.hasResult()?Math.min(b,A.from):b,1e8),create:createTooltip,above:p.aboveCursor},u?u.timestamp:Date.now(),g,!1)}map(e){return new CompletionDialog(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new CompletionDialog(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class CompletionState{constructor(e,a,l){this.active=e,this.id=a,this.open=l}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:a}=e,l=a.facet(completionConfig),p=(l.override||a.languageDataAt("autocomplete",cur(a)).map(asSource)).map(g=>(this.active.find(A=>A.source==g)||new ActiveSource(g,this.active.some(A=>A.state!=0)?1:0)).update(e,l));p.length==this.active.length&&p.every((g,b)=>g==this.active[b])&&(p=this.active);let d=this.open,f=e.effects.some(g=>g.is(setActiveEffect));d&&e.docChanged&&(d=d.map(e.changes)),e.selection||p.some(g=>g.hasResult()&&e.changes.touchesRange(g.from,g.to))||!sameResults(p,this.active)||f?d=CompletionDialog.build(p,a,this.id,d,l,f):d&&d.disabled&&!p.some(g=>g.isPending)&&(d=null),!d&&p.every(g=>!g.isPending)&&p.some(g=>g.hasResult())&&(p=p.map(g=>g.hasResult()?new ActiveSource(g.source,0):g));for(let g of e.effects)g.is(setSelectedEffect)&&(d=d&&d.setSelected(g.value,this.id));return p==this.active&&d==this.open?this:new CompletionState(p,this.id,d)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?baseAttrs:noAttrs}}function sameResults(o,e){if(o==e)return!0;for(let a=0,l=0;;){for(;a<o.length&&!o[a].hasResult();)a++;for(;l<e.length&&!e[l].hasResult();)l++;let u=a==o.length,p=l==e.length;if(u||p)return u==p;if(o[a++].result!=e[l++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"},noAttrs={};function makeAttrs(o,e){let a={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":o};return e>-1&&(a["aria-activedescendant"]=o+"-"+e),a}const none=[];function getUpdateType(o,e){if(o.isUserEvent("input.complete")){let l=o.annotation(pickedCompletion);if(l&&e.activateOnCompletion(l))return 12}let a=o.isUserEvent("input.type");return a&&e.activateOnTyping?5:a?1:o.isUserEvent("delete.backward")?2:o.selection?8:o.docChanged?16:0}class ActiveSource{constructor(e,a,l=!1){this.source=e,this.state=a,this.explicit=l}hasResult(){return!1}get isPending(){return this.state==1}update(e,a){let l=getUpdateType(e,a),u=this;(l&8||l&16&&this.touches(e))&&(u=new ActiveSource(u.source,0)),l&4&&u.state==0&&(u=new ActiveSource(this.source,1)),u=u.updateFor(e,l);for(let p of e.effects)if(p.is(startCompletionEffect))u=new ActiveSource(u.source,1,p.value);else if(p.is(closeCompletionEffect))u=new ActiveSource(u.source,0);else if(p.is(setActiveEffect))for(let d of p.value)d.source==u.source&&(u=d);return u}updateFor(e,a){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(cur(e.state))}}class ActiveResult extends ActiveSource{constructor(e,a,l,u,p,d){super(e,3,a),this.limit=l,this.result=u,this.from=p,this.to=d}hasResult(){return!0}updateFor(e,a){var l;if(!(a&3))return this.map(e.changes);let u=this.result;u.map&&!e.changes.empty&&(u=u.map(u,e.changes));let p=e.changes.mapPos(this.from),d=e.changes.mapPos(this.to,1),f=cur(e.state);if(f>d||!u||a&2&&(cur(e.startState)==this.from||f<this.limit))return new ActiveSource(this.source,a&4?1:0);let g=e.changes.mapPos(this.limit);return checkValid(u.validFor,e.state,p,d)?new ActiveResult(this.source,this.explicit,g,u,p,d):u.update&&(u=u.update(u,p,d,new CompletionContext(e.state,f,!1)))?new ActiveResult(this.source,this.explicit,g,u,u.from,(l=u.to)!==null&&l!==void 0?l:cur(e.state)):new ActiveSource(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ActiveResult(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ActiveSource(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function checkValid(o,e,a,l){if(!o)return!1;let u=e.sliceDoc(a,l);return typeof o=="function"?o(u,a,l,e):ensureAnchor(o,!0).test(u)}const setActiveEffect=StateEffect.define({map(o,e){return o.map(a=>a.map(e))}}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create(){return CompletionState.start()},update(o,e){return o.update(e)},provide:o=>[showTooltip.from(o,e=>e.tooltip),EditorView.contentAttributes.from(o,e=>e.attrs)]});function applyCompletion(o,e){const a=e.completion.apply||e.completion.label;let l=o.state.field(completionState).active.find(u=>u.source==e.source);return l instanceof ActiveResult?(typeof a=="string"?o.dispatch({...insertCompletionText(o.state,a,l.from,l.to),annotations:pickedCompletion.of(e.completion)}):a(o,e.completion,l.from,l.to),!0):!1}const createTooltip=completionTooltip(completionState,applyCompletion);function moveCompletionSelection(o,e="option"){return a=>{let l=a.state.field(completionState,!1);if(!l||!l.open||l.open.disabled||Date.now()-l.open.timestamp<a.state.facet(completionConfig).interactionDelay)return!1;let u=1,p;e=="page"&&(p=getTooltip(a,l.open.tooltip))&&(u=Math.max(2,Math.floor(p.dom.offsetHeight/p.dom.querySelector("li").offsetHeight)-1));let{length:d}=l.open.options,f=l.open.selected>-1?l.open.selected+u*(o?1:-1):o?0:d-1;return f<0?f=e=="page"?0:d-1:f>=d&&(f=e=="page"?d-1:0),a.dispatch({effects:setSelectedEffect.of(f)}),!0}}const acceptCompletion=o=>{let e=o.state.field(completionState,!1);return o.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<o.state.facet(completionConfig).interactionDelay?!1:applyCompletion(o,e.open.options[e.open.selected])},startCompletion=o=>o.state.field(completionState,!1)?(o.dispatch({effects:startCompletionEffect.of(!0)}),!0):!1,closeCompletion=o=>{let e=o.state.field(completionState,!1);return!e||!e.active.some(a=>a.state!=0)?!1:(o.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(e,a){this.active=e,this.context=a,this.time=Date.now(),this.updates=[],this.done=void 0}}const MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(o){this.view=o,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of o.state.field(completionState).active)e.isPending&&this.startQuery(e)}update(o){let e=o.state.field(completionState),a=o.state.facet(completionConfig);if(!o.selectionSet&&!o.docChanged&&o.startState.field(completionState)==e)return;let l=o.transactions.some(p=>{let d=getUpdateType(p,a);return d&8||(p.selection||p.docChanged)&&!(d&3)});for(let p=0;p<this.running.length;p++){let d=this.running[p];if(l||d.context.abortOnDocChange&&o.docChanged||d.updates.length+o.transactions.length>MaxUpdateCount&&Date.now()-d.time>MinAbortTime){for(let f of d.context.abortListeners)try{f()}catch(g){logException(this.view.state,g)}d.context.abortListeners=null,this.running.splice(p--,1)}else d.updates.push(...o.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),o.transactions.some(p=>p.effects.some(d=>d.is(startCompletionEffect)))&&(this.pendingStart=!0);let u=this.pendingStart?50:a.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(p=>p.isPending&&!this.running.some(d=>d.active.source==p.source))?setTimeout(()=>this.startUpdate(),u):-1,this.composing!=0)for(let p of o.transactions)p.isUserEvent("input.type")?this.composing=2:this.composing==2&&p.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:o}=this.view,e=o.field(completionState);for(let a of e.active)a.isPending&&!this.running.some(l=>l.active.source==a.source)&&this.startQuery(a);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(completionConfig).updateSyncTime))}startQuery(o){let{state:e}=this.view,a=cur(e),l=new CompletionContext(e,a,o.explicit,this.view),u=new RunningQuery(o,l);this.running.push(u),Promise.resolve(o.source(l)).then(p=>{u.context.aborted||(u.done=p||null,this.scheduleAccept())},p=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,p)})}scheduleAccept(){this.running.every(o=>o.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(completionConfig).updateSyncTime))}accept(){var o;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],a=this.view.state.facet(completionConfig),l=this.view.state.field(completionState);for(let u=0;u<this.running.length;u++){let p=this.running[u];if(p.done===void 0)continue;if(this.running.splice(u--,1),p.done){let f=cur(p.updates.length?p.updates[0].startState:this.view.state),g=Math.min(f,p.done.from+(p.active.explicit?0:1)),b=new ActiveResult(p.active.source,p.active.explicit,g,p.done,p.done.from,(o=p.done.to)!==null&&o!==void 0?o:f);for(let A of p.updates)b=b.update(A,a);if(b.hasResult()){e.push(b);continue}}let d=l.active.find(f=>f.source==p.active.source);if(d&&d.isPending)if(p.done==null){let f=new ActiveSource(p.active.source,0);for(let g of p.updates)f=f.update(g,a);f.isPending||e.push(f)}else this.startQuery(d)}(e.length||l.open&&l.open.disabled)&&this.view.dispatch({effects:setActiveEffect.of(e)})}},{eventHandlers:{blur(o){let e=this.view.state.field(completionState,!1);if(e&&e.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let a=e.open&&getTooltip(this.view,e.open.tooltip);(!a||!a.dom.contains(o.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:closeCompletionEffect.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20),this.composing=0}}}),windows=typeof navigator=="object"&&/Win/.test(navigator.platform),commitCharacters=Prec.highest(EditorView.domEventHandlers({keydown(o,e){let a=e.state.field(completionState,!1);if(!a||!a.open||a.open.disabled||a.open.selected<0||o.key.length>1||o.ctrlKey&&!(windows&&o.altKey)||o.metaKey)return!1;let l=a.open.options[a.open.selected],u=a.active.find(d=>d.source==l.source),p=l.completion.commitCharacters||u.result.commitCharacters;return p&&p.indexOf(o.key)>-1&&applyCompletion(e,l),!1}})),baseTheme$1=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class FieldPos{constructor(e,a,l,u){this.field=e,this.line=a,this.from=l,this.to=u}}class FieldRange{constructor(e,a,l){this.field=e,this.from=a,this.to=l}map(e){let a=e.mapPos(this.from,-1,MapMode.TrackDel),l=e.mapPos(this.to,1,MapMode.TrackDel);return a==null||l==null?null:new FieldRange(this.field,a,l)}}class Snippet{constructor(e,a){this.lines=e,this.fieldPositions=a}instantiate(e,a){let l=[],u=[a],p=e.doc.lineAt(a),d=/^\s*/.exec(p.text)[0];for(let g of this.lines){if(l.length){let b=d,A=/^\t*/.exec(g)[0].length;for(let S=0;S<A;S++)b+=e.facet(indentUnit);u.push(a+b.length-A),g=b+g.slice(A)}l.push(g),a+=g.length+1}let f=this.fieldPositions.map(g=>new FieldRange(g.field,u[g.line]+g.from,u[g.line]+g.to));return{text:l,ranges:f}}static parse(e){let a=[],l=[],u=[],p;for(let d of e.split(/\r\n?|\n/)){for(;p=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(d);){let f=p[1]?+p[1]:null,g=p[2]||p[3]||"",b=-1,A=g.replace(/\\[{}]/g,S=>S[1]);for(let S=0;S<a.length;S++)(f!=null?a[S].seq==f:A&&a[S].name==A)&&(b=S);if(b<0){let S=0;for(;S<a.length&&(f==null||a[S].seq!=null&&a[S].seq<f);)S++;a.splice(S,0,{seq:f,name:A}),b=S;for(let M of u)M.field>=b&&M.field++}for(let S of u)if(S.line==l.length&&S.from>p.index){let M=p[2]?3+(p[1]||"").length:2;S.from-=M,S.to-=M}u.push(new FieldPos(b,l.length,p.index,p.index+A.length)),d=d.slice(0,p.index)+g+d.slice(p.index+p[0].length)}d=d.replace(/\\([{}])/g,(f,g,b)=>{for(let A of u)A.line==l.length&&A.from>b&&(A.from--,A.to--);return g}),l.push(d)}return new Snippet(l,u)}}let fieldMarker=Decoration.widget({widget:new class extends WidgetType{toDOM(){let o=document.createElement("span");return o.className="cm-snippetFieldPosition",o}ignoreEvent(){return!1}}}),fieldRange=Decoration.mark({class:"cm-snippetField"});class ActiveSnippet{constructor(e,a){this.ranges=e,this.active=a,this.deco=Decoration.set(e.map(l=>(l.from==l.to?fieldMarker:fieldRange).range(l.from,l.to)),!0)}map(e){let a=[];for(let l of this.ranges){let u=l.map(e);if(!u)return null;a.push(u)}return new ActiveSnippet(a,this.active)}selectionInsideField(e){return e.ranges.every(a=>this.ranges.some(l=>l.field==this.active&&l.from<=a.from&&l.to>=a.to))}}const setActive=StateEffect.define({map(o,e){return o&&o.map(e)}}),moveToField=StateEffect.define(),snippetState=StateField.define({create(){return null},update(o,e){for(let a of e.effects){if(a.is(setActive))return a.value;if(a.is(moveToField)&&o)return new ActiveSnippet(o.ranges,a.value)}return o&&e.docChanged&&(o=o.map(e.changes)),o&&e.selection&&!o.selectionInsideField(e.selection)&&(o=null),o},provide:o=>EditorView.decorations.from(o,e=>e?e.deco:Decoration.none)});function fieldSelection(o,e){return EditorSelection.create(o.filter(a=>a.field==e).map(a=>EditorSelection.range(a.from,a.to)))}function snippet(o){let e=Snippet.parse(o);return(a,l,u,p)=>{let{text:d,ranges:f}=e.instantiate(a.state,u),{main:g}=a.state.selection,b={changes:{from:u,to:p==g.from?g.to:p,insert:Text.of(d)},scrollIntoView:!0,annotations:l?[pickedCompletion.of(l),Transaction.userEvent.of("input.complete")]:void 0};if(f.length&&(b.selection=fieldSelection(f,0)),f.some(A=>A.field>0)){let A=new ActiveSnippet(f,0),S=b.effects=[setActive.of(A)];a.state.field(snippetState,!1)===void 0&&S.push(StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme$1]))}a.dispatch(a.state.update(b))}}function moveField(o){return({state:e,dispatch:a})=>{let l=e.field(snippetState,!1);if(!l||o<0&&l.active==0)return!1;let u=l.active+o,p=o>0&&!l.ranges.some(d=>d.field==u+o);return a(e.update({selection:fieldSelection(l.ranges,u),effects:setActive.of(p?null:new ActiveSnippet(l.ranges,u)),scrollIntoView:!0})),!0}}const clearSnippet=({state:o,dispatch:e})=>o.field(snippetState,!1)?(e(o.update({effects:setActive.of(null)})),!0):!1,nextSnippetField=moveField(1),prevSnippetField=moveField(-1),defaultSnippetKeymap=[{key:"Tab",run:nextSnippetField,shift:prevSnippetField},{key:"Escape",run:clearSnippet}],snippetKeymap=Facet.define({combine(o){return o.length?o[0]:defaultSnippetKeymap}}),addSnippetKeymap=Prec.highest(keymap.compute([snippetKeymap],o=>o.facet(snippetKeymap)));function snippetCompletion(o,e){return{...e,apply:snippet(o)}}const snippetPointerHandler=EditorView.domEventHandlers({mousedown(o,e){let a=e.state.field(snippetState,!1),l;if(!a||(l=e.posAtCoords({x:o.clientX,y:o.clientY}))==null)return!1;let u=a.ranges.find(p=>p.from<=l&&p.to>=l);return!u||u.field==a.active?!1:(e.dispatch({selection:fieldSelection(a.ranges,u.field),effects:setActive.of(a.ranges.some(p=>p.field>u.field)?new ActiveSnippet(a.ranges,u.field):null),scrollIntoView:!0}),!0)}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(o,e){let a=e.mapPos(o,-1,MapMode.TrackAfter);return a??void 0}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1,closedBracket.endSide=-1;const bracketState=StateField.define({create(){return RangeSet.empty},update(o,e){if(o=o.map(e.changes),e.selection){let a=e.state.doc.lineAt(e.selection.main.head);o=o.update({filter:l=>l>=a.from&&l<=a.to})}for(let a of e.effects)a.is(closeBracketEffect)&&(o=o.update({add:[closedBracket.range(a.value,a.value+1)]}));return o}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>«»»«［］｛｝";function closing(o){for(let e=0;e<definedClosing.length;e+=2)if(definedClosing.charCodeAt(e)==o)return definedClosing.charAt(e+1);return fromCodePoint(o<128?o:o+1)}function config(o,e){return o.languageDataAt("closeBrackets",e)[0]||defaults}const android$1=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of((o,e,a,l)=>{if((android$1?o.composing:o.compositionStarted)||o.state.readOnly)return!1;let u=o.state.selection.main;if(l.length>2||l.length==2&&codePointSize(codePointAt(l,0))==1||e!=u.from||a!=u.to)return!1;let p=insertBracket(o.state,l);return p?(o.dispatch(p),!0):!1}),deleteBracketPair=({state:o,dispatch:e})=>{if(o.readOnly)return!1;let l=config(o,o.selection.main.head).brackets||defaults.brackets,u=null,p=o.changeByRange(d=>{if(d.empty){let f=prevChar(o.doc,d.head);for(let g of l)if(g==f&&nextChar(o.doc,d.head)==closing(codePointAt(g,0)))return{changes:{from:d.head-g.length,to:d.head+g.length},range:EditorSelection.cursor(d.head-g.length)}}return{range:u=d}});return u||e(o.update(p,{scrollIntoView:!0,userEvent:"delete.backward"})),!u};function insertBracket(o,e){let a=config(o,o.selection.main.head),l=a.brackets||defaults.brackets;for(let u of l){let p=closing(codePointAt(u,0));if(e==u)return p==u?handleSame(o,u,l.indexOf(u+u+u)>-1,a):handleOpen(o,u,p,a.before||defaults.before);if(e==p&&closedBracketAt(o,o.selection.main.from))return handleClose(o,u,p)}return null}function closedBracketAt(o,e){let a=!1;return o.field(bracketState).between(0,o.doc.length,l=>{l==e&&(a=!0)}),a}function nextChar(o,e){let a=o.sliceString(e,e+2);return a.slice(0,codePointSize(codePointAt(a,0)))}function prevChar(o,e){let a=o.sliceString(e-2,e);return codePointSize(codePointAt(a,0))==a.length?a:a.slice(1)}function handleOpen(o,e,a,l){let u=null,p=o.changeByRange(d=>{if(!d.empty)return{changes:[{insert:e,from:d.from},{insert:a,from:d.to}],effects:closeBracketEffect.of(d.to+e.length),range:EditorSelection.range(d.anchor+e.length,d.head+e.length)};let f=nextChar(o.doc,d.head);return!f||/\s/.test(f)||l.indexOf(f)>-1?{changes:{insert:e+a,from:d.head},effects:closeBracketEffect.of(d.head+e.length),range:EditorSelection.cursor(d.head+e.length)}:{range:u=d}});return u?null:o.update(p,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(o,e,a){let l=null,u=o.changeByRange(p=>p.empty&&nextChar(o.doc,p.head)==a?{changes:{from:p.head,to:p.head+a.length,insert:a},range:EditorSelection.cursor(p.head+a.length)}:l={range:p});return l?null:o.update(u,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(o,e,a,l){let u=l.stringPrefixes||defaults.stringPrefixes,p=null,d=o.changeByRange(f=>{if(!f.empty)return{changes:[{insert:e,from:f.from},{insert:e,from:f.to}],effects:closeBracketEffect.of(f.to+e.length),range:EditorSelection.range(f.anchor+e.length,f.head+e.length)};let g=f.head,b=nextChar(o.doc,g),A;if(b==e){if(nodeStart(o,g))return{changes:{insert:e+e,from:g},effects:closeBracketEffect.of(g+e.length),range:EditorSelection.cursor(g+e.length)};if(closedBracketAt(o,g)){let M=a&&o.sliceDoc(g,g+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:g,to:g+M.length,insert:M},range:EditorSelection.cursor(g+M.length)}}}else{if(a&&o.sliceDoc(g-2*e.length,g)==e+e&&(A=canStartStringAt(o,g-2*e.length,u))>-1&&nodeStart(o,A))return{changes:{insert:e+e+e+e,from:g},effects:closeBracketEffect.of(g+e.length),range:EditorSelection.cursor(g+e.length)};if(o.charCategorizer(g)(b)!=CharCategory.Word&&canStartStringAt(o,g,u)>-1&&!probablyInString(o,g,e,u))return{changes:{insert:e+e,from:g},effects:closeBracketEffect.of(g+e.length),range:EditorSelection.cursor(g+e.length)}}return{range:p=f}});return p?null:o.update(d,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(o,e){let a=syntaxTree(o).resolveInner(e+1);return a.parent&&a.from==e}function probablyInString(o,e,a,l){let u=syntaxTree(o).resolveInner(e,-1),p=l.reduce((d,f)=>Math.max(d,f.length),0);for(let d=0;d<5;d++){let f=o.sliceDoc(u.from,Math.min(u.to,u.from+a.length+p)),g=f.indexOf(a);if(!g||g>-1&&l.indexOf(f.slice(0,g))>-1){let A=u.firstChild;for(;A&&A.from==u.from&&A.to-A.from>a.length+g;){if(o.sliceDoc(A.to-a.length,A.to)==a)return!1;A=A.firstChild}return!0}let b=u.to==e&&u.parent;if(!b)break;u=b}return!1}function canStartStringAt(o,e,a){let l=o.charCategorizer(e);if(l(o.sliceDoc(e-1,e))!=CharCategory.Word)return e;for(let u of a){let p=e-u.length;if(o.sliceDoc(p,e)==u&&l(o.sliceDoc(p-1,p))!=CharCategory.Word)return p}return-1}function autocompletion(o={}){return[commitCharacters,completionState,completionConfig.of(o),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{mac:"Alt-`",run:startCompletion},{mac:"Alt-i",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],o=>o.facet(completionConfig).defaultKeymap?[completionKeymap]:[]));class SelectedDiagnostic{constructor(e,a,l){this.from=e,this.to=a,this.diagnostic=l}}class LintState{constructor(e,a,l){this.diagnostics=e,this.panel=a,this.selected=l}static init(e,a,l){let u=l.facet(lintConfig).markerFilter;u&&(e=u(e,l));let p=e.slice().sort((E,F)=>E.from-F.from||E.to-F.to),d=new RangeSetBuilder,f=[],g=0,b=l.doc.iter(),A=0,S=l.doc.length;for(let E=0;;){let F=E==p.length?null:p[E];if(!F&&!f.length)break;let $,Z;if(f.length)$=g,Z=f.reduce((se,z)=>Math.min(se,z.to),F&&F.from>$?F.from:1e8);else{if($=F.from,$>S)break;Z=F.to,f.push(F),E++}for(;E<p.length;){let se=p[E];if(se.from==$&&(se.to>se.from||se.to==$))f.push(se),E++,Z=Math.min(se.to,Z);else{Z=Math.min(se.from,Z);break}}Z=Math.min(Z,S);let V=!1;if(f.some(se=>se.from==$&&(se.to==Z||Z==S))&&(V=$==Z,!V&&Z-$<10)){let se=$-(A+b.value.length);se>0&&(b.next(se),A=$);for(let z=$;;){if(z>=Z){V=!0;break}if(!b.lineBreak&&A+b.value.length>z)break;z=A+b.value.length,A+=b.value.length,b.next()}}let K=maxSeverity(f);if(V)d.add($,$,Decoration.widget({widget:new DiagnosticWidget(K),diagnostics:f.slice()}));else{let se=f.reduce((z,U)=>U.markClass?z+" "+U.markClass:z,"");d.add($,Z,Decoration.mark({class:"cm-lintRange cm-lintRange-"+K+se,diagnostics:f.slice(),inclusiveEnd:f.some(z=>z.to>Z)}))}if(g=Z,g==S)break;for(let se=0;se<f.length;se++)f[se].to<=g&&f.splice(se--,1)}let M=d.finish();return new LintState(M,a,findDiagnostic(M))}}function findDiagnostic(o,e=null,a=0){let l=null;return o.between(a,1e9,(u,p,{spec:d})=>{if(!(e&&d.diagnostics.indexOf(e)<0))if(!l)l=new SelectedDiagnostic(u,p,e||d.diagnostics[0]);else{if(d.diagnostics.indexOf(l.diagnostic)<0)return!1;l=new SelectedDiagnostic(l.from,p,l.diagnostic)}}),l}function hideTooltip(o,e){let a=e.pos,l=e.end||a,u=o.state.facet(lintConfig).hideOn(o,a,l);if(u!=null)return u;let p=o.startState.doc.lineAt(e.pos);return!!(o.effects.some(d=>d.is(setDiagnosticsEffect))||o.changes.touchesRange(p.from,Math.max(p.to,l)))}function maybeEnableLint(o,e){return o.field(lintState,!1)?e:e.concat(StateEffect.appendConfig.of(lintExtensions))}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create(){return new LintState(Decoration.none,null,null)},update(o,e){if(e.docChanged&&o.diagnostics.size){let a=o.diagnostics.map(e.changes),l=null,u=o.panel;if(o.selected){let p=e.changes.mapPos(o.selected.from,1);l=findDiagnostic(a,o.selected.diagnostic,p)||findDiagnostic(a,null,p)}!a.size&&u&&e.state.facet(lintConfig).autoPanel&&(u=null),o=new LintState(a,u,l)}for(let a of e.effects)if(a.is(setDiagnosticsEffect)){let l=e.state.facet(lintConfig).autoPanel?a.value.length?LintPanel.open:null:o.panel;o=LintState.init(a.value,l,e.state)}else a.is(togglePanel)?o=new LintState(o.diagnostics,a.value?LintPanel.open:null,o.selected):a.is(movePanelSelection)&&(o=new LintState(o.diagnostics,o.panel,a.value));return o},provide:o=>[showPanel.from(o,e=>e.panel),EditorView.decorations.from(o,e=>e.diagnostics)]}),activeMark=Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(o,e,a){let{diagnostics:l}=o.state.field(lintState),u,p=-1,d=-1;l.between(e-(a<0?1:0),e+(a>0?1:0),(g,b,{spec:A})=>{if(e>=g&&e<=b&&(g==b||(e>g||a>0)&&(e<b||a<0)))return u=A.diagnostics,p=g,d=b,!1});let f=o.state.facet(lintConfig).tooltipFilter;return u&&f&&(u=f(u,o.state)),u?{pos:p,end:d,above:o.state.doc.lineAt(p).to<d,create(){return{dom:diagnosticsTooltip(o,u)}}}:null}function diagnosticsTooltip(o,e){return crelt("ul",{class:"cm-tooltip-lint"},e.map(a=>renderDiagnostic(o,a,!1)))}const openLintPanel=o=>{let e=o.state.field(lintState,!1);(!e||!e.panel)&&o.dispatch({effects:maybeEnableLint(o.state,[togglePanel.of(!0)])});let a=getPanel(o,LintPanel.open);return a&&a.dom.querySelector(".cm-panel-lint ul").focus(),!0},closeLintPanel=o=>{let e=o.state.field(lintState,!1);return!e||!e.panel?!1:(o.dispatch({effects:togglePanel.of(!1)}),!0)},nextDiagnostic=o=>{let e=o.state.field(lintState,!1);if(!e)return!1;let a=o.state.selection.main,l=e.diagnostics.iter(a.to+1);return!l.value&&(l=e.diagnostics.iter(0),!l.value||l.from==a.from&&l.to==a.to)?!1:(o.dispatch({selection:{anchor:l.from,head:l.to},scrollIntoView:!0}),!0)},lintConfig=Facet.define({combine(o){return{sources:o.map(e=>e.source).filter(e=>e!=null),...combineConfig(o.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:combineFilter,tooltipFilter:combineFilter,needsRefresh:(e,a)=>e?a?l=>e(l)||a(l):e:a,hideOn:(e,a)=>e?a?(l,u,p)=>e(l,u,p)||a(l,u,p):e:a,autoPanel:(e,a)=>e||a})}}});function combineFilter(o,e){return o?e?(a,l)=>e(o(a,l),l):o:e}function assignKeys(o){let e=[];if(o)e:for(let{name:a}of o){for(let l=0;l<a.length;l++){let u=a[l];if(/[a-zA-Z]/.test(u)&&!e.some(p=>p.toLowerCase()==u.toLowerCase())){e.push(u);continue e}}e.push("")}return e}function renderDiagnostic(o,e,a){var l;let u=a?assignKeys(e.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},crelt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(o):e.message),(l=e.actions)===null||l===void 0?void 0:l.map((p,d)=>{let f=!1,g=E=>{if(E.preventDefault(),f)return;f=!0;let F=findDiagnostic(o.state.field(lintState).diagnostics,e);F&&p.apply(o,F.from,F.to)},{name:b}=p,A=u[d]?b.indexOf(u[d]):-1,S=A<0?b:[b.slice(0,A),crelt("u",b.slice(A,A+1)),b.slice(A+1)],M=p.markClass?" "+p.markClass:"";return crelt("button",{type:"button",class:"cm-diagnosticAction"+M,onclick:g,onmousedown:g,"aria-label":` Action: ${b}${A<0?"":` (access key "${u[d]})"`}.`},S)}),e.source&&crelt("div",{class:"cm-diagnosticSource"},e.source))}class DiagnosticWidget extends WidgetType{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class PanelItem{constructor(e,a){this.diagnostic=a,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=renderDiagnostic(e,a,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(e){this.view=e,this.items=[];let a=u=>{if(u.keyCode==27)closeLintPanel(this.view),this.view.focus();else if(u.keyCode==38||u.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(u.keyCode==40||u.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(u.keyCode==36)this.moveSelection(0);else if(u.keyCode==35)this.moveSelection(this.items.length-1);else if(u.keyCode==13)this.view.focus();else if(u.keyCode>=65&&u.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:p}=this.items[this.selectedIndex],d=assignKeys(p.actions);for(let f=0;f<d.length;f++)if(d[f].toUpperCase().charCodeAt(0)==u.keyCode){let g=findDiagnostic(this.view.state.field(lintState).diagnostics,p);g&&p.actions[f].apply(e,g.from,g.to)}}else return;u.preventDefault()},l=u=>{for(let p=0;p<this.items.length;p++)this.items[p].dom.contains(u.target)&&this.moveSelection(p)};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:a,onclick:l}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(lintState).selected;if(!e)return-1;for(let a=0;a<this.items.length;a++)if(this.items[a].diagnostic==e.diagnostic)return a;return-1}update(){let{diagnostics:e,selected:a}=this.view.state.field(lintState),l=0,u=!1,p=null,d=new Set;for(e.between(0,this.view.state.doc.length,(f,g,{spec:b})=>{for(let A of b.diagnostics){if(d.has(A))continue;d.add(A);let S=-1,M;for(let E=l;E<this.items.length;E++)if(this.items[E].diagnostic==A){S=E;break}S<0?(M=new PanelItem(this.view,A),this.items.splice(l,0,M),u=!0):(M=this.items[S],S>l&&(this.items.splice(l,S-l),u=!0)),a&&M.diagnostic==a.diagnostic?M.dom.hasAttribute("aria-selected")||(M.dom.setAttribute("aria-selected","true"),p=M):M.dom.hasAttribute("aria-selected")&&M.dom.removeAttribute("aria-selected"),l++}});l<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)u=!0,this.items.pop();this.items.length==0&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),u=!0),p?(this.list.setAttribute("aria-activedescendant",p.id),this.view.requestMeasure({key:this,read:()=>({sel:p.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:f,panel:g})=>{let b=g.height/this.list.offsetHeight;f.top<g.top?this.list.scrollTop-=(g.top-f.top)/b:f.bottom>g.bottom&&(this.list.scrollTop+=(f.bottom-g.bottom)/b)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),u&&this.sync()}sync(){let e=this.list.firstChild;function a(){let l=e;e=l.nextSibling,l.remove()}for(let l of this.items)if(l.dom.parentNode==this.list){for(;e!=l.dom;)a();e=l.dom.nextSibling}else this.list.insertBefore(l.dom,e);for(;e;)a()}moveSelection(e){if(this.selectedIndex<0)return;let a=this.view.state.field(lintState),l=findDiagnostic(a.diagnostics,this.items[e].diagnostic);l&&this.view.dispatch({selection:{anchor:l.from,head:l.to},scrollIntoView:!0,effects:movePanelSelection.of(l)})}static open(e){return new LintPanel(e)}}function svg(o,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(o)}</svg>')`}function underline(o){return svg(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${o}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-hint":{backgroundImage:underline("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function severityWeight(o){return o=="error"?4:o=="warning"?3:o=="info"?2:1}function maxSeverity(o){let e="hint",a=1;for(let l of o){let u=severityWeight(l.severity);u>a&&(a=u,e=l.severity)}return e}const lintExtensions=[lintState,EditorView.decorations.compute([lintState],o=>{let{selected:e,panel:a}=o.field(lintState);return!e||!a||e.from==e.to?Decoration.none:Decoration.set([activeMark.range(e.from,e.to)])}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme];class Stack{constructor(e,a,l,u,p,d,f,g,b,A=0,S){this.p=e,this.stack=a,this.state=l,this.reducePos=u,this.pos=p,this.score=d,this.buffer=f,this.bufferBase=g,this.curContext=b,this.lookAhead=A,this.parent=S}toString(){return`[${this.stack.filter((e,a)=>a%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,a,l=0){let u=e.parser.context;return new Stack(e,[],a,l,l,0,[],0,u?new StackContext(u,u.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,a){this.stack.push(this.state,a,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var a;let l=e>>19,u=e&65535,{parser:p}=this.p,d=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),f=p.dynamicPrecedence(u);if(f&&(this.score+=f),l==0){this.pushState(p.getGoto(this.state,u,!0),this.reducePos),u<p.minRepeatTerm&&this.storeNode(u,this.reducePos,this.reducePos,d?8:4,!0),this.reduceContext(u,this.reducePos);return}let g=this.stack.length-(l-1)*3-(e&262144?6:0),b=g?this.stack[g-2]:this.p.ranges[0].from,A=this.reducePos-b;A>=2e3&&!(!((a=this.p.parser.nodeSet.types[u])===null||a===void 0)&&a.isAnonymous)&&(b==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=A):this.p.lastBigReductionSize<A&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=b,this.p.lastBigReductionSize=A));let S=g?this.stack[g-1]:0,M=this.bufferBase+this.buffer.length-S;if(u<p.minRepeatTerm||e&131072){let E=p.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(u,b,E,M+4,!0)}if(e&262144)this.state=this.stack[g];else{let E=this.stack[g-3];this.state=p.getGoto(E,u,!0)}for(;this.stack.length>g;)this.stack.pop();this.reduceContext(u,b)}storeNode(e,a,l,u=4,p=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let d=this,f=this.buffer.length;if(f==0&&d.parent&&(f=d.bufferBase-d.parent.bufferBase,d=d.parent),f>0&&d.buffer[f-4]==0&&d.buffer[f-1]>-1){if(a==l)return;if(d.buffer[f-2]>=a){d.buffer[f-2]=l;return}}}if(!p||this.pos==l)this.buffer.push(e,a,l,u);else{let d=this.buffer.length;if(d>0&&(this.buffer[d-4]!=0||this.buffer[d-1]<0)){let f=!1;for(let g=d;g>0&&this.buffer[g-2]>l;g-=4)if(this.buffer[g-1]>=0){f=!0;break}if(f)for(;d>0&&this.buffer[d-2]>l;)this.buffer[d]=this.buffer[d-4],this.buffer[d+1]=this.buffer[d-3],this.buffer[d+2]=this.buffer[d-2],this.buffer[d+3]=this.buffer[d-1],d-=4,u>4&&(u-=4)}this.buffer[d]=e,this.buffer[d+1]=a,this.buffer[d+2]=l,this.buffer[d+3]=u}}shift(e,a,l,u){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let p=e,{parser:d}=this.p;(u>this.pos||a<=d.maxNode)&&(this.pos=u,d.stateFlag(p,1)||(this.reducePos=u)),this.pushState(p,l),this.shiftContext(a,l),a<=d.maxNode&&this.buffer.push(a,l,u,4)}else this.pos=u,this.shiftContext(a,l),a<=this.p.parser.maxNode&&this.buffer.push(a,l,u,4)}apply(e,a,l,u){e&65536?this.reduce(e):this.shift(e,a,l,u)}useNode(e,a){let l=this.p.reused.length-1;(l<0||this.p.reused[l]!=e)&&(this.p.reused.push(e),l++);let u=this.pos;this.reducePos=this.pos=u+e.length,this.pushState(a,u),this.buffer.push(l,u,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,a=e.buffer.length;for(;a>0&&e.buffer[a-2]>e.reducePos;)a-=4;let l=e.buffer.slice(a),u=e.bufferBase+a;for(;e&&u==e.bufferBase;)e=e.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,l,u,this.curContext,this.lookAhead,e)}recoverByDelete(e,a){let l=e<=this.p.parser.maxNode;l&&this.storeNode(e,this.pos,a,4),this.storeNode(0,this.pos,a,l?8:4),this.pos=this.reducePos=a,this.score-=190}canShift(e){for(let a=new SimulatedStack(this);;){let l=this.p.parser.stateSlot(a.state,4)||this.p.parser.hasAction(a.state,e);if(l==0)return!1;if((l&65536)==0)return!0;a.reduce(l)}}recoverByInsert(e){if(this.stack.length>=300)return[];let a=this.p.parser.nextStates(this.state);if(a.length>8||this.stack.length>=120){let u=[];for(let p=0,d;p<a.length;p+=2)(d=a[p+1])!=this.state&&this.p.parser.hasAction(d,e)&&u.push(a[p],d);if(this.stack.length<120)for(let p=0;u.length<8&&p<a.length;p+=2){let d=a[p+1];u.some((f,g)=>g&1&&f==d)||u.push(a[p],d)}a=u}let l=[];for(let u=0;u<a.length&&l.length<4;u+=2){let p=a[u+1];if(p==this.state)continue;let d=this.split();d.pushState(p,this.pos),d.storeNode(0,d.pos,d.pos,4,!0),d.shiftContext(a[u],this.pos),d.reducePos=this.pos,d.score-=200,l.push(d)}return l}forceReduce(){let{parser:e}=this.p,a=e.stateSlot(this.state,5);if((a&65536)==0)return!1;if(!e.validAction(this.state,a)){let l=a>>19,u=a&65535,p=this.stack.length-l*3;if(p<0||e.getGoto(this.stack[p],u,!1)<0){let d=this.findForcedReduction();if(d==null)return!1;a=d}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(a),!0}findForcedReduction(){let{parser:e}=this.p,a=[],l=(u,p)=>{if(!a.includes(u))return a.push(u),e.allActions(u,d=>{if(!(d&393216))if(d&65536){let f=(d>>19)-p;if(f>1){let g=d&65535,b=this.stack.length-f*3;if(b>=0&&e.getGoto(this.stack[b],g,!1)>=0)return f<<19|65536|g}}else{let f=l(d,p+1);if(f!=null)return f}})};return l(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let a=0;a<this.stack.length;a+=3)if(this.stack[a]!=e.stack[a])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,a){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(a)))}reduceContext(e,a){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(a)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let a=new StackContext(this.curContext.tracker,e);a.hash!=this.curContext.hash&&this.emitContext(),this.curContext=a}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(e,a){this.tracker=e,this.context=a,this.hash=e.strict?e.hash(a):0}}class SimulatedStack{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let a=e&65535,l=e>>19;l==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(l-1)*3;let u=this.start.p.parser.getGoto(this.stack[this.base-3],a,!0);this.state=u}}class StackBufferCursor{constructor(e,a,l){this.stack=e,this.pos=a,this.index=l,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,a=e.bufferBase+e.buffer.length){return new StackBufferCursor(e,a,a-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(o,e=Uint16Array){if(typeof o!="string")return o;let a=null;for(let l=0,u=0;l<o.length;){let p=0;for(;;){let d=o.charCodeAt(l++),f=!1;if(d==126){p=65535;break}d>=92&&d--,d>=34&&d--;let g=d-32;if(g>=46&&(g-=46,f=!0),p+=g,f)break;p*=46}a?a[u++]=p:a=new e(p)}return a}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(e,a){this.input=e,this.ranges=a,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=a[0].from,this.range=a[0],this.end=a[a.length-1].to,this.readNext()}resolveOffset(e,a){let l=this.range,u=this.rangeIndex,p=this.pos+e;for(;p<l.from;){if(!u)return null;let d=this.ranges[--u];p-=l.from-d.to,l=d}for(;a<0?p>l.to:p>=l.to;){if(u==this.ranges.length-1)return null;let d=this.ranges[++u];p+=d.from-l.to,l=d}return p}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let a of this.ranges)if(a.to>e)return Math.max(e,a.from);return this.end}peek(e){let a=this.chunkOff+e,l,u;if(a>=0&&a<this.chunk.length)l=this.pos+e,u=this.chunk.charCodeAt(a);else{let p=this.resolveOffset(e,1);if(p==null)return-1;if(l=p,l>=this.chunk2Pos&&l<this.chunk2Pos+this.chunk2.length)u=this.chunk2.charCodeAt(l-this.chunk2Pos);else{let d=this.rangeIndex,f=this.range;for(;f.to<=l;)f=this.ranges[++d];this.chunk2=this.input.chunk(this.chunk2Pos=l),l+this.chunk2.length>f.to&&(this.chunk2=this.chunk2.slice(0,f.to-l)),u=this.chunk2.charCodeAt(0)}}return l>=this.token.lookAhead&&(this.token.lookAhead=l+1),u}acceptToken(e,a=0){let l=a?this.resolveOffset(a,-1):this.pos;if(l==null||l<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=l}acceptTokenTo(e,a){this.token.value=e,this.token.end=a}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:a}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=a,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),a=this.pos+e.length;this.chunk=a>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,a){if(a?(this.token=a,a.start=e,a.lookAhead=e+1,a.value=a.extended=-1):this.token=nullToken,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,a){if(e>=this.chunkPos&&a<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,a-this.chunkPos);if(e>=this.chunk2Pos&&a<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,a-this.chunk2Pos);if(e>=this.range.from&&a<=this.range.to)return this.input.read(e,a);let l="";for(let u of this.ranges){if(u.from>=a)break;u.to>e&&(l+=this.input.read(Math.max(u.from,e),Math.min(u.to,a)))}return l}}class TokenGroup{constructor(e,a){this.data=e,this.id=a}token(e,a){let{parser:l}=a.p;readToken(this.data,e,a,this.id,l.data,l.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class LocalTokenGroup{constructor(e,a,l){this.precTable=a,this.elseToken=l,this.data=typeof e=="string"?decodeArray(e):e}token(e,a){let l=e.pos,u=0;for(;;){let p=e.next<0,d=e.resolveOffset(1,1);if(readToken(this.data,e,a,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(p||u++,d==null)break;e.reset(d,e.token)}u&&(e.reset(l,e.token),e.acceptToken(this.elseToken,u))}}LocalTokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class ExternalTokenizer{constructor(e,a={}){this.token=e,this.contextual=!!a.contextual,this.fallback=!!a.fallback,this.extend=!!a.extend}}function readToken(o,e,a,l,u,p){let d=0,f=1<<l,{dialect:g}=a.p.parser;e:for(;(f&o[d])!=0;){let b=o[d+1];for(let E=d+3;E<b;E+=2)if((o[E+1]&f)>0){let F=o[E];if(g.allows(F)&&(e.token.value==-1||e.token.value==F||overrides(F,e.token.value,u,p))){e.acceptToken(F);break}}let A=e.next,S=0,M=o[d+2];if(e.next<0&&M>S&&o[b+M*3-3]==65535){d=o[b+M*3-1];continue e}for(;S<M;){let E=S+M>>1,F=b+E+(E<<1),$=o[F],Z=o[F+1]||65536;if(A<$)M=E;else if(A>=Z)S=E+1;else{d=o[F+2],e.advance();continue e}}break}}function findOffset(o,e,a){for(let l=e,u;(u=o[l])!=65535;l++)if(u==a)return l-e;return-1}function overrides(o,e,a,l){let u=findOffset(a,l,e);return u<0||findOffset(a,l,o)<u}const verbose=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG);let stackIDs=null;function cutAt(o,e,a){let l=o.cursor(IterMode.IncludeAnonymous);for(l.moveTo(e);;)if(!(a<0?l.childBefore(e):l.childAfter(e)))for(;;){if((a<0?l.to<e:l.from>e)&&!l.type.isError)return a<0?Math.max(0,Math.min(l.to-1,e-25)):Math.min(o.length,Math.max(l.from+1,e+25));if(a<0?l.prevSibling():l.nextSibling())break;if(!l.parent())return a<0?0:o.length}}class FragmentCursor{constructor(e,a){this.fragments=e,this.nodeSet=a,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?cutAt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?cutAt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let a=this.trees.length-1;if(a<0)return this.nextFragment(),null;let l=this.trees[a],u=this.index[a];if(u==l.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let p=l.children[u],d=this.start[a]+l.positions[u];if(d>e)return this.nextStart=d,null;if(p instanceof Tree){if(d==e){if(d<this.safeFrom)return null;let f=d+p.length;if(f<=this.safeTo){let g=p.prop(NodeProp.lookAhead);if(!g||f+g<this.fragment.to)return p}}this.index[a]++,d+p.length>=Math.max(this.safeFrom,e)&&(this.trees.push(p),this.start.push(d),this.index.push(0))}else this.index[a]++,this.nextStart=d+p.length}}}class TokenCache{constructor(e,a){this.stream=a,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(l=>new CachedToken)}getActions(e){let a=0,l=null,{parser:u}=e.p,{tokenizers:p}=u,d=u.stateSlot(e.state,3),f=e.curContext?e.curContext.hash:0,g=0;for(let b=0;b<p.length;b++){if((1<<b&d)==0)continue;let A=p[b],S=this.tokens[b];if(!(l&&!A.fallback)&&((A.contextual||S.start!=e.pos||S.mask!=d||S.context!=f)&&(this.updateCachedToken(S,A,e),S.mask=d,S.context=f),S.lookAhead>S.end+25&&(g=Math.max(S.lookAhead,g)),S.value!=0)){let M=a;if(S.extended>-1&&(a=this.addActions(e,S.extended,S.end,a)),a=this.addActions(e,S.value,S.end,a),!A.extend&&(l=S,a>M))break}}for(;this.actions.length>a;)this.actions.pop();return g&&e.setLookAhead(g),!l&&e.pos==this.stream.end&&(l=new CachedToken,l.value=e.p.parser.eofTerm,l.start=l.end=e.pos,a=this.addActions(e,l.value,l.end,a)),this.mainToken=l,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let a=new CachedToken,{pos:l,p:u}=e;return a.start=l,a.end=Math.min(l+1,u.stream.end),a.value=l==u.stream.end?u.parser.eofTerm:0,a}updateCachedToken(e,a,l){let u=this.stream.clipPos(l.pos);if(a.token(this.stream.reset(u,e),l),e.value>-1){let{parser:p}=l.p;for(let d=0;d<p.specialized.length;d++)if(p.specialized[d]==e.value){let f=p.specializers[d](this.stream.read(e.start,e.end),l);if(f>=0&&l.p.parser.dialect.allows(f>>1)){(f&1)==0?e.value=f>>1:e.extended=f>>1;break}}}else e.value=0,e.end=this.stream.clipPos(u+1)}putAction(e,a,l,u){for(let p=0;p<u;p+=3)if(this.actions[p]==e)return u;return this.actions[u++]=e,this.actions[u++]=a,this.actions[u++]=l,u}addActions(e,a,l,u){let{state:p}=e,{parser:d}=e.p,{data:f}=d;for(let g=0;g<2;g++)for(let b=d.stateSlot(p,g?2:1);;b+=3){if(f[b]==65535)if(f[b+1]==1)b=pair(f,b+2);else{u==0&&f[b+1]==2&&(u=this.putAction(pair(f,b+2),a,l,u));break}f[b]==a&&(u=this.putAction(pair(f,b+1),a,l,u))}return u}}class Parse{constructor(e,a,l,u){this.parser=e,this.input=a,this.ranges=u,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(a,u),this.tokens=new TokenCache(e,this.stream),this.topTerm=e.top[1];let{from:p}=u[0];this.stacks=[Stack.start(this,e.top[0],p)],this.fragments=l.length&&this.stream.end-p>e.bufferLength*4?new FragmentCursor(l,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,a=this.minStackPos,l=this.stacks=[],u,p;if(this.bigReductionCount>300&&e.length==1){let[d]=e;for(;d.forceReduce()&&d.stack.length&&d.stack[d.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let d=0;d<e.length;d++){let f=e[d];for(;;){if(this.tokens.mainToken=null,f.pos>a)l.push(f);else{if(this.advanceStack(f,l,e))continue;{u||(u=[],p=[]),u.push(f);let g=this.tokens.getMainToken(f);p.push(g.value,g.end)}}break}}if(!l.length){let d=u&&findFinished(u);if(d)return verbose&&console.log("Finish with "+this.stackID(d)),this.stackToTree(d);if(this.parser.strict)throw verbose&&u&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+a);this.recovering||(this.recovering=5)}if(this.recovering&&u){let d=this.stoppedAt!=null&&u[0].pos>this.stoppedAt?u[0]:this.runRecovery(u,p,l);if(d)return verbose&&console.log("Force-finish "+this.stackID(d)),this.stackToTree(d.forceAll())}if(this.recovering){let d=this.recovering==1?1:this.recovering*3;if(l.length>d)for(l.sort((f,g)=>g.score-f.score);l.length>d;)l.pop();l.some(f=>f.reducePos>a)&&this.recovering--}else if(l.length>1){e:for(let d=0;d<l.length-1;d++){let f=l[d];for(let g=d+1;g<l.length;g++){let b=l[g];if(f.sameState(b)||f.buffer.length>500&&b.buffer.length>500)if((f.score-b.score||f.buffer.length-b.buffer.length)>0)l.splice(g--,1);else{l.splice(d--,1);continue e}}}l.length>12&&(l.sort((d,f)=>f.score-d.score),l.splice(12,l.length-12))}this.minStackPos=l[0].pos;for(let d=1;d<l.length;d++)l[d].pos<this.minStackPos&&(this.minStackPos=l[d].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,a,l){let u=e.pos,{parser:p}=this,d=verbose?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&u>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let b=e.curContext&&e.curContext.tracker.strict,A=b?e.curContext.hash:0;for(let S=this.fragments.nodeAt(u);S;){let M=this.parser.nodeSet.types[S.type.id]==S.type?p.getGoto(e.state,S.type.id):-1;if(M>-1&&S.length&&(!b||(S.prop(NodeProp.contextHash)||0)==A))return e.useNode(S,M),verbose&&console.log(d+this.stackID(e)+` (via reuse of ${p.getName(S.type.id)})`),!0;if(!(S instanceof Tree)||S.children.length==0||S.positions[0]>0)break;let E=S.children[0];if(E instanceof Tree&&S.positions[0]==0)S=E;else break}}let f=p.stateSlot(e.state,4);if(f>0)return e.reduce(f),verbose&&console.log(d+this.stackID(e)+` (via always-reduce ${p.getName(f&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let g=this.tokens.getActions(e);for(let b=0;b<g.length;){let A=g[b++],S=g[b++],M=g[b++],E=b==g.length||!l,F=E?e:e.split(),$=this.tokens.mainToken;if(F.apply(A,S,$?$.start:F.pos,M),verbose&&console.log(d+this.stackID(F)+` (via ${(A&65536)==0?"shift":`reduce of ${p.getName(A&65535)}`} for ${p.getName(S)} @ ${u}${F==e?"":", split"})`),E)return!0;F.pos>u?a.push(F):l.push(F)}return!1}advanceFully(e,a){let l=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>l)return pushStackDedup(e,a),!0}}runRecovery(e,a,l){let u=null,p=!1;for(let d=0;d<e.length;d++){let f=e[d],g=a[d<<1],b=a[(d<<1)+1],A=verbose?this.stackID(f)+" -> ":"";if(f.deadEnd&&(p||(p=!0,f.restart(),verbose&&console.log(A+this.stackID(f)+" (restarted)"),this.advanceFully(f,l))))continue;let S=f.split(),M=A;for(let E=0;E<10&&S.forceReduce()&&(verbose&&console.log(M+this.stackID(S)+" (via force-reduce)"),!this.advanceFully(S,l));E++)verbose&&(M=this.stackID(S)+" -> ");for(let E of f.recoverByInsert(g))verbose&&console.log(A+this.stackID(E)+" (via recover-insert)"),this.advanceFully(E,l);this.stream.end>f.pos?(b==f.pos&&(b++,g=0),f.recoverByDelete(g,b),verbose&&console.log(A+this.stackID(f)+` (via recover-delete ${this.parser.getName(g)})`),pushStackDedup(f,l)):(!u||u.score<f.score)&&(u=f)}return u}stackToTree(e){return e.close(),Tree.build({buffer:StackBufferCursor.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let a=(stackIDs||(stackIDs=new WeakMap)).get(e);return a||stackIDs.set(e,a=String.fromCodePoint(this.nextStackID++)),a+e}}function pushStackDedup(o,e){for(let a=0;a<e.length;a++){let l=e[a];if(l.pos==o.pos&&l.sameState(o)){e[a].score<o.score&&(e[a]=o);return}}e.push(o)}class Dialect{constructor(e,a,l){this.source=e,this.flags=a,this.disabled=l}allows(e){return!this.disabled||this.disabled[e]==0}}const id$1=o=>o;class ContextTracker{constructor(e){this.start=e.start,this.shift=e.shift||id$1,this.reduce=e.reduce||id$1,this.reuse=e.reuse||id$1,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class LRParser extends Parser$1{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let a=e.nodeNames.split(" ");this.minRepeatTerm=a.length;for(let f=0;f<e.repeatNodeCount;f++)a.push("");let l=Object.keys(e.topRules).map(f=>e.topRules[f][1]),u=[];for(let f=0;f<a.length;f++)u.push([]);function p(f,g,b){u[f].push([g,g.deserialize(String(b))])}if(e.nodeProps)for(let f of e.nodeProps){let g=f[0];typeof g=="string"&&(g=NodeProp[g]);for(let b=1;b<f.length;){let A=f[b++];if(A>=0)p(A,g,f[b++]);else{let S=f[b+-A];for(let M=-A;M>0;M--)p(f[b++],g,S);b++}}}this.nodeSet=new NodeSet(a.map((f,g)=>NodeType.define({name:g>=this.minRepeatTerm?void 0:f,id:g,props:u[g],top:l.indexOf(g)>-1,error:g==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(g)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let d=decodeArray(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let f=0;f<this.specializerSpecs.length;f++)this.specialized[f]=this.specializerSpecs[f].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(e.states,Uint32Array),this.data=decodeArray(e.stateData),this.goto=decodeArray(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(f=>typeof f=="number"?new TokenGroup(d,f):f),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,a,l){let u=new Parse(this,e,a,l);for(let p of this.wrappers)u=p(u,e,a,l);return u}getGoto(e,a,l=!1){let u=this.goto;if(a>=u[0])return-1;for(let p=u[a+1];;){let d=u[p++],f=d&1,g=u[p++];if(f&&l)return g;for(let b=p+(d>>1);p<b;p++)if(u[p]==e)return g;if(f)return-1}}hasAction(e,a){let l=this.data;for(let u=0;u<2;u++)for(let p=this.stateSlot(e,u?2:1),d;;p+=3){if((d=l[p])==65535)if(l[p+1]==1)d=l[p=pair(l,p+2)];else{if(l[p+1]==2)return pair(l,p+2);break}if(d==a||d==0)return pair(l,p+1)}return 0}stateSlot(e,a){return this.states[e*6+a]}stateFlag(e,a){return(this.stateSlot(e,0)&a)>0}validAction(e,a){return!!this.allActions(e,l=>l==a?!0:null)}allActions(e,a){let l=this.stateSlot(e,4),u=l?a(l):void 0;for(let p=this.stateSlot(e,1);u==null;p+=3){if(this.data[p]==65535)if(this.data[p+1]==1)p=pair(this.data,p+2);else break;u=a(pair(this.data,p+1))}return u}nextStates(e){let a=[];for(let l=this.stateSlot(e,1);;l+=3){if(this.data[l]==65535)if(this.data[l+1]==1)l=pair(this.data,l+2);else break;if((this.data[l+2]&1)==0){let u=this.data[l+1];a.some((p,d)=>d&1&&p==u)||a.push(this.data[l],u)}}return a}configure(e){let a=Object.assign(Object.create(LRParser.prototype),this);if(e.props&&(a.nodeSet=this.nodeSet.extend(...e.props)),e.top){let l=this.topRules[e.top];if(!l)throw new RangeError(`Invalid top rule name ${e.top}`);a.top=l}return e.tokenizers&&(a.tokenizers=this.tokenizers.map(l=>{let u=e.tokenizers.find(p=>p.from==l);return u?u.to:l})),e.specializers&&(a.specializers=this.specializers.slice(),a.specializerSpecs=this.specializerSpecs.map((l,u)=>{let p=e.specializers.find(f=>f.from==l.external);if(!p)return l;let d=Object.assign(Object.assign({},l),{external:p.to});return a.specializers[u]=getSpecializer(d),d})),e.contextTracker&&(a.context=e.contextTracker),e.dialect&&(a.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(a.strict=e.strict),e.wrap&&(a.wrappers=a.wrappers.concat(e.wrap)),e.bufferLength!=null&&(a.bufferLength=e.bufferLength),a}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let a=this.dynamicPrecedences;return a==null?0:a[e]||0}parseDialect(e){let a=Object.keys(this.dialects),l=a.map(()=>!1);if(e)for(let p of e.split(" ")){let d=a.indexOf(p);d>=0&&(l[d]=!0)}let u=null;for(let p=0;p<a.length;p++)if(!l[p])for(let d=this.dialects[a[p]],f;(f=this.data[d++])!=65535;)(u||(u=new Uint8Array(this.maxTerm+1)))[f]=1;return new Dialect(e,l,u)}static deserialize(e){return new LRParser(e)}}function pair(o,e){return o[e]|o[e+1]<<16}function findFinished(o){let e=null;for(let a of o){let l=a.p.stoppedAt;(a.pos==a.p.stream.end||l!=null&&a.pos>l)&&a.p.parser.stateFlag(a.state,2)&&(!e||e.score<a.score)&&(e=a)}return e}function getSpecializer(o){if(o.external){let e=o.extend?1:0;return(a,l)=>o.external(a,l)<<1|e}return o.get}const noSemi=316,noSemiType=317,incdec=1,incdecPrefix=2,questionDot=3,JSXStartTag=4,insertSemi=318,spaces=320,newline=321,LineComment=5,BlockComment=6,Dialect_jsx=0,space=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],braceR=125,semicolon=59,slash=47,star=42,plus=43,minus=45,lt$1=60,comma=44,question=63,dot=46,bracketL=91,trackNewline=new ContextTracker({start:!1,shift(o,e){return e==LineComment||e==BlockComment||e==spaces?o:e==newline},strict:!1}),insertSemicolon=new ExternalTokenizer((o,e)=>{let{next:a}=o;(a==braceR||a==-1||e.context)&&o.acceptToken(insertSemi)},{contextual:!0,fallback:!0}),noSemicolon=new ExternalTokenizer((o,e)=>{let{next:a}=o,l;space.indexOf(a)>-1||a==slash&&((l=o.peek(1))==slash||l==star)||a!=braceR&&a!=semicolon&&a!=-1&&!e.context&&o.acceptToken(noSemi)},{contextual:!0}),noSemicolonType=new ExternalTokenizer((o,e)=>{o.next==bracketL&&!e.context&&o.acceptToken(noSemiType)},{contextual:!0}),operatorToken=new ExternalTokenizer((o,e)=>{let{next:a}=o;if(a==plus||a==minus){if(o.advance(),a==o.next){o.advance();let l=!e.context&&e.canShift(incdec);o.acceptToken(l?incdec:incdecPrefix)}}else a==question&&o.peek(1)==dot&&(o.advance(),o.advance(),(o.next<48||o.next>57)&&o.acceptToken(questionDot))},{contextual:!0});function identifierChar(o,e){return o>=65&&o<=90||o>=97&&o<=122||o==95||o>=192||!e&&o>=48&&o<=57}const jsx=new ExternalTokenizer((o,e)=>{if(o.next!=lt$1||!e.dialectEnabled(Dialect_jsx)||(o.advance(),o.next==slash))return;let a=0;for(;space.indexOf(o.next)>-1;)o.advance(),a++;if(identifierChar(o.next,!0)){for(o.advance(),a++;identifierChar(o.next,!1);)o.advance(),a++;for(;space.indexOf(o.next)>-1;)o.advance(),a++;if(o.next==comma)return;for(let l=0;;l++){if(l==7){if(!identifierChar(o.next,!0))return;break}if(o.next!="extends".charCodeAt(l))break;o.advance(),a++}}o.acceptToken(JSXStartTag,-a)}),jsHighlight=styleTags({"get set async static":tags.modifier,"for while do if else switch try catch finally return throw break continue default case defer":tags.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":tags.operatorKeyword,"let var const using function class extends":tags.definitionKeyword,"import export from":tags.moduleKeyword,"with debugger new":tags.keyword,TemplateString:tags.special(tags.string),super:tags.atom,BooleanLiteral:tags.bool,this:tags.self,null:tags.null,Star:tags.modifier,VariableName:tags.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":tags.function(tags.variableName),VariableDefinition:tags.definition(tags.variableName),Label:tags.labelName,PropertyName:tags.propertyName,PrivatePropertyName:tags.special(tags.propertyName),"CallExpression/MemberExpression/PropertyName":tags.function(tags.propertyName),"FunctionDeclaration/VariableDefinition":tags.function(tags.definition(tags.variableName)),"ClassDeclaration/VariableDefinition":tags.definition(tags.className),"NewExpression/VariableName":tags.className,PropertyDefinition:tags.definition(tags.propertyName),PrivatePropertyDefinition:tags.definition(tags.special(tags.propertyName)),UpdateOp:tags.updateOperator,"LineComment Hashbang":tags.lineComment,BlockComment:tags.blockComment,Number:tags.number,String:tags.string,Escape:tags.escape,ArithOp:tags.arithmeticOperator,LogicOp:tags.logicOperator,BitOp:tags.bitwiseOperator,CompareOp:tags.compareOperator,RegExp:tags.regexp,Equals:tags.definitionOperator,Arrow:tags.function(tags.punctuation),": Spread":tags.punctuation,"( )":tags.paren,"[ ]":tags.squareBracket,"{ }":tags.brace,"InterpolationStart InterpolationEnd":tags.special(tags.brace),".":tags.derefOperator,", ;":tags.separator,"@":tags.meta,TypeName:tags.typeName,TypeDefinition:tags.definition(tags.typeName),"type enum interface implements namespace module declare":tags.definitionKeyword,"abstract global Privacy readonly override":tags.modifier,"is keyof unique infer asserts":tags.operatorKeyword,JSXAttributeValue:tags.attributeValue,JSXText:tags.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":tags.angleBracket,"JSXIdentifier JSXNameSpacedName":tags.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":tags.attributeName,"JSXBuiltin/JSXIdentifier":tags.standard(tags.tagName)}),spec_identifier={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},spec_word={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},spec_LessThan={__proto__:null,"<":193},parser=LRParser.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:trackNewline,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[jsHighlight],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[noSemicolon,noSemicolonType,operatorToken,jsx,2,3,4,5,6,7,8,9,10,11,12,13,14,insertSemicolon,new LocalTokenGroup("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new LocalTokenGroup("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:o=>spec_identifier[o]||-1},{term:343,get:o=>spec_word[o]||-1},{term:95,get:o=>spec_LessThan[o]||-1}],tokenPrec:15201}),snippets=[snippetCompletion("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),snippetCompletion("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),snippetCompletion("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),snippetCompletion("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),snippetCompletion("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),snippetCompletion(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),snippetCompletion("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),snippetCompletion(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),snippetCompletion(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),snippetCompletion('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),snippetCompletion('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],typescriptSnippets=snippets.concat([snippetCompletion("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),snippetCompletion("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),snippetCompletion("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),cache$6=new NodeWeakMap,ScopeNodes=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function defID(o){return(e,a)=>{let l=e.node.getChild("VariableDefinition");return l&&a(l,o),!0}}const functionContext=["FunctionDeclaration"],gatherCompletions={FunctionDeclaration:defID("function"),ClassDeclaration:defID("class"),ClassExpression:()=>!0,EnumDeclaration:defID("constant"),TypeAliasDeclaration:defID("type"),NamespaceDeclaration:defID("namespace"),VariableDefinition(o,e){o.matchContext(functionContext)||e(o,"variable")},TypeDefinition(o,e){e(o,"type")},__proto__:null};function getScope(o,e){let a=cache$6.get(e);if(a)return a;let l=[],u=!0;function p(d,f){let g=o.sliceString(d.from,d.to);l.push({label:g,type:f})}return e.cursor(IterMode.IncludeAnonymous).iterate(d=>{if(u)u=!1;else if(d.name){let f=gatherCompletions[d.name];if(f&&f(d,p)||ScopeNodes.has(d.name))return!1}else if(d.to-d.from>8192){for(let f of getScope(o,d.node))l.push(f);return!1}}),cache$6.set(e,l),l}const Identifier=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,dontComplete=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function localCompletionSource(o){let e=syntaxTree(o.state).resolveInner(o.pos,-1);if(dontComplete.indexOf(e.name)>-1)return null;let a=e.name=="VariableName"||e.to-e.from<20&&Identifier.test(o.state.sliceDoc(e.from,e.to));if(!a&&!o.explicit)return null;let l=[];for(let u=e;u;u=u.parent)ScopeNodes.has(u.name)&&(l=l.concat(getScope(o.state.doc,u)));return{options:l,from:a?e.from:o.pos,validFor:Identifier}}const javascriptLanguage=LRLanguage.define({name:"javascript",parser:parser.configure({props:[indentNodeProp.add({IfStatement:continuedIndent({except:/^\s*({|else\b)/}),TryStatement:continuedIndent({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:flatIndent,SwitchBody:o=>{let e=o.textAfter,a=/^\s*\}/.test(e),l=/^\s*(case|default)\b/.test(e);return o.baseIndent+(a?0:l?1:2)*o.unit},Block:delimitedIndent({closing:"}"}),ArrowFunction:o=>o.baseIndent+o.unit,"TemplateString BlockComment":()=>null,"Statement Property":continuedIndent({except:/^\s*{/}),JSXElement(o){let e=/^\s*<\//.test(o.textAfter);return o.lineIndent(o.node.from)+(e?0:o.unit)},JSXEscape(o){let e=/\s*\}/.test(o.textAfter);return o.lineIndent(o.node.from)+(e?0:o.unit)},"JSXOpenTag JSXSelfClosingTag"(o){return o.column(o.node.from)+o.unit}}),foldNodeProp.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":foldInside,BlockComment(o){return{from:o.from+2,to:o.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),jsxSublanguage={test:o=>/^JSX/.test(o.name),facet:defineLanguageFacet({commentTokens:{block:{open:"{/*",close:"*/}"}}})},typescriptLanguage=javascriptLanguage.configure({dialect:"ts"},"typescript"),jsxLanguage=javascriptLanguage.configure({dialect:"jsx",props:[sublanguageProp.add(o=>o.isTop?[jsxSublanguage]:void 0)]}),tsxLanguage=javascriptLanguage.configure({dialect:"jsx ts",props:[sublanguageProp.add(o=>o.isTop?[jsxSublanguage]:void 0)]},"typescript");let kwCompletion=o=>({label:o,type:"keyword"});const keywords$2="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(kwCompletion),typescriptKeywords=keywords$2.concat(["declare","implements","private","protected","public"].map(kwCompletion));function javascript(o={}){let e=o.jsx?o.typescript?tsxLanguage:jsxLanguage:o.typescript?typescriptLanguage:javascriptLanguage,a=o.typescript?typescriptSnippets.concat(typescriptKeywords):snippets.concat(keywords$2);return new LanguageSupport(e,[javascriptLanguage.data.of({autocomplete:ifNotIn(dontComplete,completeFromList(a))}),javascriptLanguage.data.of({autocomplete:localCompletionSource}),o.jsx?autoCloseTags:[]])}function findOpenTag(o){for(;;){if(o.name=="JSXOpenTag"||o.name=="JSXSelfClosingTag"||o.name=="JSXFragmentTag")return o;if(o.name=="JSXEscape"||!o.parent)return null;o=o.parent}}function elementName(o,e,a=o.length){for(let l=e?.firstChild;l;l=l.nextSibling)if(l.name=="JSXIdentifier"||l.name=="JSXBuiltin"||l.name=="JSXNamespacedName"||l.name=="JSXMemberExpression")return o.sliceString(l.from,Math.min(l.to,a));return""}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),autoCloseTags=EditorView.inputHandler.of((o,e,a,l,u)=>{if((android?o.composing:o.compositionStarted)||o.state.readOnly||e!=a||l!=">"&&l!="/"||!javascriptLanguage.isActiveAt(o.state,e,-1))return!1;let p=u(),{state:d}=p,f=d.changeByRange(g=>{var b;let{head:A}=g,S=syntaxTree(d).resolveInner(A-1,-1),M;if(S.name=="JSXStartTag"&&(S=S.parent),!(d.doc.sliceString(A-1,A)!=l||S.name=="JSXAttributeValue"&&S.to>A)){if(l==">"&&S.name=="JSXFragmentTag")return{range:g,changes:{from:A,insert:"</>"}};if(l=="/"&&S.name=="JSXStartCloseTag"){let E=S.parent,F=E.parent;if(F&&E.from==A-2&&((M=elementName(d.doc,F.firstChild,A))||((b=F.firstChild)===null||b===void 0?void 0:b.name)=="JSXFragmentTag")){let $=`${M}>`;return{range:EditorSelection.cursor(A+$.length,-1),changes:{from:A,insert:$}}}}else if(l==">"){let E=findOpenTag(S);if(E&&E.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(d.doc.sliceString(A,A+2))&&(M=elementName(d.doc,E,A)))return{range:g,changes:{from:A,insert:`</${M}>`}}}}return{range:g}});return f.changes.empty?!1:(o.dispatch([p,d.update(f,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),base00="#2e3440",base01="#3b4252",base02="#434c5e",base03="#4c566a",base04="#d8dee9",base05="#e5e9f0",base06="#eceff4",base07="#8fbcbb",base08="#88c0d0",base09="#81a1c1",base0A="#5e81ac",base0b="#bf616a",base0C="#d08770",base0D="#ebcb8b",base0E="#a3be8c",base0F="#b48ead",invalid="#d30102",darkBackground="#252a33",highlightBackground=base03,background=base00,tooltipBackground=base01,selection=base03,cursor=base04,nordTheme=EditorView.theme({"&":{color:base04,backgroundColor:background},".cm-content":{caretColor:cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:cursor},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:selection},".cm-panels":{backgroundColor:darkBackground,color:base03},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"transparent",outline:`1px solid ${base07}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:base04,color:base00},".cm-activeLine":{backgroundColor:highlightBackground},".cm-selectionMatch":{backgroundColor:base05,color:base01},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${base07}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:base06,color:base02},".cm-gutters":{backgroundColor:base00,color:base03,border:"none"},".cm-activeLineGutter":{backgroundColor:highlightBackground,color:base04},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:tooltipBackground,borderBottomColor:tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:highlightBackground,color:base03}}},{dark:!0}),nordHighlightStyle=HighlightStyle.define([{tag:tags.keyword,color:base0A},{tag:[tags.name,tags.deleted,tags.character,tags.propertyName,tags.macroName],color:base08},{tag:[tags.variableName],color:base07},{tag:[tags.function(tags.variableName)],color:base07},{tag:[tags.labelName],color:base09},{tag:[tags.color,tags.constant(tags.name),tags.standard(tags.name)],color:base0A},{tag:[tags.definition(tags.name),tags.separator],color:base0E},{tag:[tags.brace],color:base07},{tag:[tags.annotation],color:invalid},{tag:[tags.number,tags.changed,tags.annotation,tags.modifier,tags.self,tags.namespace],color:base0F},{tag:[tags.typeName,tags.className],color:base0D},{tag:[tags.operator,tags.operatorKeyword],color:base0E},{tag:[tags.tagName],color:base0F},{tag:[tags.squareBracket],color:base0b},{tag:[tags.angleBracket],color:base0C},{tag:[tags.attributeName],color:base0D},{tag:[tags.regexp],color:base0A},{tag:[tags.quote],color:base0F},{tag:[tags.string],color:base0E},{tag:tags.link,color:base0E,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[tags.url,tags.escape,tags.special(tags.string)],color:base07},{tag:[tags.meta],color:base08},{tag:[tags.monospace],color:base04,fontStyle:"italic"},{tag:[tags.comment],color:base03,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold",color:base0A},{tag:tags.emphasis,fontStyle:"italic",color:base0A},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.heading,fontWeight:"bold",color:base0A},{tag:tags.special(tags.heading1),fontWeight:"bold",color:base0A},{tag:tags.heading1,fontWeight:"bold",color:base0A},{tag:[tags.heading2,tags.heading3,tags.heading4],fontWeight:"bold",color:base0A},{tag:[tags.heading5,tags.heading6],color:base0A},{tag:[tags.atom,tags.bool,tags.special(tags.variableName)],color:base0C},{tag:[tags.processingInstruction,tags.inserted],color:base07},{tag:[tags.contentSeparator],color:base0D},{tag:tags.invalid,color:base02,borderBottom:`1px dotted ${invalid}`}]),nord=[nordTheme,syntaxHighlighting(nordHighlightStyle)],createAddCursor=o=>e=>{const a=o==="down";let l=e.state.selection;for(const u of l.ranges)l=l.addRange(e.moveVertically(u,a));return e.dispatch({selection:l}),!0},addCursorUp=createAddCursor("up"),addCursorDown=createAddCursor("down"),addCursorAtEachSelectionLine=o=>{let e=null;for(const a of o.state.selection.ranges)if(!a.empty)for(let l=a.from;l<=a.to;){const u=o.state.doc.lineAt(l),p=Math.min(u.to,a.to);e?e=e.addRange(EditorSelection.range(p,p)):e=EditorSelection.single(p),l=u.to+1}return e?(o.dispatch({selection:e}),!0):!1},vscodeKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion},{key:"Tab",run:acceptCompletion},{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Alt-Enter",run:selectMatches,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:replaceAll,scope:"editor search-panel"},{key:"Ctrl-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0},{key:"Shift-Mod-l",run:selectSelectionMatches},{key:"Enter",run:insertNewlineAndIndent,shift:insertNewlineAndIndent},{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:addCursorUp,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:addCursorDown,preventDefault:!0},{key:"Shift-Alt-i",run:addCursorAtEachSelectionLine},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteBracketPair},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd},{mac:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{mac:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{mac:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{mac:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{mac:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{mac:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{mac:"Ctrl-d",run:deleteCharForward},{mac:"Ctrl-h",run:deleteCharBackward},{mac:"Ctrl-k",run:deleteToLineEnd},{mac:"Ctrl-Alt-h",run:deleteGroupBackward},{mac:"Ctrl-o",run:splitLine},{mac:"Ctrl-t",run:transposeChars},{mac:"Ctrl-v",run:cursorPageDown},{mac:"Alt-v",run:cursorPageUp},{key:"Shift-Mod-k",run:deleteLine},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Alt-ArrowUp",run:moveLineUp},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:copyLineDown},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Mod-l",run:selectLine,preventDefault:!0},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Tab",run:indentMore,shift:indentLess,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Mod-k Mod-0",run:foldAll},{key:"Mod-k Mod-j",run:unfoldAll},{key:"Mod-k Mod-c",run:lineComment},{key:"Mod-k Mod-u",run:lineUncomment},{key:"Mod-/",run:toggleComment},{key:"Shift-Alt-a",run:toggleBlockComment},{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",run:redo,preventDefault:!0},{key:"Mod-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Mod-Shift-m",run:openLintPanel},{key:"F8",run:nextDiagnostic}];App.input_mirror_time=3*1e3,App.input_grow_time=3*1e3,App.lines_enabled=!0,App.setup_input=()=>{App.create_editor(),App.max_button=App.get_max_button(),App.lines_enabled?App.enable_lines():App.disable_lines(),App.max_debouncer=App.create_debouncer(()=>{App.max_input_if_larger()},300)},App.create_editor=()=>{App.lineNumbers=lineNumbers,App.compartment=new Compartment;let o=DOM.el("#code-input-wrapper"),e=EditorView.theme(App.editor_theme,{dark:!0});App.setup_strudel_mirror();let a=[lineNumbers(),highlightActiveLineGutter(),foldGutter()],l=EditorView.updateListener.of(d=>{d.docChanged&&App.on_input_change()}),u=[nord,e,l,App.compartment.of(a),EditorState.allowMultipleSelections.of(!0),App.setup_editor_autocomplete(),Prec.highest(keymap.of([{key:"Ctrl-Shift-Alt-ArrowDown",run:copyLineDown},{key:"Ctrl-Shift-Alt-ArrowUp",run:copyLineUp},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0},...vscodeKeymap])),search(),history(),drawSelection(),dropCursor(),closeBrackets(),indentOnInput(),bracketMatching(),rectangularSelection(),crosshairCursor(),highlightSelectionMatches(),App.highlight_extension,keymap.of([...defaultKeymap,...historyKeymap,...searchKeymap,indentWithTab]),javascript(),EditorView.lineWrapping],p=EditorState.create({doc:"",extensions:u});App.editor=new EditorView({state:p,parent:o}),App.editor.dom.id="codemirror-wrapper"},App.get_input=()=>DOM.el("#codemirror-wrapper"),App.get_input_wrapper=()=>DOM.el("#code-input-wrapper"),App.get_input_value=()=>App.editor.state.doc.toString(),App.set_input=(o,e=!0)=>{let a=App.editor,l=a.state,u=l.doc.length;l.doc.toString()!==o&&(a.dispatch({changes:{from:0,to:u,insert:o}}),e&&App.scroll_input_to_top(),App.reset_code_scroll_for_content())},App.init_code_input_controls=()=>{let o=App.get_input_wrapper(),e=DOM.el("#code-input-scroll"),a=App.get_max_button(),l=DOM.el("#code-input-top"),u=DOM.el("#code-input-bottom"),p=DOM.el("#code-input-sounds"),d=DOM.el("#code-input-notes"),f=DOM.el("#code-input-banks");l&&DOM.ev(l,"click",b=>{b.preventDefault(),App.scroll_input_to_top(),App.reset_code_scroll_for_content()}),u&&DOM.ev(u,"click",b=>{b.preventDefault(),App.scroll_input_to_bottom(),App.reset_code_scroll_for_content({direction:-1})}),e&&DOM.ev(e,"click",b=>{if(b.preventDefault(),App.code_scroll_active){App.stop_code_scroll();return}App.start_code_scroll()}),a&&DOM.ev(a,"click",b=>{App.max_input()}),p&&DOM.ev(p,"click",b=>{b.preventDefault(),App.show_sounds_context(b)}),d&&DOM.ev(d,"click",b=>{b.preventDefault(),App.show_notes_context(b)}),f&&DOM.ev(f,"click",b=>{b.preventDefault(),App.show_banks_context(b)});let g=App.get_input();if(DOM.ev(g,"pointerdown",b=>{if(!App.code_scroll_active)return;let S=b.target.getBoundingClientRect();b.clientX>S.right-20&&b.clientY>S.bottom-20||App.stop_code_scroll()}),o){let b=DOM.el("#resize-handle");if(b){let A=!1;DOM.ev(b,"mousedown",S=>{S.preventDefault(),A=!0,document.body.style.userSelect="none",document.body.style.cursor="se-resize",b.style.opacity="1",b.style.pointerEvents="auto",b.classList.add("active");let M=S.clientX,E=S.clientY,F=o.offsetWidth,$=o.offsetHeight,Z=K=>{if(!A)return;let se=F+(K.clientX-M),z=$+(K.clientY-E),U=getComputedStyle(document.documentElement),ee=parseInt(U.getPropertyValue("--input-min-width")),ae=parseInt(U.getPropertyValue("--input-min-height"));se=Math.max(ee,se),z=Math.max(ae,z);let de=`${se}px`,ke=`${z}px`;o.style.width=de,o.style.height=ke,App.set_css_var("input-width-update",de),App.enable_max_button()},V=()=>{A=!1,document.body.style.userSelect="",document.body.style.cursor="",b.style.opacity="",b.style.pointerEvents="",b.classList.remove("active"),App.resize_scope(),App.check_max_button(),document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",V)};DOM.ev(document,"mousemove",Z),DOM.ev(document,"mouseup",V)}),DOM.ev(b,"dblclick",S=>{App.restore_input()})}}DOM.ev(g,"wheel",b=>{App.code_scroll_active&&App.stop_code_scroll()},{passive:!0})},App.restore_input=()=>{let o=App.get_input_wrapper();if(!o)return;let e=getComputedStyle(document.documentElement),a=parseInt(e.getPropertyValue("--input-height")),u=`${parseInt(e.getPropertyValue("--input-max-width"))}%`;o.style.width=u,o.style.height=`${a}px`,App.set_css_var("input-width-update",u),App.resize_scope(),App.check_max_button()},App.input_is_maxed=()=>{let o=App.get_input_wrapper(),e=parseInt(o.style.height),a=parseInt(o.style.width),[l,u]=App.max_input(!0),p=2;return!(Math.abs(e-l)>=p||Math.abs(a-u)>=p)},App.add_text_to_input=o=>{App.editor.dispatch(App.editor.state.replaceSelection(o)),App.editor.focus()},App.focus_input=()=>{App.editor.focus()},App.mirror_input=()=>{let o=App.get_input();o.classList.add("mirror"),clearTimeout(App.input_mirror_timeout),App.input_mirror_timeout=setTimeout(()=>{o.classList.remove("mirror")},App.input_mirror_time)},App.glow_input=()=>{let o=App.get_input();o.classList.add("glow"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{o.classList.remove("glow")},App.input_grow_time)},App.cursive_input=()=>{let o=App.get_input();o.classList.add("cursive"),clearTimeout(App.input_grow_timeout),App.input_grow_timeout=setTimeout(()=>{o.classList.remove("cursive")},App.input_grow_time)},App.max_input=(o=!1,e="normal")=>{let a=App.get_input_wrapper(),l=getComputedStyle(document.documentElement),u=parseInt(l.getPropertyValue("--input-max-width")),p=App.get_input_diff(),d=`${u}%`;return o||(e==="normal"?(a.style.height=`${p}px`,a.style.width=d):e==="width"?a.style.width=d:e==="height"&&(a.style.height=`${p}px`),["normal","width"].includes(e)&&App.set_css_var("input-width-update",d),App.resize_scope(),App.check_max_button()),[p,u]},App.get_input_diff=()=>{let o=App.get_top_height(),e=App.get_scope_height(),a=App.get_status_height(),l=App.get_bottom_height(),u=o+e+l+a;return App.viewport_height()-u-50},App.check_max_button=()=>{App.input_is_maxed()?App.disable_max_button():App.enable_max_button()},App.get_max_button=()=>DOM.el("#code-input-max"),App.enable_max_button=()=>{App.max_button.classList.remove("disabled")},App.disable_max_button=()=>{App.max_button.classList.add("disabled")},App.get_input_height=()=>App.editor.scrollDOM.scrollHeight,App.get_input_client_height=()=>App.editor.scrollDOM.clientHeight,App.set_input_border=o=>{App.editor.dom.style.borderColor=o},App.toggle_lines=()=>{App.lines_enabled=!App.lines_enabled,App.lines_enabled?App.enable_lines():App.disable_lines(),App.stor_save_lines()},App.enable_lines=()=>{App.editor.dispatch({effects:App.compartment.reconfigure(App.lineNumbers())})},App.disable_lines=()=>{App.editor.dispatch({effects:App.compartment.reconfigure([])})},App.max_input_if_larger=()=>{let o=App.get_input_wrapper(),e=parseInt(o.style.height),[a,l]=App.max_input(!0);e>a&&App.max_input(!1,"height")},App.on_input_change=()=>{App.stop_drawer(),App.clean_mirror()},App.start_keyboard=()=>{DOM.ev(document,"keydown",o=>{let e=DOM.active();if(o.key==="s")o.ctrlKey&&(o.preventDefault(),App.play_action());else if(o.key==="Escape"){if(o.preventDefault(),NeedContext.open)return;if(App.modal_open()){if(e.classList.contains("modal-filter")&&e.value){e.value="",App.modal_apply_filter();return}App.close_current_modal()}else App.is_playing()?App.pause_action():App.is_paused()&&App.stop_action()}else o.key==="1"?o.ctrlKey&&App.show_sounds_context():o.key==="2"?o.ctrlKey&&App.show_notes_context():o.key==="3"&&o.ctrlKey&&App.show_banks_context()})},App.custom_completion_source=o=>{let e=/(note|bank|sound)\s*\(\s*["']([^"']*)$/,a=o.matchBefore(e);if(!a)return null;let l=a.text.match(e);if(!l)return null;let u=l[1],p=l[2]||"",d=[];return u==="note"?d=App.strudel_notes:u==="bank"?d=App.strudel_banks:u==="sound"&&(d=App.strudel_sounds),!d||d.length===0?null:{from:o.pos-p.length,options:d.map(f=>({label:f,type:"text",boost:99})),validFor:()=>!1}},App.setup_editor_autocomplete=()=>autocompletion({override:[App.custom_completion_source],defaultKeymap:!0}),typeof globalThis.process>"u"&&(globalThis.process={env:{}}),typeof globalThis.process.env>"u"&&(globalThis.process.env={}),typeof globalThis.process.env.NODE_ENV>"u"&&(globalThis.process.env.NODE_ENV="production");let clean=Symbol("clean"),listenerQueue=[],lqIndex=0;const QUEUE_ITEMS_PER_LISTENER=4;let atom=o=>{let e=[],a={get(){return a.lc||a.listen(()=>{})(),a.value},lc:0,listen(l){return a.lc=e.push(l),()=>{for(let p=lqIndex+QUEUE_ITEMS_PER_LISTENER;p<listenerQueue.length;)listenerQueue[p]===l?listenerQueue.splice(p,QUEUE_ITEMS_PER_LISTENER):p+=QUEUE_ITEMS_PER_LISTENER;let u=e.indexOf(l);~u&&(e.splice(u,1),--a.lc||a.off())}},notify(l,u){let p=!listenerQueue.length;for(let d of e)listenerQueue.push(d,a.value,l,u);if(p){for(lqIndex=0;lqIndex<listenerQueue.length;lqIndex+=QUEUE_ITEMS_PER_LISTENER)listenerQueue[lqIndex](listenerQueue[lqIndex+1],listenerQueue[lqIndex+2],listenerQueue[lqIndex+3]);listenerQueue.length=0}},off(){},set(l){let u=a.value;u!==l&&(a.value=l,a.notify(u))},subscribe(l){let u=a.listen(l);return l(a.value),u},value:o};return process.env.NODE_ENV!=="production"&&(a[clean]=()=>{e=[],a.lc=0,a.off()}),a},map=(o={})=>{let e=atom(o);return e.setKey=function(a,l){let u=e.value;typeof l>"u"&&a in e.value?(e.value={...e.value},delete e.value[a],e.notify(u,a)):e.value[a]!==l&&(e.value={...e.value,[a]:l},e.notify(u,a))},e};if(typeof DelayNode<"u"){class o extends DelayNode{constructor(a,l,u,p){super(a),l=Math.abs(l),this.delayTime.value=u;const d=a.createGain();d.gain.value=Math.min(Math.abs(p),.995),this.feedback=d.gain;const f=a.createGain();return f.gain.value=l,this.delayGain=f,this.connect(d),this.connect(f),d.connect(this),this.connect=g=>f.connect(g),this}start(a){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,a+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(e,a,l){return new o(this,e,a,l)}}var jt={};jt.generateReverb=function(o,e){for(var a=o.audioContext||new AudioContext,l=a.sampleRate,u=o.numChannels||2,p=o.decayTime*1.5,d=Math.round(o.decayTime*l),f=Math.round(p*l),g=Math.round((o.fadeInTime||0)*l),b=Math.pow(1/1e3,1/d),A=a.createBuffer(u,f,l),S=0;S<u;S++){for(var M=A.getChannelData(S),E=0;E<f;E++)M[E]=Wn()*Math.pow(b,E);for(var E=0;E<g;E++)M[E]*=E/g}Gn(A,o.lpFreqStart||0,o.lpFreqEnd||0,o.decayTime,e)},jt.generateGraph=function(o,e,a,l,u){var p=document.createElement("canvas");p.width=e,p.height=a;var d=p.getContext("2d");d.fillStyle="#000",d.fillRect(0,0,p.width,p.height),d.fillStyle="#fff";for(var f=e/o.length,g=a/(u-l),b=0;b<o.length;b++)d.fillRect(b*f,a-(o[b]-l)*g,1,1);return p};var Gn=function(o,e,a,l,u){if(e==0){u(o);return}var p=Vn(o),d=new OfflineAudioContext(o.numberOfChannels,p[0].length,o.sampleRate),f=d.createBufferSource();f.buffer=o;var g=d.createBiquadFilter();e=Math.min(e,o.sampleRate/2),a=Math.min(a,o.sampleRate/2),g.type="lowpass",g.Q.value=1e-4,g.frequency.setValueAtTime(e,0),g.frequency.linearRampToValueAtTime(a,l),f.connect(g),g.connect(d.destination),f.start(),d.oncomplete=function(b){u(b.renderedBuffer)},d.startRendering(),window.filterNode=g},Vn=function(o){for(var e=[],a=0;a<o.numberOfChannels;a++)e[a]=o.getChannelData(a);return e},Wn=function(){return Math.random()*2-1};let fe=o=>console.log(o);const N=(...o)=>fe(...o),Mn=o=>{if(typeof o!="string")return[];const[e,a="",l]=o.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return e?[e,a,l?Number(l):void 0]:[]},xn={c:0,d:2,e:4,f:5,g:7,a:9,b:11},gn={"#":1,b:-1,s:1,f:-1},zt=(o,e=3)=>{const[a,l,u=e]=Mn(o);if(!a)throw new Error('not a note: "'+o+'"');const p=xn[a.toLowerCase()],d=l?.split("").reduce((f,g)=>f+gn[g],0)||0;return(Number(u)+1)*12+p+d},Me=o=>Math.pow(2,(o-69)/12)*440,D$1=(o,e,a)=>Math.min(Math.max(o,e),a),Ln=o=>12*Math.log(o/440)/Math.LN2+69,Kn=(o,e)=>{if(typeof o!="object")throw new Error("valueToMidi: expected object value");let{freq:a,note:l}=o;return typeof a=="number"?Ln(a):typeof l=="string"?zt(l):typeof l=="number"?l:e};function O(o,e=0,a){return isNaN(Number(o))?(!a&&N(`"${o}" is not a number, falling back to ${e}`,"warning"),e):o}const xe=(o,e)=>(o%e+e)%e,he=(o,e)=>xe(Math.round(O(o,0)),e);function ge(o,e){const{s:a,n:l=0}=o;let u=Kn(o,36),p=u-36,d,f=0;if(Array.isArray(e))f=he(l,e.length),d=e[f];else{const b=S=>zt(S)-u,A=Object.keys(e).filter(S=>!S.startsWith("_")).reduce((S,M,E)=>!S||Math.abs(b(M))<Math.abs(b(S))?M:S,null);p=-b(A),f=he(l,e[A].length),d=e[A][f]}const g=`${a}:${f}`;return{transpose:p,url:d,index:f,midi:u,label:g}}typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(o,e,a=1,l=0){const u=Math.floor(D$1(l,0,1)*e.length),p=e.sampleRate*o,d=this.createBuffer(e.numberOfChannels,e.length,e.sampleRate);for(let f=0;f<e.numberOfChannels;f++){let g=e.getChannelData(f),b=d.getChannelData(f);for(let A=0;A<p;A++){let S=(u+A*Math.abs(a))%g.length;a<1&&(S=S*-1),b[A]=g.at(S)||0}}return d},AudioContext.prototype.createReverb=function(o,e,a,l,u,p,d){const f=this.createConvolver();return f.generate=(g=2,b=.1,A=15e3,S=1e3,M,E,F)=>{f.duration=g,f.fade=b,f.lp=A,f.dim=S,f.ir=M,f.irspeed=E,f.irbegin=F,M?f.buffer=this.adjustLength(g,M,E,F):jt.generateReverb({audioContext:this,numChannels:2,decayTime:g,fadeInTime:b,lpFreqStart:A,lpFreqEnd:S},$=>{f.buffer=$})},f.generate(o,e,a,l,u,p,d),f});var pe={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class o extends GainNode{constructor(a,l){if(super(a),!pe[l])throw new Error("vowel: unknown vowel "+l);const{gains:u,qs:p,freqs:d}=pe[l],f=a.createGain();for(let g=0;g<5;g++){const b=a.createGain();b.gain.value=u[g];const A=a.createBiquadFilter();A.type="bandpass",A.Q.value=p[g],A.frequency.value=d[g],this.connect(A),A.connect(b),b.connect(f)}return f.gain.value=8,this.connect=g=>f.connect(g),this}}AudioContext.prototype.createVowelFilter=function(e){return new o(this,e)}}const Tn="data:text/javascript;base64,dmFyIF89ZnVuY3Rpb24oQyl7InVzZSBzdHJpY3QiO3ZhciBUZT1PYmplY3QuZGVmaW5lUHJvcGVydHk7dmFyIHllPShDLEQsTCk9PkQgaW4gQz9UZShDLEQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOkx9KTpDW0RdPUw7dmFyIFN0PShDLEQsTCk9PnllKEMsdHlwZW9mIEQhPSJzeW1ib2wiP0QrIiI6RCxMKTtjbGFzcyBMIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuc3RhcnRlZD0hMSx0aGlzLm5iSW5wdXRzPXQubnVtYmVyT2ZJbnB1dHMsdGhpcy5uYk91dHB1dHM9dC5udW1iZXJPZk91dHB1dHMsdGhpcy5ibG9ja1NpemU9dC5wcm9jZXNzb3JPcHRpb25zLmJsb2NrU2l6ZSx0aGlzLmhvcFNpemU9MTI4LHRoaXMubmJPdmVybGFwcz10aGlzLmJsb2NrU2l6ZS90aGlzLmhvcFNpemUsdGhpcy5pbnB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpLHRoaXMuaW5wdXRCdWZmZXJzSGVhZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQ9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpO2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMoZSwxKTt0aGlzLm91dHB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlPW5ldyBBcnJheSh0aGlzLm5iT3V0cHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iT3V0cHV0cztlKyspdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGUsMSl9cmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKXtmb3IobGV0IHM9MDtzPHRoaXMubmJJbnB1dHM7cysrKXtsZXQgcj10W3NdLmxlbmd0aDtyIT10aGlzLmlucHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKHMscil9Zm9yKGxldCBzPTA7czx0aGlzLm5iT3V0cHV0cztzKyspe2xldCByPWVbc10ubGVuZ3RoO3IhPXRoaXMub3V0cHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhzLHIpfX1hbGxvY2F0ZUlucHV0Q2hhbm5lbHModCxlKXt0aGlzLmlucHV0QnVmZmVyc1t0XT1uZXcgQXJyYXkoZSk7Zm9yKGxldCBzPTA7czxlO3MrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKzEyOCksdGhpcy5pbnB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF09bmV3IEFycmF5KGUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XVtzXT10aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5zdWJhcnJheSgwLHRoaXMuYmxvY2tTaXplKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKX1hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHQsZSl7dGhpcy5vdXRwdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bc109bmV3IEZsb2F0MzJBcnJheSh0aGlzLmJsb2NrU2l6ZSksdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXS5maWxsKDApfXJlYWRJbnB1dHModCl7aWYodFswXS5sZW5ndGgmJnRbMF1bMF0ubGVuZ3RoPT0wKXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5maWxsKDAsdGhpcy5ibG9ja1NpemUpO3JldHVybn1mb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dFtlXVtzXTt0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5zZXQocix0aGlzLmJsb2NrU2l6ZSl9fXdyaXRlT3V0cHV0cyh0KXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dGhpcy5vdXRwdXRCdWZmZXJzW2VdW3NdLnN1YmFycmF5KDAsMTI4KTt0W2VdW3NdLnNldChyKX19c2hpZnRJbnB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KX1zaGlmdE91dHB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJPdXRwdXRzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMub3V0cHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV0uc3ViYXJyYXkodGhpcy5ibG9ja1NpemUtMTI4KS5maWxsKDApfXByZXBhcmVJbnB1dEJ1ZmZlcnNUb1NlbmQoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtlXS5zZXQodGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW2VdKX1oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspZm9yKGxldCBzPTA7czx0aGlzLmJsb2NrU2l6ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdW3NdKz10aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW2VdW3NdL3RoaXMubmJPdmVybGFwc31wcm9jZXNzKHQsZSxzKXtjb25zdCBpPXRbMF1bMF0hPT12b2lkIDA7cmV0dXJuIHRoaXMuc3RhcnRlZCYmIWk/ITE6KHRoaXMuc3RhcnRlZD1pLHRoaXMucmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKSx0aGlzLnJlYWRJbnB1dHModCksdGhpcy5zaGlmdElucHV0QnVmZmVycygpLHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpLHRoaXMucHJvY2Vzc09MQSh0aGlzLmlucHV0QnVmZmVyc1RvU2VuZCx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlLHMpLHRoaXMuaGFuZGxlT3V0cHV0QnVmZmVyc1RvUmV0cmlldmUoKSx0aGlzLndyaXRlT3V0cHV0cyhlKSx0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpLCEwKX1wcm9jZXNzT0xBKHQsZSxzKXtjb25zb2xlLmFzc2VydCghMSwiTm90IG92ZXJyaWRlbiIpfX1jbGFzcyBrdHtjb25zdHJ1Y3Rvcih0KXtpZih0aGlzLnNpemU9dHwwLHRoaXMuc2l6ZTw9MXx8dGhpcy5zaXplJnRoaXMuc2l6ZS0xKXRocm93IG5ldyBFcnJvcigiRkZUIHNpemUgbXVzdCBiZSBhIHBvd2VyIG9mIHR3byBhbmQgYmlnZ2VyIHRoYW4gMSIpO3RoaXMuX2NzaXplPXQ8PDE7Zm9yKHZhciBlPW5ldyBBcnJheSh0aGlzLnNpemUqMikscz0wO3M8ZS5sZW5ndGg7cys9Mil7Y29uc3QgYz1NYXRoLlBJKnMvdGhpcy5zaXplO2Vbc109TWF0aC5jb3MoYyksZVtzKzFdPS1NYXRoLnNpbihjKX10aGlzLnRhYmxlPWU7Zm9yKHZhciByPTAsaT0xO3RoaXMuc2l6ZT5pO2k8PD0xKXIrKzt0aGlzLl93aWR0aD1yJTI9PT0wP3ItMTpyLHRoaXMuX2JpdHJldj1uZXcgQXJyYXkoMTw8dGhpcy5fd2lkdGgpO2Zvcih2YXIgbz0wO288dGhpcy5fYml0cmV2Lmxlbmd0aDtvKyspe3RoaXMuX2JpdHJldltvXT0wO2Zvcih2YXIgYT0wO2E8dGhpcy5fd2lkdGg7YSs9Mil7dmFyIHU9dGhpcy5fd2lkdGgtYS0yO3RoaXMuX2JpdHJldltvXXw9KG8+Pj5hJjMpPDx1fX10aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGwsdGhpcy5faW52PTB9ZnJvbUNvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHxuZXcgQXJyYXkodC5sZW5ndGg+Pj4xKSxyPTA7cjx0Lmxlbmd0aDtyKz0yKXNbcj4+PjFdPXRbcl07cmV0dXJuIHN9Y3JlYXRlQ29tcGxleEFycmF5KCl7Y29uc3QgdD1uZXcgQXJyYXkodGhpcy5fY3NpemUpO2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV09MDtyZXR1cm4gdH10b0NvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHx0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpLHI9MDtyPHMubGVuZ3RoO3IrPTIpc1tyXT10W3I+Pj4xXSxzW3IrMV09MDtyZXR1cm4gc31jb21wbGV0ZVNwZWN0cnVtKHQpe2Zvcih2YXIgZT10aGlzLl9jc2l6ZSxzPWU+Pj4xLHI9MjtyPHM7cis9Mil0W2Utcl09dFtyXSx0W2UtcisxXT0tdFtyKzFdfXRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3RyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9cmVhbFRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3JlYWxUcmFuc2Zvcm00KCksdGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfWludmVyc2VUcmFuc2Zvcm0odCxlKXtpZih0PT09ZSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCIpO3RoaXMuX291dD10LHRoaXMuX2RhdGE9ZSx0aGlzLl9pbnY9MSx0aGlzLl90cmFuc2Zvcm00KCk7Zm9yKHZhciBzPTA7czx0Lmxlbmd0aDtzKyspdFtzXS89dGhpcy5zaXplO3RoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1fdHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IGQ9dVthXTt0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG8sZCxyKX1lbHNlIGZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgZD11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTQobyxkLHIpfXZhciBjPXRoaXMuX2ludj8tMToxLGg9dGhpcy50YWJsZTtmb3Iocj4+PTI7cj49MjtyPj49Mil7aT1lL3I8PDE7dmFyIGY9aT4+PjI7Zm9yKG89MDtvPGU7bys9aSlmb3IodmFyIHA9bytmLGw9byxtPTA7bDxwO2wrPTIsbSs9cil7Y29uc3QgZD1sLGI9ZCtmLEk9YitmLHY9SStmLFA9dFtkXSx3PXRbZCsxXSxUPXRbYl0sQj10W2IrMV0sQT10W0ldLHk9dFtJKzFdLE89dFt2XSxxPXRbdisxXSx4PVAsRT13LE49aFttXSxGPWMqaFttKzFdLFY9VCpOLUIqRixrPVQqRitCKk4sUj1oWzIqbV0sWD1jKmhbMiptKzFdLHR0PUEqUi15KlgsZXQ9QSpYK3kqUixzdD1oWzMqbV0scnQ9YypoWzMqbSsxXSxudD1PKnN0LXEqcnQsaXQ9TypydCtxKnN0LG90PXgrdHQsSz1FK2V0LGo9eC10dCxhdD1FLWV0LGN0PVYrbnQsWj1rK2l0LCQ9YyooVi1udCksdXQ9Yyooay1pdCksbHQ9b3QrY3QsZ3Q9SytaLGJ0PW90LWN0LEl0PUstWixfdD1qK3V0LEJ0PWF0LSQsTXQ9ai11dCxQdD1hdCskO3RbZF09bHQsdFtkKzFdPWd0LHRbYl09X3QsdFtiKzFdPUJ0LHRbSV09YnQsdFtJKzFdPUl0LHRbdl09TXQsdFt2KzFdPVB0fX19X3NpbmdsZVRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPWlbZV0sYT1pW2UrMV0sdT1pW2Urc10sYz1pW2UrcysxXSxoPW8rdSxmPWErYyxwPW8tdSxsPWEtYztyW3RdPWgsclt0KzFdPWYsclt0KzJdPXAsclt0KzNdPWx9X3NpbmdsZVRyYW5zZm9ybTQodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPXRoaXMuX2ludj8tMToxLGE9cyoyLHU9cyozLGM9aVtlXSxoPWlbZSsxXSxmPWlbZStzXSxwPWlbZStzKzFdLGw9aVtlK2FdLG09aVtlK2ErMV0sZD1pW2UrdV0sYj1pW2UrdSsxXSxJPWMrbCx2PWgrbSxQPWMtbCx3PWgtbSxUPWYrZCxCPXArYixBPW8qKGYtZCkseT1vKihwLWIpLE89SStULHE9ditCLHg9UCt5LEU9dy1BLE49SS1ULEY9di1CLFY9UC15LGs9dytBO3JbdF09TyxyW3QrMV09cSxyW3QrMl09eCxyW3QrM109RSxyW3QrNF09TixyW3QrNV09RixyW3QrNl09VixyW3QrN109a31fcmVhbFRyYW5zZm9ybTQoKXt2YXIgdD10aGlzLl9vdXQsZT10aGlzLl9jc2l6ZSxzPXRoaXMuX3dpZHRoLHI9MTw8cyxpPWUvcjw8MSxvLGEsdT10aGlzLl9iaXRyZXY7aWYoaT09PTQpZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCB3dD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm0yKG8sd3Q+Pj4xLHI+Pj4xKX1lbHNlIGZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3Qgd3Q9dVthXTt0aGlzLl9zaW5nbGVSZWFsVHJhbnNmb3JtNChvLHd0Pj4+MSxyPj4+MSl9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+MSxwPWY+Pj4xLGw9cD4+PjE7Zm9yKG89MDtvPGU7bys9aSlmb3IodmFyIG09MCxkPTA7bTw9bDttKz0yLGQrPXIpe3ZhciBiPW8rbSxJPWIrcCx2PUkrcCxQPXYrcCx3PXRbYl0sVD10W2IrMV0sQj10W0ldLEE9dFtJKzFdLHk9dFt2XSxPPXRbdisxXSxxPXRbUF0seD10W1ArMV0sRT13LE49VCxGPWhbZF0sVj1jKmhbZCsxXSxrPUIqRi1BKlYsUj1CKlYrQSpGLFg9aFsyKmRdLHR0PWMqaFsyKmQrMV0sZXQ9eSpYLU8qdHQsc3Q9eSp0dCtPKlgscnQ9aFszKmRdLG50PWMqaFszKmQrMV0saXQ9cSpydC14Km50LG90PXEqbnQreCpydCxLPUUrZXQsaj1OK3N0LGF0PUUtZXQsY3Q9Ti1zdCxaPWsraXQsJD1SK290LHV0PWMqKGstaXQpLGx0PWMqKFItb3QpLGd0PUsrWixidD1qKyQsSXQ9YXQrbHQsX3Q9Y3QtdXQ7aWYodFtiXT1ndCx0W2IrMV09YnQsdFtJXT1JdCx0W0krMV09X3QsbT09PTApe3ZhciBCdD1LLVosTXQ9ai0kO3Rbdl09QnQsdFt2KzFdPU10O2NvbnRpbnVlfWlmKG0hPT1sKXt2YXIgUHQ9YXQsbWU9LWN0LHZlPUssZ2U9LWosYmU9LWMqbHQsSWU9LWMqdXQsX2U9LWMqJCxCZT0tYypaLE1lPVB0K2JlLFBlPW1lK0llLHdlPXZlK0JlLFNlPWdlLV9lLEN0PW8rcC1tLEV0PW8rZi1tO3RbQ3RdPU1lLHRbQ3QrMV09UGUsdFtFdF09d2UsdFtFdCsxXT1TZX19fX1fc2luZ2xlUmVhbFRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPWlbZV0sYT1pW2Urc10sdT1vK2EsYz1vLWE7clt0XT11LHJbdCsxXT0wLHJbdCsyXT1jLHJbdCszXT0wfV9zaW5nbGVSZWFsVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlK3NdLGY9aVtlK2FdLHA9aVtlK3VdLGw9YytmLG09Yy1mLGQ9aCtwLGI9byooaC1wKSxJPWwrZCx2PW0sUD0tYix3PWwtZCxUPW0sQj1iO3JbdF09SSxyW3QrMV09MCxyW3QrMl09dixyW3QrM109UCxyW3QrNF09dyxyW3QrNV09MCxyW3QrNl09VCxyW3QrN109Qn19bGV0IER0PW49PmNvbnNvbGUubG9nKG4pO2NvbnN0IHp0PSguLi5uKT0+RHQoLi4ubikscXQ9KG4sdCxlKT0+TWF0aC5taW4oTWF0aC5tYXgobix0KSxlKSxUdD1uPT5uLygxK24pLFd0PShuLHQpPT4obiV0K3QpJXQsTHQ9KG4sdCk9PigxK3QpKm4vKDErdCpNYXRoLmFicyhuKSksWT0obix0KT0+TWF0aC50YW5oKG4qKDErdCkpLFl0PShuLHQpPT5xdCgoMSt0KSpuLC0xLDEpLHl0PShuLHQpPT57bGV0IGU9KDErLjUqdCkqbjtjb25zdCBzPVd0KGUrMSw0KTtyZXR1cm4gMS1NYXRoLmFicyhzLTIpfSxIdD0obix0KT0+TWF0aC5zaW4oTWF0aC5QSS8yKnl0KG4sdCkpLFV0PShuLHQpPT57Y29uc3QgZT1UdChNYXRoLmxvZzFwKHQpKSxzPShuLWUvMypuKm4qbikvKDEtZS8zKTtyZXR1cm4gWShzLHQpfSxBdD0obix0LGU9ITEpPT57Y29uc3Qgcz0xKzIqdCxpPS4wNypUdChNYXRoLmxvZzFwKHQpKSxvPVkobitpLDIqdCksYT1ZKGU/aTotbitpLDIqdCksdT1vLWEsYz0xL01hdGguY29zaChzKmkpLGg9YypjLGY9TWF0aC5tYXgoMWUtOCwoZT8xOjIpKnMqaCk7cmV0dXJuIFkodS9mLHQpfSxPdD17c2N1cnZlOkx0LHNvZnQ6WSxoYXJkOll0LGN1YmljOlV0LGRpb2RlOkF0LGFzeW06KG4sdCk9PkF0KG4sdCwhMCksZm9sZDp5dCxzaW5lZm9sZDpIdCxjaGVieXNoZXY6KG4sdCk9Pntjb25zdCBlPTEwKk1hdGgubG9nMXAodCk7bGV0IHM9MSxyPW4saSxvPTA7Zm9yKGxldCBhPTE7YTw2NDthKyspe2lmKGE8Mil7bys9YT09MD9zOnI7Y29udGludWV9aT0yKm4qcy1yLHI9cyxzPWksYSUyPT09MCYmKG8rPU1hdGgubWluKDEuMyplL2EsMikqaSl9cmV0dXJuIFkobyxlLzIwKX19LEc9T2JqZWN0LmZyZWV6ZShPYmplY3Qua2V5cyhPdCkpLEt0PW49PntsZXQgdD1uO3R5cGVvZiBuPT0ic3RyaW5nIiYmKHQ9Ry5pbmRleE9mKG4pLHQ9PT0tMSYmKHp0KGBbc3VwZXJkb3VnaF0gQ291bGQgbm90IGZpbmQgd2F2ZXNoYXBpbmcgYWxnb3JpdGhtICR7bn0uCiAgICAgICAgQXZhaWxhYmxlIG9wdGlvbnMgYXJlICR7Ry5qb2luKCIsICIpfS4KICAgICAgICBEZWZhdWx0aW5nIHRvICR7R1swXX0uYCksdD0wKSk7Y29uc3QgZT1HW3QlRy5sZW5ndGhdO3JldHVybiBPdFtlXX0sTT0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLHh0PShuLHQpPT4obiV0K3QpJXQsanQ9KG4sdCxlKT0+ZSoodC1uKStuLFM9KG4sdCk9Pm5bdF0/P25bMF0sVz1uPT5uLU1hdGguZmxvb3IobiksZnQ9bj0+bnwwLE50PShuLHQsZSk9Pm48Mj8wOmp0KC10Ki41LHQqLjUsZS8obi0xKSksSD0obix0KT0+bipNYXRoLnBvdygyLHQvMTIpO2Z1bmN0aW9uIEZ0KG4sdD0xKXtyZXR1cm4gbj49dD9uLT10Om48MCYmKG4rPXQpLG59Y29uc3QgVT0xMjg7ZnVuY3Rpb24gWnQobix0KXtyZXR1cm4gdD1NYXRoLm1pbih0LDEtdCksbjx0PyhuLz10LG4rbi1uKm4tMSk6bj4xLXQ/KG49KG4tMSkvdCxuKm4rbituKzEpOjB9Y29uc3QgcHQ9e3RyaShuLHQ9LjUpe2NvbnN0IGU9MS10O3JldHVybiBuPj10PzEvZS1uL2U6bi90fSxzaW5lKG4pe3JldHVybiBNYXRoLnNpbihNYXRoLlBJKjIqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPU0odFtzXSwwLDEpLGE9TSh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtWnQobix0KX19O2Z1bmN0aW9uIFEobix0KXtyZXR1cm4gdC5sZW5ndGg+MT90W25dOnRbMF19Y29uc3QgJHQ9T2JqZWN0LmtleXMocHQpO2NsYXNzIEd0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6InRpbWUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOi41fSx7bmFtZToic2tldyIsZGVmYXVsdFZhbHVlOi41fSx7bmFtZToiZGVwdGgiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToicGhhc2VvZmZzZXQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToic2hhcGUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToiY3VydmUiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZGNvZmZzZXQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToibWluIixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1heCIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZX1pbmNyZW1lbnRQaGFzZSh0KXt0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2U9dGhpcy5waGFzZS0xKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXMuYmVnaW5bMF07aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2lmKGN1cnJlbnRUaW1lPD1yKXJldHVybiEwO2NvbnN0IGk9ZVswXSxvPXMuZnJlcXVlbmN5WzBdLGE9cy50aW1lWzBdLHU9cy5kZXB0aFswXSxjPXMuc2tld1swXSxoPXMucGhhc2VvZmZzZXRbMF0sZj1zLmN1cnZlWzBdLHA9cy5kY29mZnNldFswXSxsPXMubWluWzBdLG09cy5tYXhbMF0sZD0kdFtzLnNoYXBlWzBdXSxiPWlbMF0ubGVuZ3RoPz8wO3RoaXMucGhhc2U9PW51bGwmJih0aGlzLnBoYXNlPXh0KGEqbytoLDEpKTtjb25zdCBJPW8vc2FtcGxlUmF0ZTtmb3IobGV0IHY9MDt2PGI7disrKXtmb3IobGV0IFA9MDtQPGkubGVuZ3RoO1ArKyl7bGV0IHc9KHB0W2RdKHRoaXMucGhhc2UsYykrcCkqdTt3PU1hdGgucG93KHcsZiksaVtQXVt2XT1NKHcsbCxtKX10aGlzLmluY3JlbWVudFBoYXNlKEkpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGZvLXByb2Nlc3NvciIsR3QpO2NsYXNzIFF0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImNvYXJzZSIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5jb2Fyc2VbMF0/PzA7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8VTt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspaVtjXVt1XT11JWE9PT0wP3JbY11bdV06aVtjXVt1LTFdO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiY29hcnNlLXByb2Nlc3NvciIsUXQpO2NsYXNzIEp0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImNydXNoIixkZWZhdWx0VmFsdWU6MH1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNydXNoWzBdPz84O2E9TWF0aC5tYXgoMSxhKTtmb3IobGV0IHU9MDt1PFU7dSsrKWZvcihsZXQgYz0wO2M8ci5sZW5ndGg7YysrKXtjb25zdCBoPU1hdGgucG93KDIsYS0xKTtpW2NdW3VdPU1hdGgucm91bmQocltjXVt1XSpoKS9ofXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiY3J1c2gtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToic2hhcGUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuc2hhcGVbMF07YT1hPDE/YTouOTk5OTk5OTk5NixhPTIqYS8oMS1hKTtjb25zdCB1PU1hdGgubWF4KC4wMDEsTWF0aC5taW4oMSxzLnBvc3RnYWluWzBdKSk7Zm9yKGxldCBjPTA7YzxVO2MrKylmb3IobGV0IGg9MDtoPHIubGVuZ3RoO2grKylpW2hdW2NdPSgxK2EpKnJbaF1bY10vKDErYSpNYXRoLmFicyhyW2hdW2NdKSkqdTtyZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInNoYXBlLXByb2Nlc3NvciIsWHQpO2NsYXNzIFZ0e2NvbnN0cnVjdG9yKCl7U3QodGhpcywiczAiLDApO1N0KHRoaXMsInMxIiwwKX11cGRhdGUodCxlLHM9MCl7cz1NKHMsMCwxKSxlPU0oZSwwLHNhbXBsZVJhdGUvMi0xKTtjb25zdCByPU0oMipNYXRoLnNpbihlKihkdC9zYW1wbGVSYXRlKSksMCwxLjE0KSxvPTEtTWF0aC5wb3coLjUsKHMrLjEyNSkvLjEyNSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgdGUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBWdCxuZXcgVnRdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9TShzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgcD0wO3A8VTtwKyspdT09Im5vbmUiP2lbZl1bcF09cltmXVtwXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW3BdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW3BdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtwXT1yW2ZdW3BdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW3BdPXJbZl1bcF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsdGUpO2Z1bmN0aW9uIHoobil7Y29uc3QgdD1uKm47cmV0dXJuIG4qKDI3K3QpLygyNys5KnQpfWNvbnN0IGR0PTMuMTQxNTkyNjUzNTk7Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NTAwfSx7bmFtZToicSIsZGVmYXVsdFZhbHVlOjF9LHtuYW1lOiJkcml2ZSIsZGVmYXVsdFZhbHVlOi42OX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5wMD1bMCwwXSx0aGlzLnAxPVswLDBdLHRoaXMucDI9WzAsMF0sdGhpcy5wMz1bMCwwXSx0aGlzLnAzMj1bMCwwXSx0aGlzLnAzMz1bMCwwXSx0aGlzLnAzND1bMCwwXX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9cy5xWzBdLHU9TShNYXRoLmV4cChzLmRyaXZlWzBdKSwuMSwyZTMpO2xldCBjPXMuZnJlcXVlbmN5WzBdO2M9YyoyKmR0L3NhbXBsZVJhdGUsYz1jPjE/MTpjO2NvbnN0IGg9TWF0aC5taW4oOCxhKi4xMyk7bGV0IGY9MS91Kk1hdGgubWluKDEuNzUsMStoKTtmb3IobGV0IHA9MDtwPFU7cCsrKWZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXtjb25zdCBtPXRoaXMucDNbbF0qLjM2MDg5MSt0aGlzLnAzMltsXSouNDE3MjkrdGhpcy5wMzNbbF0qLjE3Nzg5Nit0aGlzLnAzNFtsXSouMDQzOTcyNTt0aGlzLnAzNFtsXT10aGlzLnAzM1tsXSx0aGlzLnAzM1tsXT10aGlzLnAzMltsXSx0aGlzLnAzMltsXT10aGlzLnAzW2xdLHRoaXMucDBbbF0rPSh6KHJbbF1bcF0qdS1oKm0pLXoodGhpcy5wMFtsXSkpKmMsdGhpcy5wMVtsXSs9KHoodGhpcy5wMFtsXSkteih0aGlzLnAxW2xdKSkqYyx0aGlzLnAyW2xdKz0oeih0aGlzLnAxW2xdKS16KHRoaXMucDJbbF0pKSpjLHRoaXMucDNbbF0rPSh6KHRoaXMucDJbbF0pLXoodGhpcy5wM1tsXSkpKmMsaVtsXVtwXT1tKmZ9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsYWRkZXItcHJvY2Vzc29yIixlZSk7Y2xhc3Mgc2UgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiZGlzdG9ydCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcih7cHJvY2Vzc29yT3B0aW9uczp0fSl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5hbGdvcml0aG09S3QodC5hbGdvcml0aG0pfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87Zm9yKGxldCBhPTA7YTxVO2ErKyl7Y29uc3QgdT1NKFMocy5wb3N0Z2FpbixhKSwuMDAxLDEpLGM9TWF0aC5leHBtMShTKHMuZGlzdG9ydCxhKSk7Zm9yKGxldCBoPTA7aDxyLmxlbmd0aDtoKyspe2NvbnN0IGY9cltoXVthXTtpW2hdW2FdPXUqdGhpcy5hbGdvcml0aG0oZixjKX19cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJkaXN0b3J0LXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBoYXNlPVtdfXN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6InBhbnNwcmVhZCIsZGVmYXVsdFZhbHVlOi40LG1pbjowLG1heDoxfSx7bmFtZToiZnJlcXNwcmVhZCIsZGVmYXVsdFZhbHVlOi4yLG1pbjowfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46MH0se25hbWU6InZvaWNlcyIsZGVmYXVsdFZhbHVlOjUsbWluOjF9XX1wcm9jZXNzKHQsZSxzKXtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7Y29uc3Qgcj1lWzBdO2ZvcihsZXQgaT0wO2k8clswXS5sZW5ndGg7aSsrKXtjb25zdCBvPVMocy5kZXR1bmUsaSksYT1TKHMudm9pY2VzLGkpLHU9UyhzLmZyZXFzcHJlYWQsaSksYz1TKHMucGFuc3ByZWFkLGkpKi41Ky41LGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyk7bGV0IHA9UyhzLmZyZXF1ZW5jeSxpKTtwPUgocCxvLzEwMCk7Zm9yKGxldCBsPTA7bDxhO2wrKyl7Y29uc3QgbT0obCYxKT09MTtsZXQgZD1oLGI9ZjttJiYoZD1mLGI9aCk7Y29uc3QgST1IKHAsTnQoYSx1LGwpKSx2PXh0KEkvc2FtcGxlUmF0ZSwxKTt0aGlzLnBoYXNlW2xdPXRoaXMucGhhc2VbbF0/P01hdGgucmFuZG9tKCk7Y29uc3QgUD1wdC5zYXdibGVwKHRoaXMucGhhc2VbbF0sdik7clswXVtpXT1yWzBdW2ldK1AqZCxyWzFdW2ldPXJbMV1baV0rUCpiLHRoaXMucGhhc2VbbF09RnQodGhpcy5waGFzZVtsXSt2KX19cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJzdXBlcnNhdy1vc2NpbGxhdG9yIixyZSk7Y29uc3QgbmU9MjA0ODtmdW5jdGlvbiBpZShuKXtsZXQgdD1uZXcgRmxvYXQzMkFycmF5KG4pO2Zvcih2YXIgZT0wO2U8bjtlKyspdFtlXT0uNSooMS1NYXRoLmNvcygyKk1hdGguUEkqZS9uKSk7cmV0dXJuIHR9Y2xhc3Mgb2UgZXh0ZW5kcyBMe3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOm5lfSxzdXBlcih0KSx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy50aW1lQ3Vyc29yPTAsdGhpcy5oYW5uV2luZG93PWllKHRoaXMuYmxvY2tTaXplKSx0aGlzLmZmdD1uZXcga3QodGhpcy5mZnRTaXplKSx0aGlzLmZyZXFDb21wbGV4QnVmZmVyPXRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkPXRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpLHRoaXMudGltZUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5tYWduaXR1ZGVzPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5mZnRTaXplLzIrMSksdGhpcy5wZWFrSW5kZXhlcz1uZXcgSW50MzJBcnJheSh0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSx0aGlzLm5iUGVha3M9MH1wcm9jZXNzT0xBKHQsZSxzKXtsZXQgcj1zLnBpdGNoRmFjdG9yW3MucGl0Y2hGYWN0b3IubGVuZ3RoLTFdO3I8MCYmKHI9ciouMjUpLHI9TWF0aC5tYXgoMCxyKzEpO2Zvcih2YXIgaT0wO2k8dGhpcy5uYklucHV0cztpKyspZm9yKHZhciBvPTA7bzx0W2ldLmxlbmd0aDtvKyspe3ZhciBhPXRbaV1bb10sdT1lW2ldW29dO3RoaXMuYXBwbHlIYW5uV2luZG93KGEpLHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlcixhKSx0aGlzLmNvbXB1dGVNYWduaXR1ZGVzKCksdGhpcy5maW5kUGVha3MoKSx0aGlzLnNoaWZ0UGVha3MociksdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkKSx0aGlzLmZmdC5mcm9tQ29tcGxleEFycmF5KHRoaXMudGltZUNvbXBsZXhCdWZmZXIsdSksdGhpcy5hcHBseUhhbm5XaW5kb3codSl9dGhpcy50aW1lQ3Vyc29yKz10aGlzLmhvcFNpemV9YXBwbHlIYW5uV2luZG93KHQpe2Zvcih2YXIgZT0wO2U8dGhpcy5ibG9ja1NpemU7ZSsrKXRbZV09dFtlXSp0aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2Zvcih2YXIgdD0wLGU9MDt0PHRoaXMubWFnbml0dWRlcy5sZW5ndGg7KXtsZXQgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDt2YXIgdD0yO2xldCBlPXRoaXMubWFnbml0dWRlcy5sZW5ndGgtMjtmb3IoO3Q8ZTspe2xldCBzPXRoaXMubWFnbml0dWRlc1t0XTtpZih0aGlzLm1hZ25pdHVkZXNbdC0xXT49c3x8dGhpcy5tYWduaXR1ZGVzW3QtMl0+PXMpe3QrKztjb250aW51ZX1pZih0aGlzLm1hZ25pdHVkZXNbdCsxXT49c3x8dGhpcy5tYWduaXR1ZGVzW3QrMl0+PXMpe3QrKztjb250aW51ZX10aGlzLnBlYWtJbmRleGVzW3RoaXMubmJQZWFrc109dCx0aGlzLm5iUGVha3MrKyx0Kz0yfX1zaGlmdFBlYWtzKHQpe3RoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkLmZpbGwoMCk7Zm9yKHZhciBlPTA7ZTx0aGlzLm5iUGVha3M7ZSsrKXtsZXQgbz10aGlzLnBlYWtJbmRleGVzW2VdLGE9TWF0aC5yb3VuZChvKnQpO2lmKGE+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhazt2YXIgcz0wLHI9dGhpcy5mZnRTaXplO2lmKGU+MCl7bGV0IGg9dGhpcy5wZWFrSW5kZXhlc1tlLTFdO3M9by1NYXRoLmZsb29yKChvLWgpLzIpfWlmKGU8dGhpcy5uYlBlYWtzLTEpe2xldCBoPXRoaXMucGVha0luZGV4ZXNbZSsxXTtyPW8rTWF0aC5jZWlsKChoLW8pLzIpfWxldCB1PXMtbyxjPXItbztmb3IodmFyIGk9dTtpPGM7aSsrKXtsZXQgaD1vK2ksZj1hK2k7aWYoZj49dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgcD0yKk1hdGguUEkqKGYtaCkvdGhpcy5mZnRTaXplLGw9TWF0aC5jb3MocCp0aGlzLnRpbWVDdXJzb3IpLG09TWF0aC5zaW4ocCp0aGlzLnRpbWVDdXJzb3IpLGQ9aCoyLGI9ZCsxLEk9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltkXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbYl0sUD1JKmwtdiptLHc9SSptK3YqbCxUPWYqMixCPVQrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtUXSs9UCx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtCXSs9d319fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLG9lKTtjbGFzcyBhZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waT1kdCx0aGlzLnBoaT0tdGhpcy5waSx0aGlzLlkwPTAsdGhpcy5ZMT0wLHRoaXMuUFc9dGhpcy5waSx0aGlzLkI9Mi4zLHRoaXMuZHBoaWY9MCx0aGlzLmVudmY9MH1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJkZXR1bmUiLGRlZmF1bHRWYWx1ZTowLG1pbjpOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWX0se25hbWU6InB1bHNld2lkdGgiLGRlZmF1bHRWYWx1ZToxLG1pbjowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7Y29uc3Qgcj1lWzBdO2xldCBpPTEsbztmb3IobGV0IGE9MDthPChyWzBdLmxlbmd0aD8/MCk7YSsrKXtjb25zdCB1PSgxLU0oUShhLHMucHVsc2V3aWR0aCksLS45OSwuOTkpKSp0aGlzLnBpLGM9UShhLHMuZGV0dW5lKSxoPUgoUShhLHMuZnJlcXVlbmN5KSxjLzEwMCk7bz1oKih0aGlzLnBpLyhzYW1wbGVSYXRlKi41KSksdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49dGhpcy5waSYmKHRoaXMucGhpLT0yKnRoaXMucGkpO2xldCBmPU1hdGguY29zKHRoaXMucGhpK3RoaXMuQip0aGlzLlkwKTt0aGlzLlkwPS41KihmK3RoaXMuWTApO2xldCBwPU1hdGguY29zKHRoaXMucGhpK3RoaXMuQip0aGlzLlkxK3UpO3RoaXMuWTE9LjUqKHArdGhpcy5ZMSk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVthXT0uMTUqKGYtcCkqdGhpcy5lbnZmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigicHVsc2Utb3NjaWxsYXRvciIsYWUpO2NvbnN0IG10PXtiaXRDOmZ1bmN0aW9uKG4sdCxlKXtyZXR1cm4gbiZ0P2U6MH0sYnI6ZnVuY3Rpb24obix0PTgpe2lmKHQ+MzIpdGhyb3cgbmV3IEVycm9yKCJicigpIFNpemUgY2Fubm90IGJlIGdyZWF0ZXIgdGhhbiAzMiIpO3tsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dC0wO3MrKyllKz1tdC5iaXRDKG4sMioqcywyKioodC0ocysxKSkpO3JldHVybiBlfX0sc2luZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC5zaW4obi8oMTI4L01hdGguUEkpKX0sY29zZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC5jb3Mobi8oMTI4L01hdGguUEkpKX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obi8oMTI4L01hdGguUEkpKX0scmVnRzpmdW5jdGlvbihuLHQpe3JldHVybiB0LnRlc3Qobi50b1N0cmluZygyKSl9fTtsZXQgSixodDtmdW5jdGlvbiBjZShuKXtpZigoSnx8aHQpPT1udWxsKXtKPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE1hdGgpLGh0PUoubWFwKHM9Pk1hdGhbc10pO2NvbnN0IHQ9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobXQpLGU9dC5tYXAocz0+bXRbc10pO0oucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSxodC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLkosInQiLGByZXR1cm4gMCwKJHtufHwwfTtgKS5iaW5kKGdsb2JhbFRoaXMsLi4uaHQpfWNsYXNzIHVlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBvcnQub25tZXNzYWdlPXQ9PntsZXR7Y29kZVRleHQ6ZX09dC5kYXRhO2NvbnN0e2J5dGVCZWF0U3RhcnRUaW1lOnN9PXQuZGF0YTtzIT1udWxsJiYodGhpcy50PTAsdGhpcy5pbml0aWFsT2Zmc2V0PU1hdGguZmxvb3IocykpLGU9ZS50cmltKCkucmVwbGFjZSgvXmV2YWxcKHVuZXNjYXBlXChlc2NhcGUoPzpgfFwoJ3xcKCJ8XChgKSguKj8pKD86YHwnXCl8IlwpfGBcKSkucmVwbGFjZVwoXC91XChcLlwuXClcL2csWyInYF1cJDElWyInYF1cKVwpXCkkLywocixpKT0+dW5lc2NhcGUoZXNjYXBlKGkpLnJlcGxhY2UoL3UoLi4pL2csIiQxJSIpKSksdGhpcy5mdW5jPWNlKGUpfSx0aGlzLmluaXRpYWxPZmZzZXQ9bnVsbCx0aGlzLnQ9bnVsbCx0aGlzLmZ1bmM9bnVsbH1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJkZXR1bmUiLGRlZmF1bHRWYWx1ZTowLG1pbjpOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWX0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH1dfXByb2Nlc3ModCxlLHMpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2lmKGN1cnJlbnRUaW1lPD1zLmJlZ2luWzBdKXJldHVybiEwO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTt0aGlzLnQ9PW51bGwmJih0aGlzLnQ9cy5iZWdpblswXSpzYW1wbGVSYXRlKTtjb25zdCByPWVbMF07Zm9yKGxldCBpPTA7aTxyWzBdLmxlbmd0aDtpKyspe2NvbnN0IG89UShpLHMuZGV0dW5lKSxhPUgoUShpLHMuZnJlcXVlbmN5KSxvLzEwMCk7bGV0IHU9dGhpcy50LyhzYW1wbGVSYXRlLzI1NikqYSt0aGlzLmluaXRpYWxPZmZzZXQ7Y29uc3QgZj0oKHRoaXMuZnVuYyh1KSYyNTUpLzEyNy41LTEpKi4yO2ZvcihsZXQgcD0wO3A8ci5sZW5ndGg7cCsrKXJbcF1baV09TShmLC0uNCwuNCk7dGhpcy50PXRoaXMudCsxfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsdWUpO2NvbnN0IGc9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gaGUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBSdD1uPT4oaGUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBsZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBmZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1SdCh0KSxyPVJ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBwZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKmZlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IHZ0PXt9O2NsYXNzIGRlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxfSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLmludlNSPTEvc2FtcGxlUmF0ZSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhdnRbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgcD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspcFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBwfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha312dFtpXT1vfXRoaXMudGFibGVzPXZ0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOk1hdGgucm91bmQoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIGcuTk9ORTpyZXR1cm4gdDtjYXNlIGcuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBnLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsZy5BU1lNKSk7Y2FzZSBnLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIGcuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIGcuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgZy5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqZSk7cmV0dXJuIHQqciUxfWNhc2UgZy5RVUFOVDp7Y29uc3R7bjpyfT10aGlzLl90b0JpdHMoZSk7cmV0dXJuIGZ0KHQqcikvcn1jYXNlIGcuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsTWF0aC5yb3VuZCg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoVyhpKnQpLS41KSoyfWNhc2UgZy5QV006e2NvbnN0IHI9TSguNSsuNDkqKDIqZS0xKSwwLDEpO3JldHVybiB0PHI/dC9yKi41Oi41Kyh0LXIpLygxLXIpKi41fWNhc2UgZy5PUkJJVDp7Y29uc3Qgcj0uNSplO3JldHVybiBXKHQrcipNYXRoLnNpbigyKk1hdGguUEkqMyp0KSl9Y2FzZSBnLlNQSU46e2NvbnN0IHI9LjUqZSx7bjppfT10aGlzLl90b0JpdHMoZSwxLDYpO3JldHVybiBXKHQrcipNYXRoLnNpbigyKk1hdGguUEkqaSp0KSl9Y2FzZSBnLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gTSgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgZy5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKmE8PW87YSs9MilpZihvJWE9PT0wKXJldHVybiExO3JldHVybiEwfTtsZXR7bjppfT10aGlzLl90b0JpdHMoZSwzKTtmb3IoOyFyKGkpOylpKys7cmV0dXJuIGZ0KHQqaSkvaX1jYXNlIGcuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPU1hdGgucm91bmQocik7Y29uc3QgaT0xPDxyLG89ZnQodCppKTtyZXR1cm4gbGUobyxyKS9pfWNhc2UgZy5NT0RVTEFSOntjb25zdHtuOnJ9PXRoaXMuX3RvQml0cyhlKSxpPS41KmUsbz1XKHQqcikvcjtyZXR1cm4gVyh0K2kqbyl9Y2FzZSBnLkJST1dOSUFOOntjb25zdCByPS4yNSplKnBlKDY0KnQsNCk7cmV0dXJuIFcodCtyKX1jYXNlIGcuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIE0oYSwwLDEpfWNhc2UgZy5XT1JNSE9MRTp7Y29uc3Qgcj1NKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIGcuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErTWF0aC5yb3VuZCgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIE0ociwwLDEpfWNhc2UgZy5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgZy5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKDIqTWF0aC5QSSp0KSplO3JldHVybiBXKHQrcil9Y2FzZSBnLkZMSVA6cmV0dXJuIHQ7ZGVmYXVsdDpyZXR1cm4gdH19X3NhbXBsZUZyYW1lKHQsZSl7Y29uc3Qgcz10Lmxlbmd0aCxyPWUqcztsZXQgaT1yfDA7aT49cyYmKGk9MCk7Y29uc3Qgbz1yLWksYT10W2ldO2xldCB1PWkrMTt1Pj1zJiYodT0wKTtjb25zdCBjPXRbdV07cmV0dXJuIGErKGMtYSkqb31fY2hvb3NlTWlwKHQpe3ZhciByO2NvbnN0IGU9TSh0LDFlLTYsNjQpO2xldCBzPTA7Zm9yKDtzKzE8KCgocj10aGlzLnRhYmxlcyk9PW51bGw/dm9pZCAwOnIubGVuZ3RoKXx8MSkmJmU8dGhpcy50YWJsZXNbc11bMF0ubGVuZ3RoLzg7KXMrKztyZXR1cm4gc31wcm9jZXNzKHQsZSxzKXtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7Y29uc3Qgcj1lWzBdWzBdLGk9ZVswXVsxXXx8ZVswXVswXTtpZighdGhpcy50YWJsZXMpcmV0dXJuIHIuZmlsbCgwKSxpIT09ciYmaS5zZXQociksITA7Zm9yKGxldCBvPTA7bzxyLmxlbmd0aDtvKyspe2NvbnN0IGE9UyhzLmRldHVuZSxvKSx1PVMocy5mcmVxc3ByZWFkLG8pLGg9TShTKHMucG9zaXRpb24sbyksMCwxKSoodGhpcy5udW1GcmFtZXMtMSksZj1ofDAscD1oLWYsbD1NKFMocy53YXJwLG8pLDAsMSksbT1TKHMud2FycE1vZGUsbyksZD1TKHMudm9pY2VzLG8pLGI9TShTKHMucGhhc2VyYW5kLG8pLDAsMSksST1kPjE/TShTKHMucGFuc3ByZWFkLG8pLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpJKSxQPU1hdGguc3FydCguNSsuNSpJKTtsZXQgdz1TKHMuZnJlcXVlbmN5LG8pO3c9SCh3LGEvMTAwKTtjb25zdCBUPTEvTWF0aC5zcXJ0KGQpO2ZvcihsZXQgQj0wO0I8ZDtCKyspe2NvbnN0IEE9KEImMSk9PTE7bGV0IHk9dixPPVA7QSYmKHk9UCxPPXYpO2NvbnN0IHg9SCh3LE50KGQsdSxCKSkqdGhpcy5pbnZTUixFPXRoaXMuX2Nob29zZU1pcCh4KSxOPXRoaXMudGFibGVzW0VdO3RoaXMucGhhc2VbQl09dGhpcy5waGFzZVtCXT8/TWF0aC5yYW5kb20oKSpiO2NvbnN0IEY9dGhpcy5fd2FycFBoYXNlKHRoaXMucGhhc2VbQl0sbCxtKSxWPXRoaXMuX3NhbXBsZUZyYW1lKE5bZl0sRiksaz10aGlzLl9zYW1wbGVGcmFtZShOW01hdGgubWluKHRoaXMubnVtRnJhbWVzLTEsZisxKV0sRik7bGV0IFI9Visoay1WKSpwO209PT1nLkZMSVAmJnRoaXMucGhhc2VbQl08bCYmKFI9LVIpLHJbb10rPVIqeSpULGlbb10rPVIqTypULHRoaXMucGhhc2VbQl09RnQodGhpcy5waGFzZVtCXSt4KX19cmV0dXJuITB9fXJldHVybiByZWdpc3RlclByb2Nlc3Nvcigid2F2ZXRhYmxlLW9zY2lsbGF0b3ItcHJvY2Vzc29yIixkZSksQy5XYXJwTW9kZT1nLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDLFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxDfSh7fSk7Cg==";let Lt;const Rn=()=>(Lt=new AudioContext,Lt),x$2=()=>Lt||Rn();let Ct={};function Le(o,e){const a=x$2();if(Ct[o])return Ct[o];const l=2*a.sampleRate,u=a.createBuffer(1,l,a.sampleRate),p=u.getChannelData(0);let d=0,f,g,b,A,S,M,E;f=g=b=A=S=M=E=0;for(let F=0;F<l;F++)if(o==="white")p[F]=Math.random()*2-1;else if(o==="brown"){let $=Math.random()*2-1;p[F]=(d+.02*$)/1.02,d=p[F]}else if(o==="pink"){let $=Math.random()*2-1;f=.99886*f+$*.0555179,g=.99332*g+$*.0750759,b=.969*b+$*.153852,A=.8665*A+$*.3104856,S=.55*S+$*.5329522,M=-.7616*M-$*.016898,p[F]=f+g+b+A+S+M+E+$*.5362,p[F]*=.11,E=$*.115926}else if(o==="crackle"){const $=e*.01;Math.random()<$?p[F]=Math.random()*2-1:p[F]=0}return o!=="crackle"&&(Ct[o]=u),u}function Jt(o="white",e,a=.02){const l=x$2().createBufferSource();return l.buffer=Le(o,a),l.loop=!0,l.start(e),{node:l,stop:u=>l.stop(u)}}function Sn(o,e,a){const l=Jt("pink",a);return{node:Yn(o,l.node,e),stop:u=>l?.stop(u)}}const Ke=["pink","white","brown","crackle"];function C$1(o){const e=x$2().createGain();return e.gain.value=o,e}const me=(o,e,a,l)=>l-a===0?0:(e-o)/(l-a);function I(o,e,a,l){const u=new AudioWorkletNode(o,e,l);return Object.entries(a).forEach(([p,d])=>{d!==void 0&&(u.parameters.get(p).value=d)}),u}const k=(o,e,a,l,u,p,d,f,g,b="exponential")=>{e=O(e),a=O(a),l=O(l),u=O(u);const A=b==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";b==="exponential"&&(p=p===0?.001:p,d=d===0?.001:d);const S=d-p,M=d,E=p+l*S,F=g-f,$=Z=>{let V;if(e>Z){let K=me(p,M,0,e);V=Z*K+(p>M?p:0)}else V=(Z-e)*me(M,E,0,a)+M;return b==="exponential"&&(V=V||.001),V};o.setValueAtTime(p,f),e>F?o[A]($(F),g):e+a>F?(o[A]($(e),f+e),o[A]($(F),g)):(o[A]($(e),f+e),o[A]($(e+a),f+e+a),o.setValueAtTime(E,g)),o[A](p,g+u)};function Nn(o){return typeof o=="number"?o%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[o]??0}function Tt(o,e,a,l={}){const{shape:u=0,...p}=l,{dcoffset:d=-.5,depth:f=1}=l,g={frequency:1,depth:f,skew:.5,phaseoffset:0,time:e,begin:e,end:a,shape:Nn(u),dcoffset:d,min:d*f,max:d*f+f,curve:1,...p};return I(o,"lfo-processor",g)}const Q$1=(o,e="linear",a)=>{const[l,u,p,d]=o;if(l==null&&u==null&&p==null&&d==null)return a??[.001,.001,1,.01];const f=p??(l!=null&&u==null||l==null&&u==null?1:.001);return[Math.max(l??0,.001),Math.max(u??0,.001),Math.min(f,1),Math.max(d??0,.01)]};function be(o,e,a,l,u,p){let{amount:d,offset:f,defaultAmount:g=1,curve:b="linear",values:A,holdEnd:S,defaultValues:M}=u;d==null&&(d=A.some(z=>z!=null)?g:0);const E=f??0,F=d+E;if(Math.abs(F-E)){const[z,U,ee,ae]=Q$1(A,b,M);k(e,z,U,ee,ae,E,F,a,S,b)}let $,{defaultDepth:Z=1,depth:V,dcoffset:K,...se}=p;return V==null&&(V=Object.values(se).some(z=>z!=null)?Z:0),V&&($=Tt(o,a,l,{depth:V,dcoffset:K,...se}),$.connect(e)),{lfo:$,disconnect:()=>$?.disconnect()}}let Ze=o=>o<.5?1:1-(o-.5)/.5;function Yn(o,e,a=0){const l=x$2();if(!a)return o;let u=l.createGain(),p=l.createGain();o.connect(u),e.connect(p),u.gain.value=Ze(a),p.gain.value=Ze(1-a);let d=l.createGain();return u.connect(d),p.connect(d),d}let Fn=["linear","exponential"];function ht(o,e,a,l){if((e.pattack??e.pdecay??e.psustain??e.prelease??e.penv)===void 0)return;const u=O(e.penv,1,!0),p=Fn[e.pcurve??0];let[d,f,g,b]=Q$1([e.pattack,e.pdecay,e.psustain,e.prelease],p,[.2,.001,1,.001]),A=e.panchor??g;const S=u*100,M=0-S*A,E=S-S*A;k(o,d,f,g,b,M,E,a,l,p)}function pt(o,e,a){const{vibmod:l=.5,vib:u}=e;let p;if(u>0){p=x$2().createOscillator(),p.frequency.value=u;const d=x$2().createGain();return d.gain.value=l*100,p.connect(d),d.connect(o),p.start(a),p}}function rt(o,e,a,l){const u=new ConstantSourceNode(o),p=C$1(0);return p.connect(o.destination),u.connect(p),u.onended=()=>{try{p.disconnect()}catch{}try{u.disconnect()}catch{}e()},u.start(a),u.stop(l),u}const Cn=(o,e=1,a="sine")=>{const l=x$2();let u;Ke.includes(a)?(u=l.createBufferSource(),u.buffer=Le(a,2),u.loop=!0):(u=l.createOscillator(),u.type=a,u.frequency.value=o),u.start();const p=new GainNode(l,{gain:e});return u.connect(p),{node:p,stop:d=>u.stop(d)}},Hn=(o,e,a,l="sine")=>{const u=o.value*e,p=u*a;return Cn(u,p,l)};function Kt(o,e,a){const{fmh:l=1,fmi:u,fmenv:p="exp",fmattack:d,fmdecay:f,fmsustain:g,fmrelease:b,fmvelocity:A,fmwave:S="sine",duration:M}=e;let E,F=()=>{};if(u){const $=x$2().createGain(),Z=Hn(o,l,u,S);if(E=Z.node,F=Z.stop,![d,f,g,b,A].some(V=>V!==void 0))E.connect(o);else{const[V,K,se,z]=Q$1([d,f,g,b]),U=a+M;k($.gain,V,K,se,z,0,1,a,U,p==="exp"?"exponential":"linear"),E.connect($),$.connect(o)}}return{stop:F}}const ze=o=>o/(1+o),In=(o,e)=>(o%e+e)%e,Pn=(o,e)=>(1+e)*o/(1+e*Math.abs(o)),nt=(o,e)=>Math.tanh(o*(1+e)),kn=(o,e)=>D$1((1+e)*o,-1,1),Te=(o,e)=>{let a=(1+.5*e)*o;const l=In(a+1,4);return 1-Math.abs(l-2)},Qn=(o,e)=>Math.sin(Math.PI/2*Te(o,e)),Jn=(o,e)=>{const a=ze(Math.log1p(e)),l=(o-a/3*o*o*o)/(1-a/3);return nt(l,e)},Re=(o,e,a=!1)=>{const l=1+2*e,u=.07*ze(Math.log1p(e)),p=nt(o+u,2*e),d=nt(a?u:-o+u,2*e),f=p-d,g=1/Math.cosh(l*u),b=g*g,A=Math.max(1e-8,(a?1:2)*l*b);return nt(f/A,e)},Un=(o,e)=>Re(o,e,!0),vn=(o,e)=>{const a=10*Math.log1p(e);let l=1,u=o,p,d=0;for(let f=1;f<64;f++){if(f<2){d+=f==0?l:u;continue}p=2*o*l-u,u=l,l=p,f%2===0&&(d+=Math.min(1.3*a/f,2)*p)}return nt(d,a/20)},Se={scurve:Pn,soft:nt,hard:kn,cubic:Jn,diode:Re,asym:Un,fold:Te,sinefold:Qn,chebyshev:vn};Object.freeze(Object.keys(Se));const et=(o,e=36)=>{let{note:a,freq:l}=o;return a=a||e,typeof a=="string"&&(a=zt(a)),!l&&typeof a=="number"&&(l=Me(a)),Number(l)},it=o=>{o!=null&&(o.disconnect(),o.parameters.get("end")?.setValueAtTime(0,0))},It={};function jn(o,e){var a=1024;if(o<a)return o+" B";var l=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do o/=a,++u;while(o>=a);return o.toFixed(1)+" "+l[u]}function On(o,e){const{speed:a=1}=o,{transpose:l,url:u,index:p,midi:d,label:f}=ge(o,e);let g=Math.abs(a)*Math.pow(2,l/12);return{transpose:l,url:u,index:p,midi:d,label:f,playbackRate:g}}const En=async(o,e,a)=>{let{url:l,label:u,playbackRate:p}=On(o,e);const d=x$2(),f=await Ne(l,d,u);return o.unit==="c"&&(p=p*f.duration),{buffer:f,playbackRate:p}},Dn=async(o,e,a)=>{let{buffer:l,playbackRate:u}=await En(o,e);o.speed<0&&(l=An(l));const p=x$2().createBufferSource();p.buffer=l,p.playbackRate.value=u;const{loopBegin:d=0,loopEnd:f=1,begin:g=0,end:b=1}=o,A=g*p.buffer.duration;o.loop&&(p.loop=!0,p.loopStart=d*p.buffer.duration-A,p.loopEnd=f*p.buffer.duration-A);const S=p.buffer.duration/p.playbackRate.value,M=(b-g)*S;return{bufferSource:p,offset:A,bufferDuration:S,sliceDuration:M}},Ne=(o,e,a,l=0)=>{const u=a?`sound "${a}:${l}"`:"sample";if(o=o.replace("#","%23"),!It[o]){N(`[sampler] load ${u}..`,"load-sample",{url:o});const p=Date.now();It[o]=fetch(o).then(d=>d.arrayBuffer()).then(async d=>{const f=Date.now()-p,g=jn(d.byteLength);return N(`[sampler] load ${u}... done! loaded ${g} in ${f}ms`,"loaded-sample",{url:o}),await e.decodeAudioData(d)})}return It[o]};function An(o){const e=x$2(),a=e.createBuffer(o.numberOfChannels,o.length,e.sampleRate);for(let l=0;l<o.numberOfChannels;l++)a.copyToChannel(o.getChannelData(l).slice().reverse(),l,l);return a}function we(o){if(o.startsWith("bubo:")){const[e,a]=o.split(":");o=`github:Bubobubobubobubo/dough-${a}`}return o}function Ye(o,e=""){if(!o.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let a=o.slice(7);a=a.endsWith("/")?a.slice(0,-1):a;let l=a.split("/"),u=l[0],p=l.length>=2?l[1]:"samples",d=l.length>=3?l[2]:"main",f=l.slice(3);return f.push(e||""),f=f.join("/"),`https://raw.githubusercontent.com/${u}/${p}/${d}/${f}`}const qn=(o,e,a=o._base||"")=>Object.entries(o).forEach(([l,u])=>{if(typeof u=="string"&&(u=[u]),typeof u!="object")throw new Error("wrong sample map format for "+l);a=u._base||a,a=we(a),a.startsWith("github:")&&(a=Ye(a,""));const p=d=>a+d;Array.isArray(u)?u=u.map(p):u=Object.fromEntries(Object.entries(u).map(([d,f])=>[d,(typeof f=="string"?[f]:f).map(p)])),e(l,u)});let Fe={};function $n(o){const e=Object.entries(Fe).find(([a])=>o.startsWith(a));if(e)return e[1]}async function _n(o){const e=$n(o);if(e)return e(o);if(o=we(o),o.startsWith("github:")&&(o=Ye(o,"strudel.json")),o.startsWith("local:")&&(o="http://localhost:5432"),o.startsWith("shabda:")){let[u,p]=o.split("shabda:");o=`https://shabda.ndre.gr/${p}.json?strudel=1`}if(o.startsWith("shabda/speech")){let[u,p]=o.split("shabda/speech");p=p.startsWith("/")?p.substring(1):p;let[d,f]=p.split(":"),g="f",b="en-GB";d&&([b,g]=d.split("/")),o=`https://shabda.ndre.gr/speech/${f}.json?gender=${g}&language=${b}&strudel=1'`}if(typeof fetch!="function")return;const a=o.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const l=await fetch(o).then(u=>u.json()).catch(u=>{throw console.error(u),new Error(`error loading "${o}"`)});return[l,l._base||a]}const to=async(o,e=o._base||"",a={})=>{if(typeof o=="string"){const[p,d]=await _n(o);return to(p,e||d,a)}const{prebake:l,tag:u}=a;qn(o,(p,d)=>{oo(p,d,{baseUrl:e,prebake:l,tag:u})},e)},Xe=[];async function eo(o,e,a,l,u){let{s:p,nudge:d=0,cut:f,loop:g,clip:b=void 0,n:A=0,speed:S=1,duration:M}=e;if(S===0)return;const E=x$2();let[F,$,Z,V]=Q$1([e.attack,e.decay,e.sustain,e.release]);const{bufferSource:K,sliceDuration:se,offset:z}=await Dn(e,l);if(E.currentTime>o){N(`[sampler] still loading sound "${p}:${A}"`,"highlight");return}if(!K){N(`[sampler] could not load "${p}:${A}"`,"error");return}let U=pt(K.detune,e,o);const ee=o+d;K.start(ee,z);const ae=E.createGain(),de=K.connect(ae);b==null&&g==null&&e.release==null&&(M=se);let ke=o+M;k(de.gain,F,$,Z,V,0,1,o,ke,"linear"),ht(K.detune,e,o,ke);const Oe=E.createGain();de.connect(Oe),K.onended=function(){K.disconnect(),U?.stop(),de.disconnect(),Oe.disconnect(),a()};let De=ke+V+.01;K.stop(De);const Ae={node:Oe,bufferSource:K,stop:Pe=>{K.stop(Pe)}};if(f!==void 0){const Pe=Xe[f];Pe&&(Pe.node.gain.setValueAtTime(1,ee),Pe.node.gain.linearRampToValueAtTime(0,ee+.01)),Xe[f]=Ae}return Ae}function no(o,e,a){j(o,(l,u,p)=>eo(l,u,p,e),{type:"sample",samples:e,...a})}function oo(o,e,a){o.startsWith("wt_")?Be(o,e,a):no(o,e,a)}const vt="System Standard",B=map();function j(o,e,a={}){o=o.toLowerCase().replace(/\s+/g,"_"),B.setKey(o,{onTrigger:e,data:a})}const uo=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let o=await navigator.mediaDevices.enumerateDevices();o=o.filter(a=>a.kind==="audiooutput"&&a.deviceId!=="default");const e=new Map;return e.set(vt,""),o.forEach(a=>{e.set(a.label,a.deviceId)}),e};let mt={s:"triangle",gain:.8,postgain:1,density:".03",ftype:"12db",fanchor:0,resonance:1,hresonance:1,bandq:1,channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};new Map(Object.entries(mt));let Qe=[],Pt;function mo(){if(!Pt){const o=x$2(),e=Qe.concat([Tn]);Pt=Promise.all(e.map(a=>o.audioWorklet.addModule(a)))}return Pt}async function bo(o={}){const{disableWorklets:e=!1,maxPolyphony:a,audioDeviceName:l=vt,multiChannelOrbits:u=!1}=o;if(typeof window>"u")return;const p=x$2();if(l!=null&&l!=vt)try{const d=(await uo()).get(l),f=(d??"").length>0;p.sinkId!==d&&f&&await p.setSinkId(d),N(`[superdough] Audio Device set to ${l}, it might take a few seconds before audio plays on all output channels`)}catch{N("[superdough] failed to set audio interface","warning")}if(await p.resume(),e){N("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await mo(),N("[superdough] AudioWorklets loaded")}catch(d){console.warn("could not load AudioWorklet effects",d)}N("[superdough] ready")}const Vo=["triangle","square","sawtooth","sine"],Wo=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function fo(o,e){const a=o,l=new Float32Array(e);for(let u=0;u<e;u++){const p=u*2/e-1;l[u]=Math.tanh(p*a)}return l}function ec(){[...Vo].forEach(o=>{j(o,(e,a,l)=>{const[u,p,d,f]=Q$1([a.attack,a.decay,a.sustain,a.release],"linear",[.001,.05,.6,.01]);let g=xo(o,e,a),{node:b,stop:A}=g;const S=C$1(.3),{duration:M}=a;b.onended=()=>{b.disconnect(),S.disconnect(),l()};const E=C$1(1);let F=b.connect(S).connect(E);const $=e+M;k(F.gain,u,p,d,f,0,1,e,$,"linear");const Z=$+f+.01;return A(Z),{node:F,stop:V=>{A(V)}}},{type:"synth",prebake:!0})}),j("sbd",(o,e,a)=>{const{duration:l,decay:u=.5,pdecay:p=.5,penv:d=36,clip:f}=e,g=x$2(),b=.02,A=1.2,S=.025,M=1,E=g.createOscillator();E.type="triangle",E.frequency.value=et(e,29),E.detune.setValueAtTime(d*100,0),E.detune.setValueAtTime(d*100,o),E.detune.exponentialRampToValueAtTime(.001,o+p);const F=C$1(1);F.gain.setValueAtTime(1,o+b),F.gain.exponentialRampToValueAtTime(.001,o+b+u),E.start(o);const $=Jt("brown",o,2),Z=C$1(1);Z.gain.setValueAtTime(A,o),Z.gain.exponentialRampToValueAtTime(.001,o+S);const V=new WaveShaperNode(g);V.curve=fo(2,g.sampleRate);const K=C$1(M);E.onended=()=>{E.disconnect(),F.disconnect(),V.disconnect(),$.node.disconnect(),Z.disconnect(),K.disconnect(),a()};const se=E.connect(V).connect(F).connect(K);$.node.connect(Z).connect(K);let z=o+u+.01;return f!=null&&(z=Math.min(o+f*l,z)),K.gain.setValueAtTime(M,z-.01),K.gain.linearRampToValueAtTime(0,z),E.stop(z),$.stop(z),{node:se,stop:U=>{E.stop(U)}}},{type:"synth",prebake:!0}),j("supersaw",(o,e,a)=>{const l=x$2();let{duration:u,n:p,unison:d=5,spread:f=.6,detune:g}=e;g=g??p??.18;const b=et(e),[A,S,M,E]=Q$1([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),F=o+u,$=F+E+.01,Z=D$1(d,1,100);let V=Z>1?D$1(f,0,1):0,K=I(l,"supersaw-oscillator",{frequency:b,begin:o,end:$,freqspread:g,voices:Z,panspread:V},{outputChannelCount:[2]});const se=1/Math.sqrt(Z);ht(K.parameters.get("detune"),e,o,F);const z=pt(K.parameters.get("detune"),e,o),U=Kt(K.parameters.get("frequency"),e,o);let ee=C$1(1);ee=K.connect(ee),k(ee.gain,A,S,M,E,0,.3*se,o,F,"linear");let ae=rt(l,()=>{it(K),ee.disconnect(),a(),U?.stop(),z?.stop()},o,$);return{node:ee,stop:de=>{ae.stop(de)}}},{prebake:!0,type:"synth"}),j("bytebeat",(o,e,a)=>{const l=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:u=0}=e,p=et(e),{byteBeatExpression:d=l[u%l.length],byteBeatStartTime:f}=e,g=x$2();let{duration:b}=e;const[A,S,M,E]=Q$1([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),F=o+b,$=F+E+.01;let Z=I(g,"byte-beat-processor",{frequency:p,begin:o,end:$},{outputChannelCount:[2]});Z.port.postMessage({codeText:d,byteBeatStartTime:f,frequency:p});let V=C$1(1);V=Z.connect(V),k(V.gain,A,S,M,E,0,1,o,F,"linear");let K=rt(g,()=>{it(Z),V.disconnect(),a()},o,$);return{node:V,stop:se=>{K.stop(se)}}},{prebake:!0,type:"synth"}),j("pulse",(o,e,a)=>{const l=x$2();let{pwrate:u,pwsweep:p}=e;p==null&&(u!=null?p=.3:p=0),u==null&&p!=null&&(u=1);let{duration:d,pw:f=.5}=e;const g=et(e),[b,A,S,M]=Q$1([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),E=o+d,F=E+M+.01;let $=I(l,"pulse-oscillator",{frequency:g,begin:o,end:F,pulsewidth:f},{outputChannelCount:[2]});ht($.parameters.get("detune"),e,o,E);const Z=pt($.parameters.get("detune"),e,o),V=Kt($.parameters.get("frequency"),e,o);let K=C$1(1);K=$.connect(K),k(K.gain,b,A,S,M,0,1,o,E,"linear");let se;p!=0&&(se=Tt(l,o,F,{frequency:u,depth:p}),se.connect($.parameters.get("pulsewidth")));let z=rt(l,()=>{it($),it(se),K.disconnect(),a(),V?.stop(),Z?.stop()},o,F);return{node:K,stop:U=>{z.stop(U)}}},{prebake:!0,type:"synth"}),[...Ke].forEach(o=>{j(o,(e,a,l)=>{const[u,p,d,f]=Q$1([a.attack,a.decay,a.sustain,a.release],"linear",[.001,.05,.6,.01]);let g,{density:b}=a;g=Jt(o,e,b);let{node:A,stop:S,triggerRelease:M}=g;const E=C$1(.3),{duration:F}=a;A.onended=()=>{A.disconnect(),E.disconnect(),l()};const $=C$1(1);let Z=A.connect(E).connect($);const V=e+F;k(Z.gain,u,p,d,f,0,1,e,V,"linear");const K=V+f+.01;return M?.(K),S(K),{node:Z,stop:se=>{S(se)}}},{type:"synth",prebake:!0})}),Wo.forEach(([o,e])=>B.set({...B.get(),[o]:B.get()[e]}))}function Mo(o,e){const a=new Float32Array(o+1),l=new Float32Array(o+1),u=x$2(),p=u.createOscillator(),d={sawtooth:b=>[0,-1/b],square:b=>[0,b%2===0?0:1/b],triangle:b=>[b%2===0?0:1/(b*b),0]};if(!d[e])throw new Error(`unknown wave type ${e}`);a[0]=0,l[0]=0;let f=1;for(;f<=o;){const[b,A]=d[e](f);a[f]=b,l[f]=A,f++}const g=u.createPeriodicWave(a,l);return p.setPeriodicWave(g),p}function xo(o,e,a){let{n:l,duration:u,noise:p=0}=a,d;!l||o==="sine"?(d=x$2().createOscillator(),d.type=o||"triangle"):d=Mo(l,o),d.frequency.value=et(a),d.start(e);let f=pt(d.detune,a,e);ht(d.detune,a,e,e+u);const g=Kt(d.frequency,a,e);let b;return p&&(b=Sn(d,p,e)),{node:b?.node||d,stop:A=>{g.stop(A),f?.stop(A),b?.stop(A),d.stop(A)},triggerRelease:A=>{}}}let ct;const Ue=()=>{};typeof window<"u"&&window.addEventListener("message",o=>{o.data==="strudel-stop"?Ue():o.data?.dough&&ct?.node.port.postMessage(o.data)});const Ge=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),Ve=new Set;async function zo(o,e,a=2048){const l=`${o},${a}`;if(!Ve.has(l)){const u=(await No(o,e)).getChannelData(0),p=u.length,d=Math.max(1,Math.floor(p/a)),f=new Array(d);for(let g=0;g<d;g++){const b=g*a;f[g]=u.subarray(b,b+a)}return Ve.add(l),{frames:f,frameLen:a,numFrames:d,key:l}}return{frameLen:a,key:l}}function To(o,e){var a=1024;if(o<a)return o+" B";var l=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do o/=a,++u;while(o>=a);return o.toFixed(1)+" "+l[u]}function Ro(o){const e=new DataView(o);let a=12;for(;a+8<=e.byteLength;){const l=String.fromCharCode(e.getUint8(a),e.getUint8(a+1),e.getUint8(a+2),e.getUint8(a+3)),u=e.getUint32(a+4,!0);if(l==="fmt ")return e.getUint32(a+12,!0);a+=8+u+(u&1)}return null}async function So(o){const e=Ro(o)||44100;return await new OfflineAudioContext(1,1,e).decodeAudioData(o)}const Qt={},No=(o,e)=>{if(o=o.replace("#","%23"),!Qt[o]){N(`[wavetable] load table ${e}..`,"load-table",{url:o});const a=Date.now();Qt[o]=fetch(o).then(l=>l.arrayBuffer()).then(async l=>{const u=Date.now()-a,p=To(l.byteLength);return N(`[wavetable] load table ${e}... done! loaded ${p} in ${u}ms`,"loaded-table",{url:o}),await So(l)})}return Qt[o]};function Be(o,e,a){j(o,(l,u,p,d)=>wo(l,u,p,e,d,a?.frameLen??2048),{type:"wavetable",tables:e,...a})}async function wo(o,e,a,l,u,p){const{s:d,n:f=0,duration:g,clip:b}=e,A=x$2(),[S,M,E,F]=Q$1([e.attack,e.decay,e.sustain,e.release]);let{warpmode:$}=e;typeof $=="string"&&($=Ge[$.toUpperCase()]??Ge.NONE);const Z=et(e),{url:V,label:K}=ge(e,l),se=await zo(V,K,p);let z=o+g;b!==void 0&&(z=Math.min(o+b*g,z));const U=z+F,ee=U+.01,ae=I(A,"wavetable-oscillator-processor",{begin:o,end:ee,frequency:Z,freqspread:e.detune,position:e.wt,warp:e.warp,warpMode:$,voices:Math.max(e.unison??1,1),panspread:e.spread,phaserand:e.wtphaserand??e.unison>1?1:0},{outputChannelCount:[2]});if(ae.port.postMessage({type:"table",payload:se}),A.currentTime>o){N(`[wavetable] still loading sound "${d}:${f}"`,"highlight");return}const de=[e.wtattack,e.wtdecay,e.wtsustain,e.wtrelease],ke=[e.warpattack,e.warpdecay,e.warpsustain,e.warprelease],Oe=ae.parameters,De=Oe.get("position"),Ae=Oe.get("warp");let Pe=e.wtrate;e.wtsync!=null&&(Pe=u*e.wtsync);const We=be(A,De,o,U,{offset:e.wt,amount:e.wtenv,defaultAmount:.5,values:de,holdEnd:z,defaultValues:[0,.5,0,.1]},{frequency:Pe,depth:e.wtdepth,defaultDepth:.5,shape:e.wtshape,skew:e.wtskew,dcoffset:e.wtdc??0});let qe=e.warprate;e.warpsync!=null&&(qe=qe=u*e.warpsync);const at=be(A,Ae,o,U,{offset:e.warp,amount:e.warpenv,defaultAmount:.5,values:ke,holdEnd:z,defaultValues:[0,.5,0,.1]},{frequency:qe,depth:e.warpdepth,defaultDepth:.5,shape:e.warpshape,skew:e.warpskew,dcoffset:e.warpdc??0}),yt=pt(ae.parameters.get("detune"),e,o),ut=Kt(ae.parameters.get("frequency"),e,o),Dt=A.createGain(),$t=ae.connect(Dt);k($t.gain,S,M,E,F,0,.3,o,z,"linear"),ht(ae.parameters.get("detune"),e,o,z);const Bt={node:$t,source:ae},$e=rt(A,()=>{it(ae),yt?.stop(),ut?.stop(),$t.disconnect(),We?.disconnect(),at?.disconnect(),a()},o,ee);return Bt.stop=bt=>{$e.stop(bt)},Bt}typeof BigInt>"u"&&(BigInt=function(o){if(isNaN(o))throw new Error("");return o});const C_ZERO=BigInt(0),C_ONE=BigInt(1),C_TWO=BigInt(2),C_THREE=BigInt(3),C_FIVE=BigInt(5),C_TEN=BigInt(10);BigInt(Number.MAX_SAFE_INTEGER);const MAX_CYCLE_LEN=2e3,P={s:C_ONE,n:C_ZERO,d:C_ONE};function assign(o,e){try{o=BigInt(o)}catch{throw InvalidParameter()}return o*e}function ifloor(o){return typeof o=="bigint"?o:Math.floor(o)}function newFraction(o,e){if(e===C_ZERO)throw DivisionByZero();const a=Object.create(Fraction.prototype);a.s=o<C_ZERO?-C_ONE:C_ONE,o=o<C_ZERO?-o:o;const l=gcd$1(o,e);return a.n=o/l,a.d=e/l,a}const FACTORSTEPS=[C_TWO*C_TWO,C_TWO,C_TWO*C_TWO,C_TWO,C_TWO*C_TWO,C_TWO*C_THREE,C_TWO,C_TWO*C_THREE];function factorize(o){const e=Object.create(null);if(o<=C_ONE)return e[o]=C_ONE,e;const a=l=>{e[l]=(e[l]||C_ZERO)+C_ONE};for(;o%C_TWO===C_ZERO;)a(C_TWO),o/=C_TWO;for(;o%C_THREE===C_ZERO;)a(C_THREE),o/=C_THREE;for(;o%C_FIVE===C_ZERO;)a(C_FIVE),o/=C_FIVE;for(let l=0,u=C_TWO+C_FIVE;u*u<=o;){for(;o%u===C_ZERO;)a(u),o/=u;u+=FACTORSTEPS[l],l=l+1&7}return o>C_ONE&&a(o),e}const parse$7=function(o,e){let a=C_ZERO,l=C_ONE,u=C_ONE;if(o!=null)if(e!==void 0){if(typeof o=="bigint")a=o;else{if(isNaN(o))throw InvalidParameter();if(o%1!==0)throw NonIntegerParameter();a=BigInt(o)}if(typeof e=="bigint")l=e;else{if(isNaN(e))throw InvalidParameter();if(e%1!==0)throw NonIntegerParameter();l=BigInt(e)}u=a*l}else if(typeof o=="object"){if("d"in o&&"n"in o)a=BigInt(o.n),l=BigInt(o.d),"s"in o&&(a*=BigInt(o.s));else if(0 in o)a=BigInt(o[0]),1 in o&&(l=BigInt(o[1]));else if(typeof o=="bigint")a=o;else throw InvalidParameter();u=a*l}else if(typeof o=="number"){if(isNaN(o))throw InvalidParameter();if(o<0&&(u=-C_ONE,o=-o),o%1===0)a=BigInt(o);else{let p=1,d=0,f=1,g=1,b=1,A=1e7;for(o>=1&&(p=10**Math.floor(1+Math.log10(o)),o/=p);f<=A&&b<=A;){let S=(d+g)/(f+b);if(o===S){f+b<=A?(a=d+g,l=f+b):b>f?(a=g,l=b):(a=d,l=f);break}else o>S?(d+=g,f+=b):(g+=d,b+=f),f>A?(a=g,l=b):(a=d,l=f)}a=BigInt(a)*BigInt(p),l=BigInt(l)}}else if(typeof o=="string"){let p=0,d=C_ZERO,f=C_ZERO,g=C_ZERO,b=C_ONE,A=C_ONE,S=o.replace(/_/g,"").match(/\d+|./g);if(S===null)throw InvalidParameter();if(S[p]==="-"?(u=-C_ONE,p++):S[p]==="+"&&p++,S.length===p+1?f=assign(S[p++],u):S[p+1]==="."||S[p]==="."?(S[p]!=="."&&(d=assign(S[p++],u)),p++,(p+1===S.length||S[p+1]==="("&&S[p+3]===")"||S[p+1]==="'"&&S[p+3]==="'")&&(f=assign(S[p],u),b=C_TEN**BigInt(S[p].length),p++),(S[p]==="("&&S[p+2]===")"||S[p]==="'"&&S[p+2]==="'")&&(g=assign(S[p+1],u),A=C_TEN**BigInt(S[p+1].length)-C_ONE,p+=3)):S[p+1]==="/"||S[p+1]===":"?(f=assign(S[p],u),b=assign(S[p+2],C_ONE),p+=3):S[p+3]==="/"&&S[p+1]===" "&&(d=assign(S[p],u),f=assign(S[p+2],u),b=assign(S[p+4],C_ONE),p+=5),S.length<=p)l=b*A,u=a=g+l*d+A*f;else throw InvalidParameter()}else if(typeof o=="bigint")a=o,u=o,l=C_ONE;else throw InvalidParameter();if(l===C_ZERO)throw DivisionByZero();P.s=u<C_ZERO?-C_ONE:C_ONE,P.n=a<C_ZERO?-a:a,P.d=l<C_ZERO?-l:l};function modpow(o,e,a){let l=C_ONE;for(;e>C_ZERO;o=o*o%a,e>>=C_ONE)e&C_ONE&&(l=l*o%a);return l}function cycleLen(o,e){for(;e%C_TWO===C_ZERO;e/=C_TWO);for(;e%C_FIVE===C_ZERO;e/=C_FIVE);if(e===C_ONE)return C_ZERO;let a=C_TEN%e,l=1;for(;a!==C_ONE;l++)if(a=a*C_TEN%e,l>MAX_CYCLE_LEN)return C_ZERO;return BigInt(l)}function cycleStart(o,e,a){let l=C_ONE,u=modpow(C_TEN,a,e);for(let p=0;p<300;p++){if(l===u)return BigInt(p);l=l*C_TEN%e,u=u*C_TEN%e}return 0}function gcd$1(o,e){if(!o)return e;if(!e)return o;for(;;){if(o%=e,!o)return e;if(e%=o,!e)return o}}function Fraction(o,e){if(parse$7(o,e),this instanceof Fraction)o=gcd$1(P.d,P.n),this.s=P.s,this.n=P.n/o,this.d=P.d/o;else return newFraction(P.s*P.n,P.d)}const DivisionByZero=function(){return new Error("Division by Zero")},InvalidParameter=function(){return new Error("Invalid argument")},NonIntegerParameter=function(){return new Error("Parameters must be integer")};Fraction.prototype={s:C_ONE,n:C_ZERO,d:C_ONE,abs:function(){return newFraction(this.n,this.d)},neg:function(){return newFraction(-this.s*this.n,this.d)},add:function(o,e){return parse$7(o,e),newFraction(this.s*this.n*P.d+P.s*this.d*P.n,this.d*P.d)},sub:function(o,e){return parse$7(o,e),newFraction(this.s*this.n*P.d-P.s*this.d*P.n,this.d*P.d)},mul:function(o,e){return parse$7(o,e),newFraction(this.s*P.s*this.n*P.n,this.d*P.d)},div:function(o,e){return parse$7(o,e),newFraction(this.s*P.s*this.n*P.d,this.d*P.n)},clone:function(){return newFraction(this.s*this.n,this.d)},mod:function(o,e){if(o===void 0)return newFraction(this.s*this.n%this.d,C_ONE);if(parse$7(o,e),C_ZERO===P.n*this.d)throw DivisionByZero();return newFraction(this.s*(P.d*this.n)%(P.n*this.d),P.d*this.d)},gcd:function(o,e){return parse$7(o,e),newFraction(gcd$1(P.n,this.n)*gcd$1(P.d,this.d),P.d*this.d)},lcm:function(o,e){return parse$7(o,e),P.n===C_ZERO&&this.n===C_ZERO?newFraction(C_ZERO,C_ONE):newFraction(P.n*this.n,gcd$1(P.n,this.n)*gcd$1(P.d,this.d))},inverse:function(){return newFraction(this.s*this.d,this.n)},pow:function(o,e){if(parse$7(o,e),P.d===C_ONE)return P.s<C_ZERO?newFraction((this.s*this.d)**P.n,this.n**P.n):newFraction((this.s*this.n)**P.n,this.d**P.n);if(this.s<C_ZERO)return null;let a=factorize(this.n),l=factorize(this.d),u=C_ONE,p=C_ONE;for(let d in a)if(d!=="1"){if(d==="0"){u=C_ZERO;break}if(a[d]*=P.n,a[d]%P.d===C_ZERO)a[d]/=P.d;else return null;u*=BigInt(d)**a[d]}for(let d in l)if(d!=="1"){if(l[d]*=P.n,l[d]%P.d===C_ZERO)l[d]/=P.d;else return null;p*=BigInt(d)**l[d]}return P.s<C_ZERO?newFraction(p,u):newFraction(u,p)},log:function(o,e){if(parse$7(o,e),this.s<=C_ZERO||P.s<=C_ZERO)return null;const a=Object.create(null),l=factorize(P.n),u=factorize(P.d),p=factorize(this.n),d=factorize(this.d);for(const b in u)l[b]=(l[b]||C_ZERO)-u[b];for(const b in d)p[b]=(p[b]||C_ZERO)-d[b];for(const b in l)b!=="1"&&(a[b]=!0);for(const b in p)b!=="1"&&(a[b]=!0);let f=null,g=null;for(const b in a){const A=l[b]||C_ZERO,S=p[b]||C_ZERO;if(A===C_ZERO){if(S!==C_ZERO)return null;continue}let M=S,E=A;const F=gcd$1(M,E);if(M/=F,E/=F,f===null&&g===null)f=M,g=E;else if(M*g!==f*E)return null}return f!==null&&g!==null?newFraction(f,g):null},equals:function(o,e){return parse$7(o,e),this.s*this.n*P.d===P.s*P.n*this.d},lt:function(o,e){return parse$7(o,e),this.s*this.n*P.d<P.s*P.n*this.d},lte:function(o,e){return parse$7(o,e),this.s*this.n*P.d<=P.s*P.n*this.d},gt:function(o,e){return parse$7(o,e),this.s*this.n*P.d>P.s*P.n*this.d},gte:function(o,e){return parse$7(o,e),this.s*this.n*P.d>=P.s*P.n*this.d},compare:function(o,e){parse$7(o,e);let a=this.s*this.n*P.d-P.s*P.n*this.d;return(C_ZERO<a)-(a<C_ZERO)},ceil:function(o){return o=C_TEN**BigInt(o||0),newFraction(ifloor(this.s*o*this.n/this.d)+(o*this.n%this.d>C_ZERO&&this.s>=C_ZERO?C_ONE:C_ZERO),o)},floor:function(o){return o=C_TEN**BigInt(o||0),newFraction(ifloor(this.s*o*this.n/this.d)-(o*this.n%this.d>C_ZERO&&this.s<C_ZERO?C_ONE:C_ZERO),o)},round:function(o){return o=C_TEN**BigInt(o||0),newFraction(ifloor(this.s*o*this.n/this.d)+this.s*((this.s>=C_ZERO?C_ONE:C_ZERO)+C_TWO*(o*this.n%this.d)>this.d?C_ONE:C_ZERO),o)},roundTo:function(o,e){parse$7(o,e);const a=this.n*P.d,l=this.d*P.n,u=a%l;let p=ifloor(a/l);return u+u>=l&&p++,newFraction(this.s*p*P.n,P.d)},divisible:function(o,e){return parse$7(o,e),P.n===C_ZERO?!1:this.n*P.d%(P.n*this.d)===C_ZERO},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(o=15){let e=this.n,a=this.d,l=cycleLen(e,a),u=cycleStart(e,a,l),p=this.s<C_ZERO?"-":"";if(p+=ifloor(e/a),e%=a,e*=C_TEN,e&&(p+="."),l){for(let d=u;d--;)p+=ifloor(e/a),e%=a,e*=C_TEN;p+="(";for(let d=l;d--;)p+=ifloor(e/a),e%=a,e*=C_TEN;p+=")"}else for(let d=o;e&&d--;)p+=ifloor(e/a),e%=a,e*=C_TEN;return p},toFraction:function(o=!1){let e=this.n,a=this.d,l=this.s<C_ZERO?"-":"";if(a===C_ONE)l+=e;else{const u=ifloor(e/a);o&&u>C_ZERO&&(l+=u,l+=" ",e%=a),l+=e,l+="/",l+=a}return l},toLatex:function(o=!1){let e=this.n,a=this.d,l=this.s<C_ZERO?"-":"";if(a===C_ONE)l+=e;else{const u=ifloor(e/a);o&&u>C_ZERO&&(l+=u,e%=a),l+="\\frac{",l+=e,l+="}{",l+=a,l+="}"}return l},toContinued:function(){let o=this.n,e=this.d;const a=[];for(;e;){a.push(ifloor(o/e));const l=o%e;o=e,e=l}return a},simplify:function(o=.001){const e=BigInt(Math.ceil(1/o)),a=this.abs(),l=a.toContinued();for(let u=1;u<l.length;u++){let p=newFraction(l[u-1],C_ONE);for(let f=u-2;f>=0;f--)p=p.inverse().add(l[f]);let d=p.sub(a);if(d.n*e<d.d)return p.mul(this.s)}return this}};const logKey="strudel.log";let debounce=1e3,lastMessage,lastTime;function errorLogger$1(o,e="cyclist"){process.env.NODE_ENV==="development"&&console.error(o),logger$2(`[${e}] error: ${o.message}`)}function logger$2(o,e,a={}){let l=performance.now();lastMessage===o&&l-lastTime<debounce||(lastMessage=o,lastTime=l,console.log(`%c${o}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(logKey,{detail:{message:o,type:e,data:a}})))}logger$2.key=logKey;const isNoteWithOctave=o=>/^[a-gA-G][#bsf]*[0-9]*$/.test(o),isNote=o=>/^[a-gA-G][#bsf]*-?[0-9]*$/.test(o),tokenizeNote$3=o=>{if(typeof o!="string")return[];const[e,a="",l]=o.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return e?[e,a,l?Number(l):void 0]:[]},chromas$2={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$2={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset$1=o=>o?.split("").reduce((e,a)=>e+accs$2[a],0)||0,noteToMidi$1=(o,e=3)=>{const[a,l,u=e]=tokenizeNote$3(o);if(!a)throw new Error('not a note: "'+o+'"');const p=chromas$2[a.toLowerCase()],d=getAccidentalsOffset$1(l);return(Number(u)+1)*12+p+d},midiToFreq$2=o=>Math.pow(2,(o-69)/12)*440,freqToMidi$2=o=>12*Math.log(o/440)/Math.LN2+69,valueToMidi$1=(o,e)=>{if(typeof o!="object")throw new Error("valueToMidi: expected object value");let{freq:a,note:l}=o;if(typeof a=="number")return freqToMidi$2(a);if(typeof l=="string")return noteToMidi$1(l);if(typeof l=="number")return l;if(!e)throw new Error("valueToMidi: expected freq or note to be set");return e},getEventOffsetMs=(o,e)=>(o-e)*1e3,getFreq=o=>midiToFreq$2(typeof o=="number"?o:noteToMidi$1(o)),pcs$1=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],midi2note$1=o=>{const e=Math.floor(o/12)-1;return pcs$1[o%12]+e},_mod$2=(o,e)=>(o%e+e)%e,averageArray=o=>o.reduce((e,a)=>e+a)/o.length;function nanFallback$1(o,e=0){return isNaN(Number(o))?(logger$2(`"${o}" is not a number, falling back to ${e}`,"warning"),e):o}const getSoundIndex$1=(o,e)=>_mod$2(Math.round(nanFallback$1(o??0,0)),e),getPlayableNoteValue=o=>{let{value:e,context:a}=o,l=e;if(typeof l=="object"&&!Array.isArray(l)&&(l=l.note||l.n||l.value,l===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(e)}`);if(typeof l=="number"&&a.type!=="frequency")l=midiToFreq$2(o.value);else if(typeof l=="number"&&a.type==="frequency")l=o.value;else if(typeof l!="string"||!isNote(l))throw new Error("not a note: "+JSON.stringify(l));return l},getFrequency=o=>{let{value:e,context:a}=o;if(typeof e=="object")return e.freq?e.freq:getFreq(e.note||e.n||e.value);if(typeof e=="number"&&a.type!=="frequency")e=midiToFreq$2(o.value);else if(typeof e=="string"&&isNote(e))e=midiToFreq$2(noteToMidi$1(o.value));else if(typeof e!="number")throw new Error("not a note or frequency: "+e);return e},rotate$2=(o,e)=>o.slice(e).concat(o.slice(0,e)),pipe=(...o)=>o.reduce((e,a)=>(...l)=>e(a(...l)),e=>e),compose=(...o)=>pipe(...o.reverse()),removeUndefineds=o=>o.filter(e=>e!=null),flatten=o=>[].concat(...o),id=o=>o,constant=(o,e)=>o,listRange=(o,e)=>Array.from({length:e-o+1},(a,l)=>l+o);function curry(o,e,a=o.length){const l=function u(...p){if(p.length>=a)return o.apply(this,p);{const d=function(...f){return u.apply(this,p.concat(f))};return e&&e(d,p),d}};return e&&e(l,[]),l}function parseNumeral(o){const e=Number(o);if(!isNaN(e))return e;if(isNote(o))return noteToMidi$1(o);throw new Error(`cannot parse as numeral: "${o}"`)}function mapArgs(o,e){return(...a)=>o(...a.map(e))}function numeralArgs(o){return mapArgs(o,parseNumeral)}function parseFractional(o){const e=Number(o);if(!isNaN(e))return e;const a={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[o];if(typeof a<"u")return a;throw new Error(`cannot parse as fractional: "${o}"`)}const fractionalArgs=o=>mapArgs(o,parseFractional),splitAt=function(o,e){return[e.slice(0,o),e.slice(o)]},zipWith=(o,e,a)=>e.map((l,u)=>o(l,a[u])),pairs=function(o){const e=[];for(let a=0;a<o.length-1;++a)e.push([o[a],o[a+1]]);return e},clamp$1=(o,e,a)=>Math.min(Math.max(o,e),a),solfeggio=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],indian=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],german=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],byzantine=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],japanese=["I","Ro","Ha","Ni","Ho","He","To"],english=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],sol2note=(o,e="letters")=>{const l=(e==="solfeggio"?solfeggio:e==="indian"?indian:e==="german"?german:e==="byzantine"?byzantine:e==="japanese"?japanese:english)[o%12],u=Math.floor(o/12)-1;return l+u};function uniq(o){var e={};return o.filter(function(a){return e.hasOwn(a)?!1:e[a]=!0})}function uniqsort(o){return o.sort().filter(function(e,a,l){return!a||e!=l[a-1]})}function uniqsortr(o){return o.sort((e,a)=>e.compare(a)).filter(function(e,a,l){return!a||e.ne(l[a-1])})}function unicodeToBase64(o){const e=new TextEncoder().encode(o);return btoa(String.fromCharCode(...e))}function base64ToUnicode(o){const e=new Uint8Array(atob(o).split("").map(l=>l.charCodeAt(0)));return new TextDecoder().decode(e)}function code2hash(o){return encodeURIComponent(unicodeToBase64(o))}function hash2code(o){return base64ToUnicode(decodeURIComponent(o))}function objectMap(o,e){return Array.isArray(o)?o.map(e):Object.fromEntries(Object.entries(o).map(([a,l],u)=>[a,e(l,a,u)]))}function cycleToSeconds$1(o,e){return o/e}class ClockCollator{constructor({getTargetClockTime:e=getUnixTimeSeconds,weight:a=16,offsetDelta:l=.005,checkAfterTime:u=2,resetAfterTime:p=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=e,this.weight=a,this.offsetDelta=l,this.checkAfterTime=u,this.resetAfterTime=p,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(e){const a=this.getTargetClockTime(),l=a-this.timeAtPrevOffsetSample,u=a-e;if(l>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=u),this.prevOffsetTimes.push(u),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||l>this.checkAfterTime){this.timeAtPrevOffsetSample=a;const p=averageArray(this.prevOffsetTimes);Math.abs(p-this.offsetTime)>this.offsetDelta&&(this.offsetTime=p)}return this.offsetTime}calculateTimestamp(e,a){return this.calculateOffset(e)+a}}function getPerformanceTimeSeconds(){return performance.now()*.001}function getUnixTimeSeconds(){return Date.now()*.001}const keyAlias=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let keyState;function getCurrentKeyboardState(){if(keyState==null){if(typeof window>"u")return;keyState={},window.addEventListener("keydown",o=>{keyState[o.key]=!0}),window.addEventListener("keyup",o=>{keyState[o.key]=!1})}return{...keyState}}function stringifyValues(o,e=!1){return typeof o=="object"?e?JSON.stringify(o).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(o):o}Fraction.prototype.sam=function(){return this.floor()},Fraction.prototype.nextSam=function(){return this.sam().add(1)},Fraction.prototype.wholeCycle=function(){return new TimeSpan(this.sam(),this.nextSam())},Fraction.prototype.cyclePos=function(){return this.sub(this.sam())},Fraction.prototype.lt=function(o){return this.compare(o)<0},Fraction.prototype.gt=function(o){return this.compare(o)>0},Fraction.prototype.lte=function(o){return this.compare(o)<=0},Fraction.prototype.gte=function(o){return this.compare(o)>=0},Fraction.prototype.eq=function(o){return this.compare(o)==0},Fraction.prototype.ne=function(o){return this.compare(o)!=0},Fraction.prototype.max=function(o){return this.gt(o)?this:o},Fraction.prototype.maximum=function(...o){return o=o.map(e=>new Fraction(e)),o.reduce((e,a)=>a.max(e),this)},Fraction.prototype.min=function(o){return this.lt(o)?this:o},Fraction.prototype.mulmaybe=function(o){return o!==void 0?this.mul(o):void 0},Fraction.prototype.divmaybe=function(o){return o!==void 0?this.div(o):void 0},Fraction.prototype.addmaybe=function(o){return o!==void 0?this.add(o):void 0},Fraction.prototype.submaybe=function(o){return o!==void 0?this.sub(o):void 0},Fraction.prototype.show=function(){return this.s*this.n+"/"+this.d},Fraction.prototype.or=function(o){return this.eq(0)?o:this};const fraction$1=o=>Fraction(o),gcd=(...o)=>{if(o=removeUndefineds(o),o.length!==0)return o.reduce((e,a)=>e.gcd(a),fraction$1(1))},lcm=(...o)=>{if(o=removeUndefineds(o),o.length===0)return;const e=o.pop();return o.reduce((a,l)=>a===void 0||l===void 0?void 0:a.lcm(l),e)},isFraction=o=>o instanceof Fraction;fraction$1._original=Fraction;class TimeSpan{constructor(e,a){this.begin=fraction$1(e),this.end=fraction$1(a)}get spanCycles(){const e=[];var a=this.begin;const l=this.end,u=l.sam();if(a.equals(l))return[new TimeSpan(a,l)];for(;l.gt(a);){if(a.sam().equals(u)){e.push(new TimeSpan(a,this.end));break}const p=a.nextSam();e.push(new TimeSpan(a,p)),a=p}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),a=e.add(this.duration);return new TimeSpan(e,a)}withTime(e){return new TimeSpan(e(this.begin),e(this.end))}withEnd(e){return new TimeSpan(this.begin,e(this.end))}withCycle(e){const a=this.begin.sam(),l=a.add(e(this.begin.sub(a))),u=a.add(e(this.end.sub(a)));return new TimeSpan(l,u)}intersection(e){const a=this.begin.max(e.begin),l=this.end.min(e.end);if(!a.gt(l)&&!(a.equals(l)&&(a.equals(this.end)&&this.begin.lt(this.end)||a.equals(e.end)&&e.begin.lt(e.end))))return new TimeSpan(a,l)}intersection_e(e){const a=this.intersection(e);if(a==null)throw"TimeSpans do not intersect";return a}midpoint(){return this.begin.add(this.duration.div(fraction$1(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}}class Hap{constructor(e,a,l,u={},p=!1){this.whole=e,this.part=a,this.value=l,this.context=u,this.stateful=p,p&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){let e;return typeof this.value?.duration=="number"?e=fraction$1(this.value.duration):e=this.whole.end.sub(this.whole.begin),typeof this.value?.clip=="number"?e.mul(this.value.clip):e}get endClipped(){return this.whole.begin.add(this.duration)}isActive(e){return this.whole.begin<=e&&this.endClipped>=e}isInPast(e){return e>this.endClipped}isInNearPast(e,a){return a-e<=this.endClipped}isInFuture(e){return e<this.whole.begin}isInNearFuture(e,a){return a<this.whole.begin&&a>this.whole.begin-e}isWithinTime(e,a){return this.whole.begin<=a&&this.endClipped>=e}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(e){const a=this.whole?e(this.whole):void 0;return new Hap(a,e(this.part),this.value,this.context)}withValue(e){return new Hap(this.whole,this.part,e(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(e){return this.context.tags?.includes(e)}resolveState(e){if(this.stateful&&this.hasOnset()){console.log("stateful");const a=this.value,[l,u]=a(e);return[l,new Hap(this.whole,this.part,u,this.context,!1)]}return[e,this]}spanEquals(e){return this.whole==null&&e.whole==null||this.whole.equals(e.whole)}equals(e){return this.spanEquals(e)&&this.part.equals(e.part)&&this.value===e.value}show(e=!1){const a=typeof this.value=="object"?e?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var l="";if(this.whole==null)l="~"+this.part.show;else{var u=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(l=this.whole.begin.show()+" ⇜ "),u||(l+="("),l+=this.part.show(),u||(l+=")"),this.whole.end.equals(this.part.end)||(l+=" ⇝ "+this.whole.end.show())}return"[ "+l+" | "+a+" ]"}showWhole(e=!1){return`${this.whole==null?"~":this.whole.show()}: ${stringifyValues(this.value,e)}`}combineContext(e){const a=this;return{...a.context,...e.context,locations:(a.context.locations||[]).concat(e.context.locations||[])}}setContext(e){return new Hap(this.whole,this.part,this.value,e)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class State{constructor(e,a={}){this.span=e,this.controls=a}setSpan(e){return new State(e,this.controls)}withSpan(e){return this.setSpan(e(this.span))}setControls(e){return new State(this.span,{...this.controls,...e})}}function unionWithObj(o,e,a){if(e?.value!==void 0&&Object.keys(e).length===1)return logger$2("[warn]: Can't do arithmetic on control pattern."),o;const l=Object.keys(o).filter(u=>Object.keys(e).includes(u));return Object.assign({},o,e,Object.fromEntries(l.map(u=>[u,a(o[u],e[u])])))}curry((o,e)=>o*e),curry((o,e)=>e.map(o));function drawLine(o,e=60){let a=0,l=fraction$1(0),u=[""],p="";for(;u[0].length<e;){const d=o.queryArc(a,a+1),f=d.filter(A=>A.hasOnset()).map(A=>A.duration),g=gcd(...f),b=g.inverse();u=u.map(A=>A+"|"),p+="|";for(let A=0;A<b;A++){const[S,M]=[l,l.add(g)],E=d.filter($=>$.whole.begin.lte(S)&&$.whole.end.gte(M)),F=E.length-u.length;F>0&&(u=u.concat(Array(F).fill(p))),u=u.map(($,Z)=>{const V=E[Z];if(V){const se=V.whole.begin.eq(S)?""+V.value:"-";return $+se}return $+"."}),p+=".",l=l.add(g)}a++}return u.join(`
`)}let stringParser,__steps=!0;const calculateSteps=function(o){__steps=!!o},setStringParser=o=>stringParser=o;let Pattern$1=class bn{constructor(e,a=void 0){this.query=e,this._Pattern=!0,this._steps=a}get _steps(){return this.__steps}set _steps(e){this.__steps=e===void 0?void 0:fraction$1(e)}setSteps(e){return this._steps=e,this}withSteps(e){return __steps?new bn(this.query,this._steps===void 0?void 0:e(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(e){const a=new bn(l=>this.query(l).map(u=>u.withValue(e)));return a._steps=this._steps,a}withState(e){return new bn(a=>this.query(e(a)))}fmap(e){return this.withValue(e)}appWhole(e,a){const l=this,u=function(p){const d=l.query(p),f=a.query(p),g=function(b,A){const S=b.part.intersection(A.part);if(S!=null)return new Hap(e(b.whole,A.whole),S,b.value(A.value),A.combineContext(b))};return flatten(d.map(b=>removeUndefineds(f.map(A=>g(b,A)))))};return new bn(u)}appBoth(e){const a=this,l=function(p,d){if(!(p==null||d==null))return p.intersection_e(d)},u=a.appWhole(l,e);return __steps&&(u._steps=lcm(e._steps,a._steps)),u}appLeft(e){const a=this,l=function(p){const d=[];for(const f of a.query(p)){const g=e.query(p.setSpan(f.wholeOrPart()));for(const b of g){const A=f.whole,S=f.part.intersection(b.part);if(S){const M=f.value(b.value),E=b.combineContext(f),F=new Hap(A,S,M,E);d.push(F)}}}return d},u=new bn(l);return u._steps=this._steps,u}appRight(e){const a=this,l=function(p){const d=[];for(const f of e.query(p)){const g=a.query(p.setSpan(f.wholeOrPart()));for(const b of g){const A=f.whole,S=b.part.intersection(f.part);if(S){const M=b.value(f.value),E=f.combineContext(b),F=new Hap(A,S,M,E);d.push(F)}}}return d},u=new bn(l);return u._steps=e._steps,u}bindWhole(e,a){const l=this,u=function(p){const d=function(g,b){return new Hap(e(g.whole,b.whole),b.part,b.value,Object.assign({},g.context,b.context,{locations:(g.context.locations||[]).concat(b.context.locations||[])}))},f=function(g){return a(g.value).query(p.setSpan(g.part)).map(b=>d(g,b))};return flatten(l.query(p).map(g=>f(g)))};return new bn(u)}bind(e){const a=function(l,u){if(!(l==null||u==null))return l.intersection_e(u)};return this.bindWhole(a,e)}join(){return this.bind(id)}outerBind(e){return this.bindWhole(a=>a,e).setSteps(this._steps)}outerJoin(){return this.outerBind(id)}innerBind(e){return this.bindWhole((a,l)=>l,e)}innerJoin(){return this.innerBind(id)}resetJoin(e=!1){const a=this;return new bn(l=>a.discreteOnly().query(l).map(u=>u.value.late(e?u.whole.begin:u.whole.begin.cyclePos()).query(l).map(p=>new Hap(p.whole?p.whole.intersection(u.whole):void 0,p.part.intersection(u.part),p.value).setContext(u.combineContext(p))).filter(p=>p.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const e=this;function a(l){const u=e.discreteOnly().query(l);function p(f){const b=f.value._focusSpan(f.wholeOrPart()).query(l.setSpan(f.part));function A(S,M){let E;if(M.whole&&S.whole&&(E=M.whole.intersection(S.whole),!E))return;const F=M.part.intersection(S.part);if(!F)return;const $=M.combineContext(S);return new Hap(E,F,M.value,$)}return b.map(S=>A(f,S))}return flatten(u.map(p)).filter(f=>f)}return new bn(a)}squeezeBind(e){return this.fmap(e).squeezeJoin()}polyJoin=function(){const e=this;return e.fmap(a=>a.extend(e._steps.div(a._steps))).outerJoin()};polyBind(e){return this.fmap(e).polyJoin()}queryArc(e,a,l={}){try{return this.query(new State(new TimeSpan(e,a),l))}catch(u){return errorLogger$1(u,"query"),[]}}splitQueries(){const e=this,a=l=>flatten(l.span.spanCycles.map(u=>e.query(l.setSpan(u))));return new bn(a)}withQuerySpan(e){return new bn(a=>this.query(a.withSpan(e)))}withQuerySpanMaybe(e){const a=this;return new bn(l=>{const u=l.withSpan(e);return u.span?a.query(u):[]})}withQueryTime(e){return new bn(a=>this.query(a.withSpan(l=>l.withTime(e))))}withHapSpan(e){return new bn(a=>this.query(a).map(l=>l.withSpan(e)))}withHapTime(e){return this.withHapSpan(a=>a.withTime(e))}withHaps(e){const a=new bn(l=>e(this.query(l),l));return a._steps=this._steps,a}withHap(e){return this.withHaps(a=>a.map(e))}setContext(e){return this.withHap(a=>a.setContext(e))}withContext(e){const a=this.withHap(l=>l.setContext(e(l.context)));return this.__pure!==void 0&&(a.__pure=this.__pure,a.__pure_loc=this.__pure_loc),a}stripContext(){return this.withHap(e=>e.setContext({}))}withLoc(e,a){const l={start:e,end:a},u=this.withContext(p=>{const d=(p.locations||[]).concat([l]);return{...p,locations:d}});return this.__pure&&(u.__pure=this.__pure,u.__pure_loc=l),u}filterHaps(e){return new bn(a=>this.query(a).filter(e))}filterValues(e){return new bn(a=>this.query(a).filter(l=>e(l.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(e=>e!=null)}onsetsOnly(){return this.filterHaps(e=>e.hasOnset())}discreteOnly(){return this.filterHaps(e=>e.whole)}defragmentHaps(){return this.discreteOnly().withHaps(a=>{const l=[];for(var u=0;u<a.length;++u){for(var p=!0,d=a[u];p;){const b=JSON.stringify(a[u].value);for(var f=!1,g=u+1;g<a.length;g++){const A=a[g];if(d.whole.equals(A.whole)){if(d.part.begin.eq(A.part.end)){if(b===JSON.stringify(A.value)){d=new Hap(d.whole,new TimeSpan(A.part.begin,d.part.end),d.value),a.splice(g,1),f=!0;break}}else if(A.part.begin.eq(d.part.end)&&b==JSON.stringify(A.value)){d=new Hap(d.whole,new TimeSpan(d.part.begin,A.part.end),d.value),a.splice(g,1),f=!0;break}}}p=f}l.push(d)}return l})}firstCycle(e=!1){var a=this;return e||(a=a.stripContext()),a.query(new State(new TimeSpan(fraction$1(0),fraction$1(1))))}get firstCycleValues(){return this.firstCycle().map(e=>e.value)}get showFirstCycle(){return this.firstCycle().map(e=>`${e.value}: ${e.whole.begin.toFraction()} - ${e.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(e=>e.sort((a,l)=>a.part.begin.sub(l.part.begin).or(a.part.end.sub(l.part.end)).or(a.whole.begin.sub(l.whole.begin).or(a.whole.end.sub(l.whole.end)))))}asNumber(){return this.fmap(parseNumeral)}_opIn(e,a){return this.fmap(a).appLeft(reify(e))}_opOut(e,a){return this.fmap(a).appRight(reify(e))}_opMix(e,a){return this.fmap(a).appBoth(reify(e))}_opSqueeze(e,a){const l=reify(e);return this.fmap(u=>l.fmap(p=>a(u)(p))).squeezeJoin()}_opSqueezeOut(e,a){const l=this;return reify(e).fmap(p=>l.fmap(d=>a(d)(p))).squeezeJoin()}_opReset(e,a){return reify(e).fmap(u=>this.fmap(p=>a(p)(u))).resetJoin()}_opRestart(e,a){return reify(e).fmap(u=>this.fmap(p=>a(p)(u))).restartJoin()}_opPoly(e,a){const l=reify(e);return this.fmap(u=>l.fmap(p=>a(p)(u))).polyJoin()}layer(...e){return stack(...e.map(a=>a(this)))}superimpose(...e){return this.stack(...e.map(a=>a(this)))}stack(...e){return stack(this,...e)}sequence(...e){return sequence(this,...e)}seq(...e){return sequence(this,...e)}cat(...e){return cat(this,...e)}fastcat(...e){return fastcat(this,...e)}slowcat(...e){return slowcat(this,...e)}onTrigger(e,a=!0){return this.withHap(l=>l.setContext({...l.context,onTrigger:(...u)=>{l.context.onTrigger?.(...u),e(...u)},dominantTrigger:l.context.dominantTrigger||a}))}log(e=l=>`[hap] ${l.showWhole(!0)}`,a=l=>({hap:l})){return this.onTrigger((...l)=>{logger$2(e(...l),void 0,a(...l))},!1)}logValues(e=a=>`[hap] ${stringifyValues(a,!0)}`){return this.log(a=>e(a.value))}drawLine(){return console.log(drawLine(this)),this}unjoin(e,a=id){return e.withHap(l=>l.withValue(u=>u?a(this.ribbon(l.whole.begin,l.whole.duration)):this))}into(e,a){return this.unjoin(e,a).innerJoin()}};function groupHapsBy(o,e){let a=[];return e.forEach(l=>{const u=a.findIndex(([p])=>o(l,p));u===-1?a.push([l]):a[u].push(l)}),a}const congruent=(o,e)=>o.spanEquals(e);Pattern$1.prototype.collect=function(){return this.withHaps(o=>groupHapsBy(congruent,o).map(e=>new Hap(e[0].whole,e[0].part,e,{})))};const arpWith=register("arpWith",(o,e)=>e.collect().fmap(a=>reify(o(a))).innerJoin().withHap(a=>new Hap(a.whole,a.part,a.value.value,a.combineContext(a.value)))),arp=register("arp",(o,e)=>e.arpWith(a=>reify(o).fmap(l=>a[l%a.length])),!1);function _nonArrayObject(o){return!Array.isArray(o)&&typeof o=="object"&&!isFraction(o)}function _composeOp(o,e,a){return _nonArrayObject(o)||_nonArrayObject(e)?(_nonArrayObject(o)||(o={value:o}),_nonArrayObject(e)||(e={value:e}),unionWithObj(o,e,a)):a(o,e)}(function(){const o={set:[(a,l)=>l],keep:[a=>a],keepif:[(a,l)=>l?a:void 0],add:[numeralArgs((a,l)=>a+l)],sub:[numeralArgs((a,l)=>a-l)],mul:[numeralArgs((a,l)=>a*l)],div:[numeralArgs((a,l)=>a/l)],mod:[numeralArgs(_mod$2)],pow:[numeralArgs(Math.pow)],log2:[numeralArgs(Math.log2)],band:[numeralArgs((a,l)=>a&l)],bor:[numeralArgs((a,l)=>a|l)],bxor:[numeralArgs((a,l)=>a^l)],blshift:[numeralArgs((a,l)=>a<<l)],brshift:[numeralArgs((a,l)=>a>>l)],lt:[(a,l)=>a<l],gt:[(a,l)=>a>l],lte:[(a,l)=>a<=l],gte:[(a,l)=>a>=l],eq:[(a,l)=>a==l],eqt:[(a,l)=>a===l],ne:[(a,l)=>a!=l],net:[(a,l)=>a!==l],and:[(a,l)=>a&&l],or:[(a,l)=>a||l],func:[(a,l)=>l(a)]},e=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[a,[l,u]]of Object.entries(o)){Pattern$1.prototype["_"+a]=function(p){return this.fmap(d=>l(d,p))},Object.defineProperty(Pattern$1.prototype,a,{get:function(){const p=this,d=(...f)=>p[a].in(...f);for(const f of e)d[f.toLowerCase()]=function(...g){var b=p;g=sequence(g),u&&(b=u(b),g=u(g));var A;return a==="keepif"?(A=b["_op"+f](g,S=>M=>l(S,M)),A=A.removeUndefineds()):A=b["_op"+f](g,S=>M=>_composeOp(S,M,l)),A};return d.squeezein=d.squeeze,d}});for(const p of e)Pattern$1.prototype[p.toLowerCase()]=function(...d){return this.set[p.toLowerCase()](d)}}Pattern$1.prototype.struct=function(...a){return this.keepif.out(...a)},Pattern$1.prototype.structAll=function(...a){return this.keep.out(...a)},Pattern$1.prototype.mask=function(...a){return this.keepif.in(...a)},Pattern$1.prototype.maskAll=function(...a){return this.keep.in(...a)},Pattern$1.prototype.reset=function(...a){return this.keepif.reset(...a)},Pattern$1.prototype.resetAll=function(...a){return this.keep.reset(...a)},Pattern$1.prototype.restart=function(...a){return this.keepif.restart(...a)},Pattern$1.prototype.restartAll=function(...a){return this.keep.restart(...a)}})();const polyrhythm=stack,pr=stack,pm=polymeter,gap=o=>new Pattern$1(()=>[],o),silence=gap(1),nothing=gap(0);function pure(o){function e(l){return l.span.spanCycles.map(u=>new Hap(fraction$1(u.begin).wholeCycle(),u,o))}const a=new Pattern$1(e,1);return a.__pure=o,a}function isPattern(o){return o instanceof Pattern$1||o?._Pattern}function reify(o){return isPattern(o)?o:stringParser&&typeof o=="string"?stringParser(o):pure(o)}function sequenceP(o){let e=pure([]);for(const a of o)e=e.bind(l=>a.fmap(u=>l.concat([u])));return e}function stack(...o){o=o.map(l=>Array.isArray(l)?sequence(...l):reify(l));const e=l=>flatten(o.map(u=>u.query(l))),a=new Pattern$1(e);return __steps&&(a._steps=lcm(...o.map(l=>l._steps))),a}function _stackWith(o,e){if(e=e.map(p=>Array.isArray(p)?sequence(...p):reify(p)),e.length===0)return silence;if(e.length===1)return e[0];const[a,...l]=e.map(p=>p._steps),u=__steps?a.maximum(...l):void 0;return stack(...o(u,e))}function stackLeft(...o){return _stackWith((e,a)=>a.map(l=>l._steps.eq(e)?l:stepcat(l,gap(e.sub(l._steps)))),o)}function stackRight(...o){return _stackWith((e,a)=>a.map(l=>l._steps.eq(e)?l:stepcat(gap(e.sub(l._steps)),l)),o)}function stackCentre(...o){return _stackWith((e,a)=>a.map(l=>{if(l._steps.eq(e))return l;const u=gap(e.sub(l._steps).div(2));return stepcat(u,l,u)}),o)}function stackBy(o,...e){const[a,...l]=e.map(d=>d._steps),u=a.maximum(...l),p={centre:stackCentre,left:stackLeft,right:stackRight,expand:stack,repeat:(...d)=>polymeter(...d).steps(u)};return o.inhabit(p).fmap(d=>d(...e)).innerJoin().setSteps(u)}function slowcat(...o){if(o=o.map(l=>Array.isArray(l)?fastcat(...l):reify(l)),o.length==1)return o[0];const e=function(l){const u=l.span,p=_mod$2(u.begin.sam(),o.length),d=o[p];if(!d)return[];const f=u.begin.floor().sub(u.begin.div(o.length).floor());return d.withHapTime(g=>g.add(f)).query(l.setSpan(u.withTime(g=>g.sub(f))))},a=__steps?lcm(...o.map(l=>l._steps)):void 0;return new Pattern$1(e).splitQueries().setSteps(a)}function slowcatPrime(...o){o=o.map(reify);const e=function(a){const l=Math.floor(a.span.begin)%o.length;return o[l]?.query(a)||[]};return new Pattern$1(e).splitQueries()}function cat(...o){return slowcat(...o)}function arrange(...o){const e=o.reduce((a,[l])=>a+l,0);return o=o.map(([a,l])=>[a,l.fast(a)]),stepcat(...o).slow(e)}function seqPLoop(...o){let e=fraction$1(0);for(let a of o)a.length==2&&a.unshift(e),e=a[1];return stack(...o.map(([a,l,u])=>pure(reify(u)).compress(fraction$1(a).div(e),fraction$1(l).div(e)))).slow(e).innerJoin()}function fastcat(...o){let e=slowcat(...o);return o.length>1&&(e=e._fast(o.length),e._steps=o.length),o.length==1&&o[0].__steps_source&&(o._steps=o[0]._steps),e}function sequence(...o){return fastcat(...o)}function seq(...o){return fastcat(...o)}function _sequenceCount(o){return Array.isArray(o)?o.length==0?[silence,0]:o.length==1?_sequenceCount(o[0]):[fastcat(...o.map(e=>_sequenceCount(e)[0])),o.length]:[reify(o),1]}const mask=curry((o,e)=>reify(e).mask(o)),struct=curry((o,e)=>reify(e).struct(o)),superimpose=curry((o,e)=>reify(e).superimpose(...o)),withValue=curry((o,e)=>reify(e).withValue(o)),bind=curry((o,e)=>reify(e).bind(o)),innerBind=curry((o,e)=>reify(e).innerBind(o)),outerBind=curry((o,e)=>reify(e).outerBind(o)),squeezeBind=curry((o,e)=>reify(e).squeezeBind(o)),stepBind=curry((o,e)=>reify(e).stepBind(o)),polyBind=curry((o,e)=>reify(e).polyBind(o)),set=curry((o,e)=>reify(e).set(o)),keep=curry((o,e)=>reify(e).keep(o)),keepif=curry((o,e)=>reify(e).keepif(o)),add$5=curry((o,e)=>reify(e).add(o)),sub=curry((o,e)=>reify(e).sub(o)),mul=curry((o,e)=>reify(e).mul(o)),div=curry((o,e)=>reify(e).div(o)),mod$3=curry((o,e)=>reify(e).mod(o)),pow=curry((o,e)=>reify(e).pow(o)),band=curry((o,e)=>reify(e).band(o)),bor=curry((o,e)=>reify(e).bor(o)),bxor=curry((o,e)=>reify(e).bxor(o)),blshift=curry((o,e)=>reify(e).blshift(o)),brshift=curry((o,e)=>reify(e).brshift(o)),lt=curry((o,e)=>reify(e).lt(o)),gt=curry((o,e)=>reify(e).gt(o)),lte=curry((o,e)=>reify(e).lte(o)),gte=curry((o,e)=>reify(e).gte(o)),eq=curry((o,e)=>reify(e).eq(o)),eqt=curry((o,e)=>reify(e).eqt(o)),ne=curry((o,e)=>reify(e).ne(o)),net=curry((o,e)=>reify(e).net(o)),and=curry((o,e)=>reify(e).and(o)),or=curry((o,e)=>reify(e).or(o)),func=curry((o,e)=>reify(e).func(o));function register(o,e,a=!0,l=!1,u=p=>p.innerJoin()){if(Array.isArray(o)){const f={};for(const g of o)f[g]=register(g,e,a,l,u);return f}const p=e.length;var d;return a?d=function(...f){f=f.map(reify);const g=f[f.length-1];let b;if(p===1)b=e(g);else{const A=f.slice(0,-1);if(A.every(S=>S.__pure!=null)){const S=A.map(E=>E.__pure),M=A.filter(E=>E.__pure_loc).map(E=>E.__pure_loc);b=e(...S,g),b=b.withContext(E=>{const F=(E.locations||[]).concat(M);return{...E,locations:F}})}else{const[S,...M]=A;let E=(...F)=>e(...F,g);E=curry(E,null,p-1),b=u(M.reduce((F,$)=>F.appLeft($),S.fmap(E)))}}return l&&(b._steps=g._steps),b}:d=function(...f){f=f.map(reify);const g=e(...f);return l&&(g._steps=f[f.length-1]._steps),g},Pattern$1.prototype[o]=function(...f){if(p===2&&f.length!==1)f=[sequence(...f)];else if(p!==f.length+1)throw new Error(`.${o}() expects ${p-1} inputs but got ${f.length}.`);return f=f.map(reify),d(...f,this)},p>1&&(Pattern$1.prototype["_"+o]=function(...f){const g=e(...f,this);return l&&g.setSteps(this._steps),g}),curry(d,null,p)}function stepRegister(o,e,a=!0,l=!1,u=p=>p.stepJoin()){return register(o,e,a,l,u)}const round=register("round",function(o){return o.asNumber().fmap(e=>Math.round(e))}),floor=register("floor",function(o){return o.asNumber().fmap(e=>Math.floor(e))}),ceil=register("ceil",function(o){return o.asNumber().fmap(e=>Math.ceil(e))}),toBipolar=register("toBipolar",function(o){return o.fmap(e=>e*2-1)}),fromBipolar=register("fromBipolar",function(o){return o.fmap(e=>(e+1)/2)}),range$2=register("range",function(o,e,a){return a.mul(e-o).add(o)}),rangex=register("rangex",function(o,e,a){return a._range(Math.log(o),Math.log(e)).fmap(Math.exp)}),range2=register("range2",function(o,e,a){return a.fromBipolar()._range(o,e)}),ratio=register("ratio",o=>o.fmap(e=>Array.isArray(e)?e.slice(1).reduce((a,l)=>a/l,e[0]):e)),compress=register("compress",function(o,e,a){return o=fraction$1(o),e=fraction$1(e),o.gt(e)||o.gt(1)||e.gt(1)||o.lt(0)||e.lt(0)?silence:a._fastGap(fraction$1(1).div(e.sub(o)))._late(o)}),{compressSpan,compressspan}=register(["compressSpan","compressspan"],function(o,e){return e._compress(o.begin,o.end)}),{fastGap,fastgap}=register(["fastGap","fastgap"],function(o,e){const a=function(u){const p=u.begin.sam(),d=u.begin.sub(p).mul(o).min(1),f=u.end.sub(p).mul(o).min(1);if(!(d>=1))return new TimeSpan(p.add(d),p.add(f))},l=function(u){const p=u.part.begin,d=u.part.end,f=p.sam(),g=p.sub(f).div(o).min(1),b=d.sub(f).div(o).min(1),A=new TimeSpan(f.add(g),f.add(b)),S=u.whole?new TimeSpan(A.begin.sub(p.sub(u.whole.begin).div(o)),A.end.add(u.whole.end.sub(d).div(o))):void 0;return new Hap(S,A,u.value,u.context)};return e.withQuerySpanMaybe(a).withHap(l).splitQueries()}),focus=register("focus",function(o,e,a){return o=fraction$1(o),e=fraction$1(e),a._early(o.sam())._fast(fraction$1(1).div(e.sub(o)))._late(o)}),{focusSpan,focusspan}=register(["focusSpan","focusspan"],function(o,e){return e._focus(o.begin,o.end)}),ply=register("ply",function(o,e){const a=e.fmap(l=>pure(l)._fast(o)).squeezeJoin();return __steps&&(a._steps=fraction$1(o).mulmaybe(e._steps)),a}),{fast,density:density$1}=register(["fast","density"],function(o,e){return o===0?silence:(o=fraction$1(o),e.withQueryTime(l=>l.mul(o)).withHapTime(l=>l.div(o)).setSteps(e._steps))},!0,!0),hurry=register("hurry",function(o,e){return e._fast(o).mul(pure({speed:o}))}),{slow,sparsity}=register(["slow","sparsity"],function(o,e){return o===0?silence:e._fast(fraction$1(1).div(o))}),inside=register("inside",function(o,e,a){return e(a._slow(o))._fast(o)}),outside=register("outside",function(o,e,a){return e(a._fast(o))._slow(o)}),lastOf=register("lastOf",function(o,e,a){const l=Array(o-1).fill(a);return l.push(e(a)),slowcatPrime(...l)}),{firstOf,every}=register(["firstOf","every"],function(o,e,a){const l=Array(o-1).fill(a);return l.unshift(e(a)),slowcatPrime(...l)}),apply=register("apply",function(o,e){return o(e)}),cpm=register("cpm",function(o,e){return e._fast(o/60/1)}),early=register("early",function(o,e){return o=fraction$1(o),e.withQueryTime(a=>a.add(o)).withHapTime(a=>a.sub(o))},!0,!0),late=register("late",function(o,e){return o=fraction$1(o),e._early(fraction$1(0).sub(o))},!0,!0),zoom=register("zoom",function(o,e,a){if(e=fraction$1(e),o=fraction$1(o),o.gte(e))return nothing;const l=e.sub(o),u=__steps?a._steps?.mulmaybe(l):void 0;return a.withQuerySpan(p=>p.withCycle(d=>d.mul(l).add(o))).withHapSpan(p=>p.withCycle(d=>d.sub(o).div(l))).splitQueries().setSteps(u)}),{zoomArc,zoomarc}=register(["zoomArc","zoomarc"],function(o,e){return e.zoom(o.begin,o.end)}),bite=register("bite",(o,e,a)=>e.fmap(l=>u=>{const p=fraction$1(l).div(u).mod(1),d=p.add(fraction$1(1).div(u));return a.zoom(p,d)}).appLeft(o).squeezeJoin(),!1),linger=register("linger",function(o,e){return o==0?silence:o<0?e._zoom(o.add(1),1)._slow(o):e._zoom(0,o)._slow(o)},!0,!0),{segment,seg}=register(["segment","seg"],function(o,e){return e.struct(pure(!0)._fast(o)).setSteps(o)}),swingBy=register("swingBy",(o,e,a)=>a.inside(e,late(seq(0,o/2)))),swing=register("swing",(o,e)=>e.swingBy(1/3,o)),{invert:invert$1,inv}=register(["invert","inv"],function(o){return o.fmap(e=>!e)},!0,!0),when=register("when",function(o,e,a){return o?e(a):a}),off=register("off",function(o,e,a){return stack(a,e(a.late(o)))}),brak=register("brak",function(o){return o.when(slowcat(!1,!0),e=>fastcat(e,silence)._late(.25))}),rev=register("rev",function(o){const e=function(a){const l=a.span,u=l.begin.sam(),p=l.begin.nextSam(),d=function(g){const b=g.withTime(S=>u.add(p.sub(S))),A=b.begin;return b.begin=b.end,b.end=A,b};return o.query(a.setSpan(d(l))).map(g=>g.withSpan(d))};return new Pattern$1(e).splitQueries()},!1,!0),revv=register("revv",function(o){const e=a=>new TimeSpan(fraction$1(0).sub(a.end),fraction$1(0).sub(a.begin));return o.withQuerySpan(e).withHapSpan(e)}),pressBy=register("pressBy",function(o,e){return e.fmap(a=>pure(a).compress(o,1)).squeezeJoin()}),press=register("press",function(o){return o._pressBy(.5)});Pattern$1.prototype.hush=function(){return silence};const palindrome=register("palindrome",function(o){return o.lastOf(2,rev)},!0,!0),{juxBy,juxby}=register(["juxBy","juxby"],function(o,e,a){o/=2;const l=function(d,f,g){return f in d?d[f]:g},u=a.withValue(d=>Object.assign({},d,{pan:l(d,"pan",.5)-o})),p=e(a.withValue(d=>Object.assign({},d,{pan:l(d,"pan",.5)+o})));return stack(u,p).setSteps(__steps?lcm(u._steps,p._steps):void 0)}),jux=register("jux",function(o,e){return e._juxBy(1,o,e)}),{echoWith,echowith,stutWith,stutwith}=register(["echoWith","echowith","stutWith","stutwith"],function(o,e,a,l){return stack(...listRange(0,o-1).map(u=>a(l.late(fraction$1(e).mul(u)),u)))}),echo=register("echo",function(o,e,a,l){return l._echoWith(o,e,(u,p)=>u.gain(Math.pow(a,p)))}),stut=register("stut",function(o,e,a,l){return l._echoWith(o,a,(u,p)=>u.gain(Math.pow(e,p)))}),applyN=register("applyN",function(o,e,a){let l=a;for(let u=0;u<o;u++)l=e(l);return l}),plyWith=register(["plyWith","plywith"],function(o,e,a){const l=a.fmap(u=>cat(...listRange(0,o-1).map(p=>applyN(p,e,u)))._fast(o)).squeezeJoin();return __steps&&(l._steps=fraction$1(o).mulmaybe(a._steps)),l}),plyForEach=register(["plyForEach","plyforeach"],function(o,e,a){const l=a.fmap(u=>cat(cat(pure(u),...listRange(1,o-1).map(p=>e(pure(u),p))))._fast(o)).squeezeJoin();return __steps&&(l._steps=fraction$1(o).mulmaybe(a._steps)),l}),_iter=function(o,e,a=!1){return o=fraction$1(o),slowcat(...listRange(0,o.sub(1)).map(l=>a?e.late(fraction$1(l).div(o)):e.early(fraction$1(l).div(o))))},iter=register("iter",function(o,e){return _iter(o,e,!1)},!0,!0),{iterBack,iterback}=register(["iterBack","iterback"],function(o,e){return _iter(o,e,!0)},!0,!0),{repeatCycles}=register("repeatCycles",function(o,e){return new Pattern$1(function(a){const l=a.span.begin.sam(),u=l.div(o).sam(),p=l.sub(u);return a=a.withSpan(d=>d.withTime(f=>f.sub(p))),e.query(a).map(d=>d.withSpan(f=>f.withTime(g=>g.add(p))))}).splitQueries()},!0,!0),_chunk=function(o,e,a,l=!1,u=!1){const p=Array(o-1).fill(!1);p.unshift(!0);const d=_iter(o,sequence(...p),!l);return u||(a=a.repeatCycles(o)),a.when(d,e)},{chunk,slowchunk,slowChunk}=register(["chunk","slowchunk","slowChunk"],function(o,e,a){return _chunk(o,e,a,!1,!1)},!0,!0),{chunkBack,chunkback}=register(["chunkBack","chunkback"],function(o,e,a){return _chunk(o,e,a,!0)},!0,!0),{fastchunk,fastChunk}=register(["fastchunk","fastChunk"],function(o,e,a){return _chunk(o,e,a,!1,!0)},!0,!0),{chunkinto,chunkInto}=register(["chunkinto","chunkInto"],function(o,e,a){return a.into(fastcat(!0,...Array(o-1).fill(!1))._iterback(o),e)}),{chunkbackinto,chunkBackInto}=register(["chunkbackinto","chunkBackInto"],function(o,e,a){return a.into(fastcat(!0,...Array(o-1).fill(!1))._iter(o)._early(1),e)}),bypass=register("bypass",function(o,e){return o=!!parseInt(o),o?silence:e},!0,!0),{ribbon,rib}=register(["ribbon","rib"],(o,e,a)=>a.early(o).restart(pure(1).slow(e))),hsla=register("hsla",(o,e,a,l,u)=>u.color(`hsla(${o}turn,${e*100}%,${a*100}%,${l})`)),hsl=register("hsl",(o,e,a,l)=>l.color(`hsl(${o}turn,${e*100}%,${a*100}%)`));Pattern$1.prototype.tag=function(o){return this.withContext(e=>({...e,tags:(e.tags||[]).concat([o])}))};const filter$1=register("filter",(o,e)=>e.withHaps(a=>a.filter(o))),filterWhen=register("filterWhen",(o,e)=>e.filter(a=>o(a.whole.begin))),within=register("within",(o,e,a,l)=>stack(a(l.filterWhen(u=>u.cyclePos()>=o&&u.cyclePos()<=e)),l.filterWhen(u=>u.cyclePos()<o||u.cyclePos()>e)));Pattern$1.prototype.stepJoin=function(){const o=this,e=stepcat(..._retime(_slices(o.queryArc(0,1))))._steps,a=function(l){const p=o.early(l.span.begin.sam()).query(l.setSpan(new TimeSpan(fraction$1(0),fraction$1(1))));return stepcat(..._retime(_slices(p))).query(l)};return new Pattern$1(a,e)},Pattern$1.prototype.stepBind=function(o){return this.fmap(o).stepJoin()};function _retime(o){const e=o.filter((p,d)=>d.hasSteps).reduce((p,d)=>p.add(d),fraction$1(0)),a=removeUndefineds(o.map((p,d)=>d._steps)).reduce((p,d)=>p.add(d),fraction$1(0)),l=e.eq(0)?void 0:a.div(e);function u(p,d){return d._steps===void 0?[p.mulmaybe(l),d]:[d._steps,d]}return o.map(p=>u(...p))}function _slices(o){const e=flatten(o.map(u=>[u.part.begin,u.part.end])),a=uniqsortr([fraction$1(0),fraction$1(1),...e]);return pairs(a).map(u=>[u[1].sub(u[0]),stack(..._fitslice(new TimeSpan(...u),o).map(p=>p.value.withHap(d=>d.setContext(d.combineContext(p)))))])}function _fitslice(o,e){return removeUndefineds(e.map(a=>_match(o,a)))}function _match(o,e){const a=o.intersection(e.part);if(a!=null)return new Hap(e.whole,a,e.value,e.context)}const pace=register("pace",function(o,e){return e._steps===void 0?e:e._steps.eq(fraction$1(0))?nothing:e._fast(fraction$1(o).div(e._steps)).setSteps(o)});function _polymeterListSteps(o,...e){const a=e.map(u=>_sequenceCount(u));if(a.length==0)return silence;o==0&&(o=a[0][1]);const l=[];for(const u of a)u[1]!=0&&(o==u[1]?l.push(u[0]):l.push(u[0]._fast(fraction$1(o).div(fraction$1(u[1])))));return stack(...l)}function polymeter(...o){if(Array.isArray(o[0]))return _polymeterListSteps(0,...o);if(o=o.filter(l=>l.hasSteps),o.length==0)return silence;const e=lcm(...o.map(l=>l._steps));if(e.eq(fraction$1(0)))return nothing;const a=stack(...o.map(l=>l.pace(e)));return a._steps=e,a}function stepcat(...o){if(o.length===0)return nothing;const e=d=>Array.isArray(d)?d:[d._steps??1,d];if(o=o.map(e),o.find(d=>d[0]===void 0)){const d=o.map(g=>g[0]).filter(g=>g!==void 0);if(d.length===0)return fastcat(...o.map(g=>g[1]));if(d.length===o.length)return nothing;const f=d.reduce((g,b)=>g.add(b),fraction$1(0)).div(d.length);for(let g of o)g[0]===void 0&&(g[0]=f)}if(o.length==1)return reify(o[0][1]).withSteps(f=>o[0][0]);const a=o.map(d=>d[0]).reduce((d,f)=>d.add(f),fraction$1(0));let l=fraction$1(0);const u=[];for(const[d,f]of o){if(fraction$1(d).eq(0))continue;const g=l.add(d);u.push(reify(f)._compress(l.div(a),g.div(a))),l=g}const p=stack(...u);return p._steps=a,p}function stepalt(...o){o=o.map(u=>Array.isArray(u)?u.map(reify):[reify(u)]);const e=lcm(...o.map(u=>fraction$1(u.length)));let a=[];for(let u=0;u<e;++u)a.push(...o.map(p=>p.length==0?silence:p[u%p.length]));a=a.filter(u=>u.hasSteps&&u._steps>0);const l=a.reduce((u,p)=>u.add(p._steps),fraction$1(0));return a=stepcat(...a),a._steps=l,a}const take=stepRegister("take",function(o,e){if(!e.hasSteps||e._steps.lte(0)||(o=fraction$1(o),o.eq(0)))return nothing;const a=o<0;a&&(o=o.abs());const l=o.div(e._steps);return l.lte(0)?nothing:l.gte(1)?e:a?e.zoom(fraction$1(1).sub(l),1):e.zoom(0,l)}),drop=stepRegister("drop",function(o,e){return e.hasSteps?(o=fraction$1(o),o.lt(0)?e.take(e._steps.add(o)):e.take(fraction$1(0).sub(e._steps.sub(o)))):nothing}),extend=stepRegister("extend",function(o,e){return e.fast(o).expand(o)}),replicate=stepRegister("replicate",function(o,e){return e.repeatCycles(o).fast(o).expand(o)}),expand=stepRegister("expand",function(o,e){return e.withSteps(a=>a.mul(fraction$1(o)))}),contract=stepRegister("contract",function(o,e){return e.withSteps(a=>a.div(fraction$1(o)))});Pattern$1.prototype.shrinklist=function(o){const e=this;if(!e.hasSteps)return[e];let[a,l]=Array.isArray(o)?o:[o,e._steps];if(a=fraction$1(a),l===0||a===0)return[e];const u=a>0,p=[];if(u){const d=fraction$1(1).div(e._steps).mul(a);for(let f=0;f<l;++f){const g=d.mul(f);if(g.gt(1))break;p.push([g,1])}}else{a=fraction$1(0).sub(a);const d=fraction$1(1).div(e._steps).mul(a);for(let f=0;f<l;++f){const g=fraction$1(1).sub(d.mul(f));if(g.lt(0))break;p.push([fraction$1(0),g])}}return p.map(d=>e.zoom(...d))};const shrinklist=(o,e)=>e.shrinklist(o),shrink=register("shrink",function(o,e){if(!e.hasSteps)return nothing;const a=e.shrinklist(o),l=stepcat(...a);return l._steps=a.reduce((u,p)=>u.add(p._steps),fraction$1(0)),l},!0,!1,o=>o.stepJoin()),grow=register("grow",function(o,e){if(!e.hasSteps)return nothing;const a=e.shrinklist(fraction$1(0).sub(o));a.reverse();const l=stepcat(...a);return l._steps=a.reduce((u,p)=>u.add(p._steps),fraction$1(0)),l},!0,!1,o=>o.stepJoin()),tour=function(o,...e){return o.tour(...e)};Pattern$1.prototype.tour=function(...o){return stepcat(...[].concat(...o.map((e,a)=>[...o.slice(0,o.length-a),this,...o.slice(o.length-a)]),this,...o))};const zip=function(...o){o=o.filter(l=>l.hasSteps);const e=slowcat(...o.map(l=>l._slow(l._steps))),a=lcm(...o.map(l=>l._steps));return e._fast(a).setSteps(a)},timecat=stepcat,timeCat=stepcat,s_cat=stepcat,s_alt=stepalt,s_polymeter=polymeter;Pattern$1.prototype.s_polymeter=Pattern$1.prototype.polymeter;const s_taper=shrink;Pattern$1.prototype.s_taper=Pattern$1.prototype.shrink;const s_taperlist=shrinklist;Pattern$1.prototype.s_taperlist=Pattern$1.prototype.shrinklist;const s_add=take;Pattern$1.prototype.s_add=Pattern$1.prototype.take;const s_sub=drop;Pattern$1.prototype.s_sub=Pattern$1.prototype.drop;const s_expand=expand;Pattern$1.prototype.s_expand=Pattern$1.prototype.expand;const s_extend=extend;Pattern$1.prototype.s_extend=Pattern$1.prototype.extend;const s_contract=contract;Pattern$1.prototype.s_contract=Pattern$1.prototype.contract;const s_tour=tour;Pattern$1.prototype.s_tour=Pattern$1.prototype.tour;const s_zip=zip;Pattern$1.prototype.s_zip=Pattern$1.prototype.zip;const steps$2=pace;Pattern$1.prototype.steps=Pattern$1.prototype.pace;const chop=register("chop",function(o,e){const l=Array.from({length:o},(d,f)=>f).map(d=>({begin:d/o,end:(d+1)/o})),u=function(d,f){if("begin"in d&&"end"in d&&d.begin!==void 0&&d.end!==void 0){const g=d.end-d.begin;f={begin:d.begin+f.begin*g,end:d.begin+f.end*g}}return Object.assign({},d,f)},p=function(d){return sequence(l.map(f=>u(d,f)))};return e.squeezeBind(p).setSteps(__steps?fraction$1(o).mulmaybe(e._steps):void 0)}),striate=register("striate",function(o,e){const l=Array.from({length:o},(p,d)=>d).map(p=>({begin:p/o,end:(p+1)/o})),u=slowcat(...l);return e.set(u)._fast(o).setSteps(__steps?fraction$1(o).mulmaybe(e._steps):void 0)}),_loopAt=function(o,e,a=.5){return e.speed(1/o*a).unit("c").slow(o)},slice=register("slice",function(o,e,a){return o.innerBind(l=>e.outerBind(u=>a.outerBind(p=>{p=p instanceof Object?p:{s:p};const d=Array.isArray(l)?l[u]:u/l,f=Array.isArray(l)?l[u+1]:(u+1)/l;return pure({begin:d,end:f,_slices:l,...p})}))).setSteps(e._steps)},!1);Pattern$1.prototype.onTriggerTime=function(o){return this.onTrigger((e,a,l,u)=>{const p=u-a;window.setTimeout(()=>{o(e)},p*1e3)},!1)};const splice=register("splice",function(o,e,a){const l=slice(o,e,a);return new Pattern$1(u=>{const p=u.controls._cps||1;return l.query(u).map(f=>f.withValue(g=>({speed:p/g._slices/f.whole.duration*(g.speed||1),unit:"c",...g})))}).setSteps(e._steps)},!1),{loopAt,loopat}=register(["loopAt","loopat"],function(o,e){const a=e._steps?e._steps.div(o):void 0;return new Pattern$1(l=>_loopAt(o,e,l.controls._cps).query(l),a)}),fit=register("fit",o=>o.withHaps((e,a)=>e.map(l=>l.withValue(u=>{const p=("end"in u?u.end:1)-("begin"in u?u.begin:0);return{...u,speed:(a.controls._cps||1)/l.whole.duration*p,unit:"c"}})))),{loopAtCps,loopatcps}=register(["loopAtCps","loopatcps"],function(o,e,a){return _loopAt(o,a,e)}),ref$1=o=>pure(1).withValue(()=>reify(o())).innerJoin();let fadeGain=o=>o<.5?1:1-(o-.5)/.5,xfade=(o,e,a)=>{e=reify(e),o=reify(o),a=reify(a);let l=e.fmap(p=>({gain:fadeGain(p)})),u=e.fmap(p=>({gain:fadeGain(1-p)}));return stack(o.mul(l),a.mul(u))};Pattern$1.prototype.xfade=function(o,e){return xfade(this,o,e)};const __beat=o=>(e,a,l)=>{e=fraction$1(e).mod(a),a=fraction$1(a);const u=e.div(a),p=e.add(1).div(a);return o(l.fmap(d=>pure(d)._compress(u,p)))},{beat}=register(["beat"],__beat(o=>o.innerJoin())),_morph=(o,e,a)=>{a=fraction$1(a);const l=fraction$1(1).div(o.length),u=f=>{const g=[];for(const[b,A]of f.entries())A&&g.push([fraction$1(b).div(f.length),A]);return g},p=zipWith(([f,g],[b,A])=>{const S=a.mul(b-f).add(f),M=S.add(l);return new TimeSpan(S,M)},u(o),u(e));function d(f){const g=f.span.begin.sam(),b=f.span.cycleArc(),A=[];for(const S of p){const M=S.intersection(b);M!==void 0&&A.push(new Hap(S.withTime(E=>E.add(g)),M.withTime(E=>E.add(g)),!0))}return A}return new Pattern$1(d).splitQueries()},morph=(o,e,a)=>(o=reify(o),e=reify(e),a=reify(a),o.innerBind(l=>e.innerBind(u=>a.innerBind(p=>_morph(l,u,p))))),distAlgoNames=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const o of distAlgoNames)Pattern$1.prototype[o]=function(e){const a=reify(e).fmap(l=>Array.isArray(l)?[...l,o]:[l,1,o]);return this.distort(a)};const parray=o=>{let a=pure(curry((...l)=>l,null,o.length));for(const l of o)a=a.appBoth(reify(l));return a},_ensureListPattern=o=>Array.isArray(o)?parray(o):reify(o);Pattern$1.prototype.partials=function(o){return this.withValue(e=>a=>({...e,partials:a})).appLeft(_ensureListPattern(o))};const partials=o=>_ensureListPattern(o).as("partials");Pattern$1.prototype.phases=function(o){return this.withValue(e=>a=>({...e,phases:a})).appLeft(_ensureListPattern(o))};const phases=o=>_ensureListPattern(o).as("phases");function createParam(o){let e=Array.isArray(o);o=e?o:[o];const a=o[0],l=p=>{let d;if(typeof p=="object"&&p.value!==void 0&&(d={...p},p=p.value,delete d.value),e&&Array.isArray(p)){const f=d||{};return p.forEach((g,b)=>{b<o.length&&(f[o[b]]=g)}),f}else return d?(d[a]=p,d):{[a]:p}},u=function(p,d){return d?typeof p>"u"?d.fmap(l):d.set(reify(p).withValue(l)):reify(p).withValue(l)};return Pattern$1.prototype[a]=function(p){return u(p,this)},u}const controlAlias=new Map;function isControlName(o){return controlAlias.has(o)}function registerControl(o,...e){const a=Array.isArray(o)?o[0]:o;let l={};return l[a]=createParam(o),controlAlias.set(a,a),e.forEach(u=>{l[u]=l[a],controlAlias.set(u,a),Pattern$1.prototype[u]=Pattern$1.prototype[a]}),l}const{s,sound}=registerControl(["s","n","gain"],"sound"),{wt,wavetablePosition}=registerControl("wt","wavetablePosition"),{wtenv}=registerControl("wtenv"),{wtattack,wtatt}=registerControl("wtattack","wtatt"),{wtdecay,wtdec}=registerControl("wtdecay","wtdec"),{wtsustain,wtsus}=registerControl("wtsustain","wtsus"),{wtrelease,wtrel}=registerControl("wtrelease","wtrel"),{wtrate}=registerControl("wtrate"),{wtsync}=registerControl("wtsync"),{wtdepth}=registerControl("wtdepth"),{wtshape}=registerControl("wtshape"),{wtdc}=registerControl("wtdc"),{wtskew}=registerControl("wtskew"),{warp,wavetableWarp}=registerControl("warp","wavetableWarp"),{warpattack,warpatt}=registerControl("warpattack","warpatt"),{warpdecay,warpdec}=registerControl("warpdecay","warpdec"),{warpsustain,warpsus}=registerControl("warpsustain","warpsus"),{warprelease,warprel}=registerControl("warprelease","warprel"),{warprate}=registerControl("warprate"),{warpdepth}=registerControl("warpdepth"),{warpshape}=registerControl("warpshape"),{warpdc}=registerControl("warpdc"),{warpskew}=registerControl("warpskew"),{warpmode,wavetableWarpMode}=registerControl("warpmode","wavetableWarpMode"),{wtphaserand,wavetablePhaseRand}=registerControl("wtphaserand","wavetablePhaseRand"),{warpenv}=registerControl("warpenv"),{warpsync}=registerControl("warpsync"),{source,src}=registerControl("source","src"),{n}=registerControl("n"),{note:note$2}=registerControl(["note","n"]),{accelerate}=registerControl("accelerate"),{velocity}=registerControl("velocity"),{gain}=registerControl("gain"),{postgain}=registerControl("postgain"),{amp}=registerControl("amp"),{attack,att}=registerControl("attack","att"),{fmh}=registerControl(["fmh","fmi"],"fmh"),{fmi,fm:fm$1}=registerControl(["fmi","fmh"],"fm"),{fmenv}=registerControl("fmenv"),{fmattack}=registerControl("fmattack"),{fmwave}=registerControl("fmwave"),{fmdecay}=registerControl("fmdecay"),{fmsustain}=registerControl("fmsustain"),{fmrelease}=registerControl("fmrelease"),{fmvelocity}=registerControl("fmvelocity"),{bank}=registerControl("bank"),{chorus}=registerControl("chorus"),{analyze}=registerControl("analyze"),{fft}=registerControl("fft"),{decay,dec}=registerControl("decay","dec"),{sustain,sus}=registerControl("sustain","sus"),{release,rel}=registerControl("release","rel"),{hold}=registerControl("hold"),{bandf,bpf,bp}=registerControl(["bandf","bandq","bpenv"],"bpf","bp"),{bandq,bpq}=registerControl("bandq","bpq"),{begin}=registerControl("begin"),{end}=registerControl("end"),{loop}=registerControl("loop"),{loopBegin,loopb}=registerControl("loopBegin","loopb"),{loopEnd,loope}=registerControl("loopEnd","loope"),{crush}=registerControl("crush"),{coarse}=registerControl("coarse"),{tremolo}=registerControl(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync}=registerControl(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth}=registerControl("tremolodepth","tremdepth"),{tremoloskew}=registerControl("tremoloskew","tremskew"),{tremolophase}=registerControl("tremolophase","tremphase"),{tremoloshape}=registerControl("tremoloshape","tremshape"),{drive}=registerControl("drive"),{duck}=registerControl("duckorbit","duck"),{duckdepth}=registerControl("duckdepth"),{duckonset}=registerControl("duckonset","duckons"),{duckattack}=registerControl("duckattack","duckatt"),{byteBeatExpression,bbexpr}=registerControl("byteBeatExpression","bbexpr"),{byteBeatStartTime,bbst}=registerControl("byteBeatStartTime","bbst"),{channels,ch}=registerControl("channels","ch"),{pw}=registerControl(["pw","pwrate","pwsweep"]),{pwrate}=registerControl("pwrate"),{pwsweep}=registerControl("pwsweep"),{phaserrate,ph,phaser}=registerControl(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep,phs}=registerControl("phasersweep","phs"),{phasercenter,phc}=registerControl("phasercenter","phc"),{phaserdepth,phd,phasdp}=registerControl("phaserdepth","phd","phasdp"),{channel}=registerControl("channel"),{cut}=registerControl("cut"),{cutoff,ctf,lpf,lp}=registerControl(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv,lpe}=registerControl("lpenv","lpe"),{hpenv,hpe}=registerControl("hpenv","hpe"),{bpenv,bpe}=registerControl("bpenv","bpe"),{lpattack,lpa}=registerControl("lpattack","lpa"),{hpattack,hpa}=registerControl("hpattack","hpa"),{bpattack,bpa}=registerControl("bpattack","bpa"),{lpdecay,lpd}=registerControl("lpdecay","lpd"),{hpdecay,hpd}=registerControl("hpdecay","hpd"),{bpdecay,bpd}=registerControl("bpdecay","bpd"),{lpsustain,lps}=registerControl("lpsustain","lps"),{hpsustain,hps}=registerControl("hpsustain","hps"),{bpsustain,bps}=registerControl("bpsustain","bps"),{lprelease,lpr}=registerControl("lprelease","lpr"),{hprelease,hpr}=registerControl("hprelease","hpr"),{bprelease,bpr}=registerControl("bprelease","bpr"),{ftype}=registerControl("ftype"),{fanchor}=registerControl("fanchor"),{lprate}=registerControl("lprate"),{lpsync}=registerControl("lpsync"),{lpdepth}=registerControl("lpdepth"),{lpdepthfrequency}=registerControl("lpdepthfrequency","lpdepthfreq"),{lpshape}=registerControl("lpshape"),{lpdc}=registerControl("lpdc"),{lpskew}=registerControl("lpskew"),{bprate}=registerControl("bprate"),{bpsync}=registerControl("bpsync"),{bpdepth}=registerControl("bpdepth"),{bpdepthfrequency}=registerControl("bpdepthfrequency","bpdepthfreq"),{bpshape}=registerControl("bpshape"),{bpdc}=registerControl("bpdc"),{bpskew}=registerControl("bpskew"),{hprate}=registerControl("hprate"),{hpsync}=registerControl("hpsync"),{hpdepth,hpdepthfreq}=registerControl("hpdepth"),{hpdepthfrequency}=registerControl("hpdepthfrequency","hpdepthfreq"),{hpshape}=registerControl("hpshape"),{hpdc}=registerControl("hpdc"),{hpskew}=registerControl("hpskew"),{vib,vibrato,v}=registerControl(["vib","vibmod"],"vibrato","v"),{noise}=registerControl("noise"),{vibmod,vmod}=registerControl(["vibmod","vib"],"vmod"),{hcutoff,hpf,hp}=registerControl(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance,hpq}=registerControl("hresonance","hpq"),{resonance,lpq}=registerControl("resonance","lpq"),{djf}=registerControl("djf"),{delay}=registerControl(["delay","delaytime","delayfeedback"]),{delayfeedback,delayfb,dfb}=registerControl("delayfeedback","delayfb","dfb"),{delayspeed}=registerControl("delayspeed"),{delaytime,delayt,dt}=registerControl("delaytime","delayt","dt"),{delaysync}=registerControl("delaysync"),{lock}=registerControl("lock"),{detune,det}=registerControl("detune","det"),{unison}=registerControl("unison"),{spread}=registerControl("spread"),{dry}=registerControl("dry"),{fadeTime,fadeOutTime}=registerControl("fadeTime","fadeOutTime"),{fadeInTime}=registerControl("fadeInTime"),{freq:freq$1}=registerControl("freq"),{pattack,patt}=registerControl("pattack","patt"),{pdecay,pdec}=registerControl("pdecay","pdec"),{psustain,psus}=registerControl("psustain","psus"),{prelease,prel}=registerControl("prelease","prel"),{penv}=registerControl("penv"),{pcurve}=registerControl("pcurve"),{panchor}=registerControl("panchor"),{gate,gat}=registerControl("gate","gat"),{leslie}=registerControl("leslie"),{lrate}=registerControl("lrate"),{lsize}=registerControl("lsize"),{activeLabel}=registerControl("activeLabel"),{label}=registerControl(["label","activeLabel"]),{degree}=registerControl("degree"),{mtranspose}=registerControl("mtranspose"),{ctranspose}=registerControl("ctranspose"),{harmonic}=registerControl("harmonic"),{stepsPerOctave}=registerControl("stepsPerOctave"),{octaveR}=registerControl("octaveR"),{nudge}=registerControl("nudge"),{octave:octave$1,oct}=registerControl("octave","oct"),{orbit}=registerControl("orbit","o"),{overgain}=registerControl("overgain"),{overshape}=registerControl("overshape"),{pan}=registerControl("pan"),{panspan}=registerControl("panspan"),{pansplay}=registerControl("pansplay"),{panwidth}=registerControl("panwidth"),{panorient}=registerControl("panorient"),{rate}=registerControl("rate"),{slide}=registerControl("slide"),{semitone}=registerControl("semitone"),{voice}=registerControl("voice"),{chord:chord$1}=registerControl("chord"),{dictionary:dictionary$3,dict}=registerControl("dictionary","dict"),{anchor}=registerControl("anchor"),{offset}=registerControl("offset"),{octaves}=registerControl("octaves"),{mode:mode$1}=registerControl(["mode","anchor"]),{room}=registerControl(["room","size"]),{roomlp,rlp}=registerControl("roomlp","rlp"),{roomdim,rdim}=registerControl("roomdim","rdim"),{roomfade,rfade}=registerControl("roomfade","rfade"),{ir,iresponse}=registerControl(["ir","i"],"iresponse"),{irspeed}=registerControl("irspeed"),{irbegin}=registerControl("irbegin"),{roomsize,size,sz,rsize}=registerControl("roomsize","size","sz","rsize"),{shape}=registerControl(["shape","shapevol"]),{distort,dist:dist$2}=registerControl(["distort","distortvol","distorttype"],"dist"),{distortvol}=registerControl("distortvol","distvol"),{distorttype}=registerControl("distorttype","disttype"),{compressor}=registerControl(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee}=registerControl("compressorKnee"),{compressorRatio}=registerControl("compressorRatio"),{compressorAttack}=registerControl("compressorAttack"),{compressorRelease}=registerControl("compressorRelease"),{speed}=registerControl("speed"),{stretch}=registerControl("stretch"),{unit}=registerControl("unit"),{squiz}=registerControl("squiz"),{vowel}=registerControl("vowel"),{waveloss}=registerControl("waveloss"),{density}=registerControl("density"),{expression}=registerControl("expression"),{sustainpedal}=registerControl("sustainpedal"),{fshift}=registerControl("fshift"),{fshiftnote}=registerControl("fshiftnote"),{fshiftphase}=registerControl("fshiftphase"),{triode}=registerControl("triode"),{krush}=registerControl("krush"),{kcutoff}=registerControl("kcutoff"),{octer}=registerControl("octer"),{octersub}=registerControl("octersub"),{octersubsub}=registerControl("octersubsub"),{ring}=registerControl("ring"),{ringf}=registerControl("ringf"),{ringdf}=registerControl("ringdf"),{freeze}=registerControl("freeze"),{xsdelay}=registerControl("xsdelay"),{tsdelay}=registerControl("tsdelay"),{real}=registerControl("real"),{imag}=registerControl("imag"),{enhance}=registerControl("enhance"),{comb}=registerControl("comb"),{smear:smear$1}=registerControl("smear"),{scram}=registerControl("scram"),{binshift}=registerControl("binshift"),{hbrick}=registerControl("hbrick"),{lbrick}=registerControl("lbrick"),{frameRate}=registerControl("frameRate"),{frames}=registerControl("frames"),{hours}=registerControl("hours"),{minutes}=registerControl("minutes"),{seconds}=registerControl("seconds"),{songPtr}=registerControl("songPtr"),{uid}=registerControl("uid"),{val}=registerControl("val"),{cps}=registerControl("cps"),{clip,legato}=registerControl("clip","legato"),{duration,dur}=registerControl("duration","dur"),{zrand}=registerControl("zrand"),{curve}=registerControl("curve"),{deltaSlide}=registerControl("deltaSlide"),{pitchJump}=registerControl("pitchJump"),{pitchJumpTime}=registerControl("pitchJumpTime"),{lfo,repeatTime}=registerControl("lfo","repeatTime"),{znoise}=registerControl("znoise"),{zmod}=registerControl("zmod"),{zcrush}=registerControl("zcrush"),{zdelay}=registerControl("zdelay"),{zzfx}=registerControl("zzfx"),{color,colour}=registerControl(["color","colour"]);let createParams=(...o)=>o.reduce((e,a)=>Object.assign(e,{[a]:createParam(a)}),{});const adsr=register("adsr",(o,e)=>{o=Array.isArray(o)?o:[o];const[a,l,u,p]=o;return e.set({attack:a,decay:l,sustain:u,release:p})}),ad=register("ad",(o,e)=>{o=Array.isArray(o)?o:[o];const[a,l=a]=o;return e.attack(a).decay(l)}),ds=register("ds",(o,e)=>{o=Array.isArray(o)?o:[o];const[a,l=0]=o;return e.set({decay:a,sustain:l})}),ar=register("ar",(o,e)=>{o=Array.isArray(o)?o:[o];const[a,l=a]=o;return e.set({attack:a,release:l})}),{midichan}=registerControl("midichan"),{midimap}=registerControl("midimap"),{midiport}=registerControl("midiport"),{midicmd}=registerControl("midicmd"),control=register("control",(o,e)=>{if(!Array.isArray(o))throw new Error("control expects an array of [ccn, ccv]");const[a,l]=o;return e.ccn(a).ccv(l)}),{ccn}=registerControl("ccn"),{ccv}=registerControl("ccv"),{ctlNum}=registerControl("ctlNum"),{nrpnn}=registerControl("nrpnn"),{nrpv}=registerControl("nrpv"),{progNum}=registerControl("progNum"),sysex=register("sysex",(o,e)=>{if(!Array.isArray(o))throw new Error("sysex expects an array of [id, data]");const[a,l]=o;return e.sysexid(a).sysexdata(l)}),{sysexid}=registerControl("sysexid"),{sysexdata}=registerControl("sysexdata"),{midibend}=registerControl("midibend"),{miditouch}=registerControl("miditouch"),{polyTouch}=registerControl("polyTouch"),{oschost}=registerControl("oschost"),{oscport}=registerControl("oscport"),getControlName=o=>controlAlias.has(o)?controlAlias.get(o):o,as=register("as",(o,e)=>(o=Array.isArray(o)?o:[o],e.fmap(a=>(a=Array.isArray(a)?a:[a],a=Object.fromEntries(o.map((l,u)=>[getControlName(l),a[u]])),a)))),scrub=register("scrub",(o,e)=>o.outerBind(a=>{Array.isArray(a)||(a=[a]);const[l,u=1]=a;return e.begin(l).mul(speed(u)).clip(1)}),!1),controls=Object.freeze(Object.defineProperty({__proto__:null,accelerate,activeLabel,ad,adsr,amp,analyze,anchor,ar,as,att,attack,bandf,bandq,bank,bbexpr,bbst,begin,binshift,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,byteBeatExpression,byteBeatStartTime,ccn,ccv,ch,channel,channels,chord:chord$1,chorus,clip,coarse,color,colour,comb,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,control,cps,createParam,createParams,crush,ctf,ctlNum,ctranspose,curve,cut,cutoff,dec,decay,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,density,det,detune,dfb,dict,dictionary:dictionary$3,dist:dist$2,distort,distorttype,distortvol,djf,drive,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,end,enhance,expression,fadeInTime,fadeOutTime,fadeTime,fanchor,fft,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,frameRate,frames,freeze,freq:freq$1,fshift,fshiftnote,fshiftphase,ftype,gain,gat,gate,getControlName,harmonic,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,imag,ir,irbegin,iresponse,irspeed,isControlName,kcutoff,krush,label,lbrick,legato,leslie,lfo,lock,loop,loopBegin,loopEnd,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mode:mode$1,mtranspose,n,noise,note:note$2,nrpnn,nrpv,nudge,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,offset,orbit,oschost,oscport,overgain,overshape,pan,panchor,panorient,panspan,pansplay,panwidth,patt,pattack,pcurve,pdec,pdecay,penv,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phc,phd,phs,pitchJump,pitchJumpTime,polyTouch,postgain,prel,prelease,progNum,psus,psustain,pw,pwrate,pwsweep,rate,rdim,real,registerControl,rel,release,repeatTime,resonance,rfade,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rsize,s,scram,scrub,seconds,semitone,shape,size,slide,smear:smear$1,songPtr,sound,source,speed,spread,squiz,src,stepsPerOctave,stretch,sus,sustain,sustainpedal,sysex,sysexdata,sysexid,sz,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,triode,tsdelay,uid,unison,unit,v,val,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xsdelay,zcrush,zdelay,zmod,znoise,zrand,zzfx},Symbol.toStringTag,{value:"Module"})),left=function(o,e){const[a,l]=o,[u,p]=e,[d,f]=splitAt(l,u);return[[l,a-l],[zipWith((g,b)=>g.concat(b),d,p),f]]},right=function(o,e){const[a,l]=o,[u,p]=e,[d,f]=splitAt(a,p);return[[a,l-a],[zipWith((b,A)=>b.concat(A),u,d),f]]},_bjorklund=function(o,e){const[a,l]=o;return Math.min(a,l)<=1?[o,e]:_bjorklund(...a>l?left(o,e):right(o,e))},bjorklund=function(o,e){const a=o<0,l=Math.abs(o),u=e-l,p=Array(l).fill([1]),d=Array(u).fill([0]),f=_bjorklund([l,u],[p,d]),g=flatten(f[1][0]).concat(flatten(f[1][1]));return a?g.map(b=>1-b):g},_euclidRot=function(o,e,a){const l=bjorklund(o,e);return a?rotate$2(l,-a):l},euclid=register("euclid",function(o,e,a){return a.struct(_euclidRot(o,e,0))}),bjork=register("bjork",function(o,e){Array.isArray(o)||(o=[o]);const[a,l=a,u=0]=o;return e.struct(_euclidRot(a,l,u))}),{euclidrot,euclidRot}=register(["euclidrot","euclidRot"],function(o,e,a,l){return l.struct(_euclidRot(o,e,a))}),_euclidLegato=function(o,e,a,l){if(o<1)return silence;const p=_euclidRot(o,e,0).join("").split("1").slice(1).map(d=>[d.length+1,!0]);return l.struct(timeCat(...p)).late(fraction$1(a).div(e))},euclidLegato=register(["euclidLegato"],function(o,e,a){return _euclidLegato(o,e,0,a)}),euclidLegatoRot=register(["euclidLegatoRot"],function(o,e,a,l){return _euclidLegato(o,e,a,l)}),{euclidish,eish}=register(["euclidish","eish"],function(o,e,a,l){const u=_morph(bjorklund(o,e),new Array(o).fill(1),a);return l.struct(u).setSteps(e)});function createClock(o,e,a=.05,l=.1,u=.1,p=globalThis.setInterval,d=globalThis.clearInterval,f=!0){let g=0,b=0,A=10**4,S=.01;const M=z=>a=z(a);u=u||l/2;const E=()=>{const z=o(),U=z+l+u;for(b===0&&(b=z+S);b<U;)b=f?Math.round(b*A)/A:b,e(b,a,g,z),b+=a,g++};let F;const $=()=>{Z(),E(),F=p(E,l*1e3)},Z=()=>{F!==void 0&&d(F),F=void 0};return{setDuration:M,start:$,stop:()=>{g=0,b=0,Z()},pause:()=>Z(),duration:a,interval:l,getPhase:()=>b,minLatency:S}}function steady(o){return new Pattern$1(e=>[new Hap(void 0,e.span,o)])}const signal=o=>{const e=a=>[new Hap(void 0,a.span,o(a.span.begin))];return new Pattern$1(e)},saw=signal(o=>o%1),saw2=saw.toBipolar(),isaw=signal(o=>1-o%1),isaw2=isaw.toBipolar(),sine2=signal(o=>Math.sin(Math.PI*2*o)),sine=sine2.fromBipolar(),cosine=sine._early(fraction$1(1).div(4)),cosine2=sine2._early(fraction$1(1).div(4)),square=signal(o=>Math.floor(o*2%2)),square2=square.toBipolar(),tri=fastcat(saw,isaw),tri2=fastcat(saw2,isaw2),itri=fastcat(isaw,saw),itri2=fastcat(isaw2,saw2),time$1=signal(id);let _mouseY=0,_mouseX=0;typeof window<"u"&&document.addEventListener("mousemove",o=>{_mouseY=o.clientY/document.body.clientHeight,_mouseX=o.clientX/document.body.clientWidth});const mousey=signal(()=>_mouseY),mouseY=signal(()=>_mouseY),mousex=signal(()=>_mouseX),mouseX=signal(()=>_mouseX),xorwise=o=>{const e=o<<13^o,a=e>>17^e;return a<<5^a},_frac=o=>o-Math.trunc(o),timeToIntSeed=o=>xorwise(Math.trunc(_frac(o/300)*536870912)),intSeedToRand=o=>o%536870912/536870912,timeToRand=o=>Math.abs(intSeedToRand(timeToIntSeed(o))),timeToRandsPrime=(o,e)=>{const a=[];for(let l=0;l<e;++l)a.push(intSeedToRand(o)),o=xorwise(o);return a},timeToRands=(o,e)=>timeToRandsPrime(timeToIntSeed(o),e),run=o=>saw.range(0,o).round().segment(o),binary=o=>{const e=reify(o).log2(0).floor().add(1);return binaryN(o,e)},binaryN=(o,e=16)=>{e=reify(e);const a=run(e).mul(-1).add(e.sub(1));return reify(o).segment(e).brshift(a).band(pure(1))},binaryL=o=>{const e=reify(o).log2(0).floor().add(1);return binaryNL(o,e)},binaryNL=(o,e=16)=>reify(o).withValue(a=>l=>{const u=[];for(let p=l-1;p>=0;p--)u.push(a>>p&1);return u}).appLeft(reify(e)),randL=o=>signal(e=>a=>timeToRands(e,a).map(Math.abs)).appLeft(reify(o)),randrun=o=>signal(e=>{const l=timeToRands(e.floor().add(.5),o).map((p,d)=>[p,d]).sort((p,d)=>(p[0]>d[0])-(p[0]<d[0])).map(p=>p[1]),u=e.cyclePos().mul(o).floor()%o;return l[u]})._segment(o),_rearrangeWith=(o,e,a)=>{const l=[...Array(e).keys()].map(u=>a.zoom(fraction$1(u).div(e),fraction$1(u+1).div(e)));return o.fmap(u=>l[u].repeatCycles(e)._fast(e)).innerJoin()},shuffle$2=register("shuffle",(o,e)=>_rearrangeWith(randrun(o),o,e)),scramble=register("scramble",(o,e)=>_rearrangeWith(_irand(o)._segment(o),o,e)),rand=signal(timeToRand),rand2=rand.toBipolar(),_brandBy=o=>rand.fmap(e=>e<o),brandBy=o=>reify(o).fmap(_brandBy).innerJoin(),brand=_brandBy(.5),_irand=o=>rand.fmap(e=>Math.trunc(e*o)),irand=o=>reify(o).fmap(_irand).innerJoin(),__chooseWith=(o,e)=>(e=e.map(reify),e.length==0?silence:o.range(0,e.length).fmap(a=>{const l=Math.min(Math.max(Math.floor(a),0),e.length-1);return e[l]})),chooseWith=(o,e)=>__chooseWith(o,e).outerJoin(),chooseInWith=(o,e)=>__chooseWith(o,e).innerJoin(),choose=(...o)=>chooseWith(rand,o),chooseIn=(...o)=>chooseInWith(rand,o),chooseOut=choose;Pattern$1.prototype.choose=function(...o){return chooseWith(this,o)},Pattern$1.prototype.choose2=function(...o){return chooseWith(this.fromBipolar(),o)};const chooseCycles=(...o)=>chooseInWith(rand.segment(1),o),randcat=chooseCycles,_wchooseWith=function(o,...e){const a=e.map(f=>reify(f[0])),l=[];let u=pure(0);for(const f of e)u=u.add(f[1]),l.push(u);const p=sequenceP(l),d=function(f){const g=u.mul(f);return p.fmap(b=>A=>a[b.findIndex(S=>S>A,b)]).appLeft(g)};return o.bind(d)},wchooseWith=(...o)=>_wchooseWith(...o).outerJoin(),wchoose=(...o)=>wchooseWith(rand,...o),wchooseCycles=(...o)=>_wchooseWith(rand.segment(1),...o).innerJoin(),wrandcat=wchooseCycles;function _perlin(o){let e=Math.floor(o),a=e+1;const l=d=>6*d**5-15*d**4+10*d**3;return(d=>f=>g=>f+l(d)*(g-f))(o-e)(timeToRand(e))(timeToRand(a))}const perlinWith=o=>o.fmap(_perlin);function _berlin(o){const e=Math.floor(o),a=e+1,l=timeToRand(e),u=timeToRand(a)+l,p=(o-e)/(a-e);return((f,g,b)=>f+(g-f)*b)(l,u,p)/2}const berlinWith=o=>o.fmap(_berlin),perlin=perlinWith(time$1.fmap(o=>Number(o))),berlin=berlinWith(time$1.fmap(o=>Number(o))),degradeByWith=register("degradeByWith",(o,e,a)=>a.fmap(l=>u=>l).appLeft(o.filterValues(l=>l>e)),!0,!0),degradeBy=register("degradeBy",function(o,e){return e._degradeByWith(rand,o)},!0,!0),degrade=register("degrade",o=>o._degradeBy(.5),!0,!0),undegradeBy=register("undegradeBy",function(o,e){return e._degradeByWith(rand.fmap(a=>1-a),o)},!0,!0),undegrade=register("undegrade",o=>o._undegradeBy(.5),!0,!0),sometimesBy=register("sometimesBy",function(o,e,a){return reify(o).fmap(l=>stack(a._degradeBy(l),e(a._undegradeBy(1-l)))).innerJoin()}),sometimes=register("sometimes",function(o,e){return e._sometimesBy(.5,o)}),someCyclesBy=register("someCyclesBy",function(o,e,a){return reify(o).fmap(l=>stack(a._degradeByWith(rand._segment(1),l),e(a._degradeByWith(rand.fmap(u=>1-u)._segment(1),1-l)))).innerJoin()}),someCycles=register("someCycles",function(o,e){return e._someCyclesBy(.5,o)}),often=register("often",function(o,e){return e.sometimesBy(.75,o)}),rarely=register("rarely",function(o,e){return e.sometimesBy(.25,o)}),almostNever=register("almostNever",function(o,e){return e.sometimesBy(.1,o)}),almostAlways=register("almostAlways",function(o,e){return e.sometimesBy(.9,o)}),never=register("never",function(o,e){return e}),always=register("always",function(o,e){return o(e)});function _keyDown(o){Array.isArray(o)===!1&&(o=[o]);const e=getCurrentKeyboardState();return o.every(a=>{const l=keyAlias.get(a)??a;return e[l]})}const whenKey=register("whenKey",function(o,e,a){return a.when(_keyDown(o),e)}),keyDown=register("keyDown",function(o){return o.fmap(_keyDown)}),_pick=function(o,e,a=!0){const l=Array.isArray(o),u=Object.keys(o).length;return o=objectMap(o,reify),u===0?silence:e.fmap(p=>{let d=p;return l&&(d=a?Math.round(d)%u:clamp$1(Math.round(d),0,o.length-1)),o[d]})},pick=function(o,e){return Array.isArray(e)&&([e,o]=[o,e]),__pick(o,e)},__pick=register("pick",function(o,e){return _pick(o,e,!1).innerJoin()}),pickmod=register("pickmod",function(o,e){return _pick(o,e,!0).innerJoin()}),pickF=register("pickF",function(o,e,a){return a.apply(pick(o,e))}),pickmodF=register("pickmodF",function(o,e,a){return a.apply(pickmod(o,e))}),pickOut=register("pickOut",function(o,e){return _pick(o,e,!1).outerJoin()}),pickmodOut=register("pickmodOut",function(o,e){return _pick(o,e,!0).outerJoin()}),pickRestart=register("pickRestart",function(o,e){return _pick(o,e,!1).restartJoin()}),pickmodRestart=register("pickmodRestart",function(o,e){return _pick(o,e,!0).restartJoin()}),pickReset=register("pickReset",function(o,e){return _pick(o,e,!1).resetJoin()}),pickmodReset=register("pickmodReset",function(o,e){return _pick(o,e,!0).resetJoin()}),{inhabit,pickSqueeze}=register(["inhabit","pickSqueeze"],function(o,e){return _pick(o,e,!1).squeezeJoin()}),{inhabitmod,pickmodSqueeze}=register(["inhabitmod","pickmodSqueeze"],function(o,e){return _pick(o,e,!0).squeezeJoin()}),squeeze=(o,e)=>(e=e.map(reify),e.length==0?silence:o.fmap(a=>{const l=_mod$2(Math.round(a),e.length);return e[l]}).squeezeJoin());let synth;try{synth=window?.speechSynthesis}catch(o){console.warn("cannot use window: not in browser?")}let allVoices=synth?.getVoices();function triggerSpeech(o,e,a){synth.cancel();const l=new SpeechSynthesisUtterance(o);l.lang=e,allVoices=synth.getVoices();const u=allVoices.filter(p=>p.lang.includes(e));typeof a=="number"?l.voice=u[a%u.length]:typeof a=="string"&&(l.voice=u.find(p=>p.name===p)),speechSynthesis.speak(l)}const speak=register("speak",function(o,e,a){return a.onTrigger(l=>{triggerSpeech(l.value,o,e)})}),strudelScope={},evalScope=async(...o)=>{const e=await Promise.allSettled(o),a=e.filter(l=>l.status==="fulfilled").map(l=>l.value);return e.forEach((l,u)=>{l.status==="rejected"&&console.warn(`evalScope: module with index ${u} could not be loaded:`,l.reason)}),a.forEach(l=>{Object.entries(l).forEach(([u,p])=>{globalThis[u]=p,strudelScope[u]=p})}),a};function safeEval(o,e={}){const{wrapExpression:a=!0,wrapAsync:l=!0}=e;a&&(o=`{${o}}`),l&&(o=`(async ()=>${o})()`);const u=`"use strict";return (${o})`;return Function(u)()}const evaluate$2=async(o,e,a)=>{let l={};if(e){const d=e(o,a);o=d.output,l=d}return{mode:"javascript",pattern:await safeEval(o,{wrapExpression:!!e}),meta:l}};class NeoCyclist{constructor({onTrigger:e,onToggle:a,getTime:l}){this.started=!1,this.cps=.5,this.getTime=l,this.time_at_last_tick_message=0,this.collator=new ClockCollator({getTargetClockTime:l}),this.onToggle=a,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(new URL("/clockworker-ZDiUtESR.js",_documentCurrentScript&&_documentCurrentScript.tagName.toUpperCase()==="SCRIPT"&&_documentCurrentScript.src||new URL("strudel.bundle.js",document.baseURI).href)),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const u=d=>{const{cps:f,begin:g,end:b,cycle:A,time:S}=d;this.cps=f,this.cycle=A;const M=this.collator.calculateOffset(S)+S;p(g,b,M),this.time_at_last_tick_message=M},p=(d,f,g)=>{if(this.started===!1)return;this.pattern.queryArc(d,f,{_cps:this.cps,cyclist:"neocyclist"}).forEach(A=>{if(A.hasOnset()){const M=cycleToSeconds$1(A.whole.begin-this.cycle,this.cps)+g+this.latency,E=cycleToSeconds$1(A.duration,this.cps);e?.(A,0,E,this.cps,M)}})};this.channel.onmessage=d=>{if(!this.started)return;const{payload:f,type:g}=d.data;switch(g){case"tick":u(f)}}}sendMessage(e,a){this.worker.port.postMessage({type:e,payload:a,id:this.id})}now(){const e=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+e}setCps(e=1){this.sendMessage("cpschange",{cps:e})}setCycle(e){this.sendMessage("setcycle",{cycle:e})}setStarted(e){this.sendMessage("toggle",{started:e}),this.started=e,this.onToggle?.(e)}start(){logger$2("[cyclist] start"),this.setStarted(!0)}stop(){logger$2("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(e,a=!1){this.pattern=e,a&&!this.started&&this.start()}log(e,a,l){const u=l.filter(p=>p.hasOnset());console.log(`${e.toFixed(4)} - ${a.toFixed(4)} ${Array(u.length).fill("I").join("")}`)}}class Cyclist{constructor({interval:e,onTrigger:a,onToggle:l,onError:u,getTime:p,latency:d=.1,setInterval:f,clearInterval:g,beforeStart:b}){this.started=!1,this.beforeStart=b,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=p,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=l,this.latency=d,this.clock=createClock(p,(A,S,M,E)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=A),this.num_ticks_since_cps_change++;const $=this.num_ticks_since_cps_change*S*this.cps;try{const Z=this.lastEnd;this.lastBegin=Z;const V=this.num_cycles_at_cps_change+$;if(this.lastEnd=V,this.lastTick=A,A<E){console.log("skip query: too late");return}this.pattern.queryArc(Z,V,{_cps:this.cps,cyclist:"cyclist"}).forEach(se=>{if(se.hasOnset()){const z=(se.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+d,U=se.duration/this.cps,ee=z-A;a?.(se,ee,U,this.cps,z),se.value.cps!==void 0&&this.cps!=se.value.cps&&(this.cps=se.value.cps,this.num_ticks_since_cps_change=0)}})}catch(Z){errorLogger$1(Z),u?.(Z)}},e,.1,.1,f,g)}now(){if(!this.started)return 0;const e=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+e*this.cps}setStarted(e){this.started=e,this.onToggle?.(e)}async start(){if(await this.beforeStart?.(),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");logger$2("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){logger$2("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){logger$2("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(e,a=!1){this.pattern=e,a&&!this.started&&await this.start()}setCps(e=.5){this.cps!==e&&(this.cps=e,this.num_ticks_since_cps_change=0)}log(e,a,l){const u=l.filter(p=>p.hasOnset());console.log(`${e.toFixed(4)} - ${a.toFixed(4)} ${Array(u.length).fill("I").join("")}`)}}let time;function getTime(){if(!time)throw new Error("no time set! use setTime to define a time source");return time()}function setTime(o){time=o}function repl$2({defaultOutput:o,onEvalError:e,beforeEval:a,beforeStart:l,afterEval:u,getTime:p,transpiler:d,onToggle:f,editPattern:g,onUpdateState:b,sync:A=!1,setInterval:S,clearInterval:M,id:E,mondo:F=!1}){const $={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},Z={id:E},V=$e=>{Object.assign($,$e),$.isDirty=$.code!==$.activeCode,$.error=$.evalError||$.schedulerError,b?.($)},K={onTrigger:getTrigger({defaultOutput:o,getTime:p}),getTime:p,onToggle:$e=>{V({started:$e}),f?.($e)},setInterval:S,clearInterval:M,beforeStart:l},se=A&&typeof SharedWorker<"u"?new NeoCyclist(K):new Cyclist(K);let z={},U=0,ee;const ae=function(){return z={},U=0,ee=void 0,silence};function de($e){return $e._Pattern?$e.__pure:$e}const ke=async($e,bt=!0)=>($e=g?.($e)||$e,await se.setPattern($e,bt),$e);setTime(()=>se.now());const Oe=()=>se.stop(),De=()=>se.start(),Ae=()=>se.pause(),Pe=()=>se.toggle(),We=$e=>(se.setCps(de($e)),silence),qe=$e=>(se.setCps(de($e)/60),silence);let at=[];const yt=function($e){return at.push($e),silence},ut=function($e){return ee=$e,silence},Dt=()=>{Pattern$1.prototype.p=function(bt){return typeof bt=="string"&&(bt.startsWith("_")||bt.endsWith("_"))?silence:(bt.includes("$")&&(bt=`${bt}${U}`,U++),z[bt]=this,this)},Pattern$1.prototype.q=function(bt){return silence};try{for(let bt=1;bt<10;++bt)Object.defineProperty(Pattern$1.prototype,`d${bt}`,{get(){return this.p(bt)},configurable:!0}),Object.defineProperty(Pattern$1.prototype,`p${bt}`,{get(){return this.p(bt)},configurable:!0}),Pattern$1.prototype[`q${bt}`]=silence}catch(bt){console.warn("injectPatternMethods: error:",bt)}const $e=register("cpm",function(bt,nn){return nn._fast(bt/60/se.cps)});return evalScope({all:yt,each:ut,hush:ae,cpm:$e,setCps:We,setcps:We,setCpm:qe,setcpm:qe})};return{scheduler:se,evaluate:async($e,bt=!0,nn=!0)=>{if(!$e)throw new Error("no code to evaluate");try{V({code:$e,pending:!0}),await Dt(),setTime(()=>se.now()),await a?.({code:$e}),at=[],nn&&ae(),F&&($e=`mondolang\`${$e}\``);let{pattern:Zt,meta:Rt}=await evaluate$2($e,d,Z);if(Object.keys(z).length){let qt=[],Wt=!1;for(const[tn,wn]of Object.entries(z)){const dn=tn.length>1&&tn.startsWith("S");if(dn&&Wt===!1&&(qt=[],Wt=!0),!Wt||Wt&&dn){const rn=wn.withState(Zn=>Zn.setControls({id:tn}));qt.push(rn)}}ee&&(qt=qt.map(tn=>ee(tn))),Zt=stack(...qt)}else ee&&(Zt=ee(Zt));if(at.length)for(const qt of at)Zt=qt(Zt);return isPattern(Zt)||(Zt=silence),logger$2("[eval] code updated"),Zt=await ke(Zt,bt),V({miniLocations:Rt?.miniLocations||[],widgets:Rt?.widgets||[],activeCode:$e,pattern:Zt,evalError:void 0,schedulerError:void 0,pending:!1}),u?.({code:$e,pattern:Zt,meta:Rt}),Zt}catch(Zt){logger$2(`[eval] error: ${Zt.message}`,"error"),console.error(Zt),V({evalError:Zt,pending:!1}),e?.(Zt)}},start:De,stop:Oe,pause:Ae,setCps:We,setPattern:ke,setCode:$e=>V({code:$e}),toggle:Pe,state:$}}const getTrigger=({getTime:o,defaultOutput:e})=>async(a,l,u,p,d)=>{try{(!a.context.onTrigger||!a.context.dominantTrigger)&&await e(a,l,u,p,d),a.context.onTrigger&&await a.context.onTrigger(a,o(),p,d)}catch(f){errorLogger$1(f,"getTrigger")}},backgroundImage=function(o,e={}){const a=document.getElementById("code"),l="background-image:url("+o+");background-size:contain;";a.style=l;const{className:u}=a,p=(g,b)=>{({style:()=>a.style=l+";"+b,className:()=>a.className=b+" "+u})[g]()},d=Object.entries(e).filter(([g,b])=>typeof b=="function");Object.entries(e).filter(([g,b])=>typeof b=="string").forEach(([g,b])=>p(g,b)),d.length},cleanupUi=()=>{const o=document.getElementById("code");o&&(o.style="")};logger$2("🌀 @strudel/core loaded 🌀"),globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`),globalThis._strudelLoaded=!0;const strudelCore=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator,Cyclist,Fraction:fraction$1,Hap,Pattern:Pattern$1,State,TimeSpan,__chooseWith,_brandBy,_fitslice,_irand,_keyDown,_match,_mod:_mod$2,_morph,_polymeterListSteps,_retime,_slices,accelerate,activeLabel,ad,add:add$5,adsr,almostAlways,almostNever,always,amp,analyze,anchor,and,apply,applyN,ar,arp,arpWith,arrange,as,att,attack,averageArray,backgroundImage,band,bandf,bandq,bank,base64ToUnicode,bbexpr,bbst,beat,begin,berlin,berlinWith,binary,binaryL,binaryN,binaryNL,bind,binshift,bite,bjork,bjorklund,blshift,bor,bp,bpa,bpattack,bpd,bpdc,bpdecay,bpdepth,bpdepthfrequency,bpe,bpenv,bpf,bpq,bpr,bprate,bprelease,bps,bpshape,bpskew,bpsustain,bpsync,brak,brand,brandBy,brshift,bxor,bypass,byteBeatExpression,byteBeatStartTime,calculateSteps,cat,ccn,ccv,ceil,ch,channel,channels,choose,chooseCycles,chooseIn,chooseInWith,chooseOut,chooseWith,chop,chord:chord$1,chorus,chunk,chunkBack,chunkBackInto,chunkInto,chunkback,chunkbackinto,chunkinto,clamp:clamp$1,cleanupUi,clip,coarse,code2hash,color,colour,comb,compose,compress,compressSpan,compressor,compressorAttack,compressorKnee,compressorRatio,compressorRelease,compressspan,constant,contract,control,controls,cosine,cosine2,cpm,cps,createClock,createParam,createParams,crush,ctf,ctlNum,ctranspose,curry,curve,cut,cutoff,cycleToSeconds:cycleToSeconds$1,dec,decay,degrade,degradeBy,degradeByWith,degree,delay,delayfb,delayfeedback,delayspeed,delaysync,delayt,delaytime,deltaSlide,det,detune,dfb,dict,dictionary:dictionary$3,dist:dist$2,distort,distorttype,distortvol,div,djf,drawLine,drive,drop,dry,ds,dt,duck,duckattack,duckdepth,duckonset,dur,duration,early,echo,echoWith,echowith,eish,end,enhance,eq,eqt,errorLogger:errorLogger$1,euclid,euclidLegato,euclidLegatoRot,euclidRot,euclidish,euclidrot,evalScope,evaluate:evaluate$2,every,expand,expression,extend,fadeInTime,fadeOutTime,fadeTime,fanchor,fast,fastChunk,fastGap,fastcat,fastchunk,fastgap,fft,filter:filter$1,filterWhen,firstOf,fit,flatten,floor,fm:fm$1,fmattack,fmdecay,fmenv,fmh,fmi,fmrelease,fmsustain,fmvelocity,fmwave,focus,focusSpan,focusspan,fractionalArgs,frameRate,frames,freeze,freq:freq$1,freqToMidi:freqToMidi$2,fromBipolar,fshift,fshiftnote,fshiftphase,ftype,func,gain,gap,gat,gate,getAccidentalsOffset:getAccidentalsOffset$1,getControlName,getCurrentKeyboardState,getEventOffsetMs,getFreq,getFrequency,getPerformanceTimeSeconds,getPlayableNoteValue,getSoundIndex:getSoundIndex$1,getTime,getTrigger,grow,gt,gte,harmonic,hash2code,hbrick,hcutoff,hold,hours,hp,hpa,hpattack,hpd,hpdc,hpdecay,hpdepth,hpdepthfreq,hpdepthfrequency,hpe,hpenv,hpf,hpq,hpr,hprate,hprelease,hps,hpshape,hpskew,hpsustain,hpsync,hresonance,hsl,hsla,hurry,id,imag,inhabit,inhabitmod,innerBind,inside,inv,invert:invert$1,ir,irand,irbegin,iresponse,irspeed,isControlName,isNote,isNoteWithOctave,isPattern,isaw,isaw2,iter,iterBack,iterback,itri,itri2,jux,juxBy,juxby,kcutoff,keep,keepif,keyAlias,keyDown,krush,label,lastOf,late,lbrick,legato,leslie,lfo,linger,listRange,lock,logKey,logger:logger$2,loop,loopAt,loopAtCps,loopBegin,loopEnd,loopat,loopatcps,loopb,loope,lp,lpa,lpattack,lpd,lpdc,lpdecay,lpdepth,lpdepthfrequency,lpe,lpenv,lpf,lpq,lpr,lprate,lprelease,lps,lpshape,lpskew,lpsustain,lpsync,lrate,lsize,lt,lte,mapArgs,mask,midi2note:midi2note$1,midiToFreq:midiToFreq$2,midibend,midichan,midicmd,midimap,midiport,miditouch,minutes,mod:mod$3,mode:mode$1,morph,mouseX,mouseY,mousex,mousey,mtranspose,mul,n,nanFallback:nanFallback$1,ne,net,never,noise,note:note$2,noteToMidi:noteToMidi$1,nothing,nrpnn,nrpv,nudge,numeralArgs,objectMap,oct,octave:octave$1,octaveR,octaves,octer,octersub,octersubsub,off,offset,often,or,orbit,oschost,oscport,outerBind,outside,overgain,overshape,pace,pairs,palindrome,pan,panchor,panorient,panspan,pansplay,panwidth,parray,parseFractional,parseNumeral,partials,patt,pattack,pcurve,pdec,pdecay,penv,perlin,perlinWith,ph,phasdp,phaser,phasercenter,phaserdepth,phaserrate,phasersweep,phases,phc,phd,phs,pick,pickF,pickOut,pickReset,pickRestart,pickSqueeze,pickmod,pickmodF,pickmodOut,pickmodReset,pickmodRestart,pickmodSqueeze,pipe,pitchJump,pitchJumpTime,ply,plyForEach,plyWith,pm,polyBind,polyTouch,polymeter,polyrhythm,postgain,pow,pr,prel,prelease,press,pressBy,progNum,psus,psustain,pure,pw,pwrate,pwsweep,rand,rand2,randL,randcat,randrun,range:range$2,range2,rangex,rarely,rate,ratio,rdim,real,ref:ref$1,register,registerControl,reify,rel,release,removeUndefineds,repeatCycles,repeatTime,repl:repl$2,replicate,resonance,rev,revv,rfade,rib,ribbon,ring,ringdf,ringf,rlp,room,roomdim,roomfade,roomlp,roomsize,rotate:rotate$2,round,rsize,run,s,s_add,s_alt,s_cat,s_contract,s_expand,s_extend,s_polymeter,s_sub,s_taper,s_taperlist,s_tour,s_zip,saw,saw2,scram,scramble,scrub,seconds,seg,segment,semitone,seq,seqPLoop,sequence,sequenceP,set,setStringParser,setTime,shape,shrink,shrinklist,shuffle:shuffle$2,signal,silence,sine,sine2,size,slice,slide,slow,slowChunk,slowcat,slowcatPrime,slowchunk,smear:smear$1,sol2note,someCycles,someCyclesBy,sometimes,sometimesBy,songPtr,sound,source,sparsity,speak,speed,splice,splitAt,spread,square,square2,squeeze,squeezeBind,squiz,src,stack,stackBy,stackCentre,stackLeft,stackRight,steady,stepBind,stepalt,stepcat,steps:steps$2,stepsPerOctave,stretch,striate,stringifyValues,struct,strudelScope,stut,stutWith,stutwith,sub,superimpose,sus,sustain,sustainpedal,swing,swingBy,sysex,sysexdata,sysexid,sz,take,time:time$1,timeCat,timecat,toBipolar,tokenizeNote:tokenizeNote$3,tour,tremolo,tremolodepth,tremolophase,tremoloshape,tremoloskew,tremolosync,tri,tri2,triode,tsdelay,uid,undegrade,undegradeBy,unicodeToBase64,uniq,uniqsort,uniqsortr,unison,unit,v,val,valueToMidi:valueToMidi$1,velocity,vib,vibmod,vibrato,vmod,voice,vowel,warp,warpatt,warpattack,warpdc,warpdec,warpdecay,warpdepth,warpenv,warpmode,warprate,warprel,warprelease,warpshape,warpskew,warpsus,warpsustain,warpsync,waveloss,wavetablePhaseRand,wavetablePosition,wavetableWarp,wavetableWarpMode,wchoose,wchooseCycles,when,whenKey,withValue,within,wrandcat,wt,wtatt,wtattack,wtdc,wtdec,wtdecay,wtdepth,wtenv,wtphaserand,wtrate,wtrel,wtrelease,wtshape,wtskew,wtsus,wtsustain,wtsync,xfade,xsdelay,zcrush,zdelay,zip,zipWith,zmod,znoise,zoom,zoomArc,zoomarc,zrand,zzfx},Symbol.toStringTag,{value:"Module"}));function peg$subclass(o,e){function a(){this.constructor=o}a.prototype=e.prototype,o.prototype=new a}function peg$SyntaxError(o,e,a,l){var u=Error.call(this,o);return Object.setPrototypeOf&&Object.setPrototypeOf(u,peg$SyntaxError.prototype),u.expected=e,u.found=a,u.location=l,u.name="SyntaxError",u}peg$subclass(peg$SyntaxError,Error);function peg$padEnd(o,e,a){return a=a||" ",o.length>e?o:(e-=o.length,a+=a.repeat(e),o+a.slice(0,e))}peg$SyntaxError.prototype.format=function(o){var e="Error: "+this.message;if(this.location){var a=null,l;for(l=0;l<o.length;l++)if(o[l].source===this.location.source){a=o[l].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,p=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(u):u,d=this.location.source+":"+p.line+":"+p.column;if(a){var f=this.location.end,g=peg$padEnd("",p.line.toString().length," "),b=a[u.line-1],A=u.line===f.line?f.column:b.length+1,S=A-u.column||1;e+=`
 --> `+d+`
`+g+` |
`+p.line+" | "+b+`
`+g+" | "+peg$padEnd("",u.column-1," ")+peg$padEnd("",S,"^")}else e+=`
 at `+d}return e},peg$SyntaxError.buildMessage=function(o,e){var a={literal:function(b){return'"'+u(b.text)+'"'},class:function(b){var A=b.parts.map(function(S){return Array.isArray(S)?p(S[0])+"-"+p(S[1]):p(S)});return"["+(b.inverted?"^":"")+A.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(b){return b.description}};function l(b){return b.charCodeAt(0).toString(16).toUpperCase()}function u(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+l(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+l(A)})}function p(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+l(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+l(A)})}function d(b){return a[b.type](b)}function f(b){var A=b.map(d),S,M;if(A.sort(),A.length>0){for(S=1,M=1;S<A.length;S++)A[S-1]!==A[S]&&(A[M]=A[S],M++);A.length=M}switch(A.length){case 1:return A[0];case 2:return A[0]+" or "+A[1];default:return A.slice(0,-1).join(", ")+", or "+A[A.length-1]}}function g(b){return b?'"'+u(b)+'"':"end of input"}return"Expected "+f(o)+" but "+g(e)+" found."};function peg$parse(o,e){e=e!==void 0?e:{};var a={},l=e.grammarSource,u={start:Fi},p=Fi,d=".",f="-",g="0",b=",",A="|",S="[",M="]",E="{",F="}",$="%",Z="<",V=">",K="!",se="(",z=")",U="/",ee="*",ae="?",de=":",ke="..",Oe="^",De="struct",Ae="target",Pe="euclid",We="slow",qe="rotL",at="rotR",yt="fast",ut="scale",Dt="//",$t="cat",Bt="$",$e="setcps",bt="setbpm",nn="hush",Zt=/^[1-9]/,Rt=/^[eE]/,qt=/^[+\-]/,Wt=/^[0-9]/,tn=/^[ \n\r\t\xA0]/,wn=/^["']/,dn=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,rn=/^[@_]/,Zn=/^[^\n]/,ln=Si("number"),zn=Ht(".",!1),cn=oi([["1","9"]],!1,!1),Bn=oi(["e","E"],!1,!1),ei=oi(["+","-"],!1,!1),ve=Ht("-",!1),Ce=Ht("0",!1),_e=oi([["0","9"]],!1,!1),Ie=Si("whitespace"),ot=oi([" ",`
`,"\r","	"," "],!1,!1),ft=Ht(",",!1),tt=Ht("|",!1),Mt=oi(['"',"'"],!1,!1),st=Si('a letter, a number, "-", "#", ".", "^", "_"'),Ot=oi(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),kt=Ht("[",!1),on=Ht("]",!1),an=Ht("{",!1),Ut=Ht("}",!1),Nt=Ht("%",!1),hn=Ht("<",!1),Ft=Ht(">",!1),fn=oi(["@","_"],!1,!1),mn=Ht("!",!1),xt=Ht("(",!1),Vt=Ht(")",!1),en=Ht("/",!1),sn=Ht("*",!1),yn=Ht("?",!1),Xn=Ht(":",!1),ti=Ht("..",!1),R=Ht("^",!1),te=Ht("struct",!1),q=Ht("target",!1),re=Ht("euclid",!1),le=Ht("slow",!1),Ee=Ht("rotL",!1),He=Ht("rotR",!1),Je=Ht("fast",!1),_t=Ht("scale",!1),Yt=Ht("//",!1),pn=oi([`
`],!0,!1),si=Ht("cat",!1),li=Ht("$",!1),bi=Ht("setcps",!1),Oi=Ht("setbpm",!1),ni=Ht("hush",!1),Vi=function(){return parseFloat(Er())},Qi=function(L){const oe=L.join("");return oe==="."||oe==="_"},Wi=function(L){return new vs(L.join(""))},Ii=function(L){return L},zi=function(L,oe){return L.arguments_.stepsPerCycle=oe,L},Yi=function(L){return L},Ui=function(L){return L.arguments_.alignment="polymeter_slowcat",L},ji=function(L){return oe=>oe.options_.weight=(oe.options_.weight??1)+(L??2)-1},Hi=function(L){return oe=>{const ye=(oe.options_.reps??1)+(L??2)-1;oe.options_.reps=ye,oe.options_.ops=oe.options_.ops.filter(je=>je.type_!=="replicate"),oe.options_.ops.push({type_:"replicate",arguments_:{amount:ye}}),oe.options_.weight=ye}},Ki=function(L,oe,ye){return je=>je.options_.ops.push({type_:"bjorklund",arguments_:{pulse:L,step:oe,rotation:ye}})},qi=function(L){return oe=>oe.options_.ops.push({type_:"stretch",arguments_:{amount:L,type:"slow"}})},Ji=function(L){return oe=>oe.options_.ops.push({type_:"stretch",arguments_:{amount:L,type:"fast"}})},er=function(L){return oe=>oe.options_.ops.push({type_:"degradeBy",arguments_:{amount:L,seed:ki++}})},nr=function(L){return oe=>oe.options_.ops.push({type_:"tail",arguments_:{element:L}})},rr=function(L){return oe=>oe.options_.ops.push({type_:"range",arguments_:{element:L}})},sr=function(L,oe){const ye=new Ss(L,{ops:[],weight:1,reps:1});for(const je of oe)je(ye);return ye},lr=function(L,oe){return new Ci(oe,"fastcat",void 0,!!L)},ur=function(L){return{alignment:"stack",list:L}},cr=function(L){return{alignment:"rand",list:L,seed:ki++}},hr=function(L){return{alignment:"feet",list:L,seed:ki++}},dr=function(L,oe){return oe&&oe.list.length>0?new Ci([L,...oe.list],oe.alignment,oe.seed):L},fr=function(L,oe){return new Ci(oe?[L,...oe.list]:[L],"polymeter")},mr=function(L){return L},gr=function(L){return{name:"struct",args:{mini:L}}},yr=function(L){return{name:"target",args:{name:L}}},_r=function(L,oe,ye){return{name:"bjorklund",args:{pulse:L,step:parseInt(oe)}}},br=function(L){return{name:"stretch",args:{amount:L}}},Or=function(L){return{name:"shift",args:{amount:"-"+L}}},Ar=function(L){return{name:"shift",args:{amount:L}}},xr=function(L){return{name:"stretch",args:{amount:"1/"+L}}},vr=function(L){return{name:"scale",args:{scale:L.join("")}}},Ti=function(L,oe){return oe},Cr=function(L,oe){return oe.unshift(L),new Ci(oe,"slowcat")},Sr=function(L){return L},wr=function(L,oe){return new Cs(L.name,L.args,oe)},Mr=function(L){return L},Pr=function(L){return L},kr=function(L){return new Pi("setcps",{value:L})},Tr=function(L){return new Pi("setcps",{value:L/120/2})},Dr=function(){return new Pi("hush")},ue=e.peg$currPos|0,Xt=ue,ci=[{line:1,column:1}],ii=ue,Ai=e.peg$maxFailExpected||[],At=e.peg$silentFails|0,yi;if(e.startRule){if(!(e.startRule in u))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');p=u[e.startRule]}function Er(){return o.substring(Xt,ue)}function Di(){return wi(Xt,ue)}function Ht(L,oe){return{type:"literal",text:L,ignoreCase:oe}}function oi(L,oe,ye){return{type:"class",parts:L,inverted:oe,ignoreCase:ye}}function Fr(){return{type:"end"}}function Si(L){return{type:"other",description:L}}function Ei(L){var oe=ci[L],ye;if(oe)return oe;if(L>=ci.length)ye=ci.length-1;else for(ye=L;!ci[--ye];);for(oe=ci[ye],oe={line:oe.line,column:oe.column};ye<L;)o.charCodeAt(ye)===10?(oe.line++,oe.column=1):oe.column++,ye++;return ci[L]=oe,oe}function wi(L,oe,ye){var je=Ei(L),St=Ei(oe),un={source:l,start:{offset:L,line:je.line,column:je.column},end:{offset:oe,line:St.line,column:St.column}};return un}function Et(L){ue<ii||(ue>ii&&(ii=ue,Ai=[]),Ai.push(L))}function $r(L,oe,ye){return new peg$SyntaxError(peg$SyntaxError.buildMessage(L,oe),L,oe,ye)}function Fi(){var L;return L=xs(),L}function ai(){var L,oe;return At++,L=ue,Br(),oe=xi(),oe!==a?(Xr(),Lr(),Xt=L,L=Vi()):(ue=L,L=a),At--,L===a&&At===0&&Et(ln),L}function Gr(){var L;return o.charCodeAt(ue)===46?(L=d,ue++):(L=a,At===0&&Et(zn)),L}function Zr(){var L;return L=o.charAt(ue),Zt.test(L)?ue++:(L=a,At===0&&Et(cn)),L}function Rr(){var L;return L=o.charAt(ue),Rt.test(L)?ue++:(L=a,At===0&&Et(Bn)),L}function Lr(){var L,oe,ye,je,St;if(L=ue,oe=Rr(),oe!==a){if(ye=o.charAt(ue),qt.test(ye)?ue++:(ye=a,At===0&&Et(ei)),ye===a&&(ye=null),je=[],St=pi(),St!==a)for(;St!==a;)je.push(St),St=pi();else je=a;je!==a?(oe=[oe,ye,je],L=oe):(ue=L,L=a)}else ue=L,L=a;return L}function Xr(){var L,oe,ye,je;if(L=ue,oe=Gr(),oe!==a){if(ye=[],je=pi(),je!==a)for(;je!==a;)ye.push(je),je=pi();else ye=a;ye!==a?(oe=[oe,ye],L=oe):(ue=L,L=a)}else ue=L,L=a;return L}function xi(){var L,oe,ye,je;if(L=Nr(),L===a)if(L=ue,oe=Zr(),oe!==a){for(ye=[],je=pi();je!==a;)ye.push(je),je=pi();oe=[oe,ye],L=oe}else ue=L,L=a;return L}function Br(){var L;return o.charCodeAt(ue)===45?(L=f,ue++):(L=a,At===0&&Et(ve)),L}function Nr(){var L;return o.charCodeAt(ue)===48?(L=g,ue++):(L=a,At===0&&Et(Ce)),L}function pi(){var L;return L=o.charAt(ue),Wt.test(L)?ue++:(L=a,At===0&&Et(_e)),L}function Gt(){var L,oe;for(At++,L=[],oe=o.charAt(ue),tn.test(oe)?ue++:(oe=a,At===0&&Et(ot));oe!==a;)L.push(oe),oe=o.charAt(ue),tn.test(oe)?ue++:(oe=a,At===0&&Et(ot));return At--,oe=a,At===0&&Et(Ie),L}function hi(){var L,oe,ye,je;return L=ue,oe=Gt(),o.charCodeAt(ue)===44?(ye=b,ue++):(ye=a,At===0&&Et(ft)),ye!==a?(je=Gt(),oe=[oe,ye,je],L=oe):(ue=L,L=a),L}function $i(){var L,oe,ye,je;return L=ue,oe=Gt(),o.charCodeAt(ue)===124?(ye=A,ue++):(ye=a,At===0&&Et(tt)),ye!==a?(je=Gt(),oe=[oe,ye,je],L=oe):(ue=L,L=a),L}function Gi(){var L,oe,ye,je;return L=ue,oe=Gt(),o.charCodeAt(ue)===46?(ye=d,ue++):(ye=a,At===0&&Et(zn)),ye!==a?(je=Gt(),oe=[oe,ye,je],L=oe):(ue=L,L=a),L}function di(){var L;return L=o.charAt(ue),wn.test(L)?ue++:(L=a,At===0&&Et(Mt)),L}function vi(){var L;return At++,L=o.charAt(ue),dn.test(L)?ue++:(L=a,At===0&&Et(Ot)),At--,L===a&&At===0&&Et(st),L}function Zi(){var L,oe,ye,je;if(L=ue,Gt(),oe=[],ye=vi(),ye!==a)for(;ye!==a;)oe.push(ye),ye=vi();else oe=a;return oe!==a?(ye=Gt(),Xt=ue,je=Qi(oe),je?je=a:je=void 0,je!==a?(Xt=L,L=Wi(oe)):(ue=L,L=a)):(ue=L,L=a),L}function Vr(){var L,oe,ye,je;return L=ue,Gt(),o.charCodeAt(ue)===91?(oe=S,ue++):(oe=a,At===0&&Et(kt)),oe!==a?(Gt(),ye=Xi(),ye!==a?(Gt(),o.charCodeAt(ue)===93?(je=M,ue++):(je=a,At===0&&Et(on)),je!==a?(Gt(),Xt=L,L=Ii(ye)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function Qr(){var L,oe,ye,je,St;return L=ue,Gt(),o.charCodeAt(ue)===123?(oe=E,ue++):(oe=a,At===0&&Et(an)),oe!==a?(Gt(),ye=Bi(),ye!==a?(Gt(),o.charCodeAt(ue)===125?(je=F,ue++):(je=a,At===0&&Et(Ut)),je!==a?(St=Wr(),St===a&&(St=null),Gt(),Xt=L,L=zi(ye,St)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function Wr(){var L,oe,ye;return L=ue,o.charCodeAt(ue)===37?(oe=$,ue++):(oe=a,At===0&&Et(Nt)),oe!==a?(ye=fi(),ye!==a?(Xt=L,L=Yi(ye)):(ue=L,L=a)):(ue=L,L=a),L}function Ir(){var L,oe,ye,je;return L=ue,Gt(),o.charCodeAt(ue)===60?(oe=Z,ue++):(oe=a,At===0&&Et(hn)),oe!==a?(Gt(),ye=Bi(),ye!==a?(Gt(),o.charCodeAt(ue)===62?(je=V,ue++):(je=a,At===0&&Et(Ft)),je!==a?(Gt(),Xt=L,L=Ui(ye)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function fi(){var L;return L=Zi(),L===a&&(L=Vr(),L===a&&(L=Qr(),L===a&&(L=Ir()))),L}function Ri(){var L;return L=zr(),L===a&&(L=Ur(),L===a&&(L=jr(),L===a&&(L=Hr(),L===a&&(L=Yr(),L===a&&(L=Kr(),L===a&&(L=qr(),L===a&&(L=Jr()))))))),L}function zr(){var L,oe,ye;return L=ue,Gt(),oe=o.charAt(ue),rn.test(oe)?ue++:(oe=a,At===0&&Et(fn)),oe!==a?(ye=ai(),ye===a&&(ye=null),Xt=L,L=ji(ye)):(ue=L,L=a),L}function Yr(){var L,oe,ye;return L=ue,Gt(),o.charCodeAt(ue)===33?(oe=K,ue++):(oe=a,At===0&&Et(mn)),oe!==a?(ye=ai(),ye===a&&(ye=null),Xt=L,L=Hi(ye)):(ue=L,L=a),L}function Ur(){var L,oe,ye,je,St,un,ri;return L=ue,o.charCodeAt(ue)===40?(oe=se,ue++):(oe=a,At===0&&Et(xt)),oe!==a?(Gt(),ye=_i(),ye!==a?(Gt(),je=hi(),je!==a?(Gt(),St=_i(),St!==a?(Gt(),hi(),Gt(),un=_i(),un===a&&(un=null),Gt(),o.charCodeAt(ue)===41?(ri=z,ue++):(ri=a,At===0&&Et(Vt)),ri!==a?(Xt=L,L=Ki(ye,St,un)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function jr(){var L,oe,ye;return L=ue,o.charCodeAt(ue)===47?(oe=U,ue++):(oe=a,At===0&&Et(en)),oe!==a?(ye=fi(),ye!==a?(Xt=L,L=qi(ye)):(ue=L,L=a)):(ue=L,L=a),L}function Hr(){var L,oe,ye;return L=ue,o.charCodeAt(ue)===42?(oe=ee,ue++):(oe=a,At===0&&Et(sn)),oe!==a?(ye=fi(),ye!==a?(Xt=L,L=Ji(ye)):(ue=L,L=a)):(ue=L,L=a),L}function Kr(){var L,oe,ye;return L=ue,o.charCodeAt(ue)===63?(oe=ae,ue++):(oe=a,At===0&&Et(yn)),oe!==a?(ye=ai(),ye===a&&(ye=null),Xt=L,L=er(ye)):(ue=L,L=a),L}function qr(){var L,oe,ye;return L=ue,o.charCodeAt(ue)===58?(oe=de,ue++):(oe=a,At===0&&Et(Xn)),oe!==a?(ye=fi(),ye!==a?(Xt=L,L=nr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function Jr(){var L,oe,ye;return L=ue,o.substr(ue,2)===ke?(oe=ke,ue+=2):(oe=a,At===0&&Et(ti)),oe!==a?(ye=fi(),ye!==a?(Xt=L,L=rr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function _i(){var L,oe,ye,je;if(L=ue,oe=fi(),oe!==a){for(ye=[],je=Ri();je!==a;)ye.push(je),je=Ri();Xt=L,L=sr(oe,ye)}else ue=L,L=a;return L}function ui(){var L,oe,ye,je;if(L=ue,o.charCodeAt(ue)===94?(oe=Oe,ue++):(oe=a,At===0&&Et(R)),oe===a&&(oe=null),ye=[],je=_i(),je!==a)for(;je!==a;)ye.push(je),je=_i();else ye=a;return ye!==a?(Xt=L,L=lr(oe,ye)):(ue=L,L=a),L}function Li(){var L,oe,ye,je,St;if(L=ue,oe=[],ye=ue,je=hi(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a),ye!==a)for(;ye!==a;)oe.push(ye),ye=ue,je=hi(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a);else oe=a;return oe!==a&&(Xt=L,oe=ur(oe)),L=oe,L}function es(){var L,oe,ye,je,St;if(L=ue,oe=[],ye=ue,je=$i(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a),ye!==a)for(;ye!==a;)oe.push(ye),ye=ue,je=$i(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a);else oe=a;return oe!==a&&(Xt=L,oe=cr(oe)),L=oe,L}function ts(){var L,oe,ye,je,St;if(L=ue,oe=[],ye=ue,je=Gi(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a),ye!==a)for(;ye!==a;)oe.push(ye),ye=ue,je=Gi(),je!==a?(St=ui(),St!==a?ye=St:(ue=ye,ye=a)):(ue=ye,ye=a);else oe=a;return oe!==a&&(Xt=L,oe=hr(oe)),L=oe,L}function Xi(){var L,oe,ye;return L=ue,oe=ui(),oe!==a?(ye=Li(),ye===a&&(ye=es(),ye===a&&(ye=ts())),ye===a&&(ye=null),Xt=L,L=dr(oe,ye)):(ue=L,L=a),L}function Bi(){var L,oe,ye;return L=ue,oe=ui(),oe!==a?(ye=Li(),ye===a&&(ye=null),Xt=L,L=fr(oe,ye)):(ue=L,L=a),L}function ns(){var L,oe,ye,je;return L=ue,Gt(),oe=di(),oe!==a?(Gt(),ye=Xi(),ye!==a?(Gt(),je=di(),je!==a?(Xt=L,L=mr(ye)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function is(){var L;return L=hs(),L===a&&(L=ls(),L===a&&(L=ps(),L===a&&(L=ss(),L===a&&(L=os(),L===a&&(L=rs(),L===a&&(L=cs(),L===a&&(L=us()))))))),L}function rs(){var L,oe,ye;return L=ue,o.substr(ue,6)===De?(oe=De,ue+=6):(oe=a,At===0&&Et(te)),oe!==a?(Gt(),ye=mi(),ye!==a?(Xt=L,L=gr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function ss(){var L,oe,ye,je,St;return L=ue,o.substr(ue,6)===Ae?(oe=Ae,ue+=6):(oe=a,At===0&&Et(q)),oe!==a?(Gt(),ye=di(),ye!==a?(je=Zi(),je!==a?(St=di(),St!==a?(Xt=L,L=yr(je)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function os(){var L,oe,ye,je;return L=ue,o.substr(ue,6)===Pe?(oe=Pe,ue+=6):(oe=a,At===0&&Et(re)),oe!==a?(Gt(),ye=xi(),ye!==a?(Gt(),je=xi(),je!==a?(Gt(),xi(),Xt=L,L=_r(ye,je)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a),L}function ls(){var L,oe,ye;return L=ue,o.substr(ue,4)===We?(oe=We,ue+=4):(oe=a,At===0&&Et(le)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=br(ye)):(ue=L,L=a)):(ue=L,L=a),L}function us(){var L,oe,ye;return L=ue,o.substr(ue,4)===qe?(oe=qe,ue+=4):(oe=a,At===0&&Et(Ee)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=Or(ye)):(ue=L,L=a)):(ue=L,L=a),L}function cs(){var L,oe,ye;return L=ue,o.substr(ue,4)===at?(oe=at,ue+=4):(oe=a,At===0&&Et(He)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=Ar(ye)):(ue=L,L=a)):(ue=L,L=a),L}function ps(){var L,oe,ye;return L=ue,o.substr(ue,4)===yt?(oe=yt,ue+=4):(oe=a,At===0&&Et(Je)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=xr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function hs(){var L,oe,ye,je,St;if(L=ue,o.substr(ue,5)===ut?(oe=ut,ue+=5):(oe=a,At===0&&Et(_t)),oe!==a)if(Gt(),ye=di(),ye!==a){if(je=[],St=vi(),St!==a)for(;St!==a;)je.push(St),St=vi();else je=a;je!==a?(St=di(),St!==a?(Xt=L,L=vr(je)):(ue=L,L=a)):(ue=L,L=a)}else ue=L,L=a;else ue=L,L=a;return L}function Mi(){var L,oe,ye,je;if(L=ue,o.substr(ue,2)===Dt?(oe=Dt,ue+=2):(oe=a,At===0&&Et(Yt)),oe!==a){for(ye=[],je=o.charAt(ue),Zn.test(je)?ue++:(je=a,At===0&&Et(pn));je!==a;)ye.push(je),je=o.charAt(ue),Zn.test(je)?ue++:(je=a,At===0&&Et(pn));oe=[oe,ye],L=oe}else ue=L,L=a;return L}function fs(){var L,oe,ye,je,St,un,ri,gi;if(L=ue,o.substr(ue,3)===$t?(oe=$t,ue+=3):(oe=a,At===0&&Et(si)),oe!==a)if(Gt(),o.charCodeAt(ue)===91?(ye=S,ue++):(ye=a,At===0&&Et(kt)),ye!==a)if(Gt(),je=mi(),je!==a){for(St=[],un=ue,ri=hi(),ri!==a?(gi=mi(),gi!==a?(Xt=un,un=Ti(je,gi)):(ue=un,un=a)):(ue=un,un=a);un!==a;)St.push(un),un=ue,ri=hi(),ri!==a?(gi=mi(),gi!==a?(Xt=un,un=Ti(je,gi)):(ue=un,un=a)):(ue=un,un=a);un=Gt(),o.charCodeAt(ue)===93?(ri=M,ue++):(ri=a,At===0&&Et(on)),ri!==a?(Xt=L,L=Cr(je,St)):(ue=L,L=a)}else ue=L,L=a;else ue=L,L=a;else ue=L,L=a;return L}function ms(){var L;return L=fs(),L===a&&(L=ns()),L}function mi(){var L,oe,ye,je,St;if(L=ue,oe=ms(),oe!==a){for(Gt(),ye=[],je=Mi();je!==a;)ye.push(je),je=Mi();Xt=L,L=Sr(oe)}else ue=L,L=a;return L===a&&(L=ue,oe=is(),oe!==a?(Gt(),o.charCodeAt(ue)===36?(ye=Bt,ue++):(ye=a,At===0&&Et(li)),ye!==a?(je=Gt(),St=mi(),St!==a?(Xt=L,L=wr(oe,St)):(ue=L,L=a)):(ue=L,L=a)):(ue=L,L=a)),L}function gs(){var L,oe;return L=ue,oe=mi(),oe!==a&&(Xt=L,oe=Mr(oe)),L=oe,L===a&&(L=Mi()),L}function ys(){var L;return L=gs(),L}function _s(){var L,oe;return L=ue,Gt(),oe=bs(),oe===a&&(oe=Os(),oe===a&&(oe=As())),oe!==a?(Gt(),Xt=L,L=Pr(oe)):(ue=L,L=a),L}function bs(){var L,oe,ye;return L=ue,o.substr(ue,6)===$e?(oe=$e,ue+=6):(oe=a,At===0&&Et(bi)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=kr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function Os(){var L,oe,ye;return L=ue,o.substr(ue,6)===bt?(oe=bt,ue+=6):(oe=a,At===0&&Et(Oi)),oe!==a?(Gt(),ye=ai(),ye!==a?(Xt=L,L=Tr(ye)):(ue=L,L=a)):(ue=L,L=a),L}function As(){var L,oe;return L=ue,o.substr(ue,4)===nn?(oe=nn,ue+=4):(oe=a,At===0&&Et(ni)),oe!==a&&(Xt=L,oe=Dr()),L=oe,L}function xs(){var L;return L=ys(),L===a&&(L=_s()),L}var vs=function(L){this.type_="atom",this.source_=L,this.location_=Di()},Ci=function(L,oe,ye,je){this.type_="pattern",this.arguments_={alignment:oe,_steps:je},ye!==void 0&&(this.arguments_.seed=ye),this.source_=L},Cs=function(L,oe,ye){this.type_=L,this.arguments_=oe,this.source_=ye},Ss=function(L,oe){this.type_="element",this.source_=L,this.options_=oe,this.location_=Di()},Pi=function(L,oe){this.type_="command",this.name_=L,this.options_=oe},ki=0;if(yi=p(),e.peg$library)return{peg$result:yi,peg$currPos:ue,peg$FAILED:a,peg$maxFailExpected:Ai,peg$maxFailPos:ii};if(yi!==a&&ue===o.length)return yi;throw yi!==a&&ue<o.length&&Et(Fr()),$r(Ai,ii<o.length?o.charAt(ii):null,ii<o.length?wi(ii,ii+1):wi(ii,ii))}const peg$allowedStartRules=["start"],randOffset=3e-4,applyOptions=(o,e)=>(a,l)=>{const d=o.source_[l].options_?.ops,f=a.__steps_source;if(d)for(const g of d)switch(g.type_){case"stretch":{const b=["fast","slow"],{type:A,amount:S}=g.arguments_;if(!b.includes(A))throw new Error(`mini: stretch: type must be one of ${b.join("|")} but got ${A}`);a=reify(a)[A](e(S));break}case"replicate":{const{amount:b}=g.arguments_;a=reify(a),a=a._repeatCycles(b)._fast(b);break}case"bjorklund":{g.arguments_.rotation?a=a.euclidRot(e(g.arguments_.pulse),e(g.arguments_.step),e(g.arguments_.rotation)):a=a.euclid(e(g.arguments_.pulse),e(g.arguments_.step));break}case"degradeBy":{a=reify(a)._degradeByWith(rand.early(randOffset*g.arguments_.seed),g.arguments_.amount??.5);break}case"tail":{const b=e(g.arguments_.element);a=a.fmap(A=>S=>Array.isArray(A)?[...A,S]:[A,S]).appLeft(b);break}case"range":{const b=e(g.arguments_.element);a=reify(a);const A=(M,E,F=1)=>Array.from({length:Math.abs(E-M)/F+1},($,Z)=>M<E?M+Z*F:M-Z*F);a=((M,E)=>M.squeezeBind(F=>E.bind($=>fastcat(...A(F,$)))))(a,b);break}default:console.warn(`operator "${g.type_}" not implemented`)}return a.__steps_source=a.__steps_source||f,a};function patternifyAST(o,e,a,l=0){a?.(o);const u=p=>patternifyAST(p,e,a,l);switch(o.type_){case"pattern":{const p=o.source_.map(b=>u(b)).map(applyOptions(o,u)),d=o.arguments_.alignment,f=p.filter(b=>b.__steps_source);let g;switch(d){case"stack":{g=stack(...p),f.length&&(g._steps=lcm(...f.map(b=>fraction$1(b._steps))));break}case"polymeter_slowcat":{g=stack(...p.map(b=>b._slow(b.__weight))),f.length&&(g._steps=lcm(...f.map(b=>fraction$1(b._steps))));break}case"polymeter":{const b=o.arguments_.stepsPerCycle?u(o.arguments_.stepsPerCycle).fmap(S=>fraction$1(S)):pure(fraction$1(p.length>0?p[0].__weight:1)),A=p.map(S=>S.fast(b.fmap(M=>M.div(S.__weight))));g=stack(...A);break}case"rand":{g=chooseInWith(rand.early(randOffset*o.arguments_.seed).segment(1),p),f.length&&(g._steps=lcm(...f.map(b=>fraction$1(b._steps))));break}case"feet":{g=fastcat(...p);break}default:{if(o.source_.some(A=>!!A.options_?.weight)){const A=o.source_.reduce((S,M)=>S.add(M.options_?.weight||fraction$1(1)),fraction$1(0));g=timeCat(...o.source_.map((S,M)=>[S.options_?.weight||fraction$1(1),p[M]])),g.__weight=A,g._steps=A,f.length&&(g._steps=g._steps.mul(lcm(...f.map(S=>fraction$1(S._steps)))))}else g=sequence(...p),g._steps=p.length;o.arguments_._steps&&(g.__steps_source=!0)}}return f.length&&(g.__steps_source=!0),g}case"element":return u(o.source_);case"atom":{if(o.source_==="~"||o.source_==="-")return silence;if(!o.location_)return console.warn("no location for",o),o.source_;const p=isNaN(Number(o.source_))?o.source_:Number(o.source_);if(l===-1)return pure(p);const[d,f]=getLeafLocation(e,o,l);return pure(p).withLoc(d,f)}case"stretch":return u(o.source_).slow(u(o.arguments_.amount));default:return console.warn(`node type "${o.type_}" not implemented -> returning silence`),silence}}const getLeafLocation=(o,e,a=0)=>{const{start:l,end:u}=e.location_,p=o?.split("").slice(l.offset,u.offset).join(""),[d=0,f=0]=p?p.split(e.source_).map(g=>g.split("").filter(b=>b===" ").length):[];return[l.offset+d+a,u.offset-f+a]},mini2ast=(o,e=0,a=o)=>{try{return peg$parse(o)}catch(l){const u=[l.location.start.offset+e,l.location.end.offset+e],p=a.slice(0,u[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${p}: ${l.message}`)}},getLeaves=(o,e,a)=>{const l=mini2ast(o,e,a);let u=[];return patternifyAST(l,o,p=>{p.type_==="atom"&&u.push(p)},-1),u},getLeafLocations=(o,e=0,a)=>getLeaves(o,e,a).map(l=>getLeafLocation(o,l,e)),mini=(...o)=>{const e=o.map(a=>{const l=`"${a}"`,u=mini2ast(l);return patternifyAST(u,l)});return sequence(...e)},m$1=(o,e)=>{const a=`"${o}"`,l=mini2ast(a);return patternifyAST(l,a,null,e)},h$1=o=>{const e=mini2ast(o);return patternifyAST(e,o)};function minify(o){return typeof o=="string"?mini(o):reify(o)}function miniAllStrings(){setStringParser(mini)}const strudelMini=Object.freeze(Object.defineProperty({__proto__:null,StartRules:peg$allowedStartRules,SyntaxError:peg$SyntaxError,getLeafLocation,getLeafLocations,getLeaves,h:h$1,m:m$1,mini,mini2ast,miniAllStrings,minify,parse:peg$parse,patternifyAST},Symbol.toStringTag,{value:"Module"}));if(typeof DelayNode<"u"){class o extends DelayNode{constructor(a,l,u,p){super(a),l=Math.abs(l),this.delayTime.value=u;const d=a.createGain();d.gain.value=Math.min(Math.abs(p),.995),this.feedback=d.gain;const f=a.createGain();return f.gain.value=l,this.delayGain=f,this.connect(d),this.connect(f),d.connect(this),this.connect=g=>f.connect(g),this}start(a){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,a+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(e,a,l){return new o(this,e,a,l)}}var reverbGen={};reverbGen.generateReverb=function(o,e){for(var a=o.audioContext||new AudioContext,l=a.sampleRate,u=o.numChannels||2,p=o.decayTime*1.5,d=Math.round(o.decayTime*l),f=Math.round(p*l),g=Math.round((o.fadeInTime||0)*l),b=Math.pow(1/1e3,1/d),A=a.createBuffer(u,f,l),S=0;S<u;S++){for(var M=A.getChannelData(S),E=0;E<f;E++)M[E]=randomSample()*Math.pow(b,E);for(var E=0;E<g;E++)M[E]*=E/g}applyGradualLowpass(A,o.lpFreqStart||0,o.lpFreqEnd||0,o.decayTime,e)},reverbGen.generateGraph=function(o,e,a,l,u){var p=document.createElement("canvas");p.width=e,p.height=a;var d=p.getContext("2d");d.fillStyle="#000",d.fillRect(0,0,p.width,p.height),d.fillStyle="#fff";for(var f=e/o.length,g=a/(u-l),b=0;b<o.length;b++)d.fillRect(b*f,a-(o[b]-l)*g,1,1);return p};var applyGradualLowpass=function(o,e,a,l,u){if(e==0){u(o);return}var p=getAllChannelData(o),d=new OfflineAudioContext(o.numberOfChannels,p[0].length,o.sampleRate),f=d.createBufferSource();f.buffer=o;var g=d.createBiquadFilter();e=Math.min(e,o.sampleRate/2),a=Math.min(a,o.sampleRate/2),g.type="lowpass",g.Q.value=1e-4,g.frequency.setValueAtTime(e,0),g.frequency.linearRampToValueAtTime(a,l),f.connect(g),g.connect(d.destination),f.start(),d.oncomplete=function(b){u(b.renderedBuffer),g.disconnect(),f.disconnect()},d.startRendering(),window.filterNode=g},getAllChannelData=function(o){for(var e=[],a=0;a<o.numberOfChannels;a++)e[a]=o.getChannelData(a);return e},randomSample=function(){return Math.random()*2-1};let log=o=>console.log(o);function errorLogger(o,e="superdough"){process.env.NODE_ENV==="development"&&console.error(o),logger$1(`[${e}] error: ${o.message}`)}const logger$1=(...o)=>log(...o),setLogger=o=>{log=o},tokenizeNote$2=o=>{if(typeof o!="string")return[];const[e,a="",l]=o.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return e?[e,a,l?Number(l):void 0]:[]},chromas$1={c:0,d:2,e:4,f:5,g:7,a:9,b:11},accs$1={"#":1,b:-1,s:1,f:-1},getAccidentalsOffset=o=>o?.split("").reduce((e,a)=>e+accs$1[a],0)||0,noteToMidi=(o,e=3)=>{const[a,l,u=e]=tokenizeNote$2(o);if(!a)throw new Error('not a note: "'+o+'"');const p=chromas$1[a.toLowerCase()],d=getAccidentalsOffset(l);return(Number(u)+1)*12+p+d},midiToFreq$1=o=>Math.pow(2,(o-69)/12)*440,clamp=(o,e,a)=>Math.min(Math.max(o,e),a),freqToMidi$1=o=>12*Math.log(o/440)/Math.LN2+69,valueToMidi=(o,e)=>{if(typeof o!="object")throw new Error("valueToMidi: expected object value");let{freq:a,note:l}=o;return typeof a=="number"?freqToMidi$1(a):typeof l=="string"?noteToMidi(l):typeof l=="number"?l:e};function nanFallback(o,e=0,a){return isNaN(Number(o))?(!a&&logger$1(`"${o}" is not a number, falling back to ${e}`,"warning"),e):o}const _mod$1=(o,e)=>(o%e+e)%e,getSoundIndex=(o,e)=>_mod$1(Math.round(nanFallback(o,0)),e);function cycleToSeconds(o,e){return o/e}function getCommonSampleInfo(o,e){const{s:a,n:l=0}=o;let u=valueToMidi(o,36),p=u-36,d,f=0;if(Array.isArray(e))f=getSoundIndex(l,e.length),d=e[f];else{const b=S=>noteToMidi(S)-u,A=Object.keys(e).filter(S=>!S.startsWith("_")).reduce((S,M,E)=>!S||Math.abs(b(M))<Math.abs(b(S))?M:S,null);p=-b(A),f=getSoundIndex(l,e[A].length),d=e[A][f]}const g=`${a}:${f}`;return{transpose:p,url:d,index:f,midi:u,label:g}}const pickAndRename=(o,e)=>Object.fromEntries(Object.entries(e).map(([a,l])=>[a,o[l]])),getBaseURL=o=>{try{return new URL(".",new URL(o)).href.replace(/\/$/,"")}catch{return o.split("/").slice(0,-1).join("/")}};typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(o,e,a=1,l=0){const u=Math.floor(clamp(l,0,1)*e.length),p=e.sampleRate*o,d=this.createBuffer(e.numberOfChannels,e.length,e.sampleRate);for(let f=0;f<e.numberOfChannels;f++){let g=e.getChannelData(f),b=d.getChannelData(f);for(let A=0;A<p;A++){let S=(u+A*Math.abs(a))%g.length;a<1&&(S=S*-1),b[A]=g.at(S)||0}}return d},AudioContext.prototype.createReverb=function(o,e,a,l,u,p,d){const f=this.createConvolver();return f.generate=(g=2,b=.1,A=15e3,S=1e3,M,E,F)=>{f.duration=g,f.fade=b,f.lp=A,f.dim=S,f.ir=M,f.irspeed=E,f.irbegin=F,M?f.buffer=this.adjustLength(g,M,E,F):reverbGen.generateReverb({audioContext:this,numChannels:2,decayTime:g,fadeInTime:b,lpFreqStart:A,lpFreqEnd:S},$=>{f.buffer=$})},f.generate(o,e,a,l,u,p,d),f});var vowelFormant={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class o extends GainNode{constructor(a,l){if(super(a),!vowelFormant[l])throw new Error("vowel: unknown vowel "+l);const{gains:u,qs:p,freqs:d}=vowelFormant[l];this.makeupGain=a.createGain(),this.audioNodes=[];for(let f=0;f<5;f++){const g=a.createGain();g.gain.value=u[f];const b=a.createBiquadFilter();b.type="bandpass",b.Q.value=p[f],b.frequency.value=d[f],super.connect(b),b.connect(g),this.audioNodes.push(b),g.connect(this.makeupGain),this.audioNodes.push(g)}return this.makeupGain.gain.value=8,this}connect(a){this.makeupGain.connect(a)}disconnect(){this.makeupGain.disconnect(),this.audioNodes.forEach(a=>a.disconnect()),super.disconnect(),this.makeupGain=null,this.audioNodes=null}}AudioContext.prototype.createVowelFilter=function(e){return new o(this,e)}}const workletsUrl="data:text/javascript;base64,dmFyIF89KGZ1bmN0aW9uKGZ0KXsidXNlIHN0cmljdCI7Y2xhc3Mga3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5zdGFydGVkPSExLHRoaXMubmJJbnB1dHM9dC5udW1iZXJPZklucHV0cyx0aGlzLm5iT3V0cHV0cz10Lm51bWJlck9mT3V0cHV0cyx0aGlzLmJsb2NrU2l6ZT10LnByb2Nlc3Nvck9wdGlvbnMuYmxvY2tTaXplLHRoaXMuaG9wU2l6ZT0xMjgsdGhpcy5uYk92ZXJsYXBzPXRoaXMuYmxvY2tTaXplL3RoaXMuaG9wU2l6ZSx0aGlzLmlucHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkPW5ldyBBcnJheSh0aGlzLm5iSW5wdXRzKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iSW5wdXRzO2UrKyl0aGlzLmFsbG9jYXRlSW5wdXRDaGFubmVscyhlLDEpO3RoaXMub3V0cHV0QnVmZmVycz1uZXcgQXJyYXkodGhpcy5uYk91dHB1dHMpLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmU9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKTtmb3IobGV0IGU9MDtlPHRoaXMubmJPdXRwdXRzO2UrKyl0aGlzLmFsbG9jYXRlT3V0cHV0Q2hhbm5lbHMoZSwxKX1yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpe2ZvcihsZXQgcz0wO3M8dGhpcy5uYklucHV0cztzKyspe2xldCByPXRbc10ubGVuZ3RoO3IhPXRoaXMuaW5wdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMocyxyKX1mb3IobGV0IHM9MDtzPHRoaXMubmJPdXRwdXRzO3MrKyl7bGV0IHI9ZVtzXS5sZW5ndGg7ciE9dGhpcy5vdXRwdXRCdWZmZXJzW3NdLmxlbmd0aCYmdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHMscil9fWFsbG9jYXRlSW5wdXRDaGFubmVscyh0LGUpe3RoaXMuaW5wdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUrMTI4KSx0aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XT1uZXcgQXJyYXkoZSksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmRbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW3NdPXRoaXMuaW5wdXRCdWZmZXJzW3RdW3NdLnN1YmFycmF5KDAsdGhpcy5ibG9ja1NpemUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpfWFsbG9jYXRlT3V0cHV0Q2hhbm5lbHModCxlKXt0aGlzLm91dHB1dEJ1ZmZlcnNbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW3NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5ibG9ja1NpemUpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXS5maWxsKDApO3RoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF09bmV3IEFycmF5KGUpO2ZvcihsZXQgcz0wO3M8ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW3NdLmZpbGwoMCl9cmVhZElucHV0cyh0KXtpZih0WzBdLmxlbmd0aCYmdFswXVswXS5sZW5ndGg9PTApe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXRoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLmZpbGwoMCx0aGlzLmJsb2NrU2l6ZSk7cmV0dXJufWZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10W2VdW3NdO3RoaXMuaW5wdXRCdWZmZXJzW2VdW3NdLnNldChyLHRoaXMuYmxvY2tTaXplKX19d3JpdGVPdXRwdXRzKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmlucHV0QnVmZmVyc1tlXS5sZW5ndGg7cysrKXtsZXQgcj10aGlzLm91dHB1dEJ1ZmZlcnNbZV1bc10uc3ViYXJyYXkoMCwxMjgpO3RbZV1bc10uc2V0KHIpfX1zaGlmdElucHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpfXNoaWZ0T3V0cHV0QnVmZmVycygpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdLmNvcHlXaXRoaW4oMCwxMjgpLHRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5zdWJhcnJheSh0aGlzLmJsb2NrU2l6ZS0xMjgpLmZpbGwoMCl9cHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYklucHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmlucHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdW2VdLnNldCh0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF1bZV0pfWhhbmRsZU91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlKCl7Zm9yKGxldCB0PTA7dDx0aGlzLm5iT3V0cHV0czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLm91dHB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuYmxvY2tTaXplO3MrKyl0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV1bc10rPXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bZV1bc10vdGhpcy5uYk92ZXJsYXBzfXByb2Nlc3ModCxlLHMpe2NvbnN0IGk9dFswXVswXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5zdGFydGVkJiYhaT8hMToodGhpcy5zdGFydGVkPWksdGhpcy5yZWFsbG9jYXRlQ2hhbm5lbHNJZk5lZWRlZCh0LGUpLHRoaXMucmVhZElucHV0cyh0KSx0aGlzLnNoaWZ0SW5wdXRCdWZmZXJzKCksdGhpcy5wcmVwYXJlSW5wdXRCdWZmZXJzVG9TZW5kKCksdGhpcy5wcm9jZXNzT0xBKHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kLHRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmUscyksdGhpcy5oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpLHRoaXMud3JpdGVPdXRwdXRzKGUpLHRoaXMuc2hpZnRPdXRwdXRCdWZmZXJzKCksITApfXByb2Nlc3NPTEEodCxlLHMpe2NvbnNvbGUuYXNzZXJ0KCExLCJOb3Qgb3ZlcnJpZGVuIil9fWNsYXNzIEV0e2NvbnN0cnVjdG9yKHQpe2lmKHRoaXMuc2l6ZT10fDAsdGhpcy5zaXplPD0xfHwodGhpcy5zaXplJnRoaXMuc2l6ZS0xKSE9PTApdGhyb3cgbmV3IEVycm9yKCJGRlQgc2l6ZSBtdXN0IGJlIGEgcG93ZXIgb2YgdHdvIGFuZCBiaWdnZXIgdGhhbiAxIik7dGhpcy5fY3NpemU9dDw8MTtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuc2l6ZSoyKSxzPTA7czxlLmxlbmd0aDtzKz0yKXtjb25zdCBjPU1hdGguUEkqcy90aGlzLnNpemU7ZVtzXT1NYXRoLmNvcyhjKSxlW3MrMV09LU1hdGguc2luKGMpfXRoaXMudGFibGU9ZTtmb3IodmFyIHI9MCxpPTE7dGhpcy5zaXplPmk7aTw8PTEpcisrO3RoaXMuX3dpZHRoPXIlMj09PTA/ci0xOnIsdGhpcy5fYml0cmV2PW5ldyBBcnJheSgxPDx0aGlzLl93aWR0aCk7Zm9yKHZhciBvPTA7bzx0aGlzLl9iaXRyZXYubGVuZ3RoO28rKyl7dGhpcy5fYml0cmV2W29dPTA7Zm9yKHZhciBhPTA7YTx0aGlzLl93aWR0aDthKz0yKXt2YXIgdT10aGlzLl93aWR0aC1hLTI7dGhpcy5fYml0cmV2W29dfD0obz4+PmEmMyk8PHV9fXRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbCx0aGlzLl9pbnY9MH1mcm9tQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fG5ldyBBcnJheSh0Lmxlbmd0aD4+PjEpLHI9MDtyPHQubGVuZ3RoO3IrPTIpc1tyPj4+MV09dFtyXTtyZXR1cm4gc31jcmVhdGVDb21wbGV4QXJyYXkoKXtjb25zdCB0PW5ldyBBcnJheSh0aGlzLl9jc2l6ZSk7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXT0wO3JldHVybiB0fXRvQ29tcGxleEFycmF5KHQsZSl7Zm9yKHZhciBzPWV8fHRoaXMuY3JlYXRlQ29tcGxleEFycmF5KCkscj0wO3I8cy5sZW5ndGg7cis9MilzW3JdPXRbcj4+PjFdLHNbcisxXT0wO3JldHVybiBzfWNvbXBsZXRlU3BlY3RydW0odCl7Zm9yKHZhciBlPXRoaXMuX2NzaXplLHM9ZT4+PjEscj0yO3I8cztyKz0yKXRbZS1yXT10W3JdLHRbZS1yKzFdPS10W3IrMV19dHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fdHJhbnNmb3JtNCgpLHRoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1yZWFsVHJhbnNmb3JtKHQsZSl7aWYodD09PWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBhbmQgb3V0cHV0IGJ1ZmZlcnMgbXVzdCBiZSBkaWZmZXJlbnQiKTt0aGlzLl9vdXQ9dCx0aGlzLl9kYXRhPWUsdGhpcy5faW52PTAsdGhpcy5fcmVhbFRyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9aW52ZXJzZVRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0xLHRoaXMuX3RyYW5zZm9ybTQoKTtmb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl0W3NdLz10aGlzLnNpemU7dGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfV90cmFuc2Zvcm00KCl7dmFyIHQ9dGhpcy5fb3V0LGU9dGhpcy5fY3NpemUscz10aGlzLl93aWR0aCxyPTE8PHMsaT1lL3I8PDEsbyxhLHU9dGhpcy5fYml0cmV2O2lmKGk9PT00KWZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgbT11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTIobyxtLHIpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBtPXVbYV07dGhpcy5fc2luZ2xlVHJhbnNmb3JtNChvLG0scil9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+Mjtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgZD1vK2YsbD1vLHA9MDtsPGQ7bCs9MixwKz1yKXtjb25zdCBtPWwsST1tK2YsZz1JK2Ysdj1nK2Ysdz10W21dLFA9dFttKzFdLFM9dFtJXSxWPXRbSSsxXSxNPXRbZ10seD10W2crMV0seT10W3ZdLEE9dFt2KzFdLFc9dyxOPVAsRT1oW3BdLE89YypoW3ArMV0sRj1TKkUtVipPLEQ9UypPK1YqRSxMPWhbMipwXSxDPWMqaFsyKnArMV0sZXQ9TSpMLXgqQyxzdD1NKkMreCpMLHJ0PWhbMypwXSxudD1jKmhbMypwKzFdLGl0PXkqcnQtQSpudCxvdD15Km50K0EqcnQsYXQ9VytldCwkPU4rc3QsRz1XLWV0LGN0PU4tc3QsdXQ9RitpdCxRPUQrb3QsSj1jKihGLWl0KSxodD1jKihELW90KSxsdD1hdCt1dCxidD0kK1EsSXQ9YXQtdXQsX3Q9JC1RLEJ0PUcraHQsd3Q9Y3QtSixUdD1HLWh0LFB0PWN0K0o7dFttXT1sdCx0W20rMV09YnQsdFtJXT1CdCx0W0krMV09d3QsdFtnXT1JdCx0W2crMV09X3QsdFt2XT1UdCx0W3YrMV09UHR9fX1fc2luZ2xlVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZSsxXSx1PWlbZStzXSxjPWlbZStzKzFdLGg9byt1LGY9YStjLGQ9by11LGw9YS1jO3JbdF09aCxyW3QrMV09ZixyW3QrMl09ZCxyW3QrM109bH1fc2luZ2xlVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlKzFdLGY9aVtlK3NdLGQ9aVtlK3MrMV0sbD1pW2UrYV0scD1pW2UrYSsxXSxtPWlbZSt1XSxJPWlbZSt1KzFdLGc9YytsLHY9aCtwLHc9Yy1sLFA9aC1wLFM9ZittLFY9ZCtJLE09byooZi1tKSx4PW8qKGQtSSkseT1nK1MsQT12K1YsVz13K3gsTj1QLU0sRT1nLVMsTz12LVYsRj13LXgsRD1QK007clt0XT15LHJbdCsxXT1BLHJbdCsyXT1XLHJbdCszXT1OLHJbdCs0XT1FLHJbdCs1XT1PLHJbdCs2XT1GLHJbdCs3XT1EfV9yZWFsVHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IE10PXVbYV07dGhpcy5fc2luZ2xlUmVhbFRyYW5zZm9ybTIobyxNdD4+PjEscj4+PjEpfWVsc2UgZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCBNdD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm00KG8sTXQ+Pj4xLHI+Pj4xKX12YXIgYz10aGlzLl9pbnY/LTE6MSxoPXRoaXMudGFibGU7Zm9yKHI+Pj0yO3I+PTI7cj4+PTIpe2k9ZS9yPDwxO3ZhciBmPWk+Pj4xLGQ9Zj4+PjEsbD1kPj4+MTtmb3Iobz0wO288ZTtvKz1pKWZvcih2YXIgcD0wLG09MDtwPD1sO3ArPTIsbSs9cil7dmFyIEk9bytwLGc9SStkLHY9ZytkLHc9ditkLFA9dFtJXSxTPXRbSSsxXSxWPXRbZ10sTT10W2crMV0seD10W3ZdLHk9dFt2KzFdLEE9dFt3XSxXPXRbdysxXSxOPVAsRT1TLE89aFttXSxGPWMqaFttKzFdLEQ9VipPLU0qRixMPVYqRitNKk8sQz1oWzIqbV0sZXQ9YypoWzIqbSsxXSxzdD14KkMteSpldCxydD14KmV0K3kqQyxudD1oWzMqbV0saXQ9YypoWzMqbSsxXSxvdD1BKm50LVcqaXQsYXQ9QSppdCtXKm50LCQ9TitzdCxHPUUrcnQsY3Q9Ti1zdCx1dD1FLXJ0LFE9RCtvdCxKPUwrYXQsaHQ9YyooRC1vdCksbHQ9YyooTC1hdCksYnQ9JCtRLEl0PUcrSixfdD1jdCtsdCxCdD11dC1odDtpZih0W0ldPWJ0LHRbSSsxXT1JdCx0W2ddPV90LHRbZysxXT1CdCxwPT09MCl7dmFyIHd0PSQtUSxUdD1HLUo7dFt2XT13dCx0W3YrMV09VHQ7Y29udGludWV9aWYocCE9PWwpe3ZhciBQdD1jdCxnZT0tdXQsYmU9JCxJZT0tRyxfZT0tYypsdCxCZT0tYypodCx3ZT0tYypKLFRlPS1jKlEsUGU9UHQrX2UsTWU9Z2UrQmUsU2U9YmUrVGUsVmU9SWUtd2UsQ3Q9bytkLXAsUnQ9bytmLXA7dFtDdF09UGUsdFtDdCsxXT1NZSx0W1J0XT1TZSx0W1J0KzFdPVZlfX19fV9zaW5nbGVSZWFsVHJhbnNmb3JtMih0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89aVtlXSxhPWlbZStzXSx1PW8rYSxjPW8tYTtyW3RdPXUsclt0KzFdPTAsclt0KzJdPWMsclt0KzNdPTB9X3NpbmdsZVJlYWxUcmFuc2Zvcm00KHQsZSxzKXtjb25zdCByPXRoaXMuX291dCxpPXRoaXMuX2RhdGEsbz10aGlzLl9pbnY/LTE6MSxhPXMqMix1PXMqMyxjPWlbZV0saD1pW2Urc10sZj1pW2UrYV0sZD1pW2UrdV0sbD1jK2YscD1jLWYsbT1oK2QsST1vKihoLWQpLGc9bCttLHY9cCx3PS1JLFA9bC1tLFM9cCxWPUk7clt0XT1nLHJbdCsxXT0wLHJbdCsyXT12LHJbdCszXT13LHJbdCs0XT1QLHJbdCs1XT0wLHJbdCs2XT1TLHJbdCs3XT1WfX1sZXQgRHQ9bj0+Y29uc29sZS5sb2cobik7Y29uc3QgenQ9KC4uLm4pPT5EdCguLi5uKSxXdD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFN0PW49Pm4vKDErbikscXQ9KG4sdCk9PihuJXQrdCkldCxMdD0obix0KT0+KDErdCkqbi8oMSt0Kk1hdGguYWJzKG4pKSxZPShuLHQpPT5NYXRoLnRhbmgobiooMSt0KSksWXQ9KG4sdCk9Pld0KCgxK3QpKm4sLTEsMSksVnQ9KG4sdCk9PntsZXQgZT0oMSsuNSp0KSpuO2NvbnN0IHM9cXQoZSsxLDQpO3JldHVybiAxLU1hdGguYWJzKHMtMil9LGp0PShuLHQpPT5NYXRoLnNpbihNYXRoLlBJLzIqVnQobix0KSksSHQ9KG4sdCk9Pntjb25zdCBlPVN0KE1hdGgubG9nMXAodCkpLHM9KG4tZS8zKm4qbipuKS8oMS1lLzMpO3JldHVybiBZKHMsdCl9LHh0PShuLHQsZT0hMSk9Pntjb25zdCBzPTErMip0LGk9LjA3KlN0KE1hdGgubG9nMXAodCkpLG89WShuK2ksMip0KSxhPVkoZT9pOi1uK2ksMip0KSx1PW8tYSxjPTEvTWF0aC5jb3NoKHMqaSksaD1jKmMsZj1NYXRoLm1heCgxZS04LChlPzE6MikqcypoKTtyZXR1cm4gWSh1L2YsdCl9LHl0PXtzY3VydmU6THQsc29mdDpZLGhhcmQ6WXQsY3ViaWM6SHQsZGlvZGU6eHQsYXN5bToobix0KT0+eHQobix0LCEwKSxmb2xkOlZ0LHNpbmVmb2xkOmp0LGNoZWJ5c2hldjoobix0KT0+e2NvbnN0IGU9MTAqTWF0aC5sb2cxcCh0KTtsZXQgcz0xLHI9bixpLG89MDtmb3IobGV0IGE9MTthPDY0O2ErKyl7aWYoYTwyKXtvKz1hPT0wP3M6cjtjb250aW51ZX1pPTIqbipzLXIscj1zLHM9aSxhJTI9PT0wJiYobys9TWF0aC5taW4oMS4zKmUvYSwyKSppKX1yZXR1cm4gWShvLGUvMjApfX0sWD1PYmplY3QuZnJlZXplKE9iamVjdC5rZXlzKHl0KSksS3Q9bj0+e2xldCB0PW47dHlwZW9mIG49PSJzdHJpbmciJiYodD1YLmluZGV4T2YobiksdD09PS0xJiYoenQoYFtzdXBlcmRvdWdoXSBDb3VsZCBub3QgZmluZCB3YXZlc2hhcGluZyBhbGdvcml0aG0gJHtufS4KICAgICAgICBBdmFpbGFibGUgb3B0aW9ucyBhcmUgJHtYLmpvaW4oIiwgIil9LgogICAgICAgIERlZmF1bHRpbmcgdG8gJHtYWzBdfS5gKSx0PTApKTtjb25zdCBlPVhbdCVYLmxlbmd0aF07cmV0dXJuIHl0W2VdfSxqPTEyOCxSPU1hdGguUEksaz0yKlIscT0xL3NhbXBsZVJhdGUsVD0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLFV0PShuLHQsZSk9PmUqKHQtbikrbixiPShuLHQpPT5uW3RdPz9uWzBdLEg9bj0+bi1NYXRoLmZsb29yKG4pLEs9bj0+bnwwLFU9bj0+SyhuKy41KSxadD1uPT5LKG4rMSksQXQ9bj0+bi1LKG4pLHo9bj0+e2NvbnN0IHQ9bioqMjtyZXR1cm4gbiooMjcrdCkvKDI3KzkqdCl9LE50PShuLHQpPT57aWYobjwyKXJldHVybiByPT4wO2NvbnN0IGU9dC8obi0xKSxzPXQqLjU7cmV0dXJuIHI9PnIqZS1zfSxaPShuLHQpPT5uKk1hdGgucG93KDIsdC8xMik7ZnVuY3Rpb24gJHQobix0KXt0PU1hdGgubWluKHQsMS10KTtjb25zdCBlPTEvdDtyZXR1cm4gbjx0PyhuKj1lLDIqbi1uKioyLTEpOm4+MS10PyhuPShuLTEpKmUsbioqMisyKm4rMSk6MH1jb25zdCBkdD17dHJpKG4sdD0uNSl7Y29uc3QgZT0xLXQ7cmV0dXJuIG4+PXQ/MS9lLW4vZTpuL3R9LHNpbmUobil7cmV0dXJuIE1hdGguc2luKGsqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPVQodFtzXSwwLDEpLGE9VCh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtJHQobix0KX19LEd0PU9iamVjdC5rZXlzKGR0KTtjbGFzcyBRdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ0aW1lIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6InNrZXciLGRlZmF1bHRWYWx1ZTouNX0se25hbWU6ImRlcHRoIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InBoYXNlb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6InNoYXBlIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImN1cnZlIixkZWZhdWx0VmFsdWU6MX0se25hbWU6ImRjb2Zmc2V0IixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1pbiIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJtYXgiLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucGhhc2V9aW5jcmVtZW50UGhhc2UodCl7dGhpcy5waGFzZSs9dCx0aGlzLnBoYXNlPjEmJih0aGlzLnBoYXNlPXRoaXMucGhhc2UtMSl9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1zLmJlZ2luWzBdO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cilyZXR1cm4hMDtjb25zdCBpPWVbMF0sbz1zLmZyZXF1ZW5jeVswXSxhPXMudGltZVswXSx1PXMuZGVwdGhbMF0sYz1zLnNrZXdbMF0saD1zLnBoYXNlb2Zmc2V0WzBdLGY9cy5jdXJ2ZVswXSxkPXMuZGNvZmZzZXRbMF0sbD1zLm1pblswXSxwPXMubWF4WzBdLG09R3Rbcy5zaGFwZVswXV0sST1pWzBdLmxlbmd0aD8/MDt0aGlzLnBoYXNlPT1udWxsJiYodGhpcy5waGFzZT1BdChhKm8raCkpO2NvbnN0IGc9bypxO2ZvcihsZXQgdj0wO3Y8STt2Kyspe2ZvcihsZXQgdz0wO3c8aS5sZW5ndGg7dysrKXtsZXQgUD0oZHRbbV0odGhpcy5waGFzZSxjKStkKSp1O1A9TWF0aC5wb3coUCxmKSxpW3ddW3ZdPVQoUCxsLHApfXRoaXMuaW5jcmVtZW50UGhhc2UoZyl9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsZm8tcHJvY2Vzc29yIixRdCk7Y2xhc3MgSnQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY29hcnNlIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNvYXJzZVswXT8/MDthPU1hdGgubWF4KDEsYSk7Zm9yKGxldCB1PTA7dTxqO3UrKylmb3IobGV0IGM9MDtjPHIubGVuZ3RoO2MrKylpW2NdW3VdPXUlYT09PTA/cltjXVt1XTppW2NdW3UtMV07cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjb2Fyc2UtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY3J1c2giLGRlZmF1bHRWYWx1ZTowfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuY3J1c2hbMF0/Pzg7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8ajt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspe2NvbnN0IGg9TWF0aC5wb3coMixhLTEpO2lbY11bdV09TWF0aC5yb3VuZChyW2NdW3VdKmgpL2h9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjcnVzaC1wcm9jZXNzb3IiLFh0KTtjbGFzcyB0ZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5zaGFwZVswXTthPWE8MT9hOi45OTk5OTk5OTk2LGE9MiphLygxLWEpO2NvbnN0IHU9TWF0aC5tYXgoLjAwMSxNYXRoLm1pbigxLHMucG9zdGdhaW5bMF0pKTtmb3IobGV0IGM9MDtjPGo7YysrKWZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKWlbaF1bY109KDErYSkqcltoXVtjXS8oMSthKk1hdGguYWJzKHJbaF1bY10pKSp1O3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic2hhcGUtcHJvY2Vzc29yIix0ZSk7Y2xhc3MgT3R7czA9MDtzMT0wO3VwZGF0ZSh0LGUscz0wKXtzPVQocywwLDEpLGU9VChlLDAsc2FtcGxlUmF0ZS8yLTEpO2NvbnN0IHI9VCgyKk1hdGguc2luKGUqUipxKSwwLDEuMTQpLG89MS1NYXRoLnBvdyguNSw4KnMrMSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBPdCxuZXcgT3RdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9VChzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgZD0wO2Q8ajtkKyspdT09Im5vbmUiP2lbZl1bZF09cltmXVtkXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW2RdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW2RdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtkXT1yW2ZdW2RdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW2RdPXJbZl1bZF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsZWUpO2NsYXNzIHNlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjUwMH0se25hbWU6InEiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZHJpdmUiLGRlZmF1bHRWYWx1ZTouNjl9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMucDA9WzAsMF0sdGhpcy5wMT1bMCwwXSx0aGlzLnAyPVswLDBdLHRoaXMucDM9WzAsMF0sdGhpcy5wMzI9WzAsMF0sdGhpcy5wMzM9WzAsMF0sdGhpcy5wMzQ9WzAsMF19cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztjb25zdCBhPXMucVswXSx1PVQoTWF0aC5leHAocy5kcml2ZVswXSksLjEsMmUzKTtsZXQgYz1zLmZyZXF1ZW5jeVswXTtjPWMqaypxLGM9Yz4xPzE6Yztjb25zdCBoPU1hdGgubWluKDgsYSouMTMpO2xldCBmPTEvdSpNYXRoLm1pbigxLjc1LDEraCk7Zm9yKGxldCBkPTA7ZDxqO2QrKylmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKyl7Y29uc3QgcD10aGlzLnAzW2xdKi4zNjA4OTErdGhpcy5wMzJbbF0qLjQxNzI5K3RoaXMucDMzW2xdKi4xNzc4OTYrdGhpcy5wMzRbbF0qLjA0Mzk3MjU7dGhpcy5wMzRbbF09dGhpcy5wMzNbbF0sdGhpcy5wMzNbbF09dGhpcy5wMzJbbF0sdGhpcy5wMzJbbF09dGhpcy5wM1tsXSx0aGlzLnAwW2xdKz0oeihyW2xdW2RdKnUtaCpwKS16KHRoaXMucDBbbF0pKSpjLHRoaXMucDFbbF0rPSh6KHRoaXMucDBbbF0pLXoodGhpcy5wMVtsXSkpKmMsdGhpcy5wMltsXSs9KHoodGhpcy5wMVtsXSkteih0aGlzLnAyW2xdKSkqYyx0aGlzLnAzW2xdKz0oeih0aGlzLnAyW2xdKS16KHRoaXMucDNbbF0pKSpjLGlbbF1bZF09cCpmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGFkZGVyLXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImRpc3RvcnQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3Ioe3Byb2Nlc3Nvck9wdGlvbnM6dH0pe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMuYWxnb3JpdGhtPUt0KHQuYWxnb3JpdGhtKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2ZvcihsZXQgYT0wO2E8ajthKyspe2NvbnN0IHU9VChiKHMucG9zdGdhaW4sYSksLjAwMSwxKSxjPU1hdGguZXhwbTEoYihzLmRpc3RvcnQsYSkpO2ZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKXtjb25zdCBmPXJbaF1bYV07aVtoXVthXT11KnRoaXMuYWxnb3JpdGhtKGYsYyl9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGlzdG9ydC1wcm9jZXNzb3IiLHJlKTtjbGFzcyBuZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZT1bXX1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJwYW5zcHJlYWQiLGRlZmF1bHRWYWx1ZTouNCxtaW46MCxtYXg6MX0se25hbWU6ImZyZXFzcHJlYWQiLGRlZmF1bHRWYWx1ZTouMixtaW46MH0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjAsbWluOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZTo1LG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifV19cHJvY2Vzcyh0LGUscyl7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXSxpPXMudm9pY2VzWzBdO2ZvcihsZXQgbz0wO288clswXS5sZW5ndGg7bysrKXtjb25zdCBhPWIocy5kZXR1bmUsbyksdT1iKHMuZnJlcXNwcmVhZCxvKSxjPWIocy5wYW5zcHJlYWQsbykqLjUrLjU7bGV0IGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyksZD1iKHMuZnJlcXVlbmN5LG8pO2Q9WihkLGEvMTAwKTtjb25zdCBsPU50KGksdSk7Zm9yKGxldCBwPTA7cDxpO3ArKyl7Y29uc3QgbT1aKGQsbChwKSksST1IKG0qcSk7dGhpcy5waGFzZVtwXT10aGlzLnBoYXNlW3BdPz9NYXRoLnJhbmRvbSgpO2NvbnN0IGc9ZHQuc2F3YmxlcCh0aGlzLnBoYXNlW3BdLEkpO3JbMF1bb10rPWcqaCxyWzFdW29dKz1nKmY7bGV0IHY9dGhpcy5waGFzZVtwXStJO3Y+PTEmJih2LT0xKSx0aGlzLnBoYXNlW3BdPXY7Y29uc3Qgdz1oO2g9ZixmPXd9fXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3Nvcigic3VwZXJzYXctb3NjaWxsYXRvciIsbmUpO2NvbnN0IGllPTIwNDgscHQ9bmV3IE1hcDtmdW5jdGlvbiBvZShuKXtpZighcHQuaGFzKG4pKXtjb25zdCB0PW5ldyBGbG9hdDMyQXJyYXkobik7Zm9yKGxldCBlPTA7ZTxuO2UrKyl0W2VdPS41KigxLU1hdGguY29zKGsqZS9uKSk7cHQuc2V0KG4sdCl9cmV0dXJuIHB0LmdldChuKX1jbGFzcyBhZSBleHRlbmRzIGt0e3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOmllfSxzdXBlcih0KSx0aGlzLnRpbWVDdXJzb3I9MCx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy5pbnZmZnRTaXplPTEvdGhpcy5mZnRTaXplLHRoaXMuaGFubldpbmRvdz1vZSh0aGlzLmZmdFNpemUpLHRoaXMuZmZ0PW5ldyBFdCh0aGlzLmZmdFNpemUpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQ9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy50aW1lQ29tcGxleEJ1ZmZlcj10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLm1hZ25pdHVkZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLmZmdFNpemUvMisxKSx0aGlzLnBlYWtJbmRleGVzPW5ldyBJbnQzMkFycmF5KHRoaXMubWFnbml0dWRlcy5sZW5ndGgpLHRoaXMubmJQZWFrcz0wfXByb2Nlc3NPTEEodCxlLHMpe2xldCByPXMucGl0Y2hGYWN0b3Jbcy5waXRjaEZhY3Rvci5sZW5ndGgtMV07cjwwJiYocj1yKi4yNSkscj1NYXRoLm1heCgwLHIrMSk7Zm9yKGxldCBpPTA7aTx0aGlzLm5iSW5wdXRzO2krKylmb3IobGV0IG89MDtvPHRbaV0ubGVuZ3RoO28rKyl7Y29uc3QgYT10W2ldW29dLHU9ZVtpXVtvXTt0aGlzLmFwcGx5SGFubldpbmRvdyhhKSx0aGlzLmZmdC5yZWFsVHJhbnNmb3JtKHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIsYSksdGhpcy5jb21wdXRlTWFnbml0dWRlcygpLHRoaXMuZmluZFBlYWtzKCksdGhpcy5zaGlmdFBlYWtzKHIpLHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpLHRoaXMuZmZ0LmludmVyc2VUcmFuc2Zvcm0odGhpcy50aW1lQ29tcGxleEJ1ZmZlcix0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHUpLHRoaXMuYXBwbHlIYW5uV2luZG93KHUpfXRoaXMudGltZUN1cnNvcis9dGhpcy5ob3BTaXplfWFwcGx5SGFubldpbmRvdyh0KXtmb3IobGV0IGU9MDtlPHRoaXMuYmxvY2tTaXplO2UrKyl0W2VdKj10aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2xldCB0PTAsZT0wO2Zvcig7dDx0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyl7Y29uc3Qgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDtsZXQgdD0yO2NvbnN0IGU9dGhpcy5tYWduaXR1ZGVzLmxlbmd0aC0yO2Zvcig7dDxlOyl7Y29uc3Qgcz10aGlzLm1hZ25pdHVkZXNbdF07aWYodGhpcy5tYWduaXR1ZGVzW3QtMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0LTJdPj1zKXt0Kys7Y29udGludWV9aWYodGhpcy5tYWduaXR1ZGVzW3QrMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0KzJdPj1zKXt0Kys7Y29udGludWV9dGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3NdPXQsdGhpcy5uYlBlYWtzKyssdCs9Mn19c2hpZnRQZWFrcyh0KXt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZC5maWxsKDApO2ZvcihsZXQgZT0wO2U8dGhpcy5uYlBlYWtzO2UrKyl7Y29uc3Qgcz10aGlzLnBlYWtJbmRleGVzW2VdLHI9VShzKnQpO2lmKHI+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgaT0wLG89dGhpcy5mZnRTaXplO2U+MCYmKGk9cy1VKChzLXRoaXMucGVha0luZGV4ZXNbZS0xXSkvMikpLGU8dGhpcy5uYlBlYWtzLTEmJihvPXMrWnQoKHRoaXMucGVha0luZGV4ZXNbZSsxXS1zKS8yKSk7Y29uc3QgYT1pLXMsdT1vLXMsYz1rKnRoaXMuaW52ZmZ0U2l6ZSooci1zKSxoPU1hdGguY29zKGMqdGhpcy50aW1lQ3Vyc29yKSxmPU1hdGguc2luKGMqdGhpcy50aW1lQ3Vyc29yKTtmb3IobGV0IGQ9YTtkPHU7ZCsrKXtjb25zdCBsPXMrZCxwPXIrZDtpZihwPj10aGlzLm1hZ25pdHVkZXMubGVuZ3RoKWJyZWFrO2NvbnN0IG09MipsLEk9bSsxLGc9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlclttXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbSV0sdz1nKmgtdipmLFA9ZypmK3YqaCxTPTIqcCxWPVMrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtTXSs9dyx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtWXSs9UH19fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLGFlKTtjbGFzcyBjZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGk9LVIsdGhpcy5ZMD0wLHRoaXMuWTE9MCx0aGlzLlBXPVIsdGhpcy5CPTIuMyx0aGlzLmRwaGlmPTAsdGhpcy5lbnZmPTB9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJwdWxzZXdpZHRoIixkZWZhdWx0VmFsdWU6MSxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXTtsZXQgaT0xLG87Zm9yKGxldCBhPTA7YTwoclswXS5sZW5ndGg/PzApO2ErKyl7Y29uc3QgdT0oMS1UKGIocy5wdWxzZXdpZHRoLGEpLC0uOTksLjk5KSkqUixjPWIocy5kZXR1bmUsYSksaD1aKGIocy5mcmVxdWVuY3ksYSksYy8xMDApO289aCprKnEsdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49UiYmKHRoaXMucGhpLT1rKTtsZXQgZj1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMCk7dGhpcy5ZMD0uNSooZit0aGlzLlkwKTtsZXQgZD1NYXRoLmNvcyh0aGlzLnBoaSt0aGlzLkIqdGhpcy5ZMSt1KTt0aGlzLlkxPS41KihkK3RoaXMuWTEpO2ZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXJbbF1bYV09LjE1KihmLWQpKnRoaXMuZW52Zn1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInB1bHNlLW9zY2lsbGF0b3IiLGNlKTtjb25zdCBtdD17Yml0QzpmdW5jdGlvbihuLHQsZSl7cmV0dXJuIG4mdD9lOjB9LGJyOmZ1bmN0aW9uKG4sdD04KXtpZih0PjMyKXRocm93IG5ldyBFcnJvcigiYnIoKSBTaXplIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gMzIiKTtsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dDtzKyspZXw9bXQuYml0QyhuLDE8PHMsMTw8dC0ocysxKSk7cmV0dXJuIGV9LHNpbmY6ZnVuY3Rpb24obil7cmV0dXJuIE1hdGguc2luKG4qUi8xMjgpfSxjb3NmOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLmNvcyhuKlIvMTI4KX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obipSLzEyOCl9LHJlZ0c6ZnVuY3Rpb24obix0KXtyZXR1cm4gdC50ZXN0KG4udG9TdHJpbmcoMikpfX07bGV0IHR0LHZ0O2Z1bmN0aW9uIHVlKG4pe2lmKHR0PT1udWxsKXt0dD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhNYXRoKSx2dD10dC5tYXAocz0+TWF0aFtzXSk7Y29uc3QgdD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhtdCksZT10Lm1hcChzPT5tdFtzXSk7dHQucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSx2dC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLnR0LCJ0IixgcmV0dXJuIDAsCiR7bnx8MH07YCkuYmluZChnbG9iYWxUaGlzLC4uLnZ0KX1jbGFzcyBoZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5wb3J0Lm9ubWVzc2FnZT10PT57bGV0e2NvZGVUZXh0OmV9PXQuZGF0YTtjb25zdHtieXRlQmVhdFN0YXJ0VGltZTpzfT10LmRhdGE7cyE9bnVsbCYmKHRoaXMudD0wLHRoaXMuaW5pdGlhbE9mZnNldD1NYXRoLmZsb29yKHMpKSxlPWUudHJpbSgpLnJlcGxhY2UoL15ldmFsXCh1bmVzY2FwZVwoZXNjYXBlKD86YHxcKCd8XCgifFwoYCkoLio/KSg/OmB8J1wpfCJcKXxgXCkpLnJlcGxhY2VcKFwvdVwoXC5cLlwpXC9nLFsiJ2BdXCQxJVsiJ2BdXClcKVwpJC8sKHIsaSk9PnVuZXNjYXBlKGVzY2FwZShpKS5yZXBsYWNlKC91KC4uKS9nLCIkMSUiKSkpLHRoaXMuZnVuYz11ZShlKX0sdGhpcy5pbml0aWFsT2Zmc2V0PTAsdGhpcy50PW51bGwsdGhpcy5mdW5jPW51bGx9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7dGhpcy50PT1udWxsJiYodGhpcy50PXMuYmVnaW5bMF0qc2FtcGxlUmF0ZSk7Y29uc3Qgcj1lWzBdLGk9MjU2KnE7Zm9yKGxldCBvPTA7bzxyWzBdLmxlbmd0aDtvKyspe2NvbnN0IGE9YihzLmRldHVuZSxvKSx1PVooYihzLmZyZXF1ZW5jeSxvKSxhLzEwMCksYz1pKnUqdGhpcy50K3RoaXMuaW5pdGlhbE9mZnNldCxmPSh0aGlzLmZ1bmMoYykmMjU1KS8xMjcuNS0xLGQ9VChmKi4yLC0uNCwuNCk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVtvXT1kO3RoaXMudCsrfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsaGUpO2NsYXNzIGxlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJhdHRhY2siLGRlZmF1bHRWYWx1ZTouMDA1LG1pblZhbHVlOjB9LHtuYW1lOiJkZWNheSIsZGVmYXVsdFZhbHVlOi4xNCxtaW5WYWx1ZTowfSx7bmFtZToic3VzdGFpbiIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6MCxtYXhWYWx1ZToxfSx7bmFtZToicmVsZWFzZSIsZGVmYXVsdFZhbHVlOi4xLG1pblZhbHVlOjB9LHtuYW1lOiJhdHRhY2tDdXJ2ZSIsZGVmYXVsdFZhbHVlOjAsbWluVmFsdWU6LTEsbWF4VmFsdWU6MX0se25hbWU6ImRlY2F5Q3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJyZWxlYXNlQ3VydmUiLGRlZmF1bHRWYWx1ZTowLG1pblZhbHVlOi0xLG1heFZhbHVlOjF9LHtuYW1lOiJwZWFrIixkZWZhdWx0VmFsdWU6MX0se25hbWU6InJldHJpZ2dlciIsZGVmYXVsdFZhbHVlOjEsbWluVmFsdWU6MCxtYXhWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMudmFsPTAsdGhpcy5zZWdJZHg9MCx0aGlzLnN0YXRlPTAsdGhpcy5iZWdpblRpbWU9MCx0aGlzLmVuZFRpbWU9MCx0aGlzLmF0dGFja1N0YXJ0PTB9X3dhcnAodCxlLHM9OCl7aWYodD09PTB8fHQ9PT0xKXJldHVybiB0O2lmKGU+MCl7Y29uc3Qgcj0xK3MqZTtyZXR1cm4gMS1NYXRoLnBvdygxLXQscil9ZWxzZXtjb25zdCByPTEtcyplO3JldHVybiBNYXRoLnBvdyh0LHIpfX1fYWR2YW5jZSh0LGUscyxyKXtpZihzPT09MHx8dD09PWUpdGhpcy52YWw9ZTtlbHNle2NvbnN0IGk9TWF0aC5taW4oMSwoY3VycmVudFRpbWUtdGhpcy5iZWdpblRpbWUpL3MpLG89dGhpcy5fd2FycChpLHIpO3RoaXMudmFsPXQrKGUtdCkqb319cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj1lWzBdWzBdO2lmKCFyKXJldHVybiEwO2NvbnN0IGk9YihzLmJlZ2luLDApLG89YihzLnJldHJpZ2dlciwwKT49LjU7aSE9PXRoaXMuYmVnaW5UaW1lJiYodGhpcy5zdGF0ZT09PTB8fG8pJiYodGhpcy5iZWdpblRpbWU9aSx0aGlzLnN0YXRlPTEsdGhpcy5lbmRUaW1lPWIocy5lbmQsMCksdGhpcy5hdHRhY2tTdGFydD10aGlzLnZhbCk7Y29uc3QgYT10aGlzLmVuZFRpbWUtdGhpcy5iZWdpblRpbWU7Zm9yKGxldCB1PTA7dTxyLmxlbmd0aDt1Kyspe2NvbnN0IGM9YihzLmF0dGFjayx1KSxoPWIocy5kZWNheSx1KSxmPWIocy5zdXN0YWluLHUpLGQ9YihzLnJlbGVhc2UsdSksbD1iKHMuYXR0YWNrQ3VydmUsdSkscD1iKHMuZGVjYXlDdXJ2ZSx1KSxtPWIocy5yZWxlYXNlQ3VydmUsdSksST1iKHMucGVhayx1KSxnPVt7dGltZTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksc3RhcnQ6MCx0YXJnZXQ6MH0se3RpbWU6YyxzdGFydDp0aGlzLmF0dGFja1N0YXJ0LHRhcmdldDoxLGN1cnZlOmx9LHt0aW1lOmMraCxzdGFydDoxLHRhcmdldDpmLGN1cnZlOnB9LHt0aW1lOmEsc3RhcnQ6Zix0YXJnZXQ6Zn0se3RpbWU6YStkLHN0YXJ0OmYsdGFyZ2V0OjAsY3VydmU6bX1dO2xldHt0aW1lOnYsc3RhcnQ6dyx0YXJnZXQ6UCxjdXJ2ZTpTfT1nW3RoaXMuc3RhdGVdO2Zvcih0aGlzLl9hZHZhbmNlKHcsUCx2LFMpO2N1cnJlbnRUaW1lLXRoaXMuYmVnaW5UaW1lPj12Oyl0aGlzLnN0YXRlPSh0aGlzLnN0YXRlKzEpJWcubGVuZ3RoLHY9Z1t0aGlzLnN0YXRlXS50aW1lO3JbdV09dGhpcy52YWwqSX1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoImVudmVsb3BlLXByb2Nlc3NvciIsbGUpO2NvbnN0IEI9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gZmUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBGdD1uPT4oZmUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBkZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBwZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1GdCh0KSxyPUZ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBtZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKnBlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IGd0PXt9O2NsYXNzIHZlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxLGF1dG9tYXRpb25SYXRlOiJrLXJhdGUifSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhZ3RbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgZD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspZFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBkfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha31ndFtpXT1vfXRoaXMudGFibGVzPWd0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOlUoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIEIuTk9ORTpyZXR1cm4gdDtjYXNlIEIuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBCLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsQi5BU1lNKSk7Y2FzZSBCLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIEIuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIEIuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgQi5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqKjIpO3JldHVybiB0KnIlMX1jYXNlIEIuUVVBTlQ6e2NvbnN0e246cn09dGhpcy5fdG9CaXRzKGUpO3JldHVybiBLKHQqcikvcn1jYXNlIEIuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsVSg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoQXQoaSp0KS0uNSkqMn1jYXNlIEIuUFdNOntjb25zdCByPVQoLjUrLjQ5KigyKmUtMSksMCwxKTtyZXR1cm4gdDxyP3QvciouNTouNSsodC1yKS8oMS1yKSouNX1jYXNlIEIuT1JCSVQ6e2NvbnN0IHI9LjUqZTtyZXR1cm4gSCh0K3IqTWF0aC5zaW4oayozKnQpKX1jYXNlIEIuU1BJTjp7Y29uc3Qgcj0uNSplLHtuOml9PXRoaXMuX3RvQml0cyhlLDEsNik7cmV0dXJuIEgodCtyKk1hdGguc2luKGsqaSp0KSl9Y2FzZSBCLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gVCgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgQi5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKioyPD1vO2ErPTIpaWYobyVhPT09MClyZXR1cm4hMTtyZXR1cm4hMH07bGV0e246aX09dGhpcy5fdG9CaXRzKGUsMyk7Zm9yKDshcihpKTspaSsrO3JldHVybiBLKHQqaSkvaX1jYXNlIEIuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPVUocik7Y29uc3QgaT0xPDxyLG89Syh0KmkpO3JldHVybiBkZShvLHIpL2l9Y2FzZSBCLkJST1dOSUFOOntjb25zdCByPS4yNSplKm1lKDY0KnQsNCk7cmV0dXJuIEgodCtyKX1jYXNlIEIuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIFQoYSwwLDEpfWNhc2UgQi5XT1JNSE9MRTp7Y29uc3Qgcj1UKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIEIuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErVSgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIFQociwwLDEpfWNhc2UgQi5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgQi5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKGsqdCkqZTtyZXR1cm4gSCh0K3IpfWNhc2UgQi5GTElQOnJldHVybiB0O2RlZmF1bHQ6cmV0dXJuIHR9fV9zYW1wbGVGcmFtZSh0LGUpe2NvbnN0IHM9dC5sZW5ndGgscj1lKnM7bGV0IGk9cnwwO2k+PXMmJihpPTApO2NvbnN0IG89ci1pLGE9dFtpXTtsZXQgdT1pKzE7dT49cyYmKHU9MCk7Y29uc3QgYz10W3VdO3JldHVybiBhKyhjLWEpKm99X2Nob29zZU1pcCh0KXtjb25zdCBlPVQodCwxZS02LDY0KTtsZXQgcz0wO2Zvcig7cysxPCh0aGlzLnRhYmxlcz8ubGVuZ3RofHwxKSYmZTx0aGlzLnRhYmxlc1tzXVswXS5sZW5ndGgvODspcysrO3JldHVybiBzfXByb2Nlc3ModCxlLHMpe2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtjb25zdCByPWVbMF1bMF0saT1lWzBdWzFdfHxlWzBdWzBdO2lmKCF0aGlzLnRhYmxlcylyZXR1cm4gci5maWxsKDApLGkhPT1yJiZpLnNldChyKSwhMDtjb25zdCBvPXMudm9pY2VzWzBdO2ZvcihsZXQgYT0wO2E8ci5sZW5ndGg7YSsrKXtjb25zdCB1PWIocy5kZXR1bmUsYSksYz1iKHMuZnJlcXNwcmVhZCxhKSxmPVQoYihzLnBvc2l0aW9uLGEpLDAsMSkqKHRoaXMubnVtRnJhbWVzLTEpLGQ9ZnwwLGw9Zi1kLHA9VChiKHMud2FycCxhKSwwLDEpLG09YihzLndhcnBNb2RlLGEpLEk9VChiKHMucGhhc2VyYW5kLGEpLDAsMSksZz1vPjE/VChiKHMucGFuc3ByZWFkLGEpLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpnKSx3PU1hdGguc3FydCguNSsuNSpnKTtsZXQgUD1iKHMuZnJlcXVlbmN5LGEpO1A9WihQLHUvMTAwKTtjb25zdCBTPTEvTWF0aC5zcXJ0KG8pLFY9TnQobyxjKTtmb3IobGV0IE09MDtNPG87TSsrKXtjb25zdCB4PShNJjEpPT0xO2xldCB5PXYsQT13O3gmJih5PXcsQT12KTtjb25zdCBOPVooUCxWKE0pKSpxLEU9dGhpcy5fY2hvb3NlTWlwKE4pLE89dGhpcy50YWJsZXNbRV07dGhpcy5waGFzZVtNXT10aGlzLnBoYXNlW01dPz9NYXRoLnJhbmRvbSgpKkk7Y29uc3QgRj10aGlzLl93YXJwUGhhc2UodGhpcy5waGFzZVtNXSxwLG0pLEQ9dGhpcy5fc2FtcGxlRnJhbWUoT1tkXSxGKSxMPXRoaXMuX3NhbXBsZUZyYW1lKE9bTWF0aC5taW4odGhpcy5udW1GcmFtZXMtMSxkKzEpXSxGKTtsZXQgQz1VdChELEwsbCk7bT09PUIuRkxJUCYmdGhpcy5waGFzZVtNXTxwJiYoQz0tQyksclthXSs9Qyp5KlMsaVthXSs9QypBKlMsdGhpcy5waGFzZVtNXT1IKHRoaXMucGhhc2VbTV0rTil9fXJldHVybiEwfX1yZXR1cm4gcmVnaXN0ZXJQcm9jZXNzb3IoIndhdmV0YWJsZS1vc2NpbGxhdG9yLXByb2Nlc3NvciIsdmUpLGZ0LldhcnBNb2RlPUIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGZ0LFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxmdH0pKHt9KTsK";let audioContext;const setDefaultAudioContext=()=>(audioContext=new AudioContext,audioContext),getAudioContext=()=>audioContext||setDefaultAudioContext();function getAudioContextCurrentTime(){return getAudioContext().currentTime}let noiseCache={};function getNoiseBuffer(o,e){const a=getAudioContext();if(noiseCache[o])return noiseCache[o];const l=2*a.sampleRate,u=a.createBuffer(1,l,a.sampleRate),p=u.getChannelData(0);let d=0,f,g,b,A,S,M,E;f=g=b=A=S=M=E=0;for(let F=0;F<l;F++)if(o==="white")p[F]=Math.random()*2-1;else if(o==="brown"){let $=Math.random()*2-1;p[F]=(d+.02*$)/1.02,d=p[F]}else if(o==="pink"){let $=Math.random()*2-1;f=.99886*f+$*.0555179,g=.99332*g+$*.0750759,b=.969*b+$*.153852,A=.8665*A+$*.3104856,S=.55*S+$*.5329522,M=-.7616*M-$*.016898,p[F]=f+g+b+A+S+M+E+$*.5362,p[F]*=.11,E=$*.115926}else if(o==="crackle"){const $=e*.01;Math.random()<$?p[F]=Math.random()*2-1:p[F]=0}return o!=="crackle"&&(noiseCache[o]=u),u}function getNoiseOscillator(o="white",e,a=.02){const u=getAudioContext().createBufferSource();return u.buffer=getNoiseBuffer(o,a),u.loop=!0,u.start(e),{node:u,stop:p=>u.stop(p)}}function getNoiseMix(o,e,a){const l=getNoiseOscillator("pink",a),u=drywet(o,l.node,e);return l.node.onended=()=>u.onended(),{node:u.node,stop:p=>l?.stop(p)}}const noises=["pink","white","brown","crackle"];function gainNode(o){const e=getAudioContext().createGain();return e.gain.value=o,e}function effectSend(o,e,a){const l=gainNode(a);return o.connect(l),l.connect(e),l}const getSlope=(o,e,a,l)=>l-a===0?0:(e-o)/(l-a);function getWorklet(o,e,a,l){const u=new AudioWorkletNode(o,e,l);return Object.entries(a).forEach(([p,d])=>{d!==void 0&&(u.parameters.get(p).value=d)}),u}const getParamADSR=(o,e,a,l,u,p,d,f,g,b="exponential")=>{e=nanFallback(e),a=nanFallback(a),l=nanFallback(l),u=nanFallback(u);const A=b==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";b==="exponential"&&(p=p===0?.001:p,d=d===0?.001:d);const S=d-p,M=d,E=p+l*S,F=g-f,$=Z=>{let V;if(e>Z){let K=getSlope(p,M,0,e);V=Z*K+(p>M?p:0)}else V=(Z-e)*getSlope(M,E,0,a)+M;return b==="exponential"&&(V=V||.001),V};o.setValueAtTime(p,f),e>F?o[A]($(F),g):e+a>F?(o[A]($(e),f+e),o[A]($(F),g)):(o[A]($(e),f+e),o[A]($(e+a),f+e+a),o.setValueAtTime(E,g)),o[A](p,g+u)};function getModulationShapeInput(o){return typeof o=="number"?o%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[o]??0}function getLfo(o,e,a,l={}){const{shape:u=0,...p}=l,{dcoffset:d=-.5,depth:f=1}=l,g={frequency:1,depth:f,skew:.5,phaseoffset:0,time:e,begin:e,end:a,shape:getModulationShapeInput(u),dcoffset:d,min:d*f,max:d*f+f,curve:1,...p};return getWorklet(o,"lfo-processor",g)}function getCompressor(o,e,a,l,u,p){const d={threshold:e??-3,ratio:a??10,knee:l??10,attack:u??.005,release:p??.05};return new DynamicsCompressorNode(o,d)}const getADSRValues=(o,e="linear",a)=>{const[d,f,g,b]=o;if(d==null&&f==null&&g==null&&b==null)return a??[.001,.001,1,.01];const A=g??(d!=null&&f==null||d==null&&f==null?1:.001);return[Math.max(d??0,.001),Math.max(f??0,.001),Math.min(A,1),Math.max(b??0,.01)]};function getParamLfo(o,e,a,l,u){let{defaultDepth:p=1,depth:d,dcoffset:f,...g}=u;d==null&&(d=Object.values(g).some(S=>S!=null)?p:0);let b;return d&&(b=getLfo(o,a,l,{depth:d,dcoffset:f,...g}),b.connect(e)),b}function applyParameterModulators(o,e,a,l,u,p){let{amount:d,offset:f,defaultAmount:g=1,curve:b="linear",values:A,holdEnd:S,defaultValues:M}=u;d==null&&(d=A.some(K=>K!=null)?g:0);const E=f??0,F=d+E;if(Math.abs(F-E)){const[V,K,se,z]=getADSRValues(A,b,M);getParamADSR(e,V,K,se,z,E,F,a,S,b)}const Z=getParamLfo(o,e,a,l,p);return{lfo:Z,disconnect:()=>Z?.disconnect()}}function createFilter(o,e,a,l,u,p){let{frequency:d,anchor:f,env:g,type:b,model:A,q:S=1,drive:M=.69,depth:E,depthfrequency:F,dcoffset:$=-.5,skew:Z,shape:V,rate:K,sync:se}=l,z,U;A==="ladder"?(U=getWorklet(o,"ladder-processor",{frequency:d,q:S,drive:M}),z=U.parameters.get("frequency")):(U=o.createBiquadFilter(),U.type=b,U.Q.value=S,U.frequency.value=d,z=U.frequency);const ee=[l.attack,l.decay,l.sustain,l.release],[ae,de,ke,Oe]=getADSRValues(ee,"exponential",[.005,.14,0,.1]);if([...ee,g].some(We=>We!==void 0)){g=nanFallback(g,1,!0),f=nanFallback(f,0,!0);const We=Math.abs(g),qe=We*f;let at=clamp(2**-qe*d,0,2e4),yt=clamp(2**(We-qe)*d,0,2e4);g<0&&([at,yt]=[yt,at]),getParamADSR(z,ae,de,ke,Oe,at,yt,e,a,"exponential")}se!=null&&(K=u*se);const Ae=[E,F,Z,V,K].some(We=>We!==void 0);let Pe;if(Ae){E=E??1;const We=p/u,at={depth:F??(E??1)*d,dcoffset:$,skew:Z,shape:V,frequency:K??u,min:-d+30,max:2e4-d,time:We,curve:1};Pe=getParamLfo(o,z,e,a,at)}return{filter:U,lfo:Pe}}let wetfade=o=>o<.5?1:1-(o-.5)/.5;function drywet(o,e,a=0){const l=getAudioContext();if(!a)return o;let u=l.createGain(),p=l.createGain();o.connect(u),e.connect(p),u.gain.value=wetfade(a),p.gain.value=wetfade(1-a);let d=l.createGain();return u.connect(d),p.connect(d),{node:d,onended:()=>{u.disconnect(d),p.disconnect(d),o.disconnect(u),e.disconnect(p)}}}let curves=["linear","exponential"];function getPitchEnvelope(o,e,a,l){if((e.pattack??e.pdecay??e.psustain??e.prelease??e.penv)===void 0)return;const p=nanFallback(e.penv,1,!0),d=curves[e.pcurve??0];let[f,g,b,A]=getADSRValues([e.pattack,e.pdecay,e.psustain,e.prelease],d,[.2,.001,1,.001]),S=e.panchor??b;const M=p*100,E=0-M*S,F=M-M*S;getParamADSR(o,f,g,b,A,E,F,a,l,d)}function getVibratoOscillator(o,e,a){const{vibmod:l=.5,vib:u}=e;let p;if(u>0){p=getAudioContext().createOscillator(),p.frequency.value=u;const d=getAudioContext().createGain();return d.gain.value=l*100,p.connect(d),d.connect(o),p.onended=()=>{d.disconnect(o),p.disconnect(d)},p.start(a),p}}function scheduleAtTime(o,e,a=getAudioContext()){const l=a.currentTime;webAudioTimeout(a,o,l,e)}function webAudioTimeout(o,e,a,l){const u=new ConstantSourceNode(o),p=gainNode(0);return p.connect(o.destination),u.connect(p),u.onended=()=>{try{p.disconnect()}catch{}try{u.disconnect()}catch{}e()},u.start(a),u.stop(l),u}const mod$2=(o,e=1,a="sine")=>{const l=getAudioContext();let u;noises.includes(a)?(u=l.createBufferSource(),u.buffer=getNoiseBuffer(a,2),u.loop=!0):(u=l.createOscillator(),u.type=a,u.frequency.value=o),u.start();const p=gainNode(e);return u.connect(p),{node:p,stop:d=>u.stop(d),osc:u}},fm=(o,e,a,l="sine")=>{const p=o.value*e,d=p*a;return mod$2(p,d,l)};function applyFM(o,e,a){const{fmh:l=1,fmi:u,fmenv:p="exp",fmattack:d,fmdecay:f,fmsustain:g,fmrelease:b,fmvelocity:A,fmwave:S="sine",duration:M}=e;let E,F=()=>{};if(u){const Z=getAudioContext().createGain(),V=fm(o,l,u,S);if(E=V.node,F=V.stop,![d,f,g,b,A].some(K=>K!==void 0))E.connect(o);else{const[K,se,z,U]=getADSRValues([d,f,g,b]),ee=a+M;getParamADSR(Z.gain,K,se,z,U,0,1,a,ee,p==="exp"?"exponential":"linear"),E.connect(Z),Z.connect(o)}V.osc.onended=()=>{Z.disconnect(),E.disconnect(),V.osc.disconnect()}}return{stop:F}}const __squash=o=>o/(1+o),_mod=(o,e)=>(o%e+e)%e,_scurve=(o,e)=>(1+e)*o/(1+e*Math.abs(o)),_soft=(o,e)=>Math.tanh(o*(1+e)),_hard=(o,e)=>clamp((1+e)*o,-1,1),_fold=(o,e)=>{let a=(1+.5*e)*o;const l=_mod(a+1,4);return 1-Math.abs(l-2)},_sineFold=(o,e)=>Math.sin(Math.PI/2*_fold(o,e)),_cubic=(o,e)=>{const a=__squash(Math.log1p(e)),l=(o-a/3*o*o*o)/(1-a/3);return _soft(l,e)},_diode=(o,e,a=!1)=>{const l=1+2*e,p=.07*__squash(Math.log1p(e)),d=_soft(o+p,2*e),f=_soft(a?p:-o+p,2*e),g=d-f,b=1/Math.cosh(l*p),A=b*b,S=Math.max(1e-8,(a?1:2)*l*A);return _soft(g/S,e)},_asym=(o,e)=>_diode(o,e,!0),_chebyshev=(o,e)=>{const a=10*Math.log1p(e);let l=1,u=o,p,d=0;for(let f=1;f<64;f++){if(f<2){d+=f==0?l:u;continue}p=2*o*l-u,u=l,l=p,f%2===0&&(d+=Math.min(1.3*a/f,2)*p)}return _soft(d,a/20)},distortionAlgorithms={scurve:_scurve,soft:_soft,hard:_hard,cubic:_cubic,diode:_diode,asym:_asym,fold:_fold,sinefold:_sineFold,chebyshev:_chebyshev},_algoNames=Object.freeze(Object.keys(distortionAlgorithms)),getDistortionAlgorithm=o=>{let e=o;typeof o=="string"&&(e=_algoNames.indexOf(o),e===-1&&(logger$1(`[superdough] Could not find waveshaping algorithm ${o}.
        Available options are ${_algoNames.join(", ")}.
        Defaulting to ${_algoNames[0]}.`),e=0));const a=_algoNames[e%_algoNames.length];return distortionAlgorithms[a]},getDistortion=(o,e,a)=>getWorklet(getAudioContext(),"distort-processor",{distort:o,postgain:e},{processorOptions:{algorithm:a}}),getFrequencyFromValue=(o,e=36)=>{let{note:a,freq:l,octave:u=0}=o;return a=a||e,typeof a=="string"&&(a=noteToMidi(a)),!l&&typeof a=="number"&&(l=midiToFreq$1(a)),l*=Math.pow(2,u),Number(l)},destroyAudioWorkletNode=o=>{o!=null&&(o.disconnect(),o.parameters.get("end")?.setValueAtTime(0,0))},bufferCache$1={},loadCache$2={},getCachedBuffer=o=>bufferCache$1[o];function humanFileSize$1(o,e){var a=1024;if(o<a)return o+" B";var l=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do o/=a,++u;while(o>=a);return o.toFixed(1)+" "+l[u]}function getSampleInfo(o,e){const{speed:a=1}=o,{transpose:l,url:u,index:p,midi:d,label:f}=getCommonSampleInfo(o,e);let g=Math.abs(a)*Math.pow(2,l/12);return{transpose:l,url:u,index:p,midi:d,label:f,playbackRate:g}}const getSampleBuffer=async(o,e,a)=>{let{url:l,label:u,playbackRate:p}=getSampleInfo(o,e);a&&(l=await a(l));const d=getAudioContext(),f=await loadBuffer$1(l,d,u);return o.unit==="c"&&(p=p*f.duration),{buffer:f,playbackRate:p}},getSampleBufferSource=async(o,e,a)=>{let{buffer:l,playbackRate:u}=await getSampleBuffer(o,e,a);o.speed<0&&(l=reverseBuffer(l));const d=getAudioContext().createBufferSource();d.buffer=l,d.playbackRate.value=u;const{loopBegin:f=0,loopEnd:g=1,begin:b=0,end:A=1}=o,S=b*d.buffer.duration;o.loop&&(d.loop=!0,d.loopStart=f*d.buffer.duration-S,d.loopEnd=g*d.buffer.duration-S);const E=d.buffer.duration/d.playbackRate.value,F=(A-b)*E;return{bufferSource:d,offset:S,bufferDuration:E,sliceDuration:F}},loadBuffer$1=(o,e,a,l=0)=>{const u=a?`sound "${a}:${l}"`:"sample";if(o=o.replace("#","%23"),!loadCache$2[o]){logger$1(`[sampler] load ${u}..`,"load-sample",{url:o});const p=Date.now();loadCache$2[o]=fetch(o).then(d=>d.arrayBuffer()).then(async d=>{const f=Date.now()-p,g=humanFileSize$1(d.byteLength);logger$1(`[sampler] load ${u}... done! loaded ${g} in ${f}ms`,"loaded-sample",{url:o});const b=await e.decodeAudioData(d);return bufferCache$1[o]=b,b})}return loadCache$2[o]};function reverseBuffer(o){const e=getAudioContext(),a=e.createBuffer(o.numberOfChannels,o.length,e.sampleRate);for(let l=0;l<o.numberOfChannels;l++)a.copyToChannel(o.getChannelData(l).slice().reverse(),l,l);return a}const getLoadedBuffer=o=>bufferCache$1[o];function resolveSpecialPaths(o){if(o.startsWith("bubo:")){const[e,a]=o.split(":");o=`github:Bubobubobubobubo/dough-${a}`}return o}function githubPath$2(o,e=""){if(!o.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let a=o.slice(7);a=a.endsWith("/")?a.slice(0,-1):a;let l=a.split("/"),u=l[0],p=l.length>=2?l[1]:"samples",d=l.length>=3?l[2]:"main",f=l.slice(3);return f.push(e||""),f=f.join("/"),`https://raw.githubusercontent.com/${u}/${p}/${d}/${f}`}const processSampleMap=(o,e,a=o._base||"")=>Object.entries(o).forEach(([l,u])=>{if(typeof u=="string"&&(u=[u]),typeof u!="object")throw new Error("wrong sample map format for "+l);a=u._base||a,a=resolveSpecialPaths(a),a.startsWith("github:")&&(a=githubPath$2(a,""));const p=d=>a+d;Array.isArray(u)?u=u.map(p):u=Object.fromEntries(Object.entries(u).map(([d,f])=>[d,(typeof f=="string"?[f]:f).map(p)])),e(l,u)});let resourcePrefixHandlers={};function registerSamplesPrefix(o,e){resourcePrefixHandlers[o]=e}function getSamplesPrefixHandler(o){const e=Object.entries(resourcePrefixHandlers).find(([a])=>o.startsWith(a));if(e)return e[1]}async function fetchSampleMap$1(o){const e=getSamplesPrefixHandler(o);if(e)return e(o);if(o=resolveSpecialPaths(o),o.startsWith("github:")&&(o=githubPath$2(o,"strudel.json")),o.startsWith("local:")&&(o="http://localhost:5432"),o.startsWith("shabda:")){let[u,p]=o.split("shabda:");o=`https://shabda.ndre.gr/${p}.json?strudel=1`}if(o.startsWith("shabda/speech")){let[u,p]=o.split("shabda/speech");p=p.startsWith("/")?p.substring(1):p;let[d,f]=p.split(":"),g="f",b="en-GB";d&&([b,g]=d.split("/")),o=`https://shabda.ndre.gr/speech/${f}.json?gender=${g}&language=${b}&strudel=1'`}if(typeof fetch!="function")return;const a=getBaseURL(o);if(typeof fetch>"u")return;const l=await fetch(o).then(u=>u.json()).catch(u=>{throw console.error(u),new Error(`error loading "${o}"`)});return[l,l._base||a]}const samples$1=async(o,e=o._base||"",a={})=>{if(typeof o=="string"){const[p,d]=await fetchSampleMap$1(o);return samples$1(p,e||d,a)}const{prebake:l,tag:u}=a;processSampleMap(o,(p,d)=>{registerSampleSource(p,d,{baseUrl:e,prebake:l,tag:u})},e)},cutGroups=[];async function onTriggerSample(o,e,a,l,u){let{s:p,nudge:d=0,cut:f,loop:g,clip:b=void 0,n:A=0,speed:S=1,duration:M}=e;if(S===0)return;const E=getAudioContext();let[F,$,Z,V]=getADSRValues([e.attack,e.decay,e.sustain,e.release]);const{bufferSource:K,sliceDuration:se,offset:z}=await getSampleBufferSource(e,l,u);if(E.currentTime>o){logger$1(`[sampler] still loading sound "${p}:${A}"`,"highlight");return}if(!K){logger$1(`[sampler] could not load "${p}:${A}"`,"error");return}let U=getVibratoOscillator(K.detune,e,o);const ee=o+d;K.start(ee,z);const ae=E.createGain(),de=K.connect(ae);b==null&&g==null&&e.release==null&&(M=se);let ke=o+M;getParamADSR(de.gain,F,$,Z,V,0,1,o,ke,"linear"),getPitchEnvelope(K.detune,e,o,ke);const Oe=E.createGain();de.connect(Oe),K.onended=function(){K.disconnect(),U?.stop(),de.disconnect(),Oe.disconnect(),a()};let De=ke+V+.01;K.stop(De);const Pe={node:Oe,bufferSource:K,stop:We=>{K.stop(We)}};if(f!==void 0){const We=cutGroups[f];We&&(We.node.gain.setValueAtTime(1,ee),We.node.gain.linearRampToValueAtTime(0,ee+.01)),cutGroups[f]=Pe}return Pe}function registerSample(o,e,a){registerSound(o,(l,u,p)=>onTriggerSample(l,u,p,e),{type:"sample",samples:e,...a})}function registerSampleSource(o,e,a){o.startsWith("wt_")?registerWaveTable(o,e,a):registerSample(o,e,a)}let hasChanged=(o,e)=>o!==void 0&&o!==e;class Orbit{reverbNode;delayNode;output;summingNode;djfNode;audioContext;constructor(e){this.audioContext=e,this.output=new GainNode(e,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode=new GainNode(e,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode.connect(this.output)}disconnect(){this.output.disconnect(),this.summingNode.disconnect(),this.delayNode?.disconnect(),this.reverbNode?.disconnect()}getDjf(e,a=0){this.djfNode==null&&(this.djfNode=getWorklet(this.audioContext,"djf-processor",{value:e}),this.summingNode.disconnect(),this.summingNode.connect(this.djfNode),this.djfNode.connect(this.output)),this.djfNode.parameters.get("value").setValueAtTime(e,a)}getDelay(e=0,a=.5,l){return a=clamp(a,0,.98),this.delayNode==null&&(this.delayNode=this.audioContext.createFeedbackDelay(1,e,a),this.delayNode.connect(this.summingNode),this.delayNode.start?.(l)),this.delayNode.delayTime.value!==e&&this.delayNode.delayTime.setValueAtTime(e,l),this.delayNode.feedback.value!==a&&this.delayNode.feedback.setValueAtTime(a,l),this.delayNode}getReverb(e,a,l,u,p,d,f){return this.reverbNode==null&&(this.reverbNode=this.audioContext.createReverb(e,a,l,u,p,d,f),this.reverbNode.connect(this.summingNode)),(hasChanged(e,this.reverbNode.duration)||hasChanged(a,this.reverbNode.fade)||hasChanged(l,this.reverbNode.lp)||hasChanged(u,this.reverbNode.dim)||hasChanged(d,this.reverbNode.irspeed)||hasChanged(f,this.reverbNode.irbegin)||this.reverbNode.ir!==p)&&this.reverbNode.generate(e,a,l,u,p,d,f),this.reverbNode}sendReverb(e,a){return effectSend(e,this.reverbNode,a)}sendDelay(e,a){return effectSend(e,this.delayNode,a)}duck(e,a=0,l=.1,u=1){const p=a,d=Math.max(l,.002),f=this.output.gain;webAudioTimeout(this.audioContext,()=>{const g=this.audioContext.currentTime,b=f.value;f.cancelScheduledValues(g),f.setValueAtTime(b,g);const A=Math.max(e,g),S=clamp(1-Math.sqrt(u),.01,b);f.exponentialRampToValueAtTime(S,A+p),f.exponentialRampToValueAtTime(1,A+p+d)},0,e-.01)}connectToOutput(e){e.connect(this.summingNode)}}class SuperdoughOutput{channelMerger;destinationGain;constructor(e){this.audioContext=e,this.initializeAudio()}initializeAudio(){const e=this.audioContext,a=e.destination.maxChannelCount;this.audioContext.destination.channelCount=a,this.channelMerger=new ChannelMergerNode(e,{numberOfInputs:e.destination.channelCount}),this.destinationGain=new GainNode(e),this.channelMerger.connect(this.destinationGain),this.destinationGain.connect(e.destination)}reset(){this.disconnect(),this.initializeAudio()}disconnect(){this.channelMerger.disconnect(),this.destinationGain.disconnect(),this.destinationGain=null,this.channelMerger=null}connectToDestination=(e,a=[0,1])=>{const l=new StereoPannerNode(this.audioContext);e.connect(l);const u=new ChannelSplitterNode(this.audioContext,{numberOfOutputs:l.channelCount});l.connect(u),a.forEach((p,d)=>{u.connect(this.channelMerger,d%l.channelCount,p%this.audioContext.destination.channelCount)})}}class SuperdoughAudioController{audioContext;output;nodes={};constructor(e){this.audioContext=e,this.output=new SuperdoughOutput(e)}reset(){Array.from(this.nodes).forEach(e=>{e.disconnect()}),this.nodes={},this.output.reset()}duck(e,a,l=0,u=.1,p=1){const d=[e].flat(),f=[l].flat(),g=[u].flat(),b=[p].flat();d.forEach((A,S)=>{const M=this.nodes[A];if(M==null){errorLogger(new Error(`duck target orbit ${A} does not exist`),"superdough");return}const E=f[S]??f[0],F=Math.max(g[S]??g[0],.002),$=b[S]??b[0];M.duck(a,E,F,$)})}getOrbit(e,a){return this.nodes[e]==null&&(this.nodes[e]=new Orbit(this.audioContext),this.output.connectToDestination(this.nodes[e].output,a)),this.nodes[e]}}const DEFAULT_MAX_POLYPHONY=128,DEFAULT_AUDIO_DEVICE_NAME="System Standard";let maxPolyphony=DEFAULT_MAX_POLYPHONY;function setMaxPolyphony(o){maxPolyphony=parseInt(o)??DEFAULT_MAX_POLYPHONY}let multiChannelOrbits=!1;function setMultiChannelOrbits(o){multiChannelOrbits=o==!0}const soundMap$1=map();function registerSound(o,e,a={}){o=o.toLowerCase().replace(/\s+/g,"_"),soundMap$1.setKey(o,{onTrigger:e,data:a})}let gainCurveFunc=o=>o;function applyGainCurve(o){return gainCurveFunc(o)}function setGainCurve(o){gainCurveFunc=o}function aliasBankMap(o){for(const a in o)o[a.toLowerCase()]=o[a];const e=soundMap$1.get();for(const a in e){const[l,u]=a.split("_");if(!u)continue;const p=o[l];if(p){if(typeof p=="string")e[`${p}_${u}`.toLowerCase()]=e[a];else if(Array.isArray(p))for(const d of p)e[`${d}_${u}`.toLowerCase()]=e[a]}}soundMap$1.set({...e})}async function aliasBankPath(o){const a=await(await fetch(o)).json();aliasBankMap(a)}async function aliasBank(...o){switch(o.length){case 1:return typeof o[0]=="string"?aliasBankPath(o[0]):aliasBankMap(o[0]);case 2:return aliasBankMap({[o[0]]:o[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+o.length)}}function soundAlias(o,e){if(getSound(o)==null){logger$1("soundAlias: original sound not found");return}soundMap$1.setKey(e,getSound(o))}function getSound(o){return typeof o!="string"?(console.warn(`getSound: expected string got "${o}". fall back to triangle`),soundMap$1.get().triangle):soundMap$1.get()[o.toLowerCase()]}const getAudioDevices=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let o=await navigator.mediaDevices.enumerateDevices();o=o.filter(a=>a.kind==="audiooutput"&&a.deviceId!=="default");const e=new Map;return e.set(DEFAULT_AUDIO_DEVICE_NAME,""),o.forEach(a=>{e.set(a.label,a.deviceId)}),e};let defaultDefaultValues={s:"triangle",gain:.8,postgain:1,density:".03",channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const defaultDefaultDefaultValues=Object.freeze({...defaultDefaultValues});function setDefault(o,e){defaultDefaultValues[o]=e}function resetDefaults(){defaultDefaultValues={...defaultDefaultDefaultValues}}let defaultControls=new Map(Object.entries(defaultDefaultValues));function setDefaultValue(o,e){defaultControls.set(o,e)}function getDefaultValue(o){return defaultControls.get(o)}function setDefaultValues(o){Object.keys(o).forEach(e=>{setDefaultValue(e,o[e])})}function resetDefaultValues(){defaultControls=new Map(Object.entries(defaultDefaultValues))}function setVersionDefaults(o){resetDefaultValues(),o==="1.0"&&setDefaultValue("fanchor",.5)}const resetLoadedSounds=()=>soundMap$1.set({});let externalWorklets=[];function registerWorklet(o){externalWorklets.push(o)}let workletsLoading;function loadWorklets(){if(!workletsLoading){const o=getAudioContext(),e=externalWorklets.concat([workletsUrl]);workletsLoading=Promise.all(e.map(a=>o.audioWorklet.addModule(a)))}return workletsLoading}async function initAudio$1(o={}){const{disableWorklets:e=!1,maxPolyphony:a,audioDeviceName:l=DEFAULT_AUDIO_DEVICE_NAME,multiChannelOrbits:u=!1}=o;if(setMaxPolyphony(a),setMultiChannelOrbits(u),typeof window>"u")return;const p=getAudioContext();if(l!=null&&l!=DEFAULT_AUDIO_DEVICE_NAME)try{const f=(await getAudioDevices()).get(l),g=(f??"").length>0;p.sinkId!==f&&g&&await p.setSinkId(f),logger$1(`[superdough] Audio Device set to ${l}, it might take a few seconds before audio plays on all output channels`)}catch{logger$1("[superdough] failed to set audio interface","warning")}if(await p.resume(),e){logger$1("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await loadWorklets(),logger$1("[superdough] AudioWorklets loaded")}catch(d){console.warn("could not load AudioWorklet effects",d)}logger$1("[superdough] ready")}let audioReady;async function initAudioOnFirstClick(o){return audioReady||(audioReady=new Promise(e=>{document.addEventListener("mousedown",async function a(){document.removeEventListener("mousedown",a),await initAudio$1(o),e()})})),audioReady}let controller;function getSuperdoughAudioController(){return controller==null&&(controller=new SuperdoughAudioController(getAudioContext())),controller}function connectToDestination(o,e){getSuperdoughAudioController().output.connectToDestination(o,e)}function getPhaser(o,e,a=1,l=.5,u=1e3,p=2e3){const d=getAudioContext(),f=getLfo(d,o,e,{frequency:a,depth:p*2}),g=2;let b=0;const A=[];for(let S=0;S<g;S++){const M=d.createBiquadFilter();M.type="notch",M.gain.value=1,M.frequency.value=u+b,M.Q.value=2-Math.min(Math.max(l*2,0),1.9),f.connect(M.detune),b+=282,S>0&&A[S-1].connect(M),A.push(M)}return{phaser:A[A.length-1],lfo:f}}function getFilterType(o){o=o??0;const e=["12db","ladder","24db"];return typeof o=="number"?e[Math.floor(_mod$1(o,e.length))]:o}let analysers={},analysersData={};function getAnalyserById(o,e=1024,a=.5){if(!analysers[o]){const l=getAudioContext().createAnalyser();l.fftSize=e,l.smoothingTimeConstant=a,analysers[o]=l,analysersData[o]=new Float32Array(analysers[o].frequencyBinCount)}return analysers[o].fftSize!==e&&(analysers[o].fftSize=e,analysersData[o]=new Float32Array(analysers[o].frequencyBinCount)),analysers[o]}function getAnalyzerData(o="time",e=1){const a={time:()=>analysers[e]?.getFloatTimeDomainData(analysersData[e]),frequency:()=>analysers[e]?.getFloatFrequencyData(analysersData[e])}[o];if(!a)throw new Error(`getAnalyzerData: ${o} not supported. use one of ${Object.keys(a).join(", ")}`);return a(),analysersData[e]}function resetGlobalEffects(){controller?.reset(),analysers={},analysersData={}}let activeSoundSources=new Map;function mapChannelNumbers(o){return(Array.isArray(o)?o:[o]).map(e=>e-1)}const superdough=async(o,e,a,l=.5,u=.5)=>{const p=getAudioContext(),d=getSuperdoughAudioController();let{stretch:f}=o;if(f!=null&&(e=e-.04),typeof o!="object")throw new Error(`expected hap.value to be an object, but got "${o}". Hint: append .note() or .s() to the end`,"error");if(o.duration=a,e<p.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${e.toFixed(2)}, now: ${p.currentTime.toFixed(2)})`);return}let{tremolo:g,tremolosync:b,tremolodepth:A=1,tremoloskew:S,tremolophase:M=0,tremoloshape:E,s:F=getDefaultValue("s"),bank:$,source:Z,gain:V=getDefaultValue("gain"),postgain:K=getDefaultValue("postgain"),density:se=getDefaultValue("density"),duckorbit:z,duckonset:U,duckattack:ee,duckdepth:ae,djf:de,fanchor:ke=getDefaultValue("fanchor"),release:Oe=0,phaserrate:De,phaserdepth:Ae=getDefaultValue("phaserdepth"),phasersweep:Pe,phasercenter:We,coarse:qe,crush:at,dry:yt,shape:ut,shapevol:Dt=getDefaultValue("shapevol"),distort:$t,distortvol:Bt=getDefaultValue("distortvol"),distorttype:$e=getDefaultValue("distorttype"),pan:bt,vowel:nn,delay:Zt=getDefaultValue("delay"),delayfeedback:Rt=getDefaultValue("delayfeedback"),delaysync:qt=getDefaultValue("delaysync"),delaytime:Wt,orbit:tn=getDefaultValue("orbit"),room:wn,roomfade:dn,roomlp:rn,roomdim:Zn,roomsize:ln,ir:zn,irspeed:cn,irbegin:Bn,i:ei=getDefaultValue("i"),velocity:ve=getDefaultValue("velocity"),analyze:Ce,fft:_e=getDefaultValue("fft"),compressor:Ie,compressorRatio:ot,compressorKnee:ft,compressorAttack:tt,compressorRelease:Mt}=o;Wt=Wt??cycleToSeconds(qt,l);const st=mapChannelNumbers(multiChannelOrbits&&tn>0?[tn*2-1,tn*2]:getDefaultValue("channels")),Ot=o.channels!=null?mapChannelNumbers(o.channels):st,kt=d.getOrbit(tn,Ot);z!=null&&d.duck(z,e,U,ee,ae),V=applyGainCurve(nanFallback(V,1)),K=applyGainCurve(K),Dt=applyGainCurve(Dt),Bt=applyGainCurve(Bt),Zt=applyGainCurve(Zt),ve=applyGainCurve(ve),A=applyGainCurve(A),V*=ve;const on=e+a,an=on+Oe,Ut=Math.round(Math.random()*1e6);for(let xt=0;xt<=activeSoundSources.size-maxPolyphony;xt++){const Vt=activeSoundSources.entries().next(),en=Vt.value[1].deref(),sn=Vt.value[0],yn=e+.25;en?.node?.gain?.linearRampToValueAtTime(0,yn),en?.stop?.(yn),activeSoundSources.delete(sn)}let Nt=[];if(["-","~","_"].includes(F))return;$&&F&&(F=`${$}_${F}`,o.s=F);let hn;if(Z)hn=Z(e,o,a,l);else if(getSound(F)){const{onTrigger:xt}=getSound(F),en=await xt(e,o,()=>{Nt.forEach(sn=>sn?.disconnect()),activeSoundSources.delete(Ut)},l);en&&(hn=en.node,activeSoundSources.set(Ut,new WeakRef(en)))}else throw new Error(`sound ${F} not found! Is it loaded?`);if(!hn)return;if(p.currentTime>e){logger$1("[webaudio] skip hap: still loading",p.currentTime-e);return}const Ft=[];Ft.push(hn),f!==void 0&&Ft.push(getWorklet(p,"phase-vocoder-processor",{pitchFactor:f})),Ft.push(gainNode(V));const fn=getFilterType(o.ftype);if(o.cutoff!==void 0){const Vt=pickAndRename(o,{frequency:"cutoff",q:"resonance",attack:"lpattack",decay:"lpdecay",sustain:"lpsustain",release:"lprelease",env:"lpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"lprate",sync:"lpsync",depth:"lpdepth",depthfrequency:"lpdepthfrequency",shape:"lpshape",dcoffset:"lpdc",skew:"lpskew"});Vt.type="lowpass";const en=()=>createFilter(p,e,on,Vt,l,u),{filter:sn,lfo:yn}=en();if(Ft.push(sn),yn&&Nt.push(yn),fn==="24db"){const{filter:Xn,lfo:ti}=en();Ft.push(Xn),ti&&Nt.push(ti)}}if(o.hcutoff!==void 0){const Vt=pickAndRename(o,{frequency:"hcutoff",q:"hresonance",attack:"hpattack",decay:"hpdecay",sustain:"hpsustain",release:"hprelease",env:"hpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"hprate",sync:"hpsync",depth:"hpdepth",depthfrequency:"hpdepthfrequency",shape:"hpshape",dcoffset:"hpdc",skew:"hpskew"});Vt.type="highpass";const en=()=>createFilter(p,e,on,Vt,l,u),{filter:sn,lfo:yn}=en();if(Ft.push(sn),yn&&Nt.push(yn),fn==="24db"){const{filter:Xn,lfo:ti}=en();Ft.push(Xn),ti&&Nt.push(ti)}}if(o.bandf!==void 0){const Vt=pickAndRename(o,{frequency:"bandf",q:"bandq",attack:"bpattack",decay:"bpdecay",sustain:"bpsustain",release:"bprelease",env:"bpenv",anchor:"fanchor",model:"ftype",drive:"drive",rate:"bprate",sync:"bpsync",depth:"bpdepth",depthfrequency:"bpdepthfrequency",shape:"bpshape",dcoffset:"bpdc",skew:"bpskew"});Vt.type="bandpass";const en=()=>createFilter(p,e,on,Vt,l,u),{filter:sn,lfo:yn}=en();if(Ft.push(sn),yn&&Nt.push(yn),fn==="24db"){const{filter:Xn,lfo:ti}=en();Ft.push(Xn),ti&&Nt.push(ti)}}if(nn!==void 0){const xt=p.createVowelFilter(nn);Ft.push(xt)}if(qe!==void 0&&Ft.push(getWorklet(p,"coarse-processor",{coarse:qe})),at!==void 0&&Ft.push(getWorklet(p,"crush-processor",{crush:at})),ut!==void 0&&Ft.push(getWorklet(p,"shape-processor",{shape:ut,postgain:Dt})),$t!==void 0&&Ft.push(getDistortion($t,Bt,$e)),b!=null&&(g=l*b),o.wtPosSynced!=null&&(o.wtPosRate/=l),o.wtWarpSynced!=null&&(o.wtWarpRate/=l),g!==void 0){const xt=Math.max(1-A,0),Vt=new GainNode(p,{gain:xt}),en=u/l,sn=getLfo(p,e,an,{skew:S??(E!=null?.5:1),frequency:g,depth:A,time:en,dcoffset:0,shape:E,phaseoffset:M,min:0,max:1,curve:1.5});sn.connect(Vt.gain),Nt.push(sn),Ft.push(Vt)}if(Ie!==void 0&&Ft.push(getCompressor(p,Ie,ot,ft,tt,Mt)),bt!==void 0){const xt=p.createStereoPanner();xt.pan.value=2*bt-1,Ft.push(xt)}if(De!==void 0&&Ae>0){const{phaser:xt,lfo:Vt}=getPhaser(e,an,De,Ae,We,Pe);Nt.push(Vt),Ft.push(xt)}const mn=new GainNode(p,{gain:K});if(Ft.push(mn),Zt>0&&Wt>0&&Rt>0){kt.getDelay(Wt,Rt,e);const xt=kt.sendDelay(mn,Zt);Nt.push(xt)}if(wn>0){let xt;if(zn!==void 0){let en,sn=getSound(zn);Array.isArray(sn)?en=sn.data.samples[ei%sn.data.samples.length]:typeof sn=="object"&&(en=Object.values(sn.data.samples).flat()[ei%Object.values(sn.data.samples).length]),xt=await loadBuffer$1(en,p,zn,0)}kt.getReverb(ln,dn,rn,Zn,xt,cn,Bn);const Vt=kt.sendReverb(mn,wn);Nt.push(Vt)}if(de!=null&&kt.getDjf(de,e),Ce){const xt=getAnalyserById(Ce,2**(_e+5)),Vt=effectSend(mn,xt,1);Nt.push(Vt)}if(yt!=null){yt=applyGainCurve(yt);const xt=new GainNode(p,{gain:yt});Ft.push(xt),kt.connectToOutput(xt)}else kt.connectToOutput(mn);Ft.slice(1).reduce((xt,Vt)=>xt.connect(Vt),Ft[0]),Nt=Nt.concat(Ft)},superdoughTrigger=(o,e,a,l)=>{superdough(e,o-a,e.duration/l,l)},waveforms=["triangle","square","sawtooth","sine","user"],waveformAliases=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function makeSaturationCurve(o,e){const a=o,l=new Float32Array(e);for(let u=0;u<e;u++){const p=u*2/e-1;l[u]=Math.tanh(p*a)}return l}function registerSynthSounds$1(){[...waveforms].forEach(o=>{registerSound(o,(e,a,l)=>{const[u,p,d,f]=getADSRValues([a.attack,a.decay,a.sustain,a.release],"linear",[.001,.05,.6,.01]),g=gainNode(.3);let b=getOscillator(o,e,a,()=>{g.disconnect(),l()}),{node:A,stop:S,triggerRelease:M}=b;const{duration:E}=a,F=gainNode(1);let $=A.connect(g).connect(F);const Z=e+E;getParamADSR($.gain,u,p,d,f,0,1,e,Z,"linear");const V=Z+f+.01;return M?.(V),S(V),{node:$,stop:K=>{S(K)}}},{type:"synth",prebake:!0})}),registerSound("sbd",(o,e,a)=>{const{duration:l,decay:u=.5,pdecay:p=.5,penv:d=36,clip:f}=e,g=getAudioContext(),b=.02,A=1.2,S=.025,M=1,E=g.createOscillator();E.type="triangle",E.frequency.value=getFrequencyFromValue(e,29),E.detune.setValueAtTime(d*100,0),E.detune.setValueAtTime(d*100,o),E.detune.exponentialRampToValueAtTime(.001,o+p);const F=gainNode(1);F.gain.setValueAtTime(1,o+b),F.gain.exponentialRampToValueAtTime(.001,o+b+u),E.start(o);const $=getNoiseOscillator("brown",o,2),Z=gainNode(1);Z.gain.setValueAtTime(A,o),Z.gain.exponentialRampToValueAtTime(.001,o+S);const V=new WaveShaperNode(g);V.curve=makeSaturationCurve(2,g.sampleRate);const K=gainNode(M);E.onended=()=>{E.disconnect(),F.disconnect(),V.disconnect(),$.node.disconnect(),Z.disconnect(),K.disconnect(),a()};const se=E.connect(V).connect(F).connect(K);$.node.connect(Z).connect(K);let U=o+u+.01;return f!=null&&(U=Math.min(o+f*l,U)),K.gain.setValueAtTime(M,U-.01),K.gain.linearRampToValueAtTime(0,U),E.stop(U),$.stop(U),{node:se,stop:ee=>{E.stop(ee)}}},{type:"synth",prebake:!0}),registerSound("supersaw",(o,e,a)=>{const l=getAudioContext();let{duration:u,n:p,unison:d=5,spread:f=.6,detune:g}=e;g=g??p??.18;const b=getFrequencyFromValue(e),[A,S,M,E]=getADSRValues([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),F=o+u,$=F+E+.01,Z=clamp(d,1,100);let V=Z>1?clamp(f,0,1):0,K=getWorklet(l,"supersaw-oscillator",{frequency:b,begin:o,end:$,freqspread:g,voices:Z,panspread:V},{outputChannelCount:[2]});const se=1/Math.sqrt(Z);getPitchEnvelope(K.parameters.get("detune"),e,o,F);const z=getVibratoOscillator(K.parameters.get("detune"),e,o),U=applyFM(K.parameters.get("frequency"),e,o);let ee=gainNode(1);ee=K.connect(ee),getParamADSR(ee.gain,A,S,M,E,0,.3*se,o,F,"linear");let ae=webAudioTimeout(l,()=>{destroyAudioWorkletNode(K),ee.disconnect(),a(),U?.stop(),z?.stop()},o,$);return{node:ee,stop:de=>{ae.stop(de)}}},{prebake:!0,type:"synth"}),registerSound("bytebeat",(o,e,a)=>{const l=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:u=0}=e,p=getFrequencyFromValue(e),{byteBeatExpression:d=l[u%l.length],byteBeatStartTime:f}=e,g=getAudioContext();let{duration:b}=e;const[A,S,M,E]=getADSRValues([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),F=o+b,$=F+E+.01;let Z=getWorklet(g,"byte-beat-processor",{frequency:p,begin:o,end:$},{outputChannelCount:[2]});Z.port.postMessage({codeText:d,byteBeatStartTime:f,frequency:p});let V=gainNode(1);V=Z.connect(V),getParamADSR(V.gain,A,S,M,E,0,1,o,F,"linear");let K=webAudioTimeout(g,()=>{destroyAudioWorkletNode(Z),V.disconnect(),a()},o,$);return{node:V,stop:se=>{K.stop(se)}}},{prebake:!0,type:"synth"}),registerSound("pulse",(o,e,a)=>{const l=getAudioContext();let{pwrate:u,pwsweep:p}=e;p==null&&(u!=null?p=.3:p=0),u==null&&p!=null&&(u=1);let{duration:d,pw:f=.5}=e;const g=getFrequencyFromValue(e),[b,A,S,M]=getADSRValues([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),E=o+d,F=E+M+.01;let $=getWorklet(l,"pulse-oscillator",{frequency:g,begin:o,end:F,pulsewidth:f},{outputChannelCount:[2]});getPitchEnvelope($.parameters.get("detune"),e,o,E);const Z=getVibratoOscillator($.parameters.get("detune"),e,o),V=applyFM($.parameters.get("frequency"),e,o);let K=gainNode(1);K=$.connect(K),getParamADSR(K.gain,b,A,S,M,0,1,o,E,"linear");let se;p!=0&&(se=getLfo(l,o,F,{frequency:u,depth:p}),se.connect($.parameters.get("pulsewidth")));let z=webAudioTimeout(l,()=>{destroyAudioWorkletNode($),destroyAudioWorkletNode(se),K.disconnect(),a(),V?.stop(),Z?.stop()},o,F);return{node:K,stop:U=>{z.stop(U)}}},{prebake:!0,type:"synth"}),[...noises].forEach(o=>{registerSound(o,(e,a,l)=>{const[u,p,d,f]=getADSRValues([a.attack,a.decay,a.sustain,a.release],"linear",[.001,.05,.6,.01]);let g,{density:b}=a;g=getNoiseOscillator(o,e,b);let{node:A,stop:S,triggerRelease:M}=g;const E=gainNode(.3),{duration:F}=a;A.onended=()=>{A.disconnect(),E.disconnect(),l()};const $=gainNode(1);let Z=A.connect(E).connect($);const V=e+F;getParamADSR(Z.gain,u,p,d,f,0,1,e,V,"linear");const K=V+f+.01;return M?.(K),S(K),{node:Z,stop:se=>{S(se)}}},{type:"synth",prebake:!0})}),waveformAliases.forEach(([o,e])=>soundMap$1.set({...soundMap$1.get(),[o]:soundMap$1.get()[e]}))}const PI2=2*Math.PI;function waveformN(o,e,a){o=typeof o=="object"?o:new Float32Array(o).fill(1);const u=o.length,p=new Float32Array(u+1),d=new Float32Array(u+1),f=getAudioContext(),g=f.createOscillator(),b={sawtooth:S=>[0,-1/S],square:S=>[0,S%2===0?0:1/S],triangle:S=>[S%2===0?0:1/(S*S),0],user:S=>[0,1]};if(!b[a])throw new Error(`unknown wave type ${a}`);for(let S=0;S<u;S++){const M=o[S],[E,F]=b[a](S+1),$=e?.[S]??0;let Z=E*M,V=F*M;if($!==0){const K=Math.cos(PI2*$),se=Math.sin(PI2*$);Z=K*Z-se*V,V=se*Z+K*V}p[S+1]=Z,d[S+1]=V}const A=f.createPeriodicWave(p,d);return g.setPeriodicWave(A),g}function getOscillator(o,e,a,l){const{duration:u,noise:p=0}=a,d=a.partials??a.n;let f;o==="user"&&!d&&(logger$1("[superdough] Synth 'user' was selected, but partials not specified. Defaulting to triangle. Use pat.partials to setup custom waveform"),o="triangle"),o=o==="user"&&!d?"triangle":o,!d||d?.length===0||o==="sine"?(f=getAudioContext().createOscillator(),f.type=o||"triangle"):f=waveformN(d,a.phases,o),f.frequency.value=getFrequencyFromValue(a);let g=getVibratoOscillator(f.detune,a,e);getPitchEnvelope(f.detune,a,e,e+u);const b=applyFM(f.frequency,a,e);let A;return p&&(A=getNoiseMix(f,p,e)),f.onended=()=>{A||f.disconnect(),A?.node.disconnect(),l()},f.start(e),{node:A?.node||f,stop:S=>{b.stop(S),g?.stop(S),A?.stop(S),f.stop(S)},triggerRelease:S=>{}}}function buildSamples(o=1,e=.05,a=220,l=0,u=0,p=.1,d=0,f=1,g=0,b=0,A=0,S=0,M=0,E=0,F=0,$=0,Z=0,V=1,K=0,se=0){let z=Math.PI*2,U=getAudioContext().sampleRate,ee=Dt=>Dt>0?1:-1,ae=g*=500*z/U/U,de=a*=(1+e*2*Math.random()-e)*z/U,ke=[],Oe=0,De=0,Ae=0,Pe=1,We=0,qe=0,at=0,yt,ut;for(l=l*U+9,K*=U,u*=U,p*=U,Z*=U,b*=500*z/U**3,F*=z/U,A*=z/U,S*=U,M=M*U|0,ut=l+K+u+p+Z|0;Ae<ut;ke[Ae++]=at)++qe%($*100|0)||(at=d?d>1?d>2?d>3?Math.sin((Oe%z)**3):Math.max(Math.min(Math.tan(Oe),1),-1):1-(2*Oe/z%2+2)%2:1-4*Math.abs(Math.round(Oe/z)-Oe/z):Math.sin(Oe),at=(M?1-se+se*Math.sin(z*Ae/M):1)*ee(at)*Math.abs(at)**f*o*1*(Ae<l?Ae/l:Ae<l+K?1-(Ae-l)/K*(1-V):Ae<l+K+u?V:Ae<ut-Z?(ut-Ae-Z)/p*V:0),at=Z?at/2+(Z>Ae?0:(Ae<ut-Z?1:(ut-Ae)/Z)*ke[Ae-Z|0]/2):at),yt=(a+=g+=b)*Math.cos(F*De++),Oe+=yt-yt*E*(1-(Math.sin(Ae)+1)*1e9%2),Pe&&++Pe>S&&(a+=A,de+=A,Pe=0),M&&!(++We%M)&&(a=de,g=ae,Pe||=1);return ke}const getZZFX=(o,e)=>{let{s:a,note:l=36,freq:u,zrand:p=0,attack:d=0,decay:f=0,sustain:g=.8,release:b=.1,curve:A=1,slide:S=0,deltaSlide:M=0,pitchJump:E=0,pitchJumpTime:F=0,lfo:$=0,znoise:Z=0,zmod:V=0,zcrush:K=0,zdelay:se=0,tremolo:z=0,duration:U=.2,zzfx:ee}=o;const ae=Math.max(U-d-f,0);typeof l=="string"&&(l=noteToMidi(l)),!u&&typeof l=="number"&&(u=midiToFreq$1(l)),a=a.replace("z_","");const de=["sine","triangle","sawtooth","tan","noise"].indexOf(a)||0;A=a==="square"?0:A;const Oe=buildSamples(...ee||[.25,p,u,d,ae,b,de,A,S,M,E,F,$,Z,V,K,se,g,f,z]),De=getAudioContext(),Ae=De.createBuffer(1,Oe.length,De.sampleRate);Ae.getChannelData(0).set(Oe);const Pe=getAudioContext().createBufferSource();return Pe.buffer=Ae,Pe.start(e),{node:Pe}};function registerZZFXSounds(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(o=>{registerSound(o,(e,a,l)=>{const{node:u}=getZZFX({s:o,...a},e);return u.onended=()=>{u.disconnect(),l()},{node:u,stop:()=>{}}},{type:"synth",prebake:!0})})}let worklet;async function dspWorklet(o,e){const a=`dsp-worklet-${Date.now()}`,l=`${e}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${a}', MyProcessor);
`,p=`data:text/javascript;base64,${btoa(l)}`;await o.audioWorklet.addModule(p);const d=new AudioWorkletNode(o,a);return{node:d,stop:()=>d.port.postMessage("stop")}}const stop=()=>{worklet&&(worklet?.stop(),worklet?.node?.disconnect())};typeof window<"u"&&window.addEventListener("message",o=>{o.data==="strudel-stop"?stop():o.data?.dough&&worklet?.node.port.postMessage(o.data)});const dough=async o=>{const e=getAudioContext();stop(),worklet=await dspWorklet(e,o),worklet.node.connect(e.destination)};function doughTrigger(o,e,a,l){window.postMessage({time:l,dough:o.value,currentTime:e,duration:o.duration,cps:a})}const Warpmode=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),seenKeys=new Set;async function getPayload(o,e,a=2048){const l=`${o},${a}`;if(!seenKeys.has(l)){const p=(await loadBuffer(o,e)).getChannelData(0),d=p.length,f=Math.max(1,Math.floor(d/a)),g=new Array(f);for(let b=0;b<f;b++){const A=b*a;g[b]=p.subarray(A,A+a)}return seenKeys.add(l),{frames:g,frameLen:a,numFrames:f,key:l}}return{frameLen:a,key:l}}function humanFileSize(o,e){var a=1024;if(o<a)return o+" B";var l=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;do o/=a,++u;while(o>=a);return o.toFixed(1)+" "+l[u]}function parseWavSampleRate(o){const e=new DataView(o);let a=12;for(;a+8<=e.byteLength;){const l=String.fromCharCode(e.getUint8(a),e.getUint8(a+1),e.getUint8(a+2),e.getUint8(a+3)),u=e.getUint32(a+4,!0);if(l==="fmt ")return e.getUint32(a+12,!0);a+=8+u+(u&1)}return null}async function decodeAtNativeRate(o){const e=parseWavSampleRate(o)||44100;return await new OfflineAudioContext(1,1,e).decodeAudioData(o)}const loadCache$1={},loadBuffer=(o,e)=>{if(o=o.replace("#","%23"),!loadCache$1[o]){logger$1(`[wavetable] load table ${e}..`,"load-table",{url:o});const a=Date.now();loadCache$1[o]=fetch(o).then(l=>l.arrayBuffer()).then(async l=>{const u=Date.now()-a,p=humanFileSize(l.byteLength);return logger$1(`[wavetable] load table ${e}... done! loaded ${p} in ${u}ms`,"loaded-table",{url:o}),await decodeAtNativeRate(l)})}return loadCache$1[o]};function githubPath$1(o,e=""){if(!o.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[a,l]=o.split("github:");return l=l.endsWith("/")?l.slice(0,-1):l,l.split("/").length===2&&(l+="/main"),`https://raw.githubusercontent.com/${l}/${e}`}const _processTables=(o,e,a,l={})=>(e=o._base||e,Object.entries(o).forEach(([u,p])=>{if(u==="_base")return!1;if(typeof p=="string"&&(p=[p]),typeof p!="object")throw new Error("wrong json format for "+u);let d=e;d.startsWith("github:")&&(d=githubPath$1(d,"")),p=p.map(f=>d+f).filter(f=>f.toLowerCase().endsWith(".wav")?!0:(logger$1(`[wavetable] skipping ${f} -- wavetables must be ".wav" format`),!1)),p.length&&registerWaveTable(u,p,{baseUrl:e,frameLen:a})}));function registerWaveTable(o,e,a){registerSound(o,(l,u,p,d)=>onTriggerSynth(l,u,p,e,d,a?.frameLen??2048),{type:"wavetable",tables:e,...a})}const tables=async(o,e,a,l={})=>{if(a!==void 0)return _processTables(a,o,e);o.startsWith("github:")&&(o=githubPath$1(o,"strudel.json")),o.startsWith("local:")&&(o="http://localhost:5432");const u=getBaseURL(o);if(typeof fetch=="function"&&!(typeof fetch>"u"))return fetch(o).then(p=>p.json()).then(p=>_processTables(p,u,e,l)).catch(p=>{throw console.error(p),new Error(`error loading "${o}"`)})};async function onTriggerSynth(o,e,a,l,u,p){const{s:d,n:f=0,duration:g,clip:b}=e,A=getAudioContext(),[S,M,E,F]=getADSRValues([e.attack,e.decay,e.sustain,e.release]);let{warpmode:$}=e;typeof $=="string"&&($=Warpmode[$.toUpperCase()]??Warpmode.NONE);const Z=getFrequencyFromValue(e),{url:V,label:K}=getCommonSampleInfo(e,l),se=await getPayload(V,K,p);let z=o+g;b!==void 0&&(z=Math.min(o+b*g,z));const U=z+F,ee=U+.01,ae=getWorklet(A,"wavetable-oscillator-processor",{begin:o,end:ee,frequency:Z,freqspread:e.detune,position:e.wt,warp:e.warp,warpMode:$,voices:Math.max(e.unison??1,1),panspread:e.spread,phaserand:e.wtphaserand??e.unison>1?1:0},{outputChannelCount:[2]});if(ae.port.postMessage({type:"table",payload:se}),A.currentTime>o){logger$1(`[wavetable] still loading sound "${d}:${f}"`,"highlight");return}const de=[e.wtattack,e.wtdecay,e.wtsustain,e.wtrelease],ke=[e.warpattack,e.warpdecay,e.warpsustain,e.warprelease],Oe=ae.parameters,De=Oe.get("position"),Ae=Oe.get("warp");let Pe=e.wtrate;e.wtsync!=null&&(Pe=u*e.wtsync);const We=applyParameterModulators(A,De,o,U,{offset:e.wt,amount:e.wtenv,defaultAmount:.5,values:de,holdEnd:z,defaultValues:[0,.5,0,.1]},{frequency:Pe,depth:e.wtdepth,defaultDepth:.5,shape:e.wtshape,skew:e.wtskew,dcoffset:e.wtdc??0});let qe=e.warprate;e.warpsync!=null&&(qe=qe=u*e.warpsync);const at=applyParameterModulators(A,Ae,o,U,{offset:e.warp,amount:e.warpenv,defaultAmount:.5,values:ke,holdEnd:z,defaultValues:[0,.5,0,.1]},{frequency:qe,depth:e.warpdepth,defaultDepth:.5,shape:e.warpshape,skew:e.warpskew,dcoffset:e.warpdc??0}),yt=getVibratoOscillator(ae.parameters.get("detune"),e,o),ut=applyFM(ae.parameters.get("frequency"),e,o),Dt=A.createGain(),$t=ae.connect(Dt);getParamADSR($t.gain,S,M,E,F,0,.3,o,z,"linear"),getPitchEnvelope(ae.parameters.get("detune"),e,o,z);const Bt={node:$t,source:ae},$e=webAudioTimeout(A,()=>{destroyAudioWorkletNode(ae),yt?.stop(),ut?.stop(),$t.disconnect(),We?.disconnect(),at?.disconnect(),a()},o,ee);return Bt.stop=bt=>{$e.stop(bt)},Bt}let doughWorklet;function initDoughWorklet(){const o=getAudioContext();doughWorklet=getWorklet(o,"dough-processor",{},{outputChannelCount:[2]}),connectToDestination(doughWorklet)}const soundMap=new Map,loadedSounds=new Map;Pattern$1.prototype.supradough=function(){return this.onTrigger((o,e,a,l)=>{o.value._begin=l,o.value._duration=o.duration/a,!doughWorklet&&initDoughWorklet();const u=(o.value.bank?o.value.bank+"_":"")+o.value.s,p=o.value.n??0,d=`${u}:${p}`;if(soundMap.has(u)&&(o.value.s=d),soundMap.has(u)&&!loadedSounds.has(d)){const f=soundMap.get(u),g=f[p%f.length];console.log(`load ${d} from ${g}`);const b=fetchSample(g);loadedSounds.set(d,b),b.then(({channels:A,sampleRate:S})=>doughWorklet.port.postMessage({sample:d,channels:A,sampleRate:S}))}doughWorklet.port.postMessage({spawn:o.value})},1)};function githubPath(o,e=""){if(!o.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[a,l]=o.split("github:");return l=l.endsWith("/")?l.slice(0,-1):l,l.split("/").length===2&&(l+="/main"),`https://raw.githubusercontent.com/${l}/${e}`}async function fetchSampleMap(o){if(o.startsWith("github:")&&(o=githubPath(o,"strudel.json")),o.startsWith("local:")&&(o="http://localhost:5432"),o.startsWith("shabda:")){let[l,u]=o.split("shabda:");o=`https://shabda.ndre.gr/${u}.json?strudel=1`}if(o.startsWith("shabda/speech")){let[l,u]=o.split("shabda/speech");u=u.startsWith("/")?u.substring(1):u;let[p,d]=u.split(":"),f="f",g="en-GB";p&&([g,f]=p.split("/")),o=`https://shabda.ndre.gr/speech/${d}.json?gender=${f}&language=${g}&strudel=1'`}if(typeof fetch!="function")return;const e=o.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const a=await fetch(o).then(l=>l.json()).catch(l=>{throw console.error(l),new Error(`error loading "${o}"`)});return[a,a._base||e]}async function fetchSample(o){const e=await fetch(o).then(l=>l.arrayBuffer()).then(l=>getAudioContext().decodeAudioData(l));let a=[];for(let l=0;l<e.numberOfChannels;l++)a.push(e.getChannelData(l));return{channels:a,sampleRate:e.sampleRate}}async function doughsamples(o,e){if(typeof o=="string"){const[a,l]=await fetchSampleMap(o);return doughsamples(a,l)}Object.entries(o).map(async([a,l])=>{a!=="_base"&&(l=l.map(u=>e+u),soundMap.set(a,l))})}const _workletUrl="data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IGQ9dHlwZW9mIHNhbXBsZVJhdGU8InUiP3NhbXBsZVJhdGU6NDhlMyxBPU1hdGguUEkvZCxiPTEvZDtsZXQgRT1pPT5NYXRoLnBvdyhpLDIpO2NvbnN0IFY9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtmdW5jdGlvbiBjKGkpe3JldHVybiBFKGkpfWZ1bmN0aW9uIE8oaSxzLHQpe2NvbnN0IGU9TWF0aC5zaW4oKDEtdCkqLjUqTWF0aC5QSSksaD1NYXRoLnNpbih0Ki41Kk1hdGguUEkpO3JldHVybiBpKmUrcypofWNsYXNzIHZ7cGhhc2U9MDt1cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNpbih0aGlzLnBoYXNlKjIqTWF0aC5QSSk7cmV0dXJuIHRoaXMucGhhc2U9KHRoaXMucGhhc2Urcy9kKSUxLHR9fWNsYXNzIHh7cGhhc2U9MDt1cGRhdGUocyl7cmV0dXJuIHRoaXMucGhhc2UrPWIqcyx0aGlzLnBoYXNlJTEqMi0xfX1mdW5jdGlvbiB5KGkscyl7cmV0dXJuIGk8cz8oaS89cyxpK2ktaSppLTEpOmk+MS1zPyhpPShpLTEpL3MsaSppK2kraSsxKTowfWNsYXNzIFJ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy5waGFzZT1zLnBoYXNlPz8wfXVwZGF0ZShzKXtjb25zdCB0PXMvZDtsZXQgZT15KHRoaXMucGhhc2UsdCksaD0yKnRoaXMucGhhc2UtMS1lO3JldHVybiB0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2UtPTEpLGh9fWZ1bmN0aW9uIFQoaSxzLHQpe3JldHVybiBpPDI/MDooKGgsbyxuKT0+biooby1oKStoKSgtcyouNSxzKi41LHQvKGktMSkpfWZ1bmN0aW9uIHooaSxzKXtyZXR1cm4gaSpNYXRoLnBvdygyLHMvMTIpfWNsYXNzIEZ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy52b2ljZXM9cy52b2ljZXM/PzUsdGhpcy5mcmVxc3ByZWFkPXMuZnJlcXNwcmVhZD8/LjIsdGhpcy5wYW5zcHJlYWQ9cy5wYW5zcHJlYWQ/Py40LHRoaXMucGhhc2U9bmV3IEZsb2F0MzJBcnJheSh0aGlzLnZvaWNlcykubWFwKCgpPT5NYXRoLnJhbmRvbSgpKX11cGRhdGUocyl7Y29uc3QgdD1NYXRoLnNxcnQoMS10aGlzLnBhbnNwcmVhZCksZT1NYXRoLnNxcnQodGhpcy5wYW5zcHJlYWQpO2xldCBoPTAsbz0wO2ZvcihsZXQgbj0wO248dGhpcy52b2ljZXM7bisrKXtjb25zdCBhPXoocyxUKHRoaXMudm9pY2VzLHRoaXMuZnJlcXNwcmVhZCxuKSkvZCxwPShuJjEpPT0xO2xldCB1PXQ7cCYmKHU9ZSk7bGV0IHE9eSh0aGlzLnBoYXNlW25dLGEpLEQ9Mip0aGlzLnBoYXNlW25dLTEtcTtoPWgrRCp1LG89bytEKnUsdGhpcy5waGFzZVtuXSs9YSx0aGlzLnBoYXNlW25dPjEmJih0aGlzLnBoYXNlW25dLT0xKX1yZXR1cm4gaCtvfX1jbGFzcyB3e3BoYXNlPTA7dXBkYXRlKHMpe3RoaXMucGhhc2UrPWIqcztsZXQgdD10aGlzLnBoYXNlJTE7cmV0dXJuKHQ8LjU/Mip0OjEtMioodC0uNSkpKjItMX19Y2xhc3MgZ3tzMD0wO3MxPTA7dXBkYXRlKHMsdCxlPTApe2U9TWF0aC5tYXgoZSwwKSx0PU1hdGgubWluKHQsMmU0KTtsZXQgaD0yKk1hdGguc2luKHQqQSk7aD1WKGgsMCwxLjE0KTtjb25zdCBuPTEtTWF0aC5wb3coLjUsKGUrLjEyNSkvLjEyNSkqaDtyZXR1cm4gdGhpcy5zMD1uKnRoaXMuczAtaCp0aGlzLnMxK2gqcyx0aGlzLnMxPW4qdGhpcy5zMStoKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgSXtjb25zdHJ1Y3RvcihzPTApe3RoaXMucGhhc2U9c31zYXcocyx0KXtsZXQgZT0odGhpcy5waGFzZStzKSUxLGg9eShlLHQpO3JldHVybiAyKmUtMS1ofXVwZGF0ZShzLHQ9LjUpe2NvbnN0IGU9cy9kO2xldCBoPXRoaXMuc2F3KDAsZSktdGhpcy5zYXcodCxlKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStlKSUxLGgrdCoyLTF9fWNsYXNzIEx7cGhhc2U9MDt1cGRhdGUocyx0PS41KXtyZXR1cm4gdGhpcy5waGFzZSs9YipzLHRoaXMucGhhc2UlMTx0PzE6LTF9fWNsYXNzIFN7dXBkYXRlPXM9Pk1hdGgucmFuZG9tKCk8cypiP01hdGgucmFuZG9tKCk6MH1jbGFzcyBOe3VwZGF0ZSgpe3JldHVybiBNYXRoLnJhbmRvbSgpKjItMX19Y2xhc3MgQntjb25zdHJ1Y3Rvcigpe3RoaXMub3V0PTB9dXBkYXRlKCl7bGV0IHM9TWF0aC5yYW5kb20oKSoyLTE7cmV0dXJuIHRoaXMub3V0PSh0aGlzLm91dCsuMDIqcykvMS4wMix0aGlzLm91dH19Y2xhc3MgR3tjb25zdHJ1Y3Rvcigpe3RoaXMuYjA9MCx0aGlzLmIxPTAsdGhpcy5iMj0wLHRoaXMuYjM9MCx0aGlzLmI0PTAsdGhpcy5iNT0wLHRoaXMuYjY9MH11cGRhdGUoKXtjb25zdCBzPU1hdGgucmFuZG9tKCkqMi0xO3RoaXMuYjA9Ljk5ODg2KnRoaXMuYjArcyouMDU1NTE3OSx0aGlzLmIxPS45OTMzMip0aGlzLmIxK3MqLjA3NTA3NTksdGhpcy5iMj0uOTY5KnRoaXMuYjIrcyouMTUzODUyLHRoaXMuYjM9Ljg2NjUqdGhpcy5iMytzKi4zMTA0ODU2LHRoaXMuYjQ9LjU1KnRoaXMuYjQrcyouNTMyOTUyMix0aGlzLmI1PS0uNzYxNip0aGlzLmI1LXMqLjAxNjg5ODtjb25zdCB0PXRoaXMuYjArdGhpcy5iMSt0aGlzLmIyK3RoaXMuYjMrdGhpcy5iNCt0aGlzLmI1K3RoaXMuYjYrcyouNTM2MjtyZXR1cm4gdGhpcy5iNj1zKi4xMTU5MjYsdCouMTF9fWNsYXNzIGp7cGhhc2U9MTt1cGRhdGUocyl7dGhpcy5waGFzZSs9YipzO2xldCB0PXRoaXMucGhhc2U+PTE/MTowO3JldHVybiB0aGlzLnBoYXNlPXRoaXMucGhhc2UlMSx0fX1mdW5jdGlvbiBNKGkscyx0LGU9MSl7aWYoaTw9MClyZXR1cm4gcztpZihpPj0xKXJldHVybiB0O2xldCBoO3JldHVybiBlPT09MD9oPWk6ZT4wP2g9TWF0aC5wb3coaSxlKTpoPTEtTWF0aC5wb3coMS1pLC1lKSxzKyh0LXMpKmh9Y2xhc3MgZntjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnN0YXRlPSJvZmYiLHRoaXMuc3RhcnRUaW1lPTAsdGhpcy5zdGFydFZhbD0wLHRoaXMuZGVjYXlDdXJ2ZT1zLmRlY2F5Q3VydmU/PzF9dXBkYXRlKHMsdCxlLGgsbyxuKXtzd2l0Y2godGhpcy5zdGF0ZSl7Y2FzZSJvZmYiOnJldHVybiB0PjAmJih0aGlzLnN0YXRlPSJhdHRhY2siLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD0wKSwwO2Nhc2UiYXR0YWNrIjp7bGV0IGw9cy10aGlzLnN0YXJ0VGltZTtyZXR1cm4gbD5lPyh0aGlzLnN0YXRlPSJkZWNheSIsdGhpcy5zdGFydFRpbWU9cywxKTpNKGwvZSx0aGlzLnN0YXJ0VmFsLDEsMSl9Y2FzZSJkZWNheSI6e2xldCBsPXMtdGhpcy5zdGFydFRpbWUsYT1NKGwvaCwxLG8sLXRoaXMuZGVjYXlDdXJ2ZSk7cmV0dXJuIHQ8PTA/KHRoaXMuc3RhdGU9InJlbGVhc2UiLHRoaXMuc3RhcnRUaW1lPXMsdGhpcy5zdGFydFZhbD1hLGEpOmw+aD8odGhpcy5zdGF0ZT0ic3VzdGFpbiIsdGhpcy5zdGFydFRpbWU9cyxvKTphfWNhc2Uic3VzdGFpbiI6cmV0dXJuIHQ8PTAmJih0aGlzLnN0YXRlPSJyZWxlYXNlIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9byksbztjYXNlInJlbGVhc2UiOntsZXQgbD1zLXRoaXMuc3RhcnRUaW1lO2lmKGw+bilyZXR1cm4gdGhpcy5zdGF0ZT0ib2ZmIiwwO2xldCBhPU0obC9uLHRoaXMuc3RhcnRWYWwsMCwtdGhpcy5kZWNheUN1cnZlKTtyZXR1cm4gdD4wJiYodGhpcy5zdGF0ZT0iYXR0YWNrIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9YSksYX19dGhyb3ciaW52YWxpZCBlbnZlbG9wZSBzdGF0ZSJ9fWNvbnN0ICQ9MTA7Y2xhc3Mga3t3cml0ZUlkeD0wO3JlYWRJZHg9MDtidWZmZXI9bmV3IEZsb2F0MzJBcnJheSgkKmQpO3dyaXRlKHMsdCl7dGhpcy53cml0ZUlkeD0odGhpcy53cml0ZUlkeCsxKSV0aGlzLmJ1ZmZlci5sZW5ndGgsdGhpcy5idWZmZXJbdGhpcy53cml0ZUlkeF09cztsZXQgZT1NYXRoLm1pbihNYXRoLmZsb29yKGQqdCksdGhpcy5idWZmZXIubGVuZ3RoLTEpO3RoaXMucmVhZElkeD10aGlzLndyaXRlSWR4LWUsdGhpcy5yZWFkSWR4PDAmJih0aGlzLnJlYWRJZHgrPXRoaXMuYnVmZmVyLmxlbmd0aCl9dXBkYXRlKHMsdCl7cmV0dXJuIHRoaXMud3JpdGUocyx0KSx0aGlzLmJ1ZmZlclt0aGlzLnJlYWRJZHhdfX1jbGFzcyBXe2RlbGF5PW5ldyBrO21vZHVsYXRvcj1uZXcgdzt1cGRhdGUocyx0LGUsaCxvKXtjb25zdCBuPXRoaXMubW9kdWxhdG9yLnVwZGF0ZShoKSpvLGw9dGhpcy5kZWxheS51cGRhdGUocyxlKigxK24pKTtyZXR1cm4gTyhzLGwsdCl9fWNsYXNzIFh7aG9sZD0wO3Q9MDt1cGRhdGUocyx0KXtyZXR1cm4gdGhpcy50KysldD09PTAmJih0aGlzLnQ9MCx0aGlzLmhvbGQ9cyksdGhpcy5ob2xkfX1jbGFzcyBVe3VwZGF0ZShzLHQpe3Q9TWF0aC5tYXgoMSx0KTtjb25zdCBlPU1hdGgucG93KDIsdC0xKTtyZXR1cm4gTWF0aC5yb3VuZChzKmUpL2V9fWNsYXNzIFl7dXBkYXRlKHMsdD0wLGU9MSl7ZT1NYXRoLm1heCguMDAxLE1hdGgubWluKDEsZSkpO2NvbnN0IGg9TWF0aC5leHBtMSh0KTtyZXR1cm4oMStoKSpzLygxK2gqTWF0aC5hYnMocykpKmV9fWNsYXNzIF97c3RhdGljIHNhbXBsZXM9bmV3IE1hcDtidWZmZXI7c2FtcGxlUmF0ZTtwb3M9MDtzYW1wbGVGcmVxPVAoKTtjb25zdHJ1Y3RvcihzLHQsZSl7dGhpcy5idWZmZXI9cyx0aGlzLnNhbXBsZVJhdGU9dCx0aGlzLmR1cmF0aW9uPXRoaXMuYnVmZmVyLmxlbmd0aC90aGlzLnNhbXBsZVJhdGUsdGhpcy5zcGVlZD1kL3RoaXMuc2FtcGxlUmF0ZSxlJiYodGhpcy5zcGVlZCo9dGhpcy5kdXJhdGlvbil9dXBkYXRlKHMpe2lmKHRoaXMucG9zPj10aGlzLmJ1ZmZlci5sZW5ndGgpcmV0dXJuIDA7Y29uc3QgdD1zL3RoaXMuc2FtcGxlRnJlcSp0aGlzLnNwZWVkO2xldCBlPXRoaXMuYnVmZmVyW01hdGguZmxvb3IodGhpcy5wb3MpXTtyZXR1cm4gdGhpcy5wb3M9dGhpcy5wb3MrdCxlfX1jb25zdCBtPShpLHM9ImxpbmVhciIsdCk9Pntjb25zdFtuLGwsYSxwXT1pO2lmKG49PW51bGwmJmw9PW51bGwmJmE9PW51bGwmJnA9PW51bGwpcmV0dXJuIHQ/P1suMDAxLC4wMDEsMSwuMDFdO2NvbnN0IHU9YT8/KG4hPW51bGwmJmw9PW51bGx8fG49PW51bGwmJmw9PW51bGw/MTouMDAxKTtyZXR1cm5bTWF0aC5tYXgobj8/MCwuMDAxKSxNYXRoLm1heChsPz8wLC4wMDEpLE1hdGgubWluKHUsMSksTWF0aC5tYXgocD8/MCwuMDEpXX07bGV0IEM9e3NpbmU6dixzYXc6Uix6YXc6eCxzYXd0b290aDpSLHphd3Rvb3RoOngsc3VwZXJzYXc6Rix0cmk6dyx0cmlhbmdsZTp3LHB1bHNlOkksc3F1YXJlOkkscHVsemU6TCxkdXN0OlMsY3JhY2tsZTpTLGltcHVsc2U6aix3aGl0ZTpOLGJyb3duOkIscGluazpHfTtjb25zdCBaPXtjaG9ydXM6MCxub3RlOjQ4LHM6InRyaWFuZ2xlIixiYW5rOiIiLGdhaW46MSxwb3N0Z2FpbjoxLHZlbG9jaXR5OjEsZGVuc2l0eToiLjAzIixmdHlwZToiMTJkYiIsZmFuY2hvcjowLHJlc29uYW5jZTowLGhyZXNvbmFuY2U6MCxiYW5kcTowLGNoYW5uZWxzOlsxLDJdLHBoYXNlcmRlcHRoOi43NSxzaGFwZXZvbDoxLGRpc3RvcnR2b2w6MSxkZWxheTowLGJ5dGVCZWF0RXhwcmVzc2lvbjoiMCIsZGVsYXlmZWVkYmFjazouNSxkZWxheXNwZWVkOjEsZGVsYXl0aW1lOi4yNSxvcmJpdDoxLGk6MSxmZnQ6OCx6OiJ0cmlhbmdsZSIscGFuOi41LGZtaDoxLGZtZW52OjAsc3BlZWQ6MSxwdzouNX07bGV0IHI9aT0+WltpXTtjb25zdCBIPXtjOjAsZDoyLGU6NCxmOjUsZzo3LGE6OSxiOjExfSxKPXsiIyI6MSxiOi0xLHM6MSxmOi0xfSxLPShpLHM9Myk9PntsZXRbdCxlPSIiLGg9IiJdPVN0cmluZyhpKS5tYXRjaCgvXihbYS1nQS1HXSkoWyNic2ZdKikoWzAtOV0qKSQvKT8uc2xpY2UoMSl8fFtdO2lmKCF0KXRocm93IG5ldyBFcnJvcignbm90IGEgbm90ZTogIicraSsnIicpO2NvbnN0IG89SFt0LnRvTG93ZXJDYXNlKCldLG49ZT8uc3BsaXQoIiIpLnJlZHVjZSgoYSxwKT0+YStKW3BdLDApfHwwO3JldHVybihOdW1iZXIoaHx8cykrMSkqMTIrbytufSxRPWk9Pk1hdGgucG93KDIsKGktNjkpLzEyKSo0NDAsUD1pPT4oaT1pfHxyKCJub3RlIiksdHlwZW9mIGk9PSJzdHJpbmciJiYoaT1LKGksMykpLFEoaSkpO2NsYXNzIHR0e2lkPTA7b3V0PVswLDBdO2F0dGFjaztkZWNheTtzdXN0YWluO3JlbGVhc2U7X2JlZ2luO19kdXJhdGlvbjtfc291bmQ7X2NoYW5uZWxzPTE7X2J1ZmZlcnM7dW5pdDtfcGVudjtwZW52O3BhdHRhY2s7cGRlY2F5O3BzdXN0YWluO3ByZWxlYXNlO3ZpYjtfdmliO3ZpYm1vZDtfZm07Zm1oO2ZtaTtfZm1lbnY7Zm1hdHRhY2s7Zm1kZWNheTtmbXN1c3RhaW47Zm1yZWxlYXNlO19scGVudjtscGVudjtscGF0dGFjaztscGRlY2F5O2xwc3VzdGFpbjtscHJlbGVhc2U7X2hwZW52O2hwZW52O2hwYXR0YWNrO2hwZGVjYXk7aHBzdXN0YWluO2hwcmVsZWFzZTtfYnBlbnY7YnBlbnY7YnBhdHRhY2s7YnBkZWNheTticHN1c3RhaW47YnByZWxlYXNlO2N1dG9mZjtoY3V0b2ZmO2JhbmRmO2NvYXJzZTtjcnVzaDtkaXN0b3J0O2ZyZXE7bm90ZTtfbHBmO19ocGY7X2JwZjtfY2hvcnVzO19jb2Fyc2U7X2NydXNoO19kaXN0b3J0O2NvbnN0cnVjdG9yKHMpe3RoaXMuZnJlcT8/PVAocy5ub3RlKSx0aGlzLl9iZWdpbj1zLl9iZWdpbix0aGlzLl9kdXJhdGlvbj1zLl9kdXJhdGlvbix0aGlzLnJlbGVhc2U9cy5yZWxlYXNlPz8wO2xldCB0PXRoaXM7aWYoT2JqZWN0LmFzc2lnbih0LHMpLHQucz10LnM/P3IoInMiKSx0LmdhaW49Yyh0LmdhaW4/P3IoImdhaW4iKSksdC52ZWxvY2l0eT1jKHQudmVsb2NpdHk/P3IoInZlbG9jaXR5IikpLHQucG9zdGdhaW49Yyh0LnBvc3RnYWluPz9yKCJwb3N0Z2FpbiIpKSx0LmRlbnNpdHk9dC5kZW5zaXR5Pz9yKCJkZW5zaXR5IiksdC5mYW5jaG9yPXQuZmFuY2hvcj8/cigiZmFuY2hvciIpLHQuZHJpdmU9dC5kcml2ZT8/LjY5LHQucGhhc2VyZGVwdGg9dC5waGFzZXJkZXB0aD8/cigicGhhc2VyZGVwdGgiKSx0LnNoYXBldm9sPWModC5zaGFwZXZvbD8/cigic2hhcGV2b2wiKSksdC5kaXN0b3J0dm9sPWModC5kaXN0b3J0dm9sPz9yKCJkaXN0b3J0dm9sIikpLHQuaT10Lmk/P3IoImkiKSx0LmNob3J1cz10LmNob3J1cz8/cigiY2hvcnVzIiksdC5mZnQ9dC5mZnQ/P3IoImZmdCIpLHQucGFuPXQucGFuPz9yKCJwYW4iKSx0Lm9yYml0PXQub3JiaXQ/P3IoIm9yYml0IiksdC5mbWVudj10LmZtZW52Pz9yKCJmbWVudiIpLHQucmVzb25hbmNlPXQucmVzb25hbmNlPz9yKCJyZXNvbmFuY2UiKSx0LmhyZXNvbmFuY2U9dC5ocmVzb25hbmNlPz9yKCJocmVzb25hbmNlIiksdC5iYW5kcT10LmJhbmRxPz9yKCJiYW5kcSIpLHQuc3BlZWQ9dC5zcGVlZD8/cigic3BlZWQiKSx0LnB3PXQucHc/P3IoInB3IiksW3QuYXR0YWNrLHQuZGVjYXksdC5zdXN0YWluLHQucmVsZWFzZV09bShbdC5hdHRhY2ssdC5kZWNheSx0LnN1c3RhaW4sdC5yZWxlYXNlXSksdC5faG9sZEVuZD10Ll9iZWdpbit0Ll9kdXJhdGlvbix0Ll9lbmQ9dC5faG9sZEVuZCt0LnJlbGVhc2UrLjAxLHQuZm1pJiYodC5zPT09InNhdyJ8fHQucz09PSJzYXd0b290aCIpJiYodC5zPSJ6YXciKSxDW3Quc10pe2NvbnN0IGU9Q1t0LnNdO3QuX3NvdW5kPW5ldyBlLHQuX2NoYW5uZWxzPTF9ZWxzZSBpZihfLnNhbXBsZXMuaGFzKHQucykpe2NvbnN0IGU9Xy5zYW1wbGVzLmdldCh0LnMpO3QuX2J1ZmZlcnM9W10sdC5fY2hhbm5lbHM9ZS5jaGFubmVscy5sZW5ndGg7Zm9yKGxldCBoPTA7aDx0Ll9jaGFubmVscztoKyspdC5fYnVmZmVycy5wdXNoKG5ldyBfKGUuY2hhbm5lbHNbaF0sZS5zYW1wbGVSYXRlLHQudW5pdD09PSJjIikpfWVsc2UgY29uc29sZS53YXJuKCJzb3VuZCBub3QgbG9hZGVkIix0LnMpO3QucGVudiYmKHQuX3BlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXT1tKFt0LnBhdHRhY2ssdC5wZGVjYXksdC5wc3VzdGFpbix0LnByZWxlYXNlXSkpLHQudmliJiYodC5fdmliPW5ldyB2LHQudmlibW9kPXQudmlibW9kPz9yKCJ2aWJtb2QiKSksdC5mbWkmJih0Ll9mbT1uZXcgdix0LmZtaD10LmZtaD8/cigiZm1oIiksdC5mbWVudiYmKHQuX2ZtZW52PW5ldyBmKHtkZWNheUN1cnZlOjJ9KSxbdC5mbWF0dGFjayx0LmZtZGVjYXksdC5mbXN1c3RhaW4sdC5mbXJlbGVhc2VdPW0oW3QuZm1hdHRhY2ssdC5mbWRlY2F5LHQuZm1zdXN0YWluLHQuZm1yZWxlYXNlXSkpKSx0Ll9hZHNyPW5ldyBmKHtkZWNheUN1cnZlOjJ9KSx0LmRlbGF5PWModC5kZWxheT8/cigiZGVsYXkiKSksdC5kZWxheWZlZWRiYWNrPXQuZGVsYXlmZWVkYmFjaz8/cigiZGVsYXlmZWVkYmFjayIpLHQuZGVsYXlzcGVlZD10LmRlbGF5c3BlZWQ/P3IoImRlbGF5c3BlZWQiKSx0LmRlbGF5dGltZT10LmRlbGF5dGltZT8/cigiZGVsYXl0aW1lIiksdC5scGVudiYmKHQuX2xwZW52PW5ldyBmKHtkZWNheUN1cnZlOjR9KSxbdC5scGF0dGFjayx0LmxwZGVjYXksdC5scHN1c3RhaW4sdC5scHJlbGVhc2VdPW0oW3QubHBhdHRhY2ssdC5scGRlY2F5LHQubHBzdXN0YWluLHQubHByZWxlYXNlXSkpLHQuaHBlbnYmJih0Ll9ocGVudj1uZXcgZih7ZGVjYXlDdXJ2ZTo0fSksW3QuaHBhdHRhY2ssdC5ocGRlY2F5LHQuaHBzdXN0YWluLHQuaHByZWxlYXNlXT1tKFt0LmhwYXR0YWNrLHQuaHBkZWNheSx0Lmhwc3VzdGFpbix0LmhwcmVsZWFzZV0pKSx0LmJwZW52JiYodC5fYnBlbnY9bmV3IGYoe2RlY2F5Q3VydmU6NH0pLFt0LmJwYXR0YWNrLHQuYnBkZWNheSx0LmJwc3VzdGFpbix0LmJwcmVsZWFzZV09bShbdC5icGF0dGFjayx0LmJwZGVjYXksdC5icHN1c3RhaW4sdC5icHJlbGVhc2VdKSksdC5fY2hvcnVzPXQuY2hvcnVzP1tdOm51bGwsdC5fbHBmPXQuY3V0b2ZmP1tdOm51bGwsdC5faHBmPXQuaGN1dG9mZj9bXTpudWxsLHQuX2JwZj10LmJhbmRmP1tdOm51bGwsdC5fY29hcnNlPXQuY29hcnNlP1tdOm51bGwsdC5fY3J1c2g9dC5jcnVzaD9bXTpudWxsLHQuX2Rpc3RvcnQ9dC5kaXN0b3J0P1tdOm51bGw7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jaGFubmVscztlKyspdC5fbHBmPy5wdXNoKG5ldyBnKSx0Ll9ocGY/LnB1c2gobmV3IGcpLHQuX2JwZj8ucHVzaChuZXcgZyksdC5fY2hvcnVzPy5wdXNoKG5ldyBXKSx0Ll9jb2Fyc2U/LnB1c2gobmV3IFgpLHQuX2NydXNoPy5wdXNoKG5ldyBVKSx0Ll9kaXN0b3J0Py5wdXNoKG5ldyBZKX11cGRhdGUocyl7aWYoIXRoaXMuX3NvdW5kJiYhdGhpcy5fYnVmZmVycylyZXR1cm4gMDtsZXQgdD0rKHM+PXRoaXMuX2JlZ2luJiZzPD10aGlzLl9ob2xkRW5kKSxlPXRoaXMuZnJlcSp0aGlzLnNwZWVkO2lmKHRoaXMuX2ZtJiZ0aGlzLmZtaCE9PXZvaWQgMCYmdGhpcy5mbWkhPT12b2lkIDApe2xldCBhPXRoaXMuZm1pO2lmKHRoaXMuX2ZtZW52KXtjb25zdCBxPXRoaXMuX2ZtZW52LnVwZGF0ZShzLHQsdGhpcy5mbWF0dGFjayx0aGlzLmZtZGVjYXksdGhpcy5mbXN1c3RhaW4sdGhpcy5mbXJlbGVhc2UpO2E9dGhpcy5mbWVudipxKmF9Y29uc3QgcD1lKnRoaXMuZm1oLHU9cCphO2U9ZSt0aGlzLl9mbS51cGRhdGUocCkqdX1pZih0aGlzLl92aWImJnRoaXMudmlibW9kIT09dm9pZCAwJiYoZT1lKjIqKih0aGlzLl92aWIudXBkYXRlKHRoaXMudmliKSp0aGlzLnZpYm1vZC8xMikpLHRoaXMuX3BlbnYmJnRoaXMucGVudiE9PXZvaWQgMCl7Y29uc3QgYT10aGlzLl9wZW52LnVwZGF0ZShzLHQsdGhpcy5wYXR0YWNrLHRoaXMucGRlY2F5LHRoaXMucHN1c3RhaW4sdGhpcy5wcmVsZWFzZSk7ZT1lK2EqdGhpcy5wZW52fWxldCBoPXRoaXMuY3V0b2ZmO2lmKGghPT12b2lkIDAmJnRoaXMuX2xwZW52KXtjb25zdCBhPXRoaXMuX2xwZW52LnVwZGF0ZShzLHQsdGhpcy5scGF0dGFjayx0aGlzLmxwZGVjYXksdGhpcy5scHN1c3RhaW4sdGhpcy5scHJlbGVhc2UpO2g9dGhpcy5scGVudiphKmgraH1sZXQgbz10aGlzLmhjdXRvZmY7aWYobyE9PXZvaWQgMCYmdGhpcy5faHBlbnYmJnRoaXMuaHBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5faHBlbnYudXBkYXRlKHMsdCx0aGlzLmhwYXR0YWNrLHRoaXMuaHBkZWNheSx0aGlzLmhwc3VzdGFpbix0aGlzLmhwcmVsZWFzZSk7bz0yKip0aGlzLmhwZW52KmEqbytvfWxldCBuPXRoaXMuYmFuZGY7aWYobiE9PXZvaWQgMCYmdGhpcy5fYnBlbnYmJnRoaXMuYnBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5fYnBlbnYudXBkYXRlKHMsdCx0aGlzLmJwYXR0YWNrLHRoaXMuYnBkZWNheSx0aGlzLmJwc3VzdGFpbix0aGlzLmJwcmVsZWFzZSk7bj0yKip0aGlzLmJwZW52KmEqbitufWNvbnN0IGw9dGhpcy5fYWRzci51cGRhdGUocyx0LHRoaXMuYXR0YWNrLHRoaXMuZGVjYXksdGhpcy5zdXN0YWluLHRoaXMucmVsZWFzZSk7Zm9yKGxldCBhPTA7YTx0aGlzLl9jaGFubmVsczthKyspe2lmKHRoaXMuX3NvdW5kJiZ0aGlzLnM9PT0icHVsc2UiP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlLHRoaXMucHcpOnRoaXMuX3NvdW5kP3RoaXMub3V0W2FdPXRoaXMuX3NvdW5kLnVwZGF0ZShlKTp0aGlzLl9idWZmZXJzJiYodGhpcy5vdXRbYV09dGhpcy5fYnVmZmVyc1thXS51cGRhdGUoZSkpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdKnRoaXMuZ2Fpbip0aGlzLnZlbG9jaXR5LHRoaXMuX2Nob3J1cyl7Y29uc3QgcD10aGlzLl9jaG9ydXNbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY2hvcnVzLC4wMysuMDUqYSwxLC4xMSk7dGhpcy5vdXRbYV09cCt0aGlzLm91dFthXX10aGlzLl9scGYmJih0aGlzLl9scGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLGgsdGhpcy5yZXNvbmFuY2UpLHRoaXMub3V0W2FdPXRoaXMuX2xwZlthXS5zMSksdGhpcy5faHBmJiYodGhpcy5faHBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxvLHRoaXMuaHJlc29uYW5jZSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0tdGhpcy5faHBmW2FdLnMxKSx0aGlzLl9icGYmJih0aGlzLl9icGZbYV0udXBkYXRlKHRoaXMub3V0W2FdLG4sdGhpcy5iYW5kcSksdGhpcy5vdXRbYV09dGhpcy5fYnBmW2FdLnMwKSx0aGlzLl9jb2Fyc2UmJih0aGlzLm91dFthXT10aGlzLl9jb2Fyc2VbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY29hcnNlKSksdGhpcy5fY3J1c2gmJih0aGlzLm91dFthXT10aGlzLl9jcnVzaFthXS51cGRhdGUodGhpcy5vdXRbYV0sdGhpcy5jcnVzaCkpLHRoaXMuX2Rpc3RvcnQmJih0aGlzLm91dFthXT10aGlzLl9kaXN0b3J0W2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmRpc3RvcnQsdGhpcy5kaXN0b3J0dm9sKSksdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qbCx0aGlzLm91dFthXT10aGlzLm91dFthXSp0aGlzLnBvc3RnYWluLHRoaXMuX2J1ZmZlcnN8fCh0aGlzLm91dFthXT10aGlzLm91dFthXSouMil9aWYodGhpcy5fY2hhbm5lbHM9PT0xJiYodGhpcy5vdXRbMV09dGhpcy5vdXRbMF0pLHRoaXMucGFuIT09LjUpe2NvbnN0IGE9dGhpcy5wYW4qTWF0aC5QSS8yO3RoaXMub3V0WzBdPXRoaXMub3V0WzBdKk1hdGguY29zKGEpLHRoaXMub3V0WzFdPXRoaXMub3V0WzFdKk1hdGguc2luKGEpfX19Y2xhc3Mgc3R7dm9pY2VzPVtdO3ZpZD0wO3E9W107b3V0PVswLDBdO2RlbGF5c2VuZD1bMCwwXTtkZWxheXRpbWU9cigiZGVsYXl0aW1lIik7ZGVsYXlmZWVkYmFjaz1yKCJkZWxheWZlZWRiYWNrIik7ZGVsYXlzcGVlZD1yKCJkZWxheXNwZWVkIik7dD0wO2NvbnN0cnVjdG9yKHM9NDhlMyx0PTApe3RoaXMuc2FtcGxlUmF0ZT1zLHRoaXMudD1NYXRoLmZsb29yKHQqcyksdGhpcy5fZGVsYXlMPW5ldyBrLHRoaXMuX2RlbGF5Uj1uZXcga31sb2FkU2FtcGxlKHMsdCxlKXtfLnNhbXBsZXMuc2V0KHMse2NoYW5uZWxzOnQsc2FtcGxlUmF0ZTplfSl9c2NoZWR1bGVTcGF3bihzKXtpZihzLl9iZWdpbj09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoIltkb3VnaF06IHNjaGVkdWxlU3Bhd24gZXhwZWN0ZWQgX2JlZ2luIHRvIGJlIHNldCIpO2lmKHMuX2R1cmF0aW9uPT09dm9pZCAwKXRocm93IG5ldyBFcnJvcigiW2RvdWdoXTogc2NoZWR1bGVTcGF3biBleHBlY3RlZCBfZHVyYXRpb24gdG8gYmUgc2V0Iik7cy5zYW1wbGVSYXRlPXRoaXMuc2FtcGxlUmF0ZTtjb25zdCB0PU1hdGguZmxvb3Iocy5fYmVnaW4qdGhpcy5zYW1wbGVSYXRlKTt0aGlzLnNjaGVkdWxlKHt0aW1lOnQsdHlwZToic3Bhd24iLGFyZzpzfSl9c3Bhd24ocyl7cy5pZD10aGlzLnZpZCsrO2NvbnN0IHQ9bmV3IHR0KHMpO3RoaXMudm9pY2VzLnB1c2godCk7Y29uc3QgZT1NYXRoLmNlaWwodC5fZW5kKnRoaXMuc2FtcGxlUmF0ZSk7dGhpcy5zY2hlZHVsZSh7dGltZTplLHR5cGU6ImRlc3Bhd24iLGFyZzp0LmlkfSl9ZGVzcGF3bihzKXt0aGlzLnZvaWNlcz10aGlzLnZvaWNlcy5maWx0ZXIodD0+dC5pZCE9PXMpfXNjaGVkdWxlKHMpe2lmKCF0aGlzLnEubGVuZ3RoKXt0aGlzLnEucHVzaChzKTtyZXR1cm59bGV0IHQ9MDtmb3IoO3Q8dGhpcy5xLmxlbmd0aCYmdGhpcy5xW3RdLnRpbWU8cy50aW1lOyl0Kys7dGhpcy5xLnNwbGljZSh0LDAscyl9dXBkYXRlKCl7Zm9yKDt0aGlzLnEubGVuZ3RoPjAmJnRoaXMucVswXS50aW1lPD10aGlzLnQ7KXRoaXNbdGhpcy5xWzBdLnR5cGVdKHRoaXMucVswXS5hcmcpLHRoaXMucS5zaGlmdCgpO3RoaXMub3V0WzBdPTAsdGhpcy5vdXRbMV09MDtmb3IobGV0IGU9MDtlPHRoaXMudm9pY2VzLmxlbmd0aDtlKyspdGhpcy52b2ljZXNbZV0udXBkYXRlKHRoaXMudC90aGlzLnNhbXBsZVJhdGUpLHRoaXMub3V0WzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0sdGhpcy5vdXRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSx0aGlzLnZvaWNlc1tlXS5kZWxheSYmKHRoaXMuZGVsYXlzZW5kWzBdKz10aGlzLnZvaWNlc1tlXS5vdXRbMF0qdGhpcy52b2ljZXNbZV0uZGVsYXksdGhpcy5kZWxheXNlbmRbMV0rPXRoaXMudm9pY2VzW2VdLm91dFsxXSp0aGlzLnZvaWNlc1tlXS5kZWxheSx0aGlzLmRlbGF5dGltZT10aGlzLnZvaWNlc1tlXS5kZWxheXRpbWUsdGhpcy5kZWxheXNwZWVkPXRoaXMudm9pY2VzW2VdLmRlbGF5c3BlZWQsdGhpcy5kZWxheWZlZWRiYWNrPXRoaXMudm9pY2VzW2VdLmRlbGF5ZmVlZGJhY2spO2NvbnN0IHM9dGhpcy5fZGVsYXlMLnVwZGF0ZSh0aGlzLmRlbGF5c2VuZFswXSx0aGlzLmRlbGF5dGltZSksdD10aGlzLl9kZWxheVIudXBkYXRlKHRoaXMuZGVsYXlzZW5kWzFdLHRoaXMuZGVsYXl0aW1lKTt0aGlzLmRlbGF5c2VuZFswXT1zKnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLmRlbGF5c2VuZFsxXT10KnRoaXMuZGVsYXlmZWVkYmFjayx0aGlzLm91dFswXSs9cyx0aGlzLm91dFsxXSs9dCx0aGlzLnQrK319Y29uc3QgZXQ9KGkscyx0KT0+TWF0aC5taW4oTWF0aC5tYXgoaSxzKSx0KTtjbGFzcyBpdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5kb3VnaD1uZXcgc3Qoc2FtcGxlUmF0ZSxjdXJyZW50VGltZSksdGhpcy5wb3J0Lm9ubWVzc2FnZT1zPT57cy5kYXRhLnNwYXduP3RoaXMuZG91Z2guc2NoZWR1bGVTcGF3bihzLmRhdGEuc3Bhd24pOnMuZGF0YS5zYW1wbGU/dGhpcy5kb3VnaC5sb2FkU2FtcGxlKHMuZGF0YS5zYW1wbGUscy5kYXRhLmNoYW5uZWxzLHMuZGF0YS5zYW1wbGVSYXRlKTpzLmRhdGEuc2FtcGxlcz9zLmRhdGEuc2FtcGxlcy5mb3JFYWNoKChbdCxlLGhdKT0+e3RoaXMuZG91Z2gubG9hZFNhbXBsZSh0LGUsaCl9KTpjb25zb2xlLmxvZygidW5yZWNvZ25pemVkIGV2ZW50IHR5cGUiLHMuZGF0YSl9fXByb2Nlc3Mocyx0LGUpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2NvbnN0IGg9dFswXTtmb3IobGV0IG89MDtvPGhbMF0ubGVuZ3RoO28rKyl7dGhpcy5kb3VnaC51cGRhdGUoKTtmb3IobGV0IG49MDtuPGgubGVuZ3RoO24rKyloW25dW29dPWV0KHRoaXMuZG91Z2gub3V0W25dLC0xLDEpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZG91Z2gtcHJvY2Vzc29yIixpdCl9KSgpOwo=";typeof sampleRate<"u"&&sampleRate;const workletUrl=_workletUrl;registerWorklet(workletUrl);const{Pattern,logger,repl:repl$1}=strudelCore;setLogger(logger);const hap2value=o=>(o.ensureObjectValue(),o.value),webaudioOutput=(o,e,a,l,u)=>superdough(hap2value(o),u,a,l,o.whole?.begin.valueOf());function webaudioRepl(o={}){return o={getTime:()=>getAudioContext().currentTime,defaultOutput:webaudioOutput,...o},repl$1(o)}Pattern.prototype.dough=function(){return this.onTrigger(doughTrigger,1)};const getDrawContext=(o="test-canvas",e)=>{let{contextType:a="2d",pixelated:l=!1,pixelRatio:u=window.devicePixelRatio}=e||{},p=document.querySelector("#"+o);if(!p){p=document.createElement("canvas"),p.id=o,p.width=window.innerWidth*u,p.height=window.innerHeight*u,p.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",l&&(p.style.imageRendering="pixelated"),document.body.prepend(p);let d;window.addEventListener("resize",()=>{d&&clearTimeout(d),d=setTimeout(()=>{p.width=window.innerWidth*u,p.height=window.innerHeight*u},200)})}return p.getContext(a,{willReadFrequently:!0})};let animationFrames={};function stopAnimationFrame(o){animationFrames[o]!==void 0&&(cancelAnimationFrame(animationFrames[o]),delete animationFrames[o])}function stopAllAnimations(o){Object.keys(animationFrames).forEach(e=>(!o||e.startsWith(o))&&stopAnimationFrame(e))}let memory={};Pattern$1.prototype.draw=function(o,e){if(typeof window>"u")return this;let{id:a=1,lookbehind:l=0,lookahead:u=0}=e,p=Math.max(getTime(),0);stopAnimationFrame(a),l=Math.abs(l),memory[a]=(memory[a]||[]).filter(b=>!b.isInFuture(p));let d=this.queryArc(p,p+u).filter(b=>b.hasOnset());memory[a]=memory[a].concat(d);let f;const g=()=>{const b=getTime(),A=b+u;memory[a]=memory[a].filter(E=>E.isInNearPast(l,b));let S=Math.max(f||A,A-1/10);const M=this.queryArc(S,A).filter(E=>E.hasOnset());memory[a]=memory[a].concat(M),f=A,o(memory[a],b,A,this),animationFrames[a]=requestAnimationFrame(g)};return animationFrames[a]=requestAnimationFrame(g),this};const cleanupDraw=(o=!0,e)=>{const a=getDrawContext();o&&a.clearRect(0,0,a.canvas.width,a.canvas.height),stopAllAnimations(e)};Pattern$1.prototype.onPaint=function(o){return this.withState(e=>(e.controls.painters||(e.controls.painters=[]),e.controls.painters.push(o),e))},Pattern$1.prototype.getPainters=function(){let o=[];return this.queryArc(0,0,{painters:o}),o};class Framer{constructor(e,a){this.onFrame=e,this.onError=a}start(){const e=this;let a=requestAnimationFrame(function l(u){try{e.onFrame(u)}catch(p){e.onError(p)}a=requestAnimationFrame(l)});e.cancel=()=>{cancelAnimationFrame(a)}}stop(){this.cancel&&this.cancel()}}let Drawer$1=class{constructor(e,a){this.visibleHaps=[],this.lastFrame=null,this.drawTime=a,this.painters=[],this.framer=new Framer(()=>{if(!this.scheduler){console.warn("Drawer: no scheduler");return}const l=Math.abs(this.drawTime[0]),u=this.drawTime[1],p=this.scheduler.now()+u;if(this.lastFrame===null){this.lastFrame=p;return}const d=this.scheduler.pattern.queryArc(Math.max(this.lastFrame,p-1/10),p);this.lastFrame=p,this.visibleHaps=(this.visibleHaps||[]).filter(g=>g.whole&&g.endClipped>=p-l-u).concat(d.filter(g=>g.hasOnset()));const f=p-u;e(this.visibleHaps,f,this,this.painters)},l=>{console.warn("draw error",l)})}setDrawTime(e){this.drawTime=e}invalidate(e=this.scheduler,a){if(!e)return;a=a??e.now(),this.scheduler=e;let[l,u]=this.drawTime;const[p,d]=[Math.max(a,0),a+u+.1];this.visibleHaps=this.visibleHaps.filter(g=>g.whole?.begin<a),this.painters=[];const f=e.pattern.queryArc(p,d,{painters:this.painters});this.visibleHaps=this.visibleHaps.concat(f)}start(e){this.scheduler=e,this.invalidate(),this.framer.start()}stop(){this.framer&&this.framer.stop()}};function getComputedPropertyValue(o){return typeof window>"u"?"#fff":getComputedStyle(document.documentElement).getPropertyValue(o)}let theme={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function getTheme(){return theme}function setTheme(o){theme=o}let clearColor="#22222210";Pattern$1.prototype.animate=function({callback:o,sync:e=!1,smear:a=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const l=getDrawContext();let{clientWidth:u,clientHeight:p}=l.canvas;u*=window.devicePixelRatio,p*=window.devicePixelRatio;let d=a===0?"99":Number((1-a)*100).toFixed(0);d=d.length===1?`0${d}`:d,clearColor=`#200010${d}`;const f=g=>{let b;g=Math.round(g),b=this.slow(1e3).queryArc(g,g),l.fillStyle=clearColor,l.fillRect(0,0,u,p),b.forEach(A=>{let{x:S,y:M,w:E,h:F,s:$,r:Z,angle:V=0,fill:K="darkseagreen"}=A.value;if(E*=u,F*=p,Z!==void 0&&V!==void 0){const z=V*2*Math.PI,[U,ee]=[(u-E)/2,(p-F)/2];S=U+Math.cos(z)*Z*U,M=ee+Math.sin(z)*Z*ee}else S*=u-E,M*=p-F;const se={...A.value,x:S,y:M,w:E,h:F};l.fillStyle=K,$==="rect"?l.fillRect(S,M,E,F):$==="ellipse"&&(l.beginPath(),l.ellipse(S+E/2,M+F/2,E/2,F/2,0,0,2*Math.PI),l.fill()),o&&o(l,se,A)}),window.frame=requestAnimationFrame(f)};return window.frame=requestAnimationFrame(f),silence};const{x:x$1,y,w,h,angle,r,fill,smear}=createParams("x","y","w","h","angle","r","fill","smear"),rescale=register("rescale",function(o,e){return e.mul(x$1(o).w(o).y(o).h(o))}),moveXY=register("moveXY",function(o,e,a){return a.add(x$1(o).y(e))}),zoomIn=register("zoomIn",function(o,e){const a=pure(1).sub(o).div(2);return e.rescale(o).move(a,a)}),colorMap={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function convertColorToNumber(o){return o=o.toLowerCase(),o[0]==="#"?convertHexToNumber(o):colorMap[o]!==void 0?convertHexToNumber(colorMap[o]):-1}function convertHexToNumber(o){return o=o.slice(1),parseInt(o,16)}const scale$2=(o,e,a)=>o*(a-e)+e,getValue=o=>{let{value:e}=o;typeof o.value!="object"&&(e={value:e});let{note:a,n:l,freq:u,s:p}=e;if(u)return freqToMidi$2(u);if(a=a??l,typeof a=="string")try{return noteToMidi$1(a)}catch{return 0}return typeof a=="number"?a:p?"_"+p:e};Pattern$1.prototype.pianoroll=function(o={}){let{cycles:e=4,playhead:a=.5,overscan:l=0,hideNegative:u=!1,ctx:p=getDrawContext(),id:d=1}=o,f=-e*a,g=e*(1-a);const b=(A,S)=>(!u||A.whole.begin>=0)&&A.isWithinTime(S+f,S+g);return this.draw((A,S)=>{__pianoroll({...o,time:S,ctx:p,haps:A.filter(M=>b(M,S))})},{lookbehind:f-l,lookahead:g+l,id:d}),this};function pianoroll(o){return isPattern(o)?o.pianoroll():e=>e.pianoroll(o)}function __pianoroll({time:o,haps:e,cycles:a=4,playhead:l=.5,flipTime:u=0,flipValues:p=0,hideNegative:d=!1,inactive:f=getTheme().foreground,active:g=getTheme().foreground,background:b="transparent",smear:A=0,playheadColor:S=getTheme().foreground,minMidi:M=10,maxMidi:E=90,autorange:F=0,timeframe:$,fold:Z=1,vertical:V=0,labels:K=!1,fill:se=1,fillActive:z=!1,strokeActive:U=!0,stroke:ee,hideInactive:ae=0,colorizeInactive:de=1,fontFamily:ke,ctx:Oe,id:De}={}){const Ae=Oe.canvas.width,Pe=Oe.canvas.height;let We=-a*l,qe=a*(1-l);De&&(e=e.filter(Wt=>Wt.hasTag(De))),$&&(console.warn("timeframe is deprecated! use from/to instead"),We=0,qe=$);const at=V?Pe:Ae,yt=V?Ae:Pe;let ut=V?[at,0]:[0,at];const Dt=qe-We,$t=V?[0,yt]:[yt,0];let Bt=E-M+1,$e=yt/Bt,bt=[];u&&ut.reverse(),p&&$t.reverse();const{min:nn,max:Zt,values:Rt}=e.reduce(({min:Wt,max:tn,values:wn},dn)=>{const rn=getValue(dn);return{min:rn<Wt?rn:Wt,max:rn>tn?rn:tn,values:wn.includes(rn)?wn:[...wn,rn]}},{min:1/0,max:-1/0,values:[]});F&&(M=nn,E=Zt,Bt=E-M+1),bt=Rt.sort((Wt,tn)=>typeof Wt=="number"&&typeof tn=="number"?Wt-tn:typeof Wt=="number"?1:String(Wt).localeCompare(String(tn))),$e=Z?yt/bt.length:yt/Bt,Oe.fillStyle=b,Oe.globalAlpha=1,A||(Oe.clearRect(0,0,Ae,Pe),Oe.fillRect(0,0,Ae,Pe)),e.forEach(Wt=>{const tn=Wt.whole.begin<=o&&Wt.endClipped>o;let wn=ee??(U&&tn),dn=!tn&&se||tn&&z;if(ae&&!tn)return;let rn=Wt.value?.color;g=rn||g,f=de&&rn||f,rn=tn?g:f,Oe.fillStyle=dn?rn:"transparent",Oe.strokeStyle=rn;const{velocity:Zn=1,gain:ln=1}=Wt.value||{};Oe.globalAlpha=Zn*ln;const zn=(Wt.whole.begin-(u?qe:We))/Dt,cn=scale$2(zn,...ut);let Bn=scale$2(Wt.duration/Dt,0,at);const ei=getValue(Wt),ve=Z?bt.indexOf(ei)/bt.length:(Number(ei)-M)/Bt,Ce=scale$2(ve,...$t);let _e=0;const Ie=scale$2(o/Dt,...ut);let ot;if(V?ot=[Ce+1-(p?$e:0),at-Ie+cn+_e+1-(u?0:Bn),$e-2,Bn-2]:ot=[cn-Ie+_e+1-(u?Bn:0),Ce+1-(p?0:$e),Bn-2,$e-2],wn&&Oe.strokeRect(...ot),dn&&Oe.fillRect(...ot),K){const ft=Wt.value.note??Wt.value.s+(Wt.value.n?`:${Wt.value.n}`:""),{label:tt,activeLabel:Mt}=Wt.value,Ot=(tn&&Mt||tt)??ft;let kt=V?Bn:$e*.75;Oe.font=`${kt}px ${ke||"monospace"}`,Oe.fillStyle=dn?"black":rn,Oe.textBaseline="top",Oe.fillText(Ot,...ot)}}),Oe.globalAlpha=1;const qt=scale$2(-We/Dt,...ut);return Oe.strokeStyle=S,Oe.beginPath(),V?(Oe.moveTo(0,qt),Oe.lineTo(yt,qt)):(Oe.moveTo(qt,0),Oe.lineTo(qt,yt)),Oe.stroke(),this}function getDrawOptions(o,e={}){let[a,l]=o;a=Math.abs(a);const u=l+a,p=u!==0?a/u:0;return{fold:1,...e,cycles:u,playhead:p}}const getPunchcardPainter=(o={})=>(e,a,l,u)=>__pianoroll({ctx:e,time:a,haps:l,...getDrawOptions(u,o)});Pattern$1.prototype.punchcard=function(o){return this.onPaint(getPunchcardPainter(o))},Pattern$1.prototype.wordfall=function(o){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...o})};function drawPianoroll(o){const{drawTime:e,...a}=o;__pianoroll({...getDrawOptions(e),...a})}function fromPolar(o,e,a,l){const u=(o-90)*Math.PI/180;return[a+Math.cos(u)*e,l+Math.sin(u)*e]}const xyOnSpiral=(o,e,a,l,u=0)=>fromPolar((o+u)*360,e*o,a,l);function spiralSegment(o){let{ctx:e,from:a=0,to:l=3,margin:u=50,cx:p=100,cy:d=100,rotate:f=0,thickness:g=u/2,color:b=getTheme().foreground,cap:A="round",stretch:S=1,fromOpacity:M=1,toOpacity:E=1}=o;a*=S,l*=S,f*=S,e.lineWidth=g,e.lineCap=A,e.strokeStyle=b,e.globalAlpha=M,e.beginPath();let[F,$]=xyOnSpiral(a,u,p,d,f);e.moveTo(F,$);const Z=1/60;let V=a;for(;V<=l;){const[K,se]=xyOnSpiral(V,u,p,d,f);e.globalAlpha=(V-a)/(l-a)*E,e.lineTo(K,se),V+=Z}e.stroke()}function drawSpiral(o){let{stretch:e=1,size:a=80,thickness:l=a/2,cap:u="butt",inset:p=3,playheadColor:d="#ffffff",playheadLength:f=.02,playheadThickness:g=l,padding:b=0,steady:A=1,activeColor:S=getTheme().foreground,inactiveColor:M=getTheme().gutterForeground,colorizeInactive:E=0,fade:F=!0,ctx:$,time:Z,haps:V,drawTime:K,id:se}=o;se&&(V=V.filter(Ae=>Ae.hasTag(se)));const[z,U]=[$.canvas.width,$.canvas.height];$.clearRect(0,0,z*2,U*2);const[ee,ae]=[z/2,U/2],de={margin:a/e,cx:ee,cy:ae,stretch:e,cap:u,thickness:l},ke={...de,thickness:g,from:p-f,to:p,color:d},[Oe]=K,De=A*Z;V.forEach(Ae=>{const Pe=Ae.whole.begin<=Z&&Ae.endClipped>Z,We=Ae.whole.begin-Z+p,qe=Ae.endClipped-Z+p-b,at=Ae.value?.color||S,yt=E||Pe?at:M,ut=F?1-Math.abs((Ae.whole.begin-Z)/Oe):1;spiralSegment({ctx:$,...de,from:We,to:qe,rotate:De,color:yt,fromOpacity:ut,toOpacity:ut})}),spiralSegment({ctx:$,...ke,rotate:De})}Pattern$1.prototype.spiral=function(o={}){return this.onPaint((e,a,l,u)=>drawSpiral({ctx:e,time:a,haps:l,drawTime:u,...o}))};const c=midiToFreq$2(36),circlePos=(o,e,a,l)=>{l=l*Math.PI*2;const u=Math.sin(l)*a+o,p=Math.cos(l)*a+e;return[u,p]},freq2angle=(o,e)=>.5-Math.log2(o/e)%1;function pitchwheel({haps:o,ctx:e,id:a,hapcircles:l=1,circle:u=0,edo:p=12,root:d=c,thickness:f=3,hapRadius:g=6,mode:b="flake",margin:A=10}={}){const S=b==="polygon",M=b==="flake",E=e.canvas.width,F=e.canvas.height;e.clearRect(0,0,E,F);const $=getTheme().foreground,V=Math.min(E,F)/2-f/2-g-A,K=E/2,se=F/2;a&&(o=o.filter(U=>U.hasTag(a))),e.strokeStyle=$,e.fillStyle=$,e.globalAlpha=1,e.lineWidth=f,u&&(e.beginPath(),e.arc(K,se,V,0,2*Math.PI),e.stroke()),p&&(Array.from({length:p},(U,ee)=>{const ae=freq2angle(d*Math.pow(2,ee/p),d),[de,ke]=circlePos(K,se,V,ae);e.beginPath(),e.arc(de,ke,g,0,2*Math.PI),e.fill()}),e.stroke());let z=[];e.lineWidth=g,o.forEach(U=>{let ee;try{ee=getFrequency(U)}catch{return}const ae=freq2angle(ee,d),[de,ke]=circlePos(K,se,V,ae),Oe=U.value.color||$;e.strokeStyle=Oe,e.fillStyle=Oe;const{velocity:De=1,gain:Ae=1}=U.value||{},Pe=De*Ae;e.globalAlpha=Pe,z.push([de,ke,ae,Oe,Pe]),e.beginPath(),l&&(e.moveTo(de+g,ke),e.arc(de,ke,g,0,2*Math.PI),e.fill()),M&&(e.moveTo(K,se),e.lineTo(de,ke)),e.stroke()}),e.strokeStyle=$,e.globalAlpha=1,S&&z.length&&(z=z.sort((U,ee)=>U[2]-ee[2]),e.beginPath(),e.moveTo(z[0][0],z[0][1]),z.forEach(([U,ee,ae,de,ke])=>{e.strokeStyle=de,e.globalAlpha=ke,e.lineTo(U,ee)}),e.lineTo(z[0][0],z[0][1]),e.stroke())}Pattern$1.prototype.pitchwheel=function(o={}){let{ctx:e=getDrawContext(),id:a=1}=o;return this.tag(a).onPaint((l,u,p)=>pitchwheel({...o,ctx:e,haps:p.filter(d=>d.isActive(u)),id:a}))};const strudelDraw=Object.freeze(Object.defineProperty({__proto__:null,Drawer:Drawer$1,Framer,__pianoroll,angle,cleanupDraw,colorMap,convertColorToNumber,convertHexToNumber,drawPianoroll,fill,getComputedPropertyValue,getDrawContext,getDrawOptions,getPunchcardPainter,getTheme,h,moveXY,pianoroll,pitchwheel,r,rescale,setTheme,smear,w,x:x$1,y,zoomIn},Symbol.toStringTag,{value:"Module"}));function drawTimeScope(o,{align:e=!0,color:a="white",thickness:l=3,scale:u=.25,pos:p=.75,trigger:d=0,ctx:f=getDrawContext(),id:g=1}={}){f.lineWidth=l,f.strokeStyle=a;let b=f.canvas;if(!o){f.beginPath();let $=p*b.height;f.moveTo(0,$),f.lineTo(b.width,$),f.stroke();return}const A=getAnalyzerData("time",g);f.beginPath();const S=o.frequencyBinCount;let M=e?Array.from(A).findIndex(($,Z,V)=>Z&&V[Z-1]>-d&&$<=-d):0;M=Math.max(M,0);const E=b.width*1/S;let F=0;for(let $=M;$<S;$++){const Z=A[$]+1,V=(p-u*(Z-1))*b.height;$===0?f.moveTo(F,V):f.lineTo(F,V),F+=E}f.stroke()}function drawFrequencyScope(o,{color:e="white",scale:a=.25,pos:l=.75,lean:u=.5,min:p=-150,max:d=0,ctx:f=getDrawContext(),id:g=1}={}){if(!o){f.beginPath();let F=l*A.height;f.moveTo(0,F),f.lineTo(A.width,F),f.stroke();return}const b=getAnalyzerData("frequency",g),A=f.canvas;f.fillStyle=e;const S=o.frequencyBinCount,M=A.width*1/S;let E=0;for(let F=0;F<S;F++){const Z=clamp$1((b[F]-p)/(d-p),0,1)*a,V=Z*A.height,K=(l-Z*u)*A.height;f.fillRect(E,K,Math.max(M,1),V),E+=M}}function clearScreen(o=0,e="0,0,0",a=getDrawContext()){o?(a.fillStyle=`rgba(${e},${1-o})`,a.fillRect(0,0,a.canvas.width,a.canvas.height)):a.clearRect(0,0,a.canvas.width,a.canvas.height)}Pattern$1.prototype.fscope=function(o={}){let e=o.id??1;return this.analyze(e).draw(()=>{clearScreen(o.smear,"0,0,0",o.ctx),analysers[e]&&drawFrequencyScope(analysers[e],o)},{id:e})},Pattern$1.prototype.tscope=function(o={}){let e=o.id??1;return this.analyze(e).draw(a=>{o.color=a[0]?.value?.color||getTheme().foreground,o.color,clearScreen(o.smear,"0,0,0",o.ctx),drawTimeScope(analysers[e],o)},{id:e})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;let latestColor={};Pattern$1.prototype.spectrum=function(o={}){let e=o.id??1;return this.analyze(e).draw(a=>{o.color=a[0]?.value?.color||latestColor[e]||getTheme().foreground,latestColor[e]=o.color,drawSpectrum(analysers[e],o)},{id:e})},Pattern$1.prototype.scope=Pattern$1.prototype.tscope;const lastFrames=new Map;function drawSpectrum(o,{thickness:e=3,speed:a=1,min:l=-80,max:u=0,ctx:p=getDrawContext(),id:d=1,color:f}={}){if(p.lineWidth=e,p.strokeStyle=f,!o)return;const g=a,b=getAnalyzerData("frequency",d),A=p.canvas;p.fillStyle=f;const S=o.frequencyBinCount;let M=lastFrames.get(d)||p.getImageData(0,0,A.width,A.height);lastFrames.set(d,M),p.clearRect(0,0,p.canvas.width,p.canvas.height),p.putImageData(M,-g,0);let E=A.width-a;for(let F=0;F<S;F++){const $=clamp$1((b[F]-l)/(u-l),0,1);p.globalAlpha=$;const Z=Math.log(F+1)/Math.log(S)*A.height;p.fillRect(E,A.height-Z,g,2)}lastFrames.set(d,p.getImageData(0,0,A.width,A.height))}const strudelWebAudio=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY,Warpmode,aliasBank,get analysers(){return analysers},get analysersData(){return analysersData},applyFM,applyGainCurve,applyParameterModulators,connectToDestination,createFilter,destroyAudioWorkletNode,distortionAlgorithms,dough,doughTrigger,doughsamples,drawFrequencyScope,drawTimeScope,drywet,dspWorklet,effectSend,errorLogger,gainNode,getADSRValues,getAnalyserById,getAnalyzerData,getAudioContext,getAudioContextCurrentTime,getAudioDevices,getCachedBuffer,getCompressor,getDefaultValue,getDistortion,getDistortionAlgorithm,getFrequencyFromValue,getLfo,getLoadedBuffer,getOscillator,getParamADSR,getParamLfo,getPitchEnvelope,getSampleBuffer,getSampleBufferSource,getSampleInfo,getSound,getSuperdoughAudioController,getVibratoOscillator,getWorklet,getZZFX,initAudio:initAudio$1,initAudioOnFirstClick,loadBuffer:loadBuffer$1,logger:logger$1,noises,onTriggerSample,onTriggerSynth,processSampleMap,registerSampleSource,registerSamplesPrefix,registerSound,registerSynthSounds:registerSynthSounds$1,registerWaveTable,registerWorklet,registerZZFXSounds,resetDefaultValues,resetDefaults,resetGlobalEffects,resetLoadedSounds,reverseBuffer,samples:samples$1,scheduleAtTime,setDefault,setDefaultAudioContext,setDefaultValue,setDefaultValues,setGainCurve,setLogger,setMaxPolyphony,setMultiChannelOrbits,setVersionDefaults,soundAlias,soundMap:soundMap$1,superdough,superdoughTrigger,tables,waveformN,webAudioTimeout,webaudioOutput,webaudioRepl},Symbol.toStringTag,{value:"Module"}));function isNamedPitch$1(o){return o!==null&&typeof o=="object"&&"name"in o&&typeof o.name=="string"}function isPitch$1(o){return o!==null&&typeof o=="object"&&"step"in o&&typeof o.step=="number"&&"alt"in o&&typeof o.alt=="number"&&!isNaN(o.step)&&!isNaN(o.alt)}var FIFTHS$1=[0,2,4,-1,1,3,5],STEPS_TO_OCTS$1=FIFTHS$1.map(o=>Math.floor(o*7/12));function coordinates$1(o){const{step:e,alt:a,oct:l,dir:u=1}=o,p=FIFTHS$1[e]+7*a;if(l===void 0)return[u*p];const d=l-STEPS_TO_OCTS$1[e]-4*a;return[u*p,u*d]}var FIFTHS_TO_STEPS$1=[3,0,4,1,5,2,6];function pitch$1(o){const[e,a,l]=o,u=FIFTHS_TO_STEPS$1[unaltered$1(e)],p=Math.floor((e+1)/7);if(a===void 0)return{step:u,alt:p,dir:l};const d=a+4*p+STEPS_TO_OCTS$1[u];return{step:u,alt:p,oct:d,dir:l}}function unaltered$1(o){const e=(o+1)%7;return e<0?7+e:e}var fillStr$5=(o,e)=>Array(Math.abs(e)+1).join(o),NoInterval$1=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),INTERVAL_TONAL_REGEX$1="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX$1="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$8=new RegExp("^"+INTERVAL_TONAL_REGEX$1+"|"+INTERVAL_SHORTHAND_REGEX$1+"$");function tokenizeInterval$1(o){const e=REGEX$8.exec(`${o}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var cache$5={};function interval$1(o){return typeof o=="string"?cache$5[o]||(cache$5[o]=parse$6(o)):isPitch$1(o)?interval$1(pitchName$3(o)):isNamedPitch$1(o)?interval$1(o.name):NoInterval$1}var SIZES$2=[0,2,4,5,7,9,11],TYPES$1="PMMPPMM";function parse$6(o){const e=tokenizeInterval$1(o);if(e[0]==="")return NoInterval$1;const a=+e[0],l=e[1],u=(Math.abs(a)-1)%7,p=TYPES$1[u];if(p==="M"&&l==="P")return NoInterval$1;const d=p==="M"?"majorable":"perfectable",f=""+a+l,g=a<0?-1:1,b=a===8||a===-8?a:g*(u+1),A=qToAlt$1(d,l),S=Math.floor((Math.abs(a)-1)/7),M=g*(SIZES$2[u]+A+12*S),E=(g*(SIZES$2[u]+A)%12+12)%12,F=coordinates$1({step:u,alt:A,oct:S,dir:g});return{empty:!1,name:f,num:a,q:l,step:u,alt:A,dir:g,type:d,simple:b,semitones:M,chroma:E,coord:F,oct:S}}function coordToInterval$1(o,e){const[a,l=0]=o,u=a*7+l*12<0,p=e||u?[-a,-l,-1]:[a,l,1];return interval$1(pitch$1(p))}function qToAlt$1(o,e){return e==="M"&&o==="majorable"||e==="P"&&o==="perfectable"?0:e==="m"&&o==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(o==="perfectable"?e.length:e.length+1):0}function pitchName$3(o){const{step:e,alt:a,oct:l=0,dir:u}=o;if(!u)return"";const p=e+1+7*l,d=p===0?e+1:p,f=u<0?"-":"",g=TYPES$1[e]==="M"?"majorable":"perfectable";return f+d+altToQ$1(g,a)}function altToQ$1(o,e){return e===0?o==="majorable"?"M":"P":e===-1&&o==="majorable"?"m":e>0?fillStr$5("A",e):fillStr$5("d",o==="perfectable"?e:e+1)}var fillStr$4=(o,e)=>Array(Math.abs(e)+1).join(o),NoNote$1=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),cache$4=new Map,stepToLetter$1=o=>"CDEFGAB".charAt(o),altToAcc$1=o=>o<0?fillStr$4("b",-o):fillStr$4("#",o),accToAlt$1=o=>o[0]==="b"?-o.length:o.length;function note$1(o){const e=JSON.stringify(o),a=cache$4.get(e);if(a)return a;const l=typeof o=="string"?parse$5(o):isPitch$1(o)?note$1(pitchName$2(o)):isNamedPitch$1(o)?note$1(o.name):NoNote$1;return cache$4.set(e,l),l}var REGEX$7=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote$1(o){const e=REGEX$7.exec(o);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function coordToNote$1(o){return note$1(pitch$1(o))}var mod$1=(o,e)=>(o%e+e)%e,SEMI$1=[0,2,4,5,7,9,11];function parse$5(o){const e=tokenizeNote$1(o);if(e[0]===""||e[3]!=="")return NoNote$1;const a=e[0],l=e[1],u=e[2],p=(a.charCodeAt(0)+3)%7,d=accToAlt$1(l),f=u.length?+u:void 0,g=coordinates$1({step:p,alt:d,oct:f}),b=a+l+u,A=a+l,S=(SEMI$1[p]+d+120)%12,M=f===void 0?mod$1(SEMI$1[p]+d,12)-1188:SEMI$1[p]+d+12*(f+1),E=M>=0&&M<=127?M:null,F=f===void 0?null:Math.pow(2,(M-69)/12)*440;return{empty:!1,acc:l,alt:d,chroma:S,coord:g,freq:F,height:M,letter:a,midi:E,name:b,oct:f,pc:A,step:p}}function pitchName$2(o){const{step:e,alt:a,oct:l}=o,u=stepToLetter$1(e);if(!u)return"";const p=u+altToAcc$1(a);return l||l===0?p+l:p}function transpose$5(o,e){const a=note$1(o),l=Array.isArray(e)?e:interval$1(e).coord;if(a.empty||!l||l.length<2)return"";const u=a.coord,p=u.length===1?[u[0]+l[0]]:[u[0]+l[0],u[1]+l[1]];return coordToNote$1(p).name}function tonicIntervalsTransposer$1(o,e){const a=o.length;return l=>{if(!e)return"";const u=l<0?(a- -l%a)%a:l%a,p=Math.floor(l/a),d=transpose$5(e,[0,p]);return transpose$5(d,o[u])}}function distance$5(o,e){const a=note$1(o),l=note$1(e);if(a.empty||l.empty)return"";const u=a.coord,p=l.coord,d=p[0]-u[0],f=u.length===2&&p.length===2?p[1]-u[1]:-Math.floor(d*7/12),g=l.height===a.height&&l.midi!==null&&a.oct===l.oct&&a.step>l.step;return coordToInterval$1([d,f],g).name}var fillStr$3=(o,e)=>Array(e+1).join(o),REGEX$6=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function tokenize$4(o){const e=REGEX$6.exec(o);return e?[e[1],e[2],e[3]]:["","",""]}function abcToScientificNotation(o){const[e,a,l]=tokenize$4(o);if(a==="")return"";let u=4;for(let d=0;d<l.length;d++)u+=l.charAt(d)===","?-1:1;const p=e[0]==="_"?e.replace(/_/g,"b"):e[0]==="^"?e.replace(/\^/g,"#"):"";return a.charCodeAt(0)>96?a.toUpperCase()+p+(u+1):a+p+u}function scientificToAbcNotation(o){const e=note$1(o);if(e.empty||!e.oct&&e.oct!==0)return"";const{letter:a,acc:l,oct:u}=e,p=l[0]==="b"?l.replace(/b/g,"_"):l.replace(/#/g,"^"),d=u>4?a.toLowerCase():a,f=u===5?"":u>4?fillStr$3("'",u-5):fillStr$3(",",4-u);return p+d+f}function transpose$4(o,e){return scientificToAbcNotation(transpose$5(abcToScientificNotation(o),e))}function distance$4(o,e){return distance$5(abcToScientificNotation(o),abcToScientificNotation(e))}var abc_notation_default={abcToScientificNotation,scientificToAbcNotation,tokenize:tokenize$4,transpose:transpose$4,distance:distance$4};function ascR$1(o,e){const a=[];for(;e--;a[e]=e+o);return a}function descR$1(o,e){const a=[];for(;e--;a[e]=o-e);return a}function range$1(o,e){return o<e?ascR$1(o,e-o+1):descR$1(o,o-e+1)}function rotate$1(o,e){const a=e.length,l=(o%a+a)%a;return e.slice(l,a).concat(e.slice(0,l))}function compact$1(o){return o.filter(e=>e===0||e)}function sortedNoteNames(o){return o.map(a=>note$1(a)).filter(a=>!a.empty).sort((a,l)=>a.height-l.height).map(a=>a.name)}function sortedUniqNoteNames(o){return sortedNoteNames(o).filter((e,a,l)=>a===0||e!==l[a-1])}function shuffle$1(o,e=Math.random){let a,l,u=o.length;for(;u;)a=Math.floor(e()*u--),l=o[u],o[u]=o[a],o[a]=l;return o}function permutations$1(o){return o.length===0?[[]]:permutations$1(o.slice(1)).reduce((e,a)=>e.concat(o.map((l,u)=>{const p=a.slice();return p.splice(u,0,o[0]),p})),[])}const index$4=Object.freeze(Object.defineProperty({__proto__:null,compact:compact$1,permutations:permutations$1,range:range$1,rotate:rotate$1,shuffle:shuffle$1,sortedNoteNames,sortedUniqNoteNames},Symbol.toStringTag,{value:"Module"}));function ascR(o,e){const a=[];for(;e--;a[e]=e+o);return a}function descR(o,e){const a=[];for(;e--;a[e]=o-e);return a}function range(o,e){return o<e?ascR(o,e-o+1):descR(o,o-e+1)}function rotate(o,e){const a=e.length,l=(o%a+a)%a;return e.slice(l,a).concat(e.slice(0,l))}function compact(o){return o.filter(e=>e===0||e)}function shuffle(o,e=Math.random){let a,l,u=o.length;for(;u;)a=Math.floor(e()*u--),l=o[u],o[u]=o[a],o[a]=l;return o}function permutations(o){return o.length===0?[[]]:permutations(o.slice(1)).reduce((e,a)=>e.concat(o.map((l,u)=>{const p=a.slice();return p.splice(u,0,o[0]),p})),[])}var collection_default={compact,permutations,range,rotate,shuffle},EmptyPcset={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},setNumToChroma=o=>Number(o).toString(2).padStart(12,"0"),chromaToNumber=o=>parseInt(o,2),REGEX$5=/^[01]{12}$/;function isChroma(o){return REGEX$5.test(o)}var isPcsetNum=o=>typeof o=="number"&&o>=0&&o<=4095,isPcset=o=>o&&isChroma(o.chroma),cache$3={[EmptyPcset.chroma]:EmptyPcset};function get$b(o){const e=isChroma(o)?o:isPcsetNum(o)?setNumToChroma(o):Array.isArray(o)?listToChroma(o):isPcset(o)?o.chroma:EmptyPcset.chroma;return cache$3[e]=cache$3[e]||chromaToPcset(e)}var pcset$1=get$b,chroma$3=o=>get$b(o).chroma,intervals=o=>get$b(o).intervals,num$1=o=>get$b(o).setNum,IVLS=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function chromaToIntervals(o){const e=[];for(let a=0;a<12;a++)o.charAt(a)==="1"&&e.push(IVLS[a]);return e}function notes$1(o){return get$b(o).intervals.map(e=>transpose$5("C",e))}function chromas(){return range(2048,4095).map(setNumToChroma)}function modes$1(o,e=!0){const l=get$b(o).chroma.split("");return compact(l.map((u,p)=>{const d=rotate(p,l);return e&&d[0]==="0"?null:d.join("")}))}function isEqual(o,e){return get$b(o).setNum===get$b(e).setNum}function isSubsetOf(o){const e=get$b(o).setNum;return a=>{const l=get$b(a).setNum;return e&&e!==l&&(l&e)===l}}function isSupersetOf(o){const e=get$b(o).setNum;return a=>{const l=get$b(a).setNum;return e&&e!==l&&(l|e)===l}}function isNoteIncludedIn(o){const e=get$b(o);return a=>{const l=note$1(a);return e&&!l.empty&&e.chroma.charAt(l.chroma)==="1"}}function filter(o){const e=isNoteIncludedIn(o);return a=>a.filter(e)}var pcset_default={get:get$b,chroma:chroma$3,num:num$1,intervals,chromas,isSupersetOf,isSubsetOf,isNoteIncludedIn,isEqual,filter,modes:modes$1,notes:notes$1,pcset:pcset$1};function chromaRotations(o){const e=o.split("");return e.map((a,l)=>rotate(l,e).join(""))}function chromaToPcset(o){const e=chromaToNumber(o),a=chromaRotations(o).map(chromaToNumber).filter(p=>p>=2048).sort()[0],l=setNumToChroma(a),u=chromaToIntervals(o);return{empty:!1,name:"",setNum:e,chroma:o,normalized:l,intervals:u}}function listToChroma(o){if(o.length===0)return EmptyPcset.chroma;let e;const a=[0,0,0,0,0,0,0,0,0,0,0,0];for(let l=0;l<o.length;l++)e=note$1(o[l]),e.empty&&(e=interval$1(o[l])),e.empty||(a[e.chroma]=1);return a.join("")}var CHORDS$1=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$3=CHORDS$1;({...EmptyPcset});var dictionary$2=[],index$3={};function all$3(){return dictionary$2.slice()}function add$4(o,e,a){const l=getQuality$1(o),u={...get$b(o),name:a||"",quality:l,intervals:o,aliases:e};dictionary$2.push(u),u.name&&(index$3[u.name]=u),index$3[u.setNum]=u,index$3[u.chroma]=u,u.aliases.forEach(p=>addAlias$2(u,p))}function addAlias$2(o,e){index$3[e]=o}function getQuality$1(o){const e=a=>o.indexOf(a)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}data_default$3.forEach(([o,e,a])=>add$4(o.split(" "),a.split(" "),e)),dictionary$2.sort((o,e)=>o.setNum-e.setNum);var namedSet=o=>{const e=o.reduce((a,l)=>{const u=note$1(l).chroma;return u!==void 0&&(a[u]=a[u]||note$1(l).name),a},{});return a=>e[a]};function detect$1(o,e={}){const a=o.map(u=>note$1(u).pc).filter(u=>u);return note$1.length===0?[]:findMatches(a,1,e).filter(u=>u.weight).sort((u,p)=>p.weight-u.weight).map(u=>u.name)}var BITMASK={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},testChromaNumber=o=>e=>!!(e&o),hasAnyThird=testChromaNumber(BITMASK.anyThirds),hasPerfectFifth=testChromaNumber(BITMASK.perfectFifth),hasAnySeventh=testChromaNumber(BITMASK.anySeventh),hasNonPerfectFifth=testChromaNumber(BITMASK.nonPerfectFifths);function hasAnyThirdAndPerfectFifthAndAnySeventh(o){const e=parseInt(o.chroma,2);return hasAnyThird(e)&&hasPerfectFifth(e)&&hasAnySeventh(e)}function withPerfectFifth(o){const e=parseInt(o,2);return hasNonPerfectFifth(e)?o:(e|16).toString(2)}function findMatches(o,e,a){const l=o[0],u=note$1(l).chroma,p=namedSet(o),d=modes$1(o,!1),f=[];return d.forEach((g,b)=>{const A=a.assumePerfectFifth&&withPerfectFifth(g);all$3().filter(M=>a.assumePerfectFifth&&hasAnyThirdAndPerfectFifthAndAnySeventh(M)?M.chroma===A:M.chroma===g).forEach(M=>{const E=M.aliases[0],F=p(b);b!==u?f.push({weight:.5*e,name:`${F}${E}/${l}`}):f.push({weight:1*e,name:`${F}${E}`})})}),f}function isNamedPitch(o){return o!==null&&typeof o=="object"&&"name"in o&&typeof o.name=="string"}var SIZES$1=[0,2,4,5,7,9,11],chroma$2=({step:o,alt:e})=>(SIZES$1[o]+e+120)%12,height=({step:o,alt:e,oct:a,dir:l=1})=>l*(SIZES$1[o]+e+12*(a===void 0?-100:a)),midi$1=o=>{const e=height(o);return o.oct!==void 0&&e>=-12&&e<=115?e+12:null};function isPitch(o){return o!==null&&typeof o=="object"&&"step"in o&&typeof o.step=="number"&&"alt"in o&&typeof o.alt=="number"}var FIFTHS=[0,2,4,-1,1,3,5],STEPS_TO_OCTS=FIFTHS.map(o=>Math.floor(o*7/12));function coordinates(o){const{step:e,alt:a,oct:l,dir:u=1}=o,p=FIFTHS[e]+7*a;if(l===void 0)return[u*p];const d=l-STEPS_TO_OCTS[e]-4*a;return[u*p,u*d]}var FIFTHS_TO_STEPS=[3,0,4,1,5,2,6];function pitch(o){const[e,a,l]=o,u=FIFTHS_TO_STEPS[unaltered(e)],p=Math.floor((e+1)/7);if(a===void 0)return{step:u,alt:p,dir:l};const d=a+4*p+STEPS_TO_OCTS[u];return{step:u,alt:p,oct:d,dir:l}}function unaltered(o){const e=(o+1)%7;return e<0?7+e:e}var fillStr$2=(o,e)=>Array(Math.abs(e)+1).join(o),NoInterval={empty:!0,name:"",acc:""},INTERVAL_TONAL_REGEX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",INTERVAL_SHORTHAND_REGEX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",REGEX$4=new RegExp("^"+INTERVAL_TONAL_REGEX+"|"+INTERVAL_SHORTHAND_REGEX+"$");function tokenizeInterval(o){const e=REGEX$4.exec(`${o}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var cache$2={};function interval(o){return typeof o=="string"?cache$2[o]||(cache$2[o]=parse$4(o)):isPitch(o)?interval(pitchName$1(o)):isNamedPitch(o)?interval(o.name):NoInterval}var SIZES=[0,2,4,5,7,9,11],TYPES="PMMPPMM";function parse$4(o){const e=tokenizeInterval(o);if(e[0]==="")return NoInterval;const a=+e[0],l=e[1],u=(Math.abs(a)-1)%7,p=TYPES[u];if(p==="M"&&l==="P")return NoInterval;const d=p==="M"?"majorable":"perfectable",f=""+a+l,g=a<0?-1:1,b=a===8||a===-8?a:g*(u+1),A=qToAlt(d,l),S=Math.floor((Math.abs(a)-1)/7),M=g*(SIZES[u]+A+12*S),E=(g*(SIZES[u]+A)%12+12)%12,F=coordinates({step:u,alt:A,oct:S,dir:g});return{empty:!1,name:f,num:a,q:l,step:u,alt:A,dir:g,type:d,simple:b,semitones:M,chroma:E,coord:F,oct:S}}function coordToInterval(o,e){const[a,l=0]=o,u=a*7+l*12<0,p=e||u?[-a,-l,-1]:[a,l,1];return interval(pitch(p))}function qToAlt(o,e){return e==="M"&&o==="majorable"||e==="P"&&o==="perfectable"?0:e==="m"&&o==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(o==="perfectable"?e.length:e.length+1):0}function pitchName$1(o){const{step:e,alt:a,oct:l=0,dir:u}=o;if(!u)return"";const p=e+1+7*l,d=p===0?e+1:p,f=u<0?"-":"",g=TYPES[e]==="M"?"majorable":"perfectable";return f+d+altToQ(g,a)}function altToQ(o,e){return e===0?o==="majorable"?"M":"P":e===-1&&o==="majorable"?"m":e>0?fillStr$2("A",e):fillStr$2("d",o==="perfectable"?e:e+1)}var fillStr$1=(o,e)=>Array(Math.abs(e)+1).join(o),NoNote={empty:!0,name:"",pc:"",acc:""},cache$1=new Map,stepToLetter=o=>"CDEFGAB".charAt(o),altToAcc=o=>o<0?fillStr$1("b",-o):fillStr$1("#",o),accToAlt=o=>o[0]==="b"?-o.length:o.length;function note(o){const e=JSON.stringify(o),a=cache$1.get(e);if(a)return a;const l=typeof o=="string"?parse$3(o):isPitch(o)?note(pitchName(o)):isNamedPitch(o)?note(o.name):NoNote;return cache$1.set(e,l),l}var REGEX$3=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function tokenizeNote(o){const e=REGEX$3.exec(o);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function coordToNote(o){return note(pitch(o))}var mod=(o,e)=>(o%e+e)%e,SEMI=[0,2,4,5,7,9,11];function parse$3(o){const e=tokenizeNote(o);if(e[0]===""||e[3]!=="")return NoNote;const a=e[0],l=e[1],u=e[2],p=(a.charCodeAt(0)+3)%7,d=accToAlt(l),f=u.length?+u:void 0,g=coordinates({step:p,alt:d,oct:f}),b=a+l+u,A=a+l,S=(SEMI[p]+d+120)%12,M=f===void 0?mod(SEMI[p]+d,12)-1188:SEMI[p]+d+12*(f+1),E=M>=0&&M<=127?M:null,F=f===void 0?null:Math.pow(2,(M-69)/12)*440;return{empty:!1,acc:l,alt:d,chroma:S,coord:g,freq:F,height:M,letter:a,midi:E,name:b,oct:f,pc:A,step:p}}function pitchName(o){const{step:e,alt:a,oct:l}=o,u=stepToLetter(e);if(!u)return"";const p=u+altToAcc(a);return l||l===0?p+l:p}function transpose$3(o,e){const a=note(o),l=Array.isArray(e)?e:interval(e).coord;if(a.empty||!l||l.length<2)return"";const u=a.coord,p=u.length===1?[u[0]+l[0]]:[u[0]+l[0],u[1]+l[1]];return coordToNote(p).name}function tonicIntervalsTransposer(o,e){const a=o.length;return l=>{if(!e)return"";const u=l<0?(a- -l%a)%a:l%a,p=Math.floor(l/a),d=transpose$3(e,[0,p]);return transpose$3(d,o[u])}}function distance$3(o,e){const a=note(o),l=note(e);if(a.empty||l.empty)return"";const u=a.coord,p=l.coord,d=p[0]-u[0],f=u.length===2&&p.length===2?p[1]-u[1]:-Math.floor(d*7/12),g=l.height===a.height&&l.midi!==null&&a.midi!==null&&a.step>l.step;return coordToInterval([d,f],g).name}var fillStr=(o,e)=>Array(Math.abs(e)+1).join(o);function deprecate(o,e,a){return function(...l){return console.warn(`${o} is deprecated. Use ${e}.`),a.apply(this,l)}}var isNamed=deprecate("isNamed","isNamedPitch",isNamedPitch);const Core=Object.freeze(Object.defineProperty({__proto__:null,accToAlt,altToAcc,chroma:chroma$2,coordToInterval,coordToNote,coordinates,deprecate,distance:distance$3,fillStr,height,interval,isNamed,isNamedPitch,isPitch,midi:midi$1,note,pitch,stepToLetter,tokenizeInterval,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"}));var CHORDS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],data_default$2=CHORDS,NoChordType={...EmptyPcset,name:"",quality:"Unknown",intervals:[],aliases:[]},dictionary$1=[],index$2={};function get$a(o){return index$2[o]||NoChordType}var chordType=deprecate("ChordType.chordType","ChordType.get",get$a);function names$8(){return dictionary$1.map(o=>o.name).filter(o=>o)}function symbols(){return dictionary$1.map(o=>o.aliases[0]).filter(o=>o)}function keys$1(){return Object.keys(index$2)}function all$2(){return dictionary$1.slice()}var entries$2=deprecate("ChordType.entries","ChordType.all",all$2);function removeAll$1(){dictionary$1=[],index$2={}}function add$3(o,e,a){const l=getQuality(o),u={...get$b(o),name:a||"",quality:l,intervals:o,aliases:e};dictionary$1.push(u),u.name&&(index$2[u.name]=u),index$2[u.setNum]=u,index$2[u.chroma]=u,u.aliases.forEach(p=>addAlias$1(u,p))}function addAlias$1(o,e){index$2[e]=o}function getQuality(o){const e=a=>o.indexOf(a)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}data_default$2.forEach(([o,e,a])=>add$3(o.split(" "),a.split(" "),e)),dictionary$1.sort((o,e)=>o.setNum-e.setNum);var chord_type_default={names:names$8,symbols,get:get$a,all:all$2,add:add$3,removeAll:removeAll$1,keys:keys$1,entries:entries$2,chordType},SCALES=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],data_default$1=SCALES,NoScaleType={...EmptyPcset,intervals:[],aliases:[]},dictionary=[],index$1={};function names$7(){return dictionary.map(o=>o.name)}function get$9(o){return index$1[o]||NoScaleType}var scaleType=get$9;function all$1(){return dictionary.slice()}var entries$1=all$1;function keys(){return Object.keys(index$1)}function removeAll(){dictionary=[],index$1={}}function add$2(o,e,a=[]){const l={...get$b(o),name:e,intervals:o,aliases:a};return dictionary.push(l),index$1[l.name]=l,index$1[l.setNum]=l,index$1[l.chroma]=l,l.aliases.forEach(u=>addAlias(l,u)),l}function addAlias(o,e){index$1[e]=o}data_default$1.forEach(([o,e,...a])=>add$2(o.split(" "),e,a));var scale_type_default={names:names$7,get:get$9,all:all$1,add:add$2,removeAll,keys,entries:entries$1,scaleType},NoChord={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize$3(o){const[e,a,l,u]=tokenizeNote(o);return e===""?["",o]:e==="A"&&u==="ug"?["","aug"]:[e+a,l+u]}function get$8(o){if(o==="")return NoChord;if(Array.isArray(o)&&o.length===2)return getChord(o[1],o[0]);{const[e,a]=tokenize$3(o),l=getChord(a,e);return l.empty?getChord(o):l}}function getChord(o,e,a){const l=get$a(o),u=note(e||""),p=note(a||"");if(l.empty||e&&u.empty||a&&p.empty)return NoChord;const d=distance$3(u.pc,p.pc),f=l.intervals.indexOf(d)+1;if(!p.empty&&!f)return NoChord;const g=Array.from(l.intervals);for(let M=1;M<f;M++){const E=g[0][0],F=g[0][1],$=parseInt(E,10)+7;g.push(`${$}${F}`),g.shift()}const b=u.empty?[]:g.map(M=>transpose$3(u,M));o=l.aliases.indexOf(o)!==-1?o:l.aliases[0];const A=`${u.empty?"":u.pc}${o}${p.empty||f<=1?"":"/"+p.pc}`,S=`${e?u.pc+" ":""}${l.name}${f>1&&a?" over "+p.pc:""}`;return{...l,name:S,symbol:A,type:l.name,root:p.name,intervals:g,rootDegree:f,tonic:u.name,notes:b}}var chord=deprecate("Chord.chord","Chord.get",get$8);function transpose$2(o,e){const[a,l]=tokenize$3(o);return a?transpose$3(a,e)+l:o}function chordScales(o){const e=get$8(o),a=isSupersetOf(e.chroma);return all$1().filter(l=>a(l.chroma)).map(l=>l.name)}function extended$1(o){const e=get$8(o),a=isSupersetOf(e.chroma);return all$2().filter(l=>a(l.chroma)).map(l=>e.tonic+l.aliases[0])}function reduced$1(o){const e=get$8(o),a=isSubsetOf(e.chroma);return all$2().filter(l=>a(l.chroma)).map(l=>e.tonic+l.aliases[0])}function degrees$1(o){const{intervals:e,tonic:a}=get$8(o),l=tonicIntervalsTransposer(e,a);return u=>u?l(u>0?u-1:u):""}function steps$1(o){const{intervals:e,tonic:a}=get$8(o);return tonicIntervalsTransposer(e,a)}var chord_default={getChord,get:get$8,detect:detect$1,chordScales,extended:extended$1,reduced:reduced$1,tokenize:tokenize$3,transpose:transpose$2,degrees:degrees$1,steps:steps$1,chord},DATA=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],data_default=DATA,VALUES=[];data_default.forEach(([o,e,a])=>add$1(o,e,a));var NoDuration={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function names$6(){return VALUES.reduce((o,e)=>(e.names.forEach(a=>o.push(a)),o),[])}function shorthands(){return VALUES.map(o=>o.shorthand)}var REGEX$2=/^([^.]+)(\.*)$/;function get$7(o){const[e,a,l]=REGEX$2.exec(o)||[],u=VALUES.find(f=>f.shorthand===a||f.names.includes(a));if(!u)return NoDuration;const p=calcDots(u.fraction,l.length),d=p[0]/p[1];return{...u,name:o,dots:l,value:d,fraction:p}}var value=o=>get$7(o).value,fraction=o=>get$7(o).fraction,duration_value_default={names:names$6,shorthands,get:get$7,value,fraction};function add$1(o,e,a){VALUES.push({empty:!1,dots:"",name:"",value:1/o,fraction:o<1?[1/o,1]:[1,o],shorthand:e,names:a})}function calcDots(o,e){const a=Math.pow(2,e);let l=o[0]*a,u=o[1]*a;const p=l;for(let d=0;d<e;d++)l+=p/Math.pow(2,d+1);for(;l%2===0&&u%2===0;)l/=2,u/=2;return[l,u]}function names$5(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var get$6=interval,name$1=o=>interval(o).name,semitones=o=>interval(o).semitones,quality=o=>interval(o).q,num=o=>interval(o).num;function simplify$2(o){const e=interval(o);return e.empty?"":e.simple+e.q}function invert(o){const e=interval(o);if(e.empty)return"";const a=(7-e.step)%7,l=e.type==="perfectable"?-e.alt:-(e.alt+1);return interval({step:a,alt:l,oct:e.oct,dir:e.dir}).name}var IN=[1,2,2,3,3,4,5,5,6,6,7,7],IQ="P m M m M P d P m M m M".split(" ");function fromSemitones(o){const e=o<0?-1:1,a=Math.abs(o),l=a%12,u=Math.floor(a/12);return e*(IN[l]+7*u)+IQ[l]}var distance$2=distance$5,add=combinator((o,e)=>[o[0]+e[0],o[1]+e[1]]),addTo=o=>e=>add(o,e),substract=combinator((o,e)=>[o[0]-e[0],o[1]-e[1]]);function transposeFifths$2(o,e){const a=get$6(o);if(a.empty)return"";const[l,u,p]=a.coord;return coordToInterval([l+e,u,p]).name}var interval_default={names:names$5,get:get$6,name:name$1,num,semitones,quality,fromSemitones,distance:distance$2,invert,simplify:simplify$2,add,addTo,substract,transposeFifths:transposeFifths$2};function combinator(o){return(e,a)=>{const l=interval(e).coord,u=interval(a).coord;if(l&&u){const p=o(l,u);return coordToInterval(p).name}}}function isMidi(o){return+o>=0&&+o<=127}function toMidi(o){if(isMidi(o))return+o;const e=note$1(o);return e.empty?null:e.midi}function midiToFreq(o,e=440){return Math.pow(2,(o-69)/12)*e}var L2=Math.log(2),L440=Math.log(440);function freqToMidi(o){const e=12*(Math.log(o)-L440)/L2+69;return Math.round(e*100)/100}var SHARPS="C C# D D# E F F# G G# A A# B".split(" "),FLATS="C Db D Eb E F Gb G Ab A Bb B".split(" ");function midiToNoteName(o,e={}){if(isNaN(o)||o===-1/0||o===1/0)return"";o=Math.round(o);const l=(e.sharps===!0?SHARPS:FLATS)[o%12];if(e.pitchClass)return l;const u=Math.floor(o/12)-1;return l+u}function chroma$1(o){return o%12}function pcsetFromChroma(o){return o.split("").reduce((e,a,l)=>(l<12&&a==="1"&&e.push(l),e),[])}function pcsetFromMidi(o){return o.map(chroma$1).sort((e,a)=>e-a).filter((e,a,l)=>a===0||e!==l[a-1])}function pcset(o){return Array.isArray(o)?pcsetFromMidi(o):pcsetFromChroma(o)}function pcsetNearest(o){const e=pcset(o);return a=>{const l=chroma$1(a);for(let u=0;u<12;u++){if(e.includes(l+u))return a+u;if(e.includes(l-u))return a-u}}}function pcsetSteps(o,e){const a=pcset(o),l=a.length;return u=>{const p=u<0?(l- -u%l)%l:u%l,d=Math.floor(u/l);return a[p]+d*12+e}}function pcsetDegrees(o,e){const a=pcsetSteps(o,e);return l=>{if(l!==0)return a(l>0?l-1:l)}}var index_default$4={chroma:chroma$1,freqToMidi,isMidi,midiToFreq,midiToNoteName,pcsetNearest,pcset,pcsetDegrees,pcsetSteps,toMidi},NAMES$2=["C","D","E","F","G","A","B"],toName=o=>o.name,onlyNotes=o=>o.map(note$1).filter(e=>!e.empty);function names$4(o){return o===void 0?NAMES$2.slice():Array.isArray(o)?onlyNotes(o).map(toName):[]}var get$5=note$1,name=o=>get$5(o).name,pitchClass=o=>get$5(o).pc,accidentals=o=>get$5(o).acc,octave=o=>get$5(o).oct,midi=o=>get$5(o).midi,freq=o=>get$5(o).freq,chroma=o=>get$5(o).chroma;function fromMidi(o){return midiToNoteName(o)}function fromFreq(o){return midiToNoteName(freqToMidi(o))}function fromFreqSharps(o){return midiToNoteName(freqToMidi(o),{sharps:!0})}function fromMidiSharps(o){return midiToNoteName(o,{sharps:!0})}var distance$1=distance$5,transpose$1=transpose$5,tr=transpose$5,transposeBy=o=>e=>transpose$1(e,o),trBy=transposeBy,transposeFrom=o=>e=>transpose$1(o,e),trFrom=transposeFrom;function transposeFifths$1(o,e){return transpose$1(o,[e,0])}var trFifths=transposeFifths$1;function transposeOctaves(o,e){return transpose$1(o,[0,e])}var ascending=(o,e)=>o.height-e.height,descending=(o,e)=>e.height-o.height;function sortedNames(o,e){return e=e||ascending,onlyNotes(o).sort(e).map(toName)}function sortedUniqNames(o){return sortedNames(o,ascending).filter((e,a,l)=>a===0||e!==l[a-1])}var simplify$1=o=>{const e=get$5(o);return e.empty?"":midiToNoteName(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function enharmonic(o,e){const a=get$5(o);if(a.empty)return"";const l=get$5(e||midiToNoteName(a.midi||a.chroma,{sharps:a.alt<0,pitchClass:!0}));if(l.empty||l.chroma!==a.chroma)return"";if(a.oct===void 0)return l.pc;const u=a.chroma-a.alt,p=l.chroma-l.alt,d=u>11||p<0?-1:u<0||p>11?1:0,f=a.oct+d;return l.pc+f}var index_default$3={names:names$4,get:get$5,name,pitchClass,accidentals,octave,midi,ascending,descending,distance:distance$1,sortedNames,sortedUniqNames,fromMidi,fromMidiSharps,freq,fromFreq,fromFreqSharps,chroma,transpose:transpose$1,tr,transposeBy,trBy,transposeFrom,trFrom,transposeFifths:transposeFifths$1,transposeOctaves,trFifths,simplify:simplify$1,enharmonic},NoRomanNumeral={empty:!0,name:"",chordType:""},cache={};function get$4(o){return typeof o=="string"?cache[o]||(cache[o]=parse$2(o)):typeof o=="number"?get$4(NAMES$1[o]||""):isPitch$1(o)?fromPitch(o):isNamedPitch$1(o)?get$4(o.name):NoRomanNumeral}var romanNumeral=get$4;function names$3(o=!0){return(o?NAMES$1:NAMES_MINOR).slice()}function fromPitch(o){return get$4(altToAcc$1(o.alt)+NAMES$1[o.step])}var REGEX$1=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function tokenize$2(o){return REGEX$1.exec(o)||["","","",""]}var ROMANS="I II III IV V VI VII",NAMES$1=ROMANS.split(" "),NAMES_MINOR=ROMANS.toLowerCase().split(" ");function parse$2(o){const[e,a,l,u]=tokenize$2(o);if(!l)return NoRomanNumeral;const p=l.toUpperCase(),d=NAMES$1.indexOf(p),f=accToAlt$1(a),g=1;return{empty:!1,name:e,roman:l,interval:interval$1({step:d,alt:f,dir:g}).name,acc:a,chordType:u,alt:f,step:d,major:l===p,oct:0,dir:g}}var roman_numeral_default={names:names$3,get:get$4,romanNumeral},Empty=Object.freeze([]),NoKey={type:"major",tonic:"",alteration:0,keySignature:""},NoKeyScale={tonic:"",grades:Empty,intervals:Empty,scale:Empty,triads:Empty,chords:Empty,chordsHarmonicFunction:Empty,chordScales:Empty,secondaryDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty,substituteDominants:Empty,substituteDominantSupertonics:Empty,secondaryDominantsMinorRelative:Empty},NoMajorKey={...NoKey,...NoKeyScale,type:"major",minorRelative:"",scale:Empty,substituteDominants:Empty,secondaryDominantSupertonics:Empty,substituteDominantsMinorRelative:Empty},NoMinorKey={...NoKey,type:"minor",relativeMajor:"",natural:NoKeyScale,harmonic:NoKeyScale,melodic:NoKeyScale},mapScaleToType=(o,e,a="")=>e.map((l,u)=>`${o[u]}${a}${l}`);function keyScale(o,e,a,l,u){return p=>{const d=o.map(E=>get$4(E).interval||""),f=d.map(E=>transpose$1(p,E)),g=mapScaleToType(f,a),b=f.map(E=>transpose$1(E,"5P")).map(E=>f.includes(E)&&!g.includes(E+"7")?E+"7":""),A=supertonics(b,e),S=b.map(E=>{if(!E)return"";const F=E.slice(0,-1);return transpose$1(F,"5d")+"7"}),M=supertonics(S,e);return{tonic:p,grades:o,intervals:d,scale:f,triads:mapScaleToType(f,e),chords:g,chordsHarmonicFunction:l.slice(),chordScales:mapScaleToType(f,u," "),secondaryDominants:b,secondaryDominantSupertonics:A,substituteDominants:S,substituteDominantSupertonics:M,secondaryDominantsMinorRelative:A,substituteDominantsMinorRelative:M}}}var supertonics=(o,e)=>o.map((a,l)=>{if(!a)return"";const u=a.slice(0,-1),p=transpose$1(u,"5P");return e[l].endsWith("m")?p+"m7":p+"m7b5"}),distInFifths=(o,e)=>{const a=note$1(o),l=note$1(e);return a.empty||l.empty?0:l.coord[0]-a.coord[0]},MajorScale=keyScale("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),NaturalScale=keyScale("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),HarmonicScale=keyScale("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),MelodicScale=keyScale("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function majorKey(o){const e=note$1(o).pc;if(!e)return NoMajorKey;const a=MajorScale(e),l=distInFifths("C",e);return{...a,type:"major",minorRelative:transpose$1(e,"-3m"),alteration:l,keySignature:altToAcc$1(l)}}function minorKey(o){const e=note$1(o).pc;if(!e)return NoMinorKey;const a=distInFifths("C",e)-3;return{type:"minor",tonic:e,relativeMajor:transpose$1(e,"3m"),alteration:a,keySignature:altToAcc$1(a),natural:NaturalScale(e),harmonic:HarmonicScale(e),melodic:MelodicScale(e)}}function majorTonicFromKeySignature(o){return typeof o=="number"?transposeFifths$1("C",o):typeof o=="string"&&/^b+|#+$/.test(o)?transposeFifths$1("C",accToAlt$1(o)):null}var index_default$2={majorKey,majorTonicFromKeySignature,minorKey},get$3=interval$1;function simplify(o){const e=interval$1(o);return e.empty?"":e.simple+e.q}function transposeFifths(o,e){const a=get$3(o);if(a.empty)return"";const[l,u,p]=a.coord;return coordToInterval$1([l+e,u,p]).name}var MODES=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],NoMode={...EmptyPcset,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},modes=MODES.map(toMode),index={};modes.forEach(o=>{index[o.name]=o,o.aliases.forEach(e=>{index[e]=o})});function get$2(o){return typeof o=="string"?index[o.toLowerCase()]||NoMode:o&&o.name?get$2(o.name):NoMode}var mode=get$2;function all(){return modes.slice()}var entries=all;function names$2(){return modes.map(o=>o.name)}function toMode(o){const[e,a,l,u,p,d,f]=o,g=f?[f]:[],b=Number(a).toString(2);return{empty:!1,intervals:get$9(u).intervals,modeNum:e,chroma:b,normalized:b,name:u,setNum:a,alt:l,triad:p,seventh:d,aliases:g}}function notes(o,e){return get$2(o).intervals.map(a=>transpose$5(e,a))}function chords(o){return(e,a)=>{const l=get$2(e);if(l.empty)return[];const u=rotate(l.modeNum,o),p=l.intervals.map(d=>transpose$5(a,d));return u.map((d,f)=>p[f]+d)}}var triads$1=chords(MODES.map(o=>o[4])),seventhChords=chords(MODES.map(o=>o[5]));function distance(o,e){const a=get$2(e),l=get$2(o);return a.empty||l.empty?"":simplify(transposeFifths("1P",l.alt-a.alt))}function relativeTonic(o,e,a){return transpose$5(a,distance(o,e))}var mode_default={get:get$2,names:names$2,all,distance,relativeTonic,notes,triads:triads$1,seventhChords,entries,mode};function tokenize$1(o){const[e,a,l,u]=tokenizeNote$1(o);return e===""?tokenizeBass("",o):e==="A"&&u==="ug"?tokenizeBass("","aug"):tokenizeBass(e+a,l+u)}function tokenizeBass(o,e){const a=e.split("/");if(a.length===1)return[o,a[0],""];const[l,u,p,d]=tokenizeNote$1(a[1]);return l!==""&&p===""&&d===""?[o,a[0],l+u]:[o,e,""]}function fromRomanNumerals(o,e){return e.map(get$4).map(l=>transpose$5(o,interval$1(l))+l.chordType)}function toRomanNumerals(o,e){return e.map(a=>{const[l,u]=tokenize$1(a),p=distance$5(o,l);return get$4(interval$1(p)).name+u})}var progression_default={fromRomanNumerals,toRomanNumerals};function numeric(o){const e=compact(o.map(a=>typeof a=="number"?a:toMidi(a)));return!o.length||e.length!==o.length?[]:e.reduce((a,l)=>{const u=a[a.length-1];return a.concat(range(u,l).slice(1))},[e[0]])}function chromatic(o,e){return numeric(o).map(a=>midiToNoteName(a,e))}var index_default$1={numeric,chromatic},NoScale={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function tokenize(o){if(typeof o!="string")return["",""];const e=o.indexOf(" "),a=note$1(o.substring(0,e));if(a.empty){const u=note$1(o);return u.empty?["",o.toLowerCase()]:[u.name,""]}const l=o.substring(a.name.length+1).toLowerCase();return[a.name,l.length?l:""]}var names$1=names$7;function get$1(o){const e=Array.isArray(o)?o:tokenize(o),a=note$1(e[0]).name,l=get$9(e[1]);if(l.empty)return NoScale;const u=l.name,p=a?l.intervals.map(f=>transpose$5(a,f)):[],d=a?a+" "+u:u;return{...l,name:d,type:u,tonic:a,notes:p}}var scale$1=get$1;function detect(o,e={}){const a=chroma$3(o),l=note$1(e.tonic??o[0]??""),u=l.chroma;if(u===void 0)return[];const p=a.split("");p[u]="1";const d=rotate(u,p).join(""),f=all$1().find(b=>b.chroma===d),g=[];return f&&g.push(l.name+" "+f.name),e.match==="exact"||extended(d).forEach(b=>{g.push(l.name+" "+b)}),g}function scaleChords(o){const e=get$1(o),a=isSubsetOf(e.chroma);return all$3().filter(l=>a(l.chroma)).map(l=>l.aliases[0])}function extended(o){const e=isChroma(o)?o:get$1(o).chroma,a=isSupersetOf(e);return all$1().filter(l=>a(l.chroma)).map(l=>l.name)}function reduced(o){const e=isSubsetOf(get$1(o).chroma);return all$1().filter(a=>e(a.chroma)).map(a=>a.name)}function scaleNotes(o){const e=o.map(u=>note$1(u).pc).filter(u=>u),a=e[0],l=sortedUniqNames(e);return rotate(l.indexOf(a),l)}function modeNames(o){const e=get$1(o);if(e.empty)return[];const a=e.tonic?e.notes:e.intervals;return modes$1(e.chroma).map((l,u)=>{const p=get$1(l).name;return p?[a[u],p]:["",""]}).filter(l=>l[0])}function getNoteNameOf(o){const e=Array.isArray(o)?scaleNotes(o):get$1(o).notes,a=e.map(l=>note$1(l).chroma);return l=>{const u=note$1(typeof l=="number"?fromMidi(l):l),p=u.height;if(p===void 0)return;const d=p%12,f=a.indexOf(d);if(f!==-1)return enharmonic(u.name,e[f])}}function rangeOf(o){const e=getNoteNameOf(o);return(a,l)=>{const u=note$1(a).height,p=note$1(l).height;return u===void 0||p===void 0?[]:range(u,p).map(e).filter(d=>d)}}function degrees(o){const{intervals:e,tonic:a}=get$1(o),l=tonicIntervalsTransposer$1(e,a);return u=>u?l(u>0?u-1:u):""}function steps(o){const{intervals:e,tonic:a}=get$1(o);return tonicIntervalsTransposer$1(e,a)}var index_default={degrees,detect,extended,get:get$1,modeNames,names:names$1,rangeOf,reduced,scaleChords,scaleNotes,steps,tokenize,scale:scale$1},NONE={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},NAMES=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function names(){return NAMES.slice()}var REGEX=/^(\d*\d(?:\+\d)*)\/(\d+)$/,CACHE=new Map;function get(o){const e=JSON.stringify(o),a=CACHE.get(e);if(a)return a;const l=build(parse$1(o));return CACHE.set(e,l),l}function parse$1(o){if(typeof o=="string"){const[p,d,f]=REGEX.exec(o)||[];return parse$1([d,f])}const[e,a]=o,l=+a;if(typeof e=="number")return[e,l];const u=e.split("+").map(p=>+p);return u.length===1?[u[0],l]:[u,l]}var time_signature_default={names,parse:parse$1,get},isPowerOfTwo=o=>Math.log(o)/Math.log(2)%1===0;function build([o,e]){const a=Array.isArray(o)?o.reduce((f,g)=>f+g,0):o,l=e;if(a===0||l===0)return NONE;const u=Array.isArray(o)?`${o.join("+")}/${e}`:`${o}/${e}`,p=Array.isArray(o)?o:[],d=l===4||l===2?"simple":l===8&&a%3===0?"compound":isPowerOfTwo(l)?"irregular":"irrational";return{empty:!1,name:u,type:d,upper:a,lower:l,additive:p}}var Tonal=Core,PcSet=pcset_default,ChordDictionary=chord_type_default,ScaleDictionary=scale_type_default;const dist$1=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:abc_notation_default,Array:index$4,Chord:chord_default,ChordDictionary,ChordType:chord_type_default,Collection:collection_default,Core,DurationValue:duration_value_default,Interval:interval_default,Key:index_default$2,Midi:index_default$4,Mode:mode_default,Note:index_default$3,PcSet,Pcset:pcset_default,Progression:progression_default,Range:index_default$1,RomanNumeral:roman_numeral_default,Scale:index_default,ScaleDictionary,ScaleType:scale_type_default,TimeSignature:time_signature_default,Tonal,accToAlt,altToAcc,chroma:chroma$2,coordToInterval,coordToNote,coordinates,deprecate,distance:distance$3,fillStr,height,interval,isNamed,isNamedPitch,isPitch,midi:midi$1,note,pitch,stepToLetter,tokenizeInterval,tokenizeNote,tonicIntervalsTransposer,transpose:transpose$3},Symbol.toStringTag,{value:"Module"})),flats=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],pcs=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],sharps=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],accs={b:-1,"#":1},pc2chroma=o=>{const[e,...a]=o.split("");return pcs.indexOf(e.toLowerCase())+a.reduce((l,u)=>l+accs[u],0)};function tokenizeChord$1(o){const e=(o||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return e?e.slice(1):[]}const midi2chroma=o=>o%12,step2semitones=o=>{let e=Number(o);return isNaN(e)?interval_default.semitones(o):e},x2midi=(o,e)=>{if(typeof o=="number")return o;if(typeof o=="string")return noteToMidi$1(o,e)},midi2note=(o,e=!1)=>{const a=Math.floor(o/12)-1;return(e?sharps:flats)[o%12]+a};function scaleStep$1(o,e,a=1){o=o.map(u=>typeof u=="string"?noteToMidi$1(u):u);const l=Math.floor(e/o.length)*a*12;return e=_mod$2(e,o.length),o[e]+l}function nearestNumberIndex(o,e,a){let l=0,u=1/0;return e.forEach((p,d)=>{const f=Math.abs(p-o);(!a&&f<u||a&&f<=u)&&(l=d,u=f)}),l}let scaleSteps={};function stepInNamedScale(o,e,a,l){const[u,p]=index_default.tokenize(e),d=x2midi(u),f=midi2chroma(d);if(!scaleSteps[p]){const{intervals:M}=index_default.get(`C ${p}`);scaleSteps[p]=M.map(step2semitones)}const g=scaleSteps[p];if(!g)return null;let b=d;if(a){a=x2midi(a,3);const M=midi2chroma(a),E=_mod$2(M-f,12),F=nearestNumberIndex(E,g,l);o=o+F,b=a-E}const A=Math.floor(o/g.length)*12;return o=_mod$2(o,g.length),g[o]+b+A}let modeTarget={below:o=>o.slice(-1)[0],duck:o=>o.slice(-1)[0],above:o=>o[0],root:o=>o[0]};function renderVoicing({chord:o,dictionary:e,offset:a=0,n:l,mode:u="below",anchor:p="c5",octaves:d=1}){const[f,g]=tokenizeChord$1(o),b=pc2chroma(f);p=x2midi(p?.note||p,4);const A=midi2chroma(p),S=e[g].map(ee=>(typeof ee=="string"?ee.split(" "):ee).map(step2semitones));let M,E,F=S.map((ee,ae)=>{const de=modeTarget[u](ee),ke=_mod$2(A-de-b,12);return(M===void 0||ke<M)&&(M=ke,E=ae),ke});u==="root"&&(E=0);const $=Math.ceil(a/S.length)*12,Z=_mod$2(E+a,S.length),V=S[Z],K=modeTarget[u](V),se=p-F[Z]+$,z=V.map(ee=>se-K+ee);let U=z.map(ee=>midi2note(ee));return u==="duck"&&(U=U.filter((ee,ae)=>z[ae]!==p)),l!==void 0?[scaleStep$1(U,l,d)]:U}const octavesInterval=o=>(o<=0?-1:1)+o*7+"P";function getScale(o){o=o.replaceAll(":"," ");const e=index_default.get(o),{tonic:a,empty:l}=e;if(l&&isNote(o)||l&&!a)throw new Error(`Scale name ${o} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(l)throw new Error(`Invalid scale name "${o}"`);return e}function scaleStep(o,e){o=Math.ceil(o);let{intervals:a,tonic:l}=getScale(e);l=l||"C";const{pc:u,oct:p=3}=index_default$3.get(l),d=Math.floor(o/a.length),f=_mod$2(o,a.length),g=interval_default.add(a[f],octavesInterval(d));return index_default$3.transpose(u+p,g)}function scaleOffset(o,e,a){let{notes:l}=getScale(o);if(l=l.map(S=>index_default$3.get(S).pc),e=Number(e),isNaN(e))throw new Error(`scale offset "${e}" not a number`);const{pc:u,oct:p=3}=index_default$3.get(a),d=l.indexOf(u);if(d===-1)throw new Error(`note "${a}" is not in scale "${o}"`);let f=d,g=p,b=u;const A=Math.sign(e);for(;Math.abs(f-d)<Math.abs(e);){f+=A;const S=_mod$2(f,l.length);A<0&&b[0]==="C"&&(g+=A),b=l[S],A>0&&b[0]==="C"&&(g+=A)}return b+g}const{transpose,trans}=register(["transpose","trans"],function(e,a){return a.withHap(l=>{const u=l.value.note??l.value;if(typeof u=="number"){let f;typeof e=="number"?f=e:typeof e=="string"&&(f=interval_default.semitones(e)||0);const g=u+f;return typeof l.value=="object"?l.withValue(()=>({...l.value,note:g})):l.withValue(()=>g)}if(typeof u!="string"||!isNote(u))return logger$2(`[tonal] transpose: not a note "${u}"`,"warning"),l;const p=isNaN(Number(e))?String(e):interval_default.fromSemitones(e),d=index_default$3.transpose(u,p);return typeof l.value=="object"?l.withValue(()=>({...l.value,note:d})):l.withValue(()=>d)})}),{scaleTranspose,scaleTrans,strans}=register(["scaleTranspose","scaleTrans","strans"],function(o,e){return e.withHap(a=>{if(!a.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof a.value=="object")return a.withValue(()=>({...a.value,note:scaleOffset(a.context.scale,Number(o),a.value.note)}));if(typeof a.value!="string")throw new Error("can only use scaleTranspose with notes");return a.withValue(()=>scaleOffset(a.context.scale,Number(o),a.value))})});function _convertStepToNumberAndOffset(o){let e=Number(o),a=0;if(isNaN(e)){o=String(o);const l=/^(-?\d+)([#bsf]*)$/.exec(o);if(!l)throw new Error(`invalid scale step "${o}", expected number or integer with optional # b suffixes`);e=Number(l[1]);const u=l[2]||"";a=getAccidentalsOffset$1(u)}return[e,a]}let scaleToMidisAndNotes={};function _getNearestScaleNote(o,e,a=!0){let l=typeof e=="string"?noteToMidi$1(e):e;if(scaleToMidisAndNotes[o]===void 0){const{intervals:S,tonic:M}=getScale(o),{pc:E}=index_default$3.get(M),$=S.concat("8P").map(V=>index_default$3.transpose(E+"0",V)),Z=$.map(noteToMidi$1);scaleToMidisAndNotes[o]=[Z,$]}const[u,p]=scaleToMidisAndNotes[o],d=u[0],f=Math.floor((l-d)/12),g=u.map(S=>S+12*f),b=nearestNumberIndex(l,g,a),A=p[b];return index_default$3.transpose(A,interval_default.fromSemitones(12*f))}const scale=register("scale",function(o,e){return Array.isArray(o)&&(o=o.flat().join(" ")),e.withHaps(a=>(a=a.map(l=>{let u=l.value;const p=typeof u=="object";u=p?u:{n:u};const{note:d,n:f,value:g,...b}=u,A=d??f??g;if(A===void 0)return logger$2(`[tonal] Invalid value format for 'scale'. Value must contain n, note, or value but received keys [${Object.keys(u).join(", ")}]`,"error"),l;let S;if(isNote(A))S=_getNearestScaleNote(o,A),l.value={...b,note:S};else try{const[M,E]=_convertStepToNumberAndOffset(A);b.anchor?S=stepInNamedScale(M,o,b.anchor):S=scaleStep(M,o),E!=0&&(S=index_default$3.transpose(S,interval_default.fromSemitones(E)))}catch(M){errorLogger$1(M,"tonal");return}return l.value=p?{...b,note:S}:S,l.setContext({...l.context,scale:o})}),removeUndefineds(a)))},!0,!0);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function getAugmentedNamespace(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var e=o.default;if(typeof e=="function"){var a=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};a.prototype=e.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(a,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),a}var dist={},dictionaryVoicing$1={},getBestVoicing={},hasRequiredGetBestVoicing;function requireGetBestVoicing(){if(hasRequiredGetBestVoicing)return getBestVoicing;hasRequiredGetBestVoicing=1,getBestVoicing.__esModule=!0,getBestVoicing.getBestVoicing=void 0;function o(e){var a=e.chord,l=e.range,u=e.finder,p=e.picker,d=e.lastVoicing,f=u(a,l);return f.length?p(f,d):[]}return getBestVoicing.getBestVoicing=o,getBestVoicing}var voicingsInRange={};const require$$0=getAugmentedNamespace(dist$1);var tokenizeChord={},hasRequiredTokenizeChord;function requireTokenizeChord(){if(hasRequiredTokenizeChord)return tokenizeChord;hasRequiredTokenizeChord=1,tokenizeChord.__esModule=!0,tokenizeChord.tokenizeChord=void 0;function o(e){var a=(e||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return a?a.slice(1):[]}return tokenizeChord.tokenizeChord=o,tokenizeChord}var hasRequiredVoicingsInRange;function requireVoicingsInRange(){if(hasRequiredVoicingsInRange)return voicingsInRange;hasRequiredVoicingsInRange=1,voicingsInRange.__esModule=!0,voicingsInRange.voicingsInRange=void 0;var o=require$$0,e=requireDictionaryVoicing(),a=requireTokenizeChord();function l(u,p,d){p===void 0&&(p=e.lefthand),d===void 0&&(d=["D3","A4"]);var f=(0,a.tokenizeChord)(u),g=f[0],b=f[1];if(!p[b])return[];var A=p[b].map(function(M){return M.split(" ")}),S=o.Range.chromatic(d);return A.reduce(function(M,E){var F=E.map(function(K){return o.Interval.substract(K,E[0])}),$=o.Note.transpose(g,E[0]),Z=S.filter(function(K){return o.Note.chroma(K)===o.Note.chroma($)}).filter(function(K){return o.Note.midi(o.Note.transpose(K,F[F.length-1]))<=o.Note.midi(d[1])}).map(function(K){return o.Note.enharmonic(K,$)}),V=Z.map(function(K){return F.map(function(se){return o.Note.transpose(K,se)})});return M.concat(V)},[])}return voicingsInRange.voicingsInRange=l,voicingsInRange}var hasRequiredDictionaryVoicing;function requireDictionaryVoicing(){return hasRequiredDictionaryVoicing||(hasRequiredDictionaryVoicing=1,(function(o){var e=dictionaryVoicing$1&&dictionaryVoicing$1.__assign||function(){return e=Object.assign||function(f){for(var g,b=1,A=arguments.length;b<A;b++){g=arguments[b];for(var S in g)Object.prototype.hasOwnProperty.call(g,S)&&(f[S]=g[S])}return f},e.apply(this,arguments)},a=dictionaryVoicing$1&&dictionaryVoicing$1.__rest||function(f,g){var b={};for(var A in f)Object.prototype.hasOwnProperty.call(f,A)&&g.indexOf(A)<0&&(b[A]=f[A]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,A=Object.getOwnPropertySymbols(f);S<A.length;S++)g.indexOf(A[S])<0&&Object.prototype.propertyIsEnumerable.call(f,A[S])&&(b[A[S]]=f[A[S]]);return b};o.__esModule=!0,o.dictionaryVoicing=o.dictionaryVoicingFinder=o.triads=o.guidetones=o.lefthand=void 0;var l=requireGetBestVoicing(),u=requireVoicingsInRange();o.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},o.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},o.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var p=function(f){return function(g,b){return(0,u.voicingsInRange)(g,f,b)}};o.dictionaryVoicingFinder=p;var d=function(f){var g=f.dictionary,b=f.range,A=a(f,["dictionary","range"]);return(0,l.getBestVoicing)(e(e({},A),{range:b,finder:(0,o.dictionaryVoicingFinder)(g)}))};o.dictionaryVoicing=d})(dictionaryVoicing$1)),dictionaryVoicing$1}var minTopNoteDiff$1={},hasRequiredMinTopNoteDiff;function requireMinTopNoteDiff(){if(hasRequiredMinTopNoteDiff)return minTopNoteDiff$1;hasRequiredMinTopNoteDiff=1,minTopNoteDiff$1.__esModule=!0,minTopNoteDiff$1.minTopNoteDiff=void 0;var o=require$$0;function e(a,l){if(!l)return a[0];var u=function(p){return Math.abs(o.Note.midi(l[l.length-1])-o.Note.midi(p[p.length-1]))};return a.reduce(function(p,d){return u(d)<u(p)?d:p},a[0])}return minTopNoteDiff$1.minTopNoteDiff=e,minTopNoteDiff$1}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(o){o.__esModule=!0;var e=requireDictionaryVoicing(),a=requireMinTopNoteDiff(),l=requireGetBestVoicing(),u=requireTokenizeChord();o.default={tokenizeChord:u.tokenizeChord,getBestVoicing:l.getBestVoicing,dictionaryVoicing:e.dictionaryVoicing,dictionaryVoicingFinder:e.dictionaryVoicingFinder,lefthand:e.lefthand,guidetones:e.guidetones,triads:e.triads,minTopNoteDiff:a.minTopNoteDiff}})(dist)),dist}var distExports=requireDist();const _voicings=getDefaultExportFromCjs(distExports),simple={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},complex={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing,minTopNoteDiff}=_voicings.default||_voicings,lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},triads={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},defaultDictionary={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},voicingRegistry={lefthand:{dictionary:lefthand,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:triads,mode:"below",anchor:"a4"},guidetones:{dictionary:guidetones,mode:"above",anchor:"a4"},legacy:{dictionary:defaultDictionary,mode:"below",anchor:"a4"}};let defaultDict="ireal";const setDefaultVoicings=o=>defaultDict=o,setVoicingRange=(o,e)=>addVoicings(o,voicingRegistry[o].dictionary,e),addVoicings=(o,e,a=["F3","A4"])=>{Object.assign(voicingRegistry,{[o]:{dictionary:e,range:a}})},registerVoicings=(o,e,a={})=>{Object.assign(voicingRegistry,{[o]:{dictionary:e,...a}})},getVoicing=(o,e,a)=>{const{dictionary:l,range:u}=voicingRegistry[e];return dictionaryVoicing({chord:o,dictionary:l,range:u,picker:minTopNoteDiff,lastVoicing:a})};let lastVoicing;const voicings=register("voicings",function(o,e){return e.fmap(a=>(lastVoicing=getVoicing(a,o,lastVoicing),stack(...lastVoicing))).outerJoin()}),rootNotes=register("rootNotes",function(o,e){return e.fmap(a=>{const p=(a.chord||a).match(/^([a-gA-G][b#]?).*$/)[1]+o;return a.chord?{note:p}:p})}),voicing=register("voicing",function(o){return o.fmap(e=>{e=typeof e=="string"?{chord:e}:e;let{dictionary:a=defaultDict,chord:l,anchor:u,offset:p,mode:d,n:f,octaves:g,...b}=e;a=typeof a=="string"?voicingRegistry[a]:{dictionary:a,mode:"below",anchor:"c5"};try{let A=renderVoicing({...a,chord:l,anchor:u,offset:p,mode:d,n:f,octaves:g});return stack(...A).note().set(b)}catch{return logger$2(`[voicing]: unknown chord "${l}"`),silence}}).outerJoin()});function voicingAlias(o,e,a){a=Array.isArray(a)?a:[a],a.forEach(l=>{l[e]=l[o]})}voicingAlias("^","",[simple,complex]),Object.keys(simple).forEach(o=>{if(o.includes("-")){let e=o.replace("-","m");voicingAlias(o,e,[complex,simple])}if(o.includes("^")){let e=o.replace("^","M");voicingAlias(o,e,[complex,simple])}if(o.includes("+")){let e=o.replace("+","aug");voicingAlias(o,e,[complex,simple])}}),registerVoicings("ireal",simple),registerVoicings("ireal-ext",complex);function resetVoicings(){lastVoicing=void 0,setDefaultVoicings("ireal")}const packageName="@strudel/tonal",strudelTonal=Object.freeze(Object.defineProperty({__proto__:null,addVoicings,complex,packageName,registerVoicings,resetVoicings,rootNotes,scale,scaleTrans,scaleTranspose,setDefaultVoicings,setVoicingRange,simple,strans,trans,transpose,voicing,voicingAlias,voicingRegistry,voicings},Symbol.toStringTag,{value:"Module"}));let latestOptions,hydra;async function initHydra(o={}){if(latestOptions&&JSON.stringify(latestOptions)!==JSON.stringify(o)&&document.getElementById("hydra-canvas")?.remove(),latestOptions=o,!document.getElementById("hydra-canvas")){const{src:e="https://unpkg.com/hydra-synth",feedStrudel:a=!1,contextType:l="webgl",pixelRatio:u=1,pixelated:p=!0,...d}={detectAudio:!1,...o},{canvas:f}=getDrawContext("hydra-canvas",{contextType:l,pixelRatio:u,pixelated:p});if(d.canvas=f,await import(e),hydra=new Hydra(d),a){const{canvas:g}=getDrawContext();g.style.display="none",hydra.synth.s0.init({src:g})}}return hydra}function clearHydra(){hydra&&hydra.hush(),globalThis.s0?.clear(),document.getElementById("hydra-canvas")?.remove(),globalThis.speed=speed,globalThis.shape=shape}const H=o=>()=>reify(o).queryArc(getTime(),getTime())[0].value,strudelHydra=Object.freeze(Object.defineProperty({__proto__:null,H,clearHydra,initHydra},Symbol.toStringTag,{value:"Module"}));var astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],nonASCIIidentifierChars="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",reservedWords={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ecma5AndLessKeywords="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",keywords$1={5:ecma5AndLessKeywords,"5module":ecma5AndLessKeywords+" export import",6:ecma5AndLessKeywords+" const class extends export import super"},keywordRelationalOperator=/^in(stanceof)?$/,nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]"),nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");function isInAstralSet(o,e){for(var a=65536,l=0;l<e.length;l+=2){if(a+=e[l],a>o)return!1;if(a+=e[l+1],a>=o)return!0}return!1}function isIdentifierStart(o,e){return o<65?o===36:o<91?!0:o<97?o===95:o<123?!0:o<=65535?o>=170&&nonASCIIidentifierStart.test(String.fromCharCode(o)):e===!1?!1:isInAstralSet(o,astralIdentifierStartCodes)}function isIdentifierChar(o,e){return o<48?o===36:o<58?!0:o<65?!1:o<91?!0:o<97?o===95:o<123?!0:o<=65535?o>=170&&nonASCIIidentifier.test(String.fromCharCode(o)):e===!1?!1:isInAstralSet(o,astralIdentifierStartCodes)||isInAstralSet(o,astralIdentifierCodes)}var TokenType=function(e,a){a===void 0&&(a={}),this.label=e,this.keyword=a.keyword,this.beforeExpr=!!a.beforeExpr,this.startsExpr=!!a.startsExpr,this.isLoop=!!a.isLoop,this.isAssign=!!a.isAssign,this.prefix=!!a.prefix,this.postfix=!!a.postfix,this.binop=a.binop||null,this.updateContext=null};function binop(o,e){return new TokenType(o,{beforeExpr:!0,binop:e})}var beforeExpr={beforeExpr:!0},startsExpr={startsExpr:!0},keywords={};function kw(o,e){return e===void 0&&(e={}),e.keyword=o,keywords[o]=new TokenType(o,e)}var types$1={num:new TokenType("num",startsExpr),regexp:new TokenType("regexp",startsExpr),string:new TokenType("string",startsExpr),name:new TokenType("name",startsExpr),privateId:new TokenType("privateId",startsExpr),eof:new TokenType("eof"),bracketL:new TokenType("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new TokenType("]"),braceL:new TokenType("{",{beforeExpr:!0,startsExpr:!0}),braceR:new TokenType("}"),parenL:new TokenType("(",{beforeExpr:!0,startsExpr:!0}),parenR:new TokenType(")"),comma:new TokenType(",",beforeExpr),semi:new TokenType(";",beforeExpr),colon:new TokenType(":",beforeExpr),dot:new TokenType("."),question:new TokenType("?",beforeExpr),questionDot:new TokenType("?."),arrow:new TokenType("=>",beforeExpr),template:new TokenType("template"),invalidTemplate:new TokenType("invalidTemplate"),ellipsis:new TokenType("...",beforeExpr),backQuote:new TokenType("`",startsExpr),dollarBraceL:new TokenType("${",{beforeExpr:!0,startsExpr:!0}),eq:new TokenType("=",{beforeExpr:!0,isAssign:!0}),assign:new TokenType("_=",{beforeExpr:!0,isAssign:!0}),incDec:new TokenType("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new TokenType("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:binop("||",1),logicalAND:binop("&&",2),bitwiseOR:binop("|",3),bitwiseXOR:binop("^",4),bitwiseAND:binop("&",5),equality:binop("==/!=/===/!==",6),relational:binop("</>/<=/>=",7),bitShift:binop("<</>>/>>>",8),plusMin:new TokenType("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:binop("%",10),star:binop("*",10),slash:binop("/",10),starstar:new TokenType("**",{beforeExpr:!0}),coalesce:binop("??",1),_break:kw("break"),_case:kw("case",beforeExpr),_catch:kw("catch"),_continue:kw("continue"),_debugger:kw("debugger"),_default:kw("default",beforeExpr),_do:kw("do",{isLoop:!0,beforeExpr:!0}),_else:kw("else",beforeExpr),_finally:kw("finally"),_for:kw("for",{isLoop:!0}),_function:kw("function",startsExpr),_if:kw("if"),_return:kw("return",beforeExpr),_switch:kw("switch"),_throw:kw("throw",beforeExpr),_try:kw("try"),_var:kw("var"),_const:kw("const"),_while:kw("while",{isLoop:!0}),_with:kw("with"),_new:kw("new",{beforeExpr:!0,startsExpr:!0}),_this:kw("this",startsExpr),_super:kw("super",startsExpr),_class:kw("class",startsExpr),_extends:kw("extends",beforeExpr),_export:kw("export"),_import:kw("import",startsExpr),_null:kw("null",startsExpr),_true:kw("true",startsExpr),_false:kw("false",startsExpr),_in:kw("in",{beforeExpr:!0,binop:7}),_instanceof:kw("instanceof",{beforeExpr:!0,binop:7}),_typeof:kw("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:kw("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:kw("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lineBreak=/\r\n?|\n|\u2028|\u2029/,lineBreakG=new RegExp(lineBreak.source,"g");function isNewLine(o){return o===10||o===13||o===8232||o===8233}function nextLineBreak(o,e,a){a===void 0&&(a=o.length);for(var l=e;l<a;l++){var u=o.charCodeAt(l);if(isNewLine(u))return l<a-1&&u===13&&o.charCodeAt(l+1)===10?l+2:l+1}return-1}var nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,skipWhiteSpace=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ref=Object.prototype,hasOwnProperty=ref.hasOwnProperty,toString=ref.toString,hasOwn=Object.hasOwn||(function(o,e){return hasOwnProperty.call(o,e)}),isArray=Array.isArray||(function(o){return toString.call(o)==="[object Array]"}),regexpCache=Object.create(null);function wordsRegexp(o){return regexpCache[o]||(regexpCache[o]=new RegExp("^(?:"+o.replace(/ /g,"|")+")$"))}function codePointToString(o){return o<=65535?String.fromCharCode(o):(o-=65536,String.fromCharCode((o>>10)+55296,(o&1023)+56320))}var loneSurrogate=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Position=function(e,a){this.line=e,this.column=a};Position.prototype.offset=function(e){return new Position(this.line,this.column+e)};var SourceLocation=function(e,a,l){this.start=a,this.end=l,e.sourceFile!==null&&(this.source=e.sourceFile)};function getLineInfo(o,e){for(var a=1,l=0;;){var u=nextLineBreak(o,l,e);if(u<0)return new Position(a,e-l);++a,l=u}}var defaultOptions={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},warnedAboutEcmaVersion=!1;function getOptions(o){var e={};for(var a in defaultOptions)e[a]=o&&hasOwn(o,a)?o[a]:defaultOptions[a];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!warnedAboutEcmaVersion&&typeof console=="object"&&console.warn&&(warnedAboutEcmaVersion=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!o||o.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),isArray(e.onToken)){var l=e.onToken;e.onToken=function(u){return l.push(u)}}return isArray(e.onComment)&&(e.onComment=pushComment(e,e.onComment)),e}function pushComment(o,e){return function(a,l,u,p,d,f){var g={type:a?"Block":"Line",value:l,start:u,end:p};o.locations&&(g.loc=new SourceLocation(this,d,f)),o.ranges&&(g.range=[u,p]),e.push(g)}}var SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_CLASS_FIELD_INIT=512,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(o,e){return SCOPE_FUNCTION|(o?SCOPE_ASYNC:0)|(e?SCOPE_GENERATOR:0)}var BIND_NONE=0,BIND_VAR=1,BIND_LEXICAL=2,BIND_FUNCTION=3,BIND_SIMPLE_CATCH=4,BIND_OUTSIDE=5,Parser=function(e,a,l){this.options=e=getOptions(e),this.sourceFile=e.sourceFile,this.keywords=wordsRegexp(keywords$1[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var u="";e.allowReserved!==!0&&(u=reservedWords[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(u+=" await")),this.reservedWords=wordsRegexp(u);var p=(u?u+" ":"")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(p),this.reservedWordsStrictBind=wordsRegexp(p+" "+reservedWords.strictBind),this.input=String(a),this.containsEsc=!1,l?(this.pos=l,this.lineStart=this.input.lastIndexOf(`
`,l-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=types$1.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(SCOPE_TOP),this.regexpState=null,this.privateNameStack=[]},prototypeAccessors={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Parser.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0},prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0},prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0},prototypeAccessors.canAwait.get=function(){for(var o=this.scopeStack.length-1;o>=0;o--){var e=this.scopeStack[o],a=e.flags;if(a&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT))return!1;if(a&SCOPE_FUNCTION)return(a&SCOPE_ASYNC)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},prototypeAccessors.allowSuper.get=function(){var o=this.currentThisScope(),e=o.flags;return(e&SCOPE_SUPER)>0||this.options.allowSuperOutsideMethod},prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0},prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},prototypeAccessors.allowNewDotTarget.get=function(){for(var o=this.scopeStack.length-1;o>=0;o--){var e=this.scopeStack[o],a=e.flags;if(a&(SCOPE_CLASS_STATIC_BLOCK|SCOPE_CLASS_FIELD_INIT)||a&SCOPE_FUNCTION&&!(a&SCOPE_ARROW))return!0}return!1},prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0},Parser.extend=function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];for(var l=this,u=0;u<e.length;u++)l=e[u](l);return l},Parser.parse=function(e,a){return new this(a,e).parse()},Parser.parseExpressionAt=function(e,a,l){var u=new this(l,e,a);return u.nextToken(),u.parseExpression()},Parser.tokenizer=function(e,a){return new this(a,e)},Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype,literal=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;pp$9.strictDirective=function(o){if(this.options.ecmaVersion<5)return!1;for(;;){skipWhiteSpace.lastIndex=o,o+=skipWhiteSpace.exec(this.input)[0].length;var e=literal.exec(this.input.slice(o));if(!e)return!1;if((e[1]||e[2])==="use strict"){skipWhiteSpace.lastIndex=o+e[0].length;var a=skipWhiteSpace.exec(this.input),l=a.index+a[0].length,u=this.input.charAt(l);return u===";"||u==="}"||lineBreak.test(a[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(u)||u==="!"&&this.input.charAt(l+1)==="=")}o+=e[0].length,skipWhiteSpace.lastIndex=o,o+=skipWhiteSpace.exec(this.input)[0].length,this.input[o]===";"&&o++}},pp$9.eat=function(o){return this.type===o?(this.next(),!0):!1},pp$9.isContextual=function(o){return this.type===types$1.name&&this.value===o&&!this.containsEsc},pp$9.eatContextual=function(o){return this.isContextual(o)?(this.next(),!0):!1},pp$9.expectContextual=function(o){this.eatContextual(o)||this.unexpected()},pp$9.canInsertSemicolon=function(){return this.type===types$1.eof||this.type===types$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$9.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},pp$9.semicolon=function(){!this.eat(types$1.semi)&&!this.insertSemicolon()&&this.unexpected()},pp$9.afterTrailingComma=function(o,e){if(this.type===o)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},pp$9.expect=function(o){this.eat(o)||this.unexpected()},pp$9.unexpected=function(o){this.raise(o??this.start,"Unexpected token")};var DestructuringErrors=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pp$9.checkPatternErrors=function(o,e){if(o){o.trailingComma>-1&&this.raiseRecoverable(o.trailingComma,"Comma is not permitted after the rest element");var a=e?o.parenthesizedAssign:o.parenthesizedBind;a>-1&&this.raiseRecoverable(a,e?"Assigning to rvalue":"Parenthesized pattern")}},pp$9.checkExpressionErrors=function(o,e){if(!o)return!1;var a=o.shorthandAssign,l=o.doubleProto;if(!e)return a>=0||l>=0;a>=0&&this.raise(a,"Shorthand property assignments are valid only in destructuring patterns"),l>=0&&this.raiseRecoverable(l,"Redefinition of __proto__ property")},pp$9.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},pp$9.isSimpleAssignTarget=function(o){return o.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(o.expression):o.type==="Identifier"||o.type==="MemberExpression"};var pp$8=Parser.prototype;pp$8.parseTopLevel=function(o){var e=Object.create(null);for(o.body||(o.body=[]);this.type!==types$1.eof;){var a=this.parseStatement(null,!0,e);o.body.push(a)}if(this.inModule)for(var l=0,u=Object.keys(this.undefinedExports);l<u.length;l+=1){var p=u[l];this.raiseRecoverable(this.undefinedExports[p].start,"Export '"+p+"' is not defined")}return this.adaptDirectivePrologue(o.body),this.next(),o.sourceType=this.options.sourceType,this.finishNode(o,"Program")};var loopLabel={kind:"loop"},switchLabel={kind:"switch"};pp$8.isLet=function(o){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;skipWhiteSpace.lastIndex=this.pos;var e=skipWhiteSpace.exec(this.input),a=this.pos+e[0].length,l=this.input.charCodeAt(a);if(l===91||l===92)return!0;if(o)return!1;if(l===123||l>55295&&l<56320)return!0;if(isIdentifierStart(l,!0)){for(var u=a+1;isIdentifierChar(l=this.input.charCodeAt(u),!0);)++u;if(l===92||l>55295&&l<56320)return!0;var p=this.input.slice(a,u);if(!keywordRelationalOperator.test(p))return!0}return!1},pp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;skipWhiteSpace.lastIndex=this.pos;var o=skipWhiteSpace.exec(this.input),e=this.pos+o[0].length,a;return!lineBreak.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(isIdentifierChar(a=this.input.charCodeAt(e+8))||a>55295&&a<56320))},pp$8.isUsingKeyword=function(o,e){if(this.options.ecmaVersion<17||!this.isContextual(o?"await":"using"))return!1;skipWhiteSpace.lastIndex=this.pos;var a=skipWhiteSpace.exec(this.input),l=this.pos+a[0].length;if(lineBreak.test(this.input.slice(this.pos,l)))return!1;if(o){var u=l+5,p;if(this.input.slice(l,u)!=="using"||u===this.input.length||isIdentifierChar(p=this.input.charCodeAt(u))||p>55295&&p<56320)return!1;skipWhiteSpace.lastIndex=u;var d=skipWhiteSpace.exec(this.input);if(d&&lineBreak.test(this.input.slice(u,u+d[0].length)))return!1}if(e){var f=l+2,g;if(this.input.slice(l,f)==="of"&&(f===this.input.length||!isIdentifierChar(g=this.input.charCodeAt(f))&&!(g>55295&&g<56320)))return!1}var b=this.input.charCodeAt(l);return isIdentifierStart(b,!0)||b===92},pp$8.isAwaitUsing=function(o){return this.isUsingKeyword(!0,o)},pp$8.isUsing=function(o){return this.isUsingKeyword(!1,o)},pp$8.parseStatement=function(o,e,a){var l=this.type,u=this.startNode(),p;switch(this.isLet(o)&&(l=types$1._var,p="let"),l){case types$1._break:case types$1._continue:return this.parseBreakContinueStatement(u,l.keyword);case types$1._debugger:return this.parseDebuggerStatement(u);case types$1._do:return this.parseDoStatement(u);case types$1._for:return this.parseForStatement(u);case types$1._function:return o&&(this.strict||o!=="if"&&o!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(u,!1,!o);case types$1._class:return o&&this.unexpected(),this.parseClass(u,!0);case types$1._if:return this.parseIfStatement(u);case types$1._return:return this.parseReturnStatement(u);case types$1._switch:return this.parseSwitchStatement(u);case types$1._throw:return this.parseThrowStatement(u);case types$1._try:return this.parseTryStatement(u);case types$1._const:case types$1._var:return p=p||this.value,o&&p!=="var"&&this.unexpected(),this.parseVarStatement(u,p);case types$1._while:return this.parseWhileStatement(u);case types$1._with:return this.parseWithStatement(u);case types$1.braceL:return this.parseBlock(!0,u);case types$1.semi:return this.parseEmptyStatement(u);case types$1._export:case types$1._import:if(this.options.ecmaVersion>10&&l===types$1._import){skipWhiteSpace.lastIndex=this.pos;var d=skipWhiteSpace.exec(this.input),f=this.pos+d[0].length,g=this.input.charCodeAt(f);if(g===40||g===46)return this.parseExpressionStatement(u,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),l===types$1._import?this.parseImport(u):this.parseExport(u,a);default:if(this.isAsyncFunction())return o&&this.unexpected(),this.next(),this.parseFunctionStatement(u,!0,!o);var b=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(b)return e&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),b==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(u,!1,b),this.semicolon(),this.finishNode(u,"VariableDeclaration");var A=this.value,S=this.parseExpression();return l===types$1.name&&S.type==="Identifier"&&this.eat(types$1.colon)?this.parseLabeledStatement(u,A,S,o):this.parseExpressionStatement(u,S)}},pp$8.parseBreakContinueStatement=function(o,e){var a=e==="break";this.next(),this.eat(types$1.semi)||this.insertSemicolon()?o.label=null:this.type!==types$1.name?this.unexpected():(o.label=this.parseIdent(),this.semicolon());for(var l=0;l<this.labels.length;++l){var u=this.labels[l];if((o.label==null||u.name===o.label.name)&&(u.kind!=null&&(a||u.kind==="loop")||o.label&&a))break}return l===this.labels.length&&this.raise(o.start,"Unsyntactic "+e),this.finishNode(o,a?"BreakStatement":"ContinueStatement")},pp$8.parseDebuggerStatement=function(o){return this.next(),this.semicolon(),this.finishNode(o,"DebuggerStatement")},pp$8.parseDoStatement=function(o){return this.next(),this.labels.push(loopLabel),o.body=this.parseStatement("do"),this.labels.pop(),this.expect(types$1._while),o.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(types$1.semi):this.semicolon(),this.finishNode(o,"DoWhileStatement")},pp$8.parseForStatement=function(o){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(loopLabel),this.enterScope(0),this.expect(types$1.parenL),this.type===types$1.semi)return e>-1&&this.unexpected(e),this.parseFor(o,null);var a=this.isLet();if(this.type===types$1._var||this.type===types$1._const||a){var l=this.startNode(),u=a?"let":this.value;return this.next(),this.parseVar(l,!0,u),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(o,l,e)}var p=this.isContextual("let"),d=!1,f=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(f){var g=this.startNode();return this.next(),f==="await using"&&this.next(),this.parseVar(g,!0,f),this.finishNode(g,"VariableDeclaration"),this.parseForAfterInit(o,g,e)}var b=this.containsEsc,A=new DestructuringErrors,S=this.start,M=e>-1?this.parseExprSubscripts(A,"await"):this.parseExpression(!0,A);return this.type===types$1._in||(d=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===types$1._in&&this.unexpected(e),o.await=!0):d&&this.options.ecmaVersion>=8&&(M.start===S&&!b&&M.type==="Identifier"&&M.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(o.await=!1)),p&&d&&this.raise(M.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(M,!1,A),this.checkLValPattern(M),this.parseForIn(o,M)):(this.checkExpressionErrors(A,!0),e>-1&&this.unexpected(e),this.parseFor(o,M))},pp$8.parseForAfterInit=function(o,e,a){return(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&e.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===types$1._in?a>-1&&this.unexpected(a):o.await=a>-1),this.parseForIn(o,e)):(a>-1&&this.unexpected(a),this.parseFor(o,e))},pp$8.parseFunctionStatement=function(o,e,a){return this.next(),this.parseFunction(o,FUNC_STATEMENT|(a?0:FUNC_HANGING_STATEMENT),!1,e)},pp$8.parseIfStatement=function(o){return this.next(),o.test=this.parseParenExpression(),o.consequent=this.parseStatement("if"),o.alternate=this.eat(types$1._else)?this.parseStatement("if"):null,this.finishNode(o,"IfStatement")},pp$8.parseReturnStatement=function(o){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(types$1.semi)||this.insertSemicolon()?o.argument=null:(o.argument=this.parseExpression(),this.semicolon()),this.finishNode(o,"ReturnStatement")},pp$8.parseSwitchStatement=function(o){this.next(),o.discriminant=this.parseParenExpression(),o.cases=[],this.expect(types$1.braceL),this.labels.push(switchLabel),this.enterScope(0);for(var e,a=!1;this.type!==types$1.braceR;)if(this.type===types$1._case||this.type===types$1._default){var l=this.type===types$1._case;e&&this.finishNode(e,"SwitchCase"),o.cases.push(e=this.startNode()),e.consequent=[],this.next(),l?e.test=this.parseExpression():(a&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),a=!0,e.test=null),this.expect(types$1.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(o,"SwitchStatement")},pp$8.parseThrowStatement=function(o){return this.next(),lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),o.argument=this.parseExpression(),this.semicolon(),this.finishNode(o,"ThrowStatement")};var empty$1=[];pp$8.parseCatchClauseParam=function(){var o=this.parseBindingAtom(),e=o.type==="Identifier";return this.enterScope(e?SCOPE_SIMPLE_CATCH:0),this.checkLValPattern(o,e?BIND_SIMPLE_CATCH:BIND_LEXICAL),this.expect(types$1.parenR),o},pp$8.parseTryStatement=function(o){if(this.next(),o.block=this.parseBlock(),o.handler=null,this.type===types$1._catch){var e=this.startNode();this.next(),this.eat(types$1.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),o.handler=this.finishNode(e,"CatchClause")}return o.finalizer=this.eat(types$1._finally)?this.parseBlock():null,!o.handler&&!o.finalizer&&this.raise(o.start,"Missing catch or finally clause"),this.finishNode(o,"TryStatement")},pp$8.parseVarStatement=function(o,e,a){return this.next(),this.parseVar(o,!1,e,a),this.semicolon(),this.finishNode(o,"VariableDeclaration")},pp$8.parseWhileStatement=function(o){return this.next(),o.test=this.parseParenExpression(),this.labels.push(loopLabel),o.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(o,"WhileStatement")},pp$8.parseWithStatement=function(o){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),o.object=this.parseParenExpression(),o.body=this.parseStatement("with"),this.finishNode(o,"WithStatement")},pp$8.parseEmptyStatement=function(o){return this.next(),this.finishNode(o,"EmptyStatement")},pp$8.parseLabeledStatement=function(o,e,a,l){for(var u=0,p=this.labels;u<p.length;u+=1){var d=p[u];d.name===e&&this.raise(a.start,"Label '"+e+"' is already declared")}for(var f=this.type.isLoop?"loop":this.type===types$1._switch?"switch":null,g=this.labels.length-1;g>=0;g--){var b=this.labels[g];if(b.statementStart===o.start)b.statementStart=this.start,b.kind=f;else break}return this.labels.push({name:e,kind:f,statementStart:this.start}),o.body=this.parseStatement(l?l.indexOf("label")===-1?l+"label":l:"label"),this.labels.pop(),o.label=a,this.finishNode(o,"LabeledStatement")},pp$8.parseExpressionStatement=function(o,e){return o.expression=e,this.semicolon(),this.finishNode(o,"ExpressionStatement")},pp$8.parseBlock=function(o,e,a){for(o===void 0&&(o=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(types$1.braceL),o&&this.enterScope(0);this.type!==types$1.braceR;){var l=this.parseStatement(null);e.body.push(l)}return a&&(this.strict=!1),this.next(),o&&this.exitScope(),this.finishNode(e,"BlockStatement")},pp$8.parseFor=function(o,e){return o.init=e,this.expect(types$1.semi),o.test=this.type===types$1.semi?null:this.parseExpression(),this.expect(types$1.semi),o.update=this.type===types$1.parenR?null:this.parseExpression(),this.expect(types$1.parenR),o.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(o,"ForStatement")},pp$8.parseForIn=function(o,e){var a=this.type===types$1._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!a||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(a?"for-in":"for-of")+" loop variable declaration may not have an initializer"),o.left=e,o.right=a?this.parseExpression():this.parseMaybeAssign(),this.expect(types$1.parenR),o.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(o,a?"ForInStatement":"ForOfStatement")},pp$8.parseVar=function(o,e,a,l){for(o.declarations=[],o.kind=a;;){var u=this.startNode();if(this.parseVarId(u,a),this.eat(types$1.eq)?u.init=this.parseMaybeAssign(e):!l&&a==="const"&&!(this.type===types$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!l&&(a==="using"||a==="await using")&&this.options.ecmaVersion>=17&&this.type!==types$1._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+a+" declaration"):!l&&u.id.type!=="Identifier"&&!(e&&(this.type===types$1._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):u.init=null,o.declarations.push(this.finishNode(u,"VariableDeclarator")),!this.eat(types$1.comma))break}return o},pp$8.parseVarId=function(o,e){o.id=e==="using"||e==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(o.id,e==="var"?BIND_VAR:BIND_LEXICAL,!1)};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;pp$8.parseFunction=function(o,e,a,l,u){this.initFunction(o),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!l)&&(this.type===types$1.star&&e&FUNC_HANGING_STATEMENT&&this.unexpected(),o.generator=this.eat(types$1.star)),this.options.ecmaVersion>=8&&(o.async=!!l),e&FUNC_STATEMENT&&(o.id=e&FUNC_NULLABLE_ID&&this.type!==types$1.name?null:this.parseIdent(),o.id&&!(e&FUNC_HANGING_STATEMENT)&&this.checkLValSimple(o.id,this.strict||o.generator||o.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION));var p=this.yieldPos,d=this.awaitPos,f=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(o.async,o.generator)),e&FUNC_STATEMENT||(o.id=this.type===types$1.name?this.parseIdent():null),this.parseFunctionParams(o),this.parseFunctionBody(o,a,!1,u),this.yieldPos=p,this.awaitPos=d,this.awaitIdentPos=f,this.finishNode(o,e&FUNC_STATEMENT?"FunctionDeclaration":"FunctionExpression")},pp$8.parseFunctionParams=function(o){this.expect(types$1.parenL),o.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},pp$8.parseClass=function(o,e){this.next();var a=this.strict;this.strict=!0,this.parseClassId(o,e),this.parseClassSuper(o);var l=this.enterClassBody(),u=this.startNode(),p=!1;for(u.body=[],this.expect(types$1.braceL);this.type!==types$1.braceR;){var d=this.parseClassElement(o.superClass!==null);d&&(u.body.push(d),d.type==="MethodDefinition"&&d.kind==="constructor"?(p&&this.raiseRecoverable(d.start,"Duplicate constructor in the same class"),p=!0):d.key&&d.key.type==="PrivateIdentifier"&&isPrivateNameConflicted(l,d)&&this.raiseRecoverable(d.key.start,"Identifier '#"+d.key.name+"' has already been declared"))}return this.strict=a,this.next(),o.body=this.finishNode(u,"ClassBody"),this.exitClassBody(),this.finishNode(o,e?"ClassDeclaration":"ClassExpression")},pp$8.parseClassElement=function(o){if(this.eat(types$1.semi))return null;var e=this.options.ecmaVersion,a=this.startNode(),l="",u=!1,p=!1,d="method",f=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(types$1.braceL))return this.parseClassStaticBlock(a),a;this.isClassElementNameStart()||this.type===types$1.star?f=!0:l="static"}if(a.static=f,!l&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===types$1.star)&&!this.canInsertSemicolon()?p=!0:l="async"),!l&&(e>=9||!p)&&this.eat(types$1.star)&&(u=!0),!l&&!p&&!u){var g=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?d=g:l=g)}if(l?(a.computed=!1,a.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),a.key.name=l,this.finishNode(a.key,"Identifier")):this.parseClassElementName(a),e<13||this.type===types$1.parenL||d!=="method"||u||p){var b=!a.static&&checkKeyName(a,"constructor"),A=b&&o;b&&d!=="method"&&this.raise(a.key.start,"Constructor can't have get/set modifier"),a.kind=b?"constructor":d,this.parseClassMethod(a,u,p,A)}else this.parseClassField(a);return a},pp$8.isClassElementNameStart=function(){return this.type===types$1.name||this.type===types$1.privateId||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword},pp$8.parseClassElementName=function(o){this.type===types$1.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),o.computed=!1,o.key=this.parsePrivateIdent()):this.parsePropertyName(o)},pp$8.parseClassMethod=function(o,e,a,l){var u=o.key;o.kind==="constructor"?(e&&this.raise(u.start,"Constructor can't be a generator"),a&&this.raise(u.start,"Constructor can't be an async method")):o.static&&checkKeyName(o,"prototype")&&this.raise(u.start,"Classes may not have a static property named prototype");var p=o.value=this.parseMethod(e,a,l);return o.kind==="get"&&p.params.length!==0&&this.raiseRecoverable(p.start,"getter should have no params"),o.kind==="set"&&p.params.length!==1&&this.raiseRecoverable(p.start,"setter should have exactly one param"),o.kind==="set"&&p.params[0].type==="RestElement"&&this.raiseRecoverable(p.params[0].start,"Setter cannot use rest params"),this.finishNode(o,"MethodDefinition")},pp$8.parseClassField=function(o){return checkKeyName(o,"constructor")?this.raise(o.key.start,"Classes can't have a field named 'constructor'"):o.static&&checkKeyName(o,"prototype")&&this.raise(o.key.start,"Classes can't have a static field named 'prototype'"),this.eat(types$1.eq)?(this.enterScope(SCOPE_CLASS_FIELD_INIT|SCOPE_SUPER),o.value=this.parseMaybeAssign(),this.exitScope()):o.value=null,this.semicolon(),this.finishNode(o,"PropertyDefinition")},pp$8.parseClassStaticBlock=function(o){o.body=[];var e=this.labels;for(this.labels=[],this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);this.type!==types$1.braceR;){var a=this.parseStatement(null);o.body.push(a)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(o,"StaticBlock")},pp$8.parseClassId=function(o,e){this.type===types$1.name?(o.id=this.parseIdent(),e&&this.checkLValSimple(o.id,BIND_LEXICAL,!1)):(e===!0&&this.unexpected(),o.id=null)},pp$8.parseClassSuper=function(o){o.superClass=this.eat(types$1._extends)?this.parseExprSubscripts(null,!1):null},pp$8.enterClassBody=function(){var o={declared:Object.create(null),used:[]};return this.privateNameStack.push(o),o.declared},pp$8.exitClassBody=function(){var o=this.privateNameStack.pop(),e=o.declared,a=o.used;if(this.options.checkPrivateFields)for(var l=this.privateNameStack.length,u=l===0?null:this.privateNameStack[l-1],p=0;p<a.length;++p){var d=a[p];hasOwn(e,d.name)||(u?u.used.push(d):this.raiseRecoverable(d.start,"Private field '#"+d.name+"' must be declared in an enclosing class"))}};function isPrivateNameConflicted(o,e){var a=e.key.name,l=o[a],u="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(u=(e.static?"s":"i")+e.kind),l==="iget"&&u==="iset"||l==="iset"&&u==="iget"||l==="sget"&&u==="sset"||l==="sset"&&u==="sget"?(o[a]="true",!1):l?!0:(o[a]=u,!1)}function checkKeyName(o,e){var a=o.computed,l=o.key;return!a&&(l.type==="Identifier"&&l.name===e||l.type==="Literal"&&l.value===e)}pp$8.parseExportAllDeclaration=function(o,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(o.exported=this.parseModuleExportName(),this.checkExport(e,o.exported,this.lastTokStart)):o.exported=null),this.expectContextual("from"),this.type!==types$1.string&&this.unexpected(),o.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(o.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(o,"ExportAllDeclaration")},pp$8.parseExport=function(o,e){if(this.next(),this.eat(types$1.star))return this.parseExportAllDeclaration(o,e);if(this.eat(types$1._default))return this.checkExport(e,"default",this.lastTokStart),o.declaration=this.parseExportDefaultDeclaration(),this.finishNode(o,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())o.declaration=this.parseExportDeclaration(o),o.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,o.declaration.declarations):this.checkExport(e,o.declaration.id,o.declaration.id.start),o.specifiers=[],o.source=null,this.options.ecmaVersion>=16&&(o.attributes=[]);else{if(o.declaration=null,o.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==types$1.string&&this.unexpected(),o.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(o.attributes=this.parseWithClause());else{for(var a=0,l=o.specifiers;a<l.length;a+=1){var u=l[a];this.checkUnreserved(u.local),this.checkLocalExport(u.local),u.local.type==="Literal"&&this.raise(u.local.start,"A string literal cannot be used as an exported binding without `from`.")}o.source=null,this.options.ecmaVersion>=16&&(o.attributes=[])}this.semicolon()}return this.finishNode(o,"ExportNamedDeclaration")},pp$8.parseExportDeclaration=function(o){return this.parseStatement(null)},pp$8.parseExportDefaultDeclaration=function(){var o;if(this.type===types$1._function||(o=this.isAsyncFunction())){var e=this.startNode();return this.next(),o&&this.next(),this.parseFunction(e,FUNC_STATEMENT|FUNC_NULLABLE_ID,!1,o)}else if(this.type===types$1._class){var a=this.startNode();return this.parseClass(a,"nullableID")}else{var l=this.parseMaybeAssign();return this.semicolon(),l}},pp$8.checkExport=function(o,e,a){o&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),hasOwn(o,e)&&this.raiseRecoverable(a,"Duplicate export '"+e+"'"),o[e]=!0)},pp$8.checkPatternExport=function(o,e){var a=e.type;if(a==="Identifier")this.checkExport(o,e,e.start);else if(a==="ObjectPattern")for(var l=0,u=e.properties;l<u.length;l+=1){var p=u[l];this.checkPatternExport(o,p)}else if(a==="ArrayPattern")for(var d=0,f=e.elements;d<f.length;d+=1){var g=f[d];g&&this.checkPatternExport(o,g)}else a==="Property"?this.checkPatternExport(o,e.value):a==="AssignmentPattern"?this.checkPatternExport(o,e.left):a==="RestElement"&&this.checkPatternExport(o,e.argument)},pp$8.checkVariableExport=function(o,e){if(o)for(var a=0,l=e;a<l.length;a+=1){var u=l[a];this.checkPatternExport(o,u.id)}},pp$8.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},pp$8.parseExportSpecifier=function(o){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(o,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")},pp$8.parseExportSpecifiers=function(o){var e=[],a=!0;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(a)a=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;e.push(this.parseExportSpecifier(o))}return e},pp$8.parseImport=function(o){return this.next(),this.type===types$1.string?(o.specifiers=empty$1,o.source=this.parseExprAtom()):(o.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),o.source=this.type===types$1.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(o.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(o,"ImportDeclaration")},pp$8.parseImportSpecifier=function(){var o=this.startNode();return o.imported=this.parseModuleExportName(),this.eatContextual("as")?o.local=this.parseIdent():(this.checkUnreserved(o.imported),o.local=o.imported),this.checkLValSimple(o.local,BIND_LEXICAL),this.finishNode(o,"ImportSpecifier")},pp$8.parseImportDefaultSpecifier=function(){var o=this.startNode();return o.local=this.parseIdent(),this.checkLValSimple(o.local,BIND_LEXICAL),this.finishNode(o,"ImportDefaultSpecifier")},pp$8.parseImportNamespaceSpecifier=function(){var o=this.startNode();return this.next(),this.expectContextual("as"),o.local=this.parseIdent(),this.checkLValSimple(o.local,BIND_LEXICAL),this.finishNode(o,"ImportNamespaceSpecifier")},pp$8.parseImportSpecifiers=function(){var o=[],e=!0;if(this.type===types$1.name&&(o.push(this.parseImportDefaultSpecifier()),!this.eat(types$1.comma)))return o;if(this.type===types$1.star)return o.push(this.parseImportNamespaceSpecifier()),o;for(this.expect(types$1.braceL);!this.eat(types$1.braceR);){if(e)e=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;o.push(this.parseImportSpecifier())}return o},pp$8.parseWithClause=function(){var o=[];if(!this.eat(types$1._with))return o;this.expect(types$1.braceL);for(var e={},a=!0;!this.eat(types$1.braceR);){if(a)a=!1;else if(this.expect(types$1.comma),this.afterTrailingComma(types$1.braceR))break;var l=this.parseImportAttribute(),u=l.key.type==="Identifier"?l.key.name:l.key.value;hasOwn(e,u)&&this.raiseRecoverable(l.key.start,"Duplicate attribute key '"+u+"'"),e[u]=!0,o.push(l)}return o},pp$8.parseImportAttribute=function(){var o=this.startNode();return o.key=this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(types$1.colon),this.type!==types$1.string&&this.unexpected(),o.value=this.parseExprAtom(),this.finishNode(o,"ImportAttribute")},pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1.string){var o=this.parseLiteral(this.value);return loneSurrogate.test(o.value)&&this.raise(o.start,"An export name cannot include a lone surrogate."),o}return this.parseIdent(!0)},pp$8.adaptDirectivePrologue=function(o){for(var e=0;e<o.length&&this.isDirectiveCandidate(o[e]);++e)o[e].directive=o[e].expression.raw.slice(1,-1)},pp$8.isDirectiveCandidate=function(o){return this.options.ecmaVersion>=5&&o.type==="ExpressionStatement"&&o.expression.type==="Literal"&&typeof o.expression.value=="string"&&(this.input[o.start]==='"'||this.input[o.start]==="'")};var pp$7=Parser.prototype;pp$7.toAssignable=function(o,e,a){if(this.options.ecmaVersion>=6&&o)switch(o.type){case"Identifier":this.inAsync&&o.name==="await"&&this.raise(o.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":o.type="ObjectPattern",a&&this.checkPatternErrors(a,!0);for(var l=0,u=o.properties;l<u.length;l+=1){var p=u[l];this.toAssignable(p,e),p.type==="RestElement"&&(p.argument.type==="ArrayPattern"||p.argument.type==="ObjectPattern")&&this.raise(p.argument.start,"Unexpected token")}break;case"Property":o.kind!=="init"&&this.raise(o.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(o.value,e);break;case"ArrayExpression":o.type="ArrayPattern",a&&this.checkPatternErrors(a,!0),this.toAssignableList(o.elements,e);break;case"SpreadElement":o.type="RestElement",this.toAssignable(o.argument,e),o.argument.type==="AssignmentPattern"&&this.raise(o.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":o.operator!=="="&&this.raise(o.left.end,"Only '=' operator can be used for specifying default value."),o.type="AssignmentPattern",delete o.operator,this.toAssignable(o.left,e);break;case"ParenthesizedExpression":this.toAssignable(o.expression,e,a);break;case"ChainExpression":this.raiseRecoverable(o.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(o.start,"Assigning to rvalue")}else a&&this.checkPatternErrors(a,!0);return o},pp$7.toAssignableList=function(o,e){for(var a=o.length,l=0;l<a;l++){var u=o[l];u&&this.toAssignable(u,e)}if(a){var p=o[a-1];this.options.ecmaVersion===6&&e&&p&&p.type==="RestElement"&&p.argument.type!=="Identifier"&&this.unexpected(p.argument.start)}return o},pp$7.parseSpread=function(o){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,o),this.finishNode(e,"SpreadElement")},pp$7.parseRestBinding=function(){var o=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==types$1.name&&this.unexpected(),o.argument=this.parseBindingAtom(),this.finishNode(o,"RestElement")},pp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case types$1.bracketL:var o=this.startNode();return this.next(),o.elements=this.parseBindingList(types$1.bracketR,!0,!0),this.finishNode(o,"ArrayPattern");case types$1.braceL:return this.parseObj(!0)}return this.parseIdent()},pp$7.parseBindingList=function(o,e,a,l){for(var u=[],p=!0;!this.eat(o);)if(p?p=!1:this.expect(types$1.comma),e&&this.type===types$1.comma)u.push(null);else{if(a&&this.afterTrailingComma(o))break;if(this.type===types$1.ellipsis){var d=this.parseRestBinding();this.parseBindingListItem(d),u.push(d),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(o);break}else u.push(this.parseAssignableListItem(l))}return u},pp$7.parseAssignableListItem=function(o){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e},pp$7.parseBindingListItem=function(o){return o},pp$7.parseMaybeDefault=function(o,e,a){if(a=a||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(types$1.eq))return a;var l=this.startNodeAt(o,e);return l.left=a,l.right=this.parseMaybeAssign(),this.finishNode(l,"AssignmentPattern")},pp$7.checkLValSimple=function(o,e,a){e===void 0&&(e=BIND_NONE);var l=e!==BIND_NONE;switch(o.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(o.name)&&this.raiseRecoverable(o.start,(l?"Binding ":"Assigning to ")+o.name+" in strict mode"),l&&(e===BIND_LEXICAL&&o.name==="let"&&this.raiseRecoverable(o.start,"let is disallowed as a lexically bound name"),a&&(hasOwn(a,o.name)&&this.raiseRecoverable(o.start,"Argument name clash"),a[o.name]=!0),e!==BIND_OUTSIDE&&this.declareName(o.name,e,o.start));break;case"ChainExpression":this.raiseRecoverable(o.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":l&&this.raiseRecoverable(o.start,"Binding member expression");break;case"ParenthesizedExpression":return l&&this.raiseRecoverable(o.start,"Binding parenthesized expression"),this.checkLValSimple(o.expression,e,a);default:this.raise(o.start,(l?"Binding":"Assigning to")+" rvalue")}},pp$7.checkLValPattern=function(o,e,a){switch(e===void 0&&(e=BIND_NONE),o.type){case"ObjectPattern":for(var l=0,u=o.properties;l<u.length;l+=1){var p=u[l];this.checkLValInnerPattern(p,e,a)}break;case"ArrayPattern":for(var d=0,f=o.elements;d<f.length;d+=1){var g=f[d];g&&this.checkLValInnerPattern(g,e,a)}break;default:this.checkLValSimple(o,e,a)}},pp$7.checkLValInnerPattern=function(o,e,a){switch(e===void 0&&(e=BIND_NONE),o.type){case"Property":this.checkLValInnerPattern(o.value,e,a);break;case"AssignmentPattern":this.checkLValPattern(o.left,e,a);break;case"RestElement":this.checkLValPattern(o.argument,e,a);break;default:this.checkLValPattern(o,e,a)}};var TokContext=function(e,a,l,u,p){this.token=e,this.isExpr=!!a,this.preserveSpace=!!l,this.override=u,this.generator=!!p},types={b_stat:new TokContext("{",!1),b_expr:new TokContext("{",!0),b_tmpl:new TokContext("${",!1),p_stat:new TokContext("(",!1),p_expr:new TokContext("(",!0),q_tmpl:new TokContext("`",!0,!0,function(o){return o.tryReadTemplateToken()}),f_stat:new TokContext("function",!1),f_expr:new TokContext("function",!0),f_expr_gen:new TokContext("function",!0,!1,null,!0),f_gen:new TokContext("function",!1,!1,null,!0)},pp$6=Parser.prototype;pp$6.initialContext=function(){return[types.b_stat]},pp$6.curContext=function(){return this.context[this.context.length-1]},pp$6.braceIsBlock=function(o){var e=this.curContext();return e===types.f_expr||e===types.f_stat?!0:o===types$1.colon&&(e===types.b_stat||e===types.b_expr)?!e.isExpr:o===types$1._return||o===types$1.name&&this.exprAllowed?lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):o===types$1._else||o===types$1.semi||o===types$1.eof||o===types$1.parenR||o===types$1.arrow?!0:o===types$1.braceL?e===types.b_stat:o===types$1._var||o===types$1._const||o===types$1.name?!1:!this.exprAllowed},pp$6.inGeneratorContext=function(){for(var o=this.context.length-1;o>=1;o--){var e=this.context[o];if(e.token==="function")return e.generator}return!1},pp$6.updateContext=function(o){var e,a=this.type;a.keyword&&o===types$1.dot?this.exprAllowed=!1:(e=a.updateContext)?e.call(this,o):this.exprAllowed=a.beforeExpr},pp$6.overrideContext=function(o){this.curContext()!==o&&(this.context[this.context.length-1]=o)},types$1.parenR.updateContext=types$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var o=this.context.pop();o===types.b_stat&&this.curContext().token==="function"&&(o=this.context.pop()),this.exprAllowed=!o.isExpr},types$1.braceL.updateContext=function(o){this.context.push(this.braceIsBlock(o)?types.b_stat:types.b_expr),this.exprAllowed=!0},types$1.dollarBraceL.updateContext=function(){this.context.push(types.b_tmpl),this.exprAllowed=!0},types$1.parenL.updateContext=function(o){var e=o===types$1._if||o===types$1._for||o===types$1._with||o===types$1._while;this.context.push(e?types.p_stat:types.p_expr),this.exprAllowed=!0},types$1.incDec.updateContext=function(){},types$1._function.updateContext=types$1._class.updateContext=function(o){o.beforeExpr&&o!==types$1._else&&!(o===types$1.semi&&this.curContext()!==types.p_stat)&&!(o===types$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((o===types$1.colon||o===types$1.braceL)&&this.curContext()===types.b_stat)?this.context.push(types.f_expr):this.context.push(types.f_stat),this.exprAllowed=!1},types$1.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},types$1.backQuote.updateContext=function(){this.curContext()===types.q_tmpl?this.context.pop():this.context.push(types.q_tmpl),this.exprAllowed=!1},types$1.star.updateContext=function(o){if(o===types$1._function){var e=this.context.length-1;this.context[e]===types.f_expr?this.context[e]=types.f_expr_gen:this.context[e]=types.f_gen}this.exprAllowed=!0},types$1.name.updateContext=function(o){var e=!1;this.options.ecmaVersion>=6&&o!==types$1.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var pp$5=Parser.prototype;pp$5.checkPropClash=function(o,e,a){if(!(this.options.ecmaVersion>=9&&o.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(o.computed||o.method||o.shorthand))){var l=o.key,u;switch(l.type){case"Identifier":u=l.name;break;case"Literal":u=String(l.value);break;default:return}var p=o.kind;if(this.options.ecmaVersion>=6){u==="__proto__"&&p==="init"&&(e.proto&&(a?a.doubleProto<0&&(a.doubleProto=l.start):this.raiseRecoverable(l.start,"Redefinition of __proto__ property")),e.proto=!0);return}u="$"+u;var d=e[u];if(d){var f;p==="init"?f=this.strict&&d.init||d.get||d.set:f=d.init||d[p],f&&this.raiseRecoverable(l.start,"Redefinition of property")}else d=e[u]={init:!1,get:!1,set:!1};d[p]=!0}},pp$5.parseExpression=function(o,e){var a=this.start,l=this.startLoc,u=this.parseMaybeAssign(o,e);if(this.type===types$1.comma){var p=this.startNodeAt(a,l);for(p.expressions=[u];this.eat(types$1.comma);)p.expressions.push(this.parseMaybeAssign(o,e));return this.finishNode(p,"SequenceExpression")}return u},pp$5.parseMaybeAssign=function(o,e,a){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(o);this.exprAllowed=!1}var l=!1,u=-1,p=-1,d=-1;e?(u=e.parenthesizedAssign,p=e.trailingComma,d=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new DestructuringErrors,l=!0);var f=this.start,g=this.startLoc;(this.type===types$1.parenL||this.type===types$1.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=o==="await");var b=this.parseMaybeConditional(o,e);if(a&&(b=a.call(this,b,f,g)),this.type.isAssign){var A=this.startNodeAt(f,g);return A.operator=this.value,this.type===types$1.eq&&(b=this.toAssignable(b,!1,e)),l||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=b.start&&(e.shorthandAssign=-1),this.type===types$1.eq?this.checkLValPattern(b):this.checkLValSimple(b),A.left=b,this.next(),A.right=this.parseMaybeAssign(o),d>-1&&(e.doubleProto=d),this.finishNode(A,"AssignmentExpression")}else l&&this.checkExpressionErrors(e,!0);return u>-1&&(e.parenthesizedAssign=u),p>-1&&(e.trailingComma=p),b},pp$5.parseMaybeConditional=function(o,e){var a=this.start,l=this.startLoc,u=this.parseExprOps(o,e);if(this.checkExpressionErrors(e))return u;if(this.eat(types$1.question)){var p=this.startNodeAt(a,l);return p.test=u,p.consequent=this.parseMaybeAssign(),this.expect(types$1.colon),p.alternate=this.parseMaybeAssign(o),this.finishNode(p,"ConditionalExpression")}return u},pp$5.parseExprOps=function(o,e){var a=this.start,l=this.startLoc,u=this.parseMaybeUnary(e,!1,!1,o);return this.checkExpressionErrors(e)||u.start===a&&u.type==="ArrowFunctionExpression"?u:this.parseExprOp(u,a,l,-1,o)},pp$5.parseExprOp=function(o,e,a,l,u){var p=this.type.binop;if(p!=null&&(!u||this.type!==types$1._in)&&p>l){var d=this.type===types$1.logicalOR||this.type===types$1.logicalAND,f=this.type===types$1.coalesce;f&&(p=types$1.logicalAND.binop);var g=this.value;this.next();var b=this.start,A=this.startLoc,S=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,u),b,A,p,u),M=this.buildBinary(e,a,o,S,g,d||f);return(d&&this.type===types$1.coalesce||f&&(this.type===types$1.logicalOR||this.type===types$1.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(M,e,a,l,u)}return o},pp$5.buildBinary=function(o,e,a,l,u,p){l.type==="PrivateIdentifier"&&this.raise(l.start,"Private identifier can only be left side of binary expression");var d=this.startNodeAt(o,e);return d.left=a,d.operator=u,d.right=l,this.finishNode(d,p?"LogicalExpression":"BinaryExpression")},pp$5.parseMaybeUnary=function(o,e,a,l){var u=this.start,p=this.startLoc,d;if(this.isContextual("await")&&this.canAwait)d=this.parseAwait(l),e=!0;else if(this.type.prefix){var f=this.startNode(),g=this.type===types$1.incDec;f.operator=this.value,f.prefix=!0,this.next(),f.argument=this.parseMaybeUnary(null,!0,g,l),this.checkExpressionErrors(o,!0),g?this.checkLValSimple(f.argument):this.strict&&f.operator==="delete"&&isLocalVariableAccess(f.argument)?this.raiseRecoverable(f.start,"Deleting local variable in strict mode"):f.operator==="delete"&&isPrivateFieldAccess(f.argument)?this.raiseRecoverable(f.start,"Private fields can not be deleted"):e=!0,d=this.finishNode(f,g?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===types$1.privateId)(l||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),d=this.parsePrivateIdent(),this.type!==types$1._in&&this.unexpected();else{if(d=this.parseExprSubscripts(o,l),this.checkExpressionErrors(o))return d;for(;this.type.postfix&&!this.canInsertSemicolon();){var b=this.startNodeAt(u,p);b.operator=this.value,b.prefix=!1,b.argument=d,this.checkLValSimple(d),this.next(),d=this.finishNode(b,"UpdateExpression")}}if(!a&&this.eat(types$1.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(u,p,d,this.parseMaybeUnary(null,!1,!1,l),"**",!1);else return d};function isLocalVariableAccess(o){return o.type==="Identifier"||o.type==="ParenthesizedExpression"&&isLocalVariableAccess(o.expression)}function isPrivateFieldAccess(o){return o.type==="MemberExpression"&&o.property.type==="PrivateIdentifier"||o.type==="ChainExpression"&&isPrivateFieldAccess(o.expression)||o.type==="ParenthesizedExpression"&&isPrivateFieldAccess(o.expression)}pp$5.parseExprSubscripts=function(o,e){var a=this.start,l=this.startLoc,u=this.parseExprAtom(o,e);if(u.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return u;var p=this.parseSubscripts(u,a,l,!1,e);return o&&p.type==="MemberExpression"&&(o.parenthesizedAssign>=p.start&&(o.parenthesizedAssign=-1),o.parenthesizedBind>=p.start&&(o.parenthesizedBind=-1),o.trailingComma>=p.start&&(o.trailingComma=-1)),p},pp$5.parseSubscripts=function(o,e,a,l,u){for(var p=this.options.ecmaVersion>=8&&o.type==="Identifier"&&o.name==="async"&&this.lastTokEnd===o.end&&!this.canInsertSemicolon()&&o.end-o.start===5&&this.potentialArrowAt===o.start,d=!1;;){var f=this.parseSubscript(o,e,a,l,p,d,u);if(f.optional&&(d=!0),f===o||f.type==="ArrowFunctionExpression"){if(d){var g=this.startNodeAt(e,a);g.expression=f,f=this.finishNode(g,"ChainExpression")}return f}o=f}},pp$5.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(types$1.arrow)},pp$5.parseSubscriptAsyncArrow=function(o,e,a,l){return this.parseArrowExpression(this.startNodeAt(o,e),a,!0,l)},pp$5.parseSubscript=function(o,e,a,l,u,p,d){var f=this.options.ecmaVersion>=11,g=f&&this.eat(types$1.questionDot);l&&g&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var b=this.eat(types$1.bracketL);if(b||g&&this.type!==types$1.parenL&&this.type!==types$1.backQuote||this.eat(types$1.dot)){var A=this.startNodeAt(e,a);A.object=o,b?(A.property=this.parseExpression(),this.expect(types$1.bracketR)):this.type===types$1.privateId&&o.type!=="Super"?A.property=this.parsePrivateIdent():A.property=this.parseIdent(this.options.allowReserved!=="never"),A.computed=!!b,f&&(A.optional=g),o=this.finishNode(A,"MemberExpression")}else if(!l&&this.eat(types$1.parenL)){var S=new DestructuringErrors,M=this.yieldPos,E=this.awaitPos,F=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var $=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1,S);if(u&&!g&&this.shouldParseAsyncArrow())return this.checkPatternErrors(S,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=M,this.awaitPos=E,this.awaitIdentPos=F,this.parseSubscriptAsyncArrow(e,a,$,d);this.checkExpressionErrors(S,!0),this.yieldPos=M||this.yieldPos,this.awaitPos=E||this.awaitPos,this.awaitIdentPos=F||this.awaitIdentPos;var Z=this.startNodeAt(e,a);Z.callee=o,Z.arguments=$,f&&(Z.optional=g),o=this.finishNode(Z,"CallExpression")}else if(this.type===types$1.backQuote){(g||p)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var V=this.startNodeAt(e,a);V.tag=o,V.quasi=this.parseTemplate({isTagged:!0}),o=this.finishNode(V,"TaggedTemplateExpression")}return o},pp$5.parseExprAtom=function(o,e,a){this.type===types$1.slash&&this.readRegexp();var l,u=this.potentialArrowAt===this.start;switch(this.type){case types$1._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),l=this.startNode(),this.next(),this.type===types$1.parenL&&!this.allowDirectSuper&&this.raise(l.start,"super() call outside constructor of a subclass"),this.type!==types$1.dot&&this.type!==types$1.bracketL&&this.type!==types$1.parenL&&this.unexpected(),this.finishNode(l,"Super");case types$1._this:return l=this.startNode(),this.next(),this.finishNode(l,"ThisExpression");case types$1.name:var p=this.start,d=this.startLoc,f=this.containsEsc,g=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!f&&g.name==="async"&&!this.canInsertSemicolon()&&this.eat(types$1._function))return this.overrideContext(types.f_expr),this.parseFunction(this.startNodeAt(p,d),0,!1,!0,e);if(u&&!this.canInsertSemicolon()){if(this.eat(types$1.arrow))return this.parseArrowExpression(this.startNodeAt(p,d),[g],!1,e);if(this.options.ecmaVersion>=8&&g.name==="async"&&this.type===types$1.name&&!f&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return g=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(types$1.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(p,d),[g],!0,e)}return g;case types$1.regexp:var b=this.value;return l=this.parseLiteral(b.value),l.regex={pattern:b.pattern,flags:b.flags},l;case types$1.num:case types$1.string:return this.parseLiteral(this.value);case types$1._null:case types$1._true:case types$1._false:return l=this.startNode(),l.value=this.type===types$1._null?null:this.type===types$1._true,l.raw=this.type.keyword,this.next(),this.finishNode(l,"Literal");case types$1.parenL:var A=this.start,S=this.parseParenAndDistinguishExpression(u,e);return o&&(o.parenthesizedAssign<0&&!this.isSimpleAssignTarget(S)&&(o.parenthesizedAssign=A),o.parenthesizedBind<0&&(o.parenthesizedBind=A)),S;case types$1.bracketL:return l=this.startNode(),this.next(),l.elements=this.parseExprList(types$1.bracketR,!0,!0,o),this.finishNode(l,"ArrayExpression");case types$1.braceL:return this.overrideContext(types.b_expr),this.parseObj(!1,o);case types$1._function:return l=this.startNode(),this.next(),this.parseFunction(l,0);case types$1._class:return this.parseClass(this.startNode(),!1);case types$1._new:return this.parseNew();case types$1.backQuote:return this.parseTemplate();case types$1._import:return this.options.ecmaVersion>=11?this.parseExprImport(a):this.unexpected();default:return this.parseExprAtomDefault()}},pp$5.parseExprAtomDefault=function(){this.unexpected()},pp$5.parseExprImport=function(o){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===types$1.parenL&&!o)return this.parseDynamicImport(e);if(this.type===types$1.dot){var a=this.startNodeAt(e.start,e.loc&&e.loc.start);return a.name="import",e.meta=this.finishNode(a,"Identifier"),this.parseImportMeta(e)}else this.unexpected()},pp$5.parseDynamicImport=function(o){if(this.next(),o.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(types$1.parenR)?o.options=null:(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)?o.options=null:(o.options=this.parseMaybeAssign(),this.eat(types$1.parenR)||(this.expect(types$1.comma),this.afterTrailingComma(types$1.parenR)||this.unexpected())));else if(!this.eat(types$1.parenR)){var e=this.start;this.eat(types$1.comma)&&this.eat(types$1.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(o,"ImportExpression")},pp$5.parseImportMeta=function(o){this.next();var e=this.containsEsc;return o.property=this.parseIdent(!0),o.property.name!=="meta"&&this.raiseRecoverable(o.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(o.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(o.start,"Cannot use 'import.meta' outside a module"),this.finishNode(o,"MetaProperty")},pp$5.parseLiteral=function(o){var e=this.startNode();return e.value=o,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.value!=null?e.value.toString():e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")},pp$5.parseParenExpression=function(){this.expect(types$1.parenL);var o=this.parseExpression();return this.expect(types$1.parenR),o},pp$5.shouldParseArrow=function(o){return!this.canInsertSemicolon()},pp$5.parseParenAndDistinguishExpression=function(o,e){var a=this.start,l=this.startLoc,u,p=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var d=this.start,f=this.startLoc,g=[],b=!0,A=!1,S=new DestructuringErrors,M=this.yieldPos,E=this.awaitPos,F;for(this.yieldPos=0,this.awaitPos=0;this.type!==types$1.parenR;)if(b?b=!1:this.expect(types$1.comma),p&&this.afterTrailingComma(types$1.parenR,!0)){A=!0;break}else if(this.type===types$1.ellipsis){F=this.start,g.push(this.parseParenItem(this.parseRestBinding())),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else g.push(this.parseMaybeAssign(!1,S,this.parseParenItem));var $=this.lastTokEnd,Z=this.lastTokEndLoc;if(this.expect(types$1.parenR),o&&this.shouldParseArrow(g)&&this.eat(types$1.arrow))return this.checkPatternErrors(S,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=M,this.awaitPos=E,this.parseParenArrowList(a,l,g,e);(!g.length||A)&&this.unexpected(this.lastTokStart),F&&this.unexpected(F),this.checkExpressionErrors(S,!0),this.yieldPos=M||this.yieldPos,this.awaitPos=E||this.awaitPos,g.length>1?(u=this.startNodeAt(d,f),u.expressions=g,this.finishNodeAt(u,"SequenceExpression",$,Z)):u=g[0]}else u=this.parseParenExpression();if(this.options.preserveParens){var V=this.startNodeAt(a,l);return V.expression=u,this.finishNode(V,"ParenthesizedExpression")}else return u},pp$5.parseParenItem=function(o){return o},pp$5.parseParenArrowList=function(o,e,a,l){return this.parseArrowExpression(this.startNodeAt(o,e),a,!1,l)};var empty=[];pp$5.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var o=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===types$1.dot){var e=this.startNodeAt(o.start,o.loc&&o.loc.start);e.name="new",o.meta=this.finishNode(e,"Identifier"),this.next();var a=this.containsEsc;return o.property=this.parseIdent(!0),o.property.name!=="target"&&this.raiseRecoverable(o.property.start,"The only valid meta property for new is 'new.target'"),a&&this.raiseRecoverable(o.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(o.start,"'new.target' can only be used in functions and class static block"),this.finishNode(o,"MetaProperty")}var l=this.start,u=this.startLoc;return o.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),l,u,!0,!1),this.eat(types$1.parenL)?o.arguments=this.parseExprList(types$1.parenR,this.options.ecmaVersion>=8,!1):o.arguments=empty,this.finishNode(o,"NewExpression")},pp$5.parseTemplateElement=function(o){var e=o.isTagged,a=this.startNode();return this.type===types$1.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),a.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):a.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),a.tail=this.type===types$1.backQuote,this.finishNode(a,"TemplateElement")},pp$5.parseTemplate=function(o){o===void 0&&(o={});var e=o.isTagged;e===void 0&&(e=!1);var a=this.startNode();this.next(),a.expressions=[];var l=this.parseTemplateElement({isTagged:e});for(a.quasis=[l];!l.tail;)this.type===types$1.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(types$1.dollarBraceL),a.expressions.push(this.parseExpression()),this.expect(types$1.braceR),a.quasis.push(l=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(a,"TemplateLiteral")},pp$5.isAsyncProp=function(o){return!o.computed&&o.key.type==="Identifier"&&o.key.name==="async"&&(this.type===types$1.name||this.type===types$1.num||this.type===types$1.string||this.type===types$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},pp$5.parseObj=function(o,e){var a=this.startNode(),l=!0,u={};for(a.properties=[],this.next();!this.eat(types$1.braceR);){if(l)l=!1;else if(this.expect(types$1.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1.braceR))break;var p=this.parseProperty(o,e);o||this.checkPropClash(p,u,e),a.properties.push(p)}return this.finishNode(a,o?"ObjectPattern":"ObjectExpression")},pp$5.parseProperty=function(o,e){var a=this.startNode(),l,u,p,d;if(this.options.ecmaVersion>=9&&this.eat(types$1.ellipsis))return o?(a.argument=this.parseIdent(!1),this.type===types$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(a.argument=this.parseMaybeAssign(!1,e),this.type===types$1.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(a,"SpreadElement"));this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(o||e)&&(p=this.start,d=this.startLoc),o||(l=this.eat(types$1.star)));var f=this.containsEsc;return this.parsePropertyName(a),!o&&!f&&this.options.ecmaVersion>=8&&!l&&this.isAsyncProp(a)?(u=!0,l=this.options.ecmaVersion>=9&&this.eat(types$1.star),this.parsePropertyName(a)):u=!1,this.parsePropertyValue(a,o,l,u,p,d,e,f),this.finishNode(a,"Property")},pp$5.parseGetterSetter=function(o){var e=o.key.name;this.parsePropertyName(o),o.value=this.parseMethod(!1),o.kind=e;var a=o.kind==="get"?0:1;if(o.value.params.length!==a){var l=o.value.start;o.kind==="get"?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else o.kind==="set"&&o.value.params[0].type==="RestElement"&&this.raiseRecoverable(o.value.params[0].start,"Setter cannot use rest params")},pp$5.parsePropertyValue=function(o,e,a,l,u,p,d,f){(a||l)&&this.type===types$1.colon&&this.unexpected(),this.eat(types$1.colon)?(o.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,d),o.kind="init"):this.options.ecmaVersion>=6&&this.type===types$1.parenL?(e&&this.unexpected(),o.method=!0,o.value=this.parseMethod(a,l),o.kind="init"):!e&&!f&&this.options.ecmaVersion>=5&&!o.computed&&o.key.type==="Identifier"&&(o.key.name==="get"||o.key.name==="set")&&this.type!==types$1.comma&&this.type!==types$1.braceR&&this.type!==types$1.eq?((a||l)&&this.unexpected(),this.parseGetterSetter(o)):this.options.ecmaVersion>=6&&!o.computed&&o.key.type==="Identifier"?((a||l)&&this.unexpected(),this.checkUnreserved(o.key),o.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=u),e?o.value=this.parseMaybeDefault(u,p,this.copyNode(o.key)):this.type===types$1.eq&&d?(d.shorthandAssign<0&&(d.shorthandAssign=this.start),o.value=this.parseMaybeDefault(u,p,this.copyNode(o.key))):o.value=this.copyNode(o.key),o.kind="init",o.shorthand=!0):this.unexpected()},pp$5.parsePropertyName=function(o){if(this.options.ecmaVersion>=6){if(this.eat(types$1.bracketL))return o.computed=!0,o.key=this.parseMaybeAssign(),this.expect(types$1.bracketR),o.key;o.computed=!1}return o.key=this.type===types$1.num||this.type===types$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},pp$5.initFunction=function(o){o.id=null,this.options.ecmaVersion>=6&&(o.generator=o.expression=!1),this.options.ecmaVersion>=8&&(o.async=!1)},pp$5.parseMethod=function(o,e,a){var l=this.startNode(),u=this.yieldPos,p=this.awaitPos,d=this.awaitIdentPos;return this.initFunction(l),this.options.ecmaVersion>=6&&(l.generator=o),this.options.ecmaVersion>=8&&(l.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(e,l.generator)|SCOPE_SUPER|(a?SCOPE_DIRECT_SUPER:0)),this.expect(types$1.parenL),l.params=this.parseBindingList(types$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(l,!1,!0,!1),this.yieldPos=u,this.awaitPos=p,this.awaitIdentPos=d,this.finishNode(l,"FunctionExpression")},pp$5.parseArrowExpression=function(o,e,a,l){var u=this.yieldPos,p=this.awaitPos,d=this.awaitIdentPos;return this.enterScope(functionFlags(a,!1)|SCOPE_ARROW),this.initFunction(o),this.options.ecmaVersion>=8&&(o.async=!!a),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,o.params=this.toAssignableList(e,!0),this.parseFunctionBody(o,!0,!1,l),this.yieldPos=u,this.awaitPos=p,this.awaitIdentPos=d,this.finishNode(o,"ArrowFunctionExpression")},pp$5.parseFunctionBody=function(o,e,a,l){var u=e&&this.type!==types$1.braceL,p=this.strict,d=!1;if(u)o.body=this.parseMaybeAssign(l),o.expression=!0,this.checkParams(o,!1);else{var f=this.options.ecmaVersion>=7&&!this.isSimpleParamList(o.params);(!p||f)&&(d=this.strictDirective(this.end),d&&f&&this.raiseRecoverable(o.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var g=this.labels;this.labels=[],d&&(this.strict=!0),this.checkParams(o,!p&&!d&&!e&&!a&&this.isSimpleParamList(o.params)),this.strict&&o.id&&this.checkLValSimple(o.id,BIND_OUTSIDE),o.body=this.parseBlock(!1,void 0,d&&!p),o.expression=!1,this.adaptDirectivePrologue(o.body.body),this.labels=g}this.exitScope()},pp$5.isSimpleParamList=function(o){for(var e=0,a=o;e<a.length;e+=1){var l=a[e];if(l.type!=="Identifier")return!1}return!0},pp$5.checkParams=function(o,e){for(var a=Object.create(null),l=0,u=o.params;l<u.length;l+=1){var p=u[l];this.checkLValInnerPattern(p,BIND_VAR,e?null:a)}},pp$5.parseExprList=function(o,e,a,l){for(var u=[],p=!0;!this.eat(o);){if(p)p=!1;else if(this.expect(types$1.comma),e&&this.afterTrailingComma(o))break;var d=void 0;a&&this.type===types$1.comma?d=null:this.type===types$1.ellipsis?(d=this.parseSpread(l),l&&this.type===types$1.comma&&l.trailingComma<0&&(l.trailingComma=this.start)):d=this.parseMaybeAssign(!1,l),u.push(d)}return u},pp$5.checkUnreserved=function(o){var e=o.start,a=o.end,l=o.name;if(this.inGenerator&&l==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&l==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&SCOPE_VAR)&&l==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(l==="arguments"||l==="await")&&this.raise(e,"Cannot use "+l+" in class static initialization block"),this.keywords.test(l)&&this.raise(e,"Unexpected keyword '"+l+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,a).indexOf("\\")!==-1)){var u=this.strict?this.reservedWordsStrict:this.reservedWords;u.test(l)&&(!this.inAsync&&l==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+l+"' is reserved"))}},pp$5.parseIdent=function(o){var e=this.parseIdentNode();return this.next(!!o),this.finishNode(e,"Identifier"),o||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e},pp$5.parseIdentNode=function(){var o=this.startNode();return this.type===types$1.name?o.name=this.value:this.type.keyword?(o.name=this.type.keyword,(o.name==="class"||o.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=types$1.name):this.unexpected(),o},pp$5.parsePrivateIdent=function(){var o=this.startNode();return this.type===types$1.privateId?o.name=this.value:this.unexpected(),this.next(),this.finishNode(o,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(o)),o},pp$5.parseYield=function(o){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===types$1.semi||this.canInsertSemicolon()||this.type!==types$1.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(types$1.star),e.argument=this.parseMaybeAssign(o)),this.finishNode(e,"YieldExpression")},pp$5.parseAwait=function(o){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,o),this.finishNode(e,"AwaitExpression")};var pp$4=Parser.prototype;pp$4.raise=function(o,e){var a=getLineInfo(this.input,o);e+=" ("+a.line+":"+a.column+")",this.sourceFile&&(e+=" in "+this.sourceFile);var l=new SyntaxError(e);throw l.pos=o,l.loc=a,l.raisedAt=this.pos,l},pp$4.raiseRecoverable=pp$4.raise,pp$4.curPosition=function(){if(this.options.locations)return new Position(this.curLine,this.pos-this.lineStart)};var pp$3=Parser.prototype,Scope=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};pp$3.enterScope=function(o){this.scopeStack.push(new Scope(o))},pp$3.exitScope=function(){this.scopeStack.pop()},pp$3.treatFunctionsAsVarInScope=function(o){return o.flags&SCOPE_FUNCTION||!this.inModule&&o.flags&SCOPE_TOP},pp$3.declareName=function(o,e,a){var l=!1;if(e===BIND_LEXICAL){var u=this.currentScope();l=u.lexical.indexOf(o)>-1||u.functions.indexOf(o)>-1||u.var.indexOf(o)>-1,u.lexical.push(o),this.inModule&&u.flags&SCOPE_TOP&&delete this.undefinedExports[o]}else if(e===BIND_SIMPLE_CATCH){var p=this.currentScope();p.lexical.push(o)}else if(e===BIND_FUNCTION){var d=this.currentScope();this.treatFunctionsAsVar?l=d.lexical.indexOf(o)>-1:l=d.lexical.indexOf(o)>-1||d.var.indexOf(o)>-1,d.functions.push(o)}else for(var f=this.scopeStack.length-1;f>=0;--f){var g=this.scopeStack[f];if(g.lexical.indexOf(o)>-1&&!(g.flags&SCOPE_SIMPLE_CATCH&&g.lexical[0]===o)||!this.treatFunctionsAsVarInScope(g)&&g.functions.indexOf(o)>-1){l=!0;break}if(g.var.push(o),this.inModule&&g.flags&SCOPE_TOP&&delete this.undefinedExports[o],g.flags&SCOPE_VAR)break}l&&this.raiseRecoverable(a,"Identifier '"+o+"' has already been declared")},pp$3.checkLocalExport=function(o){this.scopeStack[0].lexical.indexOf(o.name)===-1&&this.scopeStack[0].var.indexOf(o.name)===-1&&(this.undefinedExports[o.name]=o)},pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},pp$3.currentVarScope=function(){for(var o=this.scopeStack.length-1;;o--){var e=this.scopeStack[o];if(e.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK))return e}},pp$3.currentThisScope=function(){for(var o=this.scopeStack.length-1;;o--){var e=this.scopeStack[o];if(e.flags&(SCOPE_VAR|SCOPE_CLASS_FIELD_INIT|SCOPE_CLASS_STATIC_BLOCK)&&!(e.flags&SCOPE_ARROW))return e}};var Node=function(e,a,l){this.type="",this.start=a,this.end=0,e.options.locations&&(this.loc=new SourceLocation(e,l)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[a,0])},pp$2=Parser.prototype;pp$2.startNode=function(){return new Node(this,this.start,this.startLoc)},pp$2.startNodeAt=function(o,e){return new Node(this,o,e)};function finishNodeAt(o,e,a,l){return o.type=e,o.end=a,this.options.locations&&(o.loc.end=l),this.options.ranges&&(o.range[1]=a),o}pp$2.finishNode=function(o,e){return finishNodeAt.call(this,o,e,this.lastTokEnd,this.lastTokEndLoc)},pp$2.finishNodeAt=function(o,e,a,l){return finishNodeAt.call(this,o,e,a,l)},pp$2.copyNode=function(o){var e=new Node(this,o.start,this.startLoc);for(var a in o)e[a]=o[a];return e};var scriptValuesAddedInUnicode="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",ecma9BinaryProperties="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ecma10BinaryProperties=ecma9BinaryProperties+" Extended_Pictographic",ecma11BinaryProperties=ecma10BinaryProperties,ecma12BinaryProperties=ecma11BinaryProperties+" EBase EComp EMod EPres ExtPict",ecma13BinaryProperties=ecma12BinaryProperties,ecma14BinaryProperties=ecma13BinaryProperties,unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties,14:ecma14BinaryProperties},ecma14BinaryPropertiesOfStrings="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",unicodeBinaryPropertiesOfStrings={9:"",10:"",11:"",12:"",13:"",14:ecma14BinaryPropertiesOfStrings},unicodeGeneralCategoryValues="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ecma9ScriptValues="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ecma10ScriptValues=ecma9ScriptValues+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ecma11ScriptValues=ecma10ScriptValues+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ecma12ScriptValues=ecma11ScriptValues+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ecma13ScriptValues=ecma12ScriptValues+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ecma14ScriptValues=ecma13ScriptValues+" "+scriptValuesAddedInUnicode,unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues,14:ecma14ScriptValues},data={};function buildUnicodeData(o){var e=data[o]={binary:wordsRegexp(unicodeBinaryProperties[o]+" "+unicodeGeneralCategoryValues),binaryOfStrings:wordsRegexp(unicodeBinaryPropertiesOfStrings[o]),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[o])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var i=0,list=[9,10,11,12,13,14];i<list.length;i+=1){var ecmaVersion=list[i];buildUnicodeData(ecmaVersion)}var pp$1=Parser.prototype,BranchID=function(e,a){this.parent=e,this.base=a||this};BranchID.prototype.separatedFrom=function(e){for(var a=this;a;a=a.parent)for(var l=e;l;l=l.parent)if(a.base===l.base&&a!==l)return!0;return!1},BranchID.prototype.sibling=function(){return new BranchID(this.parent,this.base)};var RegExpValidationState=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=data[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};RegExpValidationState.prototype.reset=function(e,a,l){var u=l.indexOf("v")!==-1,p=l.indexOf("u")!==-1;this.start=e|0,this.source=a+"",this.flags=l,u&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=p&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=p&&this.parser.options.ecmaVersion>=9)},RegExpValidationState.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},RegExpValidationState.prototype.at=function(e,a){a===void 0&&(a=!1);var l=this.source,u=l.length;if(e>=u)return-1;var p=l.charCodeAt(e);if(!(a||this.switchU)||p<=55295||p>=57344||e+1>=u)return p;var d=l.charCodeAt(e+1);return d>=56320&&d<=57343?(p<<10)+d-56613888:p},RegExpValidationState.prototype.nextIndex=function(e,a){a===void 0&&(a=!1);var l=this.source,u=l.length;if(e>=u)return u;var p=l.charCodeAt(e),d;return!(a||this.switchU)||p<=55295||p>=57344||e+1>=u||(d=l.charCodeAt(e+1))<56320||d>57343?e+1:e+2},RegExpValidationState.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)},RegExpValidationState.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)},RegExpValidationState.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)},RegExpValidationState.prototype.eat=function(e,a){return a===void 0&&(a=!1),this.current(a)===e?(this.advance(a),!0):!1},RegExpValidationState.prototype.eatChars=function(e,a){a===void 0&&(a=!1);for(var l=this.pos,u=0,p=e;u<p.length;u+=1){var d=p[u],f=this.at(l,a);if(f===-1||f!==d)return!1;l=this.nextIndex(l,a)}return this.pos=l,!0},pp$1.validateRegExpFlags=function(o){for(var e=o.validFlags,a=o.flags,l=!1,u=!1,p=0;p<a.length;p++){var d=a.charAt(p);e.indexOf(d)===-1&&this.raise(o.start,"Invalid regular expression flag"),a.indexOf(d,p+1)>-1&&this.raise(o.start,"Duplicate regular expression flag"),d==="u"&&(l=!0),d==="v"&&(u=!0)}this.options.ecmaVersion>=15&&l&&u&&this.raise(o.start,"Invalid regular expression flag")};function hasProp(o){for(var e in o)return!0;return!1}pp$1.validateRegExpPattern=function(o){this.regexp_pattern(o),!o.switchN&&this.options.ecmaVersion>=9&&hasProp(o.groupNames)&&(o.switchN=!0,this.regexp_pattern(o))},pp$1.regexp_pattern=function(o){o.pos=0,o.lastIntValue=0,o.lastStringValue="",o.lastAssertionIsQuantifiable=!1,o.numCapturingParens=0,o.maxBackReference=0,o.groupNames=Object.create(null),o.backReferenceNames.length=0,o.branchID=null,this.regexp_disjunction(o),o.pos!==o.source.length&&(o.eat(41)&&o.raise("Unmatched ')'"),(o.eat(93)||o.eat(125))&&o.raise("Lone quantifier brackets")),o.maxBackReference>o.numCapturingParens&&o.raise("Invalid escape");for(var e=0,a=o.backReferenceNames;e<a.length;e+=1){var l=a[e];o.groupNames[l]||o.raise("Invalid named capture referenced")}},pp$1.regexp_disjunction=function(o){var e=this.options.ecmaVersion>=16;for(e&&(o.branchID=new BranchID(o.branchID,null)),this.regexp_alternative(o);o.eat(124);)e&&(o.branchID=o.branchID.sibling()),this.regexp_alternative(o);e&&(o.branchID=o.branchID.parent),this.regexp_eatQuantifier(o,!0)&&o.raise("Nothing to repeat"),o.eat(123)&&o.raise("Lone quantifier brackets")},pp$1.regexp_alternative=function(o){for(;o.pos<o.source.length&&this.regexp_eatTerm(o););},pp$1.regexp_eatTerm=function(o){return this.regexp_eatAssertion(o)?(o.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(o)&&o.switchU&&o.raise("Invalid quantifier"),!0):(o.switchU?this.regexp_eatAtom(o):this.regexp_eatExtendedAtom(o))?(this.regexp_eatQuantifier(o),!0):!1},pp$1.regexp_eatAssertion=function(o){var e=o.pos;if(o.lastAssertionIsQuantifiable=!1,o.eat(94)||o.eat(36))return!0;if(o.eat(92)){if(o.eat(66)||o.eat(98))return!0;o.pos=e}if(o.eat(40)&&o.eat(63)){var a=!1;if(this.options.ecmaVersion>=9&&(a=o.eat(60)),o.eat(61)||o.eat(33))return this.regexp_disjunction(o),o.eat(41)||o.raise("Unterminated group"),o.lastAssertionIsQuantifiable=!a,!0}return o.pos=e,!1},pp$1.regexp_eatQuantifier=function(o,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(o,e)?(o.eat(63),!0):!1},pp$1.regexp_eatQuantifierPrefix=function(o,e){return o.eat(42)||o.eat(43)||o.eat(63)||this.regexp_eatBracedQuantifier(o,e)},pp$1.regexp_eatBracedQuantifier=function(o,e){var a=o.pos;if(o.eat(123)){var l=0,u=-1;if(this.regexp_eatDecimalDigits(o)&&(l=o.lastIntValue,o.eat(44)&&this.regexp_eatDecimalDigits(o)&&(u=o.lastIntValue),o.eat(125)))return u!==-1&&u<l&&!e&&o.raise("numbers out of order in {} quantifier"),!0;o.switchU&&!e&&o.raise("Incomplete quantifier"),o.pos=a}return!1},pp$1.regexp_eatAtom=function(o){return this.regexp_eatPatternCharacters(o)||o.eat(46)||this.regexp_eatReverseSolidusAtomEscape(o)||this.regexp_eatCharacterClass(o)||this.regexp_eatUncapturingGroup(o)||this.regexp_eatCapturingGroup(o)},pp$1.regexp_eatReverseSolidusAtomEscape=function(o){var e=o.pos;if(o.eat(92)){if(this.regexp_eatAtomEscape(o))return!0;o.pos=e}return!1},pp$1.regexp_eatUncapturingGroup=function(o){var e=o.pos;if(o.eat(40)){if(o.eat(63)){if(this.options.ecmaVersion>=16){var a=this.regexp_eatModifiers(o),l=o.eat(45);if(a||l){for(var u=0;u<a.length;u++){var p=a.charAt(u);a.indexOf(p,u+1)>-1&&o.raise("Duplicate regular expression modifiers")}if(l){var d=this.regexp_eatModifiers(o);!a&&!d&&o.current()===58&&o.raise("Invalid regular expression modifiers");for(var f=0;f<d.length;f++){var g=d.charAt(f);(d.indexOf(g,f+1)>-1||a.indexOf(g)>-1)&&o.raise("Duplicate regular expression modifiers")}}}}if(o.eat(58)){if(this.regexp_disjunction(o),o.eat(41))return!0;o.raise("Unterminated group")}}o.pos=e}return!1},pp$1.regexp_eatCapturingGroup=function(o){if(o.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(o):o.current()===63&&o.raise("Invalid group"),this.regexp_disjunction(o),o.eat(41))return o.numCapturingParens+=1,!0;o.raise("Unterminated group")}return!1},pp$1.regexp_eatModifiers=function(o){for(var e="",a=0;(a=o.current())!==-1&&isRegularExpressionModifier(a);)e+=codePointToString(a),o.advance();return e};function isRegularExpressionModifier(o){return o===105||o===109||o===115}pp$1.regexp_eatExtendedAtom=function(o){return o.eat(46)||this.regexp_eatReverseSolidusAtomEscape(o)||this.regexp_eatCharacterClass(o)||this.regexp_eatUncapturingGroup(o)||this.regexp_eatCapturingGroup(o)||this.regexp_eatInvalidBracedQuantifier(o)||this.regexp_eatExtendedPatternCharacter(o)},pp$1.regexp_eatInvalidBracedQuantifier=function(o){return this.regexp_eatBracedQuantifier(o,!0)&&o.raise("Nothing to repeat"),!1},pp$1.regexp_eatSyntaxCharacter=function(o){var e=o.current();return isSyntaxCharacter(e)?(o.lastIntValue=e,o.advance(),!0):!1};function isSyntaxCharacter(o){return o===36||o>=40&&o<=43||o===46||o===63||o>=91&&o<=94||o>=123&&o<=125}pp$1.regexp_eatPatternCharacters=function(o){for(var e=o.pos,a=0;(a=o.current())!==-1&&!isSyntaxCharacter(a);)o.advance();return o.pos!==e},pp$1.regexp_eatExtendedPatternCharacter=function(o){var e=o.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(o.advance(),!0):!1},pp$1.regexp_groupSpecifier=function(o){if(o.eat(63)){this.regexp_eatGroupName(o)||o.raise("Invalid group");var e=this.options.ecmaVersion>=16,a=o.groupNames[o.lastStringValue];if(a)if(e)for(var l=0,u=a;l<u.length;l+=1){var p=u[l];p.separatedFrom(o.branchID)||o.raise("Duplicate capture group name")}else o.raise("Duplicate capture group name");e?(a||(o.groupNames[o.lastStringValue]=[])).push(o.branchID):o.groupNames[o.lastStringValue]=!0}},pp$1.regexp_eatGroupName=function(o){if(o.lastStringValue="",o.eat(60)){if(this.regexp_eatRegExpIdentifierName(o)&&o.eat(62))return!0;o.raise("Invalid capture group name")}return!1},pp$1.regexp_eatRegExpIdentifierName=function(o){if(o.lastStringValue="",this.regexp_eatRegExpIdentifierStart(o)){for(o.lastStringValue+=codePointToString(o.lastIntValue);this.regexp_eatRegExpIdentifierPart(o);)o.lastStringValue+=codePointToString(o.lastIntValue);return!0}return!1},pp$1.regexp_eatRegExpIdentifierStart=function(o){var e=o.pos,a=this.options.ecmaVersion>=11,l=o.current(a);return o.advance(a),l===92&&this.regexp_eatRegExpUnicodeEscapeSequence(o,a)&&(l=o.lastIntValue),isRegExpIdentifierStart(l)?(o.lastIntValue=l,!0):(o.pos=e,!1)};function isRegExpIdentifierStart(o){return isIdentifierStart(o,!0)||o===36||o===95}pp$1.regexp_eatRegExpIdentifierPart=function(o){var e=o.pos,a=this.options.ecmaVersion>=11,l=o.current(a);return o.advance(a),l===92&&this.regexp_eatRegExpUnicodeEscapeSequence(o,a)&&(l=o.lastIntValue),isRegExpIdentifierPart(l)?(o.lastIntValue=l,!0):(o.pos=e,!1)};function isRegExpIdentifierPart(o){return isIdentifierChar(o,!0)||o===36||o===95||o===8204||o===8205}pp$1.regexp_eatAtomEscape=function(o){return this.regexp_eatBackReference(o)||this.regexp_eatCharacterClassEscape(o)||this.regexp_eatCharacterEscape(o)||o.switchN&&this.regexp_eatKGroupName(o)?!0:(o.switchU&&(o.current()===99&&o.raise("Invalid unicode escape"),o.raise("Invalid escape")),!1)},pp$1.regexp_eatBackReference=function(o){var e=o.pos;if(this.regexp_eatDecimalEscape(o)){var a=o.lastIntValue;if(o.switchU)return a>o.maxBackReference&&(o.maxBackReference=a),!0;if(a<=o.numCapturingParens)return!0;o.pos=e}return!1},pp$1.regexp_eatKGroupName=function(o){if(o.eat(107)){if(this.regexp_eatGroupName(o))return o.backReferenceNames.push(o.lastStringValue),!0;o.raise("Invalid named reference")}return!1},pp$1.regexp_eatCharacterEscape=function(o){return this.regexp_eatControlEscape(o)||this.regexp_eatCControlLetter(o)||this.regexp_eatZero(o)||this.regexp_eatHexEscapeSequence(o)||this.regexp_eatRegExpUnicodeEscapeSequence(o,!1)||!o.switchU&&this.regexp_eatLegacyOctalEscapeSequence(o)||this.regexp_eatIdentityEscape(o)},pp$1.regexp_eatCControlLetter=function(o){var e=o.pos;if(o.eat(99)){if(this.regexp_eatControlLetter(o))return!0;o.pos=e}return!1},pp$1.regexp_eatZero=function(o){return o.current()===48&&!isDecimalDigit(o.lookahead())?(o.lastIntValue=0,o.advance(),!0):!1},pp$1.regexp_eatControlEscape=function(o){var e=o.current();return e===116?(o.lastIntValue=9,o.advance(),!0):e===110?(o.lastIntValue=10,o.advance(),!0):e===118?(o.lastIntValue=11,o.advance(),!0):e===102?(o.lastIntValue=12,o.advance(),!0):e===114?(o.lastIntValue=13,o.advance(),!0):!1},pp$1.regexp_eatControlLetter=function(o){var e=o.current();return isControlLetter(e)?(o.lastIntValue=e%32,o.advance(),!0):!1};function isControlLetter(o){return o>=65&&o<=90||o>=97&&o<=122}pp$1.regexp_eatRegExpUnicodeEscapeSequence=function(o,e){e===void 0&&(e=!1);var a=o.pos,l=e||o.switchU;if(o.eat(117)){if(this.regexp_eatFixedHexDigits(o,4)){var u=o.lastIntValue;if(l&&u>=55296&&u<=56319){var p=o.pos;if(o.eat(92)&&o.eat(117)&&this.regexp_eatFixedHexDigits(o,4)){var d=o.lastIntValue;if(d>=56320&&d<=57343)return o.lastIntValue=(u-55296)*1024+(d-56320)+65536,!0}o.pos=p,o.lastIntValue=u}return!0}if(l&&o.eat(123)&&this.regexp_eatHexDigits(o)&&o.eat(125)&&isValidUnicode(o.lastIntValue))return!0;l&&o.raise("Invalid unicode escape"),o.pos=a}return!1};function isValidUnicode(o){return o>=0&&o<=1114111}pp$1.regexp_eatIdentityEscape=function(o){if(o.switchU)return this.regexp_eatSyntaxCharacter(o)?!0:o.eat(47)?(o.lastIntValue=47,!0):!1;var e=o.current();return e!==99&&(!o.switchN||e!==107)?(o.lastIntValue=e,o.advance(),!0):!1},pp$1.regexp_eatDecimalEscape=function(o){o.lastIntValue=0;var e=o.current();if(e>=49&&e<=57){do o.lastIntValue=10*o.lastIntValue+(e-48),o.advance();while((e=o.current())>=48&&e<=57);return!0}return!1};var CharSetNone=0,CharSetOk=1,CharSetString=2;pp$1.regexp_eatCharacterClassEscape=function(o){var e=o.current();if(isCharacterClassEscape(e))return o.lastIntValue=-1,o.advance(),CharSetOk;var a=!1;if(o.switchU&&this.options.ecmaVersion>=9&&((a=e===80)||e===112)){o.lastIntValue=-1,o.advance();var l;if(o.eat(123)&&(l=this.regexp_eatUnicodePropertyValueExpression(o))&&o.eat(125))return a&&l===CharSetString&&o.raise("Invalid property name"),l;o.raise("Invalid property name")}return CharSetNone};function isCharacterClassEscape(o){return o===100||o===68||o===115||o===83||o===119||o===87}pp$1.regexp_eatUnicodePropertyValueExpression=function(o){var e=o.pos;if(this.regexp_eatUnicodePropertyName(o)&&o.eat(61)){var a=o.lastStringValue;if(this.regexp_eatUnicodePropertyValue(o)){var l=o.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(o,a,l),CharSetOk}}if(o.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(o)){var u=o.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(o,u)}return CharSetNone},pp$1.regexp_validateUnicodePropertyNameAndValue=function(o,e,a){hasOwn(o.unicodeProperties.nonBinary,e)||o.raise("Invalid property name"),o.unicodeProperties.nonBinary[e].test(a)||o.raise("Invalid property value")},pp$1.regexp_validateUnicodePropertyNameOrValue=function(o,e){if(o.unicodeProperties.binary.test(e))return CharSetOk;if(o.switchV&&o.unicodeProperties.binaryOfStrings.test(e))return CharSetString;o.raise("Invalid property name")},pp$1.regexp_eatUnicodePropertyName=function(o){var e=0;for(o.lastStringValue="";isUnicodePropertyNameCharacter(e=o.current());)o.lastStringValue+=codePointToString(e),o.advance();return o.lastStringValue!==""};function isUnicodePropertyNameCharacter(o){return isControlLetter(o)||o===95}pp$1.regexp_eatUnicodePropertyValue=function(o){var e=0;for(o.lastStringValue="";isUnicodePropertyValueCharacter(e=o.current());)o.lastStringValue+=codePointToString(e),o.advance();return o.lastStringValue!==""};function isUnicodePropertyValueCharacter(o){return isUnicodePropertyNameCharacter(o)||isDecimalDigit(o)}pp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(o){return this.regexp_eatUnicodePropertyValue(o)},pp$1.regexp_eatCharacterClass=function(o){if(o.eat(91)){var e=o.eat(94),a=this.regexp_classContents(o);return o.eat(93)||o.raise("Unterminated character class"),e&&a===CharSetString&&o.raise("Negated character class may contain strings"),!0}return!1},pp$1.regexp_classContents=function(o){return o.current()===93?CharSetOk:o.switchV?this.regexp_classSetExpression(o):(this.regexp_nonEmptyClassRanges(o),CharSetOk)},pp$1.regexp_nonEmptyClassRanges=function(o){for(;this.regexp_eatClassAtom(o);){var e=o.lastIntValue;if(o.eat(45)&&this.regexp_eatClassAtom(o)){var a=o.lastIntValue;o.switchU&&(e===-1||a===-1)&&o.raise("Invalid character class"),e!==-1&&a!==-1&&e>a&&o.raise("Range out of order in character class")}}},pp$1.regexp_eatClassAtom=function(o){var e=o.pos;if(o.eat(92)){if(this.regexp_eatClassEscape(o))return!0;if(o.switchU){var a=o.current();(a===99||isOctalDigit(a))&&o.raise("Invalid class escape"),o.raise("Invalid escape")}o.pos=e}var l=o.current();return l!==93?(o.lastIntValue=l,o.advance(),!0):!1},pp$1.regexp_eatClassEscape=function(o){var e=o.pos;if(o.eat(98))return o.lastIntValue=8,!0;if(o.switchU&&o.eat(45))return o.lastIntValue=45,!0;if(!o.switchU&&o.eat(99)){if(this.regexp_eatClassControlLetter(o))return!0;o.pos=e}return this.regexp_eatCharacterClassEscape(o)||this.regexp_eatCharacterEscape(o)},pp$1.regexp_classSetExpression=function(o){var e=CharSetOk,a;if(!this.regexp_eatClassSetRange(o))if(a=this.regexp_eatClassSetOperand(o)){a===CharSetString&&(e=CharSetString);for(var l=o.pos;o.eatChars([38,38]);){if(o.current()!==38&&(a=this.regexp_eatClassSetOperand(o))){a!==CharSetString&&(e=CharSetOk);continue}o.raise("Invalid character in character class")}if(l!==o.pos)return e;for(;o.eatChars([45,45]);)this.regexp_eatClassSetOperand(o)||o.raise("Invalid character in character class");if(l!==o.pos)return e}else o.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(o)){if(a=this.regexp_eatClassSetOperand(o),!a)return e;a===CharSetString&&(e=CharSetString)}},pp$1.regexp_eatClassSetRange=function(o){var e=o.pos;if(this.regexp_eatClassSetCharacter(o)){var a=o.lastIntValue;if(o.eat(45)&&this.regexp_eatClassSetCharacter(o)){var l=o.lastIntValue;return a!==-1&&l!==-1&&a>l&&o.raise("Range out of order in character class"),!0}o.pos=e}return!1},pp$1.regexp_eatClassSetOperand=function(o){return this.regexp_eatClassSetCharacter(o)?CharSetOk:this.regexp_eatClassStringDisjunction(o)||this.regexp_eatNestedClass(o)},pp$1.regexp_eatNestedClass=function(o){var e=o.pos;if(o.eat(91)){var a=o.eat(94),l=this.regexp_classContents(o);if(o.eat(93))return a&&l===CharSetString&&o.raise("Negated character class may contain strings"),l;o.pos=e}if(o.eat(92)){var u=this.regexp_eatCharacterClassEscape(o);if(u)return u;o.pos=e}return null},pp$1.regexp_eatClassStringDisjunction=function(o){var e=o.pos;if(o.eatChars([92,113])){if(o.eat(123)){var a=this.regexp_classStringDisjunctionContents(o);if(o.eat(125))return a}else o.raise("Invalid escape");o.pos=e}return null},pp$1.regexp_classStringDisjunctionContents=function(o){for(var e=this.regexp_classString(o);o.eat(124);)this.regexp_classString(o)===CharSetString&&(e=CharSetString);return e},pp$1.regexp_classString=function(o){for(var e=0;this.regexp_eatClassSetCharacter(o);)e++;return e===1?CharSetOk:CharSetString},pp$1.regexp_eatClassSetCharacter=function(o){var e=o.pos;if(o.eat(92))return this.regexp_eatCharacterEscape(o)||this.regexp_eatClassSetReservedPunctuator(o)?!0:o.eat(98)?(o.lastIntValue=8,!0):(o.pos=e,!1);var a=o.current();return a<0||a===o.lookahead()&&isClassSetReservedDoublePunctuatorCharacter(a)||isClassSetSyntaxCharacter(a)?!1:(o.advance(),o.lastIntValue=a,!0)};function isClassSetReservedDoublePunctuatorCharacter(o){return o===33||o>=35&&o<=38||o>=42&&o<=44||o===46||o>=58&&o<=64||o===94||o===96||o===126}function isClassSetSyntaxCharacter(o){return o===40||o===41||o===45||o===47||o>=91&&o<=93||o>=123&&o<=125}pp$1.regexp_eatClassSetReservedPunctuator=function(o){var e=o.current();return isClassSetReservedPunctuator(e)?(o.lastIntValue=e,o.advance(),!0):!1};function isClassSetReservedPunctuator(o){return o===33||o===35||o===37||o===38||o===44||o===45||o>=58&&o<=62||o===64||o===96||o===126}pp$1.regexp_eatClassControlLetter=function(o){var e=o.current();return isDecimalDigit(e)||e===95?(o.lastIntValue=e%32,o.advance(),!0):!1},pp$1.regexp_eatHexEscapeSequence=function(o){var e=o.pos;if(o.eat(120)){if(this.regexp_eatFixedHexDigits(o,2))return!0;o.switchU&&o.raise("Invalid escape"),o.pos=e}return!1},pp$1.regexp_eatDecimalDigits=function(o){var e=o.pos,a=0;for(o.lastIntValue=0;isDecimalDigit(a=o.current());)o.lastIntValue=10*o.lastIntValue+(a-48),o.advance();return o.pos!==e};function isDecimalDigit(o){return o>=48&&o<=57}pp$1.regexp_eatHexDigits=function(o){var e=o.pos,a=0;for(o.lastIntValue=0;isHexDigit(a=o.current());)o.lastIntValue=16*o.lastIntValue+hexToInt(a),o.advance();return o.pos!==e};function isHexDigit(o){return o>=48&&o<=57||o>=65&&o<=70||o>=97&&o<=102}function hexToInt(o){return o>=65&&o<=70?10+(o-65):o>=97&&o<=102?10+(o-97):o-48}pp$1.regexp_eatLegacyOctalEscapeSequence=function(o){if(this.regexp_eatOctalDigit(o)){var e=o.lastIntValue;if(this.regexp_eatOctalDigit(o)){var a=o.lastIntValue;e<=3&&this.regexp_eatOctalDigit(o)?o.lastIntValue=e*64+a*8+o.lastIntValue:o.lastIntValue=e*8+a}else o.lastIntValue=e;return!0}return!1},pp$1.regexp_eatOctalDigit=function(o){var e=o.current();return isOctalDigit(e)?(o.lastIntValue=e-48,o.advance(),!0):(o.lastIntValue=0,!1)};function isOctalDigit(o){return o>=48&&o<=55}pp$1.regexp_eatFixedHexDigits=function(o,e){var a=o.pos;o.lastIntValue=0;for(var l=0;l<e;++l){var u=o.current();if(!isHexDigit(u))return o.pos=a,!1;o.lastIntValue=16*o.lastIntValue+hexToInt(u),o.advance()}return!0};var Token=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new SourceLocation(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},pp=Parser.prototype;pp.next=function(o){!o&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Token(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},pp.getToken=function(){return this.next(),new Token(this)},typeof Symbol<"u"&&(pp[Symbol.iterator]=function(){var o=this;return{next:function(){var e=o.getToken();return{done:e.type===types$1.eof,value:e}}}}),pp.nextToken=function(){var o=this.curContext();if((!o||!o.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(types$1.eof);if(o.override)return o.override(this);this.readToken(this.fullCharCodeAtPos())},pp.readToken=function(o){return isIdentifierStart(o,this.options.ecmaVersion>=6)||o===92?this.readWord():this.getTokenFromCode(o)},pp.fullCharCodeAtPos=function(){var o=this.input.charCodeAt(this.pos);if(o<=55295||o>=56320)return o;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?o:(o<<10)+e-56613888},pp.skipBlockComment=function(){var o=this.options.onComment&&this.curPosition(),e=this.pos,a=this.input.indexOf("*/",this.pos+=2);if(a===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=a+2,this.options.locations)for(var l=void 0,u=e;(l=nextLineBreak(this.input,u,this.pos))>-1;)++this.curLine,u=this.lineStart=l;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,a),e,this.pos,o,this.curPosition())},pp.skipLineComment=function(o){for(var e=this.pos,a=this.options.onComment&&this.curPosition(),l=this.input.charCodeAt(this.pos+=o);this.pos<this.input.length&&!isNewLine(l);)l=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+o,this.pos),e,this.pos,a,this.curPosition())},pp.skipSpace=function(){e:for(;this.pos<this.input.length;){var o=this.input.charCodeAt(this.pos);switch(o){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(o>8&&o<14||o>=5760&&nonASCIIwhitespace.test(String.fromCharCode(o)))++this.pos;else break e}}},pp.finishToken=function(o,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var a=this.type;this.type=o,this.value=e,this.updateContext(a)},pp.readToken_dot=function(){var o=this.input.charCodeAt(this.pos+1);if(o>=48&&o<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&o===46&&e===46?(this.pos+=3,this.finishToken(types$1.ellipsis)):(++this.pos,this.finishToken(types$1.dot))},pp.readToken_slash=function(){var o=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):o===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.slash,1)},pp.readToken_mult_modulo_exp=function(o){var e=this.input.charCodeAt(this.pos+1),a=1,l=o===42?types$1.star:types$1.modulo;return this.options.ecmaVersion>=7&&o===42&&e===42&&(++a,l=types$1.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(types$1.assign,a+1):this.finishOp(l,a)},pp.readToken_pipe_amp=function(o){var e=this.input.charCodeAt(this.pos+1);if(e===o){if(this.options.ecmaVersion>=12){var a=this.input.charCodeAt(this.pos+2);if(a===61)return this.finishOp(types$1.assign,3)}return this.finishOp(o===124?types$1.logicalOR:types$1.logicalAND,2)}return e===61?this.finishOp(types$1.assign,2):this.finishOp(o===124?types$1.bitwiseOR:types$1.bitwiseAND,1)},pp.readToken_caret=function(){var o=this.input.charCodeAt(this.pos+1);return o===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.bitwiseXOR,1)},pp.readToken_plus_min=function(o){var e=this.input.charCodeAt(this.pos+1);return e===o?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(types$1.incDec,2):e===61?this.finishOp(types$1.assign,2):this.finishOp(types$1.plusMin,1)},pp.readToken_lt_gt=function(o){var e=this.input.charCodeAt(this.pos+1),a=1;return e===o?(a=o===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+a)===61?this.finishOp(types$1.assign,a+1):this.finishOp(types$1.bitShift,a)):e===33&&o===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(a=2),this.finishOp(types$1.relational,a))},pp.readToken_eq_excl=function(o){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(types$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2):o===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(types$1.arrow)):this.finishOp(o===61?types$1.eq:types$1.prefix,1)},pp.readToken_question=function(){var o=this.options.ecmaVersion;if(o>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var a=this.input.charCodeAt(this.pos+2);if(a<48||a>57)return this.finishOp(types$1.questionDot,2)}if(e===63){if(o>=12){var l=this.input.charCodeAt(this.pos+2);if(l===61)return this.finishOp(types$1.assign,3)}return this.finishOp(types$1.coalesce,2)}}return this.finishOp(types$1.question,1)},pp.readToken_numberSign=function(){var o=this.options.ecmaVersion,e=35;if(o>=13&&(++this.pos,e=this.fullCharCodeAtPos(),isIdentifierStart(e,!0)||e===92))return this.finishToken(types$1.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+codePointToString(e)+"'")},pp.getTokenFromCode=function(o){switch(o){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(types$1.parenL);case 41:return++this.pos,this.finishToken(types$1.parenR);case 59:return++this.pos,this.finishToken(types$1.semi);case 44:return++this.pos,this.finishToken(types$1.comma);case 91:return++this.pos,this.finishToken(types$1.bracketL);case 93:return++this.pos,this.finishToken(types$1.bracketR);case 123:return++this.pos,this.finishToken(types$1.braceL);case 125:return++this.pos,this.finishToken(types$1.braceR);case 58:return++this.pos,this.finishToken(types$1.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(types$1.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(o);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(o);case 124:case 38:return this.readToken_pipe_amp(o);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(o);case 60:case 62:return this.readToken_lt_gt(o);case 61:case 33:return this.readToken_eq_excl(o);case 63:return this.readToken_question();case 126:return this.finishOp(types$1.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+codePointToString(o)+"'")},pp.finishOp=function(o,e){var a=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(o,a)},pp.readRegexp=function(){for(var o,e,a=this.pos;;){this.pos>=this.input.length&&this.raise(a,"Unterminated regular expression");var l=this.input.charAt(this.pos);if(lineBreak.test(l)&&this.raise(a,"Unterminated regular expression"),o)o=!1;else{if(l==="[")e=!0;else if(l==="]"&&e)e=!1;else if(l==="/"&&!e)break;o=l==="\\"}++this.pos}var u=this.input.slice(a,this.pos);++this.pos;var p=this.pos,d=this.readWord1();this.containsEsc&&this.unexpected(p);var f=this.regexpState||(this.regexpState=new RegExpValidationState(this));f.reset(a,u,d),this.validateRegExpFlags(f),this.validateRegExpPattern(f);var g=null;try{g=new RegExp(u,d)}catch{}return this.finishToken(types$1.regexp,{pattern:u,flags:d,value:g})},pp.readInt=function(o,e,a){for(var l=this.options.ecmaVersion>=12&&e===void 0,u=a&&this.input.charCodeAt(this.pos)===48,p=this.pos,d=0,f=0,g=0,b=e??1/0;g<b;++g,++this.pos){var A=this.input.charCodeAt(this.pos),S=void 0;if(l&&A===95){u&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),f===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),g===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),f=A;continue}if(A>=97?S=A-97+10:A>=65?S=A-65+10:A>=48&&A<=57?S=A-48:S=1/0,S>=o)break;f=A,d=d*o+S}return l&&f===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===p||e!=null&&this.pos-p!==e?null:d};function stringToNumber(o,e){return e?parseInt(o,8):parseFloat(o.replace(/_/g,""))}function stringToBigInt(o){return typeof BigInt!="function"?null:BigInt(o.replace(/_/g,""))}pp.readRadixNumber=function(o){var e=this.pos;this.pos+=2;var a=this.readInt(o);return a==null&&this.raise(this.start+2,"Expected number in radix "+o),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(a=stringToBigInt(this.input.slice(e,this.pos)),++this.pos):isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,a)},pp.readNumber=function(o){var e=this.pos;!o&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var a=this.pos-e>=2&&this.input.charCodeAt(e)===48;a&&this.strict&&this.raise(e,"Invalid number");var l=this.input.charCodeAt(this.pos);if(!a&&!o&&this.options.ecmaVersion>=11&&l===110){var u=stringToBigInt(this.input.slice(e,this.pos));return++this.pos,isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1.num,u)}a&&/[89]/.test(this.input.slice(e,this.pos))&&(a=!1),l===46&&!a&&(++this.pos,this.readInt(10),l=this.input.charCodeAt(this.pos)),(l===69||l===101)&&!a&&(l=this.input.charCodeAt(++this.pos),(l===43||l===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var p=stringToNumber(this.input.slice(e,this.pos),a);return this.finishToken(types$1.num,p)},pp.readCodePoint=function(){var o=this.input.charCodeAt(this.pos),e;if(o===123){this.options.ecmaVersion<6&&this.unexpected();var a=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(a,"Code point out of bounds")}else e=this.readHexChar(4);return e},pp.readString=function(o){for(var e="",a=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var l=this.input.charCodeAt(this.pos);if(l===o)break;l===92?(e+=this.input.slice(a,this.pos),e+=this.readEscapedChar(!1),a=this.pos):l===8232||l===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(isNewLine(l)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(a,this.pos++),this.finishToken(types$1.string,e)};var INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(o){if(o===INVALID_TEMPLATE_ESCAPE_ERROR)this.readInvalidTemplateToken();else throw o}this.inTemplateElement=!1},pp.invalidStringToken=function(o,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw INVALID_TEMPLATE_ESCAPE_ERROR;this.raise(o,e)},pp.readTmplToken=function(){for(var o="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var a=this.input.charCodeAt(this.pos);if(a===96||a===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===types$1.template||this.type===types$1.invalidTemplate)?a===36?(this.pos+=2,this.finishToken(types$1.dollarBraceL)):(++this.pos,this.finishToken(types$1.backQuote)):(o+=this.input.slice(e,this.pos),this.finishToken(types$1.template,o));if(a===92)o+=this.input.slice(e,this.pos),o+=this.readEscapedChar(!0),e=this.pos;else if(isNewLine(a)){switch(o+=this.input.slice(e,this.pos),++this.pos,a){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:o+=`
`;break;default:o+=String.fromCharCode(a);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},pp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(types$1.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},pp.readEscapedChar=function(o){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return codePointToString(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),o){var a=this.pos-1;this.invalidStringToken(a,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var l=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],u=parseInt(l,8);return u>255&&(l=l.slice(0,-1),u=parseInt(l,8)),this.pos+=l.length-1,e=this.input.charCodeAt(this.pos),(l!=="0"||e===56||e===57)&&(this.strict||o)&&this.invalidStringToken(this.pos-1-l.length,o?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(u)}return isNewLine(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}},pp.readHexChar=function(o){var e=this.pos,a=this.readInt(16,o);return a===null&&this.invalidStringToken(e,"Bad character escape sequence"),a},pp.readWord1=function(){this.containsEsc=!1;for(var o="",e=!0,a=this.pos,l=this.options.ecmaVersion>=6;this.pos<this.input.length;){var u=this.fullCharCodeAtPos();if(isIdentifierChar(u,l))this.pos+=u<=65535?1:2;else if(u===92){this.containsEsc=!0,o+=this.input.slice(a,this.pos);var p=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var d=this.readCodePoint();(e?isIdentifierStart:isIdentifierChar)(d,l)||this.invalidStringToken(p,"Invalid Unicode escape"),o+=codePointToString(d),a=this.pos}else break;e=!1}return o+this.input.slice(a,this.pos)},pp.readWord=function(){var o=this.readWord1(),e=types$1.name;return this.keywords.test(o)&&(e=keywords[o]),this.finishToken(e,o)};var version$1="8.15.0";Parser.acorn={Parser,version:version$1,defaultOptions,Position,SourceLocation,getLineInfo,Node,TokenType,tokTypes:types$1,keywordTypes:keywords,TokContext,tokContexts:types,isIdentifierChar,isIdentifierStart,Token,isNewLine,lineBreak,lineBreakG,nonASCIIwhitespace};function parse(o,e){return Parser.parse(o,e)}var escodegen$1={},estraverse={},hasRequiredEstraverse;function requireEstraverse(){return hasRequiredEstraverse||(hasRequiredEstraverse=1,(function(o){(function e(a){var l,u,p,d,f,g;function b(U){var ee={},ae,de;for(ae in U)U.hasOwnProperty(ae)&&(de=U[ae],typeof de=="object"&&de!==null?ee[ae]=b(de):ee[ae]=de);return ee}function A(U,ee){var ae,de,ke,Oe;for(de=U.length,ke=0;de;)ae=de>>>1,Oe=ke+ae,ee(U[Oe])?de=ae:(ke=Oe+1,de-=ae+1);return ke}l={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},p={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},d={},f={},g={},u={Break:d,Skip:f,Remove:g};function S(U,ee){this.parent=U,this.key=ee}S.prototype.replace=function(ee){this.parent[this.key]=ee},S.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function M(U,ee,ae,de){this.node=U,this.path=ee,this.wrap=ae,this.ref=de}function E(){}E.prototype.path=function(){var ee,ae,de,ke,Oe,De;function Ae(Pe,We){if(Array.isArray(We))for(de=0,ke=We.length;de<ke;++de)Pe.push(We[de]);else Pe.push(We)}if(!this.__current.path)return null;for(Oe=[],ee=2,ae=this.__leavelist.length;ee<ae;++ee)De=this.__leavelist[ee],Ae(Oe,De.path);return Ae(Oe,this.__current.path),Oe},E.prototype.type=function(){var U=this.current();return U.type||this.__current.wrap},E.prototype.parents=function(){var ee,ae,de;for(de=[],ee=1,ae=this.__leavelist.length;ee<ae;++ee)de.push(this.__leavelist[ee].node);return de},E.prototype.current=function(){return this.__current.node},E.prototype.__execute=function(ee,ae){var de,ke;return ke=void 0,de=this.__current,this.__current=ae,this.__state=null,ee&&(ke=ee.call(this,ae.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=de,ke},E.prototype.notify=function(ee){this.__state=ee},E.prototype.skip=function(){this.notify(f)},E.prototype.break=function(){this.notify(d)},E.prototype.remove=function(){this.notify(g)},E.prototype.__initialize=function(U,ee){this.visitor=ee,this.root=U,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,ee.fallback==="iteration"?this.__fallback=Object.keys:typeof ee.fallback=="function"&&(this.__fallback=ee.fallback),this.__keys=p,ee.keys&&(this.__keys=Object.assign(Object.create(this.__keys),ee.keys))};function F(U){return U==null?!1:typeof U=="object"&&typeof U.type=="string"}function $(U,ee){return(U===l.ObjectExpression||U===l.ObjectPattern)&&ee==="properties"}function Z(U,ee){for(var ae=U.length-1;ae>=0;--ae)if(U[ae].node===ee)return!0;return!1}E.prototype.traverse=function(ee,ae){var de,ke,Oe,De,Ae,Pe,We,qe,at,yt,ut,Dt;for(this.__initialize(ee,ae),Dt={},de=this.__worklist,ke=this.__leavelist,de.push(new M(ee,null,null,null)),ke.push(new M(null,null,null,null));de.length;){if(Oe=de.pop(),Oe===Dt){if(Oe=ke.pop(),Pe=this.__execute(ae.leave,Oe),this.__state===d||Pe===d)return;continue}if(Oe.node){if(Pe=this.__execute(ae.enter,Oe),this.__state===d||Pe===d)return;if(de.push(Dt),ke.push(Oe),this.__state===f||Pe===f)continue;if(De=Oe.node,Ae=De.type||Oe.wrap,yt=this.__keys[Ae],!yt)if(this.__fallback)yt=this.__fallback(De);else throw new Error("Unknown node type "+Ae+".");for(qe=yt.length;(qe-=1)>=0;)if(We=yt[qe],ut=De[We],!!ut){if(Array.isArray(ut)){for(at=ut.length;(at-=1)>=0;)if(ut[at]&&!Z(ke,ut[at])){if($(Ae,yt[qe]))Oe=new M(ut[at],[We,at],"Property",null);else if(F(ut[at]))Oe=new M(ut[at],[We,at],null,null);else continue;de.push(Oe)}}else if(F(ut)){if(Z(ke,ut))continue;de.push(new M(ut,We,null,null))}}}}},E.prototype.replace=function(ee,ae){var de,ke,Oe,De,Ae,Pe,We,qe,at,yt,ut,Dt,$t;function Bt($e){var bt,nn,Zt,Rt;if($e.ref.remove()){for(nn=$e.ref.key,Rt=$e.ref.parent,bt=de.length;bt--;)if(Zt=de[bt],Zt.ref&&Zt.ref.parent===Rt){if(Zt.ref.key<nn)break;--Zt.ref.key}}}for(this.__initialize(ee,ae),ut={},de=this.__worklist,ke=this.__leavelist,Dt={root:ee},Pe=new M(ee,null,null,new S(Dt,"root")),de.push(Pe),ke.push(Pe);de.length;){if(Pe=de.pop(),Pe===ut){if(Pe=ke.pop(),Ae=this.__execute(ae.leave,Pe),Ae!==void 0&&Ae!==d&&Ae!==f&&Ae!==g&&Pe.ref.replace(Ae),(this.__state===g||Ae===g)&&Bt(Pe),this.__state===d||Ae===d)return Dt.root;continue}if(Ae=this.__execute(ae.enter,Pe),Ae!==void 0&&Ae!==d&&Ae!==f&&Ae!==g&&(Pe.ref.replace(Ae),Pe.node=Ae),(this.__state===g||Ae===g)&&(Bt(Pe),Pe.node=null),this.__state===d||Ae===d)return Dt.root;if(Oe=Pe.node,!!Oe&&(de.push(ut),ke.push(Pe),!(this.__state===f||Ae===f))){if(De=Oe.type||Pe.wrap,at=this.__keys[De],!at)if(this.__fallback)at=this.__fallback(Oe);else throw new Error("Unknown node type "+De+".");for(We=at.length;(We-=1)>=0;)if($t=at[We],yt=Oe[$t],!!yt)if(Array.isArray(yt)){for(qe=yt.length;(qe-=1)>=0;)if(yt[qe]){if($(De,at[We]))Pe=new M(yt[qe],[$t,qe],"Property",new S(yt,qe));else if(F(yt[qe]))Pe=new M(yt[qe],[$t,qe],null,new S(yt,qe));else continue;de.push(Pe)}}else F(yt)&&de.push(new M(yt,$t,null,new S(Oe,$t)))}}return Dt.root};function V(U,ee){var ae=new E;return ae.traverse(U,ee)}function K(U,ee){var ae=new E;return ae.replace(U,ee)}function se(U,ee){var ae;return ae=A(ee,function(ke){return ke.range[0]>U.range[0]}),U.extendedRange=[U.range[0],U.range[1]],ae!==ee.length&&(U.extendedRange[1]=ee[ae].range[0]),ae-=1,ae>=0&&(U.extendedRange[0]=ee[ae].range[1]),U}function z(U,ee,ae){var de=[],ke,Oe,De,Ae;if(!U.range)throw new Error("attachComments needs range information");if(!ae.length){if(ee.length){for(De=0,Oe=ee.length;De<Oe;De+=1)ke=b(ee[De]),ke.extendedRange=[0,U.range[0]],de.push(ke);U.leadingComments=de}return U}for(De=0,Oe=ee.length;De<Oe;De+=1)de.push(se(b(ee[De]),ae));return Ae=0,V(U,{enter:function(Pe){for(var We;Ae<de.length&&(We=de[Ae],!(We.extendedRange[1]>Pe.range[0]));)We.extendedRange[1]===Pe.range[0]?(Pe.leadingComments||(Pe.leadingComments=[]),Pe.leadingComments.push(We),de.splice(Ae,1)):Ae+=1;if(Ae===de.length)return u.Break;if(de[Ae].extendedRange[0]>Pe.range[1])return u.Skip}}),Ae=0,V(U,{leave:function(Pe){for(var We;Ae<de.length&&(We=de[Ae],!(Pe.range[1]<We.extendedRange[0]));)Pe.range[1]===We.extendedRange[0]?(Pe.trailingComments||(Pe.trailingComments=[]),Pe.trailingComments.push(We),de.splice(Ae,1)):Ae+=1;if(Ae===de.length)return u.Break;if(de[Ae].extendedRange[0]>Pe.range[1])return u.Skip}}),U}return a.Syntax=l,a.traverse=V,a.replace=K,a.attachComments=z,a.VisitorKeys=p,a.VisitorOption=u,a.Controller=E,a.cloneEnvironment=function(){return e({})},a})(o)})(estraverse)),estraverse}var utils={},ast={exports:{}},hasRequiredAst;function requireAst(){return hasRequiredAst||(hasRequiredAst=1,(function(){function o(d){if(d==null)return!1;switch(d.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(d){if(d==null)return!1;switch(d.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function a(d){if(d==null)return!1;switch(d.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function l(d){return a(d)||d!=null&&d.type==="FunctionDeclaration"}function u(d){switch(d.type){case"IfStatement":return d.alternate!=null?d.alternate:d.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return d.body}return null}function p(d){var f;if(d.type!=="IfStatement"||d.alternate==null)return!1;f=d.consequent;do{if(f.type==="IfStatement"&&f.alternate==null)return!0;f=u(f)}while(f);return!1}ast.exports={isExpression:o,isStatement:a,isIterationStatement:e,isSourceElement:l,isProblematicIfStatement:p,trailingStatement:u}})()),ast.exports}var code={exports:{}},hasRequiredCode;function requireCode(){return hasRequiredCode||(hasRequiredCode=1,(function(){var o,e,a,l,u,p;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},o={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function d(Z){return 48<=Z&&Z<=57}function f(Z){return 48<=Z&&Z<=57||97<=Z&&Z<=102||65<=Z&&Z<=70}function g(Z){return Z>=48&&Z<=55}a=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function b(Z){return Z===32||Z===9||Z===11||Z===12||Z===160||Z>=5760&&a.indexOf(Z)>=0}function A(Z){return Z===10||Z===13||Z===8232||Z===8233}function S(Z){if(Z<=65535)return String.fromCharCode(Z);var V=String.fromCharCode(Math.floor((Z-65536)/1024)+55296),K=String.fromCharCode((Z-65536)%1024+56320);return V+K}for(l=new Array(128),p=0;p<128;++p)l[p]=p>=97&&p<=122||p>=65&&p<=90||p===36||p===95;for(u=new Array(128),p=0;p<128;++p)u[p]=p>=97&&p<=122||p>=65&&p<=90||p>=48&&p<=57||p===36||p===95;function M(Z){return Z<128?l[Z]:e.NonAsciiIdentifierStart.test(S(Z))}function E(Z){return Z<128?u[Z]:e.NonAsciiIdentifierPart.test(S(Z))}function F(Z){return Z<128?l[Z]:o.NonAsciiIdentifierStart.test(S(Z))}function $(Z){return Z<128?u[Z]:o.NonAsciiIdentifierPart.test(S(Z))}code.exports={isDecimalDigit:d,isHexDigit:f,isOctalDigit:g,isWhiteSpace:b,isLineTerminator:A,isIdentifierStartES5:M,isIdentifierPartES5:E,isIdentifierStartES6:F,isIdentifierPartES6:$}})()),code.exports}var keyword={exports:{}},hasRequiredKeyword;function requireKeyword(){return hasRequiredKeyword||(hasRequiredKeyword=1,(function(){var o=requireCode();function e(M){switch(M){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function a(M,E){return!E&&M==="yield"?!1:l(M,E)}function l(M,E){if(E&&e(M))return!0;switch(M.length){case 2:return M==="if"||M==="in"||M==="do";case 3:return M==="var"||M==="for"||M==="new"||M==="try";case 4:return M==="this"||M==="else"||M==="case"||M==="void"||M==="with"||M==="enum";case 5:return M==="while"||M==="break"||M==="catch"||M==="throw"||M==="const"||M==="yield"||M==="class"||M==="super";case 6:return M==="return"||M==="typeof"||M==="delete"||M==="switch"||M==="export"||M==="import";case 7:return M==="default"||M==="finally"||M==="extends";case 8:return M==="function"||M==="continue"||M==="debugger";case 10:return M==="instanceof";default:return!1}}function u(M,E){return M==="null"||M==="true"||M==="false"||a(M,E)}function p(M,E){return M==="null"||M==="true"||M==="false"||l(M,E)}function d(M){return M==="eval"||M==="arguments"}function f(M){var E,F,$;if(M.length===0||($=M.charCodeAt(0),!o.isIdentifierStartES5($)))return!1;for(E=1,F=M.length;E<F;++E)if($=M.charCodeAt(E),!o.isIdentifierPartES5($))return!1;return!0}function g(M,E){return(M-55296)*1024+(E-56320)+65536}function b(M){var E,F,$,Z,V;if(M.length===0)return!1;for(V=o.isIdentifierStartES6,E=0,F=M.length;E<F;++E){if($=M.charCodeAt(E),55296<=$&&$<=56319){if(++E,E>=F||(Z=M.charCodeAt(E),!(56320<=Z&&Z<=57343)))return!1;$=g($,Z)}if(!V($))return!1;V=o.isIdentifierPartES6}return!0}function A(M,E){return f(M)&&!u(M,E)}function S(M,E){return b(M)&&!p(M,E)}keyword.exports={isKeywordES5:a,isKeywordES6:l,isReservedWordES5:u,isReservedWordES6:p,isRestrictedWord:d,isIdentifierNameES5:f,isIdentifierNameES6:b,isIdentifierES5:A,isIdentifierES6:S}})()),keyword.exports}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(){utils.ast=requireAst(),utils.code=requireCode(),utils.keyword=requireKeyword()})()),utils}var sourceMap={},sourceMapGenerator={},base64Vlq={},base64={},hasRequiredBase64;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64.encode=function(e){if(0<=e&&e<o.length)return o[e];throw new TypeError("Must be between 0 and 63: "+e)},base64.decode=function(e){var a=65,l=90,u=97,p=122,d=48,f=57,g=43,b=47,A=26,S=52;return a<=e&&e<=l?e-a:u<=e&&e<=p?e-u+A:d<=e&&e<=f?e-d+S:e==g?62:e==b?63:-1},base64}var hasRequiredBase64Vlq;function requireBase64Vlq(){if(hasRequiredBase64Vlq)return base64Vlq;hasRequiredBase64Vlq=1;var o=requireBase64(),e=5,a=1<<e,l=a-1,u=a;function p(f){return f<0?(-f<<1)+1:(f<<1)+0}function d(f){var g=(f&1)===1,b=f>>1;return g?-b:b}return base64Vlq.encode=function(g){var b="",A,S=p(g);do A=S&l,S>>>=e,S>0&&(A|=u),b+=o.encode(A);while(S>0);return b},base64Vlq.decode=function(g,b,A){var S=g.length,M=0,E=0,F,$;do{if(b>=S)throw new Error("Expected more digits in base 64 VLQ value.");if($=o.decode(g.charCodeAt(b++)),$===-1)throw new Error("Invalid base64 digit: "+g.charAt(b-1));F=!!($&u),$&=l,M=M+($<<E),E+=e}while(F);A.value=d(M),A.rest=b},base64Vlq}var util={},hasRequiredUtil;function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,(function(o){function e(z,U,ee){if(U in z)return z[U];if(arguments.length===3)return ee;throw new Error('"'+U+'" is a required argument.')}o.getArg=e;var a=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,l=/^data:.+\,.+$/;function u(z){var U=z.match(a);return U?{scheme:U[1],auth:U[2],host:U[3],port:U[4],path:U[5]}:null}o.urlParse=u;function p(z){var U="";return z.scheme&&(U+=z.scheme+":"),U+="//",z.auth&&(U+=z.auth+"@"),z.host&&(U+=z.host),z.port&&(U+=":"+z.port),z.path&&(U+=z.path),U}o.urlGenerate=p;function d(z){var U=z,ee=u(z);if(ee){if(!ee.path)return z;U=ee.path}for(var ae=o.isAbsolute(U),de=U.split(/\/+/),ke,Oe=0,De=de.length-1;De>=0;De--)ke=de[De],ke==="."?de.splice(De,1):ke===".."?Oe++:Oe>0&&(ke===""?(de.splice(De+1,Oe),Oe=0):(de.splice(De,2),Oe--));return U=de.join("/"),U===""&&(U=ae?"/":"."),ee?(ee.path=U,p(ee)):U}o.normalize=d;function f(z,U){z===""&&(z="."),U===""&&(U=".");var ee=u(U),ae=u(z);if(ae&&(z=ae.path||"/"),ee&&!ee.scheme)return ae&&(ee.scheme=ae.scheme),p(ee);if(ee||U.match(l))return U;if(ae&&!ae.host&&!ae.path)return ae.host=U,p(ae);var de=U.charAt(0)==="/"?U:d(z.replace(/\/+$/,"")+"/"+U);return ae?(ae.path=de,p(ae)):de}o.join=f,o.isAbsolute=function(z){return z.charAt(0)==="/"||a.test(z)};function g(z,U){z===""&&(z="."),z=z.replace(/\/$/,"");for(var ee=0;U.indexOf(z+"/")!==0;){var ae=z.lastIndexOf("/");if(ae<0||(z=z.slice(0,ae),z.match(/^([^\/]+:\/)?\/*$/)))return U;++ee}return Array(ee+1).join("../")+U.substr(z.length+1)}o.relative=g;var b=(function(){var z=Object.create(null);return!("__proto__"in z)})();function A(z){return z}function S(z){return E(z)?"$"+z:z}o.toSetString=b?A:S;function M(z){return E(z)?z.slice(1):z}o.fromSetString=b?A:M;function E(z){if(!z)return!1;var U=z.length;if(U<9||z.charCodeAt(U-1)!==95||z.charCodeAt(U-2)!==95||z.charCodeAt(U-3)!==111||z.charCodeAt(U-4)!==116||z.charCodeAt(U-5)!==111||z.charCodeAt(U-6)!==114||z.charCodeAt(U-7)!==112||z.charCodeAt(U-8)!==95||z.charCodeAt(U-9)!==95)return!1;for(var ee=U-10;ee>=0;ee--)if(z.charCodeAt(ee)!==36)return!1;return!0}function F(z,U,ee){var ae=Z(z.source,U.source);return ae!==0||(ae=z.originalLine-U.originalLine,ae!==0)||(ae=z.originalColumn-U.originalColumn,ae!==0||ee)||(ae=z.generatedColumn-U.generatedColumn,ae!==0)||(ae=z.generatedLine-U.generatedLine,ae!==0)?ae:Z(z.name,U.name)}o.compareByOriginalPositions=F;function $(z,U,ee){var ae=z.generatedLine-U.generatedLine;return ae!==0||(ae=z.generatedColumn-U.generatedColumn,ae!==0||ee)||(ae=Z(z.source,U.source),ae!==0)||(ae=z.originalLine-U.originalLine,ae!==0)||(ae=z.originalColumn-U.originalColumn,ae!==0)?ae:Z(z.name,U.name)}o.compareByGeneratedPositionsDeflated=$;function Z(z,U){return z===U?0:z===null?1:U===null?-1:z>U?1:-1}function V(z,U){var ee=z.generatedLine-U.generatedLine;return ee!==0||(ee=z.generatedColumn-U.generatedColumn,ee!==0)||(ee=Z(z.source,U.source),ee!==0)||(ee=z.originalLine-U.originalLine,ee!==0)||(ee=z.originalColumn-U.originalColumn,ee!==0)?ee:Z(z.name,U.name)}o.compareByGeneratedPositionsInflated=V;function K(z){return JSON.parse(z.replace(/^\)]}'[^\n]*\n/,""))}o.parseSourceMapInput=K;function se(z,U,ee){if(U=U||"",z&&(z[z.length-1]!=="/"&&U[0]!=="/"&&(z+="/"),U=z+U),ee){var ae=u(ee);if(!ae)throw new Error("sourceMapURL could not be parsed");if(ae.path){var de=ae.path.lastIndexOf("/");de>=0&&(ae.path=ae.path.substring(0,de+1))}U=f(p(ae),U)}return d(U)}o.computeSourceURL=se})(util)),util}var arraySet={},hasRequiredArraySet;function requireArraySet(){if(hasRequiredArraySet)return arraySet;hasRequiredArraySet=1;var o=requireUtil(),e=Object.prototype.hasOwnProperty,a=typeof Map<"u";function l(){this._array=[],this._set=a?new Map:Object.create(null)}return l.fromArray=function(p,d){for(var f=new l,g=0,b=p.length;g<b;g++)f.add(p[g],d);return f},l.prototype.size=function(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length},l.prototype.add=function(p,d){var f=a?p:o.toSetString(p),g=a?this.has(p):e.call(this._set,f),b=this._array.length;(!g||d)&&this._array.push(p),g||(a?this._set.set(p,b):this._set[f]=b)},l.prototype.has=function(p){if(a)return this._set.has(p);var d=o.toSetString(p);return e.call(this._set,d)},l.prototype.indexOf=function(p){if(a){var d=this._set.get(p);if(d>=0)return d}else{var f=o.toSetString(p);if(e.call(this._set,f))return this._set[f]}throw new Error('"'+p+'" is not in the set.')},l.prototype.at=function(p){if(p>=0&&p<this._array.length)return this._array[p];throw new Error("No element indexed by "+p)},l.prototype.toArray=function(){return this._array.slice()},arraySet.ArraySet=l,arraySet}var mappingList={},hasRequiredMappingList;function requireMappingList(){if(hasRequiredMappingList)return mappingList;hasRequiredMappingList=1;var o=requireUtil();function e(l,u){var p=l.generatedLine,d=u.generatedLine,f=l.generatedColumn,g=u.generatedColumn;return d>p||d==p&&g>=f||o.compareByGeneratedPositionsInflated(l,u)<=0}function a(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return a.prototype.unsortedForEach=function(u,p){this._array.forEach(u,p)},a.prototype.add=function(u){e(this._last,u)?(this._last=u,this._array.push(u)):(this._sorted=!1,this._array.push(u))},a.prototype.toArray=function(){return this._sorted||(this._array.sort(o.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},mappingList.MappingList=a,mappingList}var hasRequiredSourceMapGenerator;function requireSourceMapGenerator(){if(hasRequiredSourceMapGenerator)return sourceMapGenerator;hasRequiredSourceMapGenerator=1;var o=requireBase64Vlq(),e=requireUtil(),a=requireArraySet().ArraySet,l=requireMappingList().MappingList;function u(p){p||(p={}),this._file=e.getArg(p,"file",null),this._sourceRoot=e.getArg(p,"sourceRoot",null),this._skipValidation=e.getArg(p,"skipValidation",!1),this._sources=new a,this._names=new a,this._mappings=new l,this._sourcesContents=null}return u.prototype._version=3,u.fromSourceMap=function(d){var f=d.sourceRoot,g=new u({file:d.file,sourceRoot:f});return d.eachMapping(function(b){var A={generated:{line:b.generatedLine,column:b.generatedColumn}};b.source!=null&&(A.source=b.source,f!=null&&(A.source=e.relative(f,A.source)),A.original={line:b.originalLine,column:b.originalColumn},b.name!=null&&(A.name=b.name)),g.addMapping(A)}),d.sources.forEach(function(b){var A=b;f!==null&&(A=e.relative(f,b)),g._sources.has(A)||g._sources.add(A);var S=d.sourceContentFor(b);S!=null&&g.setSourceContent(b,S)}),g},u.prototype.addMapping=function(d){var f=e.getArg(d,"generated"),g=e.getArg(d,"original",null),b=e.getArg(d,"source",null),A=e.getArg(d,"name",null);this._skipValidation||this._validateMapping(f,g,b,A),b!=null&&(b=String(b),this._sources.has(b)||this._sources.add(b)),A!=null&&(A=String(A),this._names.has(A)||this._names.add(A)),this._mappings.add({generatedLine:f.line,generatedColumn:f.column,originalLine:g!=null&&g.line,originalColumn:g!=null&&g.column,source:b,name:A})},u.prototype.setSourceContent=function(d,f){var g=d;this._sourceRoot!=null&&(g=e.relative(this._sourceRoot,g)),f!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(g)]=f):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(g)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},u.prototype.applySourceMap=function(d,f,g){var b=f;if(f==null){if(d.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);b=d.file}var A=this._sourceRoot;A!=null&&(b=e.relative(A,b));var S=new a,M=new a;this._mappings.unsortedForEach(function(E){if(E.source===b&&E.originalLine!=null){var F=d.originalPositionFor({line:E.originalLine,column:E.originalColumn});F.source!=null&&(E.source=F.source,g!=null&&(E.source=e.join(g,E.source)),A!=null&&(E.source=e.relative(A,E.source)),E.originalLine=F.line,E.originalColumn=F.column,F.name!=null&&(E.name=F.name))}var $=E.source;$!=null&&!S.has($)&&S.add($);var Z=E.name;Z!=null&&!M.has(Z)&&M.add(Z)},this),this._sources=S,this._names=M,d.sources.forEach(function(E){var F=d.sourceContentFor(E);F!=null&&(g!=null&&(E=e.join(g,E)),A!=null&&(E=e.relative(A,E)),this.setSourceContent(E,F))},this)},u.prototype._validateMapping=function(d,f,g,b){if(f&&typeof f.line!="number"&&typeof f.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(d&&"line"in d&&"column"in d&&d.line>0&&d.column>=0&&!f&&!g&&!b)){if(d&&"line"in d&&"column"in d&&f&&"line"in f&&"column"in f&&d.line>0&&d.column>=0&&f.line>0&&f.column>=0&&g)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:d,source:g,original:f,name:b}))}},u.prototype._serializeMappings=function(){for(var d=0,f=1,g=0,b=0,A=0,S=0,M="",E,F,$,Z,V=this._mappings.toArray(),K=0,se=V.length;K<se;K++){if(F=V[K],E="",F.generatedLine!==f)for(d=0;F.generatedLine!==f;)E+=";",f++;else if(K>0){if(!e.compareByGeneratedPositionsInflated(F,V[K-1]))continue;E+=","}E+=o.encode(F.generatedColumn-d),d=F.generatedColumn,F.source!=null&&(Z=this._sources.indexOf(F.source),E+=o.encode(Z-S),S=Z,E+=o.encode(F.originalLine-1-b),b=F.originalLine-1,E+=o.encode(F.originalColumn-g),g=F.originalColumn,F.name!=null&&($=this._names.indexOf(F.name),E+=o.encode($-A),A=$)),M+=E}return M},u.prototype._generateSourcesContent=function(d,f){return d.map(function(g){if(!this._sourcesContents)return null;f!=null&&(g=e.relative(f,g));var b=e.toSetString(g);return Object.prototype.hasOwnProperty.call(this._sourcesContents,b)?this._sourcesContents[b]:null},this)},u.prototype.toJSON=function(){var d={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(d.file=this._file),this._sourceRoot!=null&&(d.sourceRoot=this._sourceRoot),this._sourcesContents&&(d.sourcesContent=this._generateSourcesContent(d.sources,d.sourceRoot)),d},u.prototype.toString=function(){return JSON.stringify(this.toJSON())},sourceMapGenerator.SourceMapGenerator=u,sourceMapGenerator}var sourceMapConsumer={},binarySearch={},hasRequiredBinarySearch;function requireBinarySearch(){return hasRequiredBinarySearch||(hasRequiredBinarySearch=1,(function(o){o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2;function e(a,l,u,p,d,f){var g=Math.floor((l-a)/2)+a,b=d(u,p[g],!0);return b===0?g:b>0?l-g>1?e(g,l,u,p,d,f):f==o.LEAST_UPPER_BOUND?l<p.length?l:-1:g:g-a>1?e(a,g,u,p,d,f):f==o.LEAST_UPPER_BOUND?g:a<0?-1:a}o.search=function(l,u,p,d){if(u.length===0)return-1;var f=e(-1,u.length,l,u,p,d||o.GREATEST_LOWER_BOUND);if(f<0)return-1;for(;f-1>=0&&p(u[f],u[f-1],!0)===0;)--f;return f}})(binarySearch)),binarySearch}var quickSort={},hasRequiredQuickSort;function requireQuickSort(){if(hasRequiredQuickSort)return quickSort;hasRequiredQuickSort=1;function o(l,u,p){var d=l[u];l[u]=l[p],l[p]=d}function e(l,u){return Math.round(l+Math.random()*(u-l))}function a(l,u,p,d){if(p<d){var f=e(p,d),g=p-1;o(l,f,d);for(var b=l[d],A=p;A<d;A++)u(l[A],b)<=0&&(g+=1,o(l,g,A));o(l,g+1,A);var S=g+1;a(l,u,p,S-1),a(l,u,S+1,d)}}return quickSort.quickSort=function(l,u){a(l,u,0,l.length-1)},quickSort}var hasRequiredSourceMapConsumer;function requireSourceMapConsumer(){if(hasRequiredSourceMapConsumer)return sourceMapConsumer;hasRequiredSourceMapConsumer=1;var o=requireUtil(),e=requireBinarySearch(),a=requireArraySet().ArraySet,l=requireBase64Vlq(),u=requireQuickSort().quickSort;function p(b,A){var S=b;return typeof b=="string"&&(S=o.parseSourceMapInput(b)),S.sections!=null?new g(S,A):new d(S,A)}p.fromSourceMap=function(b,A){return d.fromSourceMap(b,A)},p.prototype._version=3,p.prototype.__generatedMappings=null,Object.defineProperty(p.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),p.prototype.__originalMappings=null,Object.defineProperty(p.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),p.prototype._charIsMappingSeparator=function(A,S){var M=A.charAt(S);return M===";"||M===","},p.prototype._parseMappings=function(A,S){throw new Error("Subclasses must implement _parseMappings")},p.GENERATED_ORDER=1,p.ORIGINAL_ORDER=2,p.GREATEST_LOWER_BOUND=1,p.LEAST_UPPER_BOUND=2,p.prototype.eachMapping=function(A,S,M){var E=S||null,F=M||p.GENERATED_ORDER,$;switch(F){case p.GENERATED_ORDER:$=this._generatedMappings;break;case p.ORIGINAL_ORDER:$=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var Z=this.sourceRoot;$.map(function(V){var K=V.source===null?null:this._sources.at(V.source);return K=o.computeSourceURL(Z,K,this._sourceMapURL),{source:K,generatedLine:V.generatedLine,generatedColumn:V.generatedColumn,originalLine:V.originalLine,originalColumn:V.originalColumn,name:V.name===null?null:this._names.at(V.name)}},this).forEach(A,E)},p.prototype.allGeneratedPositionsFor=function(A){var S=o.getArg(A,"line"),M={source:o.getArg(A,"source"),originalLine:S,originalColumn:o.getArg(A,"column",0)};if(M.source=this._findSourceIndex(M.source),M.source<0)return[];var E=[],F=this._findMapping(M,this._originalMappings,"originalLine","originalColumn",o.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(F>=0){var $=this._originalMappings[F];if(A.column===void 0)for(var Z=$.originalLine;$&&$.originalLine===Z;)E.push({line:o.getArg($,"generatedLine",null),column:o.getArg($,"generatedColumn",null),lastColumn:o.getArg($,"lastGeneratedColumn",null)}),$=this._originalMappings[++F];else for(var V=$.originalColumn;$&&$.originalLine===S&&$.originalColumn==V;)E.push({line:o.getArg($,"generatedLine",null),column:o.getArg($,"generatedColumn",null),lastColumn:o.getArg($,"lastGeneratedColumn",null)}),$=this._originalMappings[++F]}return E},sourceMapConsumer.SourceMapConsumer=p;function d(b,A){var S=b;typeof b=="string"&&(S=o.parseSourceMapInput(b));var M=o.getArg(S,"version"),E=o.getArg(S,"sources"),F=o.getArg(S,"names",[]),$=o.getArg(S,"sourceRoot",null),Z=o.getArg(S,"sourcesContent",null),V=o.getArg(S,"mappings"),K=o.getArg(S,"file",null);if(M!=this._version)throw new Error("Unsupported version: "+M);$&&($=o.normalize($)),E=E.map(String).map(o.normalize).map(function(se){return $&&o.isAbsolute($)&&o.isAbsolute(se)?o.relative($,se):se}),this._names=a.fromArray(F.map(String),!0),this._sources=a.fromArray(E,!0),this._absoluteSources=this._sources.toArray().map(function(se){return o.computeSourceURL($,se,A)}),this.sourceRoot=$,this.sourcesContent=Z,this._mappings=V,this._sourceMapURL=A,this.file=K}d.prototype=Object.create(p.prototype),d.prototype.consumer=p,d.prototype._findSourceIndex=function(b){var A=b;if(this.sourceRoot!=null&&(A=o.relative(this.sourceRoot,A)),this._sources.has(A))return this._sources.indexOf(A);var S;for(S=0;S<this._absoluteSources.length;++S)if(this._absoluteSources[S]==b)return S;return-1},d.fromSourceMap=function(A,S){var M=Object.create(d.prototype),E=M._names=a.fromArray(A._names.toArray(),!0),F=M._sources=a.fromArray(A._sources.toArray(),!0);M.sourceRoot=A._sourceRoot,M.sourcesContent=A._generateSourcesContent(M._sources.toArray(),M.sourceRoot),M.file=A._file,M._sourceMapURL=S,M._absoluteSources=M._sources.toArray().map(function(ee){return o.computeSourceURL(M.sourceRoot,ee,S)});for(var $=A._mappings.toArray().slice(),Z=M.__generatedMappings=[],V=M.__originalMappings=[],K=0,se=$.length;K<se;K++){var z=$[K],U=new f;U.generatedLine=z.generatedLine,U.generatedColumn=z.generatedColumn,z.source&&(U.source=F.indexOf(z.source),U.originalLine=z.originalLine,U.originalColumn=z.originalColumn,z.name&&(U.name=E.indexOf(z.name)),V.push(U)),Z.push(U)}return u(M.__originalMappings,o.compareByOriginalPositions),M},d.prototype._version=3,Object.defineProperty(d.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function f(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}d.prototype._parseMappings=function(A,S){for(var M=1,E=0,F=0,$=0,Z=0,V=0,K=A.length,se=0,z={},U={},ee=[],ae=[],de,ke,Oe,De,Ae;se<K;)if(A.charAt(se)===";")M++,se++,E=0;else if(A.charAt(se)===",")se++;else{for(de=new f,de.generatedLine=M,De=se;De<K&&!this._charIsMappingSeparator(A,De);De++);if(ke=A.slice(se,De),Oe=z[ke],Oe)se+=ke.length;else{for(Oe=[];se<De;)l.decode(A,se,U),Ae=U.value,se=U.rest,Oe.push(Ae);if(Oe.length===2)throw new Error("Found a source, but no line and column");if(Oe.length===3)throw new Error("Found a source and line, but no column");z[ke]=Oe}de.generatedColumn=E+Oe[0],E=de.generatedColumn,Oe.length>1&&(de.source=Z+Oe[1],Z+=Oe[1],de.originalLine=F+Oe[2],F=de.originalLine,de.originalLine+=1,de.originalColumn=$+Oe[3],$=de.originalColumn,Oe.length>4&&(de.name=V+Oe[4],V+=Oe[4])),ae.push(de),typeof de.originalLine=="number"&&ee.push(de)}u(ae,o.compareByGeneratedPositionsDeflated),this.__generatedMappings=ae,u(ee,o.compareByOriginalPositions),this.__originalMappings=ee},d.prototype._findMapping=function(A,S,M,E,F,$){if(A[M]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+A[M]);if(A[E]<0)throw new TypeError("Column must be greater than or equal to 0, got "+A[E]);return e.search(A,S,F,$)},d.prototype.computeColumnSpans=function(){for(var A=0;A<this._generatedMappings.length;++A){var S=this._generatedMappings[A];if(A+1<this._generatedMappings.length){var M=this._generatedMappings[A+1];if(S.generatedLine===M.generatedLine){S.lastGeneratedColumn=M.generatedColumn-1;continue}}S.lastGeneratedColumn=1/0}},d.prototype.originalPositionFor=function(A){var S={generatedLine:o.getArg(A,"line"),generatedColumn:o.getArg(A,"column")},M=this._findMapping(S,this._generatedMappings,"generatedLine","generatedColumn",o.compareByGeneratedPositionsDeflated,o.getArg(A,"bias",p.GREATEST_LOWER_BOUND));if(M>=0){var E=this._generatedMappings[M];if(E.generatedLine===S.generatedLine){var F=o.getArg(E,"source",null);F!==null&&(F=this._sources.at(F),F=o.computeSourceURL(this.sourceRoot,F,this._sourceMapURL));var $=o.getArg(E,"name",null);return $!==null&&($=this._names.at($)),{source:F,line:o.getArg(E,"originalLine",null),column:o.getArg(E,"originalColumn",null),name:$}}}return{source:null,line:null,column:null,name:null}},d.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(A){return A==null}):!1},d.prototype.sourceContentFor=function(A,S){if(!this.sourcesContent)return null;var M=this._findSourceIndex(A);if(M>=0)return this.sourcesContent[M];var E=A;this.sourceRoot!=null&&(E=o.relative(this.sourceRoot,E));var F;if(this.sourceRoot!=null&&(F=o.urlParse(this.sourceRoot))){var $=E.replace(/^file:\/\//,"");if(F.scheme=="file"&&this._sources.has($))return this.sourcesContent[this._sources.indexOf($)];if((!F.path||F.path=="/")&&this._sources.has("/"+E))return this.sourcesContent[this._sources.indexOf("/"+E)]}if(S)return null;throw new Error('"'+E+'" is not in the SourceMap.')},d.prototype.generatedPositionFor=function(A){var S=o.getArg(A,"source");if(S=this._findSourceIndex(S),S<0)return{line:null,column:null,lastColumn:null};var M={source:S,originalLine:o.getArg(A,"line"),originalColumn:o.getArg(A,"column")},E=this._findMapping(M,this._originalMappings,"originalLine","originalColumn",o.compareByOriginalPositions,o.getArg(A,"bias",p.GREATEST_LOWER_BOUND));if(E>=0){var F=this._originalMappings[E];if(F.source===M.source)return{line:o.getArg(F,"generatedLine",null),column:o.getArg(F,"generatedColumn",null),lastColumn:o.getArg(F,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},sourceMapConsumer.BasicSourceMapConsumer=d;function g(b,A){var S=b;typeof b=="string"&&(S=o.parseSourceMapInput(b));var M=o.getArg(S,"version"),E=o.getArg(S,"sections");if(M!=this._version)throw new Error("Unsupported version: "+M);this._sources=new a,this._names=new a;var F={line:-1,column:0};this._sections=E.map(function($){if($.url)throw new Error("Support for url field in sections not implemented.");var Z=o.getArg($,"offset"),V=o.getArg(Z,"line"),K=o.getArg(Z,"column");if(V<F.line||V===F.line&&K<F.column)throw new Error("Section offsets must be ordered and non-overlapping.");return F=Z,{generatedOffset:{generatedLine:V+1,generatedColumn:K+1},consumer:new p(o.getArg($,"map"),A)}})}return g.prototype=Object.create(p.prototype),g.prototype.constructor=p,g.prototype._version=3,Object.defineProperty(g.prototype,"sources",{get:function(){for(var b=[],A=0;A<this._sections.length;A++)for(var S=0;S<this._sections[A].consumer.sources.length;S++)b.push(this._sections[A].consumer.sources[S]);return b}}),g.prototype.originalPositionFor=function(A){var S={generatedLine:o.getArg(A,"line"),generatedColumn:o.getArg(A,"column")},M=e.search(S,this._sections,function(F,$){var Z=F.generatedLine-$.generatedOffset.generatedLine;return Z||F.generatedColumn-$.generatedOffset.generatedColumn}),E=this._sections[M];return E?E.consumer.originalPositionFor({line:S.generatedLine-(E.generatedOffset.generatedLine-1),column:S.generatedColumn-(E.generatedOffset.generatedLine===S.generatedLine?E.generatedOffset.generatedColumn-1:0),bias:A.bias}):{source:null,line:null,column:null,name:null}},g.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(A){return A.consumer.hasContentsOfAllSources()})},g.prototype.sourceContentFor=function(A,S){for(var M=0;M<this._sections.length;M++){var E=this._sections[M],F=E.consumer.sourceContentFor(A,!0);if(F)return F}if(S)return null;throw new Error('"'+A+'" is not in the SourceMap.')},g.prototype.generatedPositionFor=function(A){for(var S=0;S<this._sections.length;S++){var M=this._sections[S];if(M.consumer._findSourceIndex(o.getArg(A,"source"))!==-1){var E=M.consumer.generatedPositionFor(A);if(E){var F={line:E.line+(M.generatedOffset.generatedLine-1),column:E.column+(M.generatedOffset.generatedLine===E.line?M.generatedOffset.generatedColumn-1:0)};return F}}}return{line:null,column:null}},g.prototype._parseMappings=function(A,S){this.__generatedMappings=[],this.__originalMappings=[];for(var M=0;M<this._sections.length;M++)for(var E=this._sections[M],F=E.consumer._generatedMappings,$=0;$<F.length;$++){var Z=F[$],V=E.consumer._sources.at(Z.source);V=o.computeSourceURL(E.consumer.sourceRoot,V,this._sourceMapURL),this._sources.add(V),V=this._sources.indexOf(V);var K=null;Z.name&&(K=E.consumer._names.at(Z.name),this._names.add(K),K=this._names.indexOf(K));var se={source:V,generatedLine:Z.generatedLine+(E.generatedOffset.generatedLine-1),generatedColumn:Z.generatedColumn+(E.generatedOffset.generatedLine===Z.generatedLine?E.generatedOffset.generatedColumn-1:0),originalLine:Z.originalLine,originalColumn:Z.originalColumn,name:K};this.__generatedMappings.push(se),typeof se.originalLine=="number"&&this.__originalMappings.push(se)}u(this.__generatedMappings,o.compareByGeneratedPositionsDeflated),u(this.__originalMappings,o.compareByOriginalPositions)},sourceMapConsumer.IndexedSourceMapConsumer=g,sourceMapConsumer}var sourceNode={},hasRequiredSourceNode;function requireSourceNode(){if(hasRequiredSourceNode)return sourceNode;hasRequiredSourceNode=1;var o=requireSourceMapGenerator().SourceMapGenerator,e=requireUtil(),a=/(\r?\n)/,l=10,u="$$$isSourceNode$$$";function p(d,f,g,b,A){this.children=[],this.sourceContents={},this.line=d??null,this.column=f??null,this.source=g??null,this.name=A??null,this[u]=!0,b!=null&&this.add(b)}return p.fromStringWithSourceMap=function(f,g,b){var A=new p,S=f.split(a),M=0,E=function(){var K=z(),se=z()||"";return K+se;function z(){return M<S.length?S[M++]:void 0}},F=1,$=0,Z=null;return g.eachMapping(function(K){if(Z!==null)if(F<K.generatedLine)V(Z,E()),F++,$=0;else{var se=S[M]||"",z=se.substr(0,K.generatedColumn-$);S[M]=se.substr(K.generatedColumn-$),$=K.generatedColumn,V(Z,z),Z=K;return}for(;F<K.generatedLine;)A.add(E()),F++;if($<K.generatedColumn){var se=S[M]||"";A.add(se.substr(0,K.generatedColumn)),S[M]=se.substr(K.generatedColumn),$=K.generatedColumn}Z=K},this),M<S.length&&(Z&&V(Z,E()),A.add(S.splice(M).join(""))),g.sources.forEach(function(K){var se=g.sourceContentFor(K);se!=null&&(b!=null&&(K=e.join(b,K)),A.setSourceContent(K,se))}),A;function V(K,se){if(K===null||K.source===void 0)A.add(se);else{var z=b?e.join(b,K.source):K.source;A.add(new p(K.originalLine,K.originalColumn,z,se,K.name))}}},p.prototype.add=function(f){if(Array.isArray(f))f.forEach(function(g){this.add(g)},this);else if(f[u]||typeof f=="string")f&&this.children.push(f);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+f);return this},p.prototype.prepend=function(f){if(Array.isArray(f))for(var g=f.length-1;g>=0;g--)this.prepend(f[g]);else if(f[u]||typeof f=="string")this.children.unshift(f);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+f);return this},p.prototype.walk=function(f){for(var g,b=0,A=this.children.length;b<A;b++)g=this.children[b],g[u]?g.walk(f):g!==""&&f(g,{source:this.source,line:this.line,column:this.column,name:this.name})},p.prototype.join=function(f){var g,b,A=this.children.length;if(A>0){for(g=[],b=0;b<A-1;b++)g.push(this.children[b]),g.push(f);g.push(this.children[b]),this.children=g}return this},p.prototype.replaceRight=function(f,g){var b=this.children[this.children.length-1];return b[u]?b.replaceRight(f,g):typeof b=="string"?this.children[this.children.length-1]=b.replace(f,g):this.children.push("".replace(f,g)),this},p.prototype.setSourceContent=function(f,g){this.sourceContents[e.toSetString(f)]=g},p.prototype.walkSourceContents=function(f){for(var g=0,b=this.children.length;g<b;g++)this.children[g][u]&&this.children[g].walkSourceContents(f);for(var A=Object.keys(this.sourceContents),g=0,b=A.length;g<b;g++)f(e.fromSetString(A[g]),this.sourceContents[A[g]])},p.prototype.toString=function(){var f="";return this.walk(function(g){f+=g}),f},p.prototype.toStringWithSourceMap=function(f){var g={code:"",line:1,column:0},b=new o(f),A=!1,S=null,M=null,E=null,F=null;return this.walk(function($,Z){g.code+=$,Z.source!==null&&Z.line!==null&&Z.column!==null?((S!==Z.source||M!==Z.line||E!==Z.column||F!==Z.name)&&b.addMapping({source:Z.source,original:{line:Z.line,column:Z.column},generated:{line:g.line,column:g.column},name:Z.name}),S=Z.source,M=Z.line,E=Z.column,F=Z.name,A=!0):A&&(b.addMapping({generated:{line:g.line,column:g.column}}),S=null,A=!1);for(var V=0,K=$.length;V<K;V++)$.charCodeAt(V)===l?(g.line++,g.column=0,V+1===K?(S=null,A=!1):A&&b.addMapping({source:Z.source,original:{line:Z.line,column:Z.column},generated:{line:g.line,column:g.column},name:Z.name})):g.column++}),this.walkSourceContents(function($,Z){b.setSourceContent($,Z)}),{code:g.code,map:b}},sourceNode.SourceNode=p,sourceNode}var hasRequiredSourceMap;function requireSourceMap(){return hasRequiredSourceMap||(hasRequiredSourceMap=1,sourceMap.SourceMapGenerator=requireSourceMapGenerator().SourceMapGenerator,sourceMap.SourceMapConsumer=requireSourceMapConsumer().SourceMapConsumer,sourceMap.SourceNode=requireSourceNode().SourceNode),sourceMap}const version="2.1.0",require$$3={version};var hasRequiredEscodegen;function requireEscodegen(){return hasRequiredEscodegen||(hasRequiredEscodegen=1,(function(o){(function(){var e,a,l,u,p,d,f,g,b,A,S,M,E,F,$,Z,V,K,se,z,U,ee,ae,de,ke,Oe;p=requireEstraverse(),d=requireUtils(),e=p.Syntax;function De(R){return xt.Expression.hasOwnProperty(R.type)}function Ae(R){return xt.Statement.hasOwnProperty(R.type)}a={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},l={"??":a.Coalesce,"||":a.LogicalOR,"&&":a.LogicalAND,"|":a.BitwiseOR,"^":a.BitwiseXOR,"&":a.BitwiseAND,"==":a.Equality,"!=":a.Equality,"===":a.Equality,"!==":a.Equality,is:a.Equality,isnt:a.Equality,"<":a.Relational,">":a.Relational,"<=":a.Relational,">=":a.Relational,in:a.Relational,instanceof:a.Relational,"<<":a.BitwiseSHIFT,">>":a.BitwiseSHIFT,">>>":a.BitwiseSHIFT,"+":a.Additive,"-":a.Additive,"*":a.Multiplicative,"%":a.Multiplicative,"/":a.Multiplicative,"**":a.Exponentiation};var Pe=1,We=2,qe=4,at=8,yt=16,ut=32,Dt=64,$t=We|qe,Bt=Pe|We,$e=Pe|We|qe,bt=Pe,nn=qe,Zt=Pe|qe,Rt=Pe,qt=Pe|ut,Wt=0,tn=Pe|yt,wn=Pe|at;function dn(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function rn(R,te){var q="";for(te|=0;te>0;te>>>=1,R+=R)te&1&&(q+=R);return q}function Zn(R){return/[\r\n]/g.test(R)}function ln(R){var te=R.length;return te&&d.code.isLineTerminator(R.charCodeAt(te-1))}function zn(R,te){var q;for(q in te)te.hasOwnProperty(q)&&(R[q]=te[q]);return R}function cn(R,te){var q,re;function le(Ee){return typeof Ee=="object"&&Ee instanceof Object&&!(Ee instanceof RegExp)}for(q in te)te.hasOwnProperty(q)&&(re=te[q],le(re)?le(R[q])?cn(R[q],re):R[q]=cn({},re):R[q]=re);return R}function Bn(R){var te,q,re,le,Ee;if(R!==R)throw new Error("Numeric literal whose value is NaN");if(R<0||R===0&&1/R<0)throw new Error("Numeric literal whose value is negative");if(R===1/0)return b?"null":A?"1e400":"1e+400";if(te=""+R,!A||te.length<3)return te;for(q=te.indexOf("."),!b&&te.charCodeAt(0)===48&&q===1&&(q=0,te=te.slice(1)),re=te,te=te.replace("e+","e"),le=0,(Ee=re.indexOf("e"))>0&&(le=+re.slice(Ee+1),re=re.slice(0,Ee)),q>=0&&(le-=re.length-q-1,re=+(re.slice(0,q)+re.slice(q+1))+""),Ee=0;re.charCodeAt(re.length+Ee-1)===48;)--Ee;return Ee!==0&&(le-=Ee,re=re.slice(0,Ee)),le!==0&&(re+="e"+le),(re.length<te.length||S&&R>1e12&&Math.floor(R)===R&&(re="0x"+R.toString(16)).length<te.length)&&+re===R&&(te=re),te}function ei(R,te){return(R&-2)===8232?(te?"u":"\\u")+(R===8232?"2028":"2029"):R===10||R===13?(te?"":"\\")+(R===10?"n":"r"):String.fromCharCode(R)}function ve(R){var te,q,re,le,Ee,He,Je,_t;if(q=R.toString(),R.source){if(te=q.match(/\/([^/]*)$/),!te)return q;for(re=te[1],q="",Je=!1,_t=!1,le=0,Ee=R.source.length;le<Ee;++le)He=R.source.charCodeAt(le),_t?(q+=ei(He,_t),_t=!1):(Je?He===93&&(Je=!1):He===47?q+="\\":He===91&&(Je=!0),q+=ei(He,_t),_t=He===92);return"/"+q+"/"+re}return q}function Ce(R,te){var q;return R===8?"\\b":R===12?"\\f":R===9?"\\t":(q=R.toString(16).toUpperCase(),b||R>255?"\\u"+"0000".slice(q.length)+q:R===0&&!d.code.isDecimalDigit(te)?"\\0":R===11?"\\x0B":"\\x"+"00".slice(q.length)+q)}function _e(R){if(R===92)return"\\\\";if(R===10)return"\\n";if(R===13)return"\\r";if(R===8232)return"\\u2028";if(R===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Ie(R){var te,q,re,le;for(le=M==="double"?'"':"'",te=0,q=R.length;te<q;++te)if(re=R.charCodeAt(te),re===39){le='"';break}else if(re===34){le="'";break}else re===92&&++te;return le+R+le}function ot(R){var te="",q,re,le,Ee=0,He=0,Je,_t;for(q=0,re=R.length;q<re;++q){if(le=R.charCodeAt(q),le===39)++Ee;else if(le===34)++He;else if(le===47&&b)te+="\\";else if(d.code.isLineTerminator(le)||le===92){te+=_e(le);continue}else if(!d.code.isIdentifierPartES5(le)&&(b&&le<32||!b&&!E&&(le<32||le>126))){te+=Ce(le,R.charCodeAt(q+1));continue}te+=String.fromCharCode(le)}if(Je=!(M==="double"||M==="auto"&&He<Ee),_t=Je?"'":'"',!(Je?Ee:He))return _t+te+_t;for(R=te,te=_t,q=0,re=R.length;q<re;++q)le=R.charCodeAt(q),(le===39&&Je||le===34&&!Je)&&(te+="\\"),te+=String.fromCharCode(le);return te+_t}function ft(R){var te,q,re,le="";for(te=0,q=R.length;te<q;++te)re=R[te],le+=Array.isArray(re)?ft(re):re;return le}function tt(R,te){if(!ee)return Array.isArray(R)?ft(R):R;if(te==null){if(R instanceof u)return R;te={}}return te.loc==null?new u(null,null,ee,R,te.name||null):new u(te.loc.start.line,te.loc.start.column,ee===!0?te.loc.source||null:ee,R,te.name||null)}function Mt(){return $||" "}function st(R,te){var q,re,le,Ee;return q=tt(R).toString(),q.length===0?[te]:(re=tt(te).toString(),re.length===0?[R]:(le=q.charCodeAt(q.length-1),Ee=re.charCodeAt(0),(le===43||le===45)&&le===Ee||d.code.isIdentifierPartES5(le)&&d.code.isIdentifierPartES5(Ee)||le===47&&Ee===105?[R,Mt(),te]:d.code.isWhiteSpace(le)||d.code.isLineTerminator(le)||d.code.isWhiteSpace(Ee)||d.code.isLineTerminator(Ee)?[R,te]:[R,$,te]))}function Ot(R){return[f,R]}function kt(R){var te;te=f,f+=g,R(f),f=te}function on(R){var te;for(te=R.length-1;te>=0&&!d.code.isLineTerminator(R.charCodeAt(te));--te);return R.length-1-te}function an(R,te){var q,re,le,Ee,He,Je,_t,Yt;for(q=R.split(/\r\n|[\r\n]/),Je=Number.MAX_VALUE,re=1,le=q.length;re<le;++re){for(Ee=q[re],He=0;He<Ee.length&&d.code.isWhiteSpace(Ee.charCodeAt(He));)++He;Je>He&&(Je=He)}for(typeof te<"u"?(_t=f,q[1][Je]==="*"&&(te+=" "),f=te):(Je&1&&--Je,_t=f),re=1,le=q.length;re<le;++re)Yt=tt(Ot(q[re].slice(Je))),q[re]=ee?Yt.join(""):Yt;return f=_t,q.join(`
`)}function Ut(R,te){if(R.type==="Line"){if(ln(R.value))return"//"+R.value;var q="//"+R.value;return de||(q+=`
`),q}return z.format.indent.adjustMultilineComment&&/[\n\r]/.test(R.value)?an("/*"+R.value+"*/",te):"/*"+R.value+"*/"}function Nt(R,te){var q,re,le,Ee,He,Je,_t,Yt,pn,si,li,bi,Oi,ni;if(R.leadingComments&&R.leadingComments.length>0){if(Ee=te,de){for(le=R.leadingComments[0],te=[],Yt=le.extendedRange,pn=le.range,li=ae.substring(Yt[0],pn[0]),ni=(li.match(/\n/g)||[]).length,ni>0?(te.push(rn(`
`,ni)),te.push(Ot(Ut(le)))):(te.push(li),te.push(Ut(le))),si=pn,q=1,re=R.leadingComments.length;q<re;q++)le=R.leadingComments[q],pn=le.range,bi=ae.substring(si[1],pn[0]),ni=(bi.match(/\n/g)||[]).length,te.push(rn(`
`,ni)),te.push(Ot(Ut(le))),si=pn;Oi=ae.substring(pn[1],Yt[1]),ni=(Oi.match(/\n/g)||[]).length,te.push(rn(`
`,ni))}else for(le=R.leadingComments[0],te=[],K&&R.type===e.Program&&R.body.length===0&&te.push(`
`),te.push(Ut(le)),ln(tt(te).toString())||te.push(`
`),q=1,re=R.leadingComments.length;q<re;++q)le=R.leadingComments[q],_t=[Ut(le)],ln(tt(_t).toString())||_t.push(`
`),te.push(Ot(_t));te.push(Ot(Ee))}if(R.trailingComments)if(de)le=R.trailingComments[0],Yt=le.extendedRange,pn=le.range,li=ae.substring(Yt[0],pn[0]),ni=(li.match(/\n/g)||[]).length,ni>0?(te.push(rn(`
`,ni)),te.push(Ot(Ut(le)))):(te.push(li),te.push(Ut(le)));else for(He=!ln(tt(te).toString()),Je=rn(" ",on(tt([f,te,g]).toString())),q=0,re=R.trailingComments.length;q<re;++q)le=R.trailingComments[q],He?(q===0?te=[te,g]:te=[te,Je],te.push(Ut(le,Je))):te=[te,Ot(Ut(le))],q!==re-1&&!ln(tt(te).toString())&&(te=[te,`
`]);return te}function hn(R,te,q){var re,le=0;for(re=R;re<te;re++)ae[re]===`
`&&le++;for(re=1;re<le;re++)q.push(F)}function Ft(R,te,q){return te<q?["(",R,")"]:R}function fn(R){var te,q,re;for(re=R.split(/\r\n|\n/),te=1,q=re.length;te<q;te++)re[te]=F+f+re[te];return re}function mn(R,te){var q,re,le;return q=R[z.verbatim],typeof q=="string"?re=Ft(fn(q),a.Sequence,te):(re=fn(q.content),le=q.precedence!=null?q.precedence:a.Sequence,re=Ft(re,le,te)),tt(re,R)}function xt(){}xt.prototype.maybeBlock=function(R,te){var q,re,le=this;return re=!z.comment||!R.leadingComments,R.type===e.BlockStatement&&re?[$,this.generateStatement(R,te)]:R.type===e.EmptyStatement&&re?";":(kt(function(){q=[F,Ot(le.generateStatement(R,te))]}),q)},xt.prototype.maybeBlockSuffix=function(R,te){var q=ln(tt(te).toString());return R.type===e.BlockStatement&&(!z.comment||!R.leadingComments)&&!q?[te,$]:q?[te,f]:[te,F,f]};function Vt(R){return tt(R.name,R)}function en(R,te){return R.async?"async"+(te?Mt():$):""}function sn(R){var te=R.generator&&!z.moz.starlessGenerator;return te?"*"+$:""}function yn(R){var te=R.value,q="";return te.async&&(q+=en(te,!R.computed)),te.generator&&(q+=sn(te)?"*":""),q}xt.prototype.generatePattern=function(R,te,q){return R.type===e.Identifier?Vt(R):this.generateExpression(R,te,q)},xt.prototype.generateFunctionParams=function(R){var te,q,re,le;if(le=!1,R.type===e.ArrowFunctionExpression&&!R.rest&&(!R.defaults||R.defaults.length===0)&&R.params.length===1&&R.params[0].type===e.Identifier)re=[en(R,!0),Vt(R.params[0])];else{for(re=R.type===e.ArrowFunctionExpression?[en(R,!1)]:[],re.push("("),R.defaults&&(le=!0),te=0,q=R.params.length;te<q;++te)le&&R.defaults[te]?re.push(this.generateAssignment(R.params[te],R.defaults[te],"=",a.Assignment,$e)):re.push(this.generatePattern(R.params[te],a.Assignment,$e)),te+1<q&&re.push(","+$);R.rest&&(R.params.length&&re.push(","+$),re.push("..."),re.push(Vt(R.rest))),re.push(")")}return re},xt.prototype.generateFunctionBody=function(R){var te,q;return te=this.generateFunctionParams(R),R.type===e.ArrowFunctionExpression&&(te.push($),te.push("=>")),R.expression?(te.push($),q=this.generateExpression(R.body,a.Assignment,$e),q.toString().charAt(0)==="{"&&(q=["(",q,")"]),te.push(q)):te.push(this.maybeBlock(R.body,wn)),te},xt.prototype.generateIterationForStatement=function(R,te,q){var re=["for"+(te.await?Mt()+"await":"")+$+"("],le=this;return kt(function(){te.left.type===e.VariableDeclaration?kt(function(){re.push(te.left.kind+Mt()),re.push(le.generateStatement(te.left.declarations[0],Wt))}):re.push(le.generateExpression(te.left,a.Call,$e)),re=st(re,R),re=[st(re,le.generateExpression(te.right,a.Assignment,$e)),")"]}),re.push(this.maybeBlock(te.body,q)),re},xt.prototype.generatePropertyKey=function(R,te){var q=[];return te&&q.push("["),q.push(this.generateExpression(R,a.Assignment,$e)),te&&q.push("]"),q},xt.prototype.generateAssignment=function(R,te,q,re,le){return a.Assignment<re&&(le|=Pe),Ft([this.generateExpression(R,a.Call,le),$+q+$,this.generateExpression(te,a.Assignment,le)],a.Assignment,re)},xt.prototype.semicolon=function(R){return!V&&R&ut?"":";"},xt.Statement={BlockStatement:function(R,te){var q,re,le=["{",F],Ee=this;return kt(function(){R.body.length===0&&de&&(q=R.range,q[1]-q[0]>2&&(re=ae.substring(q[0]+1,q[1]-1),re[0]===`
`&&(le=["{"]),le.push(re)));var He,Je,_t,Yt;for(Yt=Rt,te&at&&(Yt|=yt),He=0,Je=R.body.length;He<Je;++He)de&&(He===0&&(R.body[0].leadingComments&&(q=R.body[0].leadingComments[0].extendedRange,re=ae.substring(q[0],q[1]),re[0]===`
`&&(le=["{"])),R.body[0].leadingComments||hn(R.range[0],R.body[0].range[0],le)),He>0&&!R.body[He-1].trailingComments&&!R.body[He].leadingComments&&hn(R.body[He-1].range[1],R.body[He].range[0],le)),He===Je-1&&(Yt|=ut),R.body[He].leadingComments&&de?_t=Ee.generateStatement(R.body[He],Yt):_t=Ot(Ee.generateStatement(R.body[He],Yt)),le.push(_t),ln(tt(_t).toString())||de&&He<Je-1&&R.body[He+1].leadingComments||le.push(F),de&&He===Je-1&&(R.body[He].trailingComments||hn(R.body[He].range[1],R.range[1],le))}),le.push(Ot("}")),le},BreakStatement:function(R,te){return R.label?"break "+R.label.name+this.semicolon(te):"break"+this.semicolon(te)},ContinueStatement:function(R,te){return R.label?"continue "+R.label.name+this.semicolon(te):"continue"+this.semicolon(te)},ClassBody:function(R,te){var q=["{",F],re=this;return kt(function(le){var Ee,He;for(Ee=0,He=R.body.length;Ee<He;++Ee)q.push(le),q.push(re.generateExpression(R.body[Ee],a.Sequence,$e)),Ee+1<He&&q.push(F)}),ln(tt(q).toString())||q.push(F),q.push(f),q.push("}"),q},ClassDeclaration:function(R,te){var q,re;return q=["class"],R.id&&(q=st(q,this.generateExpression(R.id,a.Sequence,$e))),R.superClass&&(re=st("extends",this.generateExpression(R.superClass,a.Unary,$e)),q=st(q,re)),q.push($),q.push(this.generateStatement(R.body,qt)),q},DirectiveStatement:function(R,te){return z.raw&&R.raw?R.raw+this.semicolon(te):Ie(R.directive)+this.semicolon(te)},DoWhileStatement:function(R,te){var q=st("do",this.maybeBlock(R.body,Rt));return q=this.maybeBlockSuffix(R.body,q),st(q,["while"+$+"(",this.generateExpression(R.test,a.Sequence,$e),")"+this.semicolon(te)])},CatchClause:function(R,te){var q,re=this;return kt(function(){var le;R.param?(q=["catch"+$+"(",re.generateExpression(R.param,a.Sequence,$e),")"],R.guard&&(le=re.generateExpression(R.guard,a.Sequence,$e),q.splice(2,0," if ",le))):q=["catch"]}),q.push(this.maybeBlock(R.body,Rt)),q},DebuggerStatement:function(R,te){return"debugger"+this.semicolon(te)},EmptyStatement:function(R,te){return";"},ExportDefaultDeclaration:function(R,te){var q=["export"],re;return re=te&ut?qt:Rt,q=st(q,"default"),Ae(R.declaration)?q=st(q,this.generateStatement(R.declaration,re)):q=st(q,this.generateExpression(R.declaration,a.Assignment,$e)+this.semicolon(te)),q},ExportNamedDeclaration:function(R,te){var q=["export"],re,le=this;return re=te&ut?qt:Rt,R.declaration?st(q,this.generateStatement(R.declaration,re)):(R.specifiers&&(R.specifiers.length===0?q=st(q,"{"+$+"}"):R.specifiers[0].type===e.ExportBatchSpecifier?q=st(q,this.generateExpression(R.specifiers[0],a.Sequence,$e)):(q=st(q,"{"),kt(function(Ee){var He,Je;for(q.push(F),He=0,Je=R.specifiers.length;He<Je;++He)q.push(Ee),q.push(le.generateExpression(R.specifiers[He],a.Sequence,$e)),He+1<Je&&q.push(","+F)}),ln(tt(q).toString())||q.push(F),q.push(f+"}")),R.source?q=st(q,["from"+$,this.generateExpression(R.source,a.Sequence,$e),this.semicolon(te)]):q.push(this.semicolon(te))),q)},ExportAllDeclaration:function(R,te){return["export"+$,"*"+$,"from"+$,this.generateExpression(R.source,a.Sequence,$e),this.semicolon(te)]},ExpressionStatement:function(R,te){var q,re;function le(Je){var _t;return Je.slice(0,5)!=="class"?!1:(_t=Je.charCodeAt(5),_t===123||d.code.isWhiteSpace(_t)||d.code.isLineTerminator(_t))}function Ee(Je){var _t;return Je.slice(0,8)!=="function"?!1:(_t=Je.charCodeAt(8),_t===40||d.code.isWhiteSpace(_t)||_t===42||d.code.isLineTerminator(_t))}function He(Je){var _t,Yt,pn;if(Je.slice(0,5)!=="async"||!d.code.isWhiteSpace(Je.charCodeAt(5)))return!1;for(Yt=6,pn=Je.length;Yt<pn&&d.code.isWhiteSpace(Je.charCodeAt(Yt));++Yt);return Yt===pn||Je.slice(Yt,Yt+8)!=="function"?!1:(_t=Je.charCodeAt(Yt+8),_t===40||d.code.isWhiteSpace(_t)||_t===42||d.code.isLineTerminator(_t))}return q=[this.generateExpression(R.expression,a.Sequence,$e)],re=tt(q).toString(),re.charCodeAt(0)===123||le(re)||Ee(re)||He(re)||se&&te&yt&&R.expression.type===e.Literal&&typeof R.expression.value=="string"?q=["(",q,")"+this.semicolon(te)]:q.push(this.semicolon(te)),q},ImportDeclaration:function(R,te){var q,re,le=this;return R.specifiers.length===0?["import",$,this.generateExpression(R.source,a.Sequence,$e),this.semicolon(te)]:(q=["import"],re=0,R.specifiers[re].type===e.ImportDefaultSpecifier&&(q=st(q,[this.generateExpression(R.specifiers[re],a.Sequence,$e)]),++re),R.specifiers[re]&&(re!==0&&q.push(","),R.specifiers[re].type===e.ImportNamespaceSpecifier?q=st(q,[$,this.generateExpression(R.specifiers[re],a.Sequence,$e)]):(q.push($+"{"),R.specifiers.length-re===1?(q.push($),q.push(this.generateExpression(R.specifiers[re],a.Sequence,$e)),q.push($+"}"+$)):(kt(function(Ee){var He,Je;for(q.push(F),He=re,Je=R.specifiers.length;He<Je;++He)q.push(Ee),q.push(le.generateExpression(R.specifiers[He],a.Sequence,$e)),He+1<Je&&q.push(","+F)}),ln(tt(q).toString())||q.push(F),q.push(f+"}"+$)))),q=st(q,["from"+$,this.generateExpression(R.source,a.Sequence,$e),this.semicolon(te)]),q)},VariableDeclarator:function(R,te){var q=te&Pe?$e:$t;return R.init?[this.generateExpression(R.id,a.Assignment,q),$,"=",$,this.generateExpression(R.init,a.Assignment,q)]:this.generatePattern(R.id,a.Assignment,q)},VariableDeclaration:function(R,te){var q,re,le,Ee,He,Je=this;q=[R.kind],He=te&Pe?Rt:Wt;function _t(){for(Ee=R.declarations[0],z.comment&&Ee.leadingComments?(q.push(`
`),q.push(Ot(Je.generateStatement(Ee,He)))):(q.push(Mt()),q.push(Je.generateStatement(Ee,He))),re=1,le=R.declarations.length;re<le;++re)Ee=R.declarations[re],z.comment&&Ee.leadingComments?(q.push(","+F),q.push(Ot(Je.generateStatement(Ee,He)))):(q.push(","+$),q.push(Je.generateStatement(Ee,He)))}return R.declarations.length>1?kt(_t):_t(),q.push(this.semicolon(te)),q},ThrowStatement:function(R,te){return[st("throw",this.generateExpression(R.argument,a.Sequence,$e)),this.semicolon(te)]},TryStatement:function(R,te){var q,re,le,Ee;if(q=["try",this.maybeBlock(R.block,Rt)],q=this.maybeBlockSuffix(R.block,q),R.handlers)for(re=0,le=R.handlers.length;re<le;++re)q=st(q,this.generateStatement(R.handlers[re],Rt)),(R.finalizer||re+1!==le)&&(q=this.maybeBlockSuffix(R.handlers[re].body,q));else{for(Ee=R.guardedHandlers||[],re=0,le=Ee.length;re<le;++re)q=st(q,this.generateStatement(Ee[re],Rt)),(R.finalizer||re+1!==le)&&(q=this.maybeBlockSuffix(Ee[re].body,q));if(R.handler)if(Array.isArray(R.handler))for(re=0,le=R.handler.length;re<le;++re)q=st(q,this.generateStatement(R.handler[re],Rt)),(R.finalizer||re+1!==le)&&(q=this.maybeBlockSuffix(R.handler[re].body,q));else q=st(q,this.generateStatement(R.handler,Rt)),R.finalizer&&(q=this.maybeBlockSuffix(R.handler.body,q))}return R.finalizer&&(q=st(q,["finally",this.maybeBlock(R.finalizer,Rt)])),q},SwitchStatement:function(R,te){var q,re,le,Ee,He,Je=this;if(kt(function(){q=["switch"+$+"(",Je.generateExpression(R.discriminant,a.Sequence,$e),")"+$+"{"+F]}),R.cases)for(He=Rt,le=0,Ee=R.cases.length;le<Ee;++le)le===Ee-1&&(He|=ut),re=Ot(this.generateStatement(R.cases[le],He)),q.push(re),ln(tt(re).toString())||q.push(F);return q.push(Ot("}")),q},SwitchCase:function(R,te){var q,re,le,Ee,He,Je=this;return kt(function(){for(R.test?q=[st("case",Je.generateExpression(R.test,a.Sequence,$e)),":"]:q=["default:"],le=0,Ee=R.consequent.length,Ee&&R.consequent[0].type===e.BlockStatement&&(re=Je.maybeBlock(R.consequent[0],Rt),q.push(re),le=1),le!==Ee&&!ln(tt(q).toString())&&q.push(F),He=Rt;le<Ee;++le)le===Ee-1&&te&ut&&(He|=ut),re=Ot(Je.generateStatement(R.consequent[le],He)),q.push(re),le+1!==Ee&&!ln(tt(re).toString())&&q.push(F)}),q},IfStatement:function(R,te){var q,re,le,Ee=this;return kt(function(){q=["if"+$+"(",Ee.generateExpression(R.test,a.Sequence,$e),")"]}),le=te&ut,re=Rt,le&&(re|=ut),R.alternate?(q.push(this.maybeBlock(R.consequent,Rt)),q=this.maybeBlockSuffix(R.consequent,q),R.alternate.type===e.IfStatement?q=st(q,["else ",this.generateStatement(R.alternate,re)]):q=st(q,st("else",this.maybeBlock(R.alternate,re)))):q.push(this.maybeBlock(R.consequent,re)),q},ForStatement:function(R,te){var q,re=this;return kt(function(){q=["for"+$+"("],R.init?R.init.type===e.VariableDeclaration?q.push(re.generateStatement(R.init,Wt)):(q.push(re.generateExpression(R.init,a.Sequence,$t)),q.push(";")):q.push(";"),R.test&&(q.push($),q.push(re.generateExpression(R.test,a.Sequence,$e))),q.push(";"),R.update&&(q.push($),q.push(re.generateExpression(R.update,a.Sequence,$e))),q.push(")")}),q.push(this.maybeBlock(R.body,te&ut?qt:Rt)),q},ForInStatement:function(R,te){return this.generateIterationForStatement("in",R,te&ut?qt:Rt)},ForOfStatement:function(R,te){return this.generateIterationForStatement("of",R,te&ut?qt:Rt)},LabeledStatement:function(R,te){return[R.label.name+":",this.maybeBlock(R.body,te&ut?qt:Rt)]},Program:function(R,te){var q,re,le,Ee,He;for(Ee=R.body.length,q=[K&&Ee>0?`
`:""],He=tn,le=0;le<Ee;++le)!K&&le===Ee-1&&(He|=ut),de&&(le===0&&(R.body[0].leadingComments||hn(R.range[0],R.body[le].range[0],q)),le>0&&!R.body[le-1].trailingComments&&!R.body[le].leadingComments&&hn(R.body[le-1].range[1],R.body[le].range[0],q)),re=Ot(this.generateStatement(R.body[le],He)),q.push(re),le+1<Ee&&!ln(tt(re).toString())&&(de&&R.body[le+1].leadingComments||q.push(F)),de&&le===Ee-1&&(R.body[le].trailingComments||hn(R.body[le].range[1],R.range[1],q));return q},FunctionDeclaration:function(R,te){return[en(R,!0),"function",sn(R)||Mt(),R.id?Vt(R.id):"",this.generateFunctionBody(R)]},ReturnStatement:function(R,te){return R.argument?[st("return",this.generateExpression(R.argument,a.Sequence,$e)),this.semicolon(te)]:["return"+this.semicolon(te)]},WhileStatement:function(R,te){var q,re=this;return kt(function(){q=["while"+$+"(",re.generateExpression(R.test,a.Sequence,$e),")"]}),q.push(this.maybeBlock(R.body,te&ut?qt:Rt)),q},WithStatement:function(R,te){var q,re=this;return kt(function(){q=["with"+$+"(",re.generateExpression(R.object,a.Sequence,$e),")"]}),q.push(this.maybeBlock(R.body,te&ut?qt:Rt)),q}},zn(xt.prototype,xt.Statement),xt.Expression={SequenceExpression:function(R,te,q){var re,le,Ee;for(a.Sequence<te&&(q|=Pe),re=[],le=0,Ee=R.expressions.length;le<Ee;++le)re.push(this.generateExpression(R.expressions[le],a.Assignment,q)),le+1<Ee&&re.push(","+$);return Ft(re,a.Sequence,te)},AssignmentExpression:function(R,te,q){return this.generateAssignment(R.left,R.right,R.operator,te,q)},ArrowFunctionExpression:function(R,te,q){return Ft(this.generateFunctionBody(R),a.ArrowFunction,te)},ConditionalExpression:function(R,te,q){return a.Conditional<te&&(q|=Pe),Ft([this.generateExpression(R.test,a.Coalesce,q),$+"?"+$,this.generateExpression(R.consequent,a.Assignment,q),$+":"+$,this.generateExpression(R.alternate,a.Assignment,q)],a.Conditional,te)},LogicalExpression:function(R,te,q){return R.operator==="??"&&(q|=Dt),this.BinaryExpression(R,te,q)},BinaryExpression:function(R,te,q){var re,le,Ee,He,Je,_t;return He=l[R.operator],le=R.operator==="**"?a.Postfix:He,Ee=R.operator==="**"?He:He+1,He<te&&(q|=Pe),Je=this.generateExpression(R.left,le,q),_t=Je.toString(),_t.charCodeAt(_t.length-1)===47&&d.code.isIdentifierPartES5(R.operator.charCodeAt(0))?re=[Je,Mt(),R.operator]:re=st(Je,R.operator),Je=this.generateExpression(R.right,Ee,q),R.operator==="/"&&Je.toString().charAt(0)==="/"||R.operator.slice(-1)==="<"&&Je.toString().slice(0,3)==="!--"?(re.push(Mt()),re.push(Je)):re=st(re,Je),R.operator==="in"&&!(q&Pe)?["(",re,")"]:(R.operator==="||"||R.operator==="&&")&&q&Dt?["(",re,")"]:Ft(re,He,te)},CallExpression:function(R,te,q){var re,le,Ee;for(re=[this.generateExpression(R.callee,a.Call,Bt)],R.optional&&re.push("?."),re.push("("),le=0,Ee=R.arguments.length;le<Ee;++le)re.push(this.generateExpression(R.arguments[le],a.Assignment,$e)),le+1<Ee&&re.push(","+$);return re.push(")"),q&We?Ft(re,a.Call,te):["(",re,")"]},ChainExpression:function(R,te,q){a.OptionalChaining<te&&(q|=We);var re=this.generateExpression(R.expression,a.OptionalChaining,q);return Ft(re,a.OptionalChaining,te)},NewExpression:function(R,te,q){var re,le,Ee,He,Je;if(le=R.arguments.length,Je=q&qe&&!Z&&le===0?Zt:bt,re=st("new",this.generateExpression(R.callee,a.New,Je)),!(q&qe)||Z||le>0){for(re.push("("),Ee=0,He=le;Ee<He;++Ee)re.push(this.generateExpression(R.arguments[Ee],a.Assignment,$e)),Ee+1<He&&re.push(","+$);re.push(")")}return Ft(re,a.New,te)},MemberExpression:function(R,te,q){var re,le;return re=[this.generateExpression(R.object,a.Call,q&We?Bt:bt)],R.computed?(R.optional&&re.push("?."),re.push("["),re.push(this.generateExpression(R.property,a.Sequence,q&We?$e:Zt)),re.push("]")):(!R.optional&&R.object.type===e.Literal&&typeof R.object.value=="number"&&(le=tt(re).toString(),le.indexOf(".")<0&&!/[eExX]/.test(le)&&d.code.isDecimalDigit(le.charCodeAt(le.length-1))&&!(le.length>=2&&le.charCodeAt(0)===48)&&re.push(" ")),re.push(R.optional?"?.":"."),re.push(Vt(R.property))),Ft(re,a.Member,te)},MetaProperty:function(R,te,q){var re;return re=[],re.push(typeof R.meta=="string"?R.meta:Vt(R.meta)),re.push("."),re.push(typeof R.property=="string"?R.property:Vt(R.property)),Ft(re,a.Member,te)},UnaryExpression:function(R,te,q){var re,le,Ee,He,Je;return le=this.generateExpression(R.argument,a.Unary,$e),$===""?re=st(R.operator,le):(re=[R.operator],R.operator.length>2?re=st(re,le):(He=tt(re).toString(),Je=He.charCodeAt(He.length-1),Ee=le.toString().charCodeAt(0),((Je===43||Je===45)&&Je===Ee||d.code.isIdentifierPartES5(Je)&&d.code.isIdentifierPartES5(Ee))&&re.push(Mt()),re.push(le))),Ft(re,a.Unary,te)},YieldExpression:function(R,te,q){var re;return R.delegate?re="yield*":re="yield",R.argument&&(re=st(re,this.generateExpression(R.argument,a.Yield,$e))),Ft(re,a.Yield,te)},AwaitExpression:function(R,te,q){var re=st(R.all?"await*":"await",this.generateExpression(R.argument,a.Await,$e));return Ft(re,a.Await,te)},UpdateExpression:function(R,te,q){return R.prefix?Ft([R.operator,this.generateExpression(R.argument,a.Unary,$e)],a.Unary,te):Ft([this.generateExpression(R.argument,a.Postfix,$e),R.operator],a.Postfix,te)},FunctionExpression:function(R,te,q){var re=[en(R,!0),"function"];return R.id?(re.push(sn(R)||Mt()),re.push(Vt(R.id))):re.push(sn(R)||$),re.push(this.generateFunctionBody(R)),re},ArrayPattern:function(R,te,q){return this.ArrayExpression(R,te,q,!0)},ArrayExpression:function(R,te,q,re){var le,Ee,He=this;return R.elements.length?(Ee=re?!1:R.elements.length>1,le=["[",Ee?F:""],kt(function(Je){var _t,Yt;for(_t=0,Yt=R.elements.length;_t<Yt;++_t)R.elements[_t]?(le.push(Ee?Je:""),le.push(He.generateExpression(R.elements[_t],a.Assignment,$e))):(Ee&&le.push(Je),_t+1===Yt&&le.push(",")),_t+1<Yt&&le.push(","+(Ee?F:$))}),Ee&&!ln(tt(le).toString())&&le.push(F),le.push(Ee?f:""),le.push("]"),le):"[]"},RestElement:function(R,te,q){return"..."+this.generatePattern(R.argument)},ClassExpression:function(R,te,q){var re,le;return re=["class"],R.id&&(re=st(re,this.generateExpression(R.id,a.Sequence,$e))),R.superClass&&(le=st("extends",this.generateExpression(R.superClass,a.Unary,$e)),re=st(re,le)),re.push($),re.push(this.generateStatement(R.body,qt)),re},MethodDefinition:function(R,te,q){var re,le;return R.static?re=["static"+$]:re=[],R.kind==="get"||R.kind==="set"?le=[st(R.kind,this.generatePropertyKey(R.key,R.computed)),this.generateFunctionBody(R.value)]:le=[yn(R),this.generatePropertyKey(R.key,R.computed),this.generateFunctionBody(R.value)],st(re,le)},Property:function(R,te,q){return R.kind==="get"||R.kind==="set"?[R.kind,Mt(),this.generatePropertyKey(R.key,R.computed),this.generateFunctionBody(R.value)]:R.shorthand?R.value.type==="AssignmentPattern"?this.AssignmentPattern(R.value,a.Sequence,$e):this.generatePropertyKey(R.key,R.computed):R.method?[yn(R),this.generatePropertyKey(R.key,R.computed),this.generateFunctionBody(R.value)]:[this.generatePropertyKey(R.key,R.computed),":"+$,this.generateExpression(R.value,a.Assignment,$e)]},ObjectExpression:function(R,te,q){var re,le,Ee,He=this;return R.properties.length?(re=R.properties.length>1,kt(function(){Ee=He.generateExpression(R.properties[0],a.Sequence,$e)}),!re&&!Zn(tt(Ee).toString())?["{",$,Ee,$,"}"]:(kt(function(Je){var _t,Yt;if(le=["{",F,Je,Ee],re)for(le.push(","+F),_t=1,Yt=R.properties.length;_t<Yt;++_t)le.push(Je),le.push(He.generateExpression(R.properties[_t],a.Sequence,$e)),_t+1<Yt&&le.push(","+F)}),ln(tt(le).toString())||le.push(F),le.push(f),le.push("}"),le)):"{}"},AssignmentPattern:function(R,te,q){return this.generateAssignment(R.left,R.right,"=",te,q)},ObjectPattern:function(R,te,q){var re,le,Ee,He,Je,_t=this;if(!R.properties.length)return"{}";if(He=!1,R.properties.length===1)Je=R.properties[0],Je.type===e.Property&&Je.value.type!==e.Identifier&&(He=!0);else for(le=0,Ee=R.properties.length;le<Ee;++le)if(Je=R.properties[le],Je.type===e.Property&&!Je.shorthand){He=!0;break}return re=["{",He?F:""],kt(function(Yt){var pn,si;for(pn=0,si=R.properties.length;pn<si;++pn)re.push(He?Yt:""),re.push(_t.generateExpression(R.properties[pn],a.Sequence,$e)),pn+1<si&&re.push(","+(He?F:$))}),He&&!ln(tt(re).toString())&&re.push(F),re.push(He?f:""),re.push("}"),re},ThisExpression:function(R,te,q){return"this"},Super:function(R,te,q){return"super"},Identifier:function(R,te,q){return Vt(R)},ImportDefaultSpecifier:function(R,te,q){return Vt(R.id||R.local)},ImportNamespaceSpecifier:function(R,te,q){var re=["*"],le=R.id||R.local;return le&&re.push($+"as"+Mt()+Vt(le)),re},ImportSpecifier:function(R,te,q){var re=R.imported,le=[re.name],Ee=R.local;return Ee&&Ee.name!==re.name&&le.push(Mt()+"as"+Mt()+Vt(Ee)),le},ExportSpecifier:function(R,te,q){var re=R.local,le=[re.name],Ee=R.exported;return Ee&&Ee.name!==re.name&&le.push(Mt()+"as"+Mt()+Vt(Ee)),le},Literal:function(R,te,q){var re;if(R.hasOwnProperty("raw")&&U&&z.raw)try{if(re=U(R.raw).body[0].expression,re.type===e.Literal&&re.value===R.value)return R.raw}catch{}return R.regex?"/"+R.regex.pattern+"/"+R.regex.flags:typeof R.value=="bigint"?R.value.toString()+"n":R.bigint?R.bigint+"n":R.value===null?"null":typeof R.value=="string"?ot(R.value):typeof R.value=="number"?Bn(R.value):typeof R.value=="boolean"?R.value?"true":"false":ve(R.value)},GeneratorExpression:function(R,te,q){return this.ComprehensionExpression(R,te,q)},ComprehensionExpression:function(R,te,q){var re,le,Ee,He,Je=this;return re=R.type===e.GeneratorExpression?["("]:["["],z.moz.comprehensionExpressionStartsWithAssignment&&(He=this.generateExpression(R.body,a.Assignment,$e),re.push(He)),R.blocks&&kt(function(){for(le=0,Ee=R.blocks.length;le<Ee;++le)He=Je.generateExpression(R.blocks[le],a.Sequence,$e),le>0||z.moz.comprehensionExpressionStartsWithAssignment?re=st(re,He):re.push(He)}),R.filter&&(re=st(re,"if"+$),He=this.generateExpression(R.filter,a.Sequence,$e),re=st(re,["(",He,")"])),z.moz.comprehensionExpressionStartsWithAssignment||(He=this.generateExpression(R.body,a.Assignment,$e),re=st(re,He)),re.push(R.type===e.GeneratorExpression?")":"]"),re},ComprehensionBlock:function(R,te,q){var re;return R.left.type===e.VariableDeclaration?re=[R.left.kind,Mt(),this.generateStatement(R.left.declarations[0],Wt)]:re=this.generateExpression(R.left,a.Call,$e),re=st(re,R.of?"of":"in"),re=st(re,this.generateExpression(R.right,a.Sequence,$e)),["for"+$+"(",re,")"]},SpreadElement:function(R,te,q){return["...",this.generateExpression(R.argument,a.Assignment,$e)]},TaggedTemplateExpression:function(R,te,q){var re=Bt;q&We||(re=bt);var le=[this.generateExpression(R.tag,a.Call,re),this.generateExpression(R.quasi,a.Primary,nn)];return Ft(le,a.TaggedTemplate,te)},TemplateElement:function(R,te,q){return R.value.raw},TemplateLiteral:function(R,te,q){var re,le,Ee;for(re=["`"],le=0,Ee=R.quasis.length;le<Ee;++le)re.push(this.generateExpression(R.quasis[le],a.Primary,$e)),le+1<Ee&&(re.push("${"+$),re.push(this.generateExpression(R.expressions[le],a.Sequence,$e)),re.push($+"}"));return re.push("`"),re},ModuleSpecifier:function(R,te,q){return this.Literal(R,te,q)},ImportExpression:function(R,te,q){return Ft(["import(",this.generateExpression(R.source,a.Assignment,$e),")"],a.Call,te)}},zn(xt.prototype,xt.Expression),xt.prototype.generateExpression=function(R,te,q){var re,le;return le=R.type||e.Property,z.verbatim&&R.hasOwnProperty(z.verbatim)?mn(R,te):(re=this[le](R,te,q),z.comment&&(re=Nt(R,re)),tt(re,R))},xt.prototype.generateStatement=function(R,te){var q,re;return q=this[R.type](R,te),z.comment&&(q=Nt(R,q)),re=tt(q).toString(),R.type===e.Program&&!K&&F===""&&re.charAt(re.length-1)===`
`&&(q=ee?tt(q).replaceRight(/\s+$/,""):re.replace(/\s+$/,"")),tt(q,R)};function Xn(R){var te;if(te=new xt,Ae(R))return te.generateStatement(R,Rt);if(De(R))return te.generateExpression(R,a.Sequence,$e);throw new Error("Unknown node type: "+R.type)}function ti(R,te){var q=dn(),re,le;return te!=null?(typeof te.indent=="string"&&(q.format.indent.style=te.indent),typeof te.base=="number"&&(q.format.indent.base=te.base),te=cn(q,te),g=te.format.indent.style,typeof te.base=="string"?f=te.base:f=rn(g,te.format.indent.base)):(te=q,g=te.format.indent.style,f=rn(g,te.format.indent.base)),b=te.format.json,A=te.format.renumber,S=b?!1:te.format.hexadecimal,M=b?"double":te.format.quotes,E=te.format.escapeless,F=te.format.newline,$=te.format.space,te.format.compact&&(F=$=g=f=""),Z=te.format.parentheses,V=te.format.semicolons,K=te.format.safeConcatenation,se=te.directive,U=b?null:te.parse,ee=te.sourceMap,ae=te.sourceCode,de=te.format.preserveBlankLines&&ae!==null,z=te,ee&&(o.browser?u=commonjsGlobal.sourceMap.SourceNode:u=requireSourceMap().SourceNode),re=Xn(R),ee?(le=re.toStringWithSourceMap({file:te.file,sourceRoot:te.sourceMapRoot}),te.sourceContent&&le.map.setSourceContent(te.sourceMap,te.sourceContent),te.sourceMapWithCode?le:le.map.toString()):(le={code:re.toString(),map:null},te.sourceMapWithCode?le:le.code)}ke={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},Oe=dn().format,o.version=require$$3.version,o.generate=ti,o.attachComments=p.attachComments,o.Precedence=cn({},a),o.browser=!1,o.FORMAT_MINIFY=ke,o.FORMAT_DEFAULTS=Oe})()})(escodegen$1)),escodegen$1}var escodegenExports=requireEscodegen();const escodegen=getDefaultExportFromCjs(escodegenExports);class WalkerBase{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:e=>this.replacement=e}}replace(e,a,l,u){e&&a&&(l!=null?e[a][l]=u:e[a]=u)}remove(e,a,l){e&&a&&(l!=null?e[a].splice(l,1):delete e[a])}}class SyncWalker extends WalkerBase{constructor(e,a){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:l=>this.replacement=l},this.enter=e,this.leave=a}visit(e,a,l,u){if(e){if(this.enter){const d=this.should_skip,f=this.should_remove,g=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,e,a,l,u),this.replacement&&(e=this.replacement,this.replace(a,l,u,e)),this.should_remove&&this.remove(a,l,u);const b=this.should_skip,A=this.should_remove;if(this.should_skip=d,this.should_remove=f,this.replacement=g,b)return e;if(A)return null}let p;for(p in e){const d=e[p];if(d&&typeof d=="object")if(Array.isArray(d)){const f=d;for(let g=0;g<f.length;g+=1){const b=f[g];isNode(b)&&(this.visit(b,e,p,g)||g--)}}else isNode(d)&&this.visit(d,e,p,null)}if(this.leave){const d=this.replacement,f=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,e,a,l,u),this.replacement&&(e=this.replacement,this.replace(a,l,u,e)),this.should_remove&&this.remove(a,l,u);const g=this.should_remove;if(this.replacement=d,this.should_remove=f,g)return null}}return e}}function isNode(o){return o!==null&&typeof o=="object"&&"type"in o&&typeof o.type=="string"}function walk(o,{enter:e,leave:a}){return new SyncWalker(e,a).visit(o,null)}let widgetMethods=[],languages=new Map;function transpiler(o,e={}){const{wrapAsync:a=!1,addReturn:l=!0,emitMiniLocations:u=!0,emitWidgets:p=!0}=e;let d=parse(o,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),f=[];const g=(M,E)=>{const F=languages.get("minilang");if(F){const $=`[${M}]`,Z=F.getLocations($,E.start);f=f.concat(Z)}else{const $=getLeafLocations(`"${M}"`,E.start,o);f=f.concat($)}};let b=[];walk(d,{enter(M,E){if(isLanguageLiteral(M)){const{name:F}=M.tag,$=languages.get(F),Z=M.quasi.quasis[0].value.raw,V=M.quasi.start+1;if(u){const K=$.getLocations(Z,V);f=f.concat(K)}return this.skip(),this.replace(languageWithLocation(F,Z,V))}if(isTemplateLiteral(M,"tidal")){const F=M.quasi.quasis[0].value.raw,$=M.quasi.start+1;if(u){const Z=collectHaskellMiniLocations(F,$);f=f.concat(Z)}return this.skip(),this.replace(tidalWithLocation(F,$))}if(isBackTickString(M,E)){const{quasis:F}=M,{raw:$}=F[0].value;return this.skip(),u&&g($,M),this.replace(miniWithLocation($,M))}if(isStringWithDoubleQuotes(M)){const{value:F}=M;return this.skip(),u&&g(F,M),this.replace(miniWithLocation(F,M))}if(isSliderFunction(M))return p&&b.push({from:M.arguments[0].start,to:M.arguments[0].end,value:M.arguments[0].raw,min:M.arguments[1]?.value??0,max:M.arguments[2]?.value??1,step:M.arguments[3]?.value,type:"slider"}),this.replace(sliderWithLocation(M));if(isWidgetMethod(M)){const F=M.callee.property.name,$=b.filter(V=>V.type===F).length,Z={to:M.end,index:$,type:F,id:e.id};return p&&b.push(Z),this.replace(widgetWithLocation(M,Z))}if(isBareSamplesCall(M,E))return this.replace(withAwait(M));if(isLabelStatement(M))return this.replace(labelToP(M))},leave(M,E,F,$){}});let{body:A}=d;if(!A.length)console.warn("empty body -> fallback to silence"),A.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!A?.[A.length-1]?.expression)throw new Error("unexpected ast format without body expression");if(l){const{expression:M}=A[A.length-1];A[A.length-1]={type:"ReturnStatement",argument:M}}let S=escodegen.generate(d);return a&&(S=`(async ()=>{${S}})()`),u?{output:S,miniLocations:f,widgets:b}:{output:S}}function isStringWithDoubleQuotes(o,e,a){return o.type!=="Literal"?!1:o.raw[0]==='"'}function isBackTickString(o,e){return o.type==="TemplateLiteral"&&e.type!=="TaggedTemplateExpression"}function miniWithLocation(o,e){const{start:a}=e,l=languages.get("minilang");let u="m";return l&&l.name&&(u=l.name),{type:"CallExpression",callee:{type:"Identifier",name:u},arguments:[{type:"Literal",value:o},{type:"Literal",value:a}],optional:!1}}function isSliderFunction(o){return o.type==="CallExpression"&&o.callee.name==="slider"}function isWidgetMethod(o){return o.type==="CallExpression"&&widgetMethods.includes(o.callee.property?.name)}function sliderWithLocation(o){const e="slider_"+o.arguments[0].start;return o.arguments.unshift({type:"Literal",value:e,raw:e}),o.callee.name="sliderWithID",o}function getWidgetID(o){return`${o.id||""}_widget_${o.type}_${o.index}`}function widgetWithLocation(o,e){const a=getWidgetID(e);return o.arguments.unshift({type:"Literal",value:a,raw:a}),o}function isBareSamplesCall(o,e){return o.type==="CallExpression"&&o.callee.name==="samples"&&e.type!=="AwaitExpression"}function withAwait(o){return{type:"AwaitExpression",argument:o}}function isLabelStatement(o){return o.type==="LabeledStatement"}function labelToP(o){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:o.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:o.label.name,raw:`'${o.label.name}'`}]}}}function isLanguageLiteral(o){return o.type==="TaggedTemplateExpression"&&languages.has(o.tag.name)}function isTemplateLiteral(o,e){return o.type==="TaggedTemplateExpression"&&o.tag.name===e}function collectHaskellMiniLocations(o,e){return o.split("").reduce((a,l,u)=>(l!=='"'||(!a.length||a[a.length-1].length>1?a.push([u+1]):a[a.length-1].push(u)),a),[]).map(([a,l])=>{const u=o.slice(a,l);return getLeafLocations(`"${u}"`,e+a-1)}).flat()}function tidalWithLocation(o,e){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:o},{type:"Literal",value:e}],optional:!1}}function languageWithLocation(o,e,a){return{type:"CallExpression",callee:{type:"Identifier",name:o},arguments:[{type:"Literal",value:e},{type:"Literal",value:a}],optional:!1}}const gm={gm_piano:["0000_JCLive_sf2_file","0000_FluidR3_GM_sf2_file","0000_Aspirin_sf2_file","0000_Chaos_sf2_file","0000_GeneralUserGS_sf2_file","0001_FluidR3_GM_sf2_file","0001_GeneralUserGS_sf2_file","0010_Aspirin_sf2_file","0010_Chaos_sf2_file","0010_FluidR3_GM_sf2_file","0010_GeneralUserGS_sf2_file","0010_JCLive_sf2_file","0011_Aspirin_sf2_file","0011_FluidR3_GM_sf2_file","0011_GeneralUserGS_sf2_file","0012_GeneralUserGS_sf2_file","0020_Aspirin_sf2_file","0020_Chaos_sf2_file","0020_FluidR3_GM_sf2_file","0020_GeneralUserGS_sf2_file","0020_JCLive_sf2_file","0021_Aspirin_sf2_file","0021_GeneralUserGS_sf2_file","0022_Aspirin_sf2_file","0030_Aspirin_sf2_file","0030_Chaos_sf2_file","0030_FluidR3_GM_sf2_file","0030_GeneralUserGS_sf2_file","0030_JCLive_sf2_file","0031_Aspirin_sf2_file","0031_FluidR3_GM_sf2_file","0031_GeneralUserGS_sf2_file"],gm_epiano1:["0040_JCLive_sf2_file","0040_FluidR3_GM_sf2_file","0040_Aspirin_sf2_file","0040_Chaos_sf2_file","0040_GeneralUserGS_sf2_file","0041_FluidR3_GM_sf2_file","0041_GeneralUserGS_sf2_file","0042_GeneralUserGS_sf2_file","0043_GeneralUserGS_sf2_file","0044_GeneralUserGS_sf2_file","0046_GeneralUserGS_sf2_file"],gm_epiano2:["0050_JCLive_sf2_file","0050_FluidR3_GM_sf2_file","0050_Aspirin_sf2_file","0050_Chaos_sf2_file","0050_GeneralUserGS_sf2_file","0051_FluidR3_GM_sf2_file","0051_GeneralUserGS_sf2_file","0053_GeneralUserGS_sf2_file","0054_GeneralUserGS_sf2_file"],gm_harpsichord:["0060_JCLive_sf2_file","0060_FluidR3_GM_sf2_file","0060_Aspirin_sf2_file","0060_Chaos_sf2_file","0060_GeneralUserGS_sf2_file","0061_Aspirin_sf2_file","0061_GeneralUserGS_sf2_file","0062_GeneralUserGS_sf2_file"],gm_clavinet:["0070_JCLive_sf2_file","0070_FluidR3_GM_sf2_file","0070_Aspirin_sf2_file","0070_Chaos_sf2_file"],gm_celesta:["0080_JCLive_sf2_file","0080_Aspirin_sf2_file","0080_Chaos_sf2_file","0080_FluidR3_GM_sf2_file","0080_GeneralUserGS_sf2_file","0081_FluidR3_GM_sf2_file"],gm_glockenspiel:["0090_JCLive_sf2_file","0090_Aspirin_sf2_file","0090_Chaos_sf2_file","0090_FluidR3_GM_sf2_file","0090_GeneralUserGS_sf2_file"],gm_music_box:["0100_JCLive_sf2_file","0100_Aspirin_sf2_file","0100_Chaos_sf2_file","0100_FluidR3_GM_sf2_file","0100_GeneralUserGS_sf2_file"],gm_vibraphone:["0110_JCLive_sf2_file","0110_Aspirin_sf2_file","0110_Chaos_sf2_file","0110_FluidR3_GM_sf2_file","0110_GeneralUserGS_sf2_file","0111_FluidR3_GM_sf2_file"],gm_marimba:["0120_JCLive_sf2_file","0120_Aspirin_sf2_file","0120_Chaos_sf2_file","0120_FluidR3_GM_sf2_file","0120_GeneralUserGS_sf2_file","0121_FluidR3_GM_sf2_file","0121_GeneralUserGS_sf2_file"],gm_xylophone:["0130_JCLive_sf2_file","0130_Aspirin_sf2_file","0130_Chaos_sf2_file","0130_FluidR3_GM_sf2_file","0130_GeneralUserGS_sf2_file","0131_FluidR3_GM_sf2_file"],gm_tubular_bells:["0140_JCLive_sf2_file","0140_Aspirin_sf2_file","0140_FluidR3_GM_sf2_file","0140_GeneralUserGS_sf2_file","0141_FluidR3_GM_sf2_file","0142_GeneralUserGS_sf2_file"],gm_dulcimer:["0150_Aspirin_sf2_file","0150_Chaos_sf2_file","0150_FluidR3_GM_sf2_file","0150_GeneralUserGS_sf2_file","0151_FluidR3_GM_sf2_file"],gm_drawbar_organ:["0160_JCLive_sf2_file","0160_Aspirin_sf2_file","0160_Chaos_sf2_file","0160_FluidR3_GM_sf2_file","0160_GeneralUserGS_sf2_file","0161_Aspirin_sf2_file","0161_FluidR3_GM_sf2_file"],gm_percussive_organ:["0170_JCLive_sf2_file","0170_Aspirin_sf2_file","0170_Chaos_sf2_file","0170_FluidR3_GM_sf2_file","0171_FluidR3_GM_sf2_file","0172_FluidR3_GM_sf2_file"],gm_rock_organ:["0180_JCLive_sf2_file","0180_Aspirin_sf2_file","0180_Chaos_sf2_file","0180_FluidR3_GM_sf2_file","0180_GeneralUserGS_sf2_file"],gm_church_organ:["0190_JCLive_sf2_file","0190_Aspirin_sf2_file","0190_Chaos_sf2_file","0190_FluidR3_GM_sf2_file","0190_GeneralUserGS_sf2_file"],gm_reed_organ:["0200_JCLive_sf2_file","0200_Aspirin_sf2_file","0200_Chaos_sf2_file","0200_FluidR3_GM_sf2_file","0200_GeneralUserGS_sf2_file","0201_Aspirin_sf2_file","0201_FluidR3_GM_sf2_file","0201_GeneralUserGS_sf2_file"],gm_accordion:["0210_JCLive_sf2_file","0210_FluidR3_GM_sf2_file","0210_GeneralUserGS_sf2_file","0211_Aspirin_sf2_file","0211_FluidR3_GM_sf2_file","0211_GeneralUserGS_sf2_file","0212_GeneralUserGS_sf2_file"],gm_harmonica:["0220_FluidR3_GM_sf2_file","0220_JCLive_sf2_file","0220_Aspirin_sf2_file","0220_Chaos_sf2_file","0220_GeneralUserGS_sf2_file","0221_FluidR3_GM_sf2_file"],gm_bandoneon:["0230_Aspirin_sf2_file","0230_JCLive_sf2_file","0230_Chaos_sf2_file","0230_FluidR3_GM_sf2_file","0230_GeneralUserGS_sf2_file","0231_FluidR3_GM_sf2_file","0231_GeneralUserGS_sf2_file","0231_JCLive_sf2_file","0232_FluidR3_GM_sf2_file","0233_FluidR3_GM_sf2_file"],gm_acoustic_guitar_nylon:["0240_JCLive_sf2_file","0240_Aspirin_sf2_file","0240_Chaos_sf2_file","0240_FluidR3_GM_sf2_file","0240_GeneralUserGS_sf2_file","0240_LK_Godin_Nylon_SF2_file","0241_JCLive_sf2_file","0242_JCLive_sf2_file","0243_JCLive_sf2_file"],gm_acoustic_guitar_steel:["0253_Acoustic_Guitar_sf2_file","0250_Aspirin_sf2_file","0250_Chaos_sf2_file","0250_FluidR3_GM_sf2_file","0250_GeneralUserGS_sf2_file","0250_LK_AcousticSteel_SF2_file","0253_Acoustic_Guitar_sf2_file","0253_GeneralUserGS_sf2_file","0254_Acoustic_Guitar_sf2_file","0254_GeneralUserGS_sf2_file"],gm_electric_guitar_jazz:["0260_JCLive_sf2_file","0260_Aspirin_sf2_file","0260_Chaos_sf2_file","0260_FluidR3_GM_sf2_file","0260_GeneralUserGS_sf2_file","0260_Stratocaster_sf2_file","0261_GeneralUserGS_sf2_file","0261_Stratocaster_sf2_file","0262_Stratocaster_sf2_file"],gm_electric_guitar_clean:["0270_Aspirin_sf2_file","0270_Chaos_sf2_file","0270_FluidR3_GM_sf2_file","0270_GeneralUserGS_sf2_file","0270_SBAWE32_sf2_file","0270_Stratocaster_sf2_file","0271_GeneralUserGS_sf2_file","0271_Stratocaster_sf2_file","0272_Stratocaster_sf2_file"],gm_electric_guitar_muted:["0280_Aspirin_sf2_file","0280_Chaos_sf2_file","0280_GeneralUserGS_sf2_file","0280_JCLive_sf2_file","0280_LesPaul_sf2_file","0280_SBAWE32_sf2_file","0281_Aspirin_sf2_file","0281_FluidR3_GM_sf2_file","0281_GeneralUserGS_sf2_file","0282_FluidR3_GM_sf2_file"],gm_overdriven_guitar:["0290_FluidR3_GM_sf2_file","0290_Aspirin_sf2_file","0290_Chaos_sf2_file","0290_GeneralUserGS_sf2_file","0290_LesPaul_sf2_file","0290_SBAWE32_sf2_file","0291_LesPaul_sf2_file","0291_SBAWE32_sf2_file","0292_Aspirin_sf2_file","0292_LesPaul_sf2_file"],gm_distortion_guitar:["0300_FluidR3_GM_sf2_file","0300_Aspirin_sf2_file","0300_Chaos_sf2_file","0300_GeneralUserGS_sf2_file","0300_LesPaul_sf2_file","0302_Aspirin_sf2_file","0304_Aspirin_sf2_file"],gm_guitar_harmonics:["0310_Aspirin_sf2_file","0310_FluidR3_GM_sf2_file","0310_Chaos_sf2_file"],gm_acoustic_bass:["0320_JCLive_sf2_file","0320_FluidR3_GM_sf2_file","0320_Aspirin_sf2_file","0320_Chaos_sf2_file"],gm_electric_bass_finger:["0330_JCLive_sf2_file","0330_FluidR3_GM_sf2_fible","0330_Aspirin_sf2_file","0330_GeneralUserGS_sf2_file"],gm_electric_bass_pick:["0340_JCLive_sf2_file","0340_FluidR3_GM_sf2_file","0340_Aspirin_sf2_file","0340_GeneralUserGS_sf2_file","0341_Aspirin_sf2_file"],gm_fretless_bass:["0350_Aspirin_sf2_file","0350_JCLive_sf2_file"],gm_slap_bass_1:["0360_Aspirin_sf2_file","0360_JCLive_sf2_file","0360_FluidR3_GM_sf2_file","0360_Chaos_sf2_file"],gm_slap_bass_2:["0370_Aspirin_sf2_file","0370_FluidR3_GM_sf2_file","0370_GeneralUserGS_sf2_fil e","0370_JCLive_sf2_file"],gm_synth_bass_1:["0380_Chaos_sf2_file","0380_FluidR3_GM_sf2_file","0380_JCLive_sf2_file","0381_FluidR3_GM_sf2_file","0381_GeneralUserGS_sf2_file","0382_GeneralUserGS_sf2_file","0383_GeneralUserGS_sf2_file","0384_GeneralUserGS_sf2_file","0387_GeneralUserGS_sf2_file"],gm_synth_bass_2:["0390_Aspirin_sf2_file","0390_FluidR3_GM_sf2_file","0390_GeneralUserGS_sf2_file","0390_JCLive_sf2_file","0391_FluidR3_GM_sf2_file","0392_FluidR3_GM_sf2_file","0393_GeneralUserGS_sf2_file"],gm_violin:["0400_Aspirin_sf2_file","0400_Chaos_sf2_file","0400_JCLive_sf2_file","0400_FluidR3_GM_sf2_file","0400_GeneralUserGS_sf2_file","0401_Aspirin_sf2_file","0401_FluidR3_GM_sf2_file","0401_GeneralUserGS_sf2_file","0402_GeneralUserGS_sf2_file"],gm_viola:["0410_Aspirin_sf2_file","0410_FluidR3_GM_sf2_file","0410_GeneralUserGS_sf2_file","0410_JCLive_sf2_file","0411_FluidR3_GM_sf2_file"],gm_cello:["0420_Aspirin_sf2_file","0420_FluidR3_GM_sf2_file","0420_GeneralUserGS_sf2_file","0420_JCLive_sf2_file","0421_FluidR3_GM_sf2_file","0421_GeneralUserGS_sf2_file"],gm_contrabass:["0430_Aspirin_sf2_file","0430_Chaos_sf2_file","0430_GeneralUserGS_sf2_file"],gm_tremolo_strings:["0440_Aspirin_sf2_file","0440_Chaos_sf2_file","0440_GeneralUserGS_sf2_file","0440_JCLive_sf2_file","0441_GeneralUserGS_sf2_file","0442_GeneralUserGS_sf2_file"],gm_pizzicato_strings:["0450_Aspirin_sf2_file","0450_Chaos_sf2_file","0450_FluidR3_GM_sf2_file","0450_GeneralUserGS_sf2_file","0450_JCLive_sf2_file","0451_FluidR3_GM_sf2_file"],gm_orchestral_harp:["0460_Aspirin_sf2_file","0460_FluidR3_GM_sf2_file","0460_GeneralUserGS_sf2_file","0460_JCLive_sf2_file","0461_FluidR3_GM_sf2_file"],gm_timpani:["0470_Aspirin_sf2_file","0470_Chaos_sf2_file","0470_FluidR3_GM_sf2_file","0470_GeneralUserGS_sf2_file","0471_FluidR3_GM_sf2_file","0471_GeneralUserGS_sf2_file"],gm_string_ensemble_1:["0480_Aspirin_sf2_file","0480_Chaos_sf2_file","0480_FluidR3_GM_sf2_file","0480_GeneralUserGS_sf2_file","0480_JCLive_sf2_file","0481_Aspirin_sf2_file","0481_FluidR3_GM_sf2_file","0481_GeneralUserGS_sf2_file","0482_Aspirin_sf2_file","0482_GeneralUserGS_sf2_file","0483_GeneralUserGS_sf2_file"],gm_string_ensemble_2:["0490_Aspirin_sf2_file","0490_Chaos_sf2_file","0490_FluidR3_GM_sf2_file","0490_GeneralUserGS_sf2_file","0490_JCLive_sf2_file","0491_GeneralUserGS_sf2_file","0492_GeneralUserGS_sf2_file"],gm_synth_strings_1:["0500_Aspirin_sf2_file","0500_GeneralUserGS_sf2_file","0500_JCLive_sf2_file","0501_FluidR3_GM_sf2_file","0502_GeneralUserGS_sf2_file","0503_FluidR3_GM_sf2_file","0505_FluidR3_GM_sf2_file"],gm_synth_strings_2:["0510_Aspirin_sf2_file","0510_Chaos_sf2_file","0510_GeneralUserGS_sf2_file","0511_GeneralUserGS_sf2_file"],gm_choir_aahs:["0520_Aspirin_sf2_file","0520_Chaos_sf2_file","0520_FluidR3_GM_sf2_file","0520_GeneralUserGS_sf2_file","0520_JCLive_sf2_file","0520_Soul_Ahhs_sf2_file","0521_FluidR3_GM_sf2_file","0521_Soul_Ahhs_sf2_file","0522_Soul_Ahhs_sf2_file"],gm_voice_oohs:["0530_Aspirin_sf2_file","0530_Chaos_sf2_file","0530_FluidR3_GM_sf2_file","0530_GeneralUserGS_sf2_file","0531_FluidR3_GM_sf2_file","0531_JCLive_sf2_file"],gm_synth_choir:["0540_Aspirin_sf2_file","0540_Chaos_sf2_file","0540_FluidR3_GM_sf2_file","0540_GeneralUserGS_sf2_file","0541_FluidR3_GM_sf2_file"],gm_orchestra_hit:["0550_Aspirin_sf2_file","0550_Chaos_sf2_file","0550_FluidR3_GM_sf2_file","0550_GeneralUserGS_sf2_file","0551_FluidR3_GM_sf2_file"],gm_trumpet:["0560_FluidR3_GM_sf2_file","0560_JCLive_sf2_file","0560_Aspirin_sf2_file","0560_Chaos_sf2_file"],gm_trombone:["0570_Aspirin_sf2_file","0570_Chaos_sf2_file","0570_FluidR3_GM_sf2_file","0570_GeneralUserGS_sf2_file","0571_GeneralUserGS_sf2_file"],gm_tuba:["0580_FluidR3_GM_sf2_file","0580_Aspirin_sf2_file","0580_Chaos_sf2_file","0580_GeneralUserGS_sf2_file"],gm_muted_trumpet:["0590_JCLive_sf2_file","0590_Aspirin_sf2_file","0590_Chaos_sf2_file","0590_FluidR3_GM_sf2_file","0590_GeneralUserGS_sf2_file"],gm_french_horn:["0600_Aspirin_sf2_file","0600_FluidR3_GM_sf2_file","0600_GeneralUserGS_sf2_file","0600_JCLive_sf2_file","0601_FluidR3_GM_sf2_file"],gm_brass_section:["0610_JCLive_sf2_file","0610_Aspirin_sf2_file","0610_Chaos_sf2_file","0610_FluidR3_GM_sf2_file","0610_GeneralUserGS_sf2_file"],gm_synth_brass_1:["0620_Aspirin_sf2_file","0620_FluidR3_GM_sf2_file","0621_Aspirin_sf2_file","0621_FluidR3_GM_sf2_file"],gm_synth_brass_2:["0630_Aspirin_sf2_file","0630_Chaos_sf2_file","0630_FluidR3_GM_sf2_file","0630_JCLive_sf2_file","0631_FluidR3_GM_sf2_file","0632_FluidR3_GM_sf2_file","0633_FluidR3_GM_sf2_file"],gm_soprano_sax:["0640_JCLive_sf2_file","0640_Aspirin_sf2_file","0640_Chaos_sf2_file","0640_FluidR3_GM_sf2_file","0641_FluidR3_GM_sf2_file"],gm_alto_sax:["0650_JCLive_sf2_file","0650_Chaos_sf2_file","0650_FluidR3_GM_sf2_file","0650_GeneralUserGS_sf2_file","0651_Aspirin_sf2_file","0651_FluidR3_GM_sf2_file"],gm_tenor_sax:["0660_JCLive_sf2_file","0660_Aspirin_sf2_file","0660_Chaos_sf2_file","0660_GeneralUserGS_sf2_file"],gm_baritone_sax:["0670_JCLive_sf2_file","0670_Aspirin_sf2_file","0670_Chaos_sf2_file","0670_FluidR3_GM_sf2_file","0670_GeneralUserGS_sf2_file","0671_FluidR3_GM_sf2_file"],gm_oboe:["0680_JCLive_sf2_file","0680_Chaos_sf2_file","0680_FluidR3_GM_sf2_file","0680_GeneralUserGS_sf2_file","0681_FluidR3_GM_sf2_file"],gm_english_horn:["0690_JCLive_sf2_file","0690_Aspirin_sf2_file","0690_FluidR3_GM_sf2_file","0691_FluidR3_GM_sf2_file"],gm_bassoon:["0700_JCLive_sf2_file","0700_FluidR3_GM_sf2_file","0700_GeneralUserGS_sf2_file","0701_FluidR3_GM_sf2_file"],gm_clarinet:["0710_JCLive_sf2_file","0710_Aspirin_sf2_file","0710_Chaos_sf2_file","0710_FluidR3_GM_sf2_file","0710_GeneralUserGS_sf2_file","0711_FluidR3_GM_sf2_file"],gm_piccolo:["0720_JCLive_sf2_file","0720_Aspirin_sf2_file","0720_FluidR3_GM_sf2_file","0720_GeneralUserGS_sf2_file","0721_FluidR3_GM_sf2_file"],gm_flute:["0730_JCLive_sf2_file","0730_Aspirin_sf2_file","0730_FluidR3_GM_sf2_file","0730_GeneralUserGS_sf2_file","0731_FluidR3_GM_sf2_file"],gm_recorder:["0740_JCLive_sf2_file","0740_Aspirin_sf2_file","0740_Chaos_sf2_file","0740_FluidR3_GM_sf2_file","0740_GeneralUserGS_sf2_file"],gm_pan_flute:["0750_JCLive_sf2_file","0750_FluidR3_GM_sf2_file","0750_Aspirin_sf2_file","0750_Chaos_sf2_file","0750_GeneralUserGS_sf2_file","0751_Aspirin_sf2_file","0751_FluidR3_GM_sf2_file","0751_GeneralUserGS_sf2_file"],gm_blown_bottle:["0760_FluidR3_GM_sf2_file","0760_JCLive_sf2_file","0760_Chaos_sf2_file","0760_GeneralUserGS_sf2_file","0761_FluidR3_GM_sf2_file"],gm_shakuhachi:["0770_JCLive_sf2_file","0771_FluidR3_GM_sf2_file","0770_Aspirin_sf2_file","0770_FluidR3_GM_sf2_file","0770_GeneralUserGS_sf2_file"],gm_whistle:["0780_FluidR3_GM_sf2_file","0780_JCLive_sf2_file","0780_Aspirin_sf2_file","0780_Chaos_sf2_file"],gm_ocarina:["0790_FluidR3_GM_sf2_file","0790_JCLive_sf2_file","0790_Aspirin_sf2_file","0790_GeneralUserGS_sf2_file"],gm_lead_1_square:["0800_Aspirin_sf2_file","0800_Chaos_sf2_file","0800_FluidR3_GM_sf2_file"],gm_lead_2_sawtooth:["0810_JCLive_sf2_file","0810_Aspirin_sf2_file","0810_Chaos_sf2_file","0810_FluidR3_GM_sf2_file","0810_GeneralUserGS_sf2_file","0811_Aspirin_sf2_file","0811_GeneralUserGS_sf2_file"],gm_lead_3_calliope:["0820_JCLive_sf2_file","0820_Aspirin_sf2_file","0820_Chaos_sf2_file","0820_FluidR3_GM_sf2_file","0820_GeneralUserGS_sf2_file","0821_FluidR3_GM_sf2_file","0821_GeneralUserGS_sf2_file"],gm_lead_4_chiff:["0830_JCLive_sf2_file","0830_Aspirin_sf2_file","0830_FluidR3_GM_sf2_file","0830_GeneralUserGS_sf2_file","0831_FluidR3_GM_sf2_file","0831_GeneralUserGS_sf2_file"],gm_lead_5_charang:["0840_JCLive_sf2_file","0840_FluidR3_GM_sf2_file","0840_Aspirin_sf2_file","0840_Chaos_sf2_file","0840_GeneralUserGS_sf2_file","0841_Aspirin_sf2_file","0841_Chaos_sf2_file","0841_FluidR3_GM_sf2_file","0841_GeneralUserGS_sf2_file","0842_FluidR3_GM_sf2_file"],gm_lead_6_voice:["0850_JCLive_sf2_file","0850_Aspirin_sf2_file","0850_FluidR3_GM_sf2_file","0851_FluidR3_GM_sf2_file","0851_GeneralUserGS_sf2_file","0851_JCLive_sf2_file"],gm_lead_7_fifths:["0860_JCLive_sf2_file","0860_Aspirin_sf2_file","0860_Chaos_sf2_file","0860_GeneralUserGS_sf2_file","0861_Aspirin_sf2_file"],gm_lead_8_bass_lead:["0870_JCLive_sf2_file","0870_Aspirin_sf2_file","0870_Chaos_sf2_file","0870_FluidR3_GM_sf2_file","0870_GeneralUserGS_sf2_file"],gm_pad_new_age:["0880_JCLive_sf2_file","0880_Aspirin_sf2_file","0880_Chaos_sf2_file","0880_FluidR3_GM_sf2_file","0880_GeneralUserGS_sf2_file","0881_Aspirin_sf2_file","0881_FluidR3_GM_sf2_file","0881_GeneralUserGS_sf2_file","0882_Aspirin_sf2_file","0882_GeneralUserGS_sf2_file","0885_GeneralUserGS_sf2_file","0887_GeneralUserGS_sf2_file"],gm_pad_warm:["0890_JCLive_sf2_file","0890_Aspirin_sf2_file","0890_Chaos_sf2_file","0890_FluidR3_GM_sf2_file","0890_GeneralUserGS_sf2_file","0891_Aspirin_sf2_file","0891_FluidR3_GM_sf2_file"],gm_pad_poly:["0900_JCLive_sf2_file","0900_Chaos_sf2_file","0900_FluidR3_GM_sf2_file","0900_GeneralUserGS_sf2_file","0901_Aspirin_sf2_file","0901_FluidR3_GM_sf2_file","0901_GeneralUserGS_sf2_file"],gm_pad_choir:["0910_FluidR3_GM_sf2_file","0910_JCLive_sf2_file","0910_Aspirin_sf2_file","0910_GeneralUserGS_sf2_file","0911_GeneralUserGS_sf2_file","0911_JCLive_sf2_file"],gm_pad_bowed:["0920_JCLive_sf2_file","0920_Aspirin_sf2_file","0920_GeneralUserGS_sf2_file","0921_Aspirin_sf2_file","0921_GeneralUserGS_sf2_file"],gm_pad_metallic:["0930_Aspirin_sf2_file","0930_Chaos_sf2_file","0930_FluidR3_GM_sf2_file","0930_GeneralUserGS_sf2_file","0931_Aspirin_sf2_file","0931_FluidR3_GM_sf2_file","0931_GeneralUserGS_sf2_file"],gm_pad_halo:["0940_Chaos_sf2_file","0940_FluidR3_GM_sf2_file","0940_GeneralUserGS_sf2_file","0940_JCLive_sf2_file","0941_Aspirin_sf2_file","0941_FluidR3_GM_sf2_file","0941_GeneralUserGS_sf2_file","0941_JCLive_sf2_file"],gm_pad_sweep:["0950_Aspirin_sf2_file","0950_Chaos_sf2_file","0950_FluidR3_GM_sf2_file","0950_GeneralUserGS_sf2_file","0950_JCLive_sf2_file","0951_FluidR3_GM_sf2_file","0951_GeneralUserGS_sf2_file"],gm_fx_rain:["0960_FluidR3_GM_sf2_file","0960_Chaos_sf2_file","0960_GeneralUserGS_sf2_file","0961_Aspirin_sf2_file","0961_FluidR3_GM_sf2_file","0962_GeneralUserGS_sf2_file"],gm_fx_soundtrack:["0970_FluidR3_GM_sf2_file","0970_Aspirin_sf2_file","0970_GeneralUserGS_sf2_file","0971_FluidR3_GM_sf2_file","0971_GeneralUserGS_sf2_file"],gm_fx_crystal:["0980_Aspirin_sf2_file","0980_JCLive_sf2_file","0980_Chaos_sf2_file","0980_GeneralUserGS_sf2_file","0981_FluidR3_GM_sf2_file","0981_Aspirin_sf2_file","0981_GeneralUserGS_sf2_file","0982_GeneralUserGS_sf2_file","0983_GeneralUserGS_sf2_file","0984_GeneralUserGS_sf2_file"],gm_fx_atmosphere:["0990_JCLive_sf2_file","0990_Aspirin_sf2_file","0990_Chaos_sf2_file","0990_FluidR3_GM_sf2_file","0990_GeneralUserGS_sf2_file","0991_Aspirin_sf2_file","0991_FluidR3_GM_sf2_file","0991_GeneralUserGS_sf2_file","0991_JCLive_sf2_file","0992_FluidR3_GM_sf2_file","0992_JCLive_sf2_file","0993_JCLive_sf2_file","0994_JCLive_sf2_file"],gm_fx_brightness:["1000_JCLive_sf2_file","1000_Aspirin_sf2_file","1000_Chaos_sf2_file","1000_FluidR3_GM_sf2_file","1000_GeneralUserGS_sf2_file","1001_Aspirin_sf2_file","1001_FluidR3_GM_sf2_file","1001_GeneralUserGS_sf2_file","1001_JCLive_sf2_file","1002_Aspirin_sf2_file","1002_FluidR3_GM_sf2_file","1002_GeneralUserGS_sf2_file"],gm_fx_goblins:["1010_FluidR3_GM_sf2_file","1010_JCLive_sf2_file","1010_Aspirin_sf2_file","1010_Chaos_sf2_file","1010_GeneralUserGS_sf2_file","1011_Aspirin_sf2_file","1011_FluidR3_GM_sf2_file","1011_JCLive_sf2_file","1012_Aspirin_sf2_file"],gm_fx_echoes:["1020_FluidR3_GM_sf2_file","1020_JCLive_sf2_file","1020_Aspirin_sf2_file","1020_Chaos_sf2_file","1020_GeneralUserGS_sf2_file","1021_Aspirin_sf2_file","1021_FluidR3_GM_sf2_file","1021_GeneralUserGS_sf2_file","1021_JCLive_sf2_file","1022_GeneralUserGS_sf2_file"],gm_fx_sci_fi:["1030_FluidR3_GM_sf2_file","1030_Aspirin_sf2_file","1030_Chaos_sf2_file","1030_GeneralUserGS_sf2_file","1030_JCLive_sf2_file","1031_Aspirin_sf2_file","1031_FluidR3_GM_sf2_file","1031_GeneralUserGS_sf2_file","1032_FluidR3_GM_sf2_file"],gm_sitar:["1040_Aspirin_sf2_file","1040_FluidR3_GM_sf2_file","1040_JCLive_sf2_file","1040_Chaos_sf2_file","1040_GeneralUserGS_sf2_file","1041_FluidR3_GM_sf2_file","1041_GeneralUserGS_sf2_file"],gm_banjo:["1050_FluidR3_GM_sf2_file","1050_JCLive_sf2_file","1050_Aspirin_sf2_file","1050_Chaos_sf2_file","1050_GeneralUserGS_sf2_file","1051_GeneralUserGS_sf2_file"],gm_shamisen:["1060_JCLive_sf2_file","1060_FluidR3_GM_sf2_file","1060_Aspirin_sf2_file","1060_Chaos_sf2_file","1060_GeneralUserGS_sf2_file","1061_FluidR3_GM_sf2_file","1061_GeneralUserGS_sf2_file"],gm_koto:["1070_FluidR3_GM_sf2_file","1070_JCLive_sf2_file","1070_Aspirin_sf2_file","1070_Chaos_sf2_file","1070_GeneralUserGS_sf2_file","1071_FluidR3_GM_sf2_file","1071_GeneralUserGS_sf2_file","1072_GeneralUserGS_sf2_file","1073_GeneralUserGS_sf2_file"],gm_kalimba:["1080_JCLive_sf2_file","1080_FluidR3_GM_sf2_file","1080_Aspirin_sf2_file","1080_Chaos_sf2_file","1080_GeneralUserGS_sf2_file"],gm_bagpipe:["1090_Aspirin_sf2_file"],gm_fiddle:["1100_JCLive_sf2_file","1100_Aspirin_sf2_file","1100_Chaos_sf2_file","1100_FluidR3_GM_sf2_file","1100_GeneralUserGS_sf2_file","1101_Aspirin_sf2_file","1101_FluidR3_GM_sf2_file","1101_GeneralUserGS_sf2_file","1102_GeneralUserGS_sf2_file"],gm_shanai:["1110_Aspirin_sf2_file","1110_FluidR3_GM_sf2_file","1110_JCLive_sf2_file","1110_Chaos_sf2_file","1110_GeneralUserGS_sf2_file"],gm_tinkle_bell:["1120_Aspirin_sf2_file"],gm_agogo:["1130_JCLive_sf2_file","1130_Aspirin_sf2_file","1130_Chaos_sf2_file","1130_FluidR3_GM_sf2_file","1130_GeneralUserGS_sf2_file","1131_FluidR3_GM_sf2_file"],gm_steel_drums:["1140_FluidR3_GM_sf2_file","1140_Aspirin_sf2_file","1140_JCLive_sf2_file","1140_Chaos_sf2_file","1140_GeneralUserGS_sf2_file","1141_FluidR3_GM_sf2_file"],gm_woodblock:["1150_JCLive_sf2_file","1150_Aspirin_sf2_file","1150_Chaos_sf2_file","1150_FluidR3_GM_sf2_file","1150_GeneralUserGS_sf2_file","1151_FluidR3_GM_sf2_file","1151_GeneralUserGS_sf2_file","1152_FluidR3_GM_sf2_file","1152_GeneralUserGS_sf2_file"],gm_taiko_drum:["1160_JCLive_sf2_file","1160_FluidR3_GM_sf2_file","1160_Aspirin_sf2_file","1160_Chaos_sf2_file","1160_GeneralUserGS_sf2_file","1161_FluidR3_GM_sf2_file","1161_GeneralUserGS_sf2_file","1162_FluidR3_GM_sf2_file","1162_GeneralUserGS_sf2_file","1163_FluidR3_GM_sf2_file"],gm_melodic_tom:["1170_JCLive_sf2_file","1170_Aspirin_sf2_file","1170_Chaos_sf2_file","1170_FluidR3_GM_sf2_file","1170_GeneralUserGS_sf2_file","1171_FluidR3_GM_sf2_file","1171_GeneralUserGS_sf2_file","1172_FluidR3_GM_sf2_file","1173_FluidR3_GM_sf2_file"],gm_synth_drum:["1180_JCLive_sf2_file","1180_Aspirin_sf2_file","1180_Chaos_sf2_file","1180_FluidR3_GM_sf2_file","1180_GeneralUserGS_sf2_file","1181_FluidR3_GM_sf2_file","1181_GeneralUserGS_sf2_file"],gm_reverse_cymbal:["1190_JCLive_sf2_file","1190_Aspirin_sf2_file","1190_Chaos_sf2_file","1190_FluidR3_GM_sf2_file","1190_GeneralUserGS_sf2_file","1191_GeneralUserGS_sf2_file","1192_GeneralUserGS_sf2_file","1193_GeneralUserGS_sf2_file","1194_GeneralUserGS_sf2_file"],gm_guitar_fret_noise:["1200_JCLive_sf2_file","1200_Aspirin_sf2_file","1200_Chaos_sf2_file","1200_FluidR3_GM_sf2_file","1200_GeneralUserGS_sf2_file","1201_Aspirin_sf2_file","1201_GeneralUserGS_sf2_file","1202_GeneralUserGS_sf2_file"],gm_breath_noise:["1210_FluidR3_GM_sf2_file","1210_JCLive_sf2_file","1210_Aspirin_sf2_file","1210_Chaos_sf2_file","1210_GeneralUserGS_sf2_file","1211_Aspirin_sf2_file","1211_GeneralUserGS_sf2_file","1212_GeneralUserGS_sf2_file"],gm_seashore:["1220_JCLive_sf2_file","1220_Aspirin_sf2_file","1220_Chaos_sf2_file","1220_FluidR3_GM_sf2_file","1220_GeneralUserGS_sf2_file","1221_Aspirin_sf2_file","1221_GeneralUserGS_sf2_file","1221_JCLive_sf2_file","1222_Aspirin_sf2_file","1222_GeneralUserGS_sf2_file","1223_Aspirin_sf2_file","1223_GeneralUserGS_sf2_file","1224_Aspirin_sf2_file","1224_GeneralUserGS_sf2_file","1225_GeneralUserGS_sf2_file","1226_GeneralUserGS_sf2_file"],gm_bird_tweet:["1230_FluidR3_GM_sf2_file","1230_JCLive_sf2_file","1230_Aspirin_sf2_file","1230_GeneralUserGS_sf2_file","1231_GeneralUserGS_sf2_file","1232_GeneralUserGS_sf2_file","1234_GeneralUserGS_sf2_file"],gm_telephone:["1240_JCLive_sf2_file","1240_Aspirin_sf2_file","1240_Chaos_sf2_file","1240_FluidR3_GM_sf2_file","1241_Aspirin_sf2_file","1242_GeneralUserGS_sf2_file","1243_Aspirin_sf2_file","1243_GeneralUserGS_sf2_file","1244_Aspirin_sf2_file","1244_GeneralUserGS_sf2_file"],gm_helicopter:["1250_JCLive_sf2_file","1250_Aspirin_sf2_file","1250_FluidR3_GM_sf2_file","1250_GeneralUserGS_sf2_file","1251_FluidR3_GM_sf2_file","1251_GeneralUserGS_sf2_file","1252_Aspirin_sf2_file","1252_FluidR3_GM_sf2_file","1252_GeneralUserGS_sf2_file","1253_GeneralUserGS_sf2_file","1254_GeneralUserGS_sf2_file","1255_GeneralUserGS_sf2_file","1256_GeneralUserGS_sf2_file","1257_GeneralUserGS_sf2_file","1258_GeneralUserGS_sf2_file","1259_GeneralUserGS_sf2_file"],gm_applause:["1260_JCLive_sf2_file","1260_Aspirin_sf2_file","1260_Chaos_sf2_file","1260_FluidR3_GM_sf2_file","1260_GeneralUserGS_sf2_file","1261_Aspirin_sf2_file","1261_GeneralUserGS_sf2_file","1262_Aspirin_sf2_file","1262_GeneralUserGS_sf2_file","1263_Aspirin_sf2_file","1263_GeneralUserGS_sf2_file","1264_Aspirin_sf2_file","1264_GeneralUserGS_sf2_file","1265_Aspirin_sf2_file","1265_GeneralUserGS_sf2_file"],gm_gunshot:["1270_JCLive_sf2_file","1270_Aspirin_sf2_file","1270_Chaos_sf2_file","1270_FluidR3_GM_sf2_file","1270_GeneralUserGS_sf2_file","1271_Aspirin_sf2_file","1271_GeneralUserGS_sf2_file","1272_Aspirin_sf2_file","1272_GeneralUserGS_sf2_file","1273_GeneralUserGS_sf2_file","1274_GeneralUserGS_sf2_file",""]};let defaultSoundfontUrl="https://felixroos.github.io/webaudiofontdata/sound",soundfontUrl=defaultSoundfontUrl,loadCache={};async function loadFont(name){if(loadCache[name])return loadCache[name];const load=async()=>{const url=`${soundfontUrl}/${name}.js`,preset=await fetch(url).then(o=>o.text());let[_,data]=preset.split("={");return eval("{"+data)};return loadCache[name]=load(),loadCache[name]}async function getFontBufferSource(o,e,a){let{note:l="c3",freq:u}=e,p;if(u)p=freqToMidi$2(u);else if(typeof l=="string")p=noteToMidi$1(l);else if(typeof l=="number")p=l;else throw new Error(`unexpected "note" type "${typeof l}"`);const{buffer:d,zone:f}=await getFontPitch(o,p,a),g=a.createBufferSource();g.buffer=d;const b=f.originalPitch-100*f.coarseTune-f.fineTune,A=1*Math.pow(2,(100*p-b)/1200);return g.playbackRate.value=A,f.loopStart>1&&f.loopStart<f.loopEnd&&(g.loop=!0,g.loopStart=f.loopStart/f.sampleRate,g.loopEnd=f.loopEnd/f.sampleRate),g}let bufferCache={};async function getFontPitch(o,e,a){const l=`${o}:::${e}`;if(bufferCache[l])return bufferCache[l];const u=async()=>{const p=await loadFont(o);if(!p)throw new Error(`Could not load soundfont ${o}`);const d=findZone(p,e);if(!d)throw new Error("no soundfont zone found for preset ",o,"pitch",e);const f=await getBuffer(d,a);if(!f)throw new Error(`no soundfont buffer found for preset ${o}, pitch: ${e}`);return{buffer:f,zone:d}};return bufferCache[l]=u(),bufferCache[l]}function findZone(o,e){return o.find(a=>a.keyRangeLow<=e&&a.keyRangeHigh+1>=e)}async function getBuffer(o,e){if(o.sample){console.warn("zone.sample untested!");const l=atob(o.sample);o.buffer=e.createBuffer(1,l.length/2,o.sampleRate);const u=o.buffer.getChannelData(0);let p,d,f;for(var a=0;a<l.length/2;a++)p=l.charCodeAt(a*2),d=l.charCodeAt(a*2+1),p<0&&(p=256+p),d<0&&(d=256+d),f=d*256+p,f>=65536/2&&(f=f-65536),u[a]=f/65536}else if(o.file){const l=o.file.length,u=new ArrayBuffer(l),p=new Uint8Array(u),d=atob(o.file);let f;for(let g=0;g<d.length;g++)f=d.charCodeAt(g),p[g]=f;return new Promise(g=>e.decodeAudioData(u,g))}}function registerSoundfonts$1(){Object.entries(gm).forEach(([o,e])=>{registerSound(o,async(a,l,u)=>{const[p,d,f,g]=getADSRValues([l.attack,l.decay,l.sustain,l.release]),{duration:b}=l,A=getSoundIndex$1(l.n,e.length),S=e[A],M=getAudioContext(),E=await getFontBufferSource(S,l,M);E.start(a);const F=M.createGain(),$=E.connect(F),Z=a+b;getParamADSR($.gain,p,d,f,g,0,.3,a,Z,"linear");let V=Z+g+.01,K=getVibratoOscillator(E.detune,l,a);getPitchEnvelope(E.detune,l,a,Z),E.stop(V);const se=z=>{};return E.onended=()=>{E.disconnect(),K?.stop(),$.disconnect(),u()},{node:$,stop:se}},{type:"soundfont",prebake:!0,fonts:e})})}var SoundFont2={exports:{}},hasRequiredSoundFont2;function requireSoundFont2(){return hasRequiredSoundFont2||(hasRequiredSoundFont2=1,(function(o,e){(function(a,l){o.exports=l()})(window,function(){return(function(a){var l={};function u(p){if(l[p])return l[p].exports;var d=l[p]={i:p,l:!1,exports:{}};return a[p].call(d.exports,d,d.exports,u),d.l=!0,d.exports}return u.m=a,u.c=l,u.d=function(p,d,f){u.o(p,d)||Object.defineProperty(p,d,{enumerable:!0,get:f})},u.r=function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},u.t=function(p,d){if(1&d&&(p=u(p)),8&d||4&d&&typeof p=="object"&&p&&p.__esModule)return p;var f=Object.create(null);if(u.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:p}),2&d&&typeof p!="string")for(var g in p)u.d(f,g,function(b){return p[b]}.bind(null,g));return f},u.n=function(p){var d=p&&p.__esModule?function(){return p.default}:function(){return p};return u.d(d,"a",d),d},u.o=function(p,d){return Object.prototype.hasOwnProperty.call(p,d)},u.p="",u(u.s="./src/index.ts")})({"./src/chunk.ts":function(a,l,u){u.r(l),u.d(l,"SF2Chunk",function(){return E});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=u("./src/chunks/index.ts");function g(F){return(g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(F)}function b(F,$){for(var Z=0;Z<$.length;Z++){var V=$[Z];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(F,V.key,V)}}function A(F){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})(F)}function S(F,$){return(S=Object.setPrototypeOf||function(Z,V){return Z.__proto__=V,Z})(F,$)}function M(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}var E=(function(F){function $(K){var se,z,U,ee,ae,de;return(function(ke,Oe){if(!(ke instanceof Oe))throw new TypeError("Cannot call a class as a function")})(this,$),z=this,se=!(U=A($).call(this,K.id,K.length,K.buffer,K.subChunks))||g(U)!=="object"&&typeof U!="function"?M(z):U,ee=M(M(se)),de=void 0,(ae="subChunks")in ee?Object.defineProperty(ee,ae,{value:de,enumerable:!0,configurable:!0,writable:!0}):ee[ae]=de,se.subChunks=K.subChunks.map(function(ke){return new $(ke)}),se}var Z,V;return(function(K,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(se&&se.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),se&&S(K,se)})($,p.RIFFChunk),Z=$,(V=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var K=this.subChunks.reduce(function(se,z){if(z.id==="ifil"||z.id==="iver"){if(z.length!==d.SF_VERSION_LENGTH)throw new p.ParseError("Invalid size for the '".concat(z.id,"' sub-chunk"));se[z.id]="".concat(z.getInt16(),".").concat(z.getInt16(2))}else se[z.id]=z.getString();return se},{});if(!K.ifil)throw new p.ParseError("Missing required 'ifil' sub-chunk");if(!K.INAM)throw new p.ParseError("Missing required 'INAM' sub-chunk");return{version:K.ifil,soundEngine:K.isng||"EMU8000",name:K.INAM,rom:K.irom,romVersion:K.iver,creationDate:K.ICRD,author:K.IENG,product:K.IPRD,copyright:K.ICOP,comments:K.ICMT,createdBy:K.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var K=this.subChunks[0];if(K.id!=="smpl")throw new p.ParseError("Invalid chunk signature","'smpl'","'".concat(K.id,"'"));return K.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new p.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(f.getPresetHeaders)(this.subChunks[0]),presetZones:Object(f.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(f.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(f.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(f.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(f.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(f.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(f.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(f.getSampleHeaders)(this.subChunks[8])}}}])&&b(Z.prototype,V),$})()},"./src/chunks/generators.ts":function(a,l,u){u.r(l),u.d(l,"getGenerators",function(){return S});var p=u("./src/riff/index.ts"),d=u("./src/types/index.ts"),f=u("./src/constants.ts"),g=[d.GeneratorType.StartAddrsOffset,d.GeneratorType.EndAddrsOffset,d.GeneratorType.StartLoopAddrsOffset,d.GeneratorType.EndLoopAddrsOffset,d.GeneratorType.StartAddrsCoarseOffset,d.GeneratorType.EndAddrsCoarseOffset,d.GeneratorType.StartLoopAddrsCoarseOffset,d.GeneratorType.KeyNum,d.GeneratorType.Velocity,d.GeneratorType.EndLoopAddrsCoarseOffset,d.GeneratorType.SampleModes,d.GeneratorType.ExclusiveClass,d.GeneratorType.OverridingRootKey],b=[d.GeneratorType.Unused1,d.GeneratorType.Unused2,d.GeneratorType.Unused3,d.GeneratorType.Unused4,d.GeneratorType.Reserved1,d.GeneratorType.Reserved2,d.GeneratorType.Reserved3],A=[d.GeneratorType.KeyRange,d.GeneratorType.VelRange],S=function(M,E){if(M.id!==E)throw new p.ParseError("Unexpected chunk ID","'".concat(E,"'"),"'".concat(M.id,"'"));if(M.length%f.SF_GENERATOR_SIZE)throw new p.ParseError("Invalid size for the '".concat(E,"' sub-chunk"));return M.iterate(function(F){var $=F.getInt16();return d.GeneratorType[$]?E==="pgen"&&g.includes($)||E==="igen"&&b.includes($)?null:A.includes($)?{id:$,range:{lo:F.getByte(),hi:F.getByte()}}:{id:$,value:F.getInt16BE()}:null})}},"./src/chunks/index.ts":function(a,l,u){u.r(l);var p=u("./src/chunks/instruments/index.ts");u.d(l,"getInstrumentHeaders",function(){return p.getInstrumentHeaders});var d=u("./src/chunks/presets/index.ts");u.d(l,"getPresetHeaders",function(){return d.getPresetHeaders});var f=u("./src/chunks/samples/index.ts");u.d(l,"getSampleHeaders",function(){return f.getSampleHeaders});var g=u("./src/chunks/generators.ts");u.d(l,"getGenerators",function(){return g.getGenerators});var b=u("./src/chunks/modulators.ts");u.d(l,"getModulators",function(){return b.getModulators});var A=u("./src/chunks/zones.ts");u.d(l,"getZones",function(){return A.getZones}),u.d(l,"getItemsInZone",function(){return A.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(a,l,u){u.r(l),u.d(l,"getInstrumentHeaders",function(){return f});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=function(g){if(g.id!=="inst")throw new p.ParseError("Unexpected chunk ID","'inst'","'".concat(g.id,"'"));if(g.length%d.SF_INSTRUMENT_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'inst' sub-chunk");return g.iterate(function(b){return{name:b.getString(),bagIndex:b.getInt16()}})}},"./src/chunks/instruments/index.ts":function(a,l,u){u.r(l);var p=u("./src/chunks/instruments/headers.ts");u.d(l,"getInstrumentHeaders",function(){return p.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(a,l,u){u.r(l),u.d(l,"getModulators",function(){return g});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=function(b){return{type:b>>10&63,polarity:b>>9&1,direction:b>>8&1,palette:b>>7&1,index:127&b}},g=function(b,A){if(b.id!==A)throw new p.ParseError("Unexpected chunk ID","'".concat(A,"'"),"'".concat(b.id,"'"));if(b.length%d.SF_MODULATOR_SIZE)throw new p.ParseError("Invalid size for the '".concat(A,"' sub-chunk"));return b.iterate(function(S){return{source:f(S.getInt16BE()),id:S.getInt16BE(),value:S.getInt16BE(),valueSource:f(S.getInt16BE()),transform:S.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(a,l,u){u.r(l),u.d(l,"getPresetHeaders",function(){return f});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=function(g){if(g.id!=="phdr")throw new p.ParseError("Invalid chunk ID","'phdr'","'".concat(g.id,"'"));if(g.length%d.SF_PRESET_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'phdr' sub-chunk");return g.iterate(function(b){return{name:b.getString(),preset:b.getInt16(),bank:b.getInt16(),bagIndex:b.getInt16(),library:b.getUInt32(),genre:b.getUInt32(),morphology:b.getUInt32()}})}},"./src/chunks/presets/index.ts":function(a,l,u){u.r(l);var p=u("./src/chunks/presets/headers.ts");u.d(l,"getPresetHeaders",function(){return p.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(a,l,u){u.r(l),u.d(l,"getSampleHeaders",function(){return f});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=function(g){if(g.id!=="shdr")throw new p.ParseError("Unexpected chunk ID","'shdr'","'".concat(g.id,"'"));if(g.length%d.SF_SAMPLE_HEADER_SIZE)throw new p.ParseError("Invalid size for the 'shdr' sub-chunk");return g.iterate(function(b){return{name:b.getString(),start:b.getUInt32(),end:b.getUInt32(),startLoop:b.getUInt32(),endLoop:b.getUInt32(),sampleRate:b.getUInt32(),originalPitch:b.getByte(),pitchCorrection:b.getChar(),link:b.getInt16(),type:b.getInt16()}})}},"./src/chunks/samples/index.ts":function(a,l,u){u.r(l);var p=u("./src/chunks/samples/headers.ts");u.d(l,"getSampleHeaders",function(){return p.getSampleHeaders})},"./src/chunks/zones.ts":function(a,l,u){u.r(l),u.d(l,"getZones",function(){return g}),u.d(l,"getItemsInZone",function(){return b});var p=u("./src/riff/index.ts"),d=u("./src/constants.ts"),f=u("./src/types/index.ts"),g=function(E,F){if(E.id!==F)throw new p.ParseError("Unexpected chunk ID","'".concat(F,"'"),"'".concat(E.id,"'"));if(E.length%d.SF_BAG_SIZE)throw new p.ParseError("Invalid size for the '".concat(F,"' sub-chunk"));return E.iterate(function($){return{generatorIndex:$.getInt16(),modulatorIndex:$.getInt16()}})},b=function(E,F,$,Z,V,K){for(var se=[],z=0;z<E.length;z++){for(var U=E[z],ee=E[z+1],ae=U.bagIndex,de=ee?ee.bagIndex:F.length,ke=[],Oe=void 0,De=ae;De<de;De++){var Ae=A(De,F,$),Pe=S(De,F,Z),We=Pe[f.GeneratorType.KeyRange]&&Pe[f.GeneratorType.KeyRange].range,qe=Pe[K];if(qe){var at=V[qe.value];at&&ke.push({keyRange:We,modulators:Ae,generators:Pe,reference:at})}else De-ae==0&&(Oe={keyRange:We,modulators:Ae,generators:Pe})}se.push({header:U,globalZone:Oe,zones:ke})}return se},A=function(E,F,$){var Z=F[E],V=F[E+1],K=Z.modulatorIndex,se=V?V.modulatorIndex:F.length;return M(K,se,$)},S=function(E,F,$){var Z=F[E],V=F[E+1],K=Z.generatorIndex,se=V?V.generatorIndex:F.length;return M(K,se,$)},M=function(E,F,$){for(var Z={},V=E;V<F;V++){var K=$[V];K&&(Z[K.id]=K)}return Z}},"./src/constants.ts":function(a,l,u){u.r(l),u.d(l,"SF_VERSION_LENGTH",function(){return p}),u.d(l,"SF_PRESET_HEADER_SIZE",function(){return d}),u.d(l,"SF_BAG_SIZE",function(){return f}),u.d(l,"SF_MODULATOR_SIZE",function(){return g}),u.d(l,"SF_GENERATOR_SIZE",function(){return b}),u.d(l,"SF_INSTRUMENT_HEADER_SIZE",function(){return A}),u.d(l,"SF_SAMPLE_HEADER_SIZE",function(){return S}),u.d(l,"DEFAULT_SAMPLE_RATE",function(){return M});var p=4,d=38,f=4,g=10,b=4,A=22,S=46,M=22050},"./src/index.ts":function(a,l,u){u.r(l);var p=u("./src/types/index.ts");for(var d in p)d!=="default"&&(function(A){u.d(l,A,function(){return p[A]})})(d);var f=u("./src/chunk.ts");u.d(l,"SF2Chunk",function(){return f.SF2Chunk});var g=u("./src/constants.ts");u.d(l,"SF_VERSION_LENGTH",function(){return g.SF_VERSION_LENGTH}),u.d(l,"SF_PRESET_HEADER_SIZE",function(){return g.SF_PRESET_HEADER_SIZE}),u.d(l,"SF_BAG_SIZE",function(){return g.SF_BAG_SIZE}),u.d(l,"SF_MODULATOR_SIZE",function(){return g.SF_MODULATOR_SIZE}),u.d(l,"SF_GENERATOR_SIZE",function(){return g.SF_GENERATOR_SIZE}),u.d(l,"SF_INSTRUMENT_HEADER_SIZE",function(){return g.SF_INSTRUMENT_HEADER_SIZE}),u.d(l,"SF_SAMPLE_HEADER_SIZE",function(){return g.SF_SAMPLE_HEADER_SIZE}),u.d(l,"DEFAULT_SAMPLE_RATE",function(){return g.DEFAULT_SAMPLE_RATE});var b=u("./src/soundFont2.ts");u.d(l,"SoundFont2",function(){return b.SoundFont2})},"./src/riff/chunkIterator.ts":function(a,l,u){u.r(l),u.d(l,"ChunkIterator",function(){return g});var p=u("./src/utils/index.ts");function d(b,A){for(var S=0;S<A.length;S++){var M=A[S];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(b,M.key,M)}}function f(b,A,S){return A in b?Object.defineProperty(b,A,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[A]=S,b}var g=(function(){function b(M){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;(function(F,$){if(!(F instanceof $))throw new TypeError("Cannot call a class as a function")})(this,b),f(this,"target",[]),f(this,"chunk",void 0),f(this,"position",0),this.chunk=M,this.position=E}var A,S;return A=b,(S=[{key:"iterate",value:function(M){for(;this.position<this.chunk.length;){var E=M(this);E&&this.target.push(E)}}},{key:"getString",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,E=Object(p.getStringFromBuffer)(this.getBuffer(this.position,M));return this.position+=M,E}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(M){this.position+=M}},{key:"getBuffer",value:function(M,E){return this.chunk.buffer.subarray(M,M+E)}},{key:"currentPosition",get:function(){return this.position}}])&&d(A.prototype,S),b})()},"./src/riff/index.ts":function(a,l,u){u.r(l);var p=u("./src/riff/chunkIterator.ts");u.d(l,"ChunkIterator",function(){return p.ChunkIterator});var d=u("./src/riff/parseError.ts");u.d(l,"ParseError",function(){return d.ParseError});var f=u("./src/riff/parser.ts");u.d(l,"parseBuffer",function(){return f.parseBuffer}),u.d(l,"getChunk",function(){return f.getChunk}),u.d(l,"getChunkLength",function(){return f.getChunkLength}),u.d(l,"getSubChunks",function(){return f.getSubChunks}),u.d(l,"getChunkId",function(){return f.getChunkId});var g=u("./src/riff/riffChunk.ts");u.d(l,"RIFFChunk",function(){return g.RIFFChunk})},"./src/riff/parseError.ts":function(a,l,u){function p(M){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E})(M)}function d(M,E){return!E||p(E)!=="object"&&typeof E!="function"?(function(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F})(M):E}function f(M){var E=typeof Map=="function"?new Map:void 0;return(f=function(F){if(F===null||($=F,Function.toString.call($).indexOf("[native code]")===-1))return F;var $;if(typeof F!="function")throw new TypeError("Super expression must either be null or a function");if(E!==void 0){if(E.has(F))return E.get(F);E.set(F,Z)}function Z(){return g(F,arguments,A(this).constructor)}return Z.prototype=Object.create(F.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),b(Z,F)})(M)}function g(M,E,F){return(g=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}})()?Reflect.construct:function($,Z,V){var K=[null];K.push.apply(K,Z);var se=new(Function.bind.apply($,K));return V&&b(se,V.prototype),se}).apply(null,arguments)}function b(M,E){return(b=Object.setPrototypeOf||function(F,$){return F.__proto__=$,F})(M,E)}function A(M){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)})(M)}u.r(l),u.d(l,"ParseError",function(){return S});var S=(function(M){function E(F,$,Z){return(function(V,K){if(!(V instanceof K))throw new TypeError("Cannot call a class as a function")})(this,E),d(this,A(E).call(this,"".concat(F).concat($&&Z?", expected ".concat($,", received ").concat(Z):"")))}return(function(F,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create($&&$.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),$&&b(F,$)})(E,f(Error)),E})()},"./src/riff/parser.ts":function(a,l,u){u.r(l),u.d(l,"parseBuffer",function(){return g}),u.d(l,"getChunk",function(){return b}),u.d(l,"getChunkLength",function(){return A}),u.d(l,"getSubChunks",function(){return S}),u.d(l,"getChunkId",function(){return M});var p=u("./src/riff/parseError.ts"),d=u("./src/utils/buffer.ts"),f=u("./src/riff/riffChunk.ts"),g=function(E){var F=M(E);if(F!=="RIFF")throw new p.ParseError("Invalid file format","RIFF",F);var $=M(E,8);if($!=="sfbk")throw new p.ParseError("Invalid signature","sfbk",$);var Z=E.subarray(8),V=S(Z.subarray(4));return new f.RIFFChunk(F,Z.length,Z,V)},b=function(E,F){var $=M(E,F),Z=A(E,F+4),V=[];return $!=="RIFF"&&$!=="LIST"||(V=S(E.subarray(F+12))),new f.RIFFChunk($,Z,E.subarray(F+8),V)},A=function(E,F){return((E=E.subarray(F,F+4))[0]|E[1]<<8|E[2]<<16|E[3]<<24)>>>0},S=function(E){for(var F=[],$=0;$<=E.length-8;){var Z=b(E,$);F.push(Z),$=($+=8+Z.length)%2?$+1:$}return F},M=function(E){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(d.getStringFromBuffer)(E.subarray(F,F+4))}},"./src/riff/riffChunk.ts":function(a,l,u){u.r(l),u.d(l,"RIFFChunk",function(){return b});var p=u("./src/riff/chunkIterator.ts"),d=u("./src/utils/index.ts");function f(A,S){for(var M=0;M<S.length;M++){var E=S[M];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(A,E.key,E)}}function g(A,S,M){return S in A?Object.defineProperty(A,S,{value:M,enumerable:!0,configurable:!0,writable:!0}):A[S]=M,A}var b=(function(){function A(E,F,$,Z){(function(V,K){if(!(V instanceof K))throw new TypeError("Cannot call a class as a function")})(this,A),g(this,"id",void 0),g(this,"length",void 0),g(this,"buffer",void 0),g(this,"subChunks",void 0),this.id=E,this.length=F,this.buffer=$,this.subChunks=Z}var S,M;return S=A,(M=[{key:"getString",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,F=arguments.length>1?arguments[1]:void 0;return Object(d.getStringFromBuffer)(this.getBuffer(E,F||this.length-E))}},{key:"getInt16",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[E++]|this.buffer[E]<<8}},{key:"getUInt32",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[E++]|this.buffer[E++]<<8|this.buffer[E++]<<16|this.buffer[E]<<24)>>>0}},{key:"getByte",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[E]}},{key:"getChar",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[E]<<24>>24}},{key:"iterator",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new p.ChunkIterator(this,E)}},{key:"iterate",value:function(E){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=new p.ChunkIterator(this,F);return $.iterate(E),$.target}},{key:"getBuffer",value:function(E,F){return this.buffer.subarray(E,E+F)}}])&&f(S.prototype,M),A})()},"./src/soundFont2.ts":function(a,l,u){u.r(l),u.d(l,"SoundFont2",function(){return F});var p=u("./src/types/index.ts"),d=u("./src/chunk.ts"),f=u("./src/riff/index.ts"),g=u("./src/chunks/index.ts"),b=u("./src/utils/index.ts");function A($){for(var Z=1;Z<arguments.length;Z++){var V=arguments[Z]!=null?arguments[Z]:{},K=Object.keys(V);typeof Object.getOwnPropertySymbols=="function"&&(K=K.concat(Object.getOwnPropertySymbols(V).filter(function(se){return Object.getOwnPropertyDescriptor(V,se).enumerable}))),K.forEach(function(se){E($,se,V[se])})}return $}function S($,Z){for(var V=0;V<Z.length;V++){var K=Z[V];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty($,K.key,K)}}function M($,Z,V){return Z&&S($.prototype,Z),V&&S($,V),$}function E($,Z,V){return Z in $?Object.defineProperty($,Z,{value:V,enumerable:!0,configurable:!0,writable:!0}):$[Z]=V,$}var F=(function(){function $(Z){if((function(K,se){if(!(K instanceof se))throw new TypeError("Cannot call a class as a function")})(this,$),E(this,"chunk",void 0),E(this,"metaData",void 0),E(this,"sampleData",void 0),E(this,"samples",void 0),E(this,"presetData",void 0),E(this,"instruments",void 0),E(this,"presets",void 0),E(this,"banks",void 0),!(Z instanceof d.SF2Chunk)){var V=Object(f.parseBuffer)(Z);Z=new d.SF2Chunk(V)}if(Z.subChunks.length!==3)throw new f.ParseError("Invalid sfbk structure","3 chunks","".concat(Z.subChunks.length," chunks"));this.chunk=Z,this.metaData=Z.subChunks[0].getMetaData(),this.sampleData=Z.subChunks[1].getSampleData(),this.presetData=Z.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return M($,null,[{key:"from",value:function(Z){return new $(Z)}}]),M($,[{key:"getKeyData",value:function(Z){var V=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(b.memoize)(function(z,U,ee){var ae=V.banks[U];if(ae){var de=ae.presets[ee];if(de){var ke=de.zones.find(function(qe){return V.isKeyInRange(qe,z)});if(ke){var Oe=ke.instrument,De=Oe.zones.find(function(qe){return V.isKeyInRange(qe,z)});if(De){var Ae=De.sample,Pe=A({},ke.generators,De.generators),We=A({},ke.modulators,De.modulators);return{keyNumber:z,preset:de,instrument:Oe,sample:Ae,generators:Pe,modulators:We}}}}}return null})(Z,K,se)}},{key:"isKeyInRange",value:function(Z,V){return Z.keyRange===void 0||Z.keyRange.lo<=V&&Z.keyRange.hi>=V}},{key:"getBanks",value:function(){return this.presets.reduce(function(Z,V){var K=V.header.bank;return Z[K]||(Z[K]={presets:[]}),Z[K].presets[V.header.preset]=V,Z},[])}},{key:"getPresets",value:function(){var Z=this.presetData,V=Z.presetHeaders,K=Z.presetZones,se=Z.presetGenerators,z=Z.presetModulators;return Object(g.getItemsInZone)(V,K,z,se,this.instruments,p.GeneratorType.Instrument).filter(function(U){return U.header.name!=="EOP"}).map(function(U){return{header:U.header,globalZone:U.globalZone,zones:U.zones.map(function(ee){return{keyRange:ee.keyRange,generators:ee.generators,modulators:ee.modulators,instrument:ee.reference}})}})}},{key:"getInstruments",value:function(){var Z=this.presetData,V=Z.instrumentHeaders,K=Z.instrumentZones,se=Z.instrumentModulators,z=Z.instrumentGenerators;return Object(g.getItemsInZone)(V,K,se,z,this.samples,p.GeneratorType.SampleId).filter(function(U){return U.header.name!=="EOI"}).map(function(U){return{header:U.header,globalZone:U.globalZone,zones:U.zones.map(function(ee){return{keyRange:ee.keyRange,generators:ee.generators,modulators:ee.modulators,sample:ee.reference}})}})}},{key:"getSamples",value:function(){var Z=this;return this.presetData.sampleHeaders.filter(function(V){return V.name!=="EOS"}).map(function(V){if(V.name!=="EOS"&&V.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(V.sampleRate," hz in sample '").concat(V.name,"'"));return V.originalPitch>=128&&V.originalPitch<=254&&(V.originalPitch=60),V.startLoop-=V.start,V.endLoop-=V.start,{header:V,data:new Int16Array(new Uint8Array(Z.sampleData.subarray(2*V.start,2*V.end)).buffer)}})}}]),$})()},"./src/types/bank.ts":function(a,l){},"./src/types/generator.ts":function(a,l,u){var p,d;function f(b,A,S){return A in b?Object.defineProperty(b,A,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[A]=S,b}u.r(l),u.d(l,"GeneratorType",function(){return d}),u.d(l,"DEFAULT_GENERATOR_VALUES",function(){return g}),(function(b){b[b.StartAddrsOffset=0]="StartAddrsOffset",b[b.EndAddrsOffset=1]="EndAddrsOffset",b[b.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",b[b.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",b[b.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",b[b.ModLFOToPitch=5]="ModLFOToPitch",b[b.VibLFOToPitch=6]="VibLFOToPitch",b[b.ModEnvToPitch=7]="ModEnvToPitch",b[b.InitialFilterFc=8]="InitialFilterFc",b[b.InitialFilterQ=9]="InitialFilterQ",b[b.ModLFOToFilterFc=10]="ModLFOToFilterFc",b[b.ModEnvToFilterFc=11]="ModEnvToFilterFc",b[b.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",b[b.ModLFOToVolume=13]="ModLFOToVolume",b[b.Unused1=14]="Unused1",b[b.ChorusEffectsSend=15]="ChorusEffectsSend",b[b.ReverbEffectsSend=16]="ReverbEffectsSend",b[b.Pan=17]="Pan",b[b.Unused2=18]="Unused2",b[b.Unused3=19]="Unused3",b[b.Unused4=20]="Unused4",b[b.DelayModLFO=21]="DelayModLFO",b[b.FreqModLFO=22]="FreqModLFO",b[b.DelayVibLFO=23]="DelayVibLFO",b[b.FreqVibLFO=24]="FreqVibLFO",b[b.DelayModEnv=25]="DelayModEnv",b[b.AttackModEnv=26]="AttackModEnv",b[b.HoldModEnv=27]="HoldModEnv",b[b.DecayModEnv=28]="DecayModEnv",b[b.SustainModEnv=29]="SustainModEnv",b[b.ReleaseModEnv=30]="ReleaseModEnv",b[b.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",b[b.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",b[b.DelayVolEnv=33]="DelayVolEnv",b[b.AttackVolEnv=34]="AttackVolEnv",b[b.HoldVolEnv=35]="HoldVolEnv",b[b.DecayVolEnv=36]="DecayVolEnv",b[b.SustainVolEnv=37]="SustainVolEnv",b[b.ReleaseVolEnv=38]="ReleaseVolEnv",b[b.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",b[b.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",b[b.Instrument=41]="Instrument",b[b.Reserved1=42]="Reserved1",b[b.KeyRange=43]="KeyRange",b[b.VelRange=44]="VelRange",b[b.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",b[b.KeyNum=46]="KeyNum",b[b.Velocity=47]="Velocity",b[b.InitialAttenuation=48]="InitialAttenuation",b[b.Reserved2=49]="Reserved2",b[b.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",b[b.CoarseTune=51]="CoarseTune",b[b.FineTune=52]="FineTune",b[b.SampleId=53]="SampleId",b[b.SampleModes=54]="SampleModes",b[b.Reserved3=55]="Reserved3",b[b.ScaleTuning=56]="ScaleTuning",b[b.ExclusiveClass=57]="ExclusiveClass",b[b.OverridingRootKey=58]="OverridingRootKey",b[b.Unused5=59]="Unused5",b[b.EndOper=60]="EndOper"})(d||(d={}));var g=(f(p={},d.StartAddrsOffset,0),f(p,d.EndAddrsOffset,0),f(p,d.StartLoopAddrsOffset,0),f(p,d.EndLoopAddrsOffset,0),f(p,d.StartAddrsCoarseOffset,0),f(p,d.ModLFOToPitch,0),f(p,d.VibLFOToPitch,0),f(p,d.ModEnvToPitch,0),f(p,d.InitialFilterFc,13500),f(p,d.InitialFilterQ,0),f(p,d.ModLFOToFilterFc,0),f(p,d.ModEnvToFilterFc,0),f(p,d.EndAddrsCoarseOffset,0),f(p,d.ModLFOToVolume,0),f(p,d.ChorusEffectsSend,0),f(p,d.ReverbEffectsSend,0),f(p,d.Pan,0),f(p,d.DelayModLFO,-12e3),f(p,d.FreqModLFO,0),f(p,d.DelayVibLFO,-12e3),f(p,d.FreqVibLFO,0),f(p,d.DelayModEnv,-12e3),f(p,d.AttackModEnv,-12e3),f(p,d.HoldModEnv,-12e3),f(p,d.DecayModEnv,-12e3),f(p,d.SustainModEnv,0),f(p,d.ReleaseModEnv,-12e3),f(p,d.KeyNumToModEnvHold,0),f(p,d.KeyNumToModEnvDecay,0),f(p,d.DelayVolEnv,-12e3),f(p,d.AttackVolEnv,-12e3),f(p,d.HoldVolEnv,-12e3),f(p,d.DecayVolEnv,-12e3),f(p,d.SustainVolEnv,0),f(p,d.ReleaseVolEnv,-12e3),f(p,d.KeyNumToVolEnvHold,0),f(p,d.KeyNumToVolEnvDecay,0),f(p,d.StartLoopAddrsCoarseOffset,0),f(p,d.KeyNum,-1),f(p,d.Velocity,-1),f(p,d.InitialAttenuation,0),f(p,d.EndLoopAddrsCoarseOffset,0),f(p,d.CoarseTune,0),f(p,d.FineTune,0),f(p,d.SampleModes,0),f(p,d.ScaleTuning,100),f(p,d.ExclusiveClass,0),f(p,d.OverridingRootKey,-1),p)},"./src/types/index.ts":function(a,l,u){u.r(l);var p=u("./src/types/bank.ts");for(var d in p)d!=="default"&&(function(Z){u.d(l,Z,function(){return p[Z]})})(d);var f=u("./src/types/generator.ts");u.d(l,"GeneratorType",function(){return f.GeneratorType}),u.d(l,"DEFAULT_GENERATOR_VALUES",function(){return f.DEFAULT_GENERATOR_VALUES});var g=u("./src/types/instrument.ts");for(var d in g)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return g[V]})})(d);var b=u("./src/types/key.ts");for(var d in b)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return b[V]})})(d);var A=u("./src/types/metaData.ts");for(var d in A)["GeneratorType","DEFAULT_GENERATOR_VALUES","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return A[V]})})(d);var S=u("./src/types/modulator.ts");u.d(l,"ControllerType",function(){return S.ControllerType}),u.d(l,"ControllerPolarity",function(){return S.ControllerPolarity}),u.d(l,"ControllerDirection",function(){return S.ControllerDirection}),u.d(l,"ControllerPalette",function(){return S.ControllerPalette}),u.d(l,"Controller",function(){return S.Controller}),u.d(l,"TransformType",function(){return S.TransformType}),u.d(l,"DEFAULT_INSTRUMENT_MODULATORS",function(){return S.DEFAULT_INSTRUMENT_MODULATORS});var M=u("./src/types/preset.ts");for(var d in M)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return M[V]})})(d);var E=u("./src/types/presetData.ts");for(var d in E)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return E[V]})})(d);var F=u("./src/types/sample.ts");u.d(l,"SampleType",function(){return F.SampleType});var $=u("./src/types/zone.ts");for(var d in $)["GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType","default"].indexOf(d)<0&&(function(V){u.d(l,V,function(){return $[V]})})(d)},"./src/types/instrument.ts":function(a,l){},"./src/types/key.ts":function(a,l){},"./src/types/metaData.ts":function(a,l){},"./src/types/modulator.ts":function(a,l,u){u.r(l),u.d(l,"ControllerType",function(){return p}),u.d(l,"ControllerPolarity",function(){return d}),u.d(l,"ControllerDirection",function(){return f}),u.d(l,"ControllerPalette",function(){return g}),u.d(l,"Controller",function(){return b}),u.d(l,"TransformType",function(){return A}),u.d(l,"DEFAULT_INSTRUMENT_MODULATORS",function(){return M});var p,d,f,g,b,A,S=u("./src/types/generator.ts");(function(E){E[E.Linear=0]="Linear",E[E.Concave=1]="Concave",E[E.Convex=2]="Convex",E[E.Switch=3]="Switch"})(p||(p={})),(function(E){E[E.Unipolar=0]="Unipolar",E[E.Bipolar=1]="Bipolar"})(d||(d={})),(function(E){E[E.Increasing=0]="Increasing",E[E.Decreasing=1]="Decreasing"})(f||(f={})),(function(E){E[E.GeneralController=0]="GeneralController",E[E.MidiController=1]="MidiController"})(g||(g={})),(function(E){E[E.NoController=0]="NoController",E[E.NoteOnVelocity=2]="NoteOnVelocity",E[E.NoteOnKeyNumber=3]="NoteOnKeyNumber",E[E.PolyPressure=10]="PolyPressure",E[E.ChannelPressure=13]="ChannelPressure",E[E.PitchWheel=14]="PitchWheel",E[E.PitchWheelSensitivity=16]="PitchWheelSensitivity",E[E.Link=127]="Link"})(b||(b={})),(function(E){E[E.Linear=0]="Linear",E[E.Absolute=2]="Absolute"})(A||(A={}));var M=[{id:S.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:d.Unipolar,direction:f.Decreasing,palette:g.GeneralController,index:b.NoteOnVelocity},value:960,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.InitialFilterFc,source:{type:p.Linear,polarity:d.Unipolar,direction:f.Decreasing,palette:g.GeneralController,index:b.NoteOnVelocity},value:-2400,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.VibLFOToPitch,source:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.ChannelPressure},value:50,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.VibLFOToPitch,source:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.MidiController,index:1},value:50,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:d.Unipolar,direction:f.Decreasing,palette:g.MidiController,index:7},value:960,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.InitialAttenuation,source:{type:p.Linear,polarity:d.Bipolar,direction:f.Increasing,palette:g.MidiController,index:10},value:1e3,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.InitialAttenuation,source:{type:p.Concave,polarity:d.Unipolar,direction:f.Decreasing,palette:g.MidiController,index:11},value:960,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.ReverbEffectsSend,source:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.MidiController,index:91},value:200,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.ChorusEffectsSend,source:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.MidiController,index:93},value:200,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.NoController},transform:A.Linear},{id:S.GeneratorType.CoarseTune,source:{type:p.Linear,polarity:d.Bipolar,direction:f.Increasing,palette:g.GeneralController,index:b.PitchWheel},value:12700,valueSource:{type:p.Linear,polarity:d.Unipolar,direction:f.Increasing,palette:g.GeneralController,index:b.PitchWheelSensitivity},transform:A.Linear}]},"./src/types/preset.ts":function(a,l){},"./src/types/presetData.ts":function(a,l){},"./src/types/sample.ts":function(a,l,u){var p;u.r(l),u.d(l,"SampleType",function(){return p}),(function(d){d[d.EOS=0]="EOS",d[d.Mono=1]="Mono",d[d.Right=2]="Right",d[d.Left=4]="Left",d[d.Linked=8]="Linked",d[d.RomMono=32769]="RomMono",d[d.RomRight=32770]="RomRight",d[d.RomLeft=32772]="RomLeft",d[d.RomLinked=32776]="RomLinked"})(p||(p={}))},"./src/types/zone.ts":function(a,l){},"./src/utils/buffer.ts":function(a,l,u){u.r(l),u.d(l,"getStringFromBuffer",function(){return p});var p=function(d){return new TextDecoder("utf8").decode(d).split(/\0/)[0].trim()}},"./src/utils/index.ts":function(a,l,u){u.r(l);var p=u("./src/utils/buffer.ts");u.d(l,"getStringFromBuffer",function(){return p.getStringFromBuffer});var d=u("./src/utils/memoize.ts");u.d(l,"memoize",function(){return d.memoize})},"./src/utils/memoize.ts":function(a,l,u){u.r(l),u.d(l,"memoize",function(){return p});var p=function(d){var f={};return function(){for(var g=arguments.length,b=new Array(g),A=0;A<g;A++)b[A]=arguments[A];var S=JSON.stringify(b);if(S in f)return f[S];var M=d.apply(void 0,b);return f[S]=M,M}}}})})})(SoundFont2)),SoundFont2.exports}var SoundFont2Exports=requireSoundFont2();const m=o=>Math.pow(2,o/1200),Q=o=>o/1e3,G=(o,e)=>{const a=Math.pow(10,e);return Math.round(o*a)/a};typeof AudioParam<"u"&&(AudioParam.prototype.dahdsr=function(o,e,a,l,u,p,d,f,g){u=Math.max(G(u,4),.001),d=Math.max(G(d,4),.001),g=G(g,4),e=Math.max(e,.001);let b=o;return this.setValueAtTime(e,b),this.setValueAtTime(e,b+=l),this.exponentialRampToValueAtTime(a,b+=u),this.setValueAtTime(a,b+=p),this.exponentialRampToValueAtTime(Math.max(f*a,.001),b+=d),(A,S)=>{this.cancelAndHoldAtTime(A);const M=Math.max(S??e,.001);this.exponentialRampToValueAtTime(M,A+g)}});const T={0:"startAddrOffset",1:"endAddrOffset",2:"startloopAddrsOffset",3:"endloopAddrsOffset",4:"startAddrsCoarseOffset",5:"modLfoToPitch",6:"vibLfoToPitch",7:"modEnvToPitch",8:"initialFilterFc",9:"initialFilterQ",10:"modLfoToFilterFc",11:"modEnvToFilterFc",12:"endAddrsCoarseOffset",13:"modLfoToVolume",14:"unused1",15:"chorusEffectsSend",16:"reverbEffectsSend",17:"pan",18:"unused2",19:"unused3",20:"unused4",21:"delayModLFO",22:"freqModLFO",23:"delayVibLFO",24:"freqVibLFO",25:"delayModEnv",26:"attackModEnv",27:"holdModEnv",28:"decayModEnv",29:"sustainModEnv",30:"releaseModEnv",31:"keyNumToModEnvHold",32:"keyNumToModEnvDecay",33:"delayVolEnv",34:"attackVolEnv",35:"holdVolEnv",36:"decayVolEnv",37:"sustainVolEnv",38:"releaseVolEnv",39:"keyNumToVolEnvHold",40:"keyNumToVolEnvDecay",41:"instrument",42:"reserved1",43:"keyRange",44:"velRange",45:"startloopAddrsCoarseOffset",46:"keyNum",47:"velocity",48:"initialAttenuation",49:"reserved2",50:"endloopAddrsCoarseOffset",51:"coarseTune",52:"fineTune",53:"sampleID",54:"sampleModes",55:"reserved3",56:"scaleTuning",57:"exclusiveClass",58:"overridingRootKey",59:"unused5",60:"endOper"};Object.fromEntries(Object.entries(SoundFont2Exports.DEFAULT_GENERATOR_VALUES).map(([o,e])=>[T[o],e]));const D=(o,e,a,l,u)=>{var p,d,f,g,b,A,S;const M=SoundFont2Exports.DEFAULT_GENERATOR_VALUES[o];if(typeof M!="number")throw new Error(`no default value found for generator with index ${o}`);const E=e.generators[o],F=(d=(p=a.globalZone)==null?void 0:p.generators)==null?void 0:d[o],$=(f=l?.generators)==null?void 0:f[o],Z=(b=(g=u.globalZone)==null?void 0:g.generators)==null?void 0:b[o],V=E&&"value"in E?E.value:void 0,K=F&&"value"in F?F.value:void 0,se=$&&"value"in $?$.value:void 0,z=Z&&"value"in Z?Z.value:void 0,U=(A=V??K)!=null?A:M,ee=(S=se??z)!=null?S:0;return U+ee},J=o=>SoundFont2Exports.DEFAULT_GENERATOR_VALUES[o]!==void 0,W=(o,e,a)=>{var l,u,p,d;return Object.fromEntries(Array.from(new Set([Object.keys((u=(l=a.globalZone)==null?void 0:l.generators)!=null?u:{}),Object.keys(e.generators),Object.keys((d=(p=e.instrument.globalZone)==null?void 0:p.generators)!=null?d:{}),Object.keys(o.generators)].flat())).filter(J).map(f=>[T[f],D(parseInt(f),o,e.instrument,e,a)]))};function X(o,e,a){let{time:l=o.currentTime}=a;const{midi:u,start:p,velocity:d=.3,startLoop:f,endLoop:g,sampleRate:b,originalPitch:A,pitchCorrection:S,type:M,sampleModes:E=0,overridingRootKey:F,fineTune:$=0,startloopAddrsOffset:Z=0,startloopAddrsCoarseOffset:V=0,endloopAddrsOffset:K=0,endloopAddrsCoarseOffset:se=0,delayVolEnv:z=-12e3,attackVolEnv:U=-12e3,holdVolEnv:ee=-12e3,decayVolEnv:ae=-12e3,sustainVolEnv:de=0,releaseVolEnv:ke=-12e3,pan:Oe=0,...De}=a,Ae=100*(F!==void 0&&F!==-1?F:A)+S-$,Pe=u*100-Ae,We=1*Math.pow(2,Pe/1200);e.playbackRate.value=We;const qe=f+Z+V*32768,at=g+K+se*32768;at>qe&&E===1?(e.loopStart=qe/b,e.loopEnd=at/b,e.loop=!0):E===3&&console.warn("unimplemented sampleMode 3 (play till end on note off)"),Object.keys(De).filter(Bt=>!["name","instrument","keyRange","sampleID","end"].includes(Bt)).length;const yt=o.createGain(),ut=[l,0,d,m(z),m(U),m(ee),m(ae),de>=960?0:1-Q(de),m(ke)],Dt=yt.gain.dahdsr(...ut),$t=o.createStereoPanner();return $t.pan.value=Oe/1e3,yt.connect($t),e.connect(yt),$t.connect(o.destination),e.start(l),(Bt=o.currentTime)=>{e.stop(Bt+m(ke)),Dt(Bt)}}function Y(o,e,a={}){const{header:l,data:u}=e,p=new Float32Array(u.length);for(let g=0;g<u.length;g++)p[g]=u[g]/32768;const d=o.createBuffer(1,p.length,l.sampleRate);d.getChannelData(0).set(p);const f=o.createBufferSource();return f.buffer=d,a={...l,...a},X(o,f,a)}const C=(o,e)=>!o.keyRange||o.keyRange.lo<=e&&e<=o.keyRange.hi,x=(o,e)=>o.zones.filter(a=>C(a,e)&&a.instrument).map(a=>a.instrument.zones.filter(l=>C(l,e)).map(l=>{const u=W(l,a,o);return{...l,mergedGenerators:u}})).flat(),ce=(o,e,a,l=o.currentTime)=>{const u=x(e,a).map(p=>Y(o,p.sample,{...p.mergedGenerators,midi:a,time:l}));return(p=o.currentTime)=>{u.forEach(d=>d(p))}};Pattern$1.prototype.soundfont=function(o,e=0){return this.onTrigger((a,l,u,p)=>{const d=getAudioContext(),f=getPlayableNoteValue(a),g=o.presets[e%o.presets.length],b=p,A=[d,g,noteToMidi$1(f),b];ce(...A)(b+a.duration)})};async function defaultPrebake(){const o=evalScope(evalScope,Promise.resolve().then(()=>strudelCore),Promise.resolve().then(()=>strudelMini),Promise.resolve().then(()=>strudelTonal),Promise.resolve().then(()=>strudelWebAudio),{hush,evaluate:evaluate$1});await Promise.all([o,registerSynthSounds$1()])}let initDone,repl;function initStrudel(o={}){initAudioOnFirstClick(),o.miniAllStrings!==!1&&miniAllStrings();const{prebake:e,...a}=o;return repl=webaudioRepl({...a,transpiler}),initDone=(async()=>(await defaultPrebake(),await e?.(),repl))(),setTime(()=>repl.scheduler.now()),initDone}window.initStrudel=initStrudel,Pattern$1.prototype.play=function(){if(!repl)throw new Error(".play: no repl found. Have you called initStrudel?");return initDone.then(()=>{repl.setPattern(this,!0)}),this};function hush(){repl.stop()}async function evaluate$1(o,e=!0){return repl.evaluate(o,e)}App.last_eval_error="",App.handle_eval_error=o=>{App.has_error=!0,App.last_eval_error=o?.message||`${o}`,App.set_status(App.last_eval_error)};const{evaluate,scheduler}=webaudioRepl({transpiler,onEvalError:o=>{App.handle_eval_error(o)}});App.evaluate=evaluate,App.scheduler=scheduler,App.app_name="Slide",App.current_song="",App.events_started=!1,App.audio_started=!1,App.fetch_in_flight=!1,App.default_cpm=60,App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.color_index=0,App.do_partial_updates=!1,App.fetch_delay_seconds=5,App.code_url_max=1920,App.default_cpm=30,App.on_load=()=>{App.start_events()},App.get_config=async()=>{let o=await fetch("config/config.json");try{App.config=await o.json()}catch(e){console.error("Failed to parse config.json",e),App.config={}}},App.clear_draw_context=()=>{try{cleanupDraw(!0)}catch(o){console.warn("Failed to clear draw context",o)}},App.reset_eval_state=()=>{App.has_error=!1},App.report_eval_failure=o=>{let e=o?.message||App.last_eval_error||"Failed to evaluate Strudel code";App.last_eval_error=e,App.set_status(e)},App.normalize_code=(o="")=>o.replace(/\r\n/g,`
`).trim(),App.strip_set_cpm=o=>o.split(`
`).filter(e=>!e.trim().match(/^setCpm\s*\(/)).join(`
`),App.split_by_newlines=o=>{let e="",a=null,l=0,u=0,p=0,d=[],f=()=>{let g=e.trim();g&&d.push(g),e=""};for(let g=0;g<o.length;g+=1){let b=o[g],A=o[g-1];if(e+=b,a){b===a&&A!=="\\"&&(a=null);continue}if(b==='"'||b==="'"||b==="`"){a=b;continue}if(b==="("?l+=1:b===")"?l=Math.max(0,l-1):b==="["?u+=1:b==="]"?u=Math.max(0,u-1):b==="{"?p+=1:b==="}"&&(p=Math.max(0,p-1)),b!==`
`)continue;let S=o[g+1];l===0&&u===0&&p===0&&!(S===" "||S==="	")&&!(S===`
`)&&f()}return f(),d},App.segment_code=o=>{let e=App.normalize_code(o);if(!e)return[];let a=e.split(/\n{2,}/g).map(u=>u.trim()).filter(Boolean),l=[];for(let u of a){if(!u.includes(`
`)){l.push(u);continue}let p=App.split_by_newlines(u);p.length?l.push(...p):l.push(u)}if(l.length<=1&&e.includes(`
`)){let u=e.split(/\n+/g).map(p=>p.trim()).filter(Boolean);if(u.length>1)return u}return l},App.apply_partial_update=async o=>{let e=App.segment_code(o);if(!e.length)return!1;let a=[],l=0;for(let p of e){let d=await App.run_eval(p);if(d.ok){a.push(p);continue}l+=1,console.warn("Skipping segment due to error",d.error)}if(!a.length)return!1;let u=a.join(`

`);return App.set_input(u),l>0?App.playing(`Skipped ${l} segment(s)`):App.playing(),!0},App.start_events=async()=>{if(App.events_started)return;App.events_started=!0,await App.get_config(),App.load_all_storage(),App.setup_modals(),App.start_visual();let o=DOM.el("#btn-play");DOM.ev(o,"click",async()=>{let f=App.get_input_value();App.play_action(f,{fresh:!0})}),App.middle_click(o,()=>{App.copy_play()}),DOM.ev("#btn-url","click",()=>{App.get_beat_url()});let e=DOM.el("#btn-auto");DOM.ev(e,"click",()=>{App.show_auto()}),App.middle_click(e,()=>{App.toggle_auto()});let a=DOM.el("#btn-queue");DOM.ev(a,"click",()=>{App.next_in_queue()}),App.middle_click(a,()=>{App.clear_queue()}),DOM.ev("#btn-pause","click",()=>{App.pause_action()}),DOM.ev("#btn-stop","click",()=>{App.stop_action()}),DOM.ev("#btn-new","click",()=>{App.new_beat()});let l=DOM.el("#btn-collections");DOM.ev(l,"click",()=>{App.show_collections()});let u=DOM.el("#btn-snapshot");DOM.ev(u,"click",()=>{App.save_snapshot()}),App.remove_context("#controls");let p=DOM.el("#image");DOM.ev(p,"click",()=>{App.show_settings()}),App.middle_click(p,()=>{App.next_visual()});let d=DOM.el("#title");DOM.ev(d,"click",()=>{App.show_about()}),App.middle_click(d,()=>{App.mirror_title()}),App.setup_player(),App.setup_status(),App.setup_volume(),App.setup_input(),App.setup_scope(),App.setup_theme(),App.setup_effects(),App.setup_custom_numbers(),App.init_volume_controls(),App.init_tempo_controls(),App.init_code_input_controls(),App.start_keyboard(),App.start_resize_observer(),App.make_main_visible(),App.set_beat_title_from_query(),App.max_input(),App.resize_scope(),App.init_tooltips(),await App.load_song_from_query()||App.load_url_from_query()||App.load_code_from_query()||App.load_last_code(),App.update_url(),App.playing()},App.get_main=()=>DOM.el("#main"),App.make_main_visible=()=>{App.get_main().classList.remove("invisible")},App.set_title=o=>{if(o){document.title=`${App.app_name} - ${o}`;return}document.title=App.app_name},App.get_query_params=()=>new URLSearchParams(window.location.search),App.update_title=()=>{let o=App.app_name,e=App.get_song_name(!0);e?o=`${o} - ${e}`:App.beat_title&&(o=`${o} - ${App.beat_title}`),document.title=o},App.get_top_height=()=>{let o=DOM.el("#top");return App.get_el_height(o)},App.get_bottom_height=()=>{let o=DOM.el("#bottom");return App.get_el_height(o)},App.loading=()=>{App.set_status("Loading...")},App.start_resize_observer=()=>{new ResizeObserver(e=>{App.max_debouncer.call()}).observe(App.get_main()),DOM.ev(window,"resize",()=>{App.resize_scope(),App.check_max_button()})},App.setup_eval=async()=>{try{await evalScope(strudelCore,strudelMini,strudelWebAudio,strudelTonal,strudelDraw,strudelHydra,transpiler),console.log("Setup Eval done.")}catch(o){console.error("Strudel scope failed to load",o)}},App.mirror_title=()=>{DOM.el("#title").classList.toggle("mirror")},window.H=H,window.initHydra=initHydra,window.clearHydra=clearHydra,window.lz=m$2,window.Drawer=Drawer$1,window.strudelMini=strudelMini,window.registerSoundfonts=registerSoundfonts$1,window.registerSynthSounds=ec,window.initAudio=bo,window.samples=to,window.getAudioContext=x$2,window.hush=hush,App.mirror_enabled=!0,App.setup_drawer=()=>{let o=1e3,e=null,a=null,l=()=>{a=null,!(!App.editor||!e)&&(App.editor.dispatch({effects:App.set_highlight.of(e)}),e=null)};App.cancel_mirror_render=()=>{a&&(window.cancelAnimationFrame(a),a=null),e=null},App.drawer=new Drawer(u=>{if(!App.mirror_enabled||u.length>o)return;let p=[];for(let d of u)d.context&&d.context.locations?p.push(...d.context.locations):d.context&&d.context.location&&p.push(d.context.location);e=p,a||(a=window.requestAnimationFrame(l))},[0,0])},App.setup_strudel_mirror=()=>{App.set_highlight=StateEffect.define(),App.highlight_extension=StateField.define({create(){return Decoration.none},update(o,e){o=o.map(e.changes);for(let a of e.effects)if(a.is(App.set_highlight)){let l=e.newDoc.length;if(l===0)return Decoration.none;let u=a.value.filter(p=>p.end<=l).map(p=>Decoration.mark({class:"sh-executing"}).range(p.start,p.end));return Decoration.set(u,!0)}return o},provide:o=>EditorView.decorations.from(o)})},App.clean_mirror=()=>{App.cancel_mirror_render&&App.cancel_mirror_render(),App.editor&&App.editor.dispatch({effects:App.set_highlight.of([])})},App.toggle_mirror=()=>{App.mirror_enabled=!App.mirror_enabled,App.mirror_enabled?App.is_playing()&&App.start_drawer():(App.stop_drawer(),App.clean_mirror()),App.stor_save_mirror()},App.start_drawer=()=>{App.draw_started||(App.drawer.start(App.scheduler),App.draw_started=!0)},App.stop_drawer=()=>{App.drawer.stop(),App.draw_started=!1},App.modal_zindex=1e3,App.active_modals=[],App.all_modals=[],App.modal_factory=(o,e)=>{let a=DOM.el(`#${e}`),l=DOM.create("div");l.innerHTML=a.innerHTML,DOM.el("#modals").appendChild(l);let u=DOM.el(".modal",l);return u.id=`${o}-modal`,App.all_modals.push(u),u},App.create_modal=o=>App.modal_factory(o,"template-modal"),App.create_list_modal=o=>{let e=App.modal_factory(o,"template-list-modal"),a=DOM.el(".modal-filter",e);return a.id=`${o}-modal-filter`,e},App.setup_modals=()=>{DOM.ev("#main","click",o=>{let e=o.target.closest(".modal-close");if(e){let a=e.closest(".modal");a&&App.do_close_modal(a)}}),DOM.ev("#modal-overlay","click",o=>{App.close_current_modal()})},App.show_items_modal=async(o,e={})=>{let a={loaded:!1,active:-1,capitalize:!0,icons:!0,hover:!1,hover_title:""};App.def_args(a,e),App.check_create_modal(o);let l=e.loaded||!1,u=DOM.el(`#${o}-modal`),p=DOM.el(".modal-body",u),d=DOM.el(".modal-filter",u);if(l&&(p.innerHTML='<div class="loading">Loading items...</div>'),d&&(d.value="",d.disabled=!0,d.oninput=null,d.onkeydown=null),!e.items.length){p.innerHTML='<div class="loading">Nothing found</div>';return}let f=g=>{if(p.innerHTML="",!g.length){p.innerHTML='<div class="loading">No results</div>';return}let b=25;for(let[A,S]of g.entries()){let M=DOM.create("div"),E=DOM.create("div");M.className="modal-item";let F=S.alt_text||S.text;if(e.icons){let $=DOM.create("canvas","modal-icon");$.width=b,$.height=b,M.appendChild($),jdenticon.update($,F)}else if(e.color_icons){let $=DOM.create("div","color-icon");$.style.width=`${b}px`,$.style.height=`${b}px`,$.style.backgroundColor=S.icon_color,M.appendChild($)}if(F=App.underspace(F),e.capitalize&&(F=App.capitalize(F)),e.hover){let $=DOM.create("div","modal-hover");$.title=e.hover_title,$.textContent="🌊",DOM.ev($,"click",Z=>{e.ctrl_action(S,M),Z.preventDefault(),Z.stopPropagation()}),App.register_tooltip($),M.appendChild($)}E.textContent=F,M.title=S.title||"",DOM.ev(M,"click",$=>{$.ctrlKey?e.ctrl_action&&e.ctrl_action(S,M):e.action&&e.action(S,M)}),DOM.ev(M,"auxclick",$=>{$.button===1&&e.alt_action&&e.alt_action(S,M)}),App.register_tooltip(M),e.active===A&&M.classList.add("modal-active-item"),M.appendChild(E),p.appendChild(M)}};f(e.items),d&&(App.modal_apply_filter=()=>{let g=d.value.trim().toLowerCase();if(!g){f(e.items);return}let b=e.items.filter(A=>(A.alt_text||A.text).toLowerCase().includes(g));f(b)},d.disabled=!1,d.focus(),d.oninput=App.modal_apply_filter,d.onkeydown=g=>{if(g.key!=="Enter")return;g.preventDefault();let b=DOM.els(".modal-item",p);for(let A of b){A.click();break}},App.do_open_modal(u),App.focus_modal_filter(o))},App.open_modal=o=>{App.check_create_modal(o);let e=DOM.el(`#${o}-modal`);e&&App.do_open_modal(e)},App.do_open_modal=o=>{let e=DOM.el(".modal-body",o);App.show_overlay(),App.active_modals.includes(o)||App.active_modals.push(o);let a=App.active_modals.length,l=App.modal_zindex+a;o.style.zIndex=l,App.refresh_modals(),e.scrollTop=0},App.close_modal=o=>{let e=DOM.el(`#${o}-modal`);e&&App.do_close_modal(e)},App.do_close_modal=o=>{App.active_modals.includes(o)&&App.active_modals.splice(App.active_modals.indexOf(o),1),App.refresh_modals(),App.active_modals.length===0&&App.hide_overlay()},App.close_all_modals=()=>{let o=DOM.els(".modal");for(let e of o)App.do_close_modal(e)},App.close_current_modal=()=>{if(App.active_modals.length>0){let o=App.get_current_modal();App.do_close_modal(o)}},App.modal_open=()=>App.active_modals.length>0,App.show_overlay=()=>{DOM.show("#modal-overlay")},App.hide_overlay=()=>{DOM.hide("#modal-overlay")},App.focus_modal_filter=o=>{let e=DOM.el(`#${o}-modal-filter`);e&&e.focus()},App.refresh_modals=()=>{let o=App.get_current_modal();for(let e of App.all_modals)e===o?DOM.show(e,2):DOM.hide(e,2)},App.get_current_modal=()=>App.active_modals[App.active_modals.length-1],App.check_create_modal=o=>{let e=`${o}_modal_created`;if(App[e])return;let a=App[`create_${o}_modal`];a&&(a(),App[e]=!0)},App.strudel_notes=["c4","e4","g4","a4","f4","d4","b4","c3","e3","g3","a3","f3","d3","b3","f#4","bb4","c#4","eb4","g#4","f#3","bb3","c#3","eb3","g#3","c5","e5","g5","a5","f5","d5","b5","c2","e2","g2","a2","f2","d2","b2","f#5","bb5","c#5","eb5","g#5","f#2","bb2","c#2","eb2","g#2","c6","e6","g6","a6","f6","d6","b6","c1","e1","g1","a1","f1","d1","b1","f#6","bb6","c#6","eb6","g#6","f#1","bb1","c#1","eb1","g#1","c7","e7","g7","c0","e0","g0"],App.play_state="stopped",App.play_running=!1,App.last_playing="",App.setup_player=()=>{App.setup_drawer()},App.reset_playing=()=>{App.play_running=!1},App.play_action=async(o="",e={})=>{console.info("🔮 Play Action");let a={force:!1,fresh:!1};if(App.def_args(a,e),!App.play_running){App.play_running=!0;try{if(o||(o=App.get_input_value()),!o){App.last_code="",App.current_song="",App.stop_action();return}if(!e.fresh&&o===App.last_code)return;e.fresh&&App.restart_code_scroll(!0),App.stor_save_code(),App.clear_draw_context(),App.update_title(),App.stop_queue(),await App.strudel_update(o)&&(await App.resume_audio(),App.set_playing("playing"),App.update_effects(),App.update_url(),App.start_queue())}catch(l){App.last_code="",App.set_status(`Error: ${l.message}`)}finally{App.reset_playing()}}},App.stop_action=()=>{console.info("🔮 Stop Action"),App.set_playing("stopped"),App.stop_strudel(),App.stop_code_scroll(),App.stop_auto(),App.clear_draw_context(),App.set_song_context(""),App.suspend_audio(),App.stop_queue(),App.playing()},App.stop_strudel=async()=>{if(App.clear_draw_context(),App.scheduler.stop(),await App.scheduler.setPattern(null),window.clearHydra){await window.clearHydra();try{window.hush()}catch{}}App.stop_drawer(),App.clean_mirror()},App.pause_action=()=>{App.is_playing()&&(console.info("🔮 Pause Action"),App.set_playing("paused"),App.pause_strudel(),App.stop_code_scroll(),App.stop_queue())},App.pause_strudel=()=>{App.scheduler.pause(),App.stop_drawer()},App.strudel_update=async o=>{if(await App.init_player(),!App.audio_started)return console.warn("Audio not started yet. Call init_player() first."),!1;console.info("Updating 💨"),App.set_song_tempo(o),App.update_url();let e=await App.run_eval(o);return e.ok?(App.playing(),!0):App.do_partial_updates&&await App.apply_partial_update(o)?!0:(App.report_eval_failure(e.error),!1)},App.playing=o=>{App.set_play_status(o)},App.set_play_status=o=>{let e="",a=App.get_song_name(!0);e=App.cond([[()=>App.beat_title,App.beat_title],[()=>a,a],[!0,"Untitled"]]),App.last_playing=e,o&&(e=`${e} - ${o}`.trim()),App.set_status(e)},App.load_last_code=()=>{App.last_code&&App.set_input(App.last_code)},App.restart_code_scroll=(o=!0)=>{o&&App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.init_player=async()=>{if(App.audio_started){console.info("Audio already initialized");return}console.info("Initializing Audio...");try{await App.setup_eval(),await initAudio(),miniAllStrings();let o="/samples";await registerSynthSounds(),await registerSoundfonts(),await samples(`${o}/tidal-drum-machines.json`),await samples(`${o}/piano.json`),await samples(`${o}/Dirt-Samples.json`),await samples(`${o}/vcsl.json`),await samples(`${o}/mridangam.json`),samples(`${o}/strudel.json`),aliasBank(`${o}/tidal-drum-machines-alias.json`),App.audio_started=!0,App.apply_volume(),App.init_scope(),console.info("Audio Ready."),App.playing()}catch(o){throw console.error("Audio Failed:",o),o}},App.run_eval=async o=>{App.reset_eval_state(),o=App.filter_code(o),App.set_input(o,!1);try{if(App.pattern=await App.evaluate(o),App.pattern){if(App.last_code=o,App.is_stopped()){let e=App.scheduler.now(),a=App.scheduler.cps||1;App.seek_offset=e*a}App.start_drawer()}else App.last_code="",App.seek_offset=0,App.stop_action()}catch(e){return App.seek_offset=0,App.stop_action(),{ok:!1,error:e}}return App.has_error?{ok:!1,error:new Error(App.last_eval_error||"Evaluation error")}:{ok:!0}},App.rewind_player=(o=1)=>{let e=App.scheduler.cps||1,a=o*e;App.seek_offset+=a,App.update_playback()},App.forward_player=(o=1)=>{let e=App.scheduler.cps||1,a=o*e;App.seek_offset-=a,App.update_playback()},App.update_playback=()=>{App.pattern&&App.scheduler.setPattern(App.pattern.late(App.seek_offset))},App.is_playing=()=>App.play_state==="playing",App.is_paused=()=>App.play_state==="paused",App.is_stopped=()=>App.play_state==="stopped",App.copy_play=async()=>{try{let o=await navigator.clipboard.readText();o&&o.length>0&&App.play_action(o,{fresh:!0})}catch(o){console.error(`Clipboard access denied or failed: ${o}`)}},App.set_playing=o=>{App.play_state=o;let e=DOM.el("#btn-play");App.is_playing()?e.classList.add("active"):e.classList.remove("active"),e=DOM.el("#btn-pause"),App.is_paused()?e.classList.add("active"):e.classList.remove("active")},App.create_prompt_modal=()=>{let o=App.create_modal("prompt"),e=DOM.el(".modal-title",o);e.id="modal-title-prompt";let a=DOM.el(".modal-body",o);a.id="modal-body-prompt";let l=DOM.create("input","modal-input","modal-input-prompt");DOM.ev(l,"keydown",f=>{f.key==="Enter"&&App.do_prompt_action()});let u=DOM.create("div","modal-buttons"),p=DOM.create("button","modal-button","modal-button-prompt");p.textContent="Cancel";let d=DOM.create("button","modal-button","modal-button-prompt");d.textContent="Ok",DOM.ev(p,"click",()=>{App.close_modal("prompt")}),DOM.ev(d,"click",()=>{App.do_prompt_action()}),u.appendChild(p),u.appendChild(d),a.appendChild(l),a.appendChild(u)},App.show_prompt=(o={})=>{let e={title:"Enter Text",placeholder:"Text",value:""};App.def_args(e,o),App.check_create_modal("prompt");let a=DOM.el("#modal-title-prompt");a.textContent=o.title;let l=DOM.el("#modal-input-prompt");l.placeholder=o.placeholder,l.value=o.value,App.prompt_action=o.action,App.open_modal("prompt"),l.focus()},App.do_prompt_action=()=>{if(!App.prompt_action)return;let e=DOM.el("#modal-input-prompt").value;App.close_modal("prompt"),App.prompt_action(e)},App.queue=[],App.queue_delay=45*1e3,App.start_queue=()=>{clearTimeout(App.queue_timeout),App.queue_timeout=setTimeout(()=>{App.check_queue()},App.queue_delay)},App.stop_queue=()=>{clearTimeout(App.queue_timeout)},App.check_queue=()=>{App.queue.length!==0&&(App.next_in_queue(),App.start_queue())},App.queue_snapshot=o=>{App.queue.push({type:"snapshot",item_id:o.id}),App.check_queue_button()},App.queue_song=o=>{App.queue.push({type:"song",item_id:o}),App.check_queue_button()},App.check_queue_button=()=>{let o=DOM.el("#btn-queue");App.queue.length>0?DOM.show(o):DOM.hide(o)},App.next_in_queue=async()=>{let o=App.queue.shift();if(o.type==="snapshot"){let e=await App.get_snapshot_by_id(o.item_id);e&&App.load_snapshot(e)}else o.type==="song"&&App.load_song(o.item_id);App.check_queue_button()},App.clear_queue=()=>{clearTimeout(App.queue_timeout),App.queue=[],App.check_queue_button()},App.scope_container_el=void 0,App.scope_canvas_el=void 0,App.scope_canvas_ctx=void 0,App.scope_analyser=void 0,App.scope_waveform=void 0,App.scope_animation_id=void 0,App.scope_connected=!1,App.scope_pixel_ratio=1,App.scope_enabled=!0,App.scope_max_y=-1,App.scope_min_y=-1,App.scope_color="rgb(204, 198, 239)",App.scope_background="rgb(20, 20, 20)",App.scope_click_color_1="rgba(162, 171, 234, 0.5)",App.scope_click_color_2="rgba(255, 137, 204, 1)",App.scope_click_color_3="rgba(222, 242, 92, 1)",App.scope_click_color_4="rgba(91, 163, 240, 1)",App.scope_click_color_5="rgba(114, 248, 146, 1)",App.scope_click_color_6="rgba(255, 255, 255, 1)",App.scope_click_level=1,App.scope_sine_time=0,App.scope_clicks=[],App.scope_click_size=16,App.scope_is_drawing=!1,App.scope_click_distance=120,App.scope_mousedown_date=0,App.scope_beep_delay=300,App.scope_enable_date=0,App.scope_click_lock=250,App.scope_clicks_min=5,App.scope_click_rotation_speed=.001,App.scope_click_time=3*1e3,App.scope_click_level_time=3*1e3,App.gesture_scope_clicks=[],App.setup_scope=()=>{App.setup_scope_canvas(),App.scope_enabled?App.set_scope_visibility(!0):App.set_scope_visibility(!1),App.setup_time_controls(),App.init_scope_click_handler(),App.start_scope_loop()},App.init_scope=()=>{App.scope_enabled?App.enable_scope_visualizer():App.disable_scope_visualizer()},App.get_scope_wrapper=()=>(App.scope_wrapper_el||(App.scope_wrapper_el=DOM.el("#scope-wrapper")),App.scope_wrapper_el),App.get_scope_container=()=>(App.scope_container_el||(App.scope_container_el=DOM.el("#scope-container")),App.scope_container_el),App.get_scope_canvas=()=>(App.scope_canvas_el||(App.scope_canvas_el=DOM.el("#scope-canvas")),App.scope_canvas_el),App.get_scope_dimensions=()=>{if(!App.scope_canvas_el)return{width:0,height:0};let o=App.scope_canvas_el.clientWidth,e=App.scope_canvas_el.clientHeight;return o||(o=App.scope_canvas_el.width/App.scope_pixel_ratio),e||(e=App.scope_canvas_el.height/App.scope_pixel_ratio),{width:Math.max(0,o||0),height:Math.max(0,e||0)}},App.setup_scope_canvas=()=>{let o=App.get_scope_canvas();if(o){if(!App.scope_canvas_ctx){let e=o.getContext("2d");if(!e){console.warn("Scope canvas context unavailable");return}App.scope_canvas_ctx=e}return o}},App.clear_scope_canvas=()=>{if(!App.scope_canvas_ctx)return;let{width:o,height:e}=App.get_scope_dimensions();!o||!e||(App.scope_canvas_ctx.fillStyle=App.scope_background,App.scope_canvas_ctx.fillRect(0,0,o,e))},App.ensure_scope_waveform=()=>{if(App.scope_analyser)return(!App.scope_waveform||App.scope_waveform.length!==App.scope_analyser.fftSize)&&(App.scope_waveform=new Uint8Array(App.scope_analyser.fftSize)),App.scope_waveform},App.ensure_scope_analyser=()=>{if(App.scope_analyser)return App.scope_analyser;try{let o=App.get_audio_context();if(!o){console.warn("No audio context found yet.");return}let e=o.createAnalyser();e.fftSize=2048,e.minDecibels=-90,e.maxDecibels=-10,e.smoothingTimeConstant=.85,window.master_fx&&window.master_fx.nodes.master_gain?window.master_fx.nodes.master_gain.connect(e):console.log("Connecting analyser to destination input"),App.scope_analyser=e,App.ensure_scope_waveform()}catch(o){console.error("Failed to create scope analyser",o),App.scope_analyser=void 0,App.scope_waveform=void 0}return App.scope_analyser},App.connect_scope_analyser=()=>{if(App.scope_connected)return!0;let o=App.ensure_scope_analyser();if(!o)return!1;if(window.master_fx&&window.master_fx.nodes&&window.master_fx.nodes.master_gain)try{return window.master_fx.nodes.master_gain.connect(o),console.log("Connected Scope to Hijacked Master Gain"),App.scope_connected=!0,!0}catch(e){console.warn("Failed to connect to master_fx:",e)}return!1},App.stop_scope_loop=()=>{App.scope_animation_id&&(cancelAnimationFrame(App.scope_animation_id),App.scope_animation_id=void 0)},App.handle_scope_click=o=>{let e=App.get_scope_canvas();if(!e)return;let a=e.getBoundingClientRect(),l=o.clientX-a.left,u=o.clientY-a.top;App.push_scope_click({x:l,y:u,timestamp:Date.now()})},App.handle_scope_mouse_down=o=>{App.mouse_down_coords=App.get_scope_coords(o),App.scope_mousedown_date=Date.now(),App.scope_is_drawing=!0,App.handle_scope_click(o)},App.handle_scope_mouse_move=o=>{if(App.scope_is_drawing){let e=App.get_scope_canvas();if(!e)return;let a=e.getBoundingClientRect(),l=o.clientX-a.left,u=o.clientY-a.top;if((App.scope_max_y===-1||u>App.scope_max_y)&&(App.scope_max_y=u),(App.scope_min_y===-1||u<App.scope_min_y)&&(App.scope_min_y=u),App.scope_last_point){let p=App.scope_last_point.x,d=App.scope_last_point.y,f=l-p,g=u-d,b=Math.sqrt(f*f+g*g),A=Math.ceil(b/App.scope_click_distance);for(let S=1;S<=A;S++){let M=p+f*S/A,E=d+g*S/A;App.push_scope_click({x:M,y:E,timestamp:Date.now()})}}App.push_scope_click({x:l,y:u,timestamp:Date.now()}),App.scope_last_point={x:l,y:u}}},App.handle_scope_mouse_up=o=>{App.mouse_up_coords=App.get_scope_coords(o),App.check_gestures()},App.increase_scope_click_level=o=>{App.scope_click_level=o,clearTimeout(App.scope_click_level_timeout),App.color_interface(o),App.scope_click_level_timeout=setTimeout(()=>{App.scope_click_level=1,App.restore_interface_colors()},App.scope_click_level_time)},App.draw_star=(o,e,a,l,u,p,d=0)=>{let f=Math.PI/2*3+d,g=Math.PI/u,b=e+Math.cos(f)*p,A=a+Math.sin(f)*p;o.beginPath(),o.moveTo(b,A);for(let S=0;S<u;S++){let M=e+Math.cos(f)*p,E=a+Math.sin(f)*p;o.lineTo(M,E),f+=g;let F=e+Math.cos(f)*l,$=a+Math.sin(f)*l;o.lineTo(F,$),f+=g}o.lineTo(b,A),o.closePath()},App.draw_scope_frame=()=>{if(!App.scope_enabled||!App.scope_canvas_ctx){App.stop_scope_loop();return}function o(){App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame)}let e=App.scope_pixel_ratio||1,a=App.scope_canvas_el.width/e,l=App.scope_canvas_el.height/e;if(!a||!l){o();return}let u=App.scope_canvas_ctx,p=10;u.clearRect(-p,-p,a+p*2,l+p*2),u.fillStyle=App.scope_background,u.fillRect(-p,-p,a+p*2,l+p*2);let d=App.ensure_scope_waveform(),f=App.scope_analyser;if(u.strokeStyle=App.scope_color,u.lineWidth=2/e,u.beginPath(),App.is_playing()&&f&&d){f.getByteTimeDomainData(d);let b=a/d.length,A=0;for(let S=0;S<d.length;S++){let E=d[S]/128*l/2;S===0?u.moveTo(A,E):u.lineTo(A,E),A+=b}}else{App.scope_sine_time+=.012;let b=2048,A=a/b,S=0;for(let M=0;M<b;M++){let E=M/b*Math.PI*12,F=l/2+Math.sin(E+App.scope_sine_time)*(l*.15);M===0?u.moveTo(S,F):u.lineTo(S,F),S+=A}}if(u.stroke(),App.scheduler&&App.is_playing()){let b=4,A=App.scheduler.now(),S=App.scheduler.cps||1,F=((A*S-App.seek_offset)%b+b)%b/b*a;if(!isNaN(F)){let $=u.createLinearGradient(F,0,F,l);$.addColorStop(0,"rgba(255, 255, 255, 0)"),$.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),$.addColorStop(1,"rgba(255, 255, 255, 0)"),u.strokeStyle=$,u.lineWidth=4/e,u.beginPath(),u.moveTo(F,0),u.lineTo(F,l),u.stroke()}}let g=Date.now();App.scope_clicks=App.scope_clicks.filter(b=>g-b.timestamp<App.scope_click_time);for(let b of App.scope_clicks){let A=g-b.timestamp,S=b.level>1?A*App.scope_click_rotation_speed:0;u.fillStyle=App[`scope_click_color_${b.level}`],App.draw_star(u,b.x,b.y,3,5,App.scope_click_size,S),u.fill()}App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame)},App.start_scope_loop=()=>{App.scope_animation_id||(App.scope_animation_id=requestAnimationFrame(App.draw_scope_frame))},App.set_scope_visibility=o=>{let e=App.get_scope_wrapper();e&&(o?DOM.show(e):DOM.hide(e))},App.stop_scope_visualizer=()=>{App.stop_scope_loop(),App.set_scope_visibility(!1),App.clear_scope_canvas()},App.start_scope_visualizer=()=>{App.scope_connected||App.connect_scope_analyser()},App.scope_mouse_enabled=()=>Date.now()-App.scope_enable_date>=App.scope_click_lock,App.init_scope_click_handler=()=>{let o=App.get_scope_canvas();o&&(DOM.ev(o,"mousedown",e=>{App.scope_max_y=-1,App.scope_min_y=-1,App.scope_mouse_enabled()&&App.handle_scope_mouse_down(e)}),DOM.ev(o,"mousemove",e=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_move(e)}),DOM.ev(document,"mouseup",e=>{App.scope_mouse_enabled()&&App.handle_scope_mouse_up(e),App.scope_is_drawing=!1,App.scope_last_point=null}),DOM.ev(o,"contextmenu",e=>{e.preventDefault()}))},App.toggle_scope=()=>{App.scope_enabled?App.disable_scope_visualizer():App.enable_scope_visualizer()},App.enable_scope_visualizer=()=>{App.scope_enabled=!0,App.set_scope_visibility(!0),App.start_scope_loop(),App.scope_enable_date=Date.now(),App.start_scope_visualizer(),App.resize_scope(),App.stor_save_scope()},App.disable_scope_visualizer=()=>{App.scope_enabled=!1,App.stop_scope_visualizer(),App.stor_save_scope()},App.get_scope_coords=o=>{let e=App.get_scope_canvas();if(e){let a=e.getBoundingClientRect(),l=o.clientX-a.left,u=o.clientY-a.top;return{x:l,y:u}}},App.clear_scope_clicks=()=>{setTimeout(()=>{App.scope_clicks=[]},100)},App.resize_scope=()=>{let o=App.get_input_wrapper(),e=App.scope_canvas_el,a=App.scope_canvas_ctx;if(!o||!e||!a)return;let l=e.clientWidth,u=e.clientHeight||120,p=window.devicePixelRatio||1;App.scope_pixel_ratio=p;let d=Math.round(l*p),f=Math.round(u*p);(e.width!==d||e.height!==f)&&(e.width=d,e.height=f,a.setTransform(1,0,0,1,0,0),a.scale(p,p))},App.get_scope_height=()=>{if(App.scope_enabled){let o=App.get_scope_wrapper();return App.get_el_height(o)}return 0},App.set_scope_clicks=o=>{for(let e of App.gesture_scope_clicks)for(let a in o)e[a]=o[a]},App.get_scope_clicks=(o=!1)=>{let e=App.scope_clicks.filter(f=>!f.locked);if(!o||e.length<2)return e;let l=[e[e.length-1]],u=new Set;u.add(e.length-1);let p=50,d=0;for(;d<l.length;){let f=l[d];d++;for(let g=0;g<e.length;g++){if(u.has(g))continue;let b=e[g],A=f.x-b.x,S=f.y-b.y;if(Math.abs(A)>p||Math.abs(S)>p)continue;Math.sqrt(A*A+S*S)<=p&&(u.add(g),l.push(b))}}return l.sort((f,g)=>f.timestamp-g.timestamp),l},App.push_scope_click=o=>{o.locked=!1,o.level=1,App.scope_clicks.push(o)},App.setup_time_controls=()=>{let o=DOM.el("#time-rewind"),e=DOM.el("#time-forward");DOM.ev(o,"click",()=>{App.rewind_player()}),DOM.ev(e,"click",()=>{App.forward_player()}),App.middle_click(o,()=>{App.rewind_player(5)}),App.middle_click(e,()=>{App.forward_player(5)}),App.remove_context(o),App.remove_context(e)},App.code_scroll_frame=void 0,App.code_scroll_last_ts=0,App.code_scroll_direction=1,App.code_scroll_active=!1,App.code_scroll_speed_px_per_second=80,App.code_scroll_pause_until=0,App.code_scroll_wheel_pause_ms=1e3,App.code_scroll_song_pause_ms=1.2*1e3,App.code_scroll_pending_delay_ms=0,App.defer_code_scroll=o=>{if(!Number.isFinite(o)||o<=0){App.code_scroll_pending_delay_ms=0;return}App.code_scroll_pending_delay_ms=o},App.reset_code_scroll_for_content=(o={})=>{let e=0,a=o.scroll_delay_ms??App.code_scroll_song_pause_ms,l=o.direction??1;if(App.code_scroll_active&&(Number.isFinite(App.code_scroll_pending_delay_ms)&&App.code_scroll_pending_delay_ms>0?e=App.code_scroll_pending_delay_ms:Number.isFinite(a)&&a>0&&(e=a)),App.code_scroll_pending_delay_ms=0,App.code_scroll_direction=l,App.code_scroll_last_ts=0,e<=0||typeof window>"u"){App.code_scroll_pause_until=0;return}window.performance?.now?App.code_scroll_pause_until=window.performance.now()+e:App.code_scroll_pause_until=e},App.set_code_scroll_button_active=o=>{let e=DOM.el("#code-input-scroll");if(e){if(o){e.classList.add("active");return}e.classList.remove("active")}},App.code_scroll_tick=o=>{if(!App.code_scroll_active){App.code_scroll_frame=void 0;return}if(!App.editor){App.stop_code_scroll();return}if(App.code_scroll_last_ts||(App.code_scroll_last_ts=o),App.code_scroll_pause_until&&o<App.code_scroll_pause_until){App.code_scroll_last_ts=o,App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick);return}App.code_scroll_pause_until=0;let e=o-App.code_scroll_last_ts;App.code_scroll_last_ts=o;let a=App.code_scroll_speed_px_per_second*e/1e3,l=App.get_input_scroll()+a*App.code_scroll_direction,u=Math.max(0,App.get_input_height()-App.get_input_client_height());if(App.set_input_scroll(l),u<=0){App.stop_code_scroll();return}App.code_scroll_direction>0&&Math.ceil(App.get_input_scroll())+1>=u?(App.set_input_scroll(u),App.reset_code_scroll_for_content({direction:-1})):App.code_scroll_direction<0&&App.get_input_scroll()<=0&&(App.scroll_input_to_top(),App.reset_code_scroll_for_content({direction:1})),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick)},App.start_code_scroll=()=>{App.code_scroll_active||Math.max(0,App.get_input_height()-App.get_input_client_height())<=0||(App.code_scroll_active=!0,App.code_scroll_direction=1,App.code_scroll_last_ts=window.performance.now()-16,App.code_scroll_pause_until=0,App.set_code_scroll_button_active(!0),App.code_scroll_frame=window.requestAnimationFrame(App.code_scroll_tick))},App.stop_code_scroll=()=>{!App.code_scroll_active&&!App.code_scroll_frame||(App.code_scroll_active=!1,App.code_scroll_direction=1,App.code_scroll_last_ts=0,App.code_scroll_pause_until=0,App.code_scroll_frame&&(window.cancelAnimationFrame(App.code_scroll_frame),App.code_scroll_frame=void 0),App.set_code_scroll_button_active(!1))},App.restart_code_scroll=(o=!0)=>{o&&App.scroll_input_to_top(),App.code_scroll_active&&(App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_code_scroll_for_content(App.code_scroll_song_pause_ms))},App.scroll_input_to_top=()=>{App.set_input_scroll(0)},App.scroll_input_to_bottom=()=>{let o=App.editor.scrollDOM.scrollHeight;App.editor.scrollDOM.scrollTop=o},App.get_input_scroll=()=>App.editor.scrollDOM.scrollTop,App.set_input_scroll=o=>{let e=App.editor.scrollDOM;Math.abs(e.scrollTop-o)<1||(e.scrollTop=o,App.editor&&App.editor.requestMeasure())},App.create_settings_modal=()=>{let o=App.create_list_modal("settings"),e=DOM.el(".modal-title",o);e.textContent="Settings"},App.register_setting=(o,e,a)=>{let l=DOM.create("button");return l.textContent=o,l.title=e,DOM.ev(l,"click",()=>{a(),App.close_modal("settings")}),l},App.show_settings=()=>{let o="Select",e="Toggle",a="Show or hide",l="Enable or disable",u=[{text:`${o} Theme`,action:()=>{App.show_theme_modal()},title:`${o} the theme color`},{text:`${o} Visual`,action:()=>{App.open_visual_modal()},title:`${o} the background animation`},{text:`${e} Scope`,action:()=>{App.toggle_scope()},title:`${a} the scope visualizer`},{text:`${e} Status`,action:()=>{App.toggle_status()},title:`${a} the status bar`},{text:`${e} Effects`,action:()=>{App.toggle_effects()},title:`${a} the effects controls`},{text:`${e} Lines`,action:()=>{App.toggle_lines()},title:`${l} the line numbers`},{text:`${e} Mirror`,action:()=>{App.toggle_mirror()},title:`${l} the playback reflection on the code`},{text:"Connect GitHub",action:()=>{App.github_login()},title:"Connect your GitHub account to save snapshots as gists"}];App.show_items_modal("settings",{items:u,action:p=>{p.action()}})},App.db_version=1,App.db_name="SlideDatabase",App.db_store_name="snapshots",App.max_snapshot_size=20*1e4,App.max_snapshots=1e3,App.max_snapshot_title=500,App.displayed_snapshots=100,App.init_db=()=>new Promise((o,e)=>{let a=indexedDB.open(App.db_name,App.db_version);a.onupgradeneeded=l=>{let u=l.target.result;u.objectStoreNames.contains(App.db_store_name)||u.createObjectStore(App.db_store_name,{keyPath:"id",autoIncrement:!0})},a.onsuccess=()=>{console.log("💾 Snapshot saved."),o(a.result)},a.onerror=()=>{e(a.error)}}),App.get_snapshot_hash=async o=>{let e=[o.code,o.title,o.eq_low,o.eq_mid,o.eq_high,o.reverb,o.panning,o.cutoff,o.delay].join("|||"),a=new TextEncoder().encode(e),l=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(l)).map(d=>d.toString(16).padStart(2,"0")).join("")},App.save_snapshot=()=>{App.show_confirm({title:"Save Snapshot",message:"Save the current code and effects?",ok_action:()=>{App.do_save_snapshot()}})},App.do_save_snapshot=async(o="",e="")=>{if(o||(o=App.last_code),!o||!o.trim()||(e||(e=App.last_playing),o.length>App.max_snapshot_size)||e.length>App.max_snapshot_title)return;let a={code:o,title:e,eq_low:App.eq.low,eq_mid:App.eq.mid,eq_high:App.eq.high,reverb:App.reverb_enabled,panning:App.panning_enabled,cutoff:App.cutoff_enabled,delay:App.delay_enabled},l=await App.get_snapshot_hash(a),u={...a,hash:l,timestamp:Date.now()},d=(await App.init_db()).transaction([App.db_store_name],"readwrite"),f=d.objectStore(App.db_store_name),g,b=f.indexNames.contains("hash");return b?g=f.index("hash").openCursor(l):g=f.openCursor(),g.onsuccess=A=>{let S=A.target.result;if(S){let M=S.value;(b||M.hash===l)&&S.delete(),S.continue()}else{f.add(u),App.prune_snapshots(f);try{App.save_gist(JSON.stringify(a),App.filename(e))}catch(M){console.error(M)}}},new Promise((A,S)=>{d.oncomplete=()=>{A()},d.onerror=()=>{S(d.error)}})},App.prune_snapshots=o=>{let e=o.count();e.onsuccess=()=>{let a=e.result;if(a>App.max_snapshots){let l=a-App.max_snapshots,u=o.openCursor(),p=0;u.onsuccess=d=>{let f=d.target.result;f&&p<l&&(f.delete(),p++,f.continue())}}}},App.get_snapshots=async()=>{let a=(await App.init_db()).transaction([App.db_store_name],"readonly").objectStore(App.db_store_name);return new Promise((l,u)=>{let p=a.getAll();p.onsuccess=()=>{l(p.result)},p.onerror=()=>{u(p.error)}})},App.clear_snapshots=async()=>{let a=(await App.init_db()).transaction([App.db_store_name],"readwrite").objectStore(App.db_store_name);return new Promise((l,u)=>{let p=a.clear();p.onsuccess=()=>{console.log("Snapshots cleared successfully"),l()},p.onerror=()=>{console.error("Failed to clear history",p.error),u(p.error)}})},App.create_snapshots_modal=()=>{let o=App.create_list_modal("snapshots"),e=DOM.el(".modal-title",o);e.textContent="Snapshots"},App.show_snapshots=async()=>{let o=await App.get_snapshots();if(o.length===0){App.show_alert("No snapshots saved yet. Use the 💾 button.","Empty List");return}o.reverse(),o=o.slice(0,App.displayed_snapshots);let e=[];for(let a of o){let l=a.title||"Untitled",u=App.get_weekday(a.timestamp);l+=` | ${u}`,e.push({text:l,title:`Click to load this snapshot
Middle Click to remove
Ctrl+Click to queue`,snapshot:a})}App.show_items_modal("snapshots",{items:e,action:a=>{App.load_snapshot(a.snapshot)},alt_action:(a,l)=>{App.remove_snapshot(a.snapshot,l)},ctrl_action:(a,l)=>{App.queue_snapshot(a.snapshot),App.flash(l)},hover:!0,hover_title:"Queue Snapshot"})},App.use_snapshot=o=>{App.eq.low=o.eq_low||0,App.eq.mid=o.eq_mid||0,App.eq.high=o.eq_high||0,App.reverb_enabled=o.reverb||!1,App.panning_enabled=o.panning||!1,App.cutoff_enabled=o.cutoff||!1,App.delay_enabled=o.delay||!1,App.beat_title=o.title,App.check_effects(),App.save_effects()},App.load_snapshot=o=>{App.use_snapshot(o),App.stop_auto(),App.play_action(o.code,{fresh:!0}),App.close_modal("snapshots")},App.remove_snapshot=(o,e)=>{App.show_confirm({title:"Remove",message:"Remove this snapshot?",ok_action:()=>{App.do_remove_snapshot(o).then(()=>{e.remove()})}})},App.do_remove_snapshot=async o=>{if(!o||!o.id)return!1;let a=(await App.init_db()).transaction([App.db_store_name],"readwrite");return a.objectStore(App.db_store_name).delete(o.id),new Promise((u,p)=>{a.oncomplete=()=>{console.log("🗑️ Snapshot removed."),u()},a.onerror=()=>{p(a.error)}})},App.get_snapshot_by_id=async o=>{if(!o)return null;let u=(await App.init_db()).transaction([App.db_store_name],"readonly").objectStore(App.db_store_name).get(o);return new Promise((p,d)=>{u.onsuccess=()=>{p(u.result)},u.onerror=()=>{d(u.error)}})},App.song_cache={},App.fetched_songs_date=0,App.fetched_songs=[],App.song_fetch_delay=60*1e3,App.fetch_songs_list=async()=>{try{if(Date.now()-App.fetched_songs_date<App.song_fetch_delay)return App.fetched_songs;App.loading();let o=await fetch("/songs/list");if(!o.ok)throw new Error("Failed to fetch songs list");let e=await o.json();return Array.isArray(e)?(App.fetched_songs=e,App.fetched_songs_date=Date.now(),App.playing(),e):(console.error("Songs list payload was not an array"),App.playing(),[])}catch(o){return console.error("Error fetching songs",o),App.playing(),[]}},App.fetch_song_code=async o=>{try{let e=await fetch(`/songs/${o}.js`);if(!e.ok)throw new Error(`Failed to fetch song ${o}`);let a=await e.text(),l=App.clean_song_name(o),u={};return u.name=o,u.clean_name=l,u.raw=a,u.filtered=App.filter_code(a),App.song_cache[o]=u,App.last_code=a,a}catch(e){throw console.error("Error fetching song content",e),e}},App.create_songs_modal=()=>{let o=App.create_list_modal("songs"),e=DOM.el(".modal-title",o);e.textContent="Songs"},App.show_songs=async()=>{let o=await App.fetch_songs_list(),e=[];for(let a of o)e.push({text:a,title:`Click to load this song
Ctrl+Click to queue`});App.show_items_modal("songs",{items:e,action:a=>{App.load_song(a.text)},ctrl_action:(a,l)=>{App.queue_song(a.text),App.flash(l)},hover:!0,hover_title:"Queue Song"})},App.load_song=async o=>{App.close_modal("songs");try{App.loading();let e=await App.fetch_song_code(o);App.stop_auto(),App.beat_title="",App.code_scroll_active&&App.defer_code_scroll(App.code_scroll_song_pause_ms),App.reset_effects(),App.check_effects(),await App.play_action(e,{fresh:!0}),App.set_song_context(o)}catch(e){App.set_status(`Failed to load song: ${e.message}`),console.error("Failed to load song:",e)}},App.set_song_context=(o="")=>{App.current_song=o||"",App.set_title(App.underspace(App.current_song)),App.update_url(App.current_song),App.update_title()},App.random_song=async()=>{try{let o=await App.fetch_songs_list();if(!o.length){console.error("No songs available to pick from");return}let e=o.filter(u=>u!==App.current_song);if(!e.length){console.error("No songs available after filtering out the current song");return}let a=App.random_int({min:0,max:e.length-1}),l=e[a];await App.load_song(l)}catch(o){console.error("Error selecting a random song",o)}},App.get_matched_song=()=>{for(let o in App.song_cache){let e=App.song_cache[o];if(e.filtered===App.last_code)return e;if(e.raw===App.last_code)return e}},App.get_song_name=(o=!1)=>{let e=App.get_matched_song(),a="";return e&&(o?a=e.clean_name:a=e.name),a},App.clean_song_name=o=>App.capitalize(App.underspace(o)),App.strudel_sounds=["sawtooth","square","triangle","sine","sax","gtr","moog","white","pink","brown","bd","sd","rim","hh","oh","lt","mt","ht","rd","cr"],App.beat_title="",App.status_enabled=!0,App.setup_status=()=>{App.status_debouncer=App.create_debouncer(e=>{App.do_set_status(e)},200);let o=App.get_status();DOM.ev(o,"click",()=>{App.ask_for_title()}),DOM.ev(o,"wheel",e=>{e.deltaY<0?o.scrollLeft-=20:e.deltaY>0&&(o.scrollLeft+=20),e.preventDefault()}),App.check_status()},App.get_status=()=>DOM.el("#status"),App.set_status=o=>{App.status_debouncer&&App.status_debouncer.call(o)},App.do_set_status=o=>{let e=App.get_status();e.scrollTop=0,e.scrollLeft=0,e.innerText=o},App.get_status_height=()=>{let o=DOM.el("#status");return App.get_el_height(o)},App.enable_status=()=>{DOM.show(App.get_status())},App.disable_status=()=>{DOM.hide(App.get_status())},App.check_status=()=>{App.status_enabled?App.enable_status():App.disable_status()},App.toggle_status=()=>{App.status_enabled=!App.status_enabled,App.check_status(),App.stor_save_status()},App.tempo_storage_key="slide.tempo",App.auto_endpoint_storage_key="slide.auto_endpoint",App.auto_delay_storage_key="slide.auto_delay",App.volume_storage_key="slide.volume",App.visual_storage_key="slide.visual",App.scope_storage_key="slide.scope",App.code_storage_key="slide.code",App.lines_storage_key="slide.lines",App.mirror_storage_key="slide.mirror",App.theme_storage_key="slide.theme",App.effects_storage_key="slide.effects",App.status_storage_key="slide.status",App.eq_storage_key="slide.eq",App.reverb_storage_key="slide.reverb",App.panning_storage_key="slide.panning",App.cutoff_storage_key="slide.cutoff",App.delay_storage_key="slide.delay",App.load_storage=(o,e)=>{let a=localStorage.getItem(App[`${o}_storage_key`]);[null,void 0].includes(a)||e(a)},App.save_storage=(o,e)=>{localStorage.setItem(App[`${o}_storage_key`],e)},App.load_all_storage=()=>{App.stor_load_auto_endpoint(),App.stor_load_auto_delay(),App.stor_load_tempo(),App.stor_load_volume(),App.stor_load_visual(),App.stor_load_scope(),App.stor_load_code(),App.stor_load_lines(),App.stor_load_mirror(),App.stor_load_theme(),App.stor_load_eq(),App.stor_load_status(),App.stor_load_effects(),App.stor_load_reverb(),App.stor_load_panning(),App.stor_load_cutoff(),App.stor_load_delay()},App.stor_load_auto_endpoint=()=>{App.load_storage("auto_endpoint",o=>{App.auto_endpoint=o})},App.stor_load_auto_delay=()=>{App.load_storage("auto_delay",o=>{App.auto_delay=parseInt(o)})},App.stor_load_tempo=()=>{App.load_storage("tempo",o=>{App.tempo=parseInt(o)})},App.stor_load_volume=()=>{App.load_storage("volume",o=>{App.volume=parseInt(o)})},App.stor_load_visual=()=>{App.load_storage("visual",o=>{App.visual=o})},App.stor_load_scope=()=>{App.load_storage("scope",o=>{App.scope_enabled=App.boolstring(o)})},App.stor_load_lines=()=>{App.load_storage("lines",o=>{App.lines_enabled=App.boolstring(o)})},App.stor_load_mirror=()=>{App.load_storage("mirror",o=>{App.mirror_enabled=App.boolstring(o)})},App.stor_load_status=()=>{App.load_storage("status",o=>{App.status_enabled=App.boolstring(o)})},App.stor_load_code=()=>{App.load_storage("code",o=>{App.last_code=o})},App.stor_load_theme=()=>{App.load_storage("theme",o=>{App.theme=o})},App.stor_load_eq=()=>{App.load_storage("eq",o=>{App.eq=JSON.parse(o)})},App.stor_load_effects=()=>{App.load_storage("effects",o=>{App.effects_enabled=App.boolstring(o)})},App.stor_load_reverb=()=>{App.load_storage("reverb",o=>{App.reverb_enabled=App.boolstring(o)})},App.stor_load_panning=()=>{App.load_storage("panning",o=>{App.panning_enabled=App.boolstring(o)})},App.stor_load_cutoff=()=>{App.load_storage("cutoff",o=>{App.cutoff_enabled=App.boolstring(o)})},App.stor_load_delay=()=>{App.load_storage("delay",o=>{App.delay_enabled=App.boolstring(o)})},App.stor_save_auto_delay=()=>{App.save_storage("auto_delay",App.auto_delay)},App.stor_save_auto_endpoint=()=>{App.save_storage("auto_endpoint",App.auto_endpoint)},App.stor_save_tempo=()=>{App.save_storage("tempo",App.tempo)},App.stor_save_volume=()=>{App.save_storage("volume",App.volume)},App.stor_save_visual=()=>{App.save_storage("visual",App.visual)},App.stor_save_scope=()=>{App.save_storage("scope",App.scope_enabled)},App.stor_save_lines=()=>{App.save_storage("lines",App.lines_enabled)},App.stor_save_mirror=()=>{App.save_storage("mirror",App.mirror_enabled)},App.stor_save_code=()=>{App.save_storage("code",App.last_code)},App.stor_save_theme=()=>{App.save_storage("theme",App.theme)},App.stor_save_eq=()=>{App.save_storage("eq",JSON.stringify(App.eq))},App.stor_save_effects=()=>{App.save_storage("effects",JSON.stringify(App.effects_enabled))},App.stor_save_status=()=>{App.save_storage("status",JSON.stringify(App.status_enabled))},App.stor_save_reverb=()=>{App.save_storage("reverb",JSON.stringify(App.reverb_enabled))},App.stor_save_panning=()=>{App.save_storage("panning",JSON.stringify(App.panning_enabled))},App.stor_save_cutoff=()=>{App.save_storage("cutoff",JSON.stringify(App.cutoff_enabled))},App.stor_save_delay=()=>{App.save_storage("delay",JSON.stringify(App.delay_enabled))},App.tempo=App.default_cpm,App.tempo_debounce_timer=void 0,App.tempo_commit_delay_ms=500,App.min_tempo=2,App.max_tempo=120,App.tempo_step=2,App.tempo_wheel_commit_timer=void 0,App.tempo_wheel_commit_delay_ms=150,App.schedule_tempo_commit=o=>{if(typeof window>"u"){o();return}App.tempo_debounce_timer&&window.clearTimeout(App.tempo_debounce_timer),App.tempo_debounce_timer=window.setTimeout(()=>{App.tempo_debounce_timer=void 0,o()},App.tempo_commit_delay_ms)},App.schedule_tempo_wheel_commit=()=>{if(typeof window>"u"){App.on_tempo_change(!0,App.tempo);return}App.tempo_wheel_commit_timer&&window.clearTimeout(App.tempo_wheel_commit_timer),App.tempo_wheel_commit_timer=window.setTimeout(()=>{App.tempo_wheel_commit_timer=void 0,App.on_tempo_change(!0,App.tempo)},App.tempo_wheel_commit_delay_ms)},App.get_tempo_slider=()=>DOM.el("#tempo-slider"),App.get_tempo_value=()=>DOM.el("#tempo-value"),App.refresh_tempo_ui=()=>{let o=App.get_tempo_slider(),e=App.get_tempo_value();o&&(o.value=`${App.tempo}`),e&&(e.textContent=parseInt(App.tempo))},App.persist_tempo=()=>{if(!(typeof window>"u"))try{App.stor_save_tempo()}catch(o){console.warn("Failed to persist tempo",o)}},App.update_tempo=o=>{let e=parseInt(o,10);Number.isFinite(e)||(e=App.tempo),e=Math.round(e/App.tempo_step)*App.tempo_step,e=Math.min(App.max_tempo,Math.max(App.min_tempo,e)),App.tempo=e,App.refresh_tempo_ui()},App.on_tempo_change=(o=!1,e=void 0)=>{let a=e;a===null&&(a=App.get_tempo_slider()?.value),App.update_tempo(a),o&&App.schedule_tempo_commit(()=>{App.persist_tempo(),App.set_tempo()})},App.init_tempo_controls=()=>{let o=App.get_tempo_slider(),e=DOM.el("#tempo-control"),a=DOM.el("#tempo-decrement"),l=DOM.el("#tempo-increment"),u=DOM.el("#tempo-intended");if(!o)return;App.refresh_tempo_ui(),App.persist_tempo(),DOM.ev(o,"input",d=>{App.update_tempo(d.target.value)}),App.setup_slider(e,d=>{d.value=App.default_cpm,App.update_tempo(App.default_cpm),App.set_tempo()},d=>{App.on_tempo_change(!1,d),App.schedule_tempo_wheel_commit()}),DOM.ev(e,"change",()=>{App.on_tempo_change(!0)});let p=d=>{let f=App.tempo+d*App.tempo_step;App.on_tempo_change(!0,f)};App.make_control_button(a,()=>{p(-1)}),App.make_control_button(l,()=>{p(1)}),u&&DOM.ev(u,"click",()=>{App.set_song_tempo(App.last_code)}),App.remove_context(u,()=>{App.set_intended_tempo()})},App.set_tempo=()=>{try{App.scheduler.setCps(App.tempo/60)}catch(o){console.debug("Tempo will be applied when audio starts",o)}},App.intended_cpm=o=>{let e=d=>{try{return Function(`"use strict"; return (${d})`)()}catch{return null}},a=App.default_cpm,l=o.match(/setcpm\(\s*([\d./*+ -]+)\s*\)/),u=o.match(/setcps\(\s*([\d./*+ -]+)\s*\)/),p=o.match(/setbpm\(\s*([\d./*+ -]+)\s*\)/);if(l){let d=e(l[1]);d!==null&&(a=d)}else if(u){let d=e(u[1]);d!==null&&(a=d*60)}else if(p){let d=e(p[1]);d!==null&&(a=d/4)}return a},App.set_song_tempo=o=>{App.tempo=App.intended_cpm(o),App.set_tempo(),App.refresh_tempo_ui()},App.set_intended_tempo=()=>{App.set_song_tempo(App.last_code)},App.themes={white:"rgb(204, 198, 239)",blue:"rgb(127, 155, 210)",red:"rgb(222, 143, 143)",yellow:"rgb(197, 187, 106)",green:"rgb(148, 221, 148)",orange:"rgb(235, 178, 134)",purple:"rgb(176, 156, 217)",teal:"rgb(115, 194, 191)",pink:"rgb(232, 161, 193)"},App.theme="green",App.setup_theme=()=>{App.apply_color(App.themes[App.theme])},App.create_theme_modal=()=>{let o=App.create_list_modal("theme"),e=DOM.el(".modal-title",o);e.textContent="Themes"},App.show_theme_modal=()=>{let o=[];for(let e in App.themes)o.push({text:App.capitalize(e),title:"Use this for the theme color",value:e,icon_color:App.themes[e]});App.show_items_modal("theme",{items:o,icons:!1,color_icons:!0,action:e=>{App.theme=e.value,App.on_theme_change(),App.close_modal("theme")}})},App.editor_theme={"& .cm-activeLine":{backgroundColor:"transparent !important"},"& .cm-activeLineGutter":{backgroundColor:"transparent !important"},"& .cm-gutters":{backgroundColor:"#202020 !important",borderRight:"1px solid #4C566A",paddingRight:"0.66rem",userSelect:"none"},"& .cm-lineNumbers .cm-gutterElement":{paddingLeft:"8px",color:"#aaa"},"& .cm-matchingBracket":{backgroundColor:"rgba(136, 192, 208, 0.2) !important",color:"#ECEFF4 !important"},"& .cm-nonmatchingBracket":{backgroundColor:"rgba(191, 97, 106, 0.3) !important"},"& .cm-selectionMatch":{backgroundColor:"rgba(136, 192, 208, 0.25) !important",outline:"1px solid rgba(136, 192, 208, 0.4)"},"& .cm-selectionBackground, &.cm-focused .cm-selectionBackground":{backgroundColor:"rgba(67, 76, 94, 0.8) !important"},".cm-panels":{backgroundColor:"#2E3440",color:"#D8DEE9",borderTop:"1px solid #4C566A",borderBottom:"1px solid #4C566A"},".cm-panels-top":{borderBottom:"2px solid #3B4252"},".cm-panels-bottom":{borderTop:"2px solid #3B4252"},".cm-search":{display:"block",alignItems:"center",gap:"8px",padding:"8px 12px",fontFamily:"inherit"},".cm-search .cm-textfield":{backgroundColor:"#3B4252",color:"#ECEFF4",border:"1px solid #4C566A",borderRadius:"4px",padding:"4px 8px",outline:"none",minWidth:"200px"},".cm-search .cm-textfield:focus":{border:"1px solid #88C0D0"},".cm-button":{backgroundImage:"none",backgroundColor:"#434C5E",color:"#ECEFF4",border:"none",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",textTransform:"capitalize",fontSize:"0.9em"},".cm-button:hover":{backgroundColor:"#5E81AC"},".cm-button:active":{transform:"translateY(1px)"},".cm-search label":{display:"inline-flex",alignItems:"center",gap:"4px",fontSize:"0.85em",cursor:"pointer"},".cm-search input[type='checkbox']":{cursor:"pointer",accentColor:"#88C0D0"},".cm-panel.cm-search [name='close']":{marginLeft:"auto",padding:"2px 6px",fontSize:"1.2em",background:"transparent"},".cm-panel.cm-search [name='close']:hover":{color:"#C3C3C3"},".cm-searchMatch":{backgroundColor:"rgba(235, 203, 139, 0.4)",outline:"1px solid #EBCB8B"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#EBCB8B",color:"#2E3440"},".cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected='true']":{backgroundColor:"#6391c1ec",color:"white"},".cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected='true'] .cm-completionIcon":{color:"white"}},App.prev_theme=()=>{let o=Object.keys(App.themes),e=o.indexOf(App.theme);if(e===-1){App.theme=o[0];return}e=(e-1+o.length)%o.length,App.theme=o[e],App.on_theme_change()},App.next_theme=()=>{let o=Object.keys(App.themes),e=o.indexOf(App.theme);if(e===-1){App.theme=o[0];return}e=(e+1)%o.length,App.theme=o[e],App.on_theme_change()},App.on_theme_change=()=>{App.apply_color(App.themes[App.theme]),App.stor_save_theme()},App.tooltip_el=null,App.tooltips_offset=8,App.tooltips_enabled=!0,App.tooltip_delay=800,App.create_tooltip_element=()=>{App.tooltip_el||(App.tooltip_el=DOM.create("div"),App.tooltip_el.id="custom-tooltip",document.body.appendChild(App.tooltip_el),App.tooltip_debouncer=App.create_debouncer(o=>{App.show_tooltip(o)},App.tooltip_delay))},App.get_tooltip_position=o=>{let e=o.getBoundingClientRect(),a=App.tooltip_el.getBoundingClientRect(),l=e.bottom+App.tooltips_offset,u=e.left+e.width/2-a.width/2;return l+a.height>window.innerHeight&&(l=e.top-a.height-App.tooltips_offset),u<App.tooltips_offset&&(u=App.tooltips_offset),u+a.width>window.innerWidth-App.tooltips_offset&&(u=window.innerWidth-a.width-App.tooltips_offset),{top:l,left:u}},App.show_tooltip=o=>{if(!App.tooltips_enabled)return;let e=o.target.getAttribute("data-tooltip-text");if(!e)return;e=e.replace(/\\n/g,`
`),App.tooltip_el.textContent=e,App.tooltip_el.style.display="block";let{top:a,left:l}=App.get_tooltip_position(o.target);App.tooltip_el.style.top=`${a}px`,App.tooltip_el.style.left=`${l}px`},App.hide_tooltip=()=>{App.tooltip_el&&(App.tooltip_debouncer.cancel(),App.tooltip_el.style.display="none")},App.register_tooltip=o=>{if(o.hasAttribute("title")){let e=o.getAttribute("title");o.setAttribute("data-tooltip-text",e),o.removeAttribute("title")}o.dataset.hasCustomTooltip||(o.dataset.hasCustomTooltip="true",DOM.ev(o,"mouseenter",e=>{App.tooltip_debouncer.call(e)}),DOM.ev(o,"mouseleave",App.hide_tooltip),DOM.ev(o,"mousedown",App.hide_tooltip))},App.init_tooltips=()=>{App.create_tooltip_element(),DOM.els("[title]").forEach(e=>{App.register_tooltip(e)})},App.code_query_key="code",App.song_query_key="song",App.title_query_key="title",App.url_query_key="url",App.update_url=(o="")=>{let e=new URL(window.location.href),a=App.get_input_value().trim(),l=["code","song","title","url"];if([...e.searchParams.keys()].forEach(p=>{l.includes(p)||e.searchParams.delete(p)}),o||(o=App.get_song_name()),o?e.searchParams.set(App.song_query_key,o):e.searchParams.delete(App.song_query_key),!o&&App.beat_url?e.searchParams.set(App.url_query_key,App.beat_url):e.searchParams.delete(App.url_query_key),a&&!o&&!App.beat_url&&a.length<=App.code_url_max){let p=App.compress_string(a);e.searchParams.set(App.code_query_key,p)}else e.searchParams.delete(App.code_query_key);App.beat_title?e.searchParams.set(App.title_query_key,App.beat_title):e.searchParams.delete(App.title_query_key),window.history.replaceState({},document.title,`${e.pathname}${e.search}${e.hash}`)},App.load_code_from_query=()=>{let e=new URLSearchParams(window.location.search).get(App.code_query_key);if(!e)return!1;try{let a=App.uncompress_string(e);return App.last_code=a,App.load_last_code(),!0}catch(a){App.set_status(`Failed to load song: ${a.message}`),console.error("Failed to load song:",a)}return!1},App.load_url_from_query=()=>{let e=new URLSearchParams(window.location.search).get(App.url_query_key);if(!e)return!1;try{return App.beat_url=e,App.load_beat_url(),!0}catch(a){App.set_status(`Failed to load song: ${a.message}`),console.error("Failed to load song:",a)}return!1},App.load_song_from_query=async()=>{let e=App.get_query_params().get(App.song_query_key);if(!e)return!1;try{App.loading();let a=await App.fetch_song_code(e);return App.set_input(a),App.set_song_tempo(a),App.set_song_context(e),!0}catch(a){App.set_status(`Failed to load song: ${a.message}`),console.error("Failed to load song:",a)}return!1},App.set_beat_title_from_query=()=>{let e=App.get_query_params().get(App.title_query_key);e&&(App.beat_title=e)},App.get_beat_url=()=>{App.show_prompt({title:"Load URL",placeholder:"javascript / text file",value:App.beat_url||"",action:o=>{o&&(App.beat_url=o.trim(),App.load_beat_url(!0))}})},App.load_beat_url=async(o=!1)=>{if(App.update_url(),!!App.beat_url)try{App.loading();let e=await fetch(App.beat_url);if(!e.ok)throw new Error(`Failed to fetch the beat at ${App.beat_url}`);let a=await e.text();if(!a){App.playing();return}try{let p=JSON.parse(a);App.use_snapshot(p),a=p.code}catch{}let l=a.trim();if(!l){App.playing();return}App.stop_auto(),App.last_code=l;let u=App.filter_code(l);App.url_code=u,App.set_input(l),App.set_song_tempo(l),App.update_url(),App.check_effects(),App.playing(),o&&App.play_action(l,{fresh:!0})}catch(e){console.error(e),App.playing()}},App.is_url_beat=()=>App.url_code===App.last_code,App.control_button_throttle=100,App.control_button_delay=250,App.def_args=(o,e)=>{for(let a in o)e[a]===void 0&&o[a]!==void 0&&(e[a]=o[a])},App.escape_regex=o=>o.replace(/[\^$*+?.()|[\]{}-]/g,"\\$&"),App.underspace=o=>o.replace(/_+/g," ").trim(),App.truncate_path=(o,e=20)=>o.length<=e?o:o.substring(0,e)+"...",App.random_int=(o={})=>{let e={exclude:[]};if(App.def_args(e,o),o.exclude.length>0){let a=[];for(let u=o.min;u<=o.max;u++)o.exclude.includes(u)||a.push(u);if(a.length===0)return;let l;return o.rand?l=Math.floor(o.rand()*a.length):l=Math.floor(Math.random()*a.length),a[l]}return o.rand?Math.floor(o.rand()*(o.max-o.min+1)+o.min):Math.floor(Math.random()*(o.max-o.min+1)+o.min)},App.create_debouncer=(o,e)=>{if(typeof o!="function"){App.error("Invalid debouncer function");return}if(typeof e!="number"||e<1){App.error("Invalid debouncer delay");return}let a,l={};function u(){clearTimeout(a),a=void 0}function p(...d){o(...d)}return l.call=(...d)=>{u(),a=setTimeout(()=>{p(...d)},e)},l.call_2=(...d)=>{a||l.call(d)},l.now=(...d)=>{u(),p(...d)},l.cancel=()=>{u()},l},App.boolstring=o=>o&&o==="true",App.capitalize=o=>o.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),App.get_el_height=o=>{if(!o)return 0;let e=window.getComputedStyle(o),a=o.clientHeight,l=parseFloat(e.paddingTop)||0,u=parseFloat(e.paddingBottom)||0,p=parseFloat(e.marginTop)||0,d=parseFloat(e.marginBottom)||0;return a-l-u+l+u+p+d},App.viewport_height=()=>window.innerHeight||document.documentElement.clientHeight,App.compress_string=o=>{try{return lz.compressToEncodedURIComponent(o)}catch{return""}},App.uncompress_string=o=>{try{return lz.decompressFromEncodedURIComponent(o)}catch{return""}},App.make_control_button=(o,e)=>{DOM.ev(o,"click",()=>{e()}),App.remove_context(o,()=>{e()}),DOM.ev(o,"mousedown",()=>{App.ctrl_btn_interval_delay=setTimeout(()=>{App.ctrl_btn_interval=setInterval(()=>{e()},App.control_button_throttle)},App.control_button_delay)}),DOM.ev(o,"mouseup",()=>{clearInterval(App.ctrl_btn_interval),clearInterval(App.ctrl_btn_interval_delay)})},App.setup_slider=(o,e,a)=>{let l=DOM.el("input",o);App.middle_click(o,()=>{e(l)}),App.remove_context(o),DOM.ev(o,"wheel",u=>{u.preventDefault();let p=parseInt(l.step,10),d=parseInt(l.value,10),f;u.deltaY<0?f=d+p:f=d-p,l.value=f,a(f)},{passive:!1})},App.remove_context=(o,e)=>{DOM.ev(o,"contextmenu",a=>{a.preventDefault(),e&&e()})},App.set_css_var=(o,e)=>{document.documentElement.style.setProperty(`--${o}`,e)},App.middle_click=(o,e)=>{DOM.ev(o,"auxclick",a=>{a.button===1&&(e(),a.preventDefault())})},App.cond=o=>{for(let e of o){let[a,l]=e;if(typeof a=="function"?a():a)return typeof l=="function"?l():l}},App.remove_multiple_spaces=o=>o.replace(/\s+/g," ").trim(),App.get_weekday=o=>{let e=new Date(o),a={weekday:"short"};return e.toLocaleDateString(void 0,a)},App.num_lines=o=>o?o.split(`
`).length:0,App.filename=o=>(o=o.toLowerCase(),o=o.replace(/\s+/,"_"),o=o.substring(0,100),`${o}.slide`),App.flash=o=>{let a=[{opacity:1},{opacity:.3},{opacity:1}],l={duration:600,iterations:1,easing:"ease-in-out"};o.animate(a,l)},App.canvas_effect_time=3*1e3,App.animation_frames=0,App.visual_items=[{text:"auto",alt_text:"Auto - The code sets it",title:"Let the code decide. If the code contains animation calls they will be visible, else it will be a solid background"},{text:"none",alt_text:"None - Solid background",title:"Use a solid background. Most performant option"},{text:"flux surface",title:"A shimmering, flowing horizon where colors swirl like a sunset blending into dawn, a landscape in constant motion that feels alive and mysterious, like walking through a translucent, rippling lake of light"},{text:"hyper rose",title:"A surreal garden of glowing petals that pulse with vibrant energy, blossoms blooming in impossible hues, evoking a sense of wonder and infinite growth in a dreamlike meadow"},{text:"bio tunnel",title:"A lush, organic corridor woven with twisting vines and luminous flora, evoking the feeling of wandering through an underground rainforest alive with whispers of nature’s secret life"},{text:"liquid aether",title:"A flowing, translucent river of ethereal substance, shimmering with iridescent waves that pulse softly, inviting you to drift through an otherworldly sea of pure energy and serenity"},{text:"aurora borealis",title:"A celestial dance of shimmering lights in the night sky, ribbons of green, pink, and purple swirling gracefully over icy mountains, evoking awe and the mysterious beauty of the polar skies"},{text:"orb balloons",title:"A whimsical cluster of floating orbs, each glowing softly like lanterns drifting lazily in a gentle breeze, creating a playful, dreamlike atmosphere of floating serenity and joyful levity"}],App.get_bg_canvas=()=>DOM.el("#background-canvas"),App.get_bg_context=()=>App.background_canvas.getContext("2d"),App.create_visual_modal=()=>{let o=App.create_list_modal("visual"),e=DOM.el(".modal-title",o);e.textContent="Visuals"},App.open_visual_modal=async()=>{let o=App.visual_items;App.show_items_modal("visual",{items:o,action:e=>{let a=e.text.toLowerCase();App.apply_visual(a),App.close_modal("visual")},active:App.get_active_visual_index()})},App.start_visual=()=>{App.visual=App.visual||"auto",App.background_canvas=App.get_bg_canvas(),App.background_canvas_ctx=App.get_bg_context(),App.resize_listener||(App.resize_listener=()=>{App.background_canvas&&(App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight)},DOM.ev(window,"resize",App.resize_listener)),App.background_canvas.width=window.innerWidth,App.background_canvas.height=window.innerHeight,App.apply_visual(App.visual)},App.apply_visual=o=>{App.animation_id&&(cancelAnimationFrame(App.animation_id),App.animation_id=null),App.animation_frames=0,App.flow_particles=null,App.bg_orbs=null,App.visual=o,App.stor_save_visual(),["auto"].includes(o)?(App.clear_visual(),App.background_canvas.classList.add("under")):["none"].includes(o)?(App.clear_visual(),App.background_canvas.classList.remove("under")):(App.background_canvas.classList.remove("under"),App.render_animation())},App.anim_bio_tunnel=(o,e,a,l)=>{let u=e/2,p=a/2,d=l*.02;if(!App.tunnel_geo){let F=64;App.tunnel_geo=new Float32Array((F+1)*2);for(let $=0;$<=F;$++){let Z=$/F*Math.PI*2;App.tunnel_geo[$*2]=Math.cos(Z),App.tunnel_geo[$*2+1]=Math.sin(Z)}}for(let F=0;F<2;F++){let $=12,Z=F%2===0?1:-1,V=(F+1)*40,K=d*80,se="hsla(";for(let z=0;z<$;z++){let U=z/$*Math.PI*2+d*Z,ee=V+Math.sin(d*5+z)*10,ae=Math.cos(U),de=Math.sin(U),ke=Math.cos(U+.4),Oe=Math.sin(U+.4),De=u+ae*ee,Ae=p+de*ee,Pe=u+ke*(ee*.5),We=p+Oe*(ee*.5);o.beginPath(),o.moveTo(u,p),o.lineTo(De,Ae),o.lineTo(Pe,We),o.closePath();let qe=(K+z*20)%360;o.strokeStyle=`${se}${qe}, 70%, 60%, 0.6)`,o.stroke(),o.fillStyle=`${se}${qe}, 70%, 10%, 0.1)`,o.fill()}}let f=App.tunnel_geo.length/2,g=d*.5,b=Math.cos(g),A=Math.sin(g),S=d*50,M=Math.PI/8,E=d*3;for(let F=0;F<40;F++){let $=(F*20+l*5)%1e3,Z=1e3/($+10);if(Z>20)continue;let V=200*Z,K=20*Z;o.beginPath(),o.lineWidth=2;let se=(S+$*.5)%360;o.strokeStyle=`hsla(${se}, 80%, 60%, ${$/1e3})`;for(let z=0;z<f;z++){let U=App.tunnel_geo[z*2],ee=App.tunnel_geo[z*2+1],ae=Math.sin(E+z*M)*K,de=V+ae,ke=U*b-ee*A,Oe=U*A+ee*b,De=u+ke*de,Ae=p+Oe*de;z===0?o.moveTo(De,Ae):o.lineTo(De,Ae)}o.closePath(),o.stroke()}},App.anim_flux_surface=(o,e,a,l)=>{let u=30,p=40,d=l*.03,f=d*2,g=65;o.lineWidth=2;for(let b=-g;b<a+g;b+=u){let A=b*.01,S=(b*.2+l*.5)%360;o.strokeStyle=`hsla(${S}, 60%, 60%, 0.8)`,o.beginPath();for(let M=0;M<=e;M+=p){let E=Math.sin(M*.005+d)*50,F=Math.sin(M*.02-f+A)*15;o.lineTo(M,b+E+F)}o.stroke()}},App.anim_hyper_rose=(o,e,a,l)=>{let u=e/2,p=a/2,d=Math.max(e,a)*.8,f=l*.002,g=Math.PI*2,b=.02;o.lineWidth=2,o.lineJoin="round",o.globalCompositeOperation="lighter";for(let A=0;A<8;A++){let S=A/8,M=d*(1-S),E=(l*.2+A*15)%360;o.strokeStyle=`hsla(${E}, 80%, 50%, 0.6)`,o.beginPath();for(let F=0;F<g;F+=b){let $=Math.sin(F*7+f*5)*Math.cos(F*3-f),Z=M*(.5+.5*$),V=F+f*(A+1),K=u+Math.cos(V)*Z,se=p+Math.sin(V)*Z;o.lineTo(K,se)}o.closePath(),o.stroke()}o.globalCompositeOperation="source-over"},App.anim_liquid_aether=(o,e,a,l)=>{let u=80,p=.6,d=4;(!App.flow_particles||App.flow_particles.length!==u)&&(App.flow_particles=Array(u).fill().map(()=>{let b=Math.random()*100;return{x:Math.random()*e,y:Math.random()*a,speed:p,life:b,max_life:b,angle_offset:Math.random()*Math.PI*2,size:Math.random()*4+2}})),(!App.bg_orbs||App.bg_orbs.length!==d)&&(App.bg_orbs=Array(d).fill().map((b,A)=>({x:Math.random()*e,y:Math.random()*a,vx:(Math.random()-.5)*1,vy:(Math.random()-.5)*1,radius:Math.random()*500+400,hue:A*50}))),o.globalCompositeOperation="source-over",o.fillStyle="rgba(15, 10, 30, 0.1)",o.fillRect(0,0,e,a);let f=l*.002;o.globalCompositeOperation="lighter";for(let b=0;b<App.bg_orbs.length;b++){let A=App.bg_orbs[b];A.x+=A.vx+Math.sin(f)*1,A.y+=A.vy+Math.cos(f)*1,A.x<-A.radius&&(A.x=e+A.radius),A.x>e+A.radius&&(A.x=-A.radius),A.y<-A.radius&&(A.y=a+A.radius),A.y>a+A.radius&&(A.y=-A.radius);let S=o.createRadialGradient(A.x,A.y,0,A.x,A.y,A.radius),M=.4+Math.sin(f*2+A.hue)*.2;S.addColorStop(0,`hsla(${A.hue+l*.1}, 80%, 60%, ${M})`),S.addColorStop(1,"rgba(0,0,0,0)"),o.fillStyle=S,o.beginPath(),o.arc(A.x,A.y,A.radius,0,Math.PI*2),o.fill()}o.globalCompositeOperation="source-over";let g=5e-4;for(let b=0;b<App.flow_particles.length;b++){let A=App.flow_particles[b];A.life--,A.life<=0&&(A.x=Math.random()*e,A.y=Math.random()*a,A.life=100+Math.random()*100,A.max_life=A.life,A.size=Math.random()*4+2),o.beginPath();let S=(l*.1+A.x*.02+A.y*.02)%360,M=(A.max_life-A.life)/50,E=A.life/50,F=Math.min(M,E,.8);F=Math.max(0,F),o.fillStyle=`hsla(${S}, 90%, 80%, ${F})`,o.arc(A.x,A.y,A.size,0,Math.PI*2),o.fill();let $=Math.cos(A.x*g+f)+Math.sin(A.y*g+f)+A.angle_offset;A.x+=Math.cos($)*A.speed,A.y+=Math.sin($)*A.speed,A.x<-10&&(A.x=e+10),A.x>e+10&&(A.x=-10),A.y<-10&&(A.y=a+10),A.y>a+10&&(A.y=-10)}},App.anim_orb_balloons=(o,e,a,l)=>{let u=8;(!App.bg_orbs||App.bg_orbs.length!==u)&&(App.bg_orbs=Array(u).fill().map((d,f)=>({x:Math.random()*e,y:Math.random()*a,vx:(Math.random()-.5)*3,vy:(Math.random()-.5)*3,base_radius:Math.random()*150+100,hue:Math.random()*360,phase:Math.random()*Math.PI*2}))),o.globalCompositeOperation="source-over",o.fillStyle="rgba(15, 5, 25, 0.2)",o.fillRect(0,0,e,a);let p=l*.01;o.globalCompositeOperation="lighter",App.bg_orbs.forEach(d=>{d.x+=d.vx,d.y+=d.vy,d.x<-d.base_radius&&(d.vx*=-1),d.x>e+d.base_radius&&(d.vx*=-1),d.y<-d.base_radius&&(d.vy*=-1),d.y>a+d.base_radius&&(d.vy*=-1);let f=d.base_radius+Math.sin(p+d.phase)*50,g=o.createRadialGradient(d.x,d.y,0,d.x,d.y,f),b=(d.hue+l*.5)%360;g.addColorStop(0,`hsla(${b}, 80%, 60%, 0.6)`),g.addColorStop(1,`hsla(${b}, 80%, 40%, 0)`),o.fillStyle=g,o.beginPath(),o.arc(d.x,d.y,f,0,Math.PI*2),o.fill()}),o.globalCompositeOperation="source-over"},App.anim_aurora_borealis=(o,e,a,l)=>{let u=l*.02;o.lineWidth=2,o.globalCompositeOperation="lighter";for(let p=0;p<5;p++){o.beginPath();let d=a*.8,f=(l*.5+p*50)%360;o.fillStyle=`hsla(${f}, 60%, 50%, 0.3)`,o.moveTo(0,a);for(let g=0;g<=e;g+=20){let b=Math.sin(g*.002+u+p)*100+Math.sin(g*.01-u*2)*50;o.lineTo(g,d+b-p*100)}o.lineTo(e,a),o.closePath(),o.fill()}o.globalCompositeOperation="source-over"},App.render_animation=()=>{if(["auto","none"].includes(App.visual))return;let o=window.innerWidth,e=window.innerHeight,a="rgba(0, 0, 0, 0.12)";App.background_canvas_ctx.fillStyle=a,App.background_canvas_ctx.fillRect(0,0,o,e),App.visual==="bio tunnel"?App.anim_bio_tunnel(App.background_canvas_ctx,o,e,App.animation_frames):App.visual==="flux surface"?App.anim_flux_surface(App.background_canvas_ctx,o,e,App.animation_frames):App.visual==="hyper rose"?App.anim_hyper_rose(App.background_canvas_ctx,o,e,App.animation_frames):App.visual==="liquid aether"?App.anim_liquid_aether(App.background_canvas_ctx,o,e,App.animation_frames):App.visual==="aurora borealis"?App.anim_aurora_borealis(App.background_canvas_ctx,o,e,App.animation_frames):App.visual==="orb balloons"&&App.anim_orb_balloons(App.background_canvas_ctx,o,e,App.animation_frames),App.animation_frames++,App.animation_id=requestAnimationFrame(App.render_animation)},App.clear_visual=()=>{let o=window.innerWidth,e=window.innerHeight;App.background_canvas_ctx.clearRect(0,0,o,e)},App.get_active_visual_index=()=>App.visual_items.map(o=>o.text).indexOf(App.visual),App.next_visual=()=>{let o=App.get_active_visual_index();o+=1,o>=App.visual_items.length&&(o=0),o<=1&&(o=2);let e=App.visual_items[o];App.apply_visual(e.text)},App.canvas_effect_1=()=>{let a="brightness(200%) contrast(200%)",l=App.get_bg_canvas();l.style.filter=a,App.start_canvas_effect_timeout()},App.start_canvas_effect_timeout=()=>{App.canvas_effect_timeout&&clearTimeout(App.canvas_effect_timeout),App.canvas_effect_timeout=setTimeout(()=>{App.clear_canvas_effects()},App.canvas_effect_time)},App.clear_canvas_effects=()=>{let o=App.get_bg_canvas();o.style.filter=""},App.volume=100,App.volume_step=1,App.setup_volume=()=>{App.update_volume(App.volume)},App.get_volume_slider=()=>DOM.el("#volume-slider"),App.get_volume_value=()=>DOM.el("#volume-value"),App.read_volume_value=o=>{if(!o)return App.volume;let e=o.valueAsNumber;if(Number.isFinite(e))return e;let a=parseInt(o.value,10);return Number.isFinite(a)?a:App.volume},App.refresh_volume_ui=()=>{let o=App.get_volume_slider(),e=App.get_volume_value();o&&(o.value=`${App.volume}`),e&&(e.innerText=App.volume)},App.apply_volume=()=>{if(App.audio_started)try{let o=App.volume/100;App.set_gain(o)}catch(o){console.error("Failed to apply volume",o)}},App.update_volume=o=>{let e=Number(o);Number.isFinite(e)||(e=App.volume),e=Math.min(100,Math.max(0,e)),App.volume!==e&&(App.volume=e,App.refresh_volume_ui(),App.stor_save_volume(),App.apply_volume())},App.init_volume_controls=()=>{let o=App.get_volume_slider(),e=DOM.el("#volume-control"),a=DOM.el("#volume-decrement"),l=DOM.el("#volume-increment");if(!o)return;App.refresh_volume_ui(),App.stor_save_volume(),DOM.ev(o,"input",p=>{App.update_volume(App.read_volume_value(p.target))});let u=p=>{App.update_volume(App.volume+p*App.volume_step)};App.make_control_button(a,()=>{u(-1)}),App.make_control_button(l,()=>{u(1)}),App.setup_slider(e,()=>{App.update_volume(50)},()=>{App.update_volume(App.read_volume_value(o))})},App.setup_custom_numbers=()=>{let o=DOM.els(".custom-number");for(let e of o){let a=DOM.el("input[type=text]",e),l=DOM.el(".custom-number-decrease",e),u=DOM.el(".custom-number-increase",e);DOM.ev(l,"click",p=>{let d=p.shiftKey?2:1;a.value=parseInt(a.value)-d,a.dispatchEvent(new Event("change"))}),DOM.ev(u,"click",p=>{let d=p.shiftKey?2:1;a.value=parseInt(a.value)+d,a.dispatchEvent(new Event("change"))})}}})();
